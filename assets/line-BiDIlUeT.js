import{o as h,G as b}from"./vec2-ChnYg_BJ.js";import{n as T}from"./vec2f64-Dy6m9Nrb.js";import{N as E}from"./vec4f64-o2zAXfmz.js";import{C as w}from"./Point-Cz2JYYmX.js";import{h as I}from"./projectBuffer-CQnuEMuP.js";import{t as D}from"./aaBoundingBox-Dw3yBk2f.js";import{f as R,n as g}from"./FloatArray-BQXWSSJh.js";import{w as A}from"./Indices-D8XWalpO.js";import{l as F}from"./ViewingMode-Dodu7ZZk.js";import{t as f}from"./Attribute-DGhdp5lO.js";import{e as O}from"./Material-C_-mgXN8.js";import{e as c}from"./VertexAttribute-Cq4MnHjR.js";function V(t,e,n=null){const r=[],l=e.mapPositions;d(e,r);const a=r[0][1].data,i=r[0][1].indices.length,o=A(i);return y(e,r,o),C(e,r,o),v(e,r,o),S(e,r,o),U(e,r,o),z(e,r,o),L(e,r,a),new R(t,r,l,O.Line,n)}function d(t,e){const{attributeData:{position:n},removeDuplicateStartEnd:r}=t,l=N(n)&&r,a=n.length/3-(l?1:0),i=new Array(2*(a-1)),o=l?n.slice(0,-3):n;let u=0;for(let p=0;p<a-1;p++)i[u++]=p,i[u++]=p+1;e.push([c.POSITION,new f(o,i,3,l)])}function y(t,e,n){if(t.attributeData.colorFeature!=null)return;const r=t.attributeData.color;e.push([c.COLOR,new f(r??E,n,4)])}function v(t,e,n){t.attributeData.normal&&e.push([c.NORMAL,new f(t.attributeData.normal,n,3)])}function S(t,e,n){t.attributeData.colorFeature!=null&&e.push([c.COLORFEATUREATTRIBUTE,new f([t.attributeData.colorFeature],n,1,!0)])}function C(t,e,n){t.attributeData.sizeFeature==null&&e.push([c.SIZE,new f([t.attributeData.size??1],n,1,!0)])}function U(t,e,n){t.attributeData.sizeFeature!=null&&e.push([c.SIZEFEATUREATTRIBUTE,new f([t.attributeData.sizeFeature],n,1,!0)])}function z(t,e,n){t.attributeData.opacityFeature!=null&&e.push([c.OPACITYFEATUREATTRIBUTE,new f([t.attributeData.opacityFeature],n,1,!0)])}function L(t,e,n){if(t.overlayInfo==null||t.overlayInfo.renderCoordsHelper.viewingMode!==F.Global||!t.overlayInfo.spatialReference.isGeographic)return;const r=D(n.length),l=w(t.overlayInfo.spatialReference);for(let s=0;s<r.length;s+=3)I(n,s,r,s,l);const a=n.length/3,i=g(a+1);let o=B,u=G,p=0,m=0;h(o,r[m++],r[m++]),m++,i[0]=0;for(let s=1;s<a+1;++s)s===a&&(m=0),h(u,r[m++],r[m++]),m++,p+=b(o,u),i[s]=p,[o,u]=[u,o];e.push([c.DISTANCETOSTART,new f(i,e[0][1].indices,1,!0)])}function N(t){const e=t.length;return t[0]===t[e-3]&&t[1]===t[e-2]&&t[2]===t[e-1]}const B=T(),G=T();function W(t,e){if(t==null||t.length===0)return[];const n=[];return t.forEach(r=>{const l=r.length,a=D(3*l);r.forEach((o,u)=>{a[3*u]=o[0],a[3*u+1]=o[1],a[3*u+2]=o[2]});const i={attributeData:{position:a,normal:e},removeDuplicateStartEnd:!1};n.push(i)}),n}export{W as R,V as b};
