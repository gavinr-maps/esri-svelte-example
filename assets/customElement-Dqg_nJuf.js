import{L as M,u as P,c as j,n as O,s as o,b as u,x as c,e as w,d as f,i as D,a as E}from"./index-4eY77cms.js";import{j as S,d as I}from"./basemapUtils-oMnqy94d.js";import{g as A,r as s,m as n,a as N}from"./Accessor-BmwT4B0c.js";import{d as q,P as z,w as K}from"./reactiveUtils-XM7cS2OP.js";import{a as U}from"./cast-CsZslgGN.js";import{k as V,L as F,K as G}from"./projection-CyCZAIaD.js";import{c as R}from"./Point-Cz2JYYmX.js";import{m as y,l as H}from"./basemapEnsureType-CmRtohu0.js";import{s as J}from"./useT9n-Dwv-EXPO.js";import{u as Q}from"./useViewModel-x7-oy52B.js";import{e as k}from"./globalCss-B9-jl_gY.js";import"./utils-DYurMneM.js";import"./colorUtils-Rxh2V3ai.js";import"./screenUtils-_ZIvrt5o.js";import"./mat4f32-DcsiF_Rp.js";import"./mat4-Fi6iAz29.js";import"./vec3f64-BLpZdpfb.js";import"./common-DQOJ18NT.js";import"./basemapDefinitions-D-Q7PKmu.js";import"./intl-Duiy0OzY.js";import"./Promise-DfET-uns.js";import"./Evented-Dw4_VOGn.js";import"./SimpleObservable-CvOkykwM.js";import"./JSONSupport-DcrLLGjL.js";import"./Extent-g5W9hy0j.js";import"./Polyline-s-JzsQqo.js";import"./writer-DKgfqj4X.js";import"./mathUtils-Cfq9PL9W.js";import"./projectBuffer-CQnuEMuP.js";import"./geodesicConstants-RQL9oKdk.js";import"./Basemap-BZmrlnvW.js";import"./collectionUtils-CTT-51g7.js";import"./Portal-CmmHxpLg.js";import"./loadAll-D1eTJ7uv.js";import"./PortalItem-CTx1kJsR.js";import"./writeUtils-CcunaxF8.js";import"./layerUtils-B__v9OBu.js";import"./index-C5b9dHRB.js";import"./component-utils-D0ciaaZ_.js";function W(e){return S(e)}let i=class extends A{constructor(e){super(e),this._basemapCache={},this._loadingProjectionEngine=!1,this.nextBasemap=y("hybrid",this._basemapCache),this.view=null}initialize(){q(()=>this.nextBasemap,e=>{e&&!e.loaded&&e.load().catch(()=>{})},z)}destroy(){this.view=null,H(this._basemapCache),this._basemapCache=null}get _nextBasemapSpatialReferenceTask(){return I(this.view,this.nextBasemap)}get _viewSpatialReferenceLocked(){const{view:e}=this;return!e||!("spatialReferenceLocked"in e)||e.spatialReferenceLocked}get activeBasemap(){var e,a;return y(((a=(e=this.view)==null?void 0:e.map)==null?void 0:a.basemap)??"topo-vector",this._basemapCache)}castNextBasemap(e){return y(e,this._basemapCache)}get state(){const{view:e}=this;if(!(e!=null&&e.ready)||this._nextBasemapSpatialReferenceTask.updating)return"disabled";const{spatialReference:a}=this._nextBasemapSpatialReferenceTask;return this._viewSpatialReferenceLocked&&a!=null&&!e.spatialReference.equals(a)?"incompatible-next-basemap":this._loadingProjectionEngine?"loading":"ready"}async toggle(){const{activeBasemap:e,nextBasemap:a,state:l,view:t}=this;if(!t||l==="disabled"||l==="incompatible-next-basemap")return;const g=this._viewSpatialReferenceLocked;if(!g){if(await K(()=>!this._nextBasemapSpatialReferenceTask.updating),a!==this.nextBasemap||e!==this.activeBasemap)return;const{spatialReference:m}=this._nextBasemapSpatialReferenceTask;if(m==null||R(t.spatialReference,m)||V()||F(t.spatialReference,m)||(this._loadingProjectionEngine=!0,await G(),this._loadingProjectionEngine=!1),a!==this.nextBasemap||e!==this.activeBasemap)return}t.map.basemap=a,g||this._nextBasemapSpatialReferenceTask.spatialReference==null||R(t.spatialReference,this._nextBasemapSpatialReferenceTask.spatialReference)||(t.spatialReference=this._nextBasemapSpatialReferenceTask.spatialReference),this.nextBasemap=e}static getThumbnailUrl(e){return S(e)}};s([n()],i.prototype,"_loadingProjectionEngine",void 0),s([n({readOnly:!0})],i.prototype,"_nextBasemapSpatialReferenceTask",null),s([n({readOnly:!0})],i.prototype,"_viewSpatialReferenceLocked",null),s([n({readOnly:!0})],i.prototype,"activeBasemap",null),s([n()],i.prototype,"nextBasemap",void 0),s([U("nextBasemap")],i.prototype,"castNextBasemap",null),s([n({readOnly:!0})],i.prototype,"state",null),s([n()],i.prototype,"view",void 0),s([n()],i.prototype,"toggle",null),i=s([N("esri.widgets.BasemapToggle.BasemapToggleViewModel")],i);const X=i;/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.32/esri/copyright.txt for details.
v4.32.12 */const Y=D`@layer{arcgis-basemap-toggle{display:block}}`,p="esri-basemap-toggle",d="esri-basemap-thumbnail",r={base:p,secondaryBasemapImage:`${p}__image--secondary`,container:`${d} ${p}__container`,image:`${d}__image ${p}__image`,imageLoading:`${p}__image--loading`,overlay:`${d}__overlay ${p}__image-overlay`,title:`${d}__title ${p}__title`,overlayScrim:`${d}__overlay-scrim`},Z=Q(X),h=class h extends M{constructor(){super(...arguments),this.messages=J(),this.viewModel=Z(this),this.activeBasemap=this.viewModel.activeBasemap,this.autoDestroyDisabled=!1,this.icon="layer-basemap",this.nextBasemap=this.viewModel.nextBasemap,this.position="top-left",this.showTitle=!1,this.state=this.viewModel.state,this.arcgisPropertyChange=P()("nextBasemap","state"),this.arcgisReady=j()}async destroy(){await this.manager.destroy()}async toggle(){return await this.viewModel.toggle()}_getThumbnailStyles(a){const l=W(a);return l?{backgroundImage:`url(${l})`}:{backgroundImage:""}}render(){const a=this.viewModel,l=a.state==="disabled"?null:a.activeBasemap,t=a.state==="disabled"?null:a.nextBasemap,g=a.state==="loading",m=a.state==="incompatible-next-basemap",v=(t==null?void 0:t.title)??"",b=t&&t.loadStatus!=="loaded";let _;const B=this.showTitle&&v,x=m,T=B||x,L=this._getThumbnailStyles(l),C=this._getThumbnailStyles(t);return T&&(_=c`<div class=${o(r.overlay)}>${B?c`<span class=${o(r.title)} title=${v??u}>${v}</span>`:null}${x?c`<calcite-scrim class=${o(r.overlayScrim)} title=${this.messages.incompatibleSpatialReference??u}><calcite-icon icon=exclamation-mark-triangle></calcite-icon></calcite-scrim>`:null}</div>`),c`<div class=${o(f(r.base,k.widget))}><calcite-button appearance=transparent data-basemap-id=${(t?t.id:"")??u} .disabled=${m} kind=neutral .label=${this.label??void 0} @click=${()=>void this.toggle()} title=${this.label??void 0??u}><div class=${o(f(r.container,r.secondaryBasemapImage))}><div class=${o(r.image)} style=${w(L)}></div></div><div class=${o(r.container)}><div class=${o(f(r.image,b?r.imageLoading:null))} style=${w(C)}>${b||g?c`<calcite-scrim><span aria-hidden=true class=${o(k.loaderAnimation)} role=presentation></span></calcite-scrim>`:null}</div>${_}</div></calcite-button></div>`}};h.properties={activeBasemap:0,autoDestroyDisabled:5,icon:3,label:1,messageOverrides:0,nextBasemap:0,position:3,referenceElement:1,showTitle:5,state:3},h.shadowRootOptions=O,h.styles=Y;let $=h;E("arcgis-basemap-toggle",$);export{$ as ArcgisBasemapToggle};
