import{d as Qs,a1 as Bs,M as ur}from"./Accessor-BHnuXKD2.js";import{i as j,r as z}from"./TimeOnly-yGYcAQQJ.js";import{D as V,Z as Gs,b as Ws}from"./Promise-CmQqe-ke.js";import{d as Ht,al as jt,n as J,i as U,am as dt,Y as H}from"./opacityUtils-CSd4XoR2.js";import{v as Ks}from"./mathUtils-DV9iOXpW.js";var d;(function(i){i.InvalidFunctionParameters="InvalidFunctionParameters",i.InvalidValueForAggregateFunction="InvalidValueForAggregateFunction",i.UnsupportedSqlFunction="UnsupportedSqlFunction",i.UnsupportedOperator="UnsupportedOperator",i.UnsupportedSyntax="UnsupportedSyntax",i.UnsupportedIsRhs="UnsupportedIsRhs",i.UnsupportedIsLhs="UnsupportedIsLhs",i.InvalidDataType="InvalidDataType",i.CannotCastValue="CannotCastValue",i.FunctionNotRecognized="FunctionNotRecognized",i.InvalidTime="InvalidTime",i.InvalidParameterCount="InvalidParameterCount",i.InvalidTimeStamp="InvalidTimeStamp",i.InvalidDate="InvalidDate",i.InvalidOperator="InvalidOperator",i.IllegalInterval="IllegalInterval",i.YearMonthIntervals="YearMonthIntervals",i.PrimarySecondaryQualifiers="PrimarySecondaryQualifiers",i.MissingStatisticParameters="MissingStatisticParameters"})(d||(d={}));const Xs={[d.InvalidValueForAggregateFunction]:"Invalid value used in aggregate function",[d.MissingStatisticParameters]:"Statistic does not have 1 or 0 Parameters",[d.InvalidFunctionParameters]:"Invalid parameters for call to {function}",[d.UnsupportedIsLhs]:"Unsupported left hand expression in is statement",[d.UnsupportedIsRhs]:"Unsupported right hand expression in is statement",[d.UnsupportedOperator]:"Unsupported operator - {operator}",[d.UnsupportedSyntax]:"Unsupported syntax - {node}",[d.UnsupportedSqlFunction]:"Sql function not found = {function}",[d.InvalidDataType]:"Invalid sql data type",[d.InvalidDate]:"Invalid date encountered",[d.InvalidOperator]:"Invalid operator encountered",[d.InvalidTime]:"Invalid time encountered",[d.IllegalInterval]:"Illegal interval",[d.FunctionNotRecognized]:"Function not recognized",[d.InvalidTimeStamp]:"Invalid timestamp encountered",[d.InvalidParameterCount]:"Invalid parameter count for call to {name}",[d.PrimarySecondaryQualifiers]:"Primary and Secondary SqlInterval qualifiers not supported",[d.YearMonthIntervals]:"Year-Month Intervals not supported",[d.CannotCastValue]:"Cannot cast value to the required data type"};let m=class vr extends Error{constructor(a,u){super(Qs(Xs[a],u)),this.declaredRootClass="esri.arcade.featureset.support.sqlerror",Error.captureStackTrace&&Error.captureStackTrace(this,vr)}};function sr(i){return Number.isNaN(i)||i===0?i:Math.trunc(i)}const lr="esri.core.sql.SqlTimeStampOffset";let B=class st{constructor(a){this._timeStampOffset=a,this.declaredRootClass=lr,this._date=null}static isTimestampOffset(a){return typeof a=="object"&&a!=null&&"declaredRootClass"in a&&a.declaredRootClass===lr}toDateTime(){return this._date??(this._date=V.fromISO(this._timeStampOffset,{setZone:!0})),this._date}get isValid(){return this.toDateTime().isValid}get timezoneOffsetHour(){return sr(this.toDateTime().offset/60)}get timezoneOffsetMinutes(){return sr(this.toDateTime().offset%60)}toMilliseconds(){return this.toDateTime().toMillis()}get hour(){return this.toDateTime().hour}get minute(){return this.toDateTime().minute}get second(){return this.toDateTime().second}get day(){return this.toDateTime().day}get month(){return this.toDateTime().month}get year(){return this.toDateTime().year}startOfDay(){return st.fromDateTime(this.toDateTime().startOf("day"))}static fromJSDate(a){return new st(V.fromJSDate(a).toISO({includeOffset:!0}))}static fromDateTime(a){return new st(a.toISO({includeOffset:!0}))}static fromParts(a,u,e=0,l=0,v=0,g=0,C=0,N=!1,y=0,S=0){const A=`${a.toString().padStart(4,"0")}-${u.toString().padStart(2,"0")}-${e.toString().padStart(2,"0")}`;let M="";g<10&&(M="0");let X=`${l.toString().padStart(2,"0")}:${v.toString().padStart(2,"0")}:${M+g.toString()}`;C!==0&&(X+="."+C.toString().padStart(3,"0"));const tt=`${N?"-":"+"}${y.toString().padStart(2,"0")}:${S.toString().padStart(2,"0")}`;return new st(A+"T"+X+tt)}toStorageFormat(){return this._timeStampOffset}toString(){return this._timeStampOffset}toSQLValue(){let a=this.toDateTime().toSQL({includeOffset:!0,includeOffsetSpace:!0});return a&&(a=a.replace(".000","")),a}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}addMilliseconds(a){const u=this.toDateTime().plus(a);return st.fromDateTime(u)}};function tl(i,a){const u=hr[i.toLowerCase()];if(u==null)throw new m(d.FunctionNotRecognized);if(a.length<u.minParams||a.length>u.maxParams)throw new m(d.InvalidParameterCount,{name:i.toUpperCase()});return u.evaluate(a)}function cr(i,a){const u=hr[i.toLowerCase()];return u!=null&&a>=u.minParams&&a<=u.maxParams}const hr={min:{minParams:1,maxParams:1,evaluate:i=>fr(i[0],"min")},max:{minParams:1,maxParams:1,evaluate:i=>fr(i[0],"max")},avg:{minParams:1,maxParams:1,evaluate:i=>wr(i[0])},sum:{minParams:1,maxParams:1,evaluate:i=>el(i[0])},stddev:{minParams:1,maxParams:1,evaluate:i=>rl(i[0])},count:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:i[0].length},var:{minParams:1,maxParams:1,evaluate:i=>Ir(i[0])}};function wr(i){if(i===null)return null;let a=0,u=0;for(let e=0;e<i.length;e++){const l=i[e];if(l!==null){if(!ee(l))throw new m(d.InvalidValueForAggregateFunction);u++,a+=l}}return u===0?null:a/i.length}function ee(i){return typeof i=="number"}function fr(i,a){if(i===null)return null;let u=null,e=null;for(const l of i){let v=l;v=j.isDateOnly(l)||z.isTimeOnly(l)?l.toNumber():V.isDateTime(l)?l.toMillis():B.isTimestampOffset(l)?l.toMilliseconds():l,(u===null||a==="max"&&e!==null&&v!==null&&e<=v||a==="min"&&e!==null&&v!==null&&e>=v)&&(u=l,e=v)}return u}function el(i){if(i===null)return null;let a=0;for(let u=0;u<i.length;u++){const e=i[u];if(e!==null){if(!ee(e))throw new m(d.InvalidValueForAggregateFunction);a+=e}}return a}function rl(i){if(i===null)return null;const a=Ir(i);return a===null?null:Math.sqrt(a)}function Ir(i){if(i===null||(i=i.filter(e=>e!==null)).length===0)return null;const a=wr(i);if(a===null)return null;let u=0;for(const e of i){if(!ee(e))throw new m(d.InvalidValueForAggregateFunction);u+=(a-e)**2}return u/(i.length-1)}function Yt(i){if(i.precision!==null||i.secondary!==null)throw new m(d.PrimarySecondaryQualifiers)}function bt(i,a){if(a.includes(".")){const u=a.split(".");i.second=parseFloat(u[0]),i.millis=parseInt(u[1],10)}else i.second=parseFloat(a)}const dr="esri.core.sql.SqlInterval";class P{constructor(){this.declaredRootClass=dr,this.op="+",this.day=0,this.second=0,this.hour=0,this.month=0,this.year=0,this.minute=0,this.millis=0}static isInterval(a){return typeof a=="object"&&a!=null&&"declaredRootClass"in a&&a.declaredRootClass===dr}static createFromMilliseconds(a){const u=new P;return u.second=a/1e3,u}static createFromValueAndQualifier(a,u,e){let l=null;const v=new P;if(v.op=e==="-"?"-":"+",u.type==="interval-period"){Yt(u);const g=new RegExp("^[0-9]{1,}$");if(u.period==="year"||u.period==="month")throw new m(d.YearMonthIntervals);if(u.period==="second"){if(!/^[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/.test(a))throw new m(d.IllegalInterval);bt(v,a)}else{if(!g.test(a))throw new m(d.IllegalInterval);v[u.period]=parseFloat(a)}}else{if(Yt(u.start),Yt(u.end),u.start.period==="year"||u.start.period==="month"||u.end.period==="year"||u.end.period==="month")throw new m(d.YearMonthIntervals);switch(u.start.period){case"day":switch(u.end.period){case"hour":if(l=new RegExp("^[0-9]{1,} [0-9]{1,}$"),!l.test(a))throw new m(d.IllegalInterval);v[u.start.period]=parseFloat(a.split(" ")[0]),v[u.end.period]=parseFloat(a.split(" ")[1]);break;case"minute":if(l=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$"),!l.test(a))throw new m(d.IllegalInterval);{v[u.start.period]=parseFloat(a.split(" ")[0]);const g=a.split(" ")[1].split(":");v.hour=parseFloat(g[0]),v.minute=parseFloat(g[1])}break;case"second":if(l=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!l.test(a))throw new m(d.IllegalInterval);{v[u.start.period]=parseFloat(a.split(" ")[0]);const g=a.split(" ")[1].split(":");v.hour=parseFloat(g[0]),v.minute=parseFloat(g[1]),bt(v,g[2])}break;default:throw new m(d.IllegalInterval)}break;case"hour":switch(u.end.period){case"minute":if(l=new RegExp("^[0-9]{1,}:[0-9]{1,}$"),!l.test(a))throw new m(d.IllegalInterval);v.hour=parseFloat(a.split(":")[0]),v.minute=parseFloat(a.split(":")[1]);break;case"second":if(l=new RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!l.test(a))throw new m(d.IllegalInterval);{const g=a.split(":");v.hour=parseFloat(g[0]),v.minute=parseFloat(g[1]),bt(v,g[2])}break;default:throw new m(d.IllegalInterval)}break;case"minute":if(u.end.period!=="second")throw new m(d.IllegalInterval);if(l=new RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!l.test(a))throw new m(d.IllegalInterval);{const g=a.split(":");v.minute=parseFloat(g[0]),bt(v,g[1])}break;default:throw new m(d.IllegalInterval)}}return v}valueInMilliseconds(){return(this.op==="-"?-1:1)*(this.millis+1e3*this.second+60*this.minute*1e3+60*this.hour*60*1e3+24*this.day*60*60*1e3+this.month*(365/12)*24*60*60*1e3+365*this.year*24*60*60*1e3)}}const nl=/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/,al=/^(\d{1,2}):(\d{1,2})$/,il=/^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/,gr=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,ol=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$/,ul=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|-)(\d{1,2}):(\d{1,2})$/,sl=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|-)(\d{1,2}):(\d{1,2})$/,ll=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/;function Pt(i,a){if(a instanceof Gs)return a===Ht.instance?V.fromMillis(i.getTime(),{zone:Ht.instance}):V.fromJSDate(i,{zone:a});switch(a){case"system":case"local":case null:return V.fromJSDate(i);default:return(a==null?void 0:a.toLowerCase())==="unknown"?V.fromMillis(i.getTime(),{zone:Ht.instance}):V.fromJSDate(i,{zone:a})}}function K(i){return P.isInterval(i)}function $(i){return V.isDateTime(i)}function b(i){return j.isDateOnly(i)}function D(i){return z.isTimeOnly(i)}function F(i){return B.isTimestampOffset(i)}function re(i){let a=nl.exec(i);if(a!==null){const[,u,e,l]=a,v=z.fromParts(parseInt(u,10),parseInt(e,10),parseInt(l,10),0);if(v!==null)return v;throw new m(d.InvalidTime)}if(a=al.exec(i),a!==null){const[,u,e]=a,l=z.fromParts(parseInt(u,10),parseInt(e,10),0,0);if(l!==null)return l;throw new m(d.InvalidTime)}if(a=il.exec(i),a!==null){const[,u,e,l,v]=a,g=z.fromParts(parseInt(u,10),parseInt(e,10),parseInt(l,10),parseInt(v,10));if(g!==null)return g;throw new m(d.InvalidTime)}throw new m(d.InvalidTime)}function Lt(i,a,u=!1){let e=ol.exec(i);if(e!==null){const[,l,v,g,C,N,y,S]=e,A=V.fromObject({year:parseInt(l,10),month:parseInt(v,10),day:parseInt(g,10),hour:parseInt(C,10),minute:parseInt(N,10),second:parseInt(y,10),millisecond:S?parseInt(S.replace(".",""),10):0},{zone:jt(a)});if(A.isValid===!1)throw new m(d.InvalidTimeStamp);return A}if(e=ul.exec(i),e!==null){const[,l,v,g,C,N,y,S,A,M,X]=e,tt=B.fromParts(parseInt(l,10),parseInt(v,10),parseInt(g,10),parseInt(C,10),parseInt(N,10),parseInt(y,10),S?parseInt(S.replace(".",""),10):0,A==="-",parseInt(M,10),parseInt(X,10));if(tt.isValid===!1)throw new m(d.InvalidTimeStamp);return tt}if(e=sl.exec(i),e!==null){const[,l,v,g,C,N,y,S,A]=e,M=B.fromParts(parseInt(l,10),parseInt(v,10),parseInt(g,10),parseInt(C,10),parseInt(N,10),0,0,y==="-",parseInt(S,10),parseInt(A,10));if(M.isValid===!1)throw new m(d.InvalidTimeStamp);return M}if(e=ll.exec(i),e!==null){const[,l,v,g,C,N]=e,y=V.fromObject({year:parseInt(l,10),month:parseInt(v,10),day:parseInt(g,10),hour:parseInt(C,10),minute:parseInt(N,10),second:0},{zone:jt(a)});if(y.isValid===!1)throw new m(d.InvalidTimeStamp);return y}if(e=gr.exec(i),e!==null){const[,l,v,g]=e,C=V.fromObject({year:parseInt(l,10),month:parseInt(v,10),day:parseInt(g,10),hour:0,minute:0,second:0},{zone:jt(a)});if(C.isValid===!1)throw new m(d.InvalidTimeStamp);return C}throw new m(d.InvalidTimeStamp)}function yr(i,a){const u=gr.exec(i);if(u===null)try{return Lt(i,a)}catch{throw new m(d.InvalidDate)}const[,e,l,v]=u,g=j.fromParts(parseInt(e,10),parseInt(l,10),parseInt(v,10));if(g===null)throw new m(d.InvalidDate);return g}const cl=321408e5,fl=26784e5,dl=864e5,pl=36e5,ml=6e4;function Qt(i){return!!$(i)||!!F(i)}function Wt(i){return!!$(i)||!!b(i)||!!F(i)||!!D(i)}function Ft(i){if($(i))return i.toMillis();if(b(i))return i.toNumber();if(F(i))return i.toMilliseconds();throw new m(d.InvalidDataType)}function Z(i,a,u,e){if(i==null||a==null)return null;if(J(i)){if(J(a))return Q(i,a,u);if(U(a))return vl(i,a,u);if(Wt(a))throw new m(d.InvalidOperator);if(b(a))throw new m(d.InvalidOperator)}else if(U(i)){if(J(a))return hl(i,a,u);if(U(a))return wl(i,a,u);if($(a))throw new m(d.InvalidOperator);if(b(a))throw new m(d.InvalidOperator);if(D(a))throw new m(d.InvalidOperator);if(F(a))throw new m(d.InvalidOperator)}else if($(i)){if(Qt(a)){if(dt(i.zone)){if(V.isDateTime(a)&&!dt(a.zone)||B.isTimestampOffset(a))return pt(i,a,u)}else if(V.isDateTime(a)&&dt(a.zone)&&(!dt(i.zone)||B.isTimestampOffset(i)))return pt(i,a,u);return Q(Ft(i),Ft(a),u)}if(U(a))throw new m(d.InvalidOperator);if(b(a))return Il(i,a,u);if(D(a))throw new m(d.InvalidOperator);if(J(a))throw new m(d.InvalidOperator)}else if(b(i)){if(F(a))return Tl(i,a,u);if($(a))return yl(i,a,u);if(U(a))throw new m(d.InvalidOperator);if(b(a))return Q(i.toNumber(),a.toNumber(),u);if(D(a))throw new m(d.InvalidOperator);if(J(a))throw new m(d.InvalidOperator)}else if(D(i)){if(D(a))return Q(i.toNumber(),a.toNumber(),u);if(U(a))throw new m(d.InvalidOperator);if(J(a))throw new m(d.InvalidOperator);if(b(a))throw new m(d.InvalidOperator);if(Qt(a))throw new m(d.InvalidOperator)}else if(F(i)){if(Qt(a))return V.isDateTime(a)&&dt(a.zone)?pt(i,a,u):Q(Ft(i),Ft(a),u);if(U(a))throw new m(d.InvalidOperator);if(b(a))return gl(i,a,u);if(D(a))throw new m(d.InvalidOperator);if(J(a))throw new m(d.InvalidOperator)}switch(u){case"<>":return i!==a;case"=":return i===a;case">":return i>a;case"<":return i<a;case">=":return i>=a;case"<=":return i<=a}}function Q(i,a,u){switch(u){case"<>":return i!==a;case"=":return i===a;case">":return i>a;case"<":return i<a;case">=":return i>=a;case"<=":return i<=a}}function vl(i,a,u){const e=parseFloat(a);if(!isNaN(e))return Q(i,e,u);const l=i.toString();switch(u){case"<>":return l!==a;case"=":return l===a;case">":return l>a;case"<":return l<a;case">=":return l>=a;case"<=":return l<=a}}function hl(i,a,u){const e=parseFloat(i);if(!isNaN(e))return Q(e,a,u);const l=a.toString();switch(u){case"<>":return i!==l;case"=":return i===l;case">":return i>l;case"<":return i<l;case">=":return i>=l;case"<=":return i<=l}}function wl(i,a,u){switch(u){case"<>":return i!==a;case"=":return i===a;case">":return i>a;case"<":return i<a;case">=":return i>=a;case"<=":return i<=a}}function Il(i,a,u){const e=a.toDateTimeLuxon(i.zone);return Q((i=i.startOf("day")).toMillis(),e.toMillis(),u)}function gl(i,a,u){const e=a.toDateTimeLuxon(i.toDateTime().zone);return Q((i=i.startOfDay()).toMilliseconds(),e.toMillis(),u)}function yl(i,a,u){const e=i.toDateTimeLuxon(a.zone);return a=a.startOf("day"),Q(e.toMillis(),a.toMillis(),u)}function Tl(i,a,u){const e=i.toDateTimeLuxon(a.toDateTime().zone);return a=a.startOfDay(),Q(e.toMillis(),a.toMilliseconds(),u)}function pt(i,a,u){B.isTimestampOffset(i)&&(i=i.toDateTime()),B.isTimestampOffset(a)&&(a=a.toDateTime());const e=pr(i),l=pr(a);switch(u){case"<>":return e!==l;case"=":return e===l;case">":return e>l;case"<":return e<l;case">=":return e>=l;case"<=":return e<=l}}function pr(i){return i.year*cl+i.month*fl+i.day*dl+i.hour*pl+i.minute*ml+1e3*i.second+i.millisecond}function ne(i,a,u){const e=Nr[i.toLowerCase()];if(e==null)throw new m(d.FunctionNotRecognized);if(a.length<e.minParams||a.length>e.maxParams)throw new m(d.InvalidParameterCount,{name:i.toUpperCase()});return e.evaluate(a,u)}function Nl(i,a){const u=Nr[i.toLowerCase()];return u!=null&&a>=u.minParams&&a<=u.maxParams}function Bt(i){return!H(i)&&!b(i)&&!$(i)&&!D(i)&&!F(i)}function Tr(i){return b(i)||D(i)?i.toString():F(i)?i.toSQLValue():$(i)?i.millisecond===0?i.toFormat("yyyy-LL-dd HH:mm:ss"):i.toSQL({includeOffset:!1}):H(i)?Tr(V.fromJSDate(i)):i.toString()}function Ol(i){if(H(i))return j.fromDateJS(i);if($(i))return j.fromParts(i.year,i.month,i.day);if(b(i))return i;if(D(i))throw new m(d.CannotCastValue);if(F(i)&&j.fromParts(i.year,i.month,i.day)===null)throw new m(d.CannotCastValue);if(U(i)){const a=j.fromReader(i);if(a!==null&&a.isValid)return a}throw new m(d.CannotCastValue)}function Sl(i,a,u){if(H(i))return Pt(i,a);if($(i))return i;if(b(i))return i.toDateTimeLuxon("unknown");if(D(i))throw new m(d.CannotCastValue);if(F(i))return i;if(U(i))return Lt(i,"unknown",u);throw new m(d.CannotCastValue)}function xl(i){if(H(i))return z.fromDateJS(i);if($(i))return z.fromDateTime(i);if(b(i))throw new m(d.CannotCastValue);if(D(i))return i;if(F(i))return z.fromSqlTimeStampOffset(i);if(U(i))return re(i);throw new m(d.CannotCastValue)}const Nr={extract:{minParams:2,maxParams:2,evaluate:([i,a])=>{if(a==null)return null;if(H(a))switch(i.toUpperCase()){case"SECOND":return a.getSeconds();case"MINUTE":return a.getMinutes();case"HOUR":return a.getHours();case"DAY":return a.getDate();case"MONTH":return a.getMonth()+1;case"YEAR":return a.getFullYear();case"TIMEZONE_HOUR":case"TIMEZONE_MINUTE":return 0}else if($(a))switch(i.toUpperCase()){case"SECOND":return a.second;case"MINUTE":return a.minute;case"HOUR":return a.hour;case"DAY":return a.day;case"MONTH":return a.month;case"YEAR":return a.year;case"TIMEZONE_HOUR":case"TIMEZONE_MINUTE":throw new m(d.InvalidFunctionParameters,{function:"EXTRACT"})}else if(b(a))switch(i.toUpperCase()){case"DAY":return a.day;case"MONTH":return a.month;case"YEAR":return a.year;case"TIMEZONE_HOUR":case"TIMEZONE_MINUTE":throw new m(d.InvalidFunctionParameters,{function:"EXTRACT"})}else if(D(a))switch(i.toUpperCase()){case"SECOND":return a.second;case"MINUTE":return a.minute;case"HOUR":return a.hour}else if(F(a))switch(i.toUpperCase()){case"SECOND":return a.second;case"MINUTE":return a.minute;case"HOUR":return a.hour;case"DAY":return a.day;case"MONTH":return a.month;case"YEAR":return a.year;case"TIMEZONE_HOUR":return a.timezoneOffsetHour;case"TIMEZONE_MINUTE":return a.timezoneOffsetMinutes}throw new m(d.InvalidFunctionParameters,{function:"EXTRACT"})}},substring:{minParams:2,maxParams:3,evaluate:i=>{if(i.length===2){const[a,u]=i;return a==null||u==null?null:a.toString().substring(u-1)}if(i.length===3){const[a,u,e]=i;return a==null||u==null||e==null?null:e<=0?"":a.toString().substring(u-1,u+e-1)}}},position:{minParams:2,maxParams:2,evaluate:([i,a])=>i==null||a==null?null:a.indexOf(i)+1},trim:{minParams:2,maxParams:3,evaluate:i=>{const a=i.length===3,u=a?i[1]:" ",e=a?i[2]:i[1];if(u==null||e==null)return null;const l=`(${Bs(u)})`;switch(i[0]){case"BOTH":return e.replaceAll(new RegExp(`^${l}*|${l}*$`,"g"),"");case"LEADING":return e.replaceAll(new RegExp(`^${l}*`,"g"),"");case"TRAILING":return e.replaceAll(new RegExp(`${l}*$`,"g"),"")}throw new m(d.InvalidFunctionParameters,{function:"TRIM"})}},abs:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.abs(i[0])},ceiling:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.ceil(i[0])},floor:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.floor(i[0])},log:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.log(i[0])},log10:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.log(i[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.sin(i[0])},cos:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.cos(i[0])},tan:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.tan(i[0])},asin:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.asin(i[0])},acos:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.acos(i[0])},atan:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.atan(i[0])},sign:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:i[0]>0?1:i[0]<0?-1:0},power:{minParams:2,maxParams:2,evaluate:i=>i[0]==null||i[1]==null?null:i[0]**i[1]},mod:{minParams:2,maxParams:2,evaluate:i=>i[0]==null||i[1]==null?null:i[0]%i[1]},round:{minParams:1,maxParams:2,evaluate:i=>{const a=i[0],u=i.length===2?10**i[1]:1;return a==null?null:Math.round(a*u)/u}},truncate:{minParams:1,maxParams:2,evaluate:i=>i[0]==null?null:i.length===1||i[1]===0?Math.trunc(i[0]):Ks("trunc",i[0],-Number(i[1]))},char_length:{minParams:1,maxParams:1,evaluate:i=>U(i[0])?i[0].length:0},concat:{minParams:1,maxParams:1/0,evaluate:i=>{let a="";for(let u=0;u<i.length;u++){if(i[u]==null)return null;a+=i[u].toString()}return a}},lower:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:i[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:i[0].toString().toUpperCase()},coalesce:{minParams:1,maxParams:1/0,evaluate:i=>{for(const a of i)if(a!==null)return a;return null}},cosh:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.cosh(i[0])},sinh:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.sinh(i[0])},tanh:{minParams:1,maxParams:1,evaluate:i=>i[0]==null?null:Math.tanh(i[0])},nullif:{minParams:2,maxParams:2,evaluate:(i,a)=>Z(i[0],i[1],"=")?null:i[0]},cast:{minParams:2,maxParams:2,evaluate:(i,a)=>{const u=i[0],e=i[1];if(u===null)return null;switch(e.type){case"integer":{if(!Bt(u))throw new m(d.CannotCastValue);const l=parseInt(u,10);if(isNaN(l))throw new m(d.CannotCastValue);return l}case"smallint":{if(!Bt(u))throw new m(d.CannotCastValue);const l=parseInt(u,10);if(isNaN(l))throw new m(d.CannotCastValue);if(l>32767||l<-32767)throw new m(d.CannotCastValue);return l}case"float":case"real":{if(!Bt(u))throw new m(d.CannotCastValue);const l=parseFloat(u);if(isNaN(l))throw new m(d.CannotCastValue);return l}case"time":return xl(u);case"date":return Ol(u);case"timestamp":return Sl(u,a,e.withtimezone===!0);case"varchar":{const l=Tr(u);if(l.length>e.size)throw new m(d.CannotCastValue);return l}default:throw new m(d.InvalidDataType)}}}};function Or(i,a,u,e){if(i==="||")return ne("concat",[a,u],e);if(a===null||u===null)return null;if(J(a)){if(J(u))return ae(a,u,i);if(K(u))return Dl(a,u,i);if(D(u))return kl();if(b(u))return ql();if(F(u))return zl();if($(u))return Jl();if(U(u))return Hl(a,u,i);throw new m(d.InvalidOperator)}if(b(a)){if(J(u))return Ul(a,u,i);if(K(u))return Pl(a,u,i);if(D(u))return Xl();if(b(u))return Kl(a,u,i);if(F(u))return Wl(a,u,i);if($(u))return Gl(a,u,i);if(U(u))return dc();throw new m(d.InvalidOperator)}if(D(a)){if(J(u))return Vl(a,u,i);if(K(u))return $l(a,u,i);if(D(u))return uc();if(b(u))return ic();if(F(u))return oc();if($(u))return ac();if(U(u))return pc();throw new m(d.InvalidOperator)}if(K(a)){if(J(u))return Al(a,u,i);if(K(u))return Fl(a,u,i);if(D(u))return Ml(a,u,i);if(b(u))return El(a,u,i);if(F(u))return bl(a,u,i);if($(u))return Cl(a,u,i);if(U(u))return Ql();throw new m(d.InvalidOperator)}if($(a)){if(J(u))return _l(a,u,i);if(K(u))return Ll(a,u,i);if(D(u))return fc();if(b(u))return lc(a,u,i);if(F(u))return cc(a,u,i);if($(u))return sc(a,u,i);if(U(u))return mc();throw new m(d.InvalidOperator)}if(F(a)){if(J(u))return Zl(a,u,i);if(K(u))return Rl(a,u,i);if(D(u))return tc();if(b(u))return ec(a,u,i);if(F(u))return nc(a,u,i);if($(u))return rc(a,u,i);if(U(u))return vc();throw new m(d.InvalidOperator)}if(U(a)){if(J(u))return jl(a,u,i);if(K(u))return Bl();if(D(u))return hc();if(b(u))return wc();if(F(u))return gc();if($(u))return Ic();if(U(u))return Yl(a,u,i);throw new m(d.InvalidOperator)}throw new m(d.InvalidOperator)}function ae(i,a,u){switch(u){case"+":return i+a;case"-":return i-a;case"*":return i*a;case"/":return i/a}throw new m(d.InvalidOperator)}function Cl(i,a,u){switch(u){case"+":return a.plus({milliseconds:i.valueInMilliseconds()});case"-":return i.valueInMilliseconds()-a.toMillis()}throw new m(d.InvalidOperator)}function Ml(i,a,u){if(u==="+")return a.plus("milliseconds",i.valueInMilliseconds());throw new m(d.InvalidOperator)}function El(i,a,u){if(u==="+")return a.plus("milliseconds",i.valueInMilliseconds());throw new m(d.InvalidOperator)}function $l(i,a,u){switch(u){case"+":return i.plus("milliseconds",a.valueInMilliseconds());case"-":return i.plus("milliseconds",-1*a.valueInMilliseconds())}throw new m(d.InvalidOperator)}function bl(i,a,u){if(u==="+")return a.addMilliseconds(i.valueInMilliseconds());throw new m(d.InvalidOperator)}function Fl(i,a,u){switch(u){case"+":return P.createFromMilliseconds(i.valueInMilliseconds()+a.valueInMilliseconds());case"-":return P.createFromMilliseconds(i.valueInMilliseconds()-a.valueInMilliseconds());case"*":return P.createFromMilliseconds(i.valueInMilliseconds()*a.valueInMilliseconds());case"/":return P.createFromMilliseconds(i.valueInMilliseconds()/a.valueInMilliseconds())}throw new m(d.InvalidOperator)}function Al(i,a,u){switch(u){case"+":return P.createFromMilliseconds(i.valueInMilliseconds()+a);case"-":return P.createFromMilliseconds(i.valueInMilliseconds()-a);case"*":return P.createFromMilliseconds(i.valueInMilliseconds()*a);case"/":return P.createFromMilliseconds(i.valueInMilliseconds()/a)}throw new m(d.InvalidOperator)}function Dl(i,a,u){switch(u){case"+":return P.createFromMilliseconds(i+a.valueInMilliseconds());case"-":return P.createFromMilliseconds(i-a.valueInMilliseconds());case"*":return P.createFromMilliseconds(i*a.valueInMilliseconds());case"/":return P.createFromMilliseconds(i/a.valueInMilliseconds())}throw new m(d.InvalidOperator)}function Pl(i,a,u){switch(u){case"+":return i.plus("milliseconds",a.valueInMilliseconds());case"-":return i.plus("milliseconds",-1*a.valueInMilliseconds())}throw new m(d.InvalidOperator)}function Ll(i,a,u){switch(u){case"+":return i.plus({milliseconds:a.valueInMilliseconds()});case"-":return i.minus({milliseconds:a.valueInMilliseconds()})}throw new m(d.InvalidOperator)}function Rl(i,a,u){switch(u){case"+":return i.addMilliseconds(a.valueInMilliseconds());case"-":return i.addMilliseconds(-1*a.valueInMilliseconds())}throw new m(d.InvalidOperator)}function _l(i,a,u){const e=1e3*a*24*60*60;switch(u){case"+":return i.plus({milliseconds:e});case"-":return i.minus({milliseconds:e})}throw new m(d.InvalidOperator)}function Ul(i,a,u){const e=1e3*a*24*60*60;switch(u){case"+":return i.plus("milliseconds",e);case"-":return i.plus("milliseconds",-1*e)}throw new m(d.InvalidOperator)}function Vl(i,a,u){const e=1e3*a*24*60*60;switch(u){case"+":return i.plus("milliseconds",e);case"-":return i.plus("milliseconds",-1*e)}throw new m(d.InvalidOperator)}function Jl(i,a,u){throw new m(d.InvalidOperator)}function Zl(i,a,u){const e=1e3*a*24*60*60;switch(u){case"+":return i.addMilliseconds(e);case"-":return i.addMilliseconds(-1*e)}throw new m(d.InvalidOperator)}function zl(i,a,u){throw new m(d.InvalidOperator)}function kl(i,a,u){throw new m(d.InvalidOperator)}function ql(i,a,u){throw new m(d.InvalidOperator)}function Hl(i,a,u){const e=parseFloat(a);if(isNaN(e))throw new m(d.InvalidOperator);return ae(i,e,u)}function jl(i,a,u){const e=parseFloat(i);if(isNaN(e))throw new m(d.InvalidOperator);return ae(e,a,u)}function Yl(i,a,u){if(u==="+")return i+a;throw new m(d.InvalidOperator)}function Ql(i,a,u){throw new m(d.InvalidOperator)}function Bl(i,a,u){throw new m(d.InvalidOperator)}function Gl(i,a,u){if(u==="-")return i.toDateTimeLuxon(a.zone).diff(a).as("days");throw new m(d.InvalidOperator)}function Wl(i,a,u){if(u==="-")return i.toDateTimeLuxon(a.toDateTime().zone).diff(a.toDateTime()).as("days");throw new m(d.InvalidOperator)}function Kl(i,a,u){if(u==="-")return i.toDateTimeLuxon("UTC").diff(a.toDateTimeLuxon("UTC")).as("days");throw new m(d.InvalidOperator)}function Xl(i,a,u){throw new m(d.InvalidOperator)}function tc(i,a,u){throw new m(d.InvalidOperator)}function ec(i,a,u){if(u==="-")return i.toDateTime().diff(a.toDateTimeLuxon(i.toDateTime().zone)).as("days");throw new m(d.InvalidOperator)}function rc(i,a,u){if(u==="-")return i.toDateTime().diff(a).as("days");throw new m(d.InvalidOperator)}function nc(i,a,u){if(u==="-")return i.toDateTime().diff(a.toDateTime()).as("days");throw new m(d.InvalidOperator)}function ac(i,a,u){throw new m(d.InvalidOperator)}function ic(i,a,u){throw new m(d.InvalidOperator)}function oc(i,a,u){throw new m(d.InvalidOperator)}function uc(i,a,u){throw new m(d.InvalidOperator)}function sc(i,a,u){if(u==="-")return i.diff(a).as("days");throw new m(d.InvalidOperator)}function lc(i,a,u){if(u==="-")return i.diff(a.toDateTimeLuxon(i.zone)).as("days");throw new m(d.InvalidOperator)}function cc(i,a,u){if(u==="-")return i.diff(a.toDateTime()).as("days");throw new m(d.InvalidOperator)}function fc(i,a,u){throw new m(d.InvalidOperator)}function dc(i,a,u){throw new m(d.InvalidOperator)}function pc(i,a,u){throw new m(d.InvalidOperator)}function mc(i,a,u){throw new m(d.InvalidOperator)}function vc(i,a,u){throw new m(d.InvalidOperator)}function hc(i,a,u){throw new m(d.InvalidOperator)}function wc(i,a,u){throw new m(d.InvalidOperator)}function Ic(i,a,u){throw new m(d.InvalidOperator)}function gc(i,a,u){throw new m(d.InvalidOperator)}function yc(i,a){function u(){this.constructor=i}u.prototype=a.prototype,i.prototype=new u}function ot(i,a,u,e){var l=Error.call(this,i);return Object.setPrototypeOf&&Object.setPrototypeOf(l,ot.prototype),l.expected=a,l.found=u,l.location=e,l.name="SyntaxError",l}function Gt(i,a,u){return u=u||" ",i.length>a?i:(a-=i.length,i+(u+=u.repeat(a)).slice(0,a))}function Tc(i,a){var u,e={},l=(a=a!==void 0?a:{}).grammarSource,v={start:Se},g=Se,C="!",N="=",y=">=",S=">",A="<=",M="<>",X="!=",tt="||",$r="@",ie="'",oe="N'",vt="''",br=".",Fr="null",Ar="true",Dr="false",Pr="in",Lr="is",Rr="like",_r="escape",Ur="not",Vr="and",Jr="or",Zr="between",zr="from",kr="for",qr="substring",Hr="extract",jr="trim",Yr="position",Qr="timestamp",Br="date",Gr="time",Wr="leading",Kr="trailing",Xr="both",tn="cast",en="as",rn="integer",nn="int",an="smallint",on="float",un="real",sn="varchar",ln="to",cn="interval",fn="year",dn="timezone_hour",pn="timezone_minute",mn="month",vn="day",hn="hour",wn="minute",In="second",gn="case",yn="end",Tn="when",Nn="then",On="else",Sn=",",xn="(",Cn=")",ue="`",Mn=/^[<-=]/,ht=/^[+\-]/,En=/^[*\/]/,$n=/^[A-Za-z_\x80-\uFFFF]/,bn=/^[A-Za-z0-9_]/,se=/^[A-Za-z0-9_.\x80-\uFFFF]/,Fn=/^["]/,le=/^[^']/,An=/^[0-9]/,Dn=/^[eE]/,Pn=/^[ \t\n\r]/,ce=/^[^`]/,Ln=T("!",!1),Rn=T("=",!1),_n=T(">=",!1),Un=T(">",!1),Vn=T("<=",!1),Jn=T("<>",!1),Zn=k([["<","="]],!1,!1),zn=T("!=",!1),wt=k(["+","-"],!1,!1),kn=T("||",!1),qn=k(["*","/"],!1,!1),Hn=k([["A","Z"],["a","z"],"_",["","￿"]],!1,!1),jn=k([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),fe=k([["A","Z"],["a","z"],["0","9"],"_",".",["","￿"]],!1,!1),Yn=k(['"'],!1,!1),Qn=T("@",!1),de=T("'",!1),Bn=T("N'",!1),pe=T("''",!1),me=k(["'"],!0,!1),Gn=T(".",!1),Wn=k([["0","9"]],!1,!1),Kn=k(["e","E"],!1,!1),Xn=T("NULL",!0),ta=T("TRUE",!0),ea=T("FALSE",!0),ra=T("IN",!0),na=T("IS",!0),aa=T("LIKE",!0),ia=T("ESCAPE",!0),oa=T("NOT",!0),ua=T("AND",!0),sa=T("OR",!0),la=T("BETWEEN",!0),ca=T("FROM",!0),fa=T("FOR",!0),da=T("SUBSTRING",!0),pa=T("EXTRACT",!0),ma=T("TRIM",!0),va=T("POSITION",!0),ha=T("TIMESTAMP",!0),wa=T("DATE",!0),Ia=T("TIME",!0),ga=T("LEADING",!0),ya=T("TRAILING",!0),Ta=T("BOTH",!0),Na=T("CAST",!0),Oa=T("AS",!0),Sa=T("INTEGER",!0),xa=T("INT",!0),Ca=T("SMALLINT",!0),Ma=T("FLOAT",!0),Ea=T("REAL",!0),$a=T("VARCHAR",!0),ba=T("TO",!0),Fa=T("INTERVAL",!0),Aa=T("YEAR",!0),Da=T("TIMEZONE_HOUR",!0),Pa=T("TIMEZONE_MINUTE",!0),La=T("MONTH",!0),Ra=T("DAY",!0),_a=T("HOUR",!0),Ua=T("MINUTE",!0),Va=T("SECOND",!0),Ja=T("CASE",!0),Za=T("END",!0),za=T("WHEN",!0),ka=T("THEN",!0),qa=T("ELSE",!0),Ha=T(",",!1),ja=T("(",!1),Ya=T(")",!1),Qa=k([" ","	",`
`,"\r"],!1,!1),ve=T("`",!1),he=k(["`"],!0,!1),Ba=function(t){return t},Ga=function(t){return{type:"expression-list",location:I(),value:t}},we=function(t,r,o){return{op:r,expr:o,location:I()}},Wa=function(t,r){return ft(t,r)},Ie=function(t,r,o){return{op:r,expr:o,location:I()}},Ka=function(t,r){return ft(t,r)},Xa=function(t){return qs("NOT",t,I())},ti=function(t,r){return r==""||r==null||r==null?t:r.type=="arithmetic"?ft(t,r.tail):ir(r.op,t,r.right,r.escape,I())},ge=function(t,r){return{op:t,expr:r,location:I()}},ei=function(t){return{type:"arithmetic",tail:t}},ri=function(t,r){return{op:t+"NOT",right:r}},ni=function(t,r){return{op:t,right:r}},ai=function(t,r,o){return q(I(),r,o)},ii=function(t,r){return{op:"NOT"+t,right:r}},oi=function(t,r,o){return q(I(),r,o)},ui=function(t,r){return{op:t,right:r}},si=function(t){return t[0]+" "+t[2]},li=function(t){return t[0]+" "+t[2]},ci=function(t,r,o){return{op:t,right:r,escape:o.value}},fi=function(t,r){return{op:t,right:r,escape:""}},di=function(t,r){return{op:t,right:r}},pi=function(t,r){return{op:t,right:r}},ye=function(t,r,o){return{op:r,expr:o,location:I()}},mi=function(t,r){return ft(t,r)},Te=function(t,r,o){return{op:r,expr:o,location:I()}},vi=function(t,r){return ft(t,r)},hi=function(t){return t.paren=!0,t},wi=function(t){return/^CURRENT_DATE$/i.test(t)?{type:"current-time",location:I(),mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(t)?{type:"current-time",location:I(),mode:"timestamp"}:/^CURRENT_TIME$/i.test(t)?{type:"current-time",location:I(),mode:"time"}:/^CURRENT_USER$/i.test(t)?{type:"current-user",location:I()}:{type:"column-reference",location:I(),table:"",column:t}},Ii=function(t){return{type:"column-reference",location:I(),table:"",column:t,delimited:!0}},gi=function(t){return t},yi=function(t,r){return t+r.join("")},Ti=function(t,r){return t+r.join("")},Ni=function(t){return t},Oi=function(t){return t.join("")},Si=function(){return'"'},xi=function(t){return{type:"parameter",location:I(),value:t[1]}},Ci=function(t,r){return q(I(),t,r)},Mi=function(t,r){return q(I(),t,r)},Ei=function(t){return{type:"function",location:I(),name:"extract",args:t}},$i=function(t,r,o){return q(I(),t,r,...o?[o]:[])},bi=function(t,r,o){return q(I(),t,r,o)},Fi=function(t){return{type:"function",location:I(),name:"substring",args:t}},Ai=function(t,r){return q(I(),t,r)},Di=function(t,r){return q(I(),t,r)},Pi=function(t){return{type:"function",location:I(),name:"cast",args:t}},Li=function(){return{type:"data-type",location:I(),value:{type:"integer"}}},Ri=function(){return{type:"data-type",location:I(),value:{type:"smallint"}}},_i=function(){return{type:"data-type",location:I(),value:{type:"float"}}},Ui=function(){return{type:"data-type",location:I(),value:{type:"real"}}},Vi=function(){return{type:"data-type",location:I(),value:{type:"date"}}},Ji=function(){return{type:"data-type",location:I(),value:{type:"timestamp"}}},Zi=function(){return{type:"data-type",location:I(),value:{type:"time"}}},zi=function(t){return{type:"data-type",location:I(),value:{type:"varchar",size:parseInt(t)}}},ki=function(t,r,o){return q(I(),t,r,o)},qi=function(t,r){return q(I(),t,r)},Hi=function(t){return{type:"function",location:I(),name:"trim",args:t}},ji=function(t){return{type:"string",location:I(),value:t??"BOTH"}},Yi=function(t,r){return q(I(),t,r)},Qi=function(t,r){return q(I(),t,r)},Bi=function(t){return{type:"function",location:I(),name:"position",args:t}},Gi=function(t,r){return{type:"function",location:I(),name:t,args:r}},Wi=function(t){return{type:"string",location:I(),value:t}},Ki=function(t){return t.type==="string"&&Hs(t.value),{type:"timestamp",location:I(),value:t.value}},Xi=function(t){return t.type==="string"&&js(t.value),{type:"time",location:I(),value:t.value}},to=function(t,r,o){return{type:"interval",location:I(),value:r,qualifier:o,op:t}},eo=function(t,r){return{type:"interval",location:I(),value:t,qualifier:r,op:""}},ro=function(t,r){return{type:"interval-qualifier",location:I(),start:t,end:r}},no=function(t,r){return{type:"interval-period",location:I(),period:t.value,precision:r,secondary:null}},ao=function(t){return{type:"interval-period",location:I(),period:t.value,precision:null,secondary:null}},io=function(t){return{type:"interval-period",location:I(),period:t.value,precision:null,secondary:null}},oo=function(t,r){return{type:"interval-period",location:I(),period:"second",precision:t,secondary:r}},uo=function(t){return{type:"interval-period",location:I(),period:"second",precision:t,secondary:null}},so=function(){return{type:"interval-period",location:I(),period:"second",precision:null,secondary:null}},lo=function(t,r){return{type:"interval-period",location:I(),period:t.value,precision:r,secondary:null}},co=function(t){return{type:"interval-period",location:I(),period:t.value,precision:null,secondary:null}},fo=function(t,r){return{type:"interval-period",location:I(),period:"second",precision:t,secondary:r}},po=function(t){return{type:"interval-period",location:I(),period:"second",precision:t,secondary:null}},mo=function(){return{type:"interval-period",location:I(),period:"second",precision:null,secondary:null}},vo=function(){return{type:"string",location:I(),value:"day"}},ho=function(){return{type:"string",location:I(),value:"hour"}},wo=function(){return{type:"string",location:I(),value:"minute"}},Io=function(){return{type:"string",location:I(),value:"month"}},go=function(){return{type:"string",location:I(),value:"year"}},yo=function(t){return parseFloat(t)},To=function(t){return parseFloat(t)},No=function(t){return t.type==="string"&&Ys(t.value),{type:"date",location:I(),value:t.value}},Oo=function(){return{type:"null",location:I(),value:null}},So=function(){return{type:"boolean",location:I(),value:!0}},xo=function(){return{type:"boolean",location:I(),value:!1}},Ne=function(){return"'"},Co=function(t){return{type:"string",location:I(),value:t.join("")}},Mo=function(t,r){return{type:"case-expression",location:I(),format:"simple",operand:t,clauses:r,else:null,elseLocation:null}},Eo=function(t,r,o){return{type:"case-expression",location:I(),format:"simple",operand:t,clauses:r,else:o.value,elseLocation:o.location}},$o=function(t){return{type:"case-expression",location:I(),format:"searched",clauses:t,else:null,elseLocation:null}},bo=function(t,r){return{type:"case-expression",location:I(),format:"searched",clauses:t,else:r.value,elseLocation:r.location}},Fo=function(t,r){return{type:"when-clause",location:I(),operand:t,value:r}},Ao=function(t,r){return{type:"when-clause",location:I(),operand:t,value:r}},Do=function(t){return{type:"else-clause",location:I(),value:t}},Po=function(t){return{type:"number",location:I(),value:t}},Lo=function(t,r,o){return parseFloat(t+r+o)},Ro=function(t,r){return parseFloat(t+r)},_o=function(t,r){return parseFloat(t+r)},Uo=function(t){return parseFloat(t)},Vo=function(t,r){return t[0]+r},Jo=function(t){return"."+(t??"")},Zo=function(t,r){return t+r},zo=function(t){return t.join("")},ko=function(t,r){return"e"+(r===null?"":r)},qo=function(){return"IN"},Ho=function(){return"IS"},jo=function(){return"LIKE"},Yo=function(){return"ESCAPE"},Qo=function(){return"NOT"},Bo=function(){return"AND"},Go=function(){return"OR"},Wo=function(){return"BETWEEN"},Ko=function(){return"FROM"},Xo=function(){return"FOR"},tu=function(){return"SUBSTRING"},eu=function(){return"EXTRACT"},ru=function(){return"TRIM"},nu=function(){return"POSITION"},au=function(){return"TIMESTAMP"},iu=function(){return"DATE"},ou=function(){return"TIME"},uu=function(){return"LEADING"},su=function(){return"TRAILING"},lu=function(){return"BOTH"},cu=function(){return"CAST"},fu=function(){return"AS"},du=function(){return"INTEGER"},pu=function(){return"INT"},mu=function(){return"SMALLINT"},vu=function(){return"FLOAT"},hu=function(){return"REAL"},wu=function(){return"VARCHAR"},Iu=function(){return"TO"},gu=function(){return"INTERVAL"},yu=function(){return"YEAR"},Tu=function(){return"TIMEZONE_HOUR"},Nu=function(){return"TIMEZONE_MINUTE"},Ou=function(){return"MONTH"},Su=function(){return"DAY"},xu=function(){return"HOUR"},Cu=function(){return"MINUTE"},Mu=function(){return"SECOND"},Eu=function(){return"CASE"},$u=function(){return"END"},bu=function(){return"WHEN"},Fu=function(){return"THEN"},Au=function(){return"ELSE"},Du=function(t){return t},Pu=function(t){return t.join("")},n=0|a.peg$currPos,f=n,ut=[{line:1,column:1}],Y=n,It=a.peg$maxFailExpected||[],c=0|a.peg$silentFails;if(a.startRule){if(!(a.startRule in v))throw new Error(`Can't start parsing from rule "`+a.startRule+'".');g=v[a.startRule]}function I(){return gt(f,n)}function Rt(t,r){throw Ru(t,r=r!==void 0?r:gt(f,n))}function T(t,r){return{type:"literal",text:t,ignoreCase:r}}function k(t,r,o){return{type:"class",parts:t,inverted:r,ignoreCase:o}}function Lu(){return{type:"end"}}function Oe(t){var r,o=ut[t];if(o)return o;if(t>=ut.length)r=ut.length-1;else for(r=t;!ut[--r];);for(o={line:(o=ut[r]).line,column:o.column};r<t;)i.charCodeAt(r)===10?(o.line++,o.column=1):o.column++,r++;return ut[t]=o,o}function gt(t,r,o){var s=Oe(t),h=Oe(r);return{source:l,start:{offset:t,line:s.line,column:s.column},end:{offset:r,line:h.line,column:h.column}}}function w(t){n<Y||(n>Y&&(Y=n,It=[]),It.push(t))}function Ru(t,r){return new ot(t,null,null,r)}function _u(t,r,o){return new ot(ot.buildMessage(t,r),t,r,o)}function Se(){var t,r;return t=n,p(),(r=E())!==e?(p(),f=t,t=Ba(r)):(n=t,t=e),t}function xe(){var t,r,o,s,h,x;if(t=n,L()!==e){for(p(),r=[],o=E();o!==e;)r.push(o),o=n,s=n,h=p(),(x=W())!==e?s=h=[h,x,p()]:(n=s,s=e),s!==e&&(s=E())===e?(n=o,o=e):o=s;o=p(),(s=R())!==e?(f=t,t=Ga(r)):(n=t,t=e)}else n=t,t=e;return t}function E(){var t,r,o,s,h,x;if(t=n,(r=_t())!==e){for(o=[],s=n,p(),(h=qe())!==e?(p(),(x=_t())!==e?(f=s,s=we(r,h,x)):(n=s,s=e)):(n=s,s=e);s!==e;)o.push(s),s=n,p(),(h=qe())!==e?(p(),(x=_t())!==e?(f=s,s=we(r,h,x)):(n=s,s=e)):(n=s,s=e);f=t,t=Wa(r,o)}else n=t,t=e;return t}function _t(){var t,r,o,s,h,x;if(t=n,(r=yt())!==e){for(o=[],s=n,p(),(h=Mt())!==e?(p(),(x=yt())!==e?(f=s,s=Ie(r,h,x)):(n=s,s=e)):(n=s,s=e);s!==e;)o.push(s),s=n,p(),(h=Mt())!==e?(p(),(x=yt())!==e?(f=s,s=Ie(r,h,x)):(n=s,s=e)):(n=s,s=e);f=t,t=Ka(r,o)}else n=t,t=e;return t}function yt(){var t,r,o,s,h;return t=n,(r=ct())===e&&(r=n,i.charCodeAt(n)===33?(o=C,n++):(o=e,c===0&&w(Ln)),o!==e?(s=n,c++,i.charCodeAt(n)===61?(h=N,n++):(h=e,c===0&&w(Rn)),c--,h===e?s=void 0:(n=s,s=e),s!==e?r=o=[o,s]:(n=r,r=e)):(n=r,r=e)),r!==e?(o=p(),(s=yt())!==e?(f=t,t=Xa(s)):(n=t,t=e)):(n=t,t=e),t===e&&(t=Uu()),t}function Uu(){var t,r,o,s;return t=n,(r=G())!==e?(o=n,p(),(s=Vu())!==e?o=s:(n=o,o=e),o===e&&(o=null),f=t,t=ti(r,o)):(n=t,t=e),t}function Vu(){var t;return(t=Ju())===e&&(t=qu())===e&&(t=zu())===e&&(t=Zu())===e&&(t=ku()),t}function Ju(){var t,r,o,s,h;if(t=n,r=[],o=n,p(),(s=Ce())!==e?(p(),(h=G())!==e?(f=o,o=ge(s,h)):(n=o,o=e)):(n=o,o=e),o!==e)for(;o!==e;)r.push(o),o=n,p(),(s=Ce())!==e?(p(),(h=G())!==e?(f=o,o=ge(s,h)):(n=o,o=e)):(n=o,o=e);else r=e;return r!==e&&(f=t,r=ei(r)),t=r}function Ce(){var t;return i.substr(n,2)===y?(t=y,n+=2):(t=e,c===0&&w(_n)),t===e&&(i.charCodeAt(n)===62?(t=S,n++):(t=e,c===0&&w(Un)),t===e&&(i.substr(n,2)===A?(t=A,n+=2):(t=e,c===0&&w(Vn)),t===e&&(i.substr(n,2)===M?(t=M,n+=2):(t=e,c===0&&w(Jn)),t===e&&(t=i.charAt(n),Mn.test(t)?n++:(t=e,c===0&&w(Zn)),t===e&&(i.substr(n,2)===X?(t=X,n+=2):(t=e,c===0&&w(zn))))))),t}function Zu(){var t,r,o,s;return t=n,(r=ze())!==e?(p(),(o=ct())!==e?(p(),(s=G())!==e?(f=t,t=ri(r,s)):(n=t,t=e)):(n=t,t=e)):(n=t,t=e),t===e&&(t=n,(r=ze())!==e?(p(),(o=G())!==e?(f=t,t=ni(r,o)):(n=t,t=e)):(n=t,t=e)),t}function zu(){var t,r,o,s,h,x,at,or;return t=n,(r=ct())!==e?(p(),(o=He())!==e?(s=p(),h=n,(x=G())!==e?(p(),(at=Mt())!==e?(p(),(or=G())!==e?(f=h,h=ai(o,x,or)):(n=h,h=e)):(n=h,h=e)):(n=h,h=e),h!==e?(f=t,t=ii(o,h)):(n=t,t=e)):(n=t,t=e)):(n=t,t=e),t===e&&(t=n,(r=He())!==e?(p(),o=n,(s=G())!==e?(h=p(),(x=Mt())!==e?(p(),(at=G())!==e?(f=o,o=oi(r,s,at)):(n=o,o=e)):(n=o,o=e)):(n=o,o=e),o!==e?(f=t,t=ui(r,o)):(n=t,t=e)):(n=t,t=e)),t}function Me(){var t,r,o,s,h;return t=n,r=n,(o=ct())!==e?(s=p(),(h=ke())!==e?r=o=[o,s,h]:(n=r,r=e)):(n=r,r=e),r!==e&&(f=t,r=si(r)),(t=r)===e&&(t=ke()),t}function Ee(){var t,r,o,s,h;return t=n,r=n,(o=ct())!==e?(s=p(),(h=kt())!==e?r=o=[o,s,h]:(n=r,r=e)):(n=r,r=e),r!==e&&(f=t,r=li(r)),(t=r)===e&&(t=kt()),t}function ku(){var t,r,o,s;return t=n,(r=Me())!==e?(p(),(o=et())!==e?(p(),Os()!==e?(p(),(s=zt())!==e?(f=t,t=ci(r,o,s)):(n=t,t=e)):(n=t,t=e)):(n=t,t=e)):(n=t,t=e),t===e&&(t=n,(r=Me())!==e?(p(),(o=et())!==e?(f=t,t=fi(r,o)):(n=t,t=e)):(n=t,t=e)),t}function qu(){var t,r,o;return t=n,(r=Ee())!==e?(p(),(o=xe())!==e?(f=t,t=di(r,o)):(n=t,t=e)):(n=t,t=e),t===e&&(t=n,(r=Ee())!==e?(p(),(o=Zt())!==e?(f=t,t=pi(r,o)):(n=t,t=e)):(n=t,t=e)),t}function G(){var t,r,o,s,h,x;if(t=n,(r=Ut())!==e){for(o=[],s=n,p(),(h=$e())!==e?(p(),(x=Ut())!==e?(f=s,s=ye(r,h,x)):(n=s,s=e)):(n=s,s=e);s!==e;)o.push(s),s=n,p(),(h=$e())!==e?(p(),(x=Ut())!==e?(f=s,s=ye(r,h,x)):(n=s,s=e)):(n=s,s=e);f=t,t=mi(r,o)}else n=t,t=e;return t}function $e(){var t;return t=i.charAt(n),ht.test(t)?n++:(t=e,c===0&&w(wt)),t===e&&(i.substr(n,2)===tt?(t=tt,n+=2):(t=e,c===0&&w(kn))),t}function Ut(){var t,r,o,s,h,x;if(t=n,(r=Vt())!==e){for(o=[],s=n,p(),(h=be())!==e?(p(),(x=Vt())!==e?(f=s,s=Te(r,h,x)):(n=s,s=e)):(n=s,s=e);s!==e;)o.push(s),s=n,p(),(h=be())!==e?(p(),(x=Vt())!==e?(f=s,s=Te(r,h,x)):(n=s,s=e)):(n=s,s=e);f=t,t=vi(r,o)}else n=t,t=e;return t}function be(){var t;return t=i.charAt(n),En.test(t)?n++:(t=e,c===0&&w(qn)),t}function Vt(){var t,r;return(t=as())===e&&(t=Ku())===e&&(t=Xu())===e&&(t=es())===e&&(t=rs())===e&&(t=ts())===e&&(t=ns())===e&&(t=ms())===e&&(t=Hu())===e&&(t=Zt())===e&&(t=n,L()!==e?(p(),(r=E())!==e?(p(),R()!==e?(f=t,t=hi(r)):(n=t,t=e)):(n=t,t=e)):(n=t,t=e)),t}function Hu(){var t,r;return t=n,(r=ju())!==e&&(f=t,r=wi(r)),(t=r)===e&&(t=n,(r=Qu())!==e&&(f=t,r=Ii(r)),t=r),t}function ju(){var t,r;return t=n,(r=Yu())!==e&&(f=t,r=gi(r)),t=r}function Yu(){var t,r,o,s;if(t=n,(r=Jt())!==e){for(o=[],s=Ae();s!==e;)o.push(s),s=Ae();f=t,t=yi(r,o)}else n=t,t=e;return t}function Fe(){var t,r,o,s;if(t=n,(r=Jt())!==e){for(o=[],s=O();s!==e;)o.push(s),s=O();f=t,t=Ti(r,o)}else n=t,t=e;return t}function Jt(){var t;return t=i.charAt(n),$n.test(t)?n++:(t=e,c===0&&w(Hn)),t}function O(){var t;return t=i.charAt(n),bn.test(t)?n++:(t=e,c===0&&w(jn)),t}function Ae(){var t;return t=i.charAt(n),se.test(t)?n++:(t=e,c===0&&w(fe)),t}function Qu(){var t,r;return t=n,Tt()!==e?(r=Bu(),Tt()!==e?(f=t,t=Ni(r)):(n=t,t=e)):(n=t,t=e),t}function Bu(){var t,r,o;for(t=n,r=[],o=De();o!==e;)r.push(o),o=De();return f=t,t=r=Oi(r)}function De(){var t;return(t=Wu())===e&&(t=Gu()),t}function Gu(){var t;return t=n,Tt()!==e&&Tt()!==e?(f=t,t=Si()):(n=t,t=e),t}function Wu(){var t;return t=i.charAt(n),se.test(t)?n++:(t=e,c===0&&w(fe)),t}function Tt(){var t;return t=i.charAt(n),Fn.test(t)?n++:(t=e,c===0&&w(Yn)),t}function Zt(){var t,r,o,s;return t=n,r=n,i.charCodeAt(n)===64?(o=$r,n++):(o=e,c===0&&w(Qn)),o!==e&&(s=Fe())!==e?r=o=[o,s]:(n=r,r=e),r!==e&&(f=t,r=xi(r)),t=r}function Ku(){var t,r,o,s;return t=n,je()!==e?(p(),r=n,L()!==e?(p(),(o=Re())!==e?(p(),qt()!==e?(p(),(s=E())!==e?(p(),R()!==e?(f=r,r=Ci(o,s)):(n=r,r=e)):(n=r,r=e)):(n=r,r=e)):(n=r,r=e)):(n=r,r=e),r===e&&(r=n,L()!==e?(p(),(o=Re())!==e?(p(),W()!==e?(p(),(s=E())!==e?(p(),R()!==e?(f=r,r=Mi(o,s)):(n=r,r=e)):(n=r,r=e)):(n=r,r=e)):(n=r,r=e)):(n=r,r=e)),r!==e?(f=t,t=Ei(r)):(n=t,t=e)):(n=t,t=e),t}function Xu(){var t,r,o,s,h,x,at;return t=n,xs()!==e?(p(),r=n,L()!==e?(p(),(o=E())!==e?(p(),qt()!==e?(p(),(s=E())!==e?(p(),h=n,Ss()!==e?(x=p(),(at=E())!==e?(p(),h=at):(n=h,h=e)):(n=h,h=e),h===e&&(h=null),R()!==e?(f=r,r=$i(o,s,h)):(n=r,r=e)):(n=r,r=e)):(n=r,r=e)):(n=r,r=e)):(n=r,r=e),r===e&&(r=n,L()!==e?(p(),(o=E())!==e?(p(),W()!==e?(p(),(s=E())!==e?(p(),(h=W())!==e?(p(),(x=E())!==e&&(at=R())!==e?(f=r,r=bi(o,s,x)):(n=r,r=e)):(n=r,r=e)):(n=r,r=e)):(n=r,r=e)):(n=r,r=e)):(n=r,r=e)),r!==e?(f=t,t=Fi(r)):(n=t,t=e)):(n=t,t=e),t}function ts(){var t,r,o,s;return t=n,Fs()!==e?(p(),r=n,L()!==e?(p(),(o=E())!==e?(p(),As()!==e?(p(),(s=Pe())!==e?(p(),R()!==e?(f=r,r=Ai(o,s)):(n=r,r=e)):(n=r,r=e)):(n=r,r=e)):(n=r,r=e)):(n=r,r=e),r===e&&(r=n,L()!==e?(p(),(o=E())!==e?(p(),W()!==e?(p(),(s=Pe())!==e?(p(),R()!==e?(f=r,r=Di(o,s)):(n=r,r=e)):(n=r,r=e)):(n=r,r=e)):(n=r,r=e)):(n=r,r=e)),r!==e?(f=t,t=Pi(r)):(n=t,t=e)):(n=t,t=e),t}function Pe(){var t,r,o;return t=n,(r=Ds())===e&&(r=Ps()),r!==e&&(f=t,r=Li()),(t=r)===e&&(t=n,(r=Ls())!==e&&(f=t,r=Ri()),(t=r)===e&&(t=n,(r=Rs())!==e&&(f=t,r=_i()),(t=r)===e&&(t=n,(r=_s())!==e&&(f=t,r=Ui()),(t=r)===e&&(t=n,(r=Qe())!==e&&(f=t,r=Vi()),(t=r)===e&&(t=n,(r=Ye())!==e&&(f=t,r=Ji()),(t=r)===e&&(t=n,(r=Be())!==e&&(f=t,r=Zi()),(t=r)===e&&(t=n,(r=Us())!==e?(p(),L()!==e?(p(),(o=rt())!==e?(p(),R()!==e?(f=t,t=zi(o)):(n=t,t=e)):(n=t,t=e)):(n=t,t=e)):(n=t,t=e)))))))),t}function es(){var t,r,o,s,h;return t=n,Cs()!==e?(p(),r=n,L()!==e?(p(),o=Le(),p(),(s=E())!==e?(p(),qt()!==e?(p(),(h=E())!==e?(p(),R()!==e?(f=r,r=ki(o,s,h)):(n=r,r=e)):(n=r,r=e)):(n=r,r=e)):(n=r,r=e)):(n=r,r=e),r===e&&(r=n,L()!==e?(p(),o=Le(),p(),(s=E())!==e?(p(),R()!==e?(f=r,r=qi(o,s)):(n=r,r=e)):(n=r,r=e)):(n=r,r=e)),r!==e?(f=t,t=Hi(r)):(n=t,t=e)):(n=t,t=e),t}function Le(){var t,r;return t=n,(r=Es())===e&&(r=$s())===e&&(r=bs()),r===e&&(r=null),f=t,t=r=ji(r)}function rs(){var t,r,o,s;return t=n,Ms()!==e?(p(),r=n,L()!==e?(p(),(o=E())!==e?(p(),kt()!==e?(p(),(s=E())!==e?(p(),R()!==e?(f=r,r=Yi(o,s)):(n=r,r=e)):(n=r,r=e)):(n=r,r=e)):(n=r,r=e)):(n=r,r=e),r===e&&(r=n,L()!==e?(p(),(o=E())!==e?(p(),W()!==e?(p(),(s=E())!==e?(p(),R()!==e?(f=r,r=Qi(o,s)):(n=r,r=e)):(n=r,r=e)):(n=r,r=e)):(n=r,r=e)):(n=r,r=e)),r!==e?(f=t,t=Bi(r)):(n=t,t=e)):(n=t,t=e),t}function ns(){var t,r,o,s;return t=n,r=n,c++,o=je(),c--,o===e?r=void 0:(n=r,r=e),r!==e&&(o=ks())!==e?(p(),(s=xe())!==e?(f=t,t=Gi(o,s)):(n=t,t=e)):(n=t,t=e),t}function Re(){var t,r;return t=n,(r=We())===e&&(r=Ke())===e&&(r=Xe())===e&&(r=tr())===e&&(r=er())===e&&(r=nt())===e&&(r=Js())===e&&(r=Zs()),r!==e&&(f=t,r=Wi(r)),t=r}function as(){var t;return(t=zt())===e&&(t=ws())===e&&(t=ps())===e&&(t=ds())===e&&(t=fs())===e&&(t=is())===e&&(t=us())===e&&(t=os()),t}function is(){var t,r;return t=n,Ye()!==e?(p(),(r=et())!==e?(f=t,t=Ki(r)):(n=t,t=e)):(n=t,t=e),t}function os(){var t,r;return t=n,Be()!==e?(p(),(r=et())!==e?(f=t,t=Xi(r)):(n=t,t=e)):(n=t,t=e),t}function us(){var t,r,o,s;return t=n,Ge()!==e?(p(),r=i.charAt(n),ht.test(r)?n++:(r=e,c===0&&w(wt)),r!==e?(p(),(o=et())!==e?(p(),(s=_e())!==e?(f=t,t=to(r,o,s)):(n=t,t=e)):(n=t,t=e)):(n=t,t=e)):(n=t,t=e),t===e&&(t=n,Ge()!==e?(p(),(r=et())!==e?(p(),(o=_e())!==e?(f=t,t=eo(r,o)):(n=t,t=e)):(n=t,t=e)):(n=t,t=e)),t}function _e(){var t,r,o;return t=n,(r=ss())!==e?(p(),Vs()!==e?(p(),(o=ls())!==e?(f=t,t=ro(r,o)):(n=t,t=e)):(n=t,t=e)):(n=t,t=e),t===e&&(t=cs()),t}function ss(){var t,r,o;return t=n,(r=lt())!==e?(p(),L()!==e?(p(),(o=Ot())!==e?(p(),R()!==e?(f=t,t=no(r,o)):(n=t,t=e)):(n=t,t=e)):(n=t,t=e)):(n=t,t=e),t===e&&(t=n,(r=lt())!==e&&(f=t,r=ao(r)),t=r),t}function ls(){var t,r,o,s;return t=n,(r=lt())!==e&&(f=t,r=io(r)),(t=r)===e&&(t=n,(r=nt())!==e?(p(),L()!==e?(p(),(o=Ot())!==e?(p(),W()!==e?(p(),(s=Nt())!==e?(p(),R()!==e?(f=t,t=oo(o,s)):(n=t,t=e)):(n=t,t=e)):(n=t,t=e)):(n=t,t=e)):(n=t,t=e)):(n=t,t=e),t===e&&(t=n,(r=nt())!==e?(p(),L()!==e?(p(),(o=Ot())!==e?(p(),R()!==e?(f=t,t=uo(o)):(n=t,t=e)):(n=t,t=e)):(n=t,t=e)):(n=t,t=e),t===e&&(t=n,(r=nt())!==e&&(f=t,r=so()),t=r))),t}function cs(){var t,r,o,s;return t=n,(r=lt())!==e?(p(),L()!==e?(p(),(o=Nt())!==e?(p(),R()!==e?(f=t,t=lo(r,o)):(n=t,t=e)):(n=t,t=e)):(n=t,t=e)):(n=t,t=e),t===e&&(t=n,(r=lt())!==e&&(f=t,r=co(r)),(t=r)===e&&(t=n,(r=nt())!==e?(p(),L()!==e?(p(),(o=Ot())!==e?(p(),W()!==e?(p(),(s=Nt())!==e?(p(),R()!==e?(f=t,t=fo(o,s)):(n=t,t=e)):(n=t,t=e)):(n=t,t=e)):(n=t,t=e)):(n=t,t=e)):(n=t,t=e),t===e&&(t=n,(r=nt())!==e?(p(),L()!==e?(p(),(o=Nt())!==e?(p(),R()!==e?(f=t,t=po(o)):(n=t,t=e)):(n=t,t=e)):(n=t,t=e)):(n=t,t=e),t===e&&(t=n,(r=nt())!==e&&(f=t,r=mo()),t=r)))),t}function lt(){var t,r;return t=n,(r=Xe())!==e&&(f=t,r=vo()),(t=r)===e&&(t=n,(r=tr())!==e&&(f=t,r=ho()),(t=r)===e&&(t=n,(r=er())!==e&&(f=t,r=wo()),(t=r)===e&&(t=n,(r=Ke())!==e&&(f=t,r=Io()),(t=r)===e&&(t=n,(r=We())!==e&&(f=t,r=go()),t=r)))),t}function Nt(){var t,r;return t=n,(r=rt())!==e&&(f=t,r=yo(r)),t=r}function Ot(){var t,r;return t=n,(r=rt())!==e&&(f=t,r=To(r)),t=r}function fs(){var t,r;return t=n,Qe()!==e?(p(),(r=et())!==e?(f=t,t=No(r)):(n=t,t=e)):(n=t,t=e),t}function ds(){var t,r;return t=n,(r=ys())!==e&&(f=t,r=Oo()),t=r}function ps(){var t,r;return t=n,(r=Ts())!==e&&(f=t,r=So()),(t=r)===e&&(t=n,(r=Ns())!==e&&(f=t,r=xo()),t=r),t}function et(){var t;return(t=zt())===e&&(t=Zt()),t}function zt(){var t,r,o,s,h;if(t=n,i.charCodeAt(n)===39?(r=ie,n++):(r=e,c===0&&w(de)),r===e&&(i.substr(n,2)===oe?(r=oe,n+=2):(r=e,c===0&&w(Bn))),r!==e){for(o=[],s=n,i.substr(n,2)===vt?(h=vt,n+=2):(h=e,c===0&&w(pe)),h!==e&&(f=s,h=Ne()),(s=h)===e&&(s=i.charAt(n),le.test(s)?n++:(s=e,c===0&&w(me)));s!==e;)o.push(s),s=n,i.substr(n,2)===vt?(h=vt,n+=2):(h=e,c===0&&w(pe)),h!==e&&(f=s,h=Ne()),(s=h)===e&&(s=i.charAt(n),le.test(s)?n++:(s=e,c===0&&w(me)));i.charCodeAt(n)===39?(s=ie,n++):(s=e,c===0&&w(de)),s!==e?(f=t,t=Co(o)):(n=t,t=e)}else n=t,t=e;return t}function ms(){var t;return(t=vs())===e&&(t=hs()),t}function vs(){var t,r,o,s,h;if(t=n,Et()!==e)if(p(),(r=E())!==e){for(p(),o=[],s=n,(h=xt())!==e?(p(),s=h):(n=s,s=e);s!==e;)o.push(s),s=n,(h=xt())!==e?(p(),s=h):(n=s,s=e);(s=$t())!==e?(f=t,t=Mo(r,o)):(n=t,t=e)}else n=t,t=e;else n=t,t=e;if(t===e)if(t=n,Et()!==e)if(p(),(r=E())!==e){for(p(),o=[],s=n,(h=xt())!==e?(p(),s=h):(n=s,s=e);s!==e;)o.push(s),s=n,(h=xt())!==e?(p(),s=h):(n=s,s=e);(s=Ue())!==e?(h=p(),$t()!==e?(f=t,t=Eo(r,o,s)):(n=t,t=e)):(n=t,t=e)}else n=t,t=e;else n=t,t=e;return t}function hs(){var t,r,o,s;if(t=n,Et()!==e){for(p(),r=[],o=n,(s=St())!==e?(p(),o=s):(n=o,o=e);o!==e;)r.push(o),o=n,(s=St())!==e?(p(),o=s):(n=o,o=e);(o=$t())!==e?(f=t,t=$o(r)):(n=t,t=e)}else n=t,t=e;if(t===e)if(t=n,Et()!==e){for(p(),r=[],o=n,(s=St())!==e?(p(),o=s):(n=o,o=e);o!==e;)r.push(o),o=n,(s=St())!==e?(p(),o=s):(n=o,o=e);(o=Ue())!==e?(s=p(),$t()!==e?(f=t,t=bo(r,o)):(n=t,t=e)):(n=t,t=e)}else n=t,t=e;return t}function St(){var t,r,o;return t=n,rr()!==e?(p(),(r=E())!==e?(p(),nr()!==e?(p(),(o=E())!==e?(f=t,t=Fo(r,o)):(n=t,t=e)):(n=t,t=e)):(n=t,t=e)):(n=t,t=e),t}function xt(){var t,r,o;return t=n,rr()!==e?(p(),(r=E())!==e?(p(),nr()!==e?(p(),(o=E())!==e?(f=t,t=Ao(r,o)):(n=t,t=e)):(n=t,t=e)):(n=t,t=e)):(n=t,t=e),t}function Ue(){var t,r;return t=n,zs()!==e?(p(),(r=E())!==e?(f=t,t=Do(r)):(n=t,t=e)):(n=t,t=e),t}function ws(){var t,r,o,s;return t=n,(r=Is())!==e?(o=n,c++,s=Jt(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=Po(r)):(n=t,t=e)):(n=t,t=e),t}function Is(){var t,r,o,s;return t=n,(r=Ct())!==e&&(o=Ve())!==e&&(s=Je())!==e?(f=t,t=Lo(r,o,s)):(n=t,t=e),t===e&&(t=n,(r=Ct())!==e&&(o=Ve())!==e?(f=t,t=Ro(r,o)):(n=t,t=e),t===e&&(t=n,(r=Ct())!==e&&(o=Je())!==e?(f=t,t=_o(r,o)):(n=t,t=e),t===e&&(t=n,(r=Ct())!==e&&(f=t,r=Uo(r)),t=r))),t}function Ct(){var t,r,o;return(t=rt())===e&&(t=n,r=i.charAt(n),ht.test(r)?n++:(r=e,c===0&&w(wt)),r!==e&&(o=rt())!==e?(f=t,t=Vo(r,o)):(n=t,t=e)),t}function Ve(){var t,r,o;return t=n,i.charCodeAt(n)===46?(r=br,n++):(r=e,c===0&&w(Gn)),r!==e?((o=rt())===e&&(o=null),f=t,t=Jo(o)):(n=t,t=e),t}function Je(){var t,r,o;return t=n,(r=gs())!==e&&(o=rt())!==e?(f=t,t=Zo(r,o)):(n=t,t=e),t}function rt(){var t,r,o;if(t=n,r=[],(o=Ze())!==e)for(;o!==e;)r.push(o),o=Ze();else r=e;return r!==e&&(f=t,r=zo(r)),t=r}function Ze(){var t;return t=i.charAt(n),An.test(t)?n++:(t=e,c===0&&w(Wn)),t}function gs(){var t,r,o;return t=n,r=i.charAt(n),Dn.test(r)?n++:(r=e,c===0&&w(Kn)),r!==e?(o=i.charAt(n),ht.test(o)?n++:(o=e,c===0&&w(wt)),o===e&&(o=null),f=t,t=ko(r,o)):(n=t,t=e),t}function ys(){var t,r,o,s;return t=n,(r=i.substr(n,4)).toLowerCase()===Fr?n+=4:(r=e,c===0&&w(Xn)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?t=r=[r,o]:(n=t,t=e)):(n=t,t=e),t}function Ts(){var t,r,o,s;return t=n,(r=i.substr(n,4)).toLowerCase()===Ar?n+=4:(r=e,c===0&&w(ta)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?t=r=[r,o]:(n=t,t=e)):(n=t,t=e),t}function Ns(){var t,r,o,s;return t=n,(r=i.substr(n,5)).toLowerCase()===Dr?n+=5:(r=e,c===0&&w(ea)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?t=r=[r,o]:(n=t,t=e)):(n=t,t=e),t}function kt(){var t,r,o,s;return t=n,(r=i.substr(n,2)).toLowerCase()===Pr?n+=2:(r=e,c===0&&w(ra)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=qo()):(n=t,t=e)):(n=t,t=e),t}function ze(){var t,r,o,s;return t=n,(r=i.substr(n,2)).toLowerCase()===Lr?n+=2:(r=e,c===0&&w(na)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=Ho()):(n=t,t=e)):(n=t,t=e),t}function ke(){var t,r,o,s;return t=n,(r=i.substr(n,4)).toLowerCase()===Rr?n+=4:(r=e,c===0&&w(aa)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=jo()):(n=t,t=e)):(n=t,t=e),t}function Os(){var t,r,o,s;return t=n,(r=i.substr(n,6)).toLowerCase()===_r?n+=6:(r=e,c===0&&w(ia)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=Yo()):(n=t,t=e)):(n=t,t=e),t}function ct(){var t,r,o,s;return t=n,(r=i.substr(n,3)).toLowerCase()===Ur?n+=3:(r=e,c===0&&w(oa)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=Qo()):(n=t,t=e)):(n=t,t=e),t}function Mt(){var t,r,o,s;return t=n,(r=i.substr(n,3)).toLowerCase()===Vr?n+=3:(r=e,c===0&&w(ua)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=Bo()):(n=t,t=e)):(n=t,t=e),t}function qe(){var t,r,o,s;return t=n,(r=i.substr(n,2)).toLowerCase()===Jr?n+=2:(r=e,c===0&&w(sa)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=Go()):(n=t,t=e)):(n=t,t=e),t}function He(){var t,r,o,s;return t=n,(r=i.substr(n,7)).toLowerCase()===Zr?n+=7:(r=e,c===0&&w(la)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=Wo()):(n=t,t=e)):(n=t,t=e),t}function qt(){var t,r,o,s;return t=n,(r=i.substr(n,4)).toLowerCase()===zr?n+=4:(r=e,c===0&&w(ca)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=Ko()):(n=t,t=e)):(n=t,t=e),t}function Ss(){var t,r,o,s;return t=n,(r=i.substr(n,3)).toLowerCase()===kr?n+=3:(r=e,c===0&&w(fa)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=Xo()):(n=t,t=e)):(n=t,t=e),t}function xs(){var t,r,o,s;return t=n,(r=i.substr(n,9)).toLowerCase()===qr?n+=9:(r=e,c===0&&w(da)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=tu()):(n=t,t=e)):(n=t,t=e),t}function je(){var t,r,o,s;return t=n,(r=i.substr(n,7)).toLowerCase()===Hr?n+=7:(r=e,c===0&&w(pa)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=eu()):(n=t,t=e)):(n=t,t=e),t}function Cs(){var t,r,o,s;return t=n,(r=i.substr(n,4)).toLowerCase()===jr?n+=4:(r=e,c===0&&w(ma)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=ru()):(n=t,t=e)):(n=t,t=e),t}function Ms(){var t,r,o,s;return t=n,(r=i.substr(n,8)).toLowerCase()===Yr?n+=8:(r=e,c===0&&w(va)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=nu()):(n=t,t=e)):(n=t,t=e),t}function Ye(){var t,r,o,s;return t=n,(r=i.substr(n,9)).toLowerCase()===Qr?n+=9:(r=e,c===0&&w(ha)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=au()):(n=t,t=e)):(n=t,t=e),t}function Qe(){var t,r,o,s;return t=n,(r=i.substr(n,4)).toLowerCase()===Br?n+=4:(r=e,c===0&&w(wa)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=iu()):(n=t,t=e)):(n=t,t=e),t}function Be(){var t,r,o,s;return t=n,(r=i.substr(n,4)).toLowerCase()===Gr?n+=4:(r=e,c===0&&w(Ia)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=ou()):(n=t,t=e)):(n=t,t=e),t}function Es(){var t,r,o,s;return t=n,(r=i.substr(n,7)).toLowerCase()===Wr?n+=7:(r=e,c===0&&w(ga)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=uu()):(n=t,t=e)):(n=t,t=e),t}function $s(){var t,r,o,s;return t=n,(r=i.substr(n,8)).toLowerCase()===Kr?n+=8:(r=e,c===0&&w(ya)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=su()):(n=t,t=e)):(n=t,t=e),t}function bs(){var t,r,o,s;return t=n,(r=i.substr(n,4)).toLowerCase()===Xr?n+=4:(r=e,c===0&&w(Ta)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=lu()):(n=t,t=e)):(n=t,t=e),t}function Fs(){var t,r,o,s;return t=n,(r=i.substr(n,4)).toLowerCase()===tn?n+=4:(r=e,c===0&&w(Na)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=cu()):(n=t,t=e)):(n=t,t=e),t}function As(){var t,r,o,s;return t=n,(r=i.substr(n,2)).toLowerCase()===en?n+=2:(r=e,c===0&&w(Oa)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=fu()):(n=t,t=e)):(n=t,t=e),t}function Ds(){var t,r,o,s;return t=n,(r=i.substr(n,7)).toLowerCase()===rn?n+=7:(r=e,c===0&&w(Sa)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=du()):(n=t,t=e)):(n=t,t=e),t}function Ps(){var t,r,o,s;return t=n,(r=i.substr(n,3)).toLowerCase()===nn?n+=3:(r=e,c===0&&w(xa)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=pu()):(n=t,t=e)):(n=t,t=e),t}function Ls(){var t,r,o,s;return t=n,(r=i.substr(n,8)).toLowerCase()===an?n+=8:(r=e,c===0&&w(Ca)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=mu()):(n=t,t=e)):(n=t,t=e),t}function Rs(){var t,r,o,s;return t=n,(r=i.substr(n,5)).toLowerCase()===on?n+=5:(r=e,c===0&&w(Ma)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=vu()):(n=t,t=e)):(n=t,t=e),t}function _s(){var t,r,o,s;return t=n,(r=i.substr(n,4)).toLowerCase()===un?n+=4:(r=e,c===0&&w(Ea)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=hu()):(n=t,t=e)):(n=t,t=e),t}function Us(){var t,r,o,s;return t=n,(r=i.substr(n,7)).toLowerCase()===sn?n+=7:(r=e,c===0&&w($a)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=wu()):(n=t,t=e)):(n=t,t=e),t}function Vs(){var t,r,o,s;return t=n,(r=i.substr(n,2)).toLowerCase()===ln?n+=2:(r=e,c===0&&w(ba)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=Iu()):(n=t,t=e)):(n=t,t=e),t}function Ge(){var t,r,o,s;return t=n,(r=i.substr(n,8)).toLowerCase()===cn?n+=8:(r=e,c===0&&w(Fa)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=gu()):(n=t,t=e)):(n=t,t=e),t}function We(){var t,r,o,s;return t=n,(r=i.substr(n,4)).toLowerCase()===fn?n+=4:(r=e,c===0&&w(Aa)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=yu()):(n=t,t=e)):(n=t,t=e),t}function Js(){var t,r,o,s;return t=n,(r=i.substr(n,13)).toLowerCase()===dn?n+=13:(r=e,c===0&&w(Da)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=Tu()):(n=t,t=e)):(n=t,t=e),t}function Zs(){var t,r,o,s;return t=n,(r=i.substr(n,15)).toLowerCase()===pn?n+=15:(r=e,c===0&&w(Pa)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=Nu()):(n=t,t=e)):(n=t,t=e),t}function Ke(){var t,r,o,s;return t=n,(r=i.substr(n,5)).toLowerCase()===mn?n+=5:(r=e,c===0&&w(La)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=Ou()):(n=t,t=e)):(n=t,t=e),t}function Xe(){var t,r,o,s;return t=n,(r=i.substr(n,3)).toLowerCase()===vn?n+=3:(r=e,c===0&&w(Ra)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=Su()):(n=t,t=e)):(n=t,t=e),t}function tr(){var t,r,o,s;return t=n,(r=i.substr(n,4)).toLowerCase()===hn?n+=4:(r=e,c===0&&w(_a)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=xu()):(n=t,t=e)):(n=t,t=e),t}function er(){var t,r,o,s;return t=n,(r=i.substr(n,6)).toLowerCase()===wn?n+=6:(r=e,c===0&&w(Ua)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=Cu()):(n=t,t=e)):(n=t,t=e),t}function nt(){var t,r,o,s;return t=n,(r=i.substr(n,6)).toLowerCase()===In?n+=6:(r=e,c===0&&w(Va)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=Mu()):(n=t,t=e)):(n=t,t=e),t}function Et(){var t,r,o,s;return t=n,(r=i.substr(n,4)).toLowerCase()===gn?n+=4:(r=e,c===0&&w(Ja)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=Eu()):(n=t,t=e)):(n=t,t=e),t}function $t(){var t,r,o,s;return t=n,(r=i.substr(n,3)).toLowerCase()===yn?n+=3:(r=e,c===0&&w(Za)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=$u()):(n=t,t=e)):(n=t,t=e),t}function rr(){var t,r,o,s;return t=n,(r=i.substr(n,4)).toLowerCase()===Tn?n+=4:(r=e,c===0&&w(za)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=bu()):(n=t,t=e)):(n=t,t=e),t}function nr(){var t,r,o,s;return t=n,(r=i.substr(n,4)).toLowerCase()===Nn?n+=4:(r=e,c===0&&w(ka)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=Fu()):(n=t,t=e)):(n=t,t=e),t}function zs(){var t,r,o,s;return t=n,(r=i.substr(n,4)).toLowerCase()===On?n+=4:(r=e,c===0&&w(qa)),r!==e?(o=n,c++,s=O(),c--,s===e?o=void 0:(n=o,o=e),o!==e?(f=t,t=Au()):(n=t,t=e)):(n=t,t=e),t}function W(){var t;return i.charCodeAt(n)===44?(t=Sn,n++):(t=e,c===0&&w(Ha)),t}function L(){var t;return i.charCodeAt(n)===40?(t=xn,n++):(t=e,c===0&&w(ja)),t}function R(){var t;return i.charCodeAt(n)===41?(t=Cn,n++):(t=e,c===0&&w(Ya)),t}function p(){var t,r;for(t=[],r=ar();r!==e;)t.push(r),r=ar();return t}function ar(){var t;return t=i.charAt(n),Pn.test(t)?n++:(t=e,c===0&&w(Qa)),t}function ks(){var t,r,o,s;if(t=n,(r=Fe())!==e&&(f=t,r=Du(r)),(t=r)===e)if(t=n,i.charCodeAt(n)===96?(r=ue,n++):(r=e,c===0&&w(ve)),r!==e){if(o=[],s=i.charAt(n),ce.test(s)?n++:(s=e,c===0&&w(he)),s!==e)for(;s!==e;)o.push(s),s=i.charAt(n),ce.test(s)?n++:(s=e,c===0&&w(he));else o=e;o!==e?(i.charCodeAt(n)===96?(s=ue,n++):(s=e,c===0&&w(ve)),s!==e?(f=t,t=Pu(o)):(n=t,t=e)):(n=t,t=e)}else n=t,t=e;return t}function qs(t,r,o){return{type:"unary-expression",location:o,operator:t,expr:r}}function ir(t,r,o,s,h){const x={type:"binary-expression",location:h,operator:t,left:r,right:o};return s!==void 0&&(x.escape=s),x}function q(t,...r){return{type:"expression-list",location:t,value:r}}function ft(t,r){let o=t;for(const{op:s,expr:h,location:{end:x}}of r)o=ir(s,o,h,void 0,{...o.location,end:x});return o}function Hs(t){/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(t)!==!0&&Rt("Timestamp literal is invalid")}function js(t){/^(\d{1,2}):(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/.test(t)!==!0&&Rt("Time literal is invalid")}function Ys(t){/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(t)!==!0&&Rt("Date literal is invalid")}if(u=g(),a.peg$library)return{peg$result:u,peg$currPos:n,peg$FAILED:e,peg$maxFailExpected:It,peg$maxFailPos:Y};if(u!==e&&n===i.length)return u;throw u!==e&&n<i.length&&w(Lu()),_u(It,Y<i.length?i.charAt(Y):null,Y<i.length?gt(Y,Y+1):gt(Y,Y))}yc(ot,Error),ot.prototype.format=function(i){var a="Error: "+this.message;if(this.location){var u,e=null;for(u=0;u<i.length;u++)if(i[u].source===this.location.source){e=i[u].text.split(/\r\n|\n|\r/g);break}var l=this.location.start,v=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(l):l,g=this.location.source+":"+v.line+":"+v.column;if(e){var C=this.location.end,N=Gt("",v.line.toString().length," "),y=e[l.line-1],S=(l.line===C.line?C.column:y.length+1)-l.column||1;a+=`
 --> `+g+`
`+N+` |
`+v.line+" | "+y+`
`+N+" | "+Gt("",l.column-1," ")+Gt("",S,"^")}else a+=`
 at `+g}return a},ot.buildMessage=function(i,a){var u={literal:function(y){return'"'+l(y.text)+'"'},class:function(y){var S=y.parts.map(function(A){return Array.isArray(A)?v(A[0])+"-"+v(A[1]):v(A)});return"["+(y.inverted?"^":"")+S.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(y){return y.description}};function e(y){return y.charCodeAt(0).toString(16).toUpperCase()}function l(y){return y.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(S){return"\\x0"+e(S)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(S){return"\\x"+e(S)})}function v(y){return y.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(S){return"\\x0"+e(S)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(S){return"\\x"+e(S)})}function g(y){return u[y.type](y)}function C(y){var S,A,M=y.map(g);if(M.sort(),M.length>0){for(S=1,A=1;S<M.length;S++)M[S-1]!==M[S]&&(M[A]=M[S],A++);M.length=A}switch(M.length){case 1:return M[0];case 2:return M[0]+" or "+M[1];default:return M.slice(0,-1).join(", ")+", or "+M[M.length-1]}}function N(y){return y?'"'+l(y)+'"':"end of input"}return"Expected "+C(i)+" but "+N(a)+" found."};class Nc{static parse(a){return Tc(a)}}function _(i,a){if(i!=null)switch(a(i),i.type){case"when-clause":_(i.operand,a),_(i.value,a);break;case"case-expression":for(const u of i.clauses)_(u,a);i.format==="simple"&&_(i.operand,a),i.else!==null&&_(i.else,a);break;case"expression-list":for(const u of i.value)_(u,a);break;case"unary-expression":_(i.expr,a);break;case"binary-expression":_(i.left,a),_(i.right,a);break;case"function":_(i.args,a);break;case"interval":_(i.value,a),_(i.qualifier,a);break;case"interval-qualifier":_(i.start,a),_(i.end,a)}}const Oc=new Set(["current_timestamp","current_date","current_time"]);class At{static makeBool(a){return xr(a)}static featureValue(a,u,e,l){return Er(a,u,e,l)}static equalsNull(a){return a===null}static applyLike(a,u,e){return te(a,u,e)}static ensureArray(a){return Kt(a)}static applyIn(a,u,e){return Xt(a,u)}static currentTimestamp(a){return Pt(new Date,a)}static currentDate(a){return j.fromNow(a)}static currentTime(a){const u=Pt(new Date,a);return z.fromDateTime(u)}static makeSqlInterval(a,u,e){return P.createFromValueAndQualifier(a,u,e)}static convertInterval(a){return P.isInterval(a)?a.valueInMilliseconds():a}static compare(a,u,e,l){return Z(u,e,a)}static calculate(a,u,e,l){return Or(a,u,e,l)}static evaluateTime(a){return re(a)}static evaluateTimestamp(a,u,e){return Lt(a,u,e)}static evaluateDate(a,u){return yr(a,u)}static evaluateFunction(a,u,e){return ne(a,u,e)}static lookup(a,u){const e=u[a];return e===void 0?null:e}static between(a,u,e){return a==null||u[0]==null||u[1]==null?null:Z(a,u[0],">=")&&Z(a,u[1],"<=")}static notbetween(a,u,e){return a==null||u[0]==null||u[1]==null?null:Z(a,u[0],"<")||Z(a,u[1],">")}static ternaryNot(a){return Dt(a)}static ternaryAnd(a,u){return Cr(a,u)}static ternaryOr(a,u){return Mr(a,u)}}let Sc=class Sr{constructor(a,u,e="UTC",l=null){this.fieldsIndex=u,this.timeZone=e,this.currentUser=l,this.parameters={},this._hasDateFunctions=void 0,this.parseTree=Nc.parse(a);const{isStandardized:v,isAggregate:g,currentUserRequired:C,referencedFieldNames:N}=this._extractExpressionInfo(u);this._referencedFieldNames=N,this.isStandardized=v,this.isAggregate=g,this.currentUserRequired=C}static convertValueToStorageFormat(a,u=null){if(u===null)return H(a)?a.getTime():$(a)?a.toMillis():F(a)?a.toStorageFormat():D(a)?a.toStorageString():b(a)?a.toStorageFormat():a;switch(u){case"date":return H(a)?a.getTime():$(a)?a.toMillis():F(a)?a.toMilliseconds():b(a)?a.toNumber():a;case"date-only":return H(a)?j.fromDateJS(a).toString():F(a)?j.fromSqlTimeStampOffset(a).toString():$(a)?j.fromDateTime(a).toString():a;case"time-only":return H(a)?z.fromDateJS(a).toStorageString():$(a)?z.fromDateTime(a).toStorageString():F(a)?z.fromSqlTimeStampOffset(a).toStorageString():D(a)?a.toStorageString():a;case"timestamp-offset":if(H(a))return B.fromJSDate(a).toStorageFormat();if($(a))return B.fromDateTime(a).toStorageFormat();if(F(a))return a.toStorageFormat()}return a}static create(a,u={}){return new Sr(a,u.fieldsIndex,u.timeZone??void 0,u.currentUser)}get fieldNames(){return this._referencedFieldNames}testSet(a,u=mt,e=this.currentUser){return!!this._evaluateNode(this.parseTree,null,u,a,e)}calculateValue(a,u=mt,e=this.currentUser){const l=this._evaluateNode(this.parseTree,a,u,null,e);return P.isInterval(l)?l.valueInMilliseconds()/864e5:l}calculateValueCompiled(a,u=mt,e=this.currentUser){return this.parseTree._compiledVersion!=null?this.parseTree._compiledVersion(a,this.parameters,u,this.fieldsIndex,this.timeZone,e??null):ur("esri-csp-restrictions")?this.calculateValue(a,u):(this._compileMe(),this.parseTree._compiledVersion(a,this.parameters,u,this.fieldsIndex,this.timeZone,e??null))}testFeature(a,u=mt,e=this.currentUser){return!!this._evaluateNode(this.parseTree,a,u,null,e)}testFeatureCompiled(a,u=mt,e=this.currentUser){return this.parseTree._compiledVersion!=null?!!this.parseTree._compiledVersion(a,this.parameters,u,this.fieldsIndex,this.timeZone,e??null):ur("esri-csp-restrictions")?this.testFeature(a,u):(this._compileMe(),!!this.parseTree._compiledVersion(a,this.parameters,u,this.fieldsIndex,this.timeZone,e??null))}get hasDateFunctions(){return this._hasDateFunctions!=null||(this._hasDateFunctions=!1,_(this.parseTree,a=>{a.type==="current-time"?this._hasDateFunctions=!0:a.type==="function"&&(this._hasDateFunctions=this._hasDateFunctions||Oc.has(a.name.toLowerCase()))})),this._hasDateFunctions}getFunctions(){const a=new Set;return _(this.parseTree,u=>{u.type==="function"&&a.add(u.name.toLowerCase())}),Array.from(a)}getExpressions(){const a=new Map;return _(this.parseTree,u=>{if(u.type==="function"){const e=u.name.toLowerCase(),l=u.args.value[0];if(l.type==="column-reference"){const v=l.column,g=`${e}-${v}`;a.has(g)||a.set(g,{aggregateType:e,field:v})}}}),[...a.values()]}getVariables(){const a=new Set;return _(this.parseTree,u=>{u.type==="parameter"&&a.add(u.value.toLowerCase())}),Array.from(a)}_compileMe(){const a="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=new Function("feature","lookups","attributeAdapter","fieldsIndex","timeZone","currentUser",a).bind(At)}_extractExpressionInfo(a){const u=[],e=new Set;let l=!0,v=!1,g=!1;return _(this.parseTree,C=>{switch(C.type){case"column-reference":{const N=a==null?void 0:a.get(C.column);let y,S;N?y=S=N.name??"":(S=C.column,y=S.toLowerCase()),e.has(y)||(e.add(y),u.push(S)),C.column=S;break}case"current-user":g=!0;break;case"function":{const{name:N,args:y}=C,S=y.value.length;l&&(l=Nl(N,S)),v===!1&&(v=cr(N,S));break}}}),{referencedFieldNames:Array.from(u),isStandardized:l,isAggregate:v,currentUserRequired:g}}evaluateNodeToJavaScript(a){switch(a.type){case"interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(a.value)+", "+JSON.stringify(a.qualifier)+","+JSON.stringify(a.op)+")";case"case-expression":{let u="";if(a.format==="simple"){const e=this.evaluateNodeToJavaScript(a.operand);u="( ";for(let l=0;l<a.clauses.length;l++)u+=" (this.compare('=',"+e+","+this.evaluateNodeToJavaScript(a.clauses[l].operand)+") ? ("+this.evaluateNodeToJavaScript(a.clauses[l].value)+") : ";a.else!==null?u+=this.evaluateNodeToJavaScript(a.else):u+="null",u+=" )"}else{u="( ";for(let e=0;e<a.clauses.length;e++)u+=" this.makeBool("+this.evaluateNodeToJavaScript(a.clauses[e].operand)+")===true ? ("+this.evaluateNodeToJavaScript(a.clauses[e].value)+") : ";a.else!==null?u+=this.evaluateNodeToJavaScript(a.else):u+="null",u+=" )"}return u}case"parameter":return"this.lookup("+JSON.stringify(a.value.toLowerCase())+",lookups)";case"expression-list":{let u="[";for(const e of a.value)u!=="["&&(u+=","),u+=this.evaluateNodeToJavaScript(e);return u+="]",u}case"unary-expression":return"this.ternaryNot("+this.evaluateNodeToJavaScript(a.expr)+")";case"binary-expression":switch(a.operator){case"AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+" )";case"OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+" )";case"IS":if(a.right.type!=="null")throw new m(d.UnsupportedIsRhs);return"this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")";case"ISNOT":if(a.right.type!=="null")throw new m(d.UnsupportedIsRhs);return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")))";case"IN":return"this.applyIn("+this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(a.right)+"), timeZone)";case"NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(a.right)+"), timeZone))";case"BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+", timeZone)";case"NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+", timeZone)";case"LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+")";case"NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+"))";case"<>":case"<":case">":case">=":case"<=":case"=":return"this.compare("+JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+", timeZone)";case"*":case"-":case"+":case"/":case"||":return"this.calculate("+JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+", timeZone)";default:throw new m(d.UnsupportedOperator,{operator:a.operator})}case"null":case"boolean":case"string":case"number":return JSON.stringify(a.value);case"time":return"this.evaluateTime("+JSON.stringify(a.value)+")";case"date":return"this.evaluateDate("+JSON.stringify(a.value)+", 'unknown')";case"timestamp":return"this.evaluateTimestamp("+JSON.stringify(a.value)+", 'unknown')";case"current-time":return a.mode==="date"?"this.currentDate(timeZone)":a.mode==="time"?"this.currentTime(timeZone)":"this.currentTimestamp(timeZone)";case"current-user":return"currentUser";case"column-reference":return"this.featureValue(feature,"+JSON.stringify(a.column)+",fieldsIndex,attributeAdapter)";case"function":return"this.evaluateFunction("+JSON.stringify(a.name)+","+this.evaluateNodeToJavaScript(a.args)+", timeZone)"}throw new m(d.UnsupportedSyntax,{node:a.type})}_evaluateNode(a,u,e,l,v){var C;let g;switch(a.type){case"interval":{const N=this._evaluateNode(a.value,u,e,l,v);return P.createFromValueAndQualifier(N,a.qualifier,a.op)}case"case-expression":if(a.format==="simple"){const N=this._evaluateNode(a.operand,u,e,l,v);for(let y=0;y<a.clauses.length;y++)if(Z(N,this._evaluateNode(a.clauses[y].operand,u,e,l,v),"=",this.timeZone))return this._evaluateNode(a.clauses[y].value,u,e,l,v);if(a.else!==null)return this._evaluateNode(a.else,u,e,l,v)}else{for(let N=0;N<a.clauses.length;N++)if(xr(this._evaluateNode(a.clauses[N].operand,u,e,l,v)))return this._evaluateNode(a.clauses[N].value,u,e,l,v);if(a.else!==null)return this._evaluateNode(a.else,u,e,l,v)}return null;case"parameter":return g=this.parameters[a.value.toLowerCase()],H(g)?V.fromJSDate(g):g!=null&&typeof g=="object"&&"toDateTime"in g?g.toDateTime():g;case"expression-list":{const N=[];for(const y of a.value)N.push(this._evaluateNode(y,u,e,l,v));return N}case"unary-expression":return Dt(this._evaluateNode(a.expr,u,e,l,v));case"binary-expression":switch(a.operator){case"AND":return Cr(this._evaluateNode(a.left,u,e,l,v),this._evaluateNode(a.right,u,e,l,v));case"OR":return Mr(this._evaluateNode(a.left,u,e,l,v),this._evaluateNode(a.right,u,e,l,v));case"IS":if(a.right.type!=="null")throw new m(d.UnsupportedIsRhs);return this._evaluateNode(a.left,u,e,l,v)===null;case"ISNOT":if(a.right.type!=="null")throw new m(d.UnsupportedIsRhs);return this._evaluateNode(a.left,u,e,l,v)!==null;case"IN":{const N=Kt(this._evaluateNode(a.right,u,e,l,v));return Xt(this._evaluateNode(a.left,u,e,l,v),N,this.timeZone)}case"NOT IN":{const N=Kt(this._evaluateNode(a.right,u,e,l,v));return Dt(Xt(this._evaluateNode(a.left,u,e,l,v),N,this.timeZone))}case"BETWEEN":{const N=this._evaluateNode(a.left,u,e,l,v),y=this._evaluateNode(a.right,u,e,l,v);return N==null||y[0]==null||y[1]==null?null:Z(N,y[0],">=",this.timeZone)&&Z(N,y[1],"<=",this.timeZone)}case"NOTBETWEEN":{const N=this._evaluateNode(a.left,u,e,l,v),y=this._evaluateNode(a.right,u,e,l,v);return N==null||y[0]==null||y[1]==null?null:Z(N,y[0],"<",this.timeZone)||Z(N,y[1],">",this.timeZone)}case"LIKE":return te(this._evaluateNode(a.left,u,e,l,v),this._evaluateNode(a.right,u,e,l,v),a.escape);case"NOT LIKE":return Dt(te(this._evaluateNode(a.left,u,e,l,v),this._evaluateNode(a.right,u,e,l,v),a.escape));case"<>":case"<":case">":case">=":case"<=":case"=":return Z(this._evaluateNode(a.left,u,e,l,v),this._evaluateNode(a.right,u,e,l,v),a.operator,this.timeZone);case"-":case"+":case"*":case"/":case"||":return Or(a.operator,this._evaluateNode(a.left,u,e,l,v),this._evaluateNode(a.right,u,e,l,v),this.timeZone)}case"null":case"boolean":case"string":case"number":return a.value;case"date":return a.parsedValue??(a.parsedValue=yr(a.value,"unknown")),a.parsedValue;case"timestamp":return a.parsedValue??(a.parsedValue=Lt(a.value,"unknown")),a.parsedValue;case"time":return re(a.value);case"current-time":return a.mode==="date"?At.currentDate(this.timeZone):a.mode==="time"?At.currentTime(this.timeZone):At.currentTimestamp(this.timeZone);case"current-user":return v??null;case"column-reference":return Er(u,a.column,this.fieldsIndex,e);case"data-type":return a.value;case"function":{if(this.isAggregate&&cr(a.name,a.args.value.length)){const y=[];for(const S of((C=a.args)==null?void 0:C.value)||[]){const A=[];for(const M of l||[])A.push(this._evaluateNode(S,M,e,null,v));y.push(A)}return tl(a.name,y)}const N=this._evaluateNode(a.args,u,e,l,v);return ne(a.name,N,this.timeZone)}}throw new m(d.UnsupportedSyntax,{node:a.type})}};function xr(i){return i===!0}function Kt(i){return Array.isArray(i)?i:[i]}function Dt(i){return i!==null?i!==!0:null}function Cr(i,a){return i!=null&&a!=null?i===!0&&a===!0:i!==!1&&a!==!1&&null}function Mr(i,a){return i!=null&&a!=null?i===!0||a===!0:i===!0||a===!0||null}function Xt(i,a,u){if(i==null)return null;let e=!1;for(const l of a)if(l==null)e=null;else{if(i===l){e=!0;break}if(Wt(i)&&Wt(l)&&(e=Z(i,l,"="),e))break}return e}const mr="-[]/{}()*+?.\\^$|";var it;function xc(i,a){const u=a;let e="",l=it.Normal;for(let v=0;v<i.length;v++){const g=i.charAt(v);switch(l){case it.Normal:g===u?l=it.Escaped:mr.includes(g)?e+="\\"+g:e+=g==="%"?".*":g==="_"?".":g;break;case it.Escaped:mr.includes(g)?e+="\\"+g:e+=g,l=it.Normal}}return new RegExp("^"+e+"$","m")}function te(i,a,u){return i==null?null:xc(a,u).test(i)}function Cc(i){return i&&typeof i.attributes=="object"}function Er(i,a,u,e){if("getAttributeSQL"in e)return e.getAttributeSQL(i,a);const l=e.getAttribute(i,a),v=u==null?void 0:u.get(a);return l==null||(v==null?void 0:v.type)!=="esriFieldTypeDate"&&(v==null?void 0:v.type)!=="date"?l==null||(v==null?void 0:v.type)!=="esriFieldTypeDateOnly"&&(v==null?void 0:v.type)!=="date-only"?l==null||(v==null?void 0:v.type)!=="esriFieldTypeTimeOnly"&&(v==null?void 0:v.type)!=="time-only"?l==null||(v==null?void 0:v.type)!=="esriFieldTypeTimestampOffset"&&(v==null?void 0:v.type)!=="timestamp-offset"?l:new B(l):z.fromReader(l):j.fromReader(l):Pt(new Date(l),(u==null?void 0:u.getLuxonTimeZone(v.name))??Ws.utcInstance)}(function(i){i[i.Normal=0]="Normal",i[i.Escaped=1]="Escaped"})(it||(it={}));const mt={getAttribute:(i,a)=>(Cc(i)?i.attributes:i)[a]},Ac=Object.freeze(Object.defineProperty({__proto__:null,default:Sc},Symbol.toStringTag,{value:"Module"}));export{Sc as D,Ac as W,d as a,B as i,m as n,tl as u};
