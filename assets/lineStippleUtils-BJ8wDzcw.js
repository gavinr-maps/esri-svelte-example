import{o as E,G as I}from"./vec2-B_ymkwGp.js";import{n as T}from"./vec2f64-Diu2Kaa8.js";import{s as R}from"./vec4f64-CBQL1T0x.js";import{g as b}from"./Point-TlcsOcXV.js";import{H as A,n as w}from"./projectBuffer-iyGwL2dv.js";import{t as g,a as y}from"./DoubleArray-CF_CpVBS.js";import{I as O,t as F}from"./Texture-DjTh7HwY.js";import{A as S}from"./Indices-B6BGScAS.js";import{l as v}from"./ViewingMode-Dodu7ZZk.js";import{t as f}from"./orientedBoundingBox-WyW1LZfF.js";import{e as C}from"./Material-BN_i9QRJ.js";import{e as d}from"./VertexAttribute-BnAa5VW0.js";import{p as m,a as D}from"./triangulationUtils-KizYbMMI.js";import{q as N,t as L}from"./RenderGeometry-C4TY81Cr.js";function ut(t,o,n=null){const a=[],s=o.mapPositions;U(o,a);const i=a[0][1].data,r=a[0][1].indices.length,e=S(r);return j(o,a,e),H(o,a,e),x(o,a,e),z(o,a,e),P(o,a,e),_(o,a,e),B(o,a,i),new O(t,a,s,C.Line,n)}function U(t,o){const{attributeData:{position:n},removeDuplicateStartEnd:a}=t,s=G(n)&&a,i=n.length/3-(s?1:0),r=new Array(2*(i-1)),e=s?n.slice(0,-3):n;let u=0;for(let p=0;p<i-1;p++)r[u++]=p,r[u++]=p+1;o.push([d.POSITION,new f(e,r,3,s)])}function j(t,o,n){if(t.attributeData.colorFeature!=null)return;const a=t.attributeData.color;o.push([d.COLOR,new f(a??R,n,4)])}function x(t,o,n){t.attributeData.normal&&o.push([d.NORMAL,new f(t.attributeData.normal,n,3)])}function z(t,o,n){t.attributeData.colorFeature!=null&&o.push([d.COLORFEATUREATTRIBUTE,new f([t.attributeData.colorFeature],n,1,!0)])}function H(t,o,n){t.attributeData.sizeFeature==null&&o.push([d.SIZE,new f([t.attributeData.size??1],n,1,!0)])}function P(t,o,n){t.attributeData.sizeFeature!=null&&o.push([d.SIZEFEATUREATTRIBUTE,new f([t.attributeData.sizeFeature],n,1,!0)])}function _(t,o,n){t.attributeData.opacityFeature!=null&&o.push([d.OPACITYFEATUREATTRIBUTE,new f([t.attributeData.opacityFeature],n,1,!0)])}function B(t,o,n){if(t.overlayInfo==null||t.overlayInfo.renderCoordsHelper.viewingMode!==v.Global||!t.overlayInfo.spatialReference.isGeographic)return;const a=g(n.length),s=b(t.overlayInfo.spatialReference);for(let h=0;h<a.length;h+=3)A(n,h,a,h,s);const i=n.length/3,r=F(i+1);let e=Z,u=M,p=0,c=0;E(e,a[c++],a[c++]),c++,r[0]=0;for(let h=1;h<i+1;++h)h===i&&(c=0),E(u,a[c++],a[c++]),c++,p+=I(e,u),r[h]=p,[e,u]=[u,e];o.push([d.DISTANCETOSTART,new f(r,o[0][1].indices,1,!0)])}function G(t){const o=t.length;return t[0]===t[o-3]&&t[1]===t[o-2]&&t[2]===t[o-1]}const Z=T(),M=T();function pt(t,o){if(t==null||t.length===0)return[];const n=[];return t.forEach(a=>{const s=a.length,i=g(3*s);a.forEach((e,u)=>{i[3*u]=e[0],i[3*u+1]=e[1],i[3*u+2]=e[2]});const r={attributeData:{position:i,normal:o},removeDuplicateStartEnd:!1};n.push(r)}),n}function ct(t,o,n,a){const s=t.type==="polygon"?m.CCW_IS_HOLE:m.NONE,i=t.type==="polygon"?t.rings:t.paths,{position:r,outlines:e}=D(i,!!t.hasZ,s,t.spatialReference),u=g(r.length),p=N(r,t.spatialReference,0,u,0,r,0,r.length/3,o,n,a),c=p!=null;return{lines:c?$(e,r,u):[],projectionSuccess:c,sampledElevation:p}}function ht(t,o){const n=t.type==="polygon"?m.CCW_IS_HOLE:m.NONE,a=t.type==="polygon"?t.rings:t.paths,{position:s,outlines:i}=D(a,!1,n),r=w(s,t.spatialReference,0,s,o,0,s.length/3);for(let e=2;e<s.length;e+=3)s[e]=L;return{lines:r?$(i,s):[],projectionSuccess:r}}function $(t,o,n=null){const a=new Array;for(const{index:s,count:i}of t){if(i<=1)continue;const r=3*s,e=3*i;a.push({position:y(o,3*s,3*i),mapPositions:n!=null?y(n,r,e):void 0})}return a}const l={dash:[4,3],dot:[1,3],"long-dash":[8,3],"short-dash":[4,1],"short-dot":[1,1]},W={dash:l.dash,"dash-dot":[...l.dash,...l.dot],dot:l.dot,"long-dash":l["long-dash"],"long-dash-dot":[...l["long-dash"],...l.dot],"long-dash-dot-dot":[...l["long-dash"],...l.dot,...l.dot],none:null,"short-dash":l["short-dash"],"short-dash-dot":[...l["short-dash"],...l["short-dot"]],"short-dash-dot-dot":[...l["short-dash"],...l["short-dot"],...l["short-dot"]],"short-dot":l["short-dot"],solid:null},q=8;function Y(t,o){return t==null?t:{pattern:t.slice(),pixelRatio:o}}function ft(t){return{pattern:[t,t],pixelRatio:2}}function dt(t){return t!=null&&t.type==="style"?k(t.style):null}function k(t){return t!=null?Y(W[t],q):null}export{pt as R,ut as b,ft as h,ht as l,dt as n,ct as p};
