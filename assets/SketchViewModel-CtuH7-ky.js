const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./editingTools-BsHNqIWH.js","./Evented-CXIxDjmW.js","./Accessor-D6mNnsWy.js","./subclass-BR3PhgZG.js","./geometry-DpwwkAX1.js","./Extent-DHjqVB-p.js","./Point-DB4Hp4hH.js","./jsonMap-DCC6W5ex.js","./writer-3zufXUNV.js","./assets-C2mb-ea2.js","./index-CeCSsEgo.js","./index-CjOb8WjV.css","./Polyline-D97hl-6E.js","./mathUtils-ClvKsMak.js","./Graphic-Dc7F67nR.js","./PopupTemplate-ByHks6sq.js","./Clonable-cKbRam6-.js","./reactiveUtils-BFQ0BtrB.js","./shared-B3wH2qpO.js","./fieldUtils-CNduWQU9.js","./intl-Dpfm8vPB.js","./Promise-CZrWwByK.js","./enumeration--HlxOQ_N.js","./Color-DDUWtbqR.js","./colorUtils-CS9vdHXB.js","./ActionToggle-C0Z1k2jc.js","./Identifiable-BLvpQbOc.js","./symbols-CsUQ5BxR.js","./TextSymbol-gKE-H_J6.js","./screenUtils-PfxkaaMN.js","./materialUtils-CQ3JLQ1x.js","./opacityUtils-BT7mQkwC.js","./aaBoundingBox-rJEWaOSN.js","./persistableUrlUtils-BcifXQ1Z.js","./collectionUtils-Dm1icNvk.js","./Portal-liet8xHC.js","./jsonUtils-Cma_7A64.js","./SnappingVisualizer2D-ChAoR0om.js","./vec2-B_ymkwGp.js","./vec2f64-Diu2Kaa8.js","./enums-BRXbslMp.js","./SnappingManager-GEHlVC1V.js","./projection-A9yUaaTs.js","./projectBuffer-vsa0P_cF.js","./geodesicConstants-XRAvAZCD.js","./elevationInfoUtils-Bl7QRRwv.js","./unitConversionUtils-Dl04YuQU.js","./lengthUtils-D7_DvYH0.js","./projectVectorToVector-Chzd0Pq0.js","./projectPointToVector-D3506wm2.js","./UpdatingHandles-CMtXpTiG.js","./vec42-B1mBkh1w.js","./vec4f64-CBQL1T0x.js","./geodesicUtils-iciHABcX.js","./plane-Bz78OrLf.js","./mat3f64-BBpwCtoL.js","./mat4f64-Dk4dwAN8.js","./quatf64-BrpT0VRp.js","./mathUtils-kvswLROa.js","./sphere-7666U3LO.js","./mat4-ybYUU6jq.js","./geometry2dUtils-BraNT6Fs.js","./FeatureFilter-BzdN7b7E.js","./TimeExtent-41gxTbrv.js","./timeUtils-DQR2jUPL.js","./Query-Cx4awVKu.js","./DataLayerSource-6X35yXpo.js","./Field-C8SaaeoI.js","./fieldType-CIG5ey7e.js","./FullTextSearch-BNIhEccm.js","./floorFilterUtils-DZ5C6FQv.js","./layerUtils-erzwAANv.js","./InputManager-C4xu1R9l.js","./Queue-DpHko4Yk.js","./signal-DzOfzcfh.js","./keybindings-DYR2fa8r.js","./utils-CXgSw6Sd.js","./layerViewUtils-D2JqIDZ8.js","./geodesicLengthMeasurementUtils-B9-VlVgL.js","./quantityUtils-d_-fFwhF.js","./geometryEngine-BT1Ysmbs.js","./geometryEngineBase-RmbNeFm7.js","./_commonjsHelpers-DCkdB7M8.js","./hydrated-DO_xxk1P.js","./Cyclical-BY_I03kj.js","./SnappingVisualizer-Bf7sK6KY.js","./PointSnappingHint-DzxtkBUe.js","./editPlaneUtils-C3Vm9Jgw.js","./coordinateFormatter-C5AdO4H_.js","./GraphicsLayer-D2NeCfd2.js","./GraphicsCollection-nEq2FD1R.js","./Layer-C96_yo4i.js","./BlendLayer-DmvCcS5c.js","./jsonUtils-C4Wp5KpV.js","./parser-BN6zmHl-.js","./utils-D20M4_S8.js","./mat4f32-DcsiF_Rp.js","./ScaleRangeLayer-CKYXLXxK.js","./ElevationInfo-BxYXLfrw.js","./dehydratedFeatureComparison-PUpfs3tZ.js","./createUtils-CTRjyrpN.js","./Circle-tfMUO3hu.js","./surfaceCoordinateSystems-CdeJZGsb.js","./memoize-DsJmrG76.js","./ReactiveSet-HYC-4KEs.js","./diffUtils--7ofoPN-.js","./ViewingMode-Dodu7ZZk.js","./EditGeometryOperations-BgVEmauk.js","./compilerUtils-BA04t1lN.js","./InteractiveToolBase-SWVoyXWH.js","./meshVertexSpaceUtils-CtidK-ZY.js","./MeshLocalVertexSpace-Xt9zU6DE.js","./hydratedFeatures-Cy9DBeYQ.js","./interfaces-D6pIddIh.js","./SketchLabelOptions-10TdxHmI.js","./SnappingContext-lR2hMWGP.js","./SnappingDragPipelineStep-DGxr0Y3r.js","./Scheduler-CDoWuxMK.js","./debugFlags-B3L9P_UW.js","./SnappingOperation-CqqVcxu4.js","./mat2d-DPkeMmgR.js","./mat2df64-CBKYtunK.js","./quat-ChS85qAG.js","./helpMessageUtils-M95XMmyR.js","./helpMessageUtils3d-C5Z3FjL3.js","./automaticAreaMeasurementUtils-Dw2EiOKK.js","./MeshTransform-DLV7aKpV.js","./axisAngleDegrees-CHCWDIqP.js","./Tooltip-CDfptYGq.js","./themeUtils-C3zvZbsE.js","./jsxFactory-CbAu6VfF.js","./uuid-fwrPAdZb.js","./a11yUtils-DwloBVAu.js","./unitFormatUtils-DYi2eq8E.js","./ByteSizeUnit-BsxeN7wM.js","./getDefaultUnitForView-CWbVfq0i.js","./quantityFormatUtils-B4_5cYn2.js","./directionModeIcons-Br5woIHu.js","./euclideanAreaMeasurementUtils-8yQ-wjr-.js","./earcut-BqgeR2O3.js","./triangle-B7rKLsGW.js","./lineSegment-BvgMMk26.js","./euclideanLengthMeasurementUtils-Cc80-VfJ.js","./spatialReferenceEllipsoidUtils-BL8s_3ls.js","./geodesicAreaMeasurementUtils-CotWVNCL.js","./automaticLengthMeasurementUtils-CTi-ql4E.js","./isSupportedObject-B5Os5oYN.js","./boundedPlane-CZE_hxQR.js","./cimSymbolUtils-D00GIWna.js","./utils-CO7DMJWl.js","./GraphicManipulator-CGNifz7r.js","./defaults-DCm7iNI6.js","./defaultsJSON-GKolV7NZ.js","./drapedUtils-CA19mSiA.js","./colorUtils-D5nOabzP.js","./drawUtils-DkE7nqj_.js","./hitTestSelectUtils-UXJPjatw.js","./screenUtils-BGG3AyYa.js","./editingTools-D7U_L-1g.js","./TextOverlayItem-BDobHoag.js","./SnappingVisualizer3D-IUWdRJ5u.js","./ExtendedLineVisualElement-B3F9g4qj.js","./vec4f32-CjrfB-0a.js","./frustum-DqmLJYYu.js","./EngineVisualElement-D9n6uvT5.js","./RenderGeometry-CXcYvifi.js","./vec3f32-Cw9Q6TO_.js","./DoubleArray-CF_CpVBS.js","./Texture-CcsX4Ue_.js","./NormalAttribute.glsl-Dqf1UPF9.js","./interfaces-B8ge7Jg9.js","./BindType-BmZEZMMh.js","./VertexAttribute-BnAa5VW0.js","./Util-BMqL_pkg.js","./enums-BlUEVwJR.js","./Texture-BbJIOVx_.js","./basicInterfaces-wONHx_SN.js","./mat3-DRqs2t5W.js","./ShaderTechniqueConfiguration-D3UbJ2mX.js","./doublePrecisionUtils-B0owpBza.js","./Indices-B6BGScAS.js","./Material-BN_i9QRJ.js","./renderState-PYzNpa1K.js","./requestImageUtils-DgB0_9qP.js","./orientedBoundingBox-COq6pSqo.js","./computeTranslationToOriginAndRotation-CLzktXYu.js","./ElevationProvider-BHZsEIDd.js","./verticalOffsetUtils-DaB1QvwW.js","./weather-TVtZwW4o.js","./Float4DrawUniform-CWdxHXQ-.js","./NestedMap-DgiGbX8E.js","./Octree-DQVAqpsn.js","./InterleavedLayout-UIhsB8jd.js","./BufferView-B7Z-dzh4.js","./floatRGBA-C8rGFKJ0.js","./Intersector-CYIO18dt.js","./glUtil-C6KhMg1m.js","./VertexElementDescriptor-BOD-G50G.js","./MemCache-C6WUx-5V.js","./VertexArrayObject-Cwnso4un.js","./BufferObject-CjYoWxgZ.js","./VisualElement-CT5Yhr5G.js","./Laserlines.glsl-DSK5aMw9.js","./PointVisualElement-IRdvOlNZ.js","./Object3DVisualElement-439h3v21.js","./ColorMaterial.glsl-CJh1RTEZ.js","./VertexColor.glsl-lPkEAKYQ.js","./RightAngleQuadVisualElement-D_e0y-o1.js","./DefaultLayouts-Bz7P2wdj.js","./settings-BLYOUyB2.js","./lineStippleUtils-BcQwIcXj.js","./triangulationUtils-D8OjVISe.js","./deduplicate-DxTSMkFY.js","./OutlineVisualElement-q0tmPeJN.js","./VerticesVisualElement-BanhXglT.js","./RenderObject-BOdCnfVB.js","./ray-DM1mbnrb.js","./GraphicState-TgtLVp_Q.js","./manipulatorUtils-B1UTsyu_.js","./MoveManipulation-T43M2rqF.js","./dragEventPipeline3D-CGTtUgxV.js","./SelectedVertexTooltipInfo-DnBOcPiz.js","./TranslateTooltipInfo-CvJfBEli.js","./utils-C1cS-0Yj.js","./LRUCache-ju6LnIBZ.js","./IViewEvents-Bci6PjlS.js","./SlicePlaneMaterial.glsl-CsvQGmT7.js","./sliceToolConfig-DLdTgbpM.js","./ImageMaterial.glsl-RtQG_3xX.js","./SlicePlane-DzUQ-3ue.js","./persistable-ZhNvqYX-.js","./MD5-C9MwAd2G.js","./multiOriginJSONSupportUtils-C0wm8_Yw.js","./resourceExtension-CNyCBDXT.js","./projectionUtils-KFirXguG.js","./LineVisualElement-CI_1KXfW.js","./RenderCoordsHelper-DgY-kqpV.js","./projectVectorToPoint-Cwe6B2HP.js","./Factory-DT237UGo.js","./ExtentScaleTooltipInfo-BIuMRyBC.js","./GraphicsLayerView3D-CYj9o1wo.js","./LayerView3D-DMyi427V.js","./heightModelInfoUtils-BSzg1Wnl.js","./HeightModelInfo-CSXZysDz.js","./arcgisLayerUrl-Cgl5IQFD.js","./queryForSymbologySnapping-C3o9B228.js","./GraphicsProcessor-CTv3mLav.js","./WaterSurface.glsl-BJUc652W.js","./vec2f32-BbH2jxlN.js","./dehydratedFeatures-fOLmpfQS.js","./quantizationUtils-CIQDbQFJ.js","./featureConversionUtils-DdoZh_25.js","./OptimizedFeature-7juV2tZm.js","./OptimizedGeometry-vU5jWBvU.js","./OptimizedFeatureSet-Blu9Ckm7.js","./edgeUtils-BIb6yRHm.js","./DecodeSymbolColor.glsl-CeBC4xQe.js","./vec3-C3Q-RF_i.js","./SnappingCandidate-O5eRSE6e.js","./visualVariableUtils-DzaXbn8H.js","./sizeVariableUtils-Cmcuvw-4.js","./Normals-D1LdtP06.js","./objectResourceUtils-DwPhzmLp.js","./devEnvironmentUtils-D6qIi8Ky.js","./vec4-L9zJLV3y.js","./Version-_Vxue7Ui.js","./CIMSymbolHelper-C1Ghh-WW.js","./BidiEngine-BwB1Df7c.js","./fontUtils-CILP_6vp.js","./GeometryUtils-BSPpv37S.js","./definitions-ByNBSgP9.js","./mat2df32-orApM5a3.js","./Rect-CUzevAry.js","./BoundingBox-BhuXqU4L.js","./OverrideHelper-C4oumxVn.js","./MeshComponent-D1ps11B9.js","./imageUtils-9KeT6Jbh.js","./MeshVertexAttributes-DVEL_Tlm.js","./projection-CJ-ESJIf.js","./styleUtils-DQEZjdpw.js","./webStyleSymbolUtils-BtUE3Q7L.js","./jsonUtils-C6dvhNjw.js","./Intersector-wnm5hmmT.js","./Graphics3DObjectStates-BWSTgD8k.js","./ClassBreaksRenderer-DMO3d0Rn.js","./UniqueValueRenderer-dci9bLM8.js","./colorRamps-CFlTi-ob.js","./SizeVariable-aYYWlweG.js","./ColorStop-CXfPDZon.js","./jsonUtils-CuoSmH2q.js","./FieldsIndex-IOXc-mnc.js","./UnknownTimeZone-D0GlcniK.js","./HeatmapColorStop-CgvKf0-E.js","./heatmapUtils-C-uT6ZIV.js","./SimpleRenderer-DvJZ7cyq.js","./rendererConversion-Dp1igvNJ.js","./basemapUtils-CkCKogG3.js","./Basemap-DhGpUWGY.js","./loadAll-DDw-urzS.js","./PortalItem-BuTU9OuN.js","./writeUtils-3wz9AuW7.js","./optimizedFeatureQueryEngineAdapter-Buta7wlw.js","./centroid-DdLmOD72.js","./PooledRBush-CGlhTzFe.js","./quickselect-D0_cvEX6.js","./popupUtils-sb3Ob2mW.js","./projectExtentUtils-C8xmByoE.js","./geometryServiceUtils-K7u_-O-B.js","./project-C_6NxEch.js","./utils-D61i9O7E.js","./utils-Dx8bgRIB.js","./LayerView-CbIY_4n2.js","./GraphicMover-CgfEhfye.js","./HighlightHelper-BmkMLZFD.js","./layerUtils-BS1Di3Pm.js","./featureUtils-2Q65ejfE.js","./utils-BaQRRNPl.js","./Box-B1mkzfrs.js","./settings-CxmqFnN7.js","./Reshape-DRMyIAjo.js"])))=>i.map(i=>d[i]);
import{_ as S}from"./index-CeCSsEgo.js";import{o as et,e as y}from"./Evented-CXIxDjmW.js";import{g as rt,k as st,j as R}from"./symbols-CsUQ5BxR.js";import{V as K,v as $,d as D,A as L,p as nt,w as W}from"./reactiveUtils-BFQ0BtrB.js";import{y as m,b as x,n as pt,c as lt}from"./subclass-BR3PhgZG.js";import{u as I,q as V,g as N,z as ht}from"./Accessor-D6mNnsWy.js";import{G as ct,g as dt}from"./Point-DB4Hp4hH.js";import{J as ut,_ as yt,W as mt,K as gt}from"./projection-A9yUaaTs.js";import{k as Z}from"./Polyline-D97hl-6E.js";import vt from"./GraphicsLayer-D2NeCfd2.js";import{m as _t}from"./layerUtils-erzwAANv.js";import{P as G,l as ot,r as ft,E as q,p as bt,a as Ot}from"./isSupportedObject-B5Os5oYN.js";import{v as wt,l as Et,f as Gt}from"./elevationInfoUtils-Bl7QRRwv.js";import{e as Y}from"./layerUtils-BS1Di3Pm.js";import{_ as w}from"./InputManager-C4xu1R9l.js";import{p as f}from"./keybindings-DYR2fa8r.js";import{c as Tt}from"./SketchLabelOptions-10TdxHmI.js";import{k as at,I as z,N as St}from"./SnappingManager-GEHlVC1V.js";import{r as At}from"./hitTestSelectUtils-UXJPjatw.js";import{n as B}from"./screenUtils-BGG3AyYa.js";import{n as Mt}from"./compilerUtils-BA04t1lN.js";import{y as J,S as Ct,d as kt}from"./TextSymbol-gKE-H_J6.js";function Rt(t){return Dt(t).result}function Dt(t){var o;if(t.graphic&&((o=t.graphic.layer)==null?void 0:o.type)!=="graphics")return{result:G.GRAPHICS_LAYER_MISSING};if(!t.operations)return{result:G.GEOMETRY_MISSING};if(wt(t.elevationInfo))return{result:G.ELEVATION_MODE_UNSUPPORTED};const e=t.operations.data.type,a=t.operations.data.geometry;return e==="point"||e==="mesh"||e==="polyline"||e==="polygon"?{result:G.SUPPORTED,geometry:a}:{result:G.GEOMETRY_TYPE_UNSUPPORTED}}function It(t){var a;if(((a=t.layer)==null?void 0:a.type)!=="graphics")return G.GRAPHICS_LAYER_MISSING;if(t.geometry==null)return G.GEOMETRY_MISSING;switch(t.geometry.type){case"point":break;case"polygon":case"polyline":case"multipoint":case"extent":case"mesh":return G.SUPPORTED;default:return G.GEOMETRY_TYPE_UNSUPPORTED}const e=t.symbol!=null&&t.symbol.type==="point-3d"&&t.symbol.symbolLayers;return!e||!e.some(o=>o.type==="object")?G.SYMBOL_TYPE_UNSUPPORTED:Et(t)!=="on-the-ground"&&Gt(t)?G.ELEVATION_MODE_UNSUPPORTED:G.SUPPORTED}let E=class extends et.EventedAccessor{constructor(t){super(t),this.cancelled=!1,this.history={undo:[],redo:[]},this.type=null}get tool(){if(!this.activeComponent)return null;switch(this.activeComponent.type){case"graphic-mover":case"move-3d":return"move";case"box":case"transform-3d":return"transform";case"reshape":case"reshape-3d":return"reshape";case"draw-2d":case"draw-3d":return this.activeComponent.geometryType;default:Mt(this.activeComponent)}return null}addToHistory(t){this.history.redo=[],this.history.undo.push(t)}resetHistory(){this.history.redo=[],this.history.undo=[]}canUndo(){return this.history.undo.length>0}canRedo(){return this.history.redo.length>0}complete(){this._reset(),this.onEnd(),this.emit("complete")}cancel(){this.cancelled=!0,this.complete()}_reset(){var t;(t=this.activeComponent)==null||t.reset()}refreshComponent(){const t=this.activeComponent;t&&(t.type!=="box"&&t.type!=="reshape"&&t.type!=="graphic-mover"||t.refresh())}set undo(t){this._set("undo",()=>{this.canUndo()&&t()})}set redo(t){this._set("redo",()=>{this.canRedo()&&t()})}};y([m()],E.prototype,"activeComponent",void 0),y([m()],E.prototype,"cancelled",void 0),y([m()],E.prototype,"history",void 0),y([m()],E.prototype,"tool",null),y([m()],E.prototype,"type",void 0),y([m()],E.prototype,"canUndo",null),y([m()],E.prototype,"canRedo",null),y([m()],E.prototype,"onEnd",void 0),y([m()],E.prototype,"undo",null),y([m()],E.prototype,"redo",null),y([m()],E.prototype,"toggleTool",void 0),y([m()],E.prototype,"addToSelection",void 0),y([m()],E.prototype,"removeFromSelection",void 0),E=y([x("esri.widgets.Sketch.support.OperationHandle")],E);let U=class extends E{};y([m()],U.prototype,"activeComponent",void 0),U=y([x("esri.widgets.Sketch.support.OperationHandle.CreateOperationHandle")],U);let A=class extends E{};y([m()],A.prototype,"activeComponent",void 0),A=y([x("esri.widgets.Sketch.support.OperationHandle.UpdateOperationHandle")],A);const Q={defaultZ:0},C={reshapeOptions:{edgeOperation:"split",shapeOperation:"move",vertexOperation:"move"},enableMoveAllGraphics:!0,enableRotation:!0,enableScaling:!0,multipleSelectionEnabled:!0,preserveAspectRatio:!1,toggleToolOnClick:!0,enableZ:!0,highlightOptions:{enabled:!0},tool:"transform"};let v=class extends et.EventedAccessor{constructor(t){var e;super(t),this._numUpdating=0,this._defaultSnappingManager=null,this._internalGraphicsLayer=new vt({listMode:"hide",internal:!0,title:"SVM Internal"}),this._operationHandle=null,this._viewHandlesKey="viewHandles",this.activeFillSymbol=null,this.activeLineSymbol=null,this.activeVertexSymbol=null,this.allowDeleteKey=!0,this.layer=null,this.pointSymbol=new J({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this.polygonSymbol=new Ct({color:[150,150,150,.2],outline:{color:[50,50,50],width:2}}),this.polylineSymbol=new kt({color:[130,130,130,1],width:2}),this.meshSymbol=new rt({symbolLayers:new K([new st])}),this.updateGraphics=new K,this.updateOnGraphicClick=!0,this.vertexSymbol=new J({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this.sketchOptions=new ot,this._moduleLoaderAbortController=null,this._viewReadyAbortController=null,this._originalPopupEnabled=null,this.defaultCreateOptions=Q,this.defaultUpdateOptions=C,this.snappingOptions=((e=t==null?void 0:t.snappingManager)==null?void 0:e.options)??(t==null?void 0:t.snappingOptions)??new at}initialize(){this.addHandles([$(()=>{var t,e;return(e=(t=this.view)==null?void 0:t.map)==null?void 0:e.layers},"change",t=>{t.removed.includes(this.layer)&&this.cancel()}),$(()=>{var t;return(t=this.layer)==null?void 0:t.graphics},"change",t=>{if(this._operationHandle!=null)for(const e of t.removed)this.updateGraphics.includes(e)&&(this.updateGraphics.length>1?this._operationHandle.removeFromSelection(e):this._operationHandle.cancel())}),D(()=>{var t;return((t=this.layer)==null?void 0:t.elevationInfo)??null},t=>{t!==this._internalGraphicsLayer.elevationInfo&&(this.cancel(),this._internalGraphicsLayer.elevationInfo=t)},L),D(()=>this.view,t=>{this._defaultSnappingManager=I(this._defaultSnappingManager),t&&(this.snappingManager||(this._defaultSnappingManager=new z({view:t,options:this.snappingOptions})),t.type==="2d"?S(()=>import("./editingTools-BsHNqIWH.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157]),import.meta.url):t.type==="3d"&&(S(()=>import("./editingTools-D7U_L-1g.js"),__vite__mapDeps([158,1,2,3,154,23,24,13,51,52,17,18,45,6,7,8,9,10,11,46,47,98,19,20,21,4,5,12,29,136,84,79,133,134,38,39,54,55,56,57,58,135,35,159,130,131,145,142,48,43,44,49,42,143,78,80,81,82,83,53,160,161,162,163,59,60,141,164,26,165,166,167,168,169,170,171,108,172,173,174,175,176,177,178,179,180,181,106,140,182,183,184,122,185,186,147,187,112,14,15,16,22,25,27,28,30,31,32,33,34,36,127,188,117,74,118,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,41,50,61,62,63,64,65,66,67,68,69,70,71,72,73,75,76,77,85,86,208,209,210,211,139,212,213,214,215,216,113,217,87,88,89,90,91,92,93,94,95,96,97,99,100,101,102,103,104,105,107,109,110,111,114,115,116,119,120,121,123,124,125,126,128,129,132,137,138,144,146,218,219,220,221,222,223,148,149,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,150,151,152,153]),import.meta.url),S(()=>import("./GraphicsLayerView3D-CYj9o1wo.js"),__vite__mapDeps([240,1,2,3,17,18,241,242,243,7,9,10,11,6,8,244,33,245,4,5,12,13,49,42,43,44,48,45,46,47,165,39,166,167,168,169,170,171,108,172,173,51,52,174,175,176,38,177,55,56,60,178,179,180,181,106,140,59,54,57,58,141,182,183,184,122,143,185,186,147,187,112,14,15,16,19,20,21,22,23,24,25,26,27,28,29,30,31,32,34,35,36,163,127,188,117,74,118,189,190,191,192,193,194,195,196,197,198,199,200,246,105,50,91,63,64,247,205,206,248,249,250,67,68,251,252,253,254,255,256,139,82,257,258,259,260,211,212,261,262,263,264,265,266,267,268,269,40,149,270,120,271,272,273,151,152,274,154,148,223,93,94,95,96,224,210,237,275,276,277,110,111,278,208,279,280,281,71,282,65,66,69,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,72,73,305,77,306,307,308,309,310,311]),import.meta.url)))},L),D(()=>{var t;return(t=this.view)==null?void 0:t.spatialReference},(t,e)=>{t&&e&&!t.equals(e)&&this.cancel()})]),St(this)}destroy(){this.cancel(),this._removeDefaultLayer(),this._defaultSnappingManager=I(this._defaultSnappingManager),this._set("snappingManager",null),this._set("view",null),this.emit("destroy")}get updating(){return this._numUpdating>0||this.snappingManager!=null&&this.snappingManager.updating}get activeTool(){var t;return((t=this._operationHandle)==null?void 0:t.tool)??null}get activeComponent(){var t;return((t=this._operationHandle)==null?void 0:t.activeComponent)??null}get createGraphic(){return this.activeComponent==null||this.activeComponent.type!=="draw-3d"&&this.activeComponent.type!=="draw-2d"?this._get("createGraphic"):this.activeComponent.graphic}get defaultCreateOptions(){return this._get("defaultCreateOptions")}set defaultCreateOptions(t){this._set("defaultCreateOptions",{...Q,...t})}get defaultUpdateOptions(){return this._get("defaultUpdateOptions")}set defaultUpdateOptions(t){this._set("defaultUpdateOptions",{...C,...t,reshapeOptions:{...C.reshapeOptions,...t==null?void 0:t.reshapeOptions},highlightOptions:{...C.highlightOptions,...t==null?void 0:t.highlightOptions}})}get labelOptions(){return this.sketchOptions.labels}set labelOptions(t){this.sketchOptions.labels=t}get snappingOptions(){var t;return((t=this.snappingManager)==null?void 0:t.options)??this._get("snappingOptions")}set snappingOptions(t){this._defaultSnappingManager!=null&&(this._defaultSnappingManager.options=t),this._set("snappingOptions",t)}get snappingManager(){return this._isOverridden("snappingManager")&&this._get("snappingManager"),this._defaultSnappingManager}set snappingManager(t){if(t)this._isOverridden("snappingManager")||(this._defaultSnappingManager=I(this._defaultSnappingManager)),this._override("snappingManager",t);else{const{view:e}=this;!this._defaultSnappingManager&&e&&(this._defaultSnappingManager=new z({options:this.snappingOptions,view:e})),this._clearOverride("snappingManager")}}get state(){var a;const t=!(!((a=this.view)!=null&&a.ready)||!this.layer),e=this._operationHandle;return t&&e?"active":t?"ready":"disabled"}get tooltipOptions(){return this.sketchOptions.tooltips}set tooltipOptions(t){this.sketchOptions.tooltips=t}get valueOptions(){return this.sketchOptions.values}set valueOptions(t){this.sketchOptions.values=t}get view(){return this._get("view")}set view(t){const e=this._get("view");if(e){const{container:o,map:i}=e;o&&(e.cursor=null),i==null||i.remove(this._internalGraphicsLayer),this.removeHandles(this._viewHandlesKey),this.cancel()}const a="view-ready";this.removeHandles(a),t&&this.addHandles(nt(()=>t.ready,o=>{this.removeHandles(this._viewHandlesKey),o&&this.addHandles(this._generateViewHandles(t),this._viewHandlesKey)},L),a),this._set("view",t)}cancel(){this._moduleLoaderAbortController=V(this._moduleLoaderAbortController),this._viewReadyAbortController=V(this._viewReadyAbortController),this._operationHandle&&this._operationHandle.cancel()}complete(){this._operationHandle&&this._operationHandle.complete()}delete(){const{state:t,updateGraphics:e}=this;if(t==="active"&&e.length){const{activeTool:a,layer:o}=this,i=e.toArray();o.removeMany(i),this.cancel(),this._emitDeleteEvent({graphics:i,tool:a})}}duplicate(){if(this.state==="active"&&this.updateGraphics.length){const t=this.updateGraphics.map(e=>e.clone()).toArray();return this.layer.addMany(t),this.emit("duplicate",{graphics:t,type:"duplicate"}),t}return[]}async create(t,e){this.cancel(),await this._waitViewReady();const{view:a,layer:o}=this;if(!a||this.state==="disabled")throw o||this._logMissingLayer(),N();if(a.activeTool!=null&&(a.activeTool=null),!t)return void this._logError("sketch:missing-parameter","Missing parameter 'tool'.");Y(a,this._internalGraphicsLayer);const i=await this._setupCreateOperation(t,e);if(i==null||this.destroyed)return void a.map.remove(this._internalGraphicsLayer);const r=()=>{var c;if(i===this._operationHandle){const s=this.createGraphic,h=this._operationHandle.cancelled;this._operationHandle.destroy(),this._operationHandle=null,this._set("createGraphic",null),(c=this.view)!=null&&c.map&&this.view.map.remove(this._internalGraphicsLayer),i.cancelled||s==null||o.add(s),this.emit("create",{graphic:s,state:h?"cancel":"complete",tool:t,toolEventInfo:null,type:"create"})}};i.on("complete",r),this._operationHandle=i,a.ready&&a.focus()}async place(t,e){return this.create("mesh",{mode:"click",hasZ:t.hasZ,geometryToPlace:t,...e})}async update(t,e){this.cancel(),await this._waitViewReady();const{layer:a,view:o,state:i}=this;if(!o||i==="disabled")throw a||this._logMissingLayer(),N();o.activeTool!=null&&(o.activeTool=null);const r=Array.isArray(t)?t:[t];if(t==null||!(r!=null&&r.length))return void this._logError("sketch:missing-parameter","Missing parameter 'graphics'.");if(r.some(s=>s.layer!==a?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics missing from the supplied GraphicsLayer."),!0):s.geometry==null&&(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with an unsupported geometry."),!0)))return;const c=await this._setupUpdateOperation(r,e);this.destroyed||c==null||O(c)||(Y(o,this._internalGraphicsLayer),this._setUpdateOperationHandle(c,e),this.emit("update",{graphics:r,state:"start",aborted:!1,tool:c.tool,toolEventInfo:null,type:"update"}))}async _updateSpatialReference(t){const e=this.view;if(e){this._beginAsyncOperation(),t=Array.isArray(t)?t:[t];for(const a of t)a.geometry==null||a.geometry.type==="mesh"||ct(a.geometry.spatialReference,e.spatialReference)||(ut(a.geometry.spatialReference,e.spatialReference)||yt()||await mt(),a.geometry=gt(a.geometry,e.spatialReference));this._endAsyncOperation()}else this._logMissingView()}undo(){var t;this.canUndo()&&((t=this._operationHandle)==null||t.undo())}redo(){var t;this.canRedo()&&((t=this._operationHandle)==null||t.redo())}canUndo(){var t;return!!((t=this._operationHandle)!=null&&t.canUndo())}canRedo(){var t;return!!((t=this._operationHandle)!=null&&t.canRedo())}toggleUpdateTool(){var t;(t=this._operationHandle)==null||t.toggleTool()}async _getFirstHit(t){const e=this.view;if(!e)return this._logMissingView(),null;if(e.type==="2d"){const i=[];e.map.allLayers.forEach(c=>{c.type!=="vector-tile"&&c.type!=="imagery"||i.push(c)});const r=await e.hitTest(t,{exclude:i});return At(r.results)}const a=[e.map.ground];e.map.allLayers.forEach(i=>{_t(i.type)&&a.push(i)});const o=await e.hitTest(t,{exclude:a});if(o.results.length>0){const i=o.results[0];if(i!=null&&i.type==="graphic"&&i.graphic&&(!o.ground.mapPoint||e.map.ground.opacity<1||o.ground.distance-(i.distance??0)>-Math.min(3*o.ground.distance,e.viewingMode==="global"?dt(e.renderCoordsHelper.spatialReference).radius/e.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY)))return i}return null}_generateViewHandles(t){return[t.on("immediate-click",async e=>{var r;const a=this.state==="active"&&((r=this._operationHandle)==null?void 0:r.type)==="create";if(this.state==="disabled"||a||!this.updateOnGraphicClick)return;this._beginAsyncOperation();const o=await e.async(()=>this._getFirstHit(B(e)));let i=null;if(o!=null){const c=o.graphic;this.updateGraphics.includes(c)||c.layer===this.layer?(e.stopPropagation(),i=c):t.type!=="2d"||this._isComponentGraphic(c)||this.state!=="active"||this.cancel()}else this.state==="active"&&this.cancel();i==null||this.updateGraphics.includes(i)||await this.update([i],{...this.defaultUpdateOptions,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions}}),this._endAsyncOperation()},w.WIDGET)]}async _setupCreateOperation(t,e){const a=this.view;if(!a)return this._logMissingView(),null;const o={hasZ:a.type==="3d",...this.defaultCreateOptions,...e},i=await this._setupDrawGraphicTool(t,a,o);return i==null?null:(a.tools.add(i),a.activeTool=i,this._setupCreateOperationHandle(i))}async _setupDrawGraphicTool(t,e,a){if(t==="multipoint"&&e.type==="3d")return this._logError("sketch:create","Multipoint geometries are not supported in SceneView."),null;if(!e)return this._logMissingView(),null;const{cursor:o,defaultZ:i,hasZ:r,geometryToPlace:c,graphicProperties:s,mode:h,preserveAspectRatio:n}=a,p=t==="rectangle"||t==="circle"?"hybrid":"click",l=n??t!=="rectangle",g={centered:t!=="rectangle"&&!(t==="circle"&&!l),cursor:o,defaultZ:i,forceUniformSize:l,graphicProperties:s,geometryToPlace:c,geometryType:t,graphicSymbol:this._getGraphicSymbolFromTool(t),hasZ:r,mode:h??p,snappingManager:this.snappingManager,snapToScene:!1,view:e};return e.type==="2d"?this._makeDrawGraphicTool2D(g):this._makeDrawGraphicTool3D(g)}async _makeDrawGraphicTool2D(t){const e=await this._requireModule(S(()=>import("./editingTools-BsHNqIWH.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157]),import.meta.url));return O(e)||this.destroyed?null:new e.module.DrawGraphicTool2D({...t,activeVertexSymbol:this.activeVertexSymbol,regularVerticesSymbol:this.vertexSymbol,activeLineSymbol:this.activeLineSymbol,activeFillSymbol:Pt(t.geometryType)?this.activeFillSymbol:null,sketchOptions:this.sketchOptions})}async _makeDrawGraphicTool3D(t){const e=await this._requireModule(S(()=>import("./editingTools-D7U_L-1g.js"),__vite__mapDeps([158,1,2,3,154,23,24,13,51,52,17,18,45,6,7,8,9,10,11,46,47,98,19,20,21,4,5,12,29,136,84,79,133,134,38,39,54,55,56,57,58,135,35,159,130,131,145,142,48,43,44,49,42,143,78,80,81,82,83,53,160,161,162,163,59,60,141,164,26,165,166,167,168,169,170,171,108,172,173,174,175,176,177,178,179,180,181,106,140,182,183,184,122,185,186,147,187,112,14,15,16,22,25,27,28,30,31,32,33,34,36,127,188,117,74,118,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,41,50,61,62,63,64,65,66,67,68,69,70,71,72,73,75,76,77,85,86,208,209,210,211,139,212,213,214,215,216,113,217,87,88,89,90,91,92,93,94,95,96,97,99,100,101,102,103,104,105,107,109,110,111,114,115,116,119,120,121,123,124,125,126,128,129,132,137,138,144,146,218,219,220,221,222,223,148,149,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,150,151,152,153]),import.meta.url));if(O(e)||this.destroyed)return null;const{elevationInfo:a}=this.layer;return new e.module.DrawGraphicTool3D({...t,elevationInfo:a,snapToScene:!0,sketchOptions:this.sketchOptions})}_setupCreateOperationHandle(t){const e=this.view;if(!e)return this._logMissingView(),null;let a=null;const o=t.forceUniformSize,i=t.centered,r=[e.on("key-down",s=>{if(s.key===f.pan)s.stopPropagation(),s.repeat||(t.enabled=!1);else if(s.key===f.complete)s.stopPropagation(),t.completeCreateOperation();else if(s.key!==f.vertexAdd||s.repeat)s.key===f.undo?(s.stopPropagation(),c.undo()):s.key===f.redo?(s.stopPropagation(),c.redo()):s.key!==f.constraint||t.geometryType!=="rectangle"&&t.geometryType!=="circle"||s.repeat?s.key===f.center&&(s.repeat||(t.centered=!i,s.stopPropagation())):(t.forceUniformSize=!o,s.stopPropagation());else{const h=t.drawOperation.geometryType;h!=="polyline"&&h!=="polygon"&&h!=="multipoint"||(s.stopPropagation(),t.drawOperation.commitStagedVertex())}},w.WIDGET),e.on("key-up",s=>{s.key===f.pan?t.enabled=!0:s.key!==f.constraint||t.geometryType!=="rectangle"&&t.geometryType!=="circle"?s.key===f.center&&(t.centered=i,s.stopPropagation()):(t.forceUniformSize=o,s.stopPropagation())},w.WIDGET),t.on("vertex-add",s=>{switch(a=a==null?"start":"active",s.operation){case"apply":this.emit("create",{graphic:t.graphic,state:a,tool:this.activeTool,toolEventInfo:s,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[t.graphic],tool:t.geometryType});break;case"redo":this._emitRedoEvent({graphics:[t.graphic],tool:t.geometryType})}}),t.on("cursor-update",s=>{t.drawOperation.numCommittedVertices>0&&this.emit("create",{graphic:t.graphic,state:"active",tool:this.activeTool,toolEventInfo:{coordinates:s.vertices[0].coordinates,type:"cursor-update"},type:"create"})}),t.on("vertex-remove",s=>{switch(s.operation){case"apply":this.emit("create",{graphic:t.graphic,state:"active",tool:this.activeTool,toolEventInfo:s,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[t.graphic],tool:t.geometryType});break;case"redo":this._emitRedoEvent({graphics:[t.graphic],tool:t.geometryType})}}),t.on("complete",s=>{this._set("createGraphic",s.graphic),a="complete",s.aborted?c&&c.cancel():c&&c.complete()}),D(()=>this._getGraphicSymbolFromTool(t.geometryType),s=>{t.graphicSymbol=s})],c=new U({activeComponent:t,tool:t.geometryType,type:"create",onEnd:()=>{var s;r.forEach(h=>h.remove()),r.length=0,(s=e.tools)==null||s.remove(t)},undo:()=>{t.canUndo&&t.undo()},redo:()=>{t.canRedo&&t.redo()},canUndo:()=>t.canUndo,canRedo:()=>t.canRedo});return c}_getGraphicSymbolFromTool(t){switch(t){case"point":case"multipoint":return this.pointSymbol;case"polyline":return this.polylineSymbol;case"circle":case"rectangle":case"polygon":return this.polygonSymbol;case"mesh":return this.meshSymbol}}async _setupUpdateOperation(t,e){var c;const{layer:a,view:o}=this;if(!o)return this._logMissingView(),null;const i={...this.defaultUpdateOptions,...e,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions,...e==null?void 0:e.reshapeOptions},highlightOptions:{...this.defaultUpdateOptions.highlightOptions,...e==null?void 0:e.highlightOptions}};let r=i.tool??C.tool;for(const s of t)a.remove(s),a.add(s);if(o.type==="3d"){if(t.length===0)return null;switch(r){case"move":return this._setupMove3DOperation(t,i,o,r);case"reshape":return t.length>1?(this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null):this._setupReshape3DOperation(t[0],i,o);case"transform":return this._setupGraphicTransform3DOperation(t,i,o)}}switch(r){case"move":return this._setupMove2DOperation(t,i,o);case"reshape":return t.length>1?(this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null):this._setupTransformOrReshape2DOperation(t,r,i,o);case"transform":if(t.length===1){const s=(c=t[0].geometry)==null?void 0:c.type;s!=="point"&&s!=="multipoint"||(r="reshape")}return this._setupTransformOrReshape2DOperation(t,r,i,o)}}async _setupMove3DOperation(t,e,a,o,i=!1){const r=await this._requireModule(S(()=>import("./editingTools-D7U_L-1g.js"),__vite__mapDeps([158,1,2,3,154,23,24,13,51,52,17,18,45,6,7,8,9,10,11,46,47,98,19,20,21,4,5,12,29,136,84,79,133,134,38,39,54,55,56,57,58,135,35,159,130,131,145,142,48,43,44,49,42,143,78,80,81,82,83,53,160,161,162,163,59,60,141,164,26,165,166,167,168,169,170,171,108,172,173,174,175,176,177,178,179,180,181,106,140,182,183,184,122,185,186,147,187,112,14,15,16,22,25,27,28,30,31,32,33,34,36,127,188,117,74,118,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,41,50,61,62,63,64,65,66,67,68,69,70,71,72,73,75,76,77,85,86,208,209,210,211,139,212,213,214,215,216,113,217,87,88,89,90,91,92,93,94,95,96,97,99,100,101,102,103,104,105,107,109,110,111,114,115,116,119,120,121,123,124,125,126,128,129,132,137,138,144,146,218,219,220,221,222,223,148,149,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,150,151,152,153]),import.meta.url));if(O(r))return r;const{ManipulatedObject3DGraphic:c,MoveTool3D:s}=r.module,h=new Map,n=()=>{h.forEach(u=>u.destroy()),h.clear()};for(const u of t){const d=new c({view:a,graphic:u}),b=ft(d);if(b!==G.SUPPORTED)return n(),this._logError("sketch:move",`Move operation not supported for provided graphic(s) (${q(b)}).`),null;h.set(u,d)}const p=new s({view:a,enableZ:e.enableZ,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});a.tools.add(p),p.objects.addMany(Array.from(h.values())),i||this.updateGraphics.addMany(t);const l=[],g=new A({activeComponent:p,tool:o,type:"update",onEnd:()=>{var u;l.forEach(d=>d.remove()),l.length=0,(u=a.tools)==null||u.remove(p),p.destroyed||p.destroy(),n()},undo:()=>{tt(this.view,p),H(g,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:o})},redo:()=>{P(g,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:o})},addToSelection:u=>{this.updateGraphics.push(u);const d=new c({view:a,graphic:u});h.set(u,d),p.objects.push(d),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[u],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:u=>{const d=this.updateGraphics.indexOf(u);if(g.history.undo.forEach(T=>T.updates.splice(d,1)),g.history.redo.forEach(T=>T.updates.splice(d,1)),this.updateGraphics.remove(u),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[u],type:"selection-change"},type:"update"}),this.updateGraphics.length===0)return void g.complete();const b=h.get(u);b&&(p.objects.remove(b),b.destroy(),h.delete(u))},toggleTool:async()=>{if(this.updateGraphics.length!==1||e.toggleToolOnClick===!1||o!=="transform")return;const u=this.updateGraphics.at(0),d=await this._setupReshape3DOperation(u,e,a,!0);d&&!O(d)&&(g.onEnd(),g.destroy(),this._setUpdateOperationHandle(d,e))}});return l.push(...this._getHandlesForComponent(g,e),a.on("immediate-click",u=>this._getCommonUpdateOperationClickHandlers(g,u,e),w.WIDGET),a.on("key-down",u=>{this._getCommonUpdateOperationKeyDownHandlers(g,u)},w.WIDGET)),g}_setupGraphicTransform3DOperation(t,e,a,o=!1){if(t.length===1&&It(t[0])===G.SUPPORTED){const i=t[0],r=i.geometry;if(r!=null&&(r.type==="point"||r.type==="mesh"))return this._setupPointTransform3DOperation(i,e,a);if(r!=null&&(r.type==="polygon"||r.type==="polyline"))return this._setupPolyTransform3DOperation(i,e,a,o)}return this._setupMove3DOperation(t,e,a,"transform",o)}async _setupPointTransform3DOperation(t,e,a){const o="transform",{enableRotation:i,enableScaling:r,enableZ:c}=e,s=await this._requireModule(S(()=>import("./editingTools-D7U_L-1g.js"),__vite__mapDeps([158,1,2,3,154,23,24,13,51,52,17,18,45,6,7,8,9,10,11,46,47,98,19,20,21,4,5,12,29,136,84,79,133,134,38,39,54,55,56,57,58,135,35,159,130,131,145,142,48,43,44,49,42,143,78,80,81,82,83,53,160,161,162,163,59,60,141,164,26,165,166,167,168,169,170,171,108,172,173,174,175,176,177,178,179,180,181,106,140,182,183,184,122,185,186,147,187,112,14,15,16,22,25,27,28,30,31,32,33,34,36,127,188,117,74,118,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,41,50,61,62,63,64,65,66,67,68,69,70,71,72,73,75,76,77,85,86,208,209,210,211,139,212,213,214,215,216,113,217,87,88,89,90,91,92,93,94,95,96,97,99,100,101,102,103,104,105,107,109,110,111,114,115,116,119,120,121,123,124,125,126,128,129,132,137,138,144,146,218,219,220,221,222,223,148,149,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,150,151,152,153]),import.meta.url));if(O(s))return s;const{TransformTool3D:h,ManipulatedObject3DGraphic:n}=s.module,p=new n({graphic:t,view:a}),l=new h({object:p,view:a,enableRotation:i,enableScaling:r,enableZ:c,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});a.tools.add(l),this.updateGraphics.add(t);const g=[],u=new A({activeComponent:l,tool:o,type:"update",onEnd:()=>{var d;g.forEach(b=>b.remove()),g.length=0,(d=a.tools)==null||d.remove(l),l.destroyed||l.destroy(),p.destroy()},undo:()=>{tt(this.view,l),H(u,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:o})},redo:()=>{P(u,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:o})},addToSelection:async d=>{this.updateGraphics.add(d),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[d],removed:[],type:"selection-change"},type:"update"}),u.onEnd(),u.destroy();const b=await this._setupMove3DOperation(this.updateGraphics.toArray(),e,a,"transform",!0);O(b)||this._setUpdateOperationHandle(b,e)},removeFromSelection:d=>{this.updateGraphics.remove(d),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[d],type:"selection-change"},type:"update"}),u.complete()},toggleTool:()=>{}});return g.push(...this._getHandlesForComponent(u,e),a.on("immediate-click",d=>this._getCommonUpdateOperationClickHandlers(u,d,e),w.WIDGET),a.on("key-down",d=>{this._getCommonUpdateOperationKeyDownHandlers(u,d)},w.WIDGET)),u}async _setupPolyTransform3DOperation(t,e,a,o=!1){var j,F;const i="transform",{enableRotation:r,enableScaling:c,enableZ:s,preserveAspectRatio:h}=e,n=await this._requireModule(S(()=>import("./editingTools-D7U_L-1g.js"),__vite__mapDeps([158,1,2,3,154,23,24,13,51,52,17,18,45,6,7,8,9,10,11,46,47,98,19,20,21,4,5,12,29,136,84,79,133,134,38,39,54,55,56,57,58,135,35,159,130,131,145,142,48,43,44,49,42,143,78,80,81,82,83,53,160,161,162,163,59,60,141,164,26,165,166,167,168,169,170,171,108,172,173,174,175,176,177,178,179,180,181,106,140,182,183,184,122,185,186,147,187,112,14,15,16,22,25,27,28,30,31,32,33,34,36,127,188,117,74,118,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,41,50,61,62,63,64,65,66,67,68,69,70,71,72,73,75,76,77,85,86,208,209,210,211,139,212,213,214,215,216,113,217,87,88,89,90,91,92,93,94,95,96,97,99,100,101,102,103,104,105,107,109,110,111,114,115,116,119,120,121,123,124,125,126,128,129,132,137,138,144,146,218,219,220,221,222,223,148,149,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,150,151,152,153]),import.meta.url));if(O(n))return n;const{ManipulatedObject3DGraphic:p,ExtentTransformTool:l}=n.module,g=(F=(j=this.view)==null?void 0:j.inputManager)==null?void 0:F.isModifierKeyDown(f.constraint),u=new p({view:a,graphic:t}),d=new l({object:u,view:a,enableRotation:r,enableScaling:c,enableZ:s,preserveAspectRatio:!!h!=!!g,sketchOptions:this.sketchOptions});a.tools.add(d),o||this.updateGraphics.add(t);const b=[],T=new A({activeComponent:d,tool:i,type:"update",onEnd:()=>{var _;b.forEach(k=>k.remove()),b.length=0,(_=a.tools)==null||_.remove(d),d.destroyed||d.destroy(),u.destroy()},canUndo:()=>d.canUndo,undo:()=>{d.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:i})},canRedo:()=>d.canRedo,redo:()=>{d.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:i})},addToSelection:async _=>{this.updateGraphics.add(_),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[_],removed:[],type:"selection-change"},type:"update"}),T.onEnd(),T.destroy();const k=await this._setupMove3DOperation(this.updateGraphics.toArray(),e,a,"transform",!0);O(k)||this._setUpdateOperationHandle(k,e)},removeFromSelection:_=>{this.updateGraphics.remove(_),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[_],type:"selection-change"},type:"update"}),T.complete()},toggleTool:async()=>{if(this.updateGraphics.length!==1||e.toggleToolOnClick===!1)return;const _=await this._setupReshape3DOperation(t,e,a,!0);_&&!O(_)&&(T.onEnd(),T.destroy(),this._setUpdateOperationHandle(_,e))}});return b.push(...this._getHandlesForComponent(T,e),a.on("immediate-click",_=>this._getCommonUpdateOperationClickHandlers(T,_,e),w.WIDGET),a.on("key-down",_=>this._getCommonUpdateOperationKeyDownHandlers(T,_),w.WIDGET),a.on("key-down",_=>{_.key!==f.constraint||_.repeat||(d.preserveAspectRatio=!d.preserveAspectRatio,_.stopPropagation())},w.WIDGET),a.on("key-up",_=>{_.key===f.constraint&&(d.preserveAspectRatio=!d.preserveAspectRatio,_.stopPropagation())},w.WIDGET)),T}async _setupMove2DOperation(t,e,a){const o="move";this.updateGraphics.addMany(t),await this._updateSpatialReference(t);const i=await this._getGraphicMover(t,e,a);if(O(i))return i;const r=new A({activeComponent:i,tool:o,type:"update",onEnd:()=>{var n;this._displayDefaultCursor(),h.forEach(p=>p.remove()),s.forEach(p=>p.remove()),h=[],s=[],i.destroy(),(n=this._internalGraphicsLayer)==null||n.removeMany([...this.updateGraphics.toArray()])},undo:()=>{const n=this.updateGraphics.toArray();H(r,n),r.refreshComponent(),this._emitUndoEvent({graphics:n,tool:o})},redo:()=>{const n=this.updateGraphics.toArray();P(r,n),r.refreshComponent(),this._emitRedoEvent({graphics:n,tool:o})},addToSelection:async n=>{await this._updateSpatialReference(n),this.updateGraphics.push(n),i.graphics=this.updateGraphics.toArray(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[n],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:n=>{const p=this.updateGraphics.indexOf(n);r.history.undo.forEach(g=>g.updates.splice(p,1)),r.history.redo.forEach(g=>g.updates.splice(p,1)),this.updateGraphics.remove(n);const l=this.updateGraphics.toArray();this.emit("update",{graphics:l,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[n],type:"selection-change"},type:"update"}),this.updateGraphics.length!==0?i.graphics=l:r.complete()}});let c=!1,s=[a.on("immediate-click",n=>this._getCommonUpdateOperationClickHandlers(r,n,e),w.WIDGET),a.on("key-down",n=>{this._getCommonUpdateOperationKeyDownHandlers(r,n),n.key!==f.constraint||n.repeat||(c=!0,i.enableMoveAllGraphics=!i.enableMoveAllGraphics)},w.WIDGET),a.on("key-up",n=>{n.key===f.constraint&&c&&(c=!1,i.enableMoveAllGraphics=!i.enableMoveAllGraphics)},w.WIDGET)],h=this._getHandlesForComponent(r,e);return r}async _setupReshape3DOperation(t,e,a,o=!1){const i="reshape",r=await this._requireModule(S(()=>import("./editingTools-D7U_L-1g.js"),__vite__mapDeps([158,1,2,3,154,23,24,13,51,52,17,18,45,6,7,8,9,10,11,46,47,98,19,20,21,4,5,12,29,136,84,79,133,134,38,39,54,55,56,57,58,135,35,159,130,131,145,142,48,43,44,49,42,143,78,80,81,82,83,53,160,161,162,163,59,60,141,164,26,165,166,167,168,169,170,171,108,172,173,174,175,176,177,178,179,180,181,106,140,182,183,184,122,185,186,147,187,112,14,15,16,22,25,27,28,30,31,32,33,34,36,127,188,117,74,118,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,41,50,61,62,63,64,65,66,67,68,69,70,71,72,73,75,76,77,85,86,208,209,210,211,139,212,213,214,215,216,113,217,87,88,89,90,91,92,93,94,95,96,97,99,100,101,102,103,104,105,107,109,110,111,114,115,116,119,120,121,123,124,125,126,128,129,132,137,138,144,146,218,219,220,221,222,223,148,149,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,150,151,152,153]),import.meta.url));if(O(r))return r;const{ManipulatedObject3DGraphic:c,ReshapeTool3D:s}=r.module,h=new c({view:a,graphic:t}),n=Rt(h);if(n!==G.SUPPORTED)return h.destroy(),this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${q(n)}).`),null;const p=e.reshapeOptions,l=new s({view:a,object:h,enableZVertex:e.enableZ&&(p==null?void 0:p.vertexOperation)==="move",enableZShape:e.enableZ&&(p==null?void 0:p.shapeOperation)==="move",enableMoveObject:(p==null?void 0:p.shapeOperation)==="move"||(p==null?void 0:p.shapeOperation)==="move-xy",enableMidpoints:(p==null?void 0:p.edgeOperation)==="split",enableEdgeOffset:(p==null?void 0:p.edgeOperation)==="offset",snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});a.tools.add(l),o||this.updateGraphics.add(h.graphic);const g=[],u=new A({activeComponent:l,tool:i,type:"update",onEnd:()=>{var d;g.forEach(b=>b.remove()),g.length=0,(d=a.tools)==null||d.remove(l),l.destroyed||l.destroy(),h.destroy()},canUndo:()=>l.canUndo,undo:()=>{l.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:i})},canRedo:()=>l.canRedo,redo:()=>{l.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:i})},addToSelection:async d=>{this.updateGraphics.add(d),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[d],removed:[],type:"selection-change"},type:"update"}),u.onEnd(),u.destroy();const b=await this._setupMove3DOperation(this.updateGraphics.toArray(),e,a,"transform",!0);O(b)||this._setUpdateOperationHandle(b,e)},removeFromSelection:d=>{this.updateGraphics.remove(d),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[d],type:"selection-change"},type:"update"}),u.complete()},toggleTool:async()=>{if(e.toggleToolOnClick===!1)return;u.onEnd(),u.destroy();const d=await this._setupGraphicTransform3DOperation(this.updateGraphics.toArray(),e,a,!0);O(d)||this._setUpdateOperationHandle(d,e)}});return g.push(...this._getHandlesForComponent(u,e),a.on("immediate-click",d=>this._getCommonUpdateOperationClickHandlers(u,d,e),w.WIDGET),a.on("key-down",d=>{this._getCommonUpdateOperationKeyDownHandlers(u,d)},w.WIDGET)),u}async _setupTransformOrReshape2DOperation(t,e,a,o){this.updateGraphics.addMany(t),await this._updateSpatialReference(t);const i=e==="transform"?await this._getBox(t,a,o):await this._getReshape(t,a,o);if(O(i))return i;const r=new A({activeComponent:i,type:"update",onEnd:()=>{s.forEach(h=>h.remove()),c.forEach(h=>h.remove()),s=[],c=[],r.activeComponent&&!r.activeComponent.destroyed&&r.activeComponent.destroy(),this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray())},undo:()=>{H(r,this.updateGraphics.toArray()),r.refreshComponent(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:r.tool})},redo:()=>{P(r,this.updateGraphics.toArray()),r.refreshComponent(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:r.tool})},addToSelection:async h=>{let n=r.activeComponent;if((n==null?void 0:n.type)==="reshape"){const p=[...this.updateGraphics,h];this.updateGraphics.removeAll(),r.onEnd(),r.destroy();const l=await this._setupTransformOrReshape2DOperation(p,"transform",a,o);if(O(l))return;this._setUpdateOperationHandle(l,a)}else this.updateGraphics.add(h),n.graphics=this.updateGraphics.toArray(),n.refresh(),r.resetHistory();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[h],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:async h=>{const n=this.updateGraphics.indexOf(h);r.history.undo.forEach(l=>l.updates.splice(n,1)),r.history.redo.forEach(l=>l.updates.splice(n,1)),this.updateGraphics.remove(h);const p=this.updateGraphics.toArray();if(p.length===0)r.complete();else{const l=p[0].geometry;p.length!==1||l==null||l.type!=="point"&&l.type!=="multipoint"?r.activeComponent.graphics=p:r.toggleTool()}this.emit("update",{graphics:p,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[h],type:"selection-change"},type:"update"})},toggleTool:async()=>{var l;if(this.updateGraphics.length>1)return;const h=this.updateGraphics.at(0),n=h.geometry;if(n!=null&&(r.tool==="reshape"&&(n.type==="point"||n.type==="multipoint")||r.tool==="transform"&&n.type==="extent"))return;let p=null;r.tool==="transform"?p=await this._getReshape([h],a,o):r.tool==="reshape"&&(p=await this._getBox([h],a,o)),O(p)||((l=r.activeComponent)==null||l.destroy(),r.activeComponent=p,r.activeComponent&&(s.forEach(g=>g.remove()),s=this._getHandlesForComponent(r,a)))}});let c=[o.on("immediate-click",h=>this._getCommonUpdateOperationClickHandlers(r,h,a),w.WIDGET),o.on("key-down",h=>{if(this._getCommonUpdateOperationKeyDownHandlers(r,h),h.key===f.constraint&&!h.repeat&&r){const n=r.activeComponent;n&&n.type==="box"&&(n.preserveAspectRatio=!n.preserveAspectRatio)}},w.WIDGET),o.on("key-up",h=>{if(h.key===f.constraint&&r){const n=r.activeComponent;n&&n.type==="box"&&(n.preserveAspectRatio=!n.preserveAspectRatio)}},w.WIDGET)],s=this._getHandlesForComponent(r,a);return r}async _getGraphicMover(t,e,a){const{enableMoveAllGraphics:o,highlightOptions:i}=e,r=await this._requireModule(S(()=>import("./GraphicMover-CgfEhfye.js"),__vite__mapDeps([312,1,2,3,27,22,7,8,19,10,11,20,21,9,13,4,5,6,12,28,23,24,29,30,31,32,33,17,18,34,35,16,89,90,14,15,25,26,36,91,63,64,92,93,94,95,96,60,97,98,46,47,155,313,314,77,315,71,316,297,298,299,300,72,73,74,150,38,42,43,44,49,45,151,152,153,157]),import.meta.url));return O(r)?r:new r.module.default({enableMoveAllGraphics:o,highlightsEnabled:!!(i!=null&&i.enabled),indicatorsEnabled:!1,graphics:t,view:a,callbacks:{onGraphicMoveStart:({dx:c,dy:s,graphic:h})=>{this._displayGrabbingCursor(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:c,dy:s,mover:h,type:"move-start"},type:"update"})},onGraphicMove:({dx:c,dy:s,graphic:h})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:c,dy:s,mover:h,type:"move"},type:"update"}),onGraphicMoveStop:({dx:c,dy:s,graphic:h})=>{this._displayPointerCursor(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:c,dy:s,mover:h,type:"move-stop"},type:"update"})},onGraphicPointerOver:()=>this._displayPointerCursor(),onGraphicPointerOut:()=>this._displayDefaultCursor()}})}async _getBox(t,e,a){var n,p;const{enableRotation:o,enableScaling:i,highlightOptions:r,preserveAspectRatio:c}=e,s=await this._requireModule(S(()=>import("./Box-B1mkzfrs.js"),__vite__mapDeps([317,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,79,155,312,89,90,91,63,64,92,93,94,95,96,60,97,98,46,47,313,314,77,315,71,316,297,298,299,300,72,73,74,150,38,42,43,44,49,45,151,152,153,157,318,146,114,41,48,50,39,51,52,53,54,55,56,57,58,59,61,62,65,66,67,68,69,70,75,76,78,80,81,82,83,84,128,129,130,131,132,103,133,134,135,136,88,137,239,145,142,143,222]),import.meta.url));if(O(s))return s;const h=(p=(n=this.view)==null?void 0:n.inputManager)==null?void 0:p.isModifierKeyDown(f.constraint);return new s.module.default({graphics:t,enableRotation:o,enableScaling:i,highlightsEnabled:!!(r!=null&&r.enabled),preserveAspectRatio:!!c!=!!h,layer:this._internalGraphicsLayer,view:a,sketchOptions:this.sketchOptions,callbacks:{onMoveStart:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onMove:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onMoveStop:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onScaleStart:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onScale:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onScaleStop:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onRotateStart:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onRotate:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onRotateStop:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"})}})}async _getReshape(t,e,a){var s,h,n;const o=((s=e.reshapeOptions)==null?void 0:s.edgeOperation)==="split",i=((h=e.reshapeOptions)==null?void 0:h.shapeOperation)==="move",r=!!((n=e.highlightOptions)!=null&&n.enabled),c=await this._requireModule(S(()=>import("./Reshape-DRMyIAjo.js"),__vite__mapDeps([319,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,89,90,91,63,64,92,93,94,95,96,60,97,98,46,47,106,37,38,39,40,41,42,43,44,45,48,49,50,51,52,53,54,55,56,57,58,59,61,62,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,155,312,313,314,315,316,297,298,299,300,150,151,152,153,157,125,88,126,122,127,110,111,128,129,130,131,132,103,133,134,135,136,137,138,139,140,141,142,143,144,221,222,145,318,107,108,146,114,115]),import.meta.url));return O(c)?c:new c.module.default({enableMidpoints:o,enableMovement:i,graphic:t[0],highlightsEnabled:r,layer:this._internalGraphicsLayer,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions,view:a,callbacks:{onReshapeStart:p=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...p},type:"update"}),onReshape:p=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...p},type:"update"}),onReshapeStop:({mover:p,type:l})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:p,type:l},type:"update"}),onMoveStart:({dx:p,dy:l,mover:g,type:u})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:p,dy:l,mover:g,type:u},type:"update"}),onMove:({dx:p,dy:l,mover:g,type:u})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:p,dy:l,mover:g,type:u},type:"update"}),onMoveStop:({dx:p,dy:l,mover:g,type:u})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:p,dy:l,mover:g,type:u},type:"update"}),onVertexAdd:({added:p,type:l,vertices:g})=>{const u=p.map(d=>Z(d.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:u,vertices:g,type:l},type:"update"})},onVertexRemove:({removed:p,type:l,vertices:g})=>{const u=p.map(d=>Z(d.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{removed:u,vertices:g,type:l},type:"update"})}}})}_getHandlesForComponent(t,e){const a=t.activeComponent;if(!a)return[];switch(a.type){case"graphic-mover":return[a.on("graphic-click",({graphic:o,viewEvent:i})=>{var r;(r=i.native)!=null&&r.shiftKey&&(i.stopPropagation(),t.removeFromSelection(o))}),a.on("graphic-move-start",o=>t.addToHistory(M(o.allGraphics)))];case"box":return[a.on("graphic-click",o=>this._onTransformOrReshape2DGraphicClick(t,e,o)),a.on("move-start",o=>t.addToHistory(M(o.graphics))),a.on("rotate-start",o=>t.addToHistory(M(o.graphics))),a.on("scale-start",o=>t.addToHistory(M(o.graphics)))];case"reshape":return[a.on("graphic-click",o=>this._onTransformOrReshape2DGraphicClick(t,e,o)),a.on("move-start",o=>t.addToHistory(M([o.mover]))),a.on("reshape-start",o=>t.addToHistory(M([o.graphic]))),a.on("vertex-add",o=>t.addToHistory(M([o.oldGraphic]))),a.on("vertex-remove",o=>t.addToHistory(M([o.oldGraphic])))];case"move-3d":return[a.events.on("record-undo",({updates:o})=>{t.addToHistory({updates:o})}),a.events.on("move-start",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:o.objects.length>0?o.objects[0].graphic:null,type:"move-start"},type:"update"})}),a.events.on("move",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:o.dx,dy:o.dy,mover:o.objects.length>0?o.objects[0].graphic:null,type:"move"},type:"update"})}),a.events.on("move-stop",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:o.objects.length>0?o.objects[0].graphic:null,type:"move-stop"},type:"update"})}),a.events.on("immediate-click",o=>{o.shiftKey?this._toggleSelection([o.object.graphic],t,e):t.toggleTool()})];case"transform-3d":return[a.events.on("record-undo",({updates:o})=>{t.addToHistory({updates:o})}),a.events.on("translate-start",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:o.object.graphic,dx:o.dxScreen,dy:o.dyScreen,type:"move-start"},type:"update"})}),a.events.on("translate-stop",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:o.object.graphic,dx:o.dxScreen,dy:o.dyScreen,type:"move-stop"},type:"update"})}),a.events.on("rotate-start",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:o.object.graphic,angle:o.angle,type:"rotate-start"},type:"update"})}),a.events.on("rotate-stop",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:o.object.graphic,angle:o.angle,type:"rotate-stop"},type:"update"})}),a.events.on("scale-start",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:o.object.graphic,xScale:o.xScale,yScale:o.yScale,type:"scale-start"},type:"update"})}),a.events.on("scale-stop",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:o.object.graphic,xScale:o.xScale,yScale:o.yScale,type:"scale-stop"},type:"update"})}),a.events.on("translate",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:o.object.graphic,dx:o.dxScreen,dy:o.dyScreen,type:"move"},type:"update"})}),a.events.on("rotate",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:o.object.graphic,angle:o.angle,type:"rotate"},type:"update"})}),a.events.on("scale",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:o.object.graphic,xScale:o.xScale,yScale:o.yScale,type:"scale"},type:"update"})}),a.events.on("immediate-click",o=>{o.shiftKey?this._toggleSelection([o.object.graphic],t,e):t.toggleTool()})];case"reshape-3d":return[a.events.on("reshape",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...o,mover:o.object.graphic},type:"update"})}),a.events.on("move",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...o,mover:o.object.graphic},type:"update"})}),a.events.on("vertex-add",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:o,type:"update"})}),a.events.on("vertex-remove",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:o,type:"update"})}),a.events.on("immediate-click",o=>{o.shiftKey?this._toggleSelection([o.object.graphic],t,e):t.toggleTool()})]}}_onTransformOrReshape2DGraphicClick(t,e,a){var r;const{graphic:o,viewEvent:i}=a;return(r=i.native)!=null&&r.shiftKey&&o.layer===this.layer?(i.stopPropagation(),t.removeFromSelection(o)):e.toggleToolOnClick?(i.stopPropagation(),t.toggleTool()):void 0}_setUpdateOperationHandle(t,e){var i;this._operationHandle=t;const a=(i=this.view)==null?void 0:i.map;this._disablePopup(e);const o=()=>{if(t===this._operationHandle){const r=this.updateGraphics.toArray(),c=this._operationHandle.tool;this._operationHandle.destroy(),this._operationHandle=null,this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray()),this.updateGraphics.removeAll(),a&&a.remove(this._internalGraphicsLayer),this._restorePopup(e),this.emit("update",{graphics:r,state:"complete",aborted:t.cancelled,tool:c,toolEventInfo:null,type:"update"})}};t.on("complete",o)}async _getCommonUpdateOperationClickHandlers(t,e,a){const o=B(e),i=await e.async(()=>this._getFirstHit(o));if(i==null)return void t.complete();if(e.native.shiftKey&&this._toggleSelection([i.graphic],t,a))return void e.stopPropagation();this.updateGraphics.includes(i.graphic)?e.stopPropagation():t.complete()}_toggleSelection(t,e,a){const o=!!a.multipleSelectionEnabled;return t.some(i=>i!=null&&!(!o||i.layer!==this.layer)&&(this.updateGraphics.includes(i)?e.removeFromSelection(i):e.addToSelection(i),!0))}_getCommonUpdateOperationKeyDownHandlers(t,e){if(!t)return;const a=e.key;a===f.undo&&t.canUndo()?(e.stopPropagation(),t.undo()):a===f.redo&&t.canRedo()?(e.stopPropagation(),t.redo()):a===f.cancel?(e.stopPropagation(),t.cancel()):this.allowDeleteKey&&f.delete.includes(a)&&this._onDeleteKey(e)}_onDeleteKey(t){var o;if(!this._operationHandle||this._operationHandle.type!=="update")return;const e=this.activeComponent,a=this.updateGraphics.toArray();e!=null&&(e.type!=="reshape"||a.length===1&&((o=a[0].geometry)==null?void 0:o.type)==="point")&&(t.stopPropagation(),this.delete())}_removeDefaultLayer(){var t,e;this._internalGraphicsLayer&&((e=(t=this.view)==null?void 0:t.map)==null||e.remove(this._internalGraphicsLayer),this._internalGraphicsLayer=I(this._internalGraphicsLayer))}_isComponentGraphic(t){var a;const{activeComponent:e}=this;return!(!t||e==null)&&(((a=t.attributes)==null?void 0:a.esriSketchTool)||e.type==="draw-2d"&&e.graphic===t||(e.type==="box"||e.type==="reshape")&&e.isUIGraphic(t))}_displayPointerCursor(){var t;(t=this.view)!=null&&t.container&&this.view.cursor!=="pointer"&&(this.view.cursor="pointer")}_displayGrabbingCursor(){var t;(t=this.view)!=null&&t.container&&this.view.cursor!=="grabbing"&&(this.view.cursor="grabbing")}_displayDefaultCursor(){var t;(t=this.view)!=null&&t.container&&this.view.cursor!==null&&(this.view.cursor=null)}_logError(t,e,a){pt.getLogger(this).error(new lt(t,e,a))}async _requireModule(t){const e=new AbortController;this._moduleLoaderAbortController=e;const a=await t;return this._moduleLoaderAbortController!==e||e.signal.aborted?{requireError:"aborted"}:{module:a}}_emitUndoEvent(t){this.emit("undo",{...t,type:"undo"})}_emitRedoEvent(t){this.emit("redo",{...t,type:"redo"})}_emitDeleteEvent(t){this.emit("delete",{...t,type:"delete"})}get test(){}wait(){return W(()=>!this.updating)}_beginAsyncOperation(){this._numUpdating+=1,this.notifyChange("updating")}_endAsyncOperation(){this._numUpdating-=1,this.notifyChange("updating")}_disablePopupEnabled(t){var e;return((e=this.view)==null?void 0:e.type)!=="3d"||this.updateOnGraphicClick||((t==null?void 0:t.toggleToolOnClick)??!1)}_disablePopup(t){this._disablePopupEnabled(t)&&this.view&&this._originalPopupEnabled==null&&(this._originalPopupEnabled=this.view.popupEnabled,this.view.popupEnabled=!1)}_restorePopup(t){this._disablePopupEnabled(t)&&this.view&&this._originalPopupEnabled!=null&&(this.view.popupEnabled=this._originalPopupEnabled,this._originalPopupEnabled=null)}async _waitViewReady(){const t=this.view;t?(V(this._viewReadyAbortController),this._viewReadyAbortController=new AbortController,await ht(W(()=>t==null?void 0:t.ready),this._viewReadyAbortController.signal)):this._logMissingView()}_logMissingView(){this._logError("sketch:missing-property",X("view"))}_logMissingLayer(){this._logError(Ht,X("layer"))}};y([m()],v.prototype,"_defaultSnappingManager",void 0),y([m()],v.prototype,"updating",null),y([m()],v.prototype,"_operationHandle",void 0),y([m({readOnly:!0})],v.prototype,"activeTool",null),y([m()],v.prototype,"activeFillSymbol",void 0),y([m()],v.prototype,"activeLineSymbol",void 0),y([m()],v.prototype,"activeVertexSymbol",void 0),y([m()],v.prototype,"allowDeleteKey",void 0),y([m({readOnly:!0})],v.prototype,"createGraphic",null),y([m()],v.prototype,"defaultCreateOptions",null),y([m()],v.prototype,"defaultUpdateOptions",null),y([m({type:Tt,nonNullable:!0})],v.prototype,"labelOptions",null),y([m()],v.prototype,"layer",void 0),y([m({types:R})],v.prototype,"pointSymbol",void 0),y([m({types:R})],v.prototype,"polygonSymbol",void 0),y([m({types:R})],v.prototype,"polylineSymbol",void 0),y([m()],v.prototype,"meshSymbol",void 0),y([m({type:at,nonNullable:!0})],v.prototype,"snappingOptions",null),y([m()],v.prototype,"snappingManager",null),y([m({readOnly:!0})],v.prototype,"state",null),y([m({type:bt,nonNullable:!0})],v.prototype,"tooltipOptions",null),y([m({readOnly:!0})],v.prototype,"updateGraphics",void 0),y([m()],v.prototype,"updateOnGraphicClick",void 0),y([m({type:Ot,nonNullable:!0})],v.prototype,"valueOptions",null),y([m({types:R})],v.prototype,"vertexSymbol",void 0),y([m({value:null})],v.prototype,"view",null),y([m({constructOnly:!0,type:ot})],v.prototype,"sketchOptions",void 0),v=y([x("esri.widgets.Sketch.SketchViewModel")],v);const Ht="sketch:missing-property",X=t=>`Property '${t}' is missing on SketchViewModel.`;function Pt(t){return t==="polygon"||t==="rectangle"||t==="circle"}function H(t,e){it("undo",t.history.undo,t.history.redo,e)}function P(t,e){it("redo",t.history.redo,t.history.undo,e)}function it(t,e,a,o){const i=e.pop();if(!i)return;const r=i.updates,c=[];o.forEach((s,h)=>{const n=r[h];n!=null&&("geometry"in n&&n.geometry!=null&&(c.push({geometry:s.geometry}),s.geometry=n.geometry),"symbol"in n&&n.symbol!=null&&(c.push({symbol:s.symbol}),s.symbol=n.symbol),"undo"in n&&(c.push(n),n[t](s)))}),a.push({updates:c})}function tt(t,e){t!=null&&e.hasGrabbedManipulators&&(t.activeTool=null)}function M(t){return{updates:t.map(({geometry:e})=>(e==null?void 0:e.type)==="mesh"?{geometry:e.cloneShallow()}:{geometry:e})}}function O(t){return"requireError"in t&&t.requireError==="aborted"}const ie=v;export{ie as p};
