import{p as C,H as E,c as A,h as y,a as S}from"./jsxFactory-CJa39Fro.js";import{t as x,f as M,A as p}from"./dom-D_AJDzAj.js";import"./tslib.es6-B3Jf3DVX.js";import"./intl-CChhNOV8.js";import"./date-DlqISzcw.js";import"./jsonMap-0cxwUWs2.js";import"./subclass-BZA_h8Db.js";import"./locale-C9TlLpzi.js";import"./messages-OmQvZhAg.js";import"./Accessor-BLX9ikPh.js";import"./assets-C43MgM-v.js";import"./index-Bh2oEzTI.js";import"./Evented-BHRw9x22.js";import"./Promise-B2Hu02L7.js";import"./reactiveUtils-C5zUhJQJ.js";import"./asyncUtils-CWX51uTe.js";import"./Collection-CEdjem1-.js";import"./shared-B3wH2qpO.js";import"./SimpleObservable-KocWTzVy.js";import"./uuid-fwrPAdZb.js";import"./cast-Bjksrh93.js";/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
 * v2.13.2
 */function T(d){return(d==null?void 0:d.tagName)==="CALCITE-TREE-ITEM"}function w(d){return Array.from(d.querySelectorAll("calcite-tree-item:not([disabled])")).filter(e=>{let t=e;for(;t!==d&&t!==void 0;){const s=t.parentElement;if(!(!T(s)||!s.hasChildren||s.expanded))return!1;t=t.parentElement}return!0})}const D=":host{display:block}:host(:focus){outline:2px solid transparent;outline-offset:2px}:host([hidden]){display:none}[hidden]{display:none}",k=D,I=C(class extends E{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.calciteTreeSelect=A(this,"calciteTreeSelect",6),this.keyDownHandler=e=>{if(this.child)return;const t=this.el,s=e.target,c=["ArrowRight","ArrowDown","ArrowLeft","ArrowUp","Home","End","Tab"];if(!(T(s)&&this.el.contains(s))||!c.includes(e.key))return;const n=w(t);if(e.key==="Tab"){n.forEach(r=>r.tabIndex=-1);return}if(e.key==="ArrowDown"){const r=n.indexOf(s),l=n[r+1];l==null||l.focus(),e.preventDefault();return}if(e.key==="ArrowUp"){const r=n.indexOf(s),l=n[r-1];l==null||l.focus(),e.preventDefault();return}if(e.key==="ArrowLeft"){if(s.hasChildren&&s.expanded){s.expanded=!1,e.preventDefault();return}const l=n.slice(0,n.indexOf(s)).reverse().find(u=>u.depth===s.depth-1);l==null||l.focus(),e.preventDefault();return}if(e.key==="ArrowRight"){if(!s.disabled&&s.hasChildren)if(!s.expanded)s.expanded=!0,e.preventDefault();else{const r=n.indexOf(s),l=n[r+1];l==null||l.focus(),e.preventDefault()}return}if(e.key==="Home"){const r=n.shift();r&&(r.focus(),e.preventDefault());return}if(e.key==="End"){const r=n.pop();r&&(r.focus(),e.preventDefault());return}},this.lines=!1,this.child=void 0,this.scale="m",this.selectionMode="single",this.selectedItems=[]}componentWillRender(){var t;const e=(t=this.el.parentElement)==null?void 0:t.closest("calcite-tree");this.lines=e?e.lines:this.lines,this.scale=e?e.scale:this.scale,this.selectionMode=e?e.selectionMode:this.selectionMode,this.child=!!e}render(){return y(S,{key:"5b08de1c59622b78985de9019bf4ba11d605a07f","aria-multiselectable":this.child?void 0:x(this.selectionMode==="multiple"||this.selectionMode==="multichildren"),onKeyDown:this.keyDownHandler,role:this.child?void 0:"tree",tabIndex:this.getRootTabIndex()},y("slot",{key:"00a037cf92cb5facadc4b2961a9369b6ae0631f5"}))}onFocus(){if(!this.child){const e=this.el.querySelector("calcite-tree-item[selected]:not([disabled])")||this.el.querySelector("calcite-tree-item:not([disabled])");M(e)}}onFocusIn(e){(e.relatedTarget===this.el||!this.el.contains(e.relatedTarget))&&this.el.removeAttribute("tabindex")}onFocusOut(e){!this.el.contains(e.relatedTarget)&&(this.el.tabIndex=this.getRootTabIndex())}onInternalTreeItemSelect(e){if(this.child)return;const t=e.target,s=p(t.querySelectorAll("calcite-tree-item"));if(e.preventDefault(),e.stopPropagation(),this.selectionMode==="ancestors"){this.updateAncestorTree(e);return}const c=this.selectionMode==="none",n=this.selectionMode!==null&&(!t.hasChildren||t.hasChildren&&(this.selectionMode==="children"||this.selectionMode==="multichildren")),r=this.selectionMode==="multichildren"&&t.hasChildren,l=!c&&e.detail.modifyCurrentSelection&&(this.selectionMode==="multiple"||this.selectionMode==="multichildren"),u=!l&&((this.selectionMode==="single"||this.selectionMode==="multiple")&&s.length<=0||this.selectionMode==="children"||this.selectionMode==="multichildren"||this.selectionMode==="single-persist"&&!t.hasChildren),h=["multiple","none","single","single-persist"].includes(this.selectionMode)&&t.hasChildren,a=[];n&&a.push(t),u&&p(this.el.querySelectorAll("calcite-tree-item[selected]")).forEach(o=>{a.includes(o)||(o.selected=!1)}),h&&["multiple","none","single","single-persist"].includes(this.selectionMode)&&(t.expanded=!t.expanded),r&&s.forEach(i=>{i.selected=!1,i.hasChildren&&(i.expanded=!1)}),l&&window.getSelection().removeAllRanges(),l&&t.selected?a.forEach(i=>{i.disabled||(i.selected=!1)}):c||a.forEach(i=>{i.disabled||(i.selected=this.selectionMode!=="single"||!i.selected)}),this.selectedItems=c?[]:p(this.el.querySelectorAll("calcite-tree-item")).filter(i=>i.selected),this.calciteTreeSelect.emit(),e.stopPropagation()}updateAncestorTree(e){const t=e.target,s=e.detail.updateItem;if(t.disabled||t.indeterminate&&!s)return;const c=[];let n=t.parentElement.closest("calcite-tree-item");for(;n;)c.push(n),n=n.parentElement.closest("calcite-tree-item");const r=Array.from(t.querySelectorAll("calcite-tree-item:not([disabled])")),l=r.filter(i=>!i.hasChildren),u=r.filter(i=>i.hasChildren);let h;s?h=t.hasChildren?!(t.selected||t.indeterminate):!t.selected:h=t.selected,l.forEach(i=>{i.selected=h,i.indeterminate=!1});function a(i,o){const f=i.filter(m=>m.selected),g=i.filter(m=>!m.selected);o.selected=f.length===i.length,o.indeterminate=f.length>0&&g.length>0}u.reverse().forEach(i=>{const o=Array.from(i.querySelectorAll(":scope > calcite-tree > calcite-tree-item"));a(o,i)}),s&&(t.hasChildren?a(r,t):(t.selected=h,t.indeterminate=!1)),c.forEach(i=>{const o=p(i.querySelectorAll("calcite-tree-item")),f=o.filter(m=>m.selected);if(f.length===0){i.selected=!1,i.indeterminate=!1;return}const g=f.length<o.length;i.indeterminate=g,i.selected=!g}),this.selectedItems=p(this.el.querySelectorAll("calcite-tree-item")).filter(i=>i.selected),s&&this.calciteTreeSelect.emit()}getRootTabIndex(){return this.child?-1:0}get el(){return this}static get style(){return k}},[1,"calcite-tree",{lines:[1540],child:[1540],scale:[1537],selectionMode:[1537,"selection-mode"],selectedItems:[1040]},[[0,"focus","onFocus"],[0,"focusin","onFocusIn"],[0,"focusout","onFocusOut"],[0,"calciteInternalTreeItemSelect","onInternalTreeItemSelect"]]]);function b(){if(typeof customElements>"u")return;["calcite-tree"].forEach(e=>{switch(e){case"calcite-tree":customElements.get(e)||customElements.define(e,I);break}})}b();const Z=I,v=b;export{Z as CalciteTree,v as defineCustomElement};
