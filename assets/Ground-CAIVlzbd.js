const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./ElevationQuery-C0bbwpsV.js","./asyncUtils-CWX51uTe.js","./tslib.es6-B3Jf3DVX.js","./Accessor-BLX9ikPh.js","./subclass-BZA_h8Db.js","./Point-Cg0-ChZE.js","./cast-Bjksrh93.js","./writer-DNAwXnhG.js","./assets-C43MgM-v.js","./index-Bh2oEzTI.js","./index-2kwcjS9-.css","./jsonMap-0cxwUWs2.js","./Polyline-D9YkgmM_.js","./Extent-Bf3YTe7m.js","./mathUtils-C4_ghTv4.js","./projection-B971H0Re.js","./SimpleObservable-KocWTzVy.js","./vec3f64-BLpZdpfb.js","./projectBuffer-Bs7GwaPY.js","./geodesicConstants-DWQLYX7F.js","./ElevationSamplerData-DF8Bl6I9.js","./geometry-D964gYQX.js","./ElevationTile-F2xXmLtF.js","./TileKey-DZd6gJy7.js","./layersCreator-qSEwd4GK.js","./Collection-CEdjem1-.js","./Evented-BHRw9x22.js","./shared-B3wH2qpO.js","./portalLayers-BzFmbxxn.js","./associatedFeatureServiceUtils-CXx2I5Ic.js","./arcgisLayerUrl-BX1FE5Hm.js","./persistableUrlUtils-fa1mAujs.js","./Portal-C10FKnaA.js","./Loadable-BabW5Xcc.js","./Promise-B2Hu02L7.js","./locale-C9TlLpzi.js","./PortalItem-DzgXrpyc.js","./lazyLayerLoader-Buplpp4b.js","./requestPresets-B-6DU6iY.js","./layerUtils-BrNoooE9.js","./portalItemUtils-BzVoFAku.js","./styleUtils-KMFBtb6u.js"])))=>i.map(i=>d[i]);
import{_ as c}from"./index-Bh2oEzTI.js";import{r as s}from"./tslib.es6-B3Jf3DVX.js";import{l as I}from"./Color-BCS62Hs5.js";import{V as L}from"./Collection-CEdjem1-.js";import{n as C}from"./collectionUtils-D_lHIu88.js";import{o as A}from"./compilerUtils-Dw3R0f-Z.js";import{a as $,n as v,b as E,g,m as l,x as _}from"./subclass-BZA_h8Db.js";import{f as S,u as b}from"./assets-C43MgM-v.js";import{m as O}from"./Loadable-BabW5Xcc.js";import{t as x}from"./loadAll-B6mYSptb.js";import{c as P,q as T,s as d}from"./Accessor-BLX9ikPh.js";import{r as N}from"./writer-DNAwXnhG.js";import{r as F}from"./enumeration-Ba5njXdz.js";import{r as V,n as j}from"./opacityUtils-C68Tlu6_.js";var m;let y=m=class extends S{constructor(e){super(e),this.type="none"}clone(){return new m({type:this.type})}};s([F({none:"none",stayAbove:"stay-above"})],y.prototype,"type",void 0),y=m=s([$("esri.ground.NavigationConstraint")],y);var h;let a=h=class extends b(O){constructor(e){super(e),this.opacity=1,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new L;const r=t=>{t.parent&&t.parent!==this&&"remove"in t.parent&&t.parent.remove(t),t.parent=this,t.type!=="elevation"&&t.type!=="base-elevation"&&v.getLogger(this).error(`Layer '${t.title}, id:${t.id}' of type '${t.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`)},i=t=>{t.parent=null};this.addHandles([this.layers.on("after-add",t=>r(t.item)),this.layers.on("after-remove",t=>i(t.item))])}initialize(){this.when().catch(e=>{P(e)||v.getLogger(this).error("#load()","Failed to load ground",e)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const e=this.layers.removeAll();for(const r of e)T(r);this.layers.destroy()}normalizeCtorArgs(e){return e&&"resourceInfo"in e&&(this._set("resourceInfo",e.resourceInfo),delete(e={...e}).resourceInfo),e}set layers(e){this._set("layers",C(e,this._get("layers")))}writeLayers(e,r,i,t){const o=[];e&&(t={...t,layerContainerType:"ground"},e.forEach(n=>{if("write"in n){const p={};A(n)().write(p,t)&&o.push(p)}else t!=null&&t.messages&&t.messages.push(new E("layer:unsupported",`Layers (${n.title}, ${n.id}) of type '${n.declaredClass}' cannot be persisted in the ground`,{layer:n}))})),r.layers=o}load(e){return this.addResolvingPromise(this._loadFromSource(e)),Promise.resolve(this)}loadAll(){return x(this,e=>{e(this.layers)})}async queryElevation(e,r){await this.load({signal:r==null?void 0:r.signal});const{ElevationQuery:i}=await c(()=>import("./ElevationQuery-C0bbwpsV.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]),import.meta.url);d(r);const t=new i,o=this.layers.filter(w).toArray();return t.queryAll(o,e,r)}async createElevationSampler(e,r){await this.load({signal:r==null?void 0:r.signal});const{ElevationQuery:i}=await c(()=>import("./ElevationQuery-C0bbwpsV.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]),import.meta.url);d(r);const t=new i,o=this.layers.filter(w).toArray();return t.createSamplerAll(o,e,r)}clone(){const e={opacity:this.opacity,surfaceColor:g(this.surfaceColor),navigationConstraint:g(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(e.loadStatus="loaded"),new h({resourceInfo:this.resourceInfo}).set(e)}read(e,r){this.resourceInfo||this._set("resourceInfo",{data:e,context:r}),super.read(e,r)}_loadFromSource(e){const r=this.resourceInfo;return r?this._loadLayersFromJSON(r.data,r.context,e):Promise.resolve()}async _loadLayersFromJSON(e,r,i){const t=(r==null?void 0:r.origin)||"web-scene",o=(r==null?void 0:r.portal)||null,n=(r==null?void 0:r.url)||null,{populateOperationalLayers:p}=await c(async()=>{const{populateOperationalLayers:u}=await import("./layersCreator-qSEwd4GK.js");return{populateOperationalLayers:u}},__vite__mapDeps([24,25,2,3,4,26,27,16,28,29,8,9,10,30,31,32,33,34,7,13,5,6,11,35,36,37,38,39,40,15,17,12,14,18,19,41,1]),import.meta.url);d(i);const f=[];if(e.layers&&Array.isArray(e.layers)){const u={context:{origin:t,url:n,portal:o,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};f.push(p(this.layers,e.layers,u))}await Promise.allSettled(f)}};function R(e){return e&&"createElevationSampler"in e}function w(e){return e.type==="elevation"||R(e)}s([l({json:{read:!1}})],a.prototype,"layers",null),s([N("layers")],a.prototype,"writeLayers",null),s([l({readOnly:!0})],a.prototype,"resourceInfo",void 0),s([l({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:_,read:{reader:V,source:"transparency"},write:{writer:(e,r)=>{r.transparency=j(e)},target:"transparency"}}})],a.prototype,"opacity",void 0),s([l({type:I,json:{type:[_],write:(e,r)=>{r.surfaceColor=e.toJSON().slice(0,3)}}})],a.prototype,"surfaceColor",void 0),s([l({type:y,json:{write:!0}})],a.prototype,"navigationConstraint",void 0),a=h=s([$("esri.Ground")],a);const Y=a;export{Y as b};
