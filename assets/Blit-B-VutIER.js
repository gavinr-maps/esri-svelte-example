const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Compositing.glsl-DMM7CJmu.js","./screenUtils-_ZIvrt5o.js","./vec2-maR1OrZI.js","./common-DQOJ18NT.js","./vec32-Dvg_eL9J.js","./vec3f64-BLpZdpfb.js","./sphere-C77djCO6.js","./subclass-BZA_h8Db.js","./mathUtils-C4_ghTv4.js","./mat4-GpOFENPA.js","./vec42-YcqnINSP.js","./vec4f64-o2zAXfmz.js","./Polyline-D9YkgmM_.js","./tslib.es6-B3Jf3DVX.js","./writer-DNAwXnhG.js","./Extent-Bf3YTe7m.js","./Point-Cg0-ChZE.js","./Accessor-BLX9ikPh.js","./cast-Bjksrh93.js","./assets-C43MgM-v.js","./index-Bh2oEzTI.js","./index-2kwcjS9-.css","./jsonMap-0cxwUWs2.js","./mat3-BRl2i9Bz.js","./mat3f64-BBpwCtoL.js","./plane-IENfwZlB.js","./mat4f64-Dk4dwAN8.js","./quatf64-CCm9z-pX.js","./vec2f64-miziP1SN.js","./mathUtils-BG-eq9fO.js","./interfaces-DDtDqZYj.js","./VertexAttribute-Cq4MnHjR.js","./BindType-BmZEZMMh.js","./Texture-Fac_8AOC.js","./Util-BIfApRF5.js","./Material-_xx7OZxD.js","./boundedPlane-EV1sS2Ke.js","./lineSegment-D7sKPPYf.js","./ViewingMode-Dodu7ZZk.js","./Texture-Begq2x5n.js","./enums-D9v74xTE.js","./renderState-DQLu6AJX.js","./reactiveUtils-C5zUhJQJ.js","./asyncUtils-CWX51uTe.js","./Collection-CEdjem1-.js","./Evented-BHRw9x22.js","./shared-B3wH2qpO.js","./SimpleObservable-KocWTzVy.js","./projectBuffer-Bs7GwaPY.js","./geodesicConstants-DWQLYX7F.js","./Matrix3DrawUniform-CiBFaSz6.js","./compilerUtils-Dw3R0f-Z.js","./lengthUtils-DL1-FDQQ.js","./ShaderTechniqueConfiguration-CBbn2DCi.js","./Indices-DflDlU4Z.js","./triangle-PTGDC_xJ.js","./AlphaCutoff-UcccL64p.js","./requestImageUtils-DgMiQwsm.js"])))=>i.map(i=>d[i]);
import{o as g,i as _,b,c as $,g as x,h as y,j as O}from"./Texture-Fac_8AOC.js";import{t as F}from"./Float4DrawUniform-N58YDhuZ.js";import{o as C}from"./Matrix3DrawUniform-CiBFaSz6.js";import{t as T,o as c}from"./interfaces-DDtDqZYj.js";import{r as h}from"./tslib.es6-B3Jf3DVX.js";import{i as d,a as w}from"./ShaderTechniqueConfiguration-CBbn2DCi.js";import{_ as N}from"./index-Bh2oEzTI.js";import{n as P}from"./compilerUtils-Dw3R0f-Z.js";import{B as p,o as v,g as l,c as D}from"./renderState-DQLu6AJX.js";import{_ as q}from"./enums-D9v74xTE.js";var t;(function(r){r[r.None=0]="None",r[r.Alpha=1]="Alpha",r[r.PremultipliedAlpha=2]="PremultipliedAlpha",r[r.Depth=3]="Depth",r[r.COUNT=4]="COUNT"})(t||(t={}));class u extends w{constructor(){super(...arguments),this.blitMode=t.None,this.hasOpacityFactor=!1}}h([d({count:t.COUNT})],u.prototype,"blitMode",void 0),h([d()],u.prototype,"hasOpacityFactor",void 0);class f extends T{constructor(){super(...arguments),this.opacity=1}}function A(r){const e=new g;e.include(_),e.fragment.uniforms.add(new b("tex",o=>o.texture)),r.hasOpacityFactor&&e.fragment.uniforms.add(new C("opacity",o=>o.opacity));const a=r.blitMode===t.Depth;return a&&(e.fragment.uniforms.add(new $("nearFar",(o,i)=>i.camera.nearFar)),e.fragment.include(x),e.fragment.include(F)),e.fragment.main.add(c`
    ${a?c`
          float normalizedLinearDepth = (-linearDepthFromTexture(tex, uv) - nearFar[0]) / (nearFar[1] - nearFar[0]);
          fragColor = float2rgba(normalizedLinearDepth);`:c`
          fragColor = texture(tex, uv) ${r.hasOpacityFactor?"* opacity":""};`}`),e}const M=Object.freeze(Object.defineProperty({__proto__:null,CompositingPassParameters:f,build:A},Symbol.toStringTag,{value:"Module"}));class m extends y{constructor(e,a,o){super(e,a,new O(M,()=>N(()=>import("./Compositing.glsl-DMM7CJmu.js").then(i=>i.C),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57]),import.meta.url)),o)}initializePipeline(e){switch(e.blitMode){case t.None:case t.Depth:return p({colorWrite:l});case t.Alpha:return p({blending:D,colorWrite:l});default:P(e.blitMode);case t.PremultipliedAlpha:case t.COUNT:return p({blending:v,colorWrite:l})}}}class V{constructor(e,a=t.None){this._techniques=e,this._parameters=new f,this._configuration=new u,this._configuration.blitMode=a,e.precompile(m,this._configuration)}blit(e,a,o,i){e.bindFramebuffer(o.fbo),e.setClearColor(0,0,0,1),e.clear(q.COLOR),this._parameters.texture=a.getTexture();const n=this._techniques.acquire(m,this._configuration);e.bindTechnique(n,i,this._parameters),e.screen.draw(),n.release()}blend(e,a,o,i,n=1){this._configuration.hasOpacityFactor=n<1;const s=this._techniques.acquire(m,this._configuration);return s.compiled?(e.bindFramebuffer(o.fbo),this._parameters.texture=a.getTexture(),this._parameters.opacity=n,e.bindTechnique(s,i,this._parameters),e.screen.draw(),s.release(),!0):(s.release(),!1)}}export{m as a,A as g,t as i,f as m,V as o,u as r};
