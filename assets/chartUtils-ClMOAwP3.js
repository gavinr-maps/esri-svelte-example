import{o as S,l as N}from"./ResponsiveTheme-Davkijyt.js";import{s as q,l as J}from"./intl-CChhNOV8.js";import{t as D,e as K}from"./subclass-BZA_h8Db.js";import{s as Q}from"./Accessor-BLX9ikPh.js";import{r as P}from"./signal-D4lghLjV.js";import{g as G,b as _}from"./unitFormatUtils-CZ2bRlFg.js";import{I as R}from"./Point-Cg0-ChZE.js";import{e as ii}from"./common-DQOJ18NT.js";import{r as v,e as ti,s as oi,T as ei}from"./ElevationProfile-ltu2j9-y.js";import{G as ni,D as ri}from"./chartUtilsAm5-SdAMhygp.js";import{u as O}from"./jsxFactory-CJa39Fro.js";import{r as ai}from"./themeUtils-C3zvZbsE.js";import{n as si,g as Y,b as li,x as pi,l as mi,f as di}from"./LineSeries-CHF2Cw04.js";import{a3 as b,z as u,r as ci,Y as ui}from"./Theme-CClEG6aO.js";import{u as W}from"./Tooltip-CbvbKhee.js";import"./date-DlqISzcw.js";import"./jsonMap-0cxwUWs2.js";import"./locale-C9TlLpzi.js";import"./messages-OmQvZhAg.js";import"./assets-C43MgM-v.js";import"./index-Bh2oEzTI.js";import"./tslib.es6-B3Jf3DVX.js";import"./SimpleObservable-KocWTzVy.js";import"./ByteSizeUnit-BsxeN7wM.js";import"./Cyclical-oTUX3aX7.js";import"./mathUtils-C4_ghTv4.js";import"./quantityUtils-D0GB2dMc.js";import"./cast-Bjksrh93.js";import"./writer-DNAwXnhG.js";import"./asyncUtils-CWX51uTe.js";import"./memoize-DsJmrG76.js";import"./reactiveUtils-C5zUhJQJ.js";import"./Collection-CEdjem1-.js";import"./Evented-BHRw9x22.js";import"./shared-B3wH2qpO.js";import"./Graphic-DsxsIjhH.js";import"./geometry-D964gYQX.js";import"./Extent-Bf3YTe7m.js";import"./Polyline-D9YkgmM_.js";import"./PopupTemplate-BHMhS05j.js";import"./Clonable-D3rtuBWg.js";import"./fieldUtils-tmQlKvWo.js";import"./enumeration-Ba5njXdz.js";import"./Color-BCS62Hs5.js";import"./colorUtils-0bJDPow9.js";import"./ActionToggle-iT4slXc7.js";import"./Identifiable-B1UbsKNt.js";import"./symbols-CNimns--.js";import"./TextSymbol-D8QO_KUV.js";import"./screenUtils-_ZIvrt5o.js";import"./materialUtils-DarhapKC.js";import"./opacityUtils-C68Tlu6_.js";import"./vec3f64-BLpZdpfb.js";import"./aaBoundingBox-BE7cC1jD.js";import"./persistableUrlUtils-fa1mAujs.js";import"./collectionUtils-D_lHIu88.js";import"./Portal-C10FKnaA.js";import"./Loadable-BabW5Xcc.js";import"./Promise-B2Hu02L7.js";import"./jsonUtils-CEfjT-BK.js";import"./LRUCache-B_PHMSGm.js";import"./MemCache-Dx1v3xLC.js";import"./ElevationQueryTileCache-D4sXpJpw.js";import"./projectVectorToVector-G2uWGoIb.js";import"./projectBuffer-Bs7GwaPY.js";import"./geodesicConstants-DWQLYX7F.js";import"./projectPointToVector-GINIbYMz.js";import"./projection-B971H0Re.js";import"./LayerConstants-B33OP6sh.js";import"./layerUtils-BrNoooE9.js";import"./Material-_xx7OZxD.js";import"./interfaces-DDtDqZYj.js";import"./VertexAttribute-Cq4MnHjR.js";import"./boundedPlane-EV1sS2Ke.js";import"./sphere-C77djCO6.js";import"./mat4-GpOFENPA.js";import"./vec32-Dvg_eL9J.js";import"./vec42-YcqnINSP.js";import"./vec4f64-o2zAXfmz.js";import"./mat3-BRl2i9Bz.js";import"./mat3f64-BBpwCtoL.js";import"./plane-IENfwZlB.js";import"./mat4f64-Dk4dwAN8.js";import"./quatf64-CCm9z-pX.js";import"./vec2f64-miziP1SN.js";import"./mathUtils-BG-eq9fO.js";import"./lineSegment-D7sKPPYf.js";import"./ViewingMode-Dodu7ZZk.js";import"./ElevationProvider-C95wyCKc.js";import"./dehydratedFeatureUtils-B--Sgpdi.js";import"./intersectorUtils-BK9EUwUf.js";import"./verticalOffsetUtils-BDQLpfho.js";import"./orientedBoundingBox-DOAJUK5g.js";import"./quat-4pa1e6ds.js";import"./spatialReferenceEllipsoidUtils-DBE_OFra.js";import"./computeTranslationToOriginAndRotation-Q27G6TBL.js";import"./intersectorUtilsConversions-D_fcRVdX.js";import"./Intersector-wXoCuQ8W.js";import"./Intersector-BQ92CPLA.js";import"./defaultUnit-_T4IY-sW.js";import"./getDefaultUnitForView-Ce2vZZap.js";import"./throttle-jjSnxk80.js";import"./elevationInfoUtils-BC_66_Fg.js";import"./unitConversionUtils-BMfW9yAe.js";import"./lengthUtils-DL1-FDQQ.js";import"./vec2-maR1OrZI.js";import"./geodesicUtils-FCYOaNwu.js";import"./QueueProcessor-DZiVr5XH.js";import"./Queue-yu3bZ02p.js";import"./ReactiveMap-6CfRGOlR.js";import"./Scheduler-CJu5awNf.js";import"./debugFlags-BF6Z0j0F.js";import"./traversalUtils-DmE6QkgJ.js";import"./uuid-fwrPAdZb.js";import"./Ground-CAIVlzbd.js";import"./compilerUtils-Dw3R0f-Z.js";import"./loadAll-B6mYSptb.js";import"./ElevationQuery-C0bbwpsV.js";import"./ElevationSamplerData-DF8Bl6I9.js";import"./ElevationTile-F2xXmLtF.js";import"./TileKey-DZd6gJy7.js";import"./GraphicsLayer-i3FeUJ_n.js";import"./GraphicsCollection-FfahqxsR.js";import"./Layer-CVt7Hb5J.js";import"./TimeExtent-DocT5yPf.js";import"./timeUtils-8fb_2oAt.js";import"./BlendLayer-CXM4n_Ge.js";import"./jsonUtils-CSnQD004.js";import"./parser-CTsgEym6.js";import"./utils-93yNk4Xc.js";import"./mat4f32-DcsiF_Rp.js";import"./ScaleRangeLayer-Bb8Ig1Hz.js";import"./ElevationInfo-CA5m_tHv.js";import"./InputManager-Ba9xzDpe.js";import"./SketchViewModel-BKa9ySXO.js";import"./isSupportedObject-6I_Nw0mS.js";import"./SketchLabelOptions-DDQnGNSN.js";import"./angularMeasurementUtils-7e2vxqzG.js";import"./layerUtils-BS1Di3Pm.js";import"./keybindings-DoOdil3D.js";import"./SnappingManager-BJPyuu7J.js";import"./Query-5Xpquc1r.js";import"./DataLayerSource-BKkswDvG.js";import"./Field-ybkHhtnK.js";import"./fieldType-BuzM0UHS.js";import"./FullTextSearch-Csd1Hktu.js";import"./utils-BpB3MnW1.js";import"./Version-BSlAgupz.js";import"./geometry2dUtils-DdyQE7AQ.js";import"./viewUtils-DrPohWV3.js";import"./hitTestSelectUtils-UXJPjatw.js";import"./screenUtils-WcqhHU65.js";import"./UnitSelect-Bx5aDsPO.js";import"./globalCss-CZa70j6i.js";import"./DefaultTheme-DgyNOTWV.js";import"./ColorSet-m18wwIVg.js";import"./Tick-CpbeWzTs.js";import"./Button-CkcQ3mkT.js";function fi(i,e,o=10){const t=z(e-i,!1);if(t===0)return[i,e];const n=z(t/(o-1),!0);return[Math.floor(i/n)*n,Math.ceil(e/n)*n]}function z(i,e){const o=Math.floor(Math.log10(i)),t=i/10**o;let n;return n=e?t<1.5?1:t<3?2:t<5?2.5:t<7?5:10:t<=1?1:t<=2?2:t<=3?2.5:t<=5?5:10,n*10**o}const A="#f8f8f8",I="#a9a9a9",g="#323232",xi="line",gi="fill",h=15,x=12,X=.001,hi=.1,Ai=.02,E={fontFamily:"Avenir Next",paddingBottom:x/2,paddingLeft:0,paddingRight:0,paddingTop:0,axisGridStroke:"#f4f4f4",axisLabelsFontSize:9,axisLabelsFontWeight:"400",axisLabelsColor:I,axisTooltipFontSize:12,axisTooltipBackgroundColor:g,axisTooltipLabelColor:A,axisTooltipPaddingTop:Math.round(x/4),axisTooltipPaddingBottom:Math.round(x/4),axisTooltipPaddingHorizontal:Math.round(h/4),xAxisMinGridDistance:50,xAxisLabelsSpacing:Math.round(x/2),xAxisMinLabelPosition:.05,xAxisMaxLabelPosition:.9,yAxisMinGridDistance:30,yAxisLabelSpacing:Math.round(h/4),yAxisMinLabelPosition:0,yAxisMaxLabelPosition:.8,seriesTooltipFontSize:12,seriesTooltipBackgroundColor:A,seriesTooltipLabelColor:g,seriesFillLighten:.9,seriesTooltipSpacing:x/2,seriesTooltipPaddingVertical:Math.round(h/4),seriesTooltipPaddingHorizontal:Math.round(h/4)},vi={...E,axisGridStroke:g,axisLabelsColor:I,axisTooltipBackgroundColor:g,axisTooltipLabelColor:A,seriesTooltipBackgroundColor:g,seriesTooltipLabelColor:A,seriesFillLighten:-.75},y={minX:void 0,maxX:void 0,minY:void 0,maxY:void 0};async function $e(i){const e=await ni(i.container);Q(i.abortOptions);const o=ai(),t=o?vi:E;e.setThemes(o?[S.new(e),N.new(e)]:[S.new(e)]);const n=O(i.container),r=e.container.children.push(si.new(e,{panX:!0,panY:!0,paddingTop:t.paddingTop,paddingBottom:t.paddingBottom,paddingLeft:n?t.paddingRight:t.paddingLeft,paddingRight:n?t.paddingLeft:t.paddingRight,maxTooltipDistance:0}));r.zoomOutButton.set("forceHidden",!0);const a=r.xAxes.push(Y.new(e,{renderer:li.new(e,{})})),s=r.yAxes.push(Y.new(e,{renderer:pi.new(e,{})})),m=P(null),l=P("loading"),p={params:i,chart:r,xAxis:a,yAxis:s,seriesInfos:new Map,messages:null,theme:t,pointerIsOver:!1,get state(){return l.value},get data(){return m.value},set data(d){m.value=d}};yi(p),Ti(p),bi(p);const c=D([Ci(p,i.onRangeChange),ki(p,i.onCursorPositionChange),L(e.events.once("frameended",()=>{l.value="ready"})),L(e)]);return{destroy:()=>{c.remove(),l.value="destroyed"},update:d=>{d.data===p.data&&d.messages===p.messages||M(p)||Li(p,d)},zoomOut:()=>V(p)}}function M(i){return i.state==="destroyed"}function bi({chart:i,xAxis:e,yAxis:o}){const t=mi.new(i.root,{behavior:"none",xAxis:e,yAxis:o});t.lineY.set("visible",!1),i.set("cursor",t)}function yi(i){var a;const{chart:e,xAxis:o,theme:t}=i;o.setAll({extraMax:0,extraMin:0,maxDeviation:0,numberFormatter:U(i,"distance"),strictMinMax:!0,strictMinMaxSelection:!0}),o.axisHeader.set("forceHidden",!0);const n=o.get("renderer");n.setAll({inside:!1,minGridDistance:t.xAxisMinGridDistance}),n.labels.template.setAll({centerX:b,centerY:b,fill:u(t.axisLabelsColor),fontFamily:t.fontFamily,fontSize:t.axisLabelsFontSize,fontWeight:t.axisLabelsFontWeight,maxPosition:t.xAxisMaxLabelPosition,minPosition:t.xAxisMinLabelPosition,paddingLeft:0,paddingRight:0,paddingTop:t.xAxisLabelsSpacing});const r=o.set("tooltip",W.new(e.root,{paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0}));(a=r.get("background"))==null||a.setAll({fill:u(t.axisTooltipBackgroundColor),stroke:void 0}),r.label.setAll({fill:u(t.axisTooltipLabelColor),fontFamily:t.fontFamily,fontSize:t.axisTooltipFontSize,paddingBottom:t.axisTooltipPaddingBottom,paddingLeft:t.axisTooltipPaddingHorizontal,paddingRight:t.axisTooltipPaddingHorizontal,paddingTop:t.axisTooltipPaddingTop}),n.grid.template.setAll({strokeOpacity:1,stroke:u(t.axisGridStroke)})}function Ti(i){const{yAxis:e,theme:o}=i;e.setAll({baseValue:v().noDataValue,extraMax:0,extraMin:0,maxDeviation:0,numberFormatter:U(i,"elevation"),strictMinMax:!0,strictMinMaxSelection:!0,tooltip:void 0}),e.axisHeader.set("visible",!1);const t=O(i.params.container),n=e.get("renderer");n.setAll({minGridDistance:o.yAxisMinGridDistance,opposite:t,inside:!0}),n.labels.template.setAll({centerX:b,centerY:ci,fill:u(o.axisLabelsColor),fontFamily:o.fontFamily,fontSize:o.axisLabelsFontSize,fontWeight:o.axisLabelsFontWeight,maxPosition:o.yAxisMaxLabelPosition,minPosition:o.yAxisMinLabelPosition,paddingBottom:0,paddingLeft:t?0:o.yAxisLabelSpacing,paddingRight:t?o.yAxisLabelSpacing:0,paddingTop:0,textAlign:"start"}),n.grid.template.setAll({strokeOpacity:1,stroke:u(o.axisGridStroke)})}function Li(i,e){var s;if(M(i))return;const o=i.data??void 0,t=e.data??void 0;(s=i.chart.get("cursor"))==null||s.set("forceHidden",!(t!=null&&t.refined));const n=o!==t,r=(o==null?void 0:o.effectiveUnits)!==(t==null?void 0:t.effectiveUnits),a=(o==null?void 0:o.uniformScaling)!==(t==null?void 0:t.uniformScaling);i.data=t,i.messages=e.messages,(n||r)&&(Mi(i),Pi(i)),a&&V(i),T(i)}function V(i){M(i)||(i.xAxis.zoom(0,1),i.yAxis.zoom(0,1))}function Mi(i){const{chart:e,data:o,xAxis:t,yAxis:n}=i,{minX:r,maxX:a,minY:s,maxY:m}=Fi({data:o,pixelWidth:t.width(),pixelHeight:n.height()}),l=!!(o!=null&&o.uniformScaling),p=!!(o!=null&&o.refined);e.setAll({panX:!0,panY:l,pinchZoomX:p,pinchZoomY:p&&l,wheelX:"panX",wheelY:p?l?"zoomXY":"zoomX":"none"}),t.setAll({max:a,min:r,panX:!0,panY:!1,zoomX:!0,zoomY:l}),n.setAll({max:m,min:s,panX:!1,panY:l,zoomX:l,zoomY:l})}function Fi({data:i,pixelWidth:e,pixelHeight:o}){if(i==null)return y;const t=i.statistics,n=0,r=t==null?void 0:t.maxDistance;let a=t==null?void 0:t.minElevation,s=t==null?void 0:t.maxElevation;if(r==null||a==null||s==null)return y;const m=Math.max(r-n,X);let l=Math.max(s-a,X);const p=i.effectiveUnits;if(i.dynamicElevationRange){const c=R(m,p.distance,p.elevation);l=Math.max(l,c/v().maxChartRatio)}return a-=Ai*l,s=a+l+hi*l,[a,s]=fi(a,s,10),l=s-a,i.uniformScaling?Si({data:i,bounds:{minX:n,maxX:r,minY:a,maxY:s},pixelWidth:e,pixelHeight:o,centered:!0}):{minX:n,maxX:n+m,minY:a,maxY:a+l}}function Si({data:i,bounds:e,pixelWidth:o,pixelHeight:t,centered:n}){if(i==null)return e;let{minX:r,maxX:a,minY:s,maxY:m}=e;if(r==null||a==null||s==null||m==null)return y;const l=a-r,p=m-s,c=i.effectiveUnits,d=R(p,c.elevation,c.distance)/t/(l/o);return d>=1?[r,a]=C([r,a],d,n):[s,m]=C([s,m],1/d,n),{minX:r,maxX:a,minY:s,maxY:m}}function C([i,e],o,t){const n=(e-i)*o;if(t){const r=(i+e)/2-n/2;return[r,r+n]}return[i,i+n]}function Pi(i){var l;const{chart:e,data:o,seriesInfos:t,xAxis:n,yAxis:r}=i;if(o==null||o.lines.length===0)return void e.series.clear();const a=new Map,s=new Set(e.series.values),m=o.lines.length;for(let p=0;p<m;p++){const c=o.lines[p];let d=t.get(c.id);d?(d.fill&&s.delete(d.fill),s.delete(d.line)):(d=zi(i,c),d.fill&&e.series.push(d.fill),e.series.push(d.line)),a.set(d.id,d);const f=m-p-1;(l=d.fill)==null||l.set("layer",f),d.line.set("layer",m+f),Yi(i,d,c)}i.seriesInfos=a;for(const p of s)e.series.removeValue(p);n.set("layer",m+1),r.set("layer",m+2)}function Yi({theme:i},e,o){const t=u(o.color.toCss()),n=o.samples??[],r=n.length>0,{line:a,fill:s}=e;a.set("visible",r),a.set("stroke",t),s==null||s.set("visible",r),s==null||s.set("fill",ui.lighten(t,i.seriesFillLighten)),a.data.setAll(n),s==null||s.data.setAll(n)}function zi(i,e){const{id:o}=e,t=k(i,`${xi}-${o}`);t.setAll({dy:e.chartStrokeOffsetY,tooltip:Xi(i)}),t.strokes.template.setAll({strokeWidth:e.chartStrokeWidth});let n=null;return e.chartFillEnabled&&(n=k(i,`${gi}-${o}`),n.fills.template.setAll({fillOpacity:1,visible:!0})),{id:o,line:t,fill:n}}function k(i,e){return di.new(i.chart.root,{connect:!1,excludeFromTotal:!0,fill:void 0,id:e,stroke:void 0,valueXField:"distance",valueYField:"elevation",xAxis:i.xAxis,yAxis:i.yAxis})}function Xi({theme:i,chart:e}){var r;const o=W.new(e.root,{autoTextColor:!1,forceHidden:!0,getFillFromSprite:!1,getLabelFillFromSprite:!1,pointerOrientation:"vertical",visible:!1}),t=i.seriesTooltipPaddingHorizontal,n=i.seriesTooltipPaddingVertical;return o.label.setAll({fill:u(i.seriesTooltipLabelColor),fontFamily:i.fontFamily,fontSize:i.seriesTooltipFontSize,paddingBottom:n,paddingLeft:t,paddingRight:t,paddingTop:n,textAlign:"start"}),(r=o.get("background"))==null||r.setAll({stroke:void 0,fill:u(i.seriesTooltipBackgroundColor)}),o.adapters.add("dy",a=>{var l;const s=i.seriesTooltipSpacing,m=((l=o.get("pointTo"))==null?void 0:l.y)??0;return(a??0)+(o.y()>m?s:-s)}),o}function Ci(i,e){const{xAxis:o,yAxis:t}=i,n=()=>{e(w(o),w(t))},r=a=>[a.on("start",n),a.on("end",n)];return Z([...r(o),...r(t)])}function w(i){const e=Math.abs((i.get("end")??0)-(i.get("start")??0)),o=e!==0?1/e:1;return Math.abs(1-o)<ii()?1:o}function ki(i,e){const{chart:o,xAxis:t,yAxis:n}=i,r=o.get("cursor"),a=o.plotContainer.events,s=l=>{i.pointerIsOver=l,T(i)},m=()=>{s(!1),e(null,null)};return Z([r==null?void 0:r.events.on("cursormoved",()=>{if(!i.pointerIsOver)return;T(i);let l=(r==null?void 0:r.getPrivate("positionX"))??0,p=(r==null?void 0:r.getPrivate("positionY"))??0;const c=i.data;if((c==null?void 0:c.statistics)!=null){const{maxDistance:d,minElevation:f,maxElevation:F}=c.statistics;d!=null&&(l=$(l,H(t),B(t),0,d)),f!=null&&F!=null&&(p=$(p,H(n),B(n),f,F))}e(l,p)}),a.on("pointerover",()=>s(!0)),a.on("pointerout",m),a.on("blur",m)])}function $(i,e,o,t,n){return(e+i*(o-e)-t)/(n-t)}function T(i){const e=wi(i);if(!e)return void i.seriesInfos.forEach(o=>{var t;(t=o.line.get("tooltip"))==null||t.set("forceHidden",!0)});i.seriesInfos.forEach(o=>{const t=o.line.get("tooltip");t.set("forceHidden",!1),t.label.set("text",e)}),i.xAxis.getTooltip().setAll({tooltipText:Bi(i)})}function wi(i){const{data:e}=i,o=e==null?void 0:e.lines.map(t=>{var n;return{line:t,y:(n=j(i,t))==null?void 0:n.elevation}}).sort($i);return o&&o.length!==0&&o[0].y!=null?o.map(({y:t,line:n})=>Hi(i,n,t)).join(`
`):null}function $i({y:i},{y:e}){return i==null?1:e==null?-1:e-i}function Hi(i,e,o){const{data:t,messages:n}=i;if(t==null||n==null)return"";const r=v().formatPrecision,a=q(n.chartTooltip,{name:ti(e,n),elevation:o!=null?G(n,o,t.effectiveUnits.elevation,r):oi});return`[${e.color.toHex()}]●[/] ${a}`}function Bi(i){const{data:e,messages:o}=i;if(e==null||o==null)return"";const t=e.lines[0],n=t?j(i,t):null,r=v().formatPrecision;return n!=null?G(o,n.distance,e.effectiveUnits.distance,r):"-"}function U(i,e){const o=ri.new(i.chart.root,{});return o.format=(t,n,r)=>{const{data:a,messages:s}=i;return s==null||a==null||typeof t=="string"?"":`${J(t,{maximumFractionDigits:r})} ${_(s,a.effectiveUnits[e],"abbr")}`},o}function j({chart:i,xAxis:e},o){const t=o.samples??[];if(t.length===0)return null;const n=i.get("cursor"),r=(n==null?void 0:n.getPrivate("positionX"))??0,a=e.toAxisPosition(r),s=e.positionToValue(a);return ei(t,s,m=>m.distance)}function H(i){return i.positionToValue(i.get("start")??0)}function B(i){return i.positionToValue(i.get("end")??1)}function Z(i){return D(i.map(L))}function L(i){return K(()=>{i==null||i.dispose()})}export{$e as createChart,Fi as getAdjustedBounds};
