const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-DVEy4f7w.js","./index-CjrYEQXz.js","./jsxFactory-CLjKarlq.js","./Accessor-BHnuXKD2.js","./intl-Do3GEEJ7.js","./Promise-CmQqe-ke.js","./cast-BA_-jlhc.js","./index-tefRSezt.js","./index-Cx51aysm.css","./JSONSupport-CGdeqxpk.js","./Evented-DCWccWGU.js","./reactiveUtils-BR0C1Kq4.js","./SimpleObservable-7oieNGD8.js","./uuid-Cl5lrJ4c.js","./guid-ejniuQmw.js","./useT9n-CJAswmP1.js","./index-73bQemcW.js","./dom--xxYYVQF.js","./observers-BdozwIHb.js","./keyed-CdPY5MOf.js","./directive-helpers-C0aXnQdc.js","./ref-Ccn4I0kT.js","./interactive-B8siLByk.js","./loadable-DOQnSSjG.js","./component-CFGnHAqh.js","./index-TFxiSNpz.js","./index-DIp-v4qk.js","./floating-ui-BkLjHVN3.js","./debounce-DbkufipY.js","./openCloseComponent-dw_x67D_.js","./static-g4FJ4v8I.js","./FloatingArrow-D9X-HbKW.js","./useFocusTrap-ENcZoC4L.js","./focusTrapComponent-Br_3Mz8_.js","./key-CZcQa38B.js","./index-CCqZjfSZ.js","./array-BbE1dLa5.js","./index-BSRDeu3E.js","./ExpandToggle-UGfmSgey.js","./index-D130RxMY.js","./label-BLne9qNB.js","./index-DqW6JA5s.js","./index-CG2ORNuo.js","./index-Cdn0mJBU.js","./_commonjsHelpers-DqlTr81k.js","./global-BYws3GYH.js","./index-Ch_sYKt7.js","./index-svtat3zr.js","./customElement-C8qyVijX.js","./live-BIBBLA6F.js","./form-B15gmg4q.js","./Validation-O1TFEQW-.js","./input-DI9tZAPS.js","./index-BGRynF8w.js","./locale-CXx8I9ox.js","./index-B7BDzDjX.js","./index-BtF7Kdcs.js","./index-BeVvv8sv.js","./core-zHisM37C.js","./index-DWkZ-WI6.js","./index-LmcDAlT8.js","./repeat-Cgn4lGS8.js","./math-BpAtBkbz.js","./throttle-CQXZGPS6.js"])))=>i.map(i=>d[i]);
import{_ as f}from"./index-tefRSezt.js";import{r as o,m as n,a as P,g as tt,N as L,B as et}from"./Accessor-BHnuXKD2.js";import{h as u}from"./Color-gncXBiLc.js";import"./intl-Do3GEEJ7.js";import{p as it,d as I,P as rt}from"./reactiveUtils-BR0C1Kq4.js";import{g as ot}from"./unitFormatUtils-Dbksq3U5.js";import{n as a,e as V,O as nt,c as st,v as at}from"./jsxFactory-CLjKarlq.js";import{e as A}from"./globalCss-CZa70j6i.js";import{r as q,t as lt,o as T}from"./LabeledSwitch-CbCItYC2.js";import{i as pt}from"./Evented-DCWccWGU.js";import{_ as z,M as ct}from"./mathUtils-DV9iOXpW.js";import{j as k,x as j}from"./Point-XGrwlf63.js";import{U as dt,O as mt}from"./projection-B2I9Bzj_.js";import{u as ht}from"./scaleUtils-CfLu-sg1.js";import{S as ut}from"./JSONSupport-CGdeqxpk.js";import{r as gt}from"./enumeration-Cr5WIZs4.js";import{e as U}from"./projectVectorToVector-dS8io47t.js";import{e as vt}from"./defaultUnit-CO7iAvsB.js";import{d as F,y as _t}from"./TextSymbol-BQ_NW9Xo.js";import{t as yt,l as bt,f as wt,u as ft}from"./gridUtils-DagZsDOv.js";import{DrawGraphicTool2D as St}from"./editingTools-EqwFkCtO.js";import{d as Ct}from"./SnappingManager-CF4NflXd.js";import{d as W}from"./RightAngleSnappingHint-CCcBBYgG.js";import{x as Mt}from"./TextOverlayItem-D-lNDrXB.js";import{o as xt}from"./formatUtils-DMCnWBkV.js";import{s as Tt}from"./substitute-D1XJWgT5.js";import"./colorUtils-Rxh2V3ai.js";import"./Promise-CmQqe-ke.js";import"./cast-BA_-jlhc.js";import"./SimpleObservable-7oieNGD8.js";import"./ByteSizeUnit-BsxeN7wM.js";import"./Cyclical-CPiNl4ru.js";import"./quantityUtils-1LswOhxZ.js";import"./uuid-Cl5lrJ4c.js";import"./writer-B2bQV2uU.js";import"./vec3f64-BLpZdpfb.js";import"./Extent-CBBGeHb-.js";import"./Polyline-BmuD2-ZN.js";import"./projectBuffer-DOU0xvVi.js";import"./geodesicConstants-yASAK_zX.js";import"./projectPointToVector-BS0u8fq6.js";import"./getDefaultUnitForView-CuRQcAm0.js";import"./Portal-CTRRujjZ.js";import"./screenUtils-_ZIvrt5o.js";import"./geodesicUtils-Bh_GX0Qj.js";import"./normalizeUtils-XRAPXbWa.js";import"./normalizeUtilsCommon-D0zPTJCj.js";import"./jsonUtils-Cu7OBRmN.js";import"./utils-Cy8wFNQo.js";import"./utils-CkSELPnj.js";import"./Graphic-CFXUQZlS.js";import"./Clonable-DvJsj5LF.js";import"./opacityUtils-CSd4XoR2.js";import"./ActionToggle-__-l4AdQ.js";import"./Identifiable-BrT7zvUW.js";import"./typeUtils-BSg8Y507.js";import"./collectionUtils-CbaToa73.js";import"./aaBoundingBox-CeBivBRq.js";import"./SnappingVisualizer2D-CeuJ0hoo.js";import"./vec2-maR1OrZI.js";import"./common-DQOJ18NT.js";import"./vec2f64-Dy6m9Nrb.js";import"./enums-BJSSbDkD.js";import"./SnappingVisualizer-Cb3uuWOu.js";import"./PointSnappingHint-CurBFXPo.js";import"./vec32-Dvg_eL9J.js";import"./editPlaneUtils-DCrwtYoD.js";import"./UpdatingHandles-ptqz1ck8.js";import"./coordinateFormatter-DRC3YXJ-.js";import"./GraphicsLayer-Acqd2VFm.js";import"./GraphicsCollection-CkliHSk1.js";import"./Layer-C9uQlTBT.js";import"./TimeExtent-J5qnUFx_.js";import"./timeUtils-D2X862bk.js";import"./ScaleRangeLayer-C59zG_yk.js";import"./layerContainerType-C5CzMsLd.js";import"./jsonUtils-TjZmCq6l.js";import"./utils-DYurMneM.js";import"./mat4f32-DcsiF_Rp.js";import"./mat4-Fi6iAz29.js";import"./ElevationInfo-Di4W6v5U.js";import"./unitConversionUtils-C4AR5obr.js";import"./lengthUtils-DjJgJFRg.js";import"./dehydratedFeatureComparison-Bbl7iMhI.js";import"./createUtils-CfrW4il_.js";import"./Circle-aC-JFV1q.js";import"./geometryEngine-CtEcpiHE.js";import"./geometryEngineBase-yFIvKOkM.js";import"./_commonjsHelpers-DCkdB7M8.js";import"./hydrated-Dw-Mfo_Y.js";import"./surfaceCoordinateSystems-DRgCZXAE.js";import"./memoize-DsJmrG76.js";import"./ReactiveSet-CoXPgSt3.js";import"./diffUtils-CMkuJvD2.js";import"./elevationInfoUtils-RSZ4Logn.js";import"./ViewingMode-Dodu7ZZk.js";import"./DrawingMode-Cvvf0VVz.js";import"./EditGeometryOperations-C5kkQVhH.js";import"./vec42-YcqnINSP.js";import"./vec4f64-o2zAXfmz.js";import"./plane-4dpuo6-e.js";import"./mat3f64-BBpwCtoL.js";import"./mat4f64-Dk4dwAN8.js";import"./quatf64-CCm9z-pX.js";import"./mathUtils-B9R7G-2c.js";import"./geometry2dUtils-vtViF5g_.js";import"./dragEventPipeline-D_Ldto1o.js";import"./meshVertexSpaceUtils-SW0WEjNN.js";import"./MeshLocalVertexSpace-C0YDTRex.js";import"./hydratedFeatures-BVVSs98j.js";import"./angularMeasurementUtils-lDJJxFDs.js";import"./SketchLabelOptions-CwtwEofC.js";import"./SnappingContext-lR2hMWGP.js";import"./SnappingDragPipelineStep-C7nIAEz_.js";import"./Scheduler-B_GuBefw.js";import"./signal-DSa0yokC.js";import"./debugFlags-ZrDyTcDc.js";import"./SnappingOperation-DhUO_0vk.js";import"./mat2d-D9DBP-jx.js";import"./mat2df64-CBKYtunK.js";import"./quat-4pa1e6ds.js";import"./helpMessageUtils-2XpUG8Xk.js";import"./helpMessageUtils3d-GWzBuIWZ.js";import"./SketchTooltipInfo-BnBTvnNx.js";import"./MeshTransform-CIhaTwDv.js";import"./axisAngleDegrees-8Sw4vC28.js";import"./keybindings-DrKrBFID.js";import"./InputManager-Bs9UE-jw.js";import"./Queue-BOnccek2.js";import"./themeUtils-C3zvZbsE.js";import"./a11yUtils-CSYUX1kC.js";import"./quantityFormatUtils-9VppKzbq.js";import"./directionModeIcons-Br5woIHu.js";import"./automaticAreaMeasurementUtils-BLAXwG3j.js";import"./geodesicMeasurementUtils-ChQtpZ42.js";import"./euclideanAreaMeasurementUtils-D8mvS0qj.js";import"./earcut-Lltz9D9k.js";import"./triangle-D_E6eTS3.js";import"./sphere-DQxj5tsv.js";import"./mat3-CR8GKnhD.js";import"./lineSegment-C-CDF7QX.js";import"./euclideanLengthMeasurementUtils-EupqVlJl.js";import"./spatialReferenceEllipsoidUtils-DM073JUd.js";import"./geodesicAreaMeasurementUtils-C07tJXJM.js";import"./automaticLengthMeasurementUtils-B8fQn4oI.js";import"./geodesicLengthMeasurementUtils-C8eO8ivV.js";import"./InteractiveToolBase-DNJTN0p5.js";import"./interfaces-D6pIddIh.js";import"./SketchOptions-92Ul6Fzp.js";import"./boundedPlane-Dyz2ub5d.js";import"./cimSymbolUtils-azhJhO4Y.js";import"./utils-B91u8350.js";import"./defaultCIMValues-DII_GG3u.js";import"./GraphicManipulator-dZUtye0g.js";import"./defaults-Dwxdhopq.js";import"./defaultsJSON-GKolV7NZ.js";import"./drapedUtils-DFAbG8en.js";import"./colorUtils-BAowQmkN.js";import"./drawUtils-BxNz8j4I.js";import"./hitTestSelectUtils-UXJPjatw.js";import"./screenUtils-DyhV4TAA.js";import"./viewUtils-Ce2x26K8.js";import"./Query-DCBIeen2.js";import"./Field-Cyk7Ur5d.js";import"./fieldType-L-VlbZqy.js";import"./FullTextSearch-BWm_kPUE.js";import"./utils-D02V2_jH.js";import"./Version-9k2AOv05.js";import"./number-BWHn6sm2.js";let g=class extends ut{constructor(i){super(i),this.center=new k,this.dynamicScaling=!0,this.majorLineColor=u.fromArray([115,115,115,1]),this.majorLineInterval=10,this.minorLineColor=u.fromArray([165,165,165,1]),this.rotateWithMap=!1,this.rotation=0,this.spacing=1,this.type="measured",this.units="miles"}};o([n()],g.prototype,"center",void 0),o([n()],g.prototype,"dynamicScaling",void 0),o([n()],g.prototype,"majorLineColor",void 0),o([n()],g.prototype,"majorLineInterval",void 0),o([n()],g.prototype,"minorLineColor",void 0),o([n()],g.prototype,"rotateWithMap",void 0),o([n()],g.prototype,"rotation",void 0),o([n()],g.prototype,"spacing",void 0),o([gt({measured:"measured"})],g.prototype,"type",void 0),o([n()],g.prototype,"units",void 0),g=o([P("esri.grids.MeasuredGrid")],g);let v=class extends tt{constructor(i){super(i),this.color=new u([255,127,0,1]),this.isDecoration=!0,this.length=34,this.rotation=0,this.thickness=2,this.visible=!0}get _strokeStyle(){return this.color.toCss(!0)}render(){const{x:i,y:t,length:e,thickness:r,rotation:s}=this,l=e/2,d=`0 0 ${e} ${e}`,c=`M${l} 0 V${e} M0 ${l} H${e}`;return a("div",{classes:{"esri-box-overlay-item":!0},dir:"ltr",styles:{left:`${(i??0)-l}px`,top:`${(t??0)-l}px`,width:`${e}px`,height:`${e}px`,transform:`rotate(${s}deg)`,visibility:this.visible?"visible":"hidden"}},a("svg",{styles:{overflow:"visible"},viewbox:d},a("path",{d:c,stroke:this._strokeStyle,"stroke-width":r})))}renderCanvas(){}};o([n()],v.prototype,"color",void 0),o([n()],v.prototype,"isDecoration",void 0),o([n()],v.prototype,"length",void 0),o([n()],v.prototype,"rotation",void 0),o([n()],v.prototype,"thickness",void 0),o([n()],v.prototype,"visible",void 0),o([n()],v.prototype,"x",void 0),o([n()],v.prototype,"y",void 0),o([n({readOnly:!0})],v.prototype,"_strokeStyle",null),v=o([P("esri.views.overlay.CrosshairOverlayItem")],v);const $t=v,K=i=>{if(i==null||isNaN(i))return 0;const t=i+180;return Math.trunc(z(t,360))},It=i=>{let t=i;return t==null?0:(typeof t=="string"&&(t=parseInt(t,10)),isNaN(t)?0:z(Math.trunc(t),360)-180)},B=(i,t)=>{if(!i||t.length<3)return;const[e,r,s,l]=t,[d,c]=l===void 0?[1,.25]:[l,.25*l];i.majorLineColor=u.fromArray([e,r,s,d]),i.minorLineColor=u.fromArray([e,r,s,c])},N=Symbol("grid-interactivity");let p=class extends pt.EventedAccessor{constructor(t){super(t),this._drawGraphicTool=null,this._crosshairLabel=null,this._crosshairItem=null,this.snappingManager=null,this.snappingOptions=null,this.view=null,this.placementDisabled=!1,this._mostRecentlyShownGrid=null,this._sketchedVertexCount=0}initialize(){this.addHandles([it(()=>!this.displayEnabled,()=>{this.interactivePlacementState=null}),I(()=>{var t;return(t=this.view)==null?void 0:t.viewpoint},()=>{this._renderOverlays()}),I(()=>{var t;return(t=this.snappingOptions)==null?void 0:t.gridEnabled},t=>{t!=null&&this.trySetDisplayEnabled(t)}),I(()=>{var t;return(t=this.view)==null?void 0:t.grid},(t,e)=>{this._mostRecentlyShownGrid=!t&&e?e:null})])}destroy(){var t,e,r,s;this._resetGridPlacementState(),this._crosshairItem&&((e=(t=this.view)==null?void 0:t.overlay)==null||e.removeItem(this._crosshairItem),this._crosshairItem=L(this._crosshairItem)),this._crosshairLabel&&((s=(r=this.view)==null?void 0:r.overlay)==null||s.removeItem(this._crosshairLabel),this._crosshairLabel=L(this._crosshairLabel))}get displayEnabled(){var t;return!!((t=this.view)!=null&&t.grid)}get dynamicScaling(){var t;return((t=this.grid)==null?void 0:t.dynamicScaling)??!1}set dynamicScaling(t){this.grid&&(this.grid.dynamicScaling=t)}get grid(){var t;return((t=this.view)==null?void 0:t.grid)??this._mostRecentlyShownGrid}set gridColor(t){this._set("gridColor",t);const[e,r,s,l]=t.toArray();B(this.grid,[e,r,s,l/255])}get gridControlsEnabled(){return this.displayEnabled&&!this.interactivePlacementState}set interactivePlacementState(t){this._set("interactivePlacementState",t),this._resetGridPlacementState(),t&&this._startGridManipulation(t)}get majorLineInterval(){var t;return((t=this.grid)==null?void 0:t.majorLineInterval)??10}set majorLineInterval(t){this.grid&&(this.grid.majorLineInterval=t<1?1:t>15?15:t)}get rotateWithMap(){var t;return((t=this.grid)==null?void 0:t.rotateWithMap)??!1}set rotateWithMap(t){this.grid&&(this.grid.rotateWithMap=t)}get rotation(){var t;return((t=this.grid)==null?void 0:t.rotation)??-180}set rotation(t){this.grid&&(this.grid.rotation=t)}get snappingEnabled(){var t;return(this.grid&&((t=this.snappingOptions)==null?void 0:t.gridEnabled))??!1}set snappingEnabled(t){const{snappingOptions:e}=this;e&&(e.gridEnabled=t)}get spacing(){var t;return((t=this.grid)==null?void 0:t.spacing)??1}set spacing(t){this.grid&&t>0&&(this.grid.spacing=t)}get unit(){var t;return(t=this.grid)==null?void 0:t.units}set unit(t){this.grid&&(this.grid.units=t)}get gridOutOfScale(){return!this.dynamicScaling&&this._pixelsPerStride!=null&&this._pixelsPerStride<yt}get effectiveSpacingAfterDynamicScaling(){var t;return this.majorLineInterval<1||!this.dynamicScaling||!this.view||this._pixelsPerStride==null||!((t=this.grid)!=null&&t.spacing)?null:this.grid.spacing*bt(this.majorLineInterval,this._pixelsPerStride,this.dynamicScaling)}get numericSpacingInputShouldBeVisible(){var t;return!!((t=this.view)!=null&&t.spatialReference)&&wt(this.view.spatialReference)}get _metersPerSRUnit(){if(!(this.view&&this.displayEnabled&&this.grid&&dt(this.grid.center.spatialReference,this.view.spatialReference)))return null;const t=mt(this.grid.center,this.view.spatialReference);return ft(t)}get _pixelsPerStride(){var s;if(!((s=this.view)!=null&&s.scale)||!this.displayEnabled||!this.grid||this._metersPerSRUnit==null)return null;const t=this.grid,{scale:e,spatialReference:r}=this.view;return j(t.spacing,t.units,"meters")/(this._metersPerSRUnit*ht(e,r))}get _isPlacing(){if(!this._drawGraphicTool)return!1;const t=this.interactivePlacementState;return t==="place"||t==="interactive"&&this._sketchedVertexCount===0}get _isRotating(){if(!this._drawGraphicTool)return!1;const t=this.interactivePlacementState;return t==="rotate"||t==="interactive"&&this._sketchedVertexCount===1}get _isScaling(){return this._drawGraphicTool?this.interactivePlacementState==="interactive"&&this._sketchedVertexCount===1:!1}togglePlacementState(t){this.interactivePlacementState=this.interactivePlacementState===t?null:t}trySetDisplayEnabled(t){const{view:e}=this;if(e!=null&&e.ready)if(!e.grid&&t)if(this._mostRecentlyShownGrid)e.grid=this._mostRecentlyShownGrid;else{const r=this.defaultUnit==="imperial"?"feet":"meters";e.grid=new g({units:r,center:e.center??new k,rotateWithMap:!0}),B(this.grid,[115,115,115])}else t||(e.grid=null);else et.getLogger(this).warn("Attempting to enable grid display while view is not ready")}startPlacement(t){const{view:e,snappingManager:r}=this;if(!e)return;this._set("interactivePlacementState",t),this._sketchedVertexCount=0;const s=new St({view:e,graphicProperties:{attributes:{[W]:W}},sketchOptions:{tooltips:{enabled:!0,visibleElements:{direction:!1,rotation:!1,totalLength:!1,elevation:!1,distance:!1,area:!1}}},geometryType:"polyline",mode:"click",snapToScene:!1,snappingManager:r,forceUniformSize:!0,centered:!1,cursor:this.interactivePlacementState==="interactive"||this.interactivePlacementState==="place"?"none":null,regularVerticesSymbol:void 0,activeVertexSymbol:Pt,activeLineSymbol:H,graphicSymbol:H});this._drawGraphicTool=s,e.addAndActivateTool(s),this._renderOverlays(),this.addHandles([s.on("cursor-update",l=>this._onCursorUpdate(l)),s.on("complete",()=>this._onDrawComplete()),s.on("vertex-add",l=>this._onVertexAdd(l,t))],N)}async _startGridManipulation(t){const{view:e}=this;if(!e)return void(this.interactivePlacementState=null);const r=new CustomEvent("before-placement",{cancelable:!0});this.emit("before-placement",r),r.defaultPrevented||this.startPlacement(t)}_onCursorUpdate(t){var e;try{if(this._isPlacing){const r=t.vertices[0].coordinates;return void this._handlePlace(r)}if(this._drawGraphicTool.cursor=null,this._isRotating&&this._handleRotate(t.vertices[0].coordinates),this._isScaling){const r=(e=this._drawGraphicTool)==null?void 0:e.drawOperation.cursorVertex;this._handleScale(r)}}finally{this._renderOverlays()}}_onDrawComplete(){this._drawGraphicTool.cursor=null,this.interactivePlacementState=null}_onVertexAdd(t,e){const r=t.vertices[0].coordinates;this._isPlacing&&this._handlePlace(r),this._isRotating&&this._sketchedVertexCount>0&&this._handleRotate(r),this._isScaling&&this._sketchedVertexCount>0&&this._handleScale(U(r[0],r[1],void 0,this.view.spatialReference)),this._sketchedVertexCount++,this._drawGraphicTool.cursor=null,this._sketchedVertexCount!==2&&e==="interactive"||(this.interactivePlacementState=null),this._renderOverlays()}_handlePlace(t){const{grid:e,view:r}=this;e&&r&&(e.center=new k({x:t[0],y:t[1],spatialReference:r.spatialReference}))}_handleRotate(t){var D;const{grid:e,view:r}=this;if(!e||!r)return;(D=this._drawGraphicTool)==null||D.sketchOptions.tooltips.set("enabled",!1);const{x:s,y:l}=e.center,[d,c]=t,b=r.toScreen(e.center,{pickClosestTarget:!0}),m=b&&r.toMap(b),w=r.toScreen(U(d,c,void 0,r.spatialReference),{pickClosestTarget:!0}),S=w&&r.toMap(w),M=m?m.x:s,E=m?m.y:l,x=M-(S?S.x:d),R=E-(S?S.y:c);if(x===0&&R===0)return;const Q=Math.atan2(R,x),G=ct(Q),X=e.rotateWithMap,Y=r.viewpoint.rotation??0,Z=X?G:G-Y;e.rotation=Math.fround(Z)%360}_handleScale(t){const{view:e,grid:r,_drawGraphicTool:s,interactivePlacementState:l,_metersPerSRUnit:d}=this;if(!(t&&e&&r&&s&&d))return;s.sketchOptions.tooltips.enabled=!1;const c=l==="interactive"?r.center:s.drawOperation.firstVertex;if(!c||!t)return;const b=e==null?void 0:e.toScreen(c),m=b&&e.toMap(b),w=e==null?void 0:e.toScreen(t),S=m??c,M=(w&&e.toMap(w))??t,E=Math.sqrt((S.x-M.x)**2+(S.y-M.y)**2),x=j(E*d,"meters",r.units);this.spacing=x}_renderOverlays(){this._renderCrosshairOverlay(),this._renderTextOverlay()}_renderTextOverlay(){const{grid:t,view:e,_drawGraphicTool:r}=this,s=this._getCrosshairLabel();if(!(t&&(e!=null&&e.overlay)&&r&&s))return;const l=e.toScreen(t.center,{pickClosestTarget:!0});l&&(s.position=[l.x+12,l.y+12]),this._isRotating?(s.text=`${K(t.rotation)}${xt}`,s.visible=!0):s.visible=!1}_renderCrosshairOverlay(){const{grid:t,view:e,_drawGraphicTool:r}=this;if(!t||!(e!=null&&e.overlay)||!r)return;const s=this._getCrosshair();if(!s)return;const l=e.toScreen(t.center);l&&(s.x=l.x,s.y=l.y,s.rotation=t.rotateWithMap?e.viewpoint.rotation-t.rotation:-t.rotation,s.visible=!!r)}_getCrosshairLabel(){if(this._crosshairLabel)return this._crosshairLabel;const{grid:t,view:e,_drawGraphicTool:r}=this;if(!t||!(e!=null&&e.overlay)||!r)return null;const s=new Mt({anchor:"top-left",fontSize:10,textColor:new u([21,21,21]),backgroundColor:new u([248,248,248]),padding:8,borderRadius:20});return e.overlay.addItem(s),this._crosshairLabel=s,s}_getCrosshair(){var r;const{_crosshairItem:t,view:e}=this;return e!=null&&e.overlay?t&&e.overlay.items.includes(t)?t:(this._crosshairItem=new $t({color:e.effectiveTheme.accentColor,thickness:4,length:36,visible:!0}),(r=e.overlay)==null||r.addItem(this._crosshairItem),this._crosshairItem):null}_resetGridPlacementState(){var t,e;this.removeHandles(N),this._crosshairItem&&(this._crosshairItem.visible=!1),this._crosshairLabel&&(this._crosshairLabel.visible=!1),this._drawGraphicTool&&(((t=this.view)==null?void 0:t.activeTool)===this._drawGraphicTool&&(this.view.activeTool=null),(e=this.view)==null||e.tools.remove(this._drawGraphicTool)),this._drawGraphicTool=L(this._drawGraphicTool)}};o([n(vt)],p.prototype,"defaultUnit",void 0),o([n({readOnly:!0})],p.prototype,"displayEnabled",null),o([n()],p.prototype,"dynamicScaling",null),o([n()],p.prototype,"grid",null),o([n({type:u})],p.prototype,"gridColor",null),o([n({readOnly:!0})],p.prototype,"gridControlsEnabled",null),o([n()],p.prototype,"interactivePlacementState",null),o([n()],p.prototype,"majorLineInterval",null),o([n()],p.prototype,"rotateWithMap",null),o([n()],p.prototype,"rotation",null),o([n()],p.prototype,"snappingEnabled",null),o([n()],p.prototype,"snappingManager",void 0),o([n({type:Ct})],p.prototype,"snappingOptions",void 0),o([n()],p.prototype,"spacing",null),o([n()],p.prototype,"unit",null),o([n()],p.prototype,"view",void 0),o([n({readOnly:!0})],p.prototype,"gridOutOfScale",null),o([n({readOnly:!0})],p.prototype,"effectiveSpacingAfterDynamicScaling",null),o([n({readOnly:!0})],p.prototype,"numericSpacingInputShouldBeVisible",null),o([n()],p.prototype,"placementDisabled",void 0),o([n()],p.prototype,"_metersPerSRUnit",null),o([n()],p.prototype,"_pixelsPerStride",null),o([n()],p.prototype,"_isPlacing",null),o([n()],p.prototype,"_isRotating",null),o([n()],p.prototype,"_isScaling",null),o([n()],p.prototype,"_mostRecentlyShownGrid",void 0),o([n()],p.prototype,"_sketchedVertexCount",void 0),p=o([P("esri.widgets.support.GridControls.GridControlsViewModel")],p);const J=p,H=new F({width:0}),Pt=new _t({color:u.fromArray([0,0,0,0]),outline:new F({color:u.fromArray([0,0,0,0])})}),_="esri-grid-controls",y={base:_,borderedSwitch:`${_}__switch--bordered`,container:`${_}__container`,numericInputsContainer:`${_}__numeric-inputs__container`,tilegroup:`${_}__tilegroup`,tile:`${_}__tile`,tileDisabled:`${_}__tile--disabled`,tileContent:`${_}__tile__content`,suffixedInputContainer:`${_}__input-with-suffix__container`,inputSuffix:`${_}__input-with-suffix__suffix-part`,inlineIcon:`${_}__inline-icon`},C={widgetIcon:"grid-unit",gridTheme:{light:"circle",dark:"circle-area",custom:"palette"},placementState:{interactive:"maximum-territory-distance",place:"move",rotate:"rotate"},warning:"exclamation-mark-triangle"},$=u.fromArray([115,115,115]),O=u.fromArray([200,200,200]),Et=["interactive","place","rotate"];let h=class extends nt{constructor(i,t){super(i,t),this.customColor=null,this.messages=null,this.messagesUnits=null,this.viewModel=new J,this.visibleElements=new q}initialize(){this.addHandles([I(()=>{var i,t;return(t=(i=this.view)==null?void 0:i.grid)==null?void 0:t.majorLineColor},i=>{!i||$.equals(i)||O.equals(i)||(this.customColor=i)},rt)])}loadDependencies(){return Promise.all([st({action:()=>f(()=>import("./index-DVEy4f7w.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24]),import.meta.url),"action-bar":()=>f(()=>import("./index-TFxiSNpz.js"),__vite__mapDeps([25,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,0,19,20,21,22,23,24,26,27,28,29,30,31,32,33,34,35,36,37,38]),import.meta.url),label:()=>f(()=>import("./index-D130RxMY.js"),__vite__mapDeps([39,2,3,4,5,6,7,8,9,10,11,12,13,40,17,14]),import.meta.url),icon:()=>f(()=>import("./index-73bQemcW.js").then(i=>i.i),__vite__mapDeps([16,2,3,4,5,6,7,8,9,10,11,12,13,17,14,18]),import.meta.url),popover:()=>f(()=>import("./index-DIp-v4qk.js").then(i=>i.i),__vite__mapDeps([26,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,0,19,20,21,22,23,24,27,28,29,30,31,32,33,34]),import.meta.url),tooltip:()=>f(()=>import("./index-DqW6JA5s.js"),__vite__mapDeps([41,2,3,4,5,6,7,8,9,10,11,12,13,21,20,27,17,14,28,29,31,19]),import.meta.url),"color-picker":()=>f(()=>import("./index-CG2ORNuo.js"),__vite__mapDeps([42,43,2,3,4,5,6,7,8,9,10,11,12,13,19,20,44,45,17,14,16,18,46,47,48,49,21,50,22,40,23,24,51,52,15,53,34,54,55,1,56,30,57,58,59,60,61,62,63,28]),import.meta.url),"input-number":()=>f(()=>import("./index-BGRynF8w.js"),__vite__mapDeps([53,16,2,3,4,5,6,7,8,9,10,11,12,13,17,14,18,46,47,49,20,19,21,50,22,34,40,23,54,24,51,52,15]),import.meta.url)}),lt()])}get icon(){return C.widgetIcon}set icon(i){this._overrideIfSome("icon",i)}get label(){return this.messages.widgetLabel}set label(i){this._overrideIfSome("label",i)}get snappingManager(){return this.viewModel.snappingManager}set snappingManager(i){this.viewModel.snappingManager=i}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(i){this.viewModel.snappingOptions=i}get theme(){var t;const i=(t=this.viewModel.grid)==null?void 0:t.majorLineColor;return i?$.equals(i)?"dark":O.equals(i)?"light":"custom":null}set theme(i){const{viewModel:t,customColor:e,view:r}=this;switch(i){case"light":t.gridColor=O;break;case"dark":t.gridColor=$;break;case"custom":t.gridColor=e??(r==null?void 0:r.effectiveTheme.accentColor)??$}}get view(){return this.viewModel.view}set view(i){this.viewModel.view=i}render(){return a("div",{"aria-label":this.label,class:this.classes(y.base,A.widget,A.panel)},a("div",{class:y.container},this._renderContent()))}_renderContent(){const{visibleElements:i}=this;return[i.gridEnabledToggle?this._renderEnabledToggle():null,i.placementButtons?this._renderGridPlacementButtons():null,i.numericInputs?this._renderNumericInputs():null,i.lineIntervalInput?this._renderIntervalInput():null,i.gridSnapEnabledToggle&&this.viewModel.snappingOptions?this._renderSnappingToggle():null,i.dynamicScaleToggle?this._renderDynamicScaleToggle():null,i.rotateWithMapToggle?this._renderRotateToggle():null,i.colorSelection?this._renderColorSelection():null]}_renderGridPlacementButtons(){const{interactivePlacementState:i,placementDisabled:t,gridControlsEnabled:e}=this.viewModel,r=t||!e;return a("calcite-label",{key:"grid-placement-buttons",scale:"s"},this.messages.placementOptions,a("calcite-action-bar",{expandDisabled:!0,layout:"horizontal"},Et.map(s=>this._renderPlacementModeButton(s,r,i))))}_renderPlacementModeButton(i,t,e){const r=this.messages.placementState[i],s=`__placement-action-${i}`;return a("div",null,a("calcite-action",{active:e===i,alignment:"center",disabled:t,icon:C.placementState[i],id:s,onclick:()=>this.viewModel.togglePlacementState(i),text:r}),a("calcite-tooltip",{overlayPositioning:"fixed",placement:"top",referenceElement:s},r))}_renderNumericInputs(){const{rotation:i,spacing:t,effectiveSpacingAfterDynamicScaling:e,numericSpacingInputShouldBeVisible:r,unit:s="meters"}=this.viewModel,l=this.messagesUnits.units[s].abbr,d=this.viewModel.gridControlsEnabled,c=e!=null&&e!==this.viewModel.spacing,b=`__spacing_input_scaled-${this.id}`;return a("div",{class:this.classes(y.numericInputsContainer)},[r?a("calcite-label",{key:"spacing-label",scale:"s"},a("span",null,this.messages.inputLabel.spacing,c?a("calcite-icon",{class:this.classes(y.inlineIcon),icon:C.warning,id:b,scale:"s",tabIndex:0}):void 0),a("div",{class:y.suffixedInputContainer},a("calcite-input-number",{disabled:!d,numberButtonType:"none",suffixText:l,value:`${t==null?void 0:t.toFixed(2)}`,onCalciteInputNumberChange:({currentTarget:m})=>{const w=parseFloat(m.value);this.viewModel.spacing=w,w!==this.viewModel.spacing&&(m.value=`${this.viewModel.spacing}`)}}),c?a("calcite-tooltip",{overlayPositioning:"fixed",placement:"leading",referenceElement:b},Tt(this.messages.warnings.dynamicSpacing,{actualSpacingIncludingUnit:ot(this.messagesUnits,e,s,2,"plural")})):void 0)):void 0,a("calcite-label",{key:"angle-label",scale:"s"},this.messages.inputLabel.angle,a("calcite-input-number",{disabled:!d,integer:!0,numberButtonType:"none",suffixText:this.messagesUnits.units.degrees.abbr,value:`${K(i)}`,onCalciteInputNumberChange:({currentTarget:m})=>this.viewModel.rotation=It(m.value)}))])}_renderIntervalInput(){const{majorLineInterval:i,gridControlsEnabled:t}=this.viewModel;return a("div",{class:this.classes(y.numericInputsContainer)},a("calcite-label",{scale:"s"},this.messages.inputLabel.interval,a("calcite-input-number",{disabled:!t,integer:!0,max:15,min:1,numberButtonType:"vertical",value:`${i}`,onCalciteInputNumberChange:({currentTarget:e})=>{const r=Number.parseInt(e.value,10);this.viewModel.majorLineInterval=r,r!==this.viewModel.majorLineInterval&&(e.value=`${this.viewModel.majorLineInterval}`)}})))}_renderSnappingToggle(){const{snappingOptions:i,gridControlsEnabled:t}=this.viewModel;return a(T,{checked:!!((i==null?void 0:i.gridEnabled)??!1),disabled:!(t&&i),key:"grid-snap-enabled-toggle",label:this.messages.switchLabel.snap,onChange:e=>{var r;return(r=this.viewModel.snappingOptions)==null?void 0:r.set("gridEnabled",e)}})}_renderDynamicScaleToggle(){const{viewModel:i,messages:t}=this,e=this.visibleElements.outOfScaleWarning&&i.gridOutOfScale;return a(T,{checked:i.dynamicScaling,disabled:!i.gridControlsEnabled,hint:e?t.warnings.outOfScale:void 0,hintIcon:C.warning,hintKind:"warning",key:`grid-dynamic-scale-toggle-${this.id}`,label:t.switchLabel.scaling,onChange:r=>i.dynamicScaling=r})}_renderRotateToggle(){const{gridControlsEnabled:i,rotateWithMap:t}=this.viewModel;return a(T,{checked:t,disabled:!i,key:"grid-rotate-map-toggle",label:this.messages.switchLabel.rotateWithMap,onChange:e=>this.viewModel.rotateWithMap=e})}_renderEnabledToggle(){return a("div",{class:y.borderedSwitch},a(T,{checked:this.viewModel.displayEnabled,disabled:!!this.viewModel.interactivePlacementState,key:"grid-enabled-toggle",label:this.messages.switchLabel.display,onChange:i=>this.viewModel.trySetDisplayEnabled(i)}))}_renderColorSelection(){const{customColor:i}=this,t=`${this.id}--custom-grid-color-button`;return a("calcite-label",{scale:"s"},this.messages.inputLabel.theme,a("div",{class:y.tilegroup},[this._renderThemeTile({value:"dark"}),this._renderThemeTile({value:"light"}),this._renderThemeTile({value:"custom",id:t}),a("calcite-popover",{autoClose:!0,label:this.messages.gridLineColorPopoverLabel,overlayPositioning:"fixed",referenceElement:t},a("calcite-color-picker",{alphaChannel:!0,savedDisabled:!0,value:(i==null?void 0:i.toHex({digits:8}))??"#000000ff",onCalciteColorPickerChange:e=>{const r=u.fromHex(e.currentTarget.value);r&&(this.customColor=r,this.theme="custom")}}))]))}_renderThemeTile(i){const{theme:t}=this,{value:e}=i,r=this.messages.gridTheme[e],s=`${this.id}--theme_tile_${e}`,l=`${s}__label`,d=C.gridTheme[e],c=this.viewModel.gridControlsEnabled;return a("div",{class:at({[y.tile]:!0,[y.tileDisabled]:!c}),id:i.id,role:"button"},a("input",{"aria-labelledby":l,checked:t===e,disabled:!c,id:s,name:`${this.id}--theme`,onchange:b=>{var m;this.theme=e,(m=b.target)==null||m.focus()},tabIndex:0,type:"radio"}),a("div",{class:y.tileContent},a("calcite-icon",{icon:d,scale:"l"}),a("calcite-label",{for:s,id:l},r)))}};o([n({type:u})],h.prototype,"customColor",void 0),o([n()],h.prototype,"icon",null),o([n()],h.prototype,"label",null),o([n(),V("esri/widgets/support/GridControls/t9n/GridControls")],h.prototype,"messages",void 0),o([n(),V("esri/core/t9n/Units")],h.prototype,"messagesUnits",void 0),o([n()],h.prototype,"snappingManager",null),o([n()],h.prototype,"snappingOptions",null),o([n()],h.prototype,"theme",null),o([n()],h.prototype,"view",null),o([n({type:J})],h.prototype,"viewModel",void 0),o([n({type:q,nonNullable:!0})],h.prototype,"visibleElements",void 0),h=o([P("esri.widgets.support.GridControls")],h);const jr=h;export{jr as default};
