const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./calcite-action-DqS7UojZ.js","./action-DJPgY7YC.js","./jsxFactory-CbAu6VfF.js","./Evented-CXIxDjmW.js","./Accessor-D6mNnsWy.js","./subclass-BR3PhgZG.js","./intl-Dpfm8vPB.js","./Promise-CZrWwByK.js","./jsonMap-DCC6W5ex.js","./assets-C2mb-ea2.js","./index-CeCSsEgo.js","./index-CjOb8WjV.css","./reactiveUtils-BFQ0BtrB.js","./shared-B3wH2qpO.js","./uuid-fwrPAdZb.js","./dom-Cv0oa6So.js","./interactive-Dtpmn6Ls.js","./loadable-CTFTnu2T.js","./locale-BUTTOPma.js","./key-D5DPfjW0.js","./observers-EizV_Lvc.js","./component-ByvC-PUv.js","./t9n-DfK3dFGw.js","./icon-DIKjN-ev.js","./loader-wfvKSvDR.js","./calcite-action-group-CkreNvSj.js","./action-group-CQvaBL2Q.js","./conditionalSlot-MT4PnZbw.js","./action-menu-CBohuqGX.js","./array-DofFqflK.js","./popover-Cj0_nbSv.js","./floating-ui-BiOoil4s.js","./debounce-C5YDvsuO.js","./focusTrapComponent-C9GPb5g8.js","./openCloseComponent-v_dlVp47.js","./Heading-Dn_ijr3J.js","./FloatingArrow-HmzV7w9c.js","./calcite-action-menu-DvA8-r5o.js","./calcite-block-MHbn6ZJN.js","./handle-C2OyFwdr.js","./scrim-tJUFlVOZ.js","./calcite-label-CI84R5fD.js","./label-rdYpV4K5.js","./calcite-input-EEDQOvVg.js","./input2-ChLBQj0V.js","./form-DcBTx4ZC.js","./Validation-BBJwLSGg.js","./input-Dt5r39B0.js","./input-message-CKyGNFPw.js","./progress-B-8bmD6j.js","./calcite-button-D_QRw8fR.js","./button-CT5wDIjk.js","./calcite-flow-CrhM5qTo.js","./calcite-flow-item-M0Vz-xgS.js","./panel-B3delCVt.js","./calcite-icon-CocWVhPd.js","./calcite-list-C9DJsIWv.js","./resources4-CT6dxwoZ.js","./utils3-Dl40LrI3.js","./filter-BHzLPuAd.js","./calcite-list-item-D17u9P-_.js","./calcite-notice-DAIcfVw0.js","./calcite-tooltip-HeRO_zdX.js","./CatalogLayerList-8V4SsEmK.js","./Identifiable-BLvpQbOc.js","./ReactiveMap-Dl_3-Rm5.js","./catalogUtils--o1nDhfl.js","./actionUtils-ybdhNUfW.js","./substitute-JuF-yP_g.js","./ListItem-B3QFVwaH.js","./ActionToggle-C0Z1k2jc.js","./layerListUtils-CMiJTmu0.js","./widget-AQdZwE2X.js","./globalCss-CZa70j6i.js","./vmEvent-D4Ubqkbq.js"])))=>i.map(i=>d[i]);
import{_ as f}from"./index-CeCSsEgo.js";import{o as ee,e as a}from"./Evented-CXIxDjmW.js";import{V as Y,d as M,P as N}from"./reactiveUtils-BFQ0BtrB.js";import{S as te,O}from"./Accessor-D6mNnsWy.js";import{s as ie}from"./Identifiable-BLvpQbOc.js";import{y as o,b as q,n as V}from"./subclass-BR3PhgZG.js";import{t as K,n as se}from"./actionUtils-ybdhNUfW.js";import{B as ae,r as le,n as r,e as Q}from"./jsxFactory-CbAu6VfF.js";import{I as z}from"./ListItem-B3QFVwaH.js";import{f as W,u as oe,n as ne,x as F,M as X,r as re,d as ce,y as de,m as me,l as pe,b as he,t as ue}from"./layerListUtils-CMiJTmu0.js";import{e as H}from"./globalCss-CZa70j6i.js";import{n as ge}from"./Heading-ynVMbJ8d.js";import{e as _e}from"./vmEvent-D4Ubqkbq.js";import"./shared-B3wH2qpO.js";import"./intl-Dpfm8vPB.js";import"./Promise-CZrWwByK.js";import"./jsonMap-DCC6W5ex.js";import"./assets-C2mb-ea2.js";import"./substitute-JuF-yP_g.js";import"./uuid-fwrPAdZb.js";import"./ActionToggle-C0Z1k2jc.js";import"./widget-AQdZwE2X.js";import"./mathUtils-ClvKsMak.js";const v={view:"view",basemap:"basemap",baseLayers:"base-layers",referenceLayers:"reference-layers",baseLayersListMode:"reference-layers-list-mode",referenceLayersListMode:"base-layers-list-mode",baseLayerViews:"base-layer-views",referenceLayerViews:"reference-layer-views",children:"children"},ye="hide",U=Y.ofType(z);let w=class extends ee.EventedAccessor{constructor(e){super(e),this.baseItems=new U,this.baseListItemCreatedFunction=null,this.checkPublishStatusEnabled=!1,this.listModeDisabled=!1,this.referenceListItemCreatedFunction=null,this.referenceItems=new U,this.view=null,this._compileBaseList=this._compileBaseList.bind(this),this._compileReferenceList=this._compileReferenceList.bind(this)}initialize(){this.addHandles([M(()=>{var e,t,i,s;return[(t=(e=this.view)==null?void 0:e.map)==null?void 0:t.basemap,((i=this.view)==null?void 0:i.ready)===!0,(s=this.view)==null?void 0:s.basemapView]},()=>this._watchBasemapLayers(),N),M(()=>[this.baseListItemCreatedFunction,this.checkPublishStatusEnabled,this.listModeDisabled],()=>this._baseListItemCreatedFunctionChanged()),M(()=>[this.referenceListItemCreatedFunction,this.checkPublishStatusEnabled,this.listModeDisabled],()=>this._referenceListItemCreatedFunctionChanged())],v.view)}destroy(){this.view=null,this._removeAllBaseItems(),this._removeAllReferenceItems()}get basemapTitle(){var e,t,i;return((i=(t=(e=this.view)==null?void 0:e.map)==null?void 0:t.basemap)==null?void 0:i.title)??null}set basemapTitle(e){this._override("basemapTitle",e)}get state(){var e;return(e=this.view)!=null&&e.ready?"ready":this.view?"loading":"disabled"}get totalBaseItems(){return this.baseItems.flatten(e=>e.children).length}get totalReferenceItems(){return this.referenceItems.flatten(e=>e.children).length}triggerAction(e,t){e&&!e.disabled&&this.emit("trigger-action",{action:e,item:t})}moveListItem({targetItem:e,fromParentItem:t,toParentItem:i,from:s,to:l,newIndex:n}){var S,R;const m=e==null?void 0:e.layer;if(!m||m.type==="subtype-sublayer"||m.type==="sublayer")return;const c=(R=(S=this.view)==null?void 0:S.map)==null?void 0:R.basemap,p=c==null?void 0:c.baseLayers,b=c==null?void 0:c.referenceLayers,_=t?W(t):s==="base"?p:b,h=i?W(i):l==="base"?p:b;if(!_||!h)return;const{baseItems:y,referenceItems:L}=this,u=s==="base"?y:L,C=l==="base"?y:L,P=(t==null?void 0:t.children)||u,k=(i==null?void 0:i.children)||C,B=h.length-n;e.parent=i||null,P.remove(e),_.remove(m),k.includes(e)||k.add(e,B),h.includes(m)||h.add(m,B),this._compileLists()}_createItemChangeHandles({items:e,key:t,callback:i}){this.removeHandles(t),i(),e&&this.addHandles(e.on("change",()=>i()),t)}_createListItem({layer:e,type:t}){const{view:i,baseListItemCreatedFunction:s,referenceListItemCreatedFunction:l,checkPublishStatusEnabled:n,listModeDisabled:m}=this;return new z({layer:e,checkPublishStatusEnabled:n,listItemCreatedFunction:t==="base"?s:l,listModeDisabled:m,view:i})}_watchLayersListMode({layers:e,key:t,callback:i}){this.removeHandles(t),e&&!this.listModeDisabled&&this.addHandles(M(()=>e.filter(s=>"listMode"in s).map(s=>s.listMode).toArray(),()=>i()),t)}_getViewableLayers(e){return e?this.listModeDisabled?e:e.filter(t=>oe(t)!==ye):void 0}_compileListItems({layers:e,items:t,key:i,type:s,callback:l}){this._watchLayersListMode({layers:e,key:i,callback:l});const n=this._getViewableLayers(e);n!=null&&n.length?(this._createNewItems({type:s,items:t,layers:n}),this._removeItems({items:t,layers:n}),this._sortItems(t,n)):s==="base"?this._removeAllBaseItems():this._removeAllReferenceItems()}_compileReferenceList(){var i,s,l;const{referenceItems:e}=this,t=(l=(s=(i=this.view)==null?void 0:i.map)==null?void 0:s.basemap)==null?void 0:l.referenceLayers;this._compileListItems({type:"reference",layers:t,items:e,key:v.referenceLayersListMode,callback:this._compileReferenceList})}_compileBaseList(){var i,s,l;const{baseItems:e}=this,t=(l=(s=(i=this.view)==null?void 0:i.map)==null?void 0:s.basemap)==null?void 0:l.baseLayers;this._compileListItems({type:"base",layers:t,items:e,key:v.baseLayersListMode,callback:this._compileBaseList})}_compileLists(){this._compileReferenceList(),this._compileBaseList()}_createNewItems({items:e,layers:t,type:i}){t==null||t.forEach(s=>{e.some(l=>l.layer===s)||e.add(this._createListItem({type:i,layer:s}))})}_removeItems({items:e,layers:t}){e&&e.forEach(i=>{if(!i)return;(t==null?void 0:t.some(l=>i.layer===l))||(this.removeHandles(`${v.children}-${i.uid}`),e.remove(i),i.destroy())})}_sortItems(e,t){e&&t&&e.sort((i,s)=>{const l=t.indexOf(i.layer),n=t.indexOf(s.layer);return l>n?-1:l<n?1:0})}_removeAllBaseItems(){this.baseItems.drain(e=>{this.removeHandles(`${v.children}-${e.uid}`),e.destroy()})}_removeAllReferenceItems(){this.referenceItems.drain(e=>{this.removeHandles(`${v.children}-${e.uid}`),e.destroy()})}_baseListItemCreatedFunctionChanged(){this._removeAllBaseItems(),this._compileLists()}_referenceListItemCreatedFunctionChanged(){this._removeAllReferenceItems(),this._compileLists()}_watchBasemapLayers(){const{view:e}=this;if(this.removeHandles([v.baseLayers,v.referenceLayers,v.basemap,v.baseLayerViews,v.referenceLayerViews]),!(e!=null&&e.ready))return this._removeAllBaseItems(),void this._removeAllReferenceItems();this._compileLists(),this.addHandles([M(()=>{var t,i,s;return(s=(i=(t=this.view)==null?void 0:t.map)==null?void 0:i.basemap)==null?void 0:s.baseLayers},t=>this._createItemChangeHandles({items:t,key:v.baseLayers,callback:this._compileBaseList}),N),M(()=>{var t,i,s;return(s=(i=(t=this.view)==null?void 0:t.map)==null?void 0:i.basemap)==null?void 0:s.referenceLayers},t=>this._createItemChangeHandles({items:t,key:v.referenceLayers,callback:this._compileReferenceList}),N),M(()=>{var t,i;return(i=(t=this.view)==null?void 0:t.basemapView)==null?void 0:i.baseLayerViews},t=>this._createItemChangeHandles({items:t,key:v.baseLayerViews,callback:this._compileBaseList}),N),M(()=>{var t,i;return(i=(t=this.view)==null?void 0:t.basemapView)==null?void 0:i.referenceLayerViews},t=>this._createItemChangeHandles({items:t,key:v.referenceLayerViews,callback:this._compileReferenceList}),N)],v.basemap)}};a([o({type:U,readOnly:!0})],w.prototype,"baseItems",void 0),a([o()],w.prototype,"basemapTitle",null),a([o()],w.prototype,"baseListItemCreatedFunction",void 0),a([o()],w.prototype,"checkPublishStatusEnabled",void 0),a([o({nonNullable:!0})],w.prototype,"listModeDisabled",void 0),a([o()],w.prototype,"referenceListItemCreatedFunction",void 0),a([o({type:U,readOnly:!0})],w.prototype,"referenceItems",void 0),a([o({readOnly:!0})],w.prototype,"state",null),a([o()],w.prototype,"totalBaseItems",null),a([o()],w.prototype,"totalReferenceItems",null),a([o()],w.prototype,"view",void 0),w=a([q("esri.widgets.BasemapLayerList.BasemapLayerListViewModel")],w);const Z=w;let I=class extends te{constructor(){super(...arguments),this.baseLayers=!0,this.catalogLayerList=!0,this.closeButton=!1,this.collapseButton=!1,this.editTitleButton=!1,this.errors=!1,this.filter=!1,this.flow=!0,this.heading=!0,this.referenceLayers=!0,this.statusIndicators=!0,this.temporaryLayerIndicators=!1}};a([o({type:Boolean,nonNullable:!0})],I.prototype,"baseLayers",void 0),a([o({type:Boolean,nonNullable:!0})],I.prototype,"catalogLayerList",void 0),a([o({type:Boolean,nonNullable:!0})],I.prototype,"closeButton",void 0),a([o({type:Boolean,nonNullable:!0})],I.prototype,"collapseButton",void 0),a([o({type:Boolean,nonNullable:!0})],I.prototype,"editTitleButton",void 0),a([o({type:Boolean,nonNullable:!0})],I.prototype,"errors",void 0),a([o({type:Boolean,nonNullable:!0})],I.prototype,"filter",void 0),a([o({type:Boolean,nonNullable:!0})],I.prototype,"flow",void 0),a([o({type:Boolean,nonNullable:!0})],I.prototype,"heading",void 0),a([o({type:Boolean,nonNullable:!0})],I.prototype,"referenceLayers",void 0),a([o({type:Boolean,nonNullable:!0})],I.prototype,"statusIndicators",void 0),a([o({type:Boolean,nonNullable:!0})],I.prototype,"temporaryLayerIndicators",void 0),I=a([q("esri.widgets.BasemapLayerList.BasemapLayerListVisibleElements")],I);const G=I,E="esri-basemap-layer-list",T=`${E}__item`,g={base:E,actionMenu:`${E}__action-menu`,actionGroup:`${E}__action-group`,filterNoResults:`${E}__filter-no-results`,item:T,itemActive:`${T}--active`,itemContent:`${T}-content`,itemContentBottom:`${T}-content-bottom`,itemMessage:`${T}-message`,itemInvisible:`${T}--invisible`,itemActionIcon:`${T}-action-icon`,itemActionImage:`${T}-action-image`,itemTemporaryIcon:`${T}-temporary-icon`,itemCatalogIcon:`${T}-catalog-icon`,statusIndicator:`${E}__status-indicator`,publishing:`${E}__publishing`,updating:`${E}__updating`,editing:`${E}__editing`,connectionStatus:`${E}__connection-status`,connectionStatusConnected:`${E}__connection-status--connected`,visibleToggle:`${E}__visible-toggle`,visibleIcon:`${E}__visible-icon`,section:`${E}__section`},be=Y.ofType(z),ve=".*\\S+.*";let d=class extends ie(ae){constructor(e,t){super(e,t),this._activeItem=null,this._tooltipReferenceMap=new Map,this._editTitleInput=null,this._focusRootFlowItem=!1,this._focusPanelFlowItem=!1,this._focusEditingFlowItem=!1,this._focusCatalogFlowItem=!1,this._lastDragDetail=null,this._selectedDragItemLayerUid=null,this._rootGroupUid=`basemap-${this.uid}`,this.catalogLayerList=null,this.catalogOptions=null,this.collapsed=!1,this.dragEnabled=!1,this.editingTitle=!1,this.filterPlaceholder="",this.baseFilterText="",this.referenceFilterText="",this.listItemCanGiveFunction=null,this.listItemCanReceiveFunction=null,this.headingLevel=2,this.messages=null,this.messagesCommon=null,this.minFilterItems=ne,this.openCatalogItem=null,this.selectedItems=new be,this.selectionMode="none",this.viewModel=new Z,this.visibilityAppearance="default",this.visibleElements=new G,this._canMove=({dragEl:i,fromEl:s,toEl:l},n)=>{var R,D,x;const m=n==="pull"?this.listItemCanGiveFunction:this.listItemCanReceiveFunction,c=F(i);if(!(c!=null&&c.sortable))return!1;const p=F(s),b=X(s),_=F(l),h=X(l),y=!!b&&!!h&&b===h,L={selected:c,from:p,to:_},u=s.group,C=l.group,P=((R=p==null?void 0:p.layer)==null?void 0:R.type)??"",k=((D=_==null?void 0:_.layer)==null?void 0:D.type)??"",B=new Set(["map-image","catalog","knowledge-graph"]);return u&&C&&typeof m=="function"?m.call(null,L):y&&!B.has(P)&&!B.has(k)&&((x=c==null?void 0:c.layer)==null?void 0:x.type)!=="sublayer"},this._clearActiveItem=()=>{this._activeItem=null},this._setActiveItem=i=>{if(this.visibilityAppearance!=="default")return;const s=Array.from(i.composedPath()).find(l=>{var n;return(n=l.classList)==null?void 0:n.contains(g.item)});this._activeItem=F(s)},this._onCalciteListOrderChange=i=>{const{_lastDragDetail:s}=this,{toEl:l,fromEl:n,dragEl:m,newIndex:c}=i;if(!n||!l||(s==null?void 0:s.newIndex)===c&&(s==null?void 0:s.dragEl)===m&&(s==null?void 0:s.toEl)===l&&(s==null?void 0:s.fromEl)===n)return;this._lastDragDetail=i;const p=n,b=l;if(p!==b)this._moveLayerFromChildList({toEl:b,fromEl:p,dragEl:m,newIndex:c});else{const _=Array.from(n.children).filter(h=>h==null?void 0:h.matches("calcite-list-item")).map(h=>h.value);this._sortLayers(p,_)}}}initialize(){this.addHandles([M(()=>this.openCatalogItem,e=>e?this._createCatalog():this._destroyCatalog())])}normalizeCtorArgs(e){return(e==null?void 0:e.editingEnabled)!=null&&e.visibleElements!=null?{...e,visibleElements:new G({...e.visibleElements,editTitleButton:e.editingEnabled})}:e}loadDependencies(){return le({action:()=>f(()=>import("./calcite-action-DqS7UojZ.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24]),import.meta.url),"action-group":()=>f(()=>import("./calcite-action-group-CkreNvSj.js"),__vite__mapDeps([25,26,2,3,4,5,6,7,8,9,10,11,12,13,14,27,20,17,18,15,19,22,28,29,1,16,21,23,24,30,31,32,33,34,35,36]),import.meta.url),"action-menu":()=>f(()=>import("./calcite-action-menu-DvA8-r5o.js"),__vite__mapDeps([37,28,2,3,4,5,6,7,8,9,10,11,12,13,14,29,15,19,17,1,16,18,20,21,22,23,24,30,31,32,33,34,35,36]),import.meta.url),block:()=>f(()=>import("./calcite-block-MHbn6ZJN.js"),__vite__mapDeps([38,2,3,4,5,6,7,8,9,10,11,12,13,14,27,20,15,16,18,19,22,35,17,34,1,21,23,24,28,29,30,31,32,33,36,39,40]),import.meta.url),label:()=>f(()=>import("./calcite-label-CI84R5fD.js"),__vite__mapDeps([41,2,3,4,5,6,7,8,9,10,11,12,13,14,42,15,21]),import.meta.url),input:()=>f(()=>import("./calcite-input-EEDQOvVg.js"),__vite__mapDeps([43,44,2,3,4,5,6,7,8,9,10,11,12,13,14,15,45,16,19,42,21,17,18,20,22,46,47,23,48,49]),import.meta.url),button:()=>f(()=>import("./calcite-button-D_QRw8fR.js"),__vite__mapDeps([50,51,2,3,4,5,6,7,8,9,10,11,12,13,14,45,15,16,42,21,17,18,19,20,22,23,24]),import.meta.url),flow:()=>f(()=>import("./calcite-flow-CrhM5qTo.js"),__vite__mapDeps([52,2,3,4,5,6,7,8,9,10,11,12,13,14,20,17]),import.meta.url),"flow-item":()=>f(()=>import("./calcite-flow-item-M0Vz-xgS.js"),__vite__mapDeps([53,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,22,54,28,29,1,21,23,24,30,31,32,33,34,35,36,40]),import.meta.url),icon:()=>f(()=>import("./calcite-icon-CocWVhPd.js"),__vite__mapDeps([55,23,2,3,4,5,6,7,8,9,10,11,12,13,14,15,20]),import.meta.url),list:()=>f(()=>import("./calcite-list-C9DJsIWv.js"),__vite__mapDeps([56,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,20,57,58,17,22,18,19,59,32,23,44,45,42,21,46,47,48,49,24,40]),import.meta.url),"list-item":()=>f(()=>import("./calcite-list-item-D17u9P-_.js"),__vite__mapDeps([60,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,22,17,58,57,1,21,23,24,39]),import.meta.url),notice:()=>f(()=>import("./calcite-notice-DAIcfVw0.js"),__vite__mapDeps([61,2,3,4,5,6,7,8,9,10,11,12,13,14,27,20,15,17,18,19,22,34,21,23]),import.meta.url),tooltip:()=>f(()=>import("./calcite-tooltip-HeRO_zdX.js"),__vite__mapDeps([62,2,3,4,5,6,7,8,9,10,11,12,13,14,15,31,32,34,36]),import.meta.url)})}destroy(){this._tooltipReferenceMap.clear()}get _totalBaseItems(){return this.viewModel.baseItems.flatten(e=>e.children.filter(t=>t.layer.type!=="catalog-dynamic-group")).length}get _totalReferenceItems(){return this.viewModel.referenceItems.flatten(e=>e.children.filter(t=>t.layer.type!=="catalog-dynamic-group")).length}get _baseFilterEnabled(){return this._totalBaseItems>=this.minFilterItems&&this.visibleElements.filter}get _referenceFilterEnabled(){return this._totalReferenceItems>=this.minFilterItems&&this.visibleElements.filter}get basemapTitle(){return this.viewModel.basemapTitle}set basemapTitle(e){this.viewModel.basemapTitle=e}get baseListItemCreatedFunction(){return this.viewModel.baseListItemCreatedFunction}set baseListItemCreatedFunction(e){this.viewModel.baseListItemCreatedFunction=e}get editingEnabled(){return O(V.getLogger(this),"editingEnabled",{replacement:"selectionMode, dragEnabled, visibleElements.editTitleButton",version:"4.29",warnOnce:!0}),this.selectionMode!=="none"&&this.dragEnabled&&this.visibleElements.editTitleButton}set editingEnabled(e){O(V.getLogger(this),"editingEnabled",{replacement:"selectionMode, dragEnabled, visibleElements.editTitleButton",version:"4.29",warnOnce:!0}),this.dragEnabled=e,this.visibleElements.editTitleButton=e,this.selectionMode=e?this.multipleSelectionEnabled?"multiple":"single":"none"}get icon(){return"layers"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get multipleSelectionEnabled(){return O(V.getLogger(this),"multipleSelectionEnabled",{replacement:"selectionMode",version:"4.29",warnOnce:!0}),this.selectionMode==="multiple"}set multipleSelectionEnabled(e){O(V.getLogger(this),"multipleSelectionEnabled",{replacement:"selectionMode",version:"4.29",warnOnce:!0}),this.selectionMode=e?"multiple":this.editingEnabled?"single":"none"}get referenceListItemCreatedFunction(){return this.viewModel.referenceListItemCreatedFunction}set referenceListItemCreatedFunction(e){this.viewModel.referenceListItemCreatedFunction=e}get baseItems(){return this.viewModel.baseItems}get referenceItems(){return this.viewModel.referenceItems}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}triggerAction(e,t){return this.viewModel.triggerAction(e,t)}render(){const{state:e}=this.viewModel,t={[H.hidden]:e==="loading",[H.disabled]:e==="disabled"};return r("div",{class:this.classes(g.base,H.widget,H.panel,t)},this._renderItems())}_renderItemTooltip(e){return e?r("calcite-tooltip",{key:`tooltip-${e.layer.uid}`,referenceElement:this._tooltipReferenceMap.get(e.layer.uid)},this.messages.layerIncompatibleTooltip):null}_renderItemTooltipNodes(e){var t;return e.incompatible?this._renderItemTooltip(e):(t=e.children)==null?void 0:t.filter(i=>!i.hidden).toArray().map(i=>this._renderItemTooltipNodes(i))}_renderItemTooltips(e){return e==null?void 0:e.toArray().map(t=>this._renderItemTooltipNodes(t))}async _createCatalog(){var u;this._destroyCatalog();const{default:e}=await f(()=>import("./CatalogLayerList-8V4SsEmK.js"),__vite__mapDeps([63,10,11,3,4,5,12,13,64,65,66,67,6,7,8,9,68,2,14,69,70,71,72,73,74]),import.meta.url),{headingLevel:t,catalogOptions:i,view:s,filterPlaceholder:l,baseListItemCreatedFunction:n,referenceListItemCreatedFunction:m,minFilterItems:c,selectionMode:p,visibilityAppearance:b,openCatalogItem:_,referenceItems:h}=this,y=_&&h.flatten(C=>C.children).includes(_)?"reference":"base",L=(u=this.openCatalogItem)==null?void 0:u.layer;this._set("catalogLayerList",new e({headingLevel:t,view:s,filterPlaceholder:l,minFilterItems:c,selectionMode:p,listItemCreatedFunction:y==="base"?n:m,visibilityAppearance:b,...i,catalogLayer:L}))}_destroyCatalog(){var e;(e=this.catalogLayerList)==null||e.destroy(),this._set("catalogLayerList",null)}_renderCatalogFlowItem(){var s;const{openCatalogItem:e,messages:t}=this;if(!e)return null;const i=this._getLayerTitle(e);return r("calcite-flow-item",{afterCreate:this._focusCatalogFlowItemNode,afterUpdate:this._focusCatalogFlowItemNode,bind:this,description:i,heading:t.catalogLayers,headingLevel:this.headingLevel,key:`flow-catalog-${e.uid}`,onCalciteFlowItemBack:l=>{l.preventDefault(),this.openCatalogItem=null,this._focusRootFlowItem=!0}},(s=this.catalogLayerList)==null?void 0:s.render())}_focusCatalogFlowItemNode(e){this._focusCatalogFlowItem&&(this._focusCatalogFlowItem=!1,requestAnimationFrame(()=>e==null?void 0:e.setFocus()))}_renderPanelFlowItems(e){return e?e.flatten(t=>t.children).filter(({hidden:t,panel:i})=>!t&&(i==null?void 0:i.open)&&!i.disabled&&i.flowEnabled).toArray().map(({title:t,panel:i})=>{const s=()=>this._handlePanelFlowItemBack(i);return r("calcite-flow-item",{afterCreate:this._focusPanelFlowItemNode,afterUpdate:this._focusPanelFlowItemNode,bind:this,description:t,heading:i.title,headingLevel:this.headingLevel,key:`flow-panel-${i.uid}`,onCalciteFlowItemBack:l=>{l.preventDefault(),s()}},i.render(),r("calcite-button",{appearance:"transparent",onclick:s,slot:"footer-actions",width:"full"},this.messagesCommon.back))}):[]}_handlePanelFlowItemBack(e){e.open=!1,this._focusRootFlowItem=!0}_focusEditingFlowItemNode(e){this._focusEditingFlowItem&&(this._focusEditingFlowItem=!1,requestAnimationFrame(()=>e==null?void 0:e.setFocus()))}_focusRootFlowItemNode(e){this._focusRootFlowItem&&(this._focusRootFlowItem=!1,requestAnimationFrame(()=>e==null?void 0:e.setFocus()))}_focusPanelFlowItemNode(e){this._focusPanelFlowItem&&(this._focusPanelFlowItem=!1,requestAnimationFrame(()=>e==null?void 0:e.setFocus()))}_renderItemMessage(e){return e.error?r("div",{class:g.itemMessage,key:"esri-layer-list__error",slot:"content-bottom"},r("calcite-notice",{icon:"exclamation-mark-triangle",kind:"warning",open:!0,scale:"s",width:"full"},r("div",{slot:"message"},this.messages.layerError))):e.incompatible?r("div",{class:g.itemMessage,key:"esri-layer-list__incompatible",slot:"content-bottom"},r("calcite-notice",{afterCreate:t=>this._setTooltipReference(t,e),afterRemoved:()=>this._removeTooltipReference(e),icon:"exclamation-mark-triangle",kind:"warning",open:!0,scale:"s",tabIndex:0,width:"full"},r("div",{slot:"message"},this.messages.layerIncompatible))):null}_getLayerTitle(e){return e.title||this.messages.untitledLayer}_renderItem(e,t,i,s,l){var D,x,j,J;const{_activeItem:n,_selectedDragItemLayerUid:m,selectionMode:c,selectedItems:p,messages:b,visibleElements:_}=this,h=this._getLayerTitle(e),y=e.visibleAtCurrentTimeExtent?e.visibleAtCurrentScale?h:`${h} (${b.layerInvisibleAtScale})`:`${h} (${b.layerInvisibleAtTime})`,L=this._filterActions(e.actionsSections),u=this._countActions(L),C=((x=(D=e.parent)==null?void 0:D.layer)==null?void 0:x.type)==="catalog",P=((j=e.layer)==null?void 0:j.type)==="catalog-footprint",k=((J=e.layer)==null?void 0:J.type)==="catalog-dynamic-group",B=P?r("calcite-icon",{class:g.itemCatalogIcon,icon:"footprint",key:"footprint",scale:"s",slot:"content-start"}):null,S=_.catalogLayerList&&k?r("calcite-icon",{class:g.itemCatalogIcon,icon:"catalog-dataset",key:"catalog-dataset",scale:"s",slot:"content-start"}):null,R=k?r("calcite-action",{appearance:"transparent",icon:"chevron-right",iconFlipRtl:!0,onclick:()=>{this.openCatalogItem=s,this._focusCatalogFlowItem=!0},scale:"s",slot:"actions-end",text:h}):null;return r("calcite-list-item",{afterCreate:A=>this._focusSelectedDragEl(A,e),afterUpdate:A=>this._focusSelectedDragEl(A,e),class:this.classes(g.item,{[g.itemActive]:n===e}),"data-item":e,"data-layer-id":e.layer.id,dragDisabled:!e.sortable||i||C,dragSelected:e.layer.uid===m,id:e.layer.uid,key:`list-item-${e.layer.uid}`,label:h,metadata:{parentTitles:l,title:h},open:e.open,selected:c!=="none"&&p.includes(e),title:y,value:e.layer.uid,onCalciteListItemDragHandleChange:A=>this._handleCalciteListItemDragHandleChange(A,e),onCalciteListItemSelect:A=>this._handleCalciteListItemSelect(A,e,s),onCalciteListItemToggle:A=>this._handleCalciteListItemToggle(A,e)},B,S,r("div",{class:this.classes({[g.itemContent]:!0,[g.itemInvisible]:!e.visibleAtCurrentScale||!e.visibleAtCurrentTimeExtent}),slot:"content"},h),this._renderItemStatus(e,s),this._renderItemToggle(e,s),R,this._renderItemTemporaryIcon(e),this._renderChildList(e,t,l),this._renderItemMessage(e),this._renderPanel(e.panel),this._renderPanelAction(e.panel),u>1?this._renderActionsSections(e,L):u===1?this._renderAction({item:e,action:this._getSingleAction(L),textEnabled:!1}):null)}_renderItemStatus(e,t){const{visibleElements:i}=this;if(!i.statusIndicators)return null;const{connectionStatus:s,publishing:l,updating:n}=e,m=n&&!t,c=!!s;return r("calcite-icon",{class:this.classes({[g.statusIndicator]:!0,[g.publishing]:l,[g.updating]:m,[g.connectionStatus]:c,[g.connectionStatusConnected]:c&&s==="connected"}),icon:re({connectionStatus:s,publishing:l}),key:"layer-item-status",scale:"s",slot:"actions-end"})}_renderItemTemporaryIcon(e){return this.visibleElements.temporaryLayerIndicators&&"persistenceEnabled"in e.layer&&!e.layer.persistenceEnabled?r("calcite-icon",{class:g.itemTemporaryIcon,icon:"temporary",key:"temporary-icon",scale:"s",slot:"actions-start",title:this.messages.temporary}):null}_renderItemToggle(e,t){const{messages:i,visibilityAppearance:s}=this,{visible:l}=e,n=t==null?void 0:t.visibilityMode;if(n==="inherited")return null;const m=ue({visible:l,exclusive:n==="exclusive",visibilityAppearance:s}),c=s==="checkbox",p=i.layerVisibility;return r("calcite-action",{appearance:"transparent",class:g.visibleToggle,icon:c?m:void 0,key:"visibility-toggle",onclick:()=>this._toggleVisibility(e,t),scale:"s",slot:c?"actions-start":"actions-end",text:p,title:p},c?null:r("calcite-icon",{class:this.classes({[g.visibleIcon]:n!=="exclusive"&&l}),icon:m,scale:"s"}))}_renderPanel(e){return!(e!=null&&e.open)||e.disabled||e.flowEnabled?null:r("div",{class:g.itemContentBottom,key:`content-panel-${e.uid}`,slot:"content-bottom"},e.render())}_renderPanelAction(e){if(!(e!=null&&e.visible))return null;const{open:t,title:i,disabled:s}=e;return r("calcite-action",{active:t,appearance:"transparent",disabled:s,icon:K(e),key:`action-${e.uid}`,onclick:()=>this._togglePanel(e),scale:"s",slot:"actions-end",text:i??"",title:i??void 0},this._renderFallbackIcon(e))}_renderActionsSections(e,t){const i=this.messagesCommon.options;return r("calcite-action-menu",{appearance:"transparent",class:g.actionMenu,key:"item-action-menu",label:this.messagesCommon.menu,open:e.actionsOpen,overlayPositioning:"fixed",placement:"bottom-end",scale:"s",slot:"actions-end",onCalciteActionMenuOpen:s=>e.actionsOpen=s.target.open},r("calcite-action",{appearance:"transparent",icon:"ellipsis",scale:"s",slot:"trigger",text:i,title:i}),t.toArray().map((s,l)=>this._renderActionSection(e,s,l)))}_renderActionSection(e,t,i){return r("calcite-action-group",{class:g.actionGroup,key:`action-section-${i}`},t.toArray().map(s=>this._renderAction({item:e,action:s,textEnabled:!0})))}_renderFallbackIcon(e){const{className:t,icon:i}=e;if(i)return null;const s="image"in e?e.image:void 0,l={[g.itemActionIcon]:!!t,[g.itemActionImage]:!!s};return t&&(l[t]=!0),s||t?r("span",{"aria-hidden":"true",class:this.classes(g.itemActionIcon,l),key:"icon",styles:se(s)}):null}_renderAction(e){const{item:t,action:i,textEnabled:s}=e;if(!i)return null;const{active:l,disabled:n,title:m,type:c,indicator:p}=i;return r("calcite-action",{active:c==="toggle"&&i.value,appearance:"transparent",disabled:n,icon:K(i),indicator:p,key:`action-${i.uid}`,loading:l,onclick:()=>this._triggerAction(t,i),scale:"s",slot:s?void 0:"actions-end",text:m??"",textEnabled:s,title:m??void 0},this._renderFallbackIcon(i))}_setTooltipReference(e,t){this._tooltipReferenceMap.set(t.layer.uid,e)}_removeTooltipReference(e){this._tooltipReferenceMap.delete(e.layer.uid)}_moveLayerFromChildList({toEl:e,fromEl:t,dragEl:i,newIndex:s}){const l=F(i),n=F(e),m=F(t),c=$(t),p=$(e);c&&p&&this.viewModel.moveListItem({targetItem:l,fromParentItem:m,toParentItem:n,newIndex:s,from:c,to:p})}_handleCalciteListDragEnd(e){const{fromEl:t,dragEl:i,oldIndex:s}=e;t.insertBefore(i,t.children[s])}_sortLayers(e,t){var i,s,l,n,m,c;if(e)if(e.group===this._rootGroupUid){const p=$(e),b=p==="base"?(l=(s=(i=this.view)==null?void 0:i.map)==null?void 0:s.basemap)==null?void 0:l.baseLayers:p==="reference"?(c=(m=(n=this.view)==null?void 0:n.map)==null?void 0:m.basemap)==null?void 0:c.referenceLayers:null;ce(b,t)}else{const p=F(e);if(!p)return;de(p,t)}}_getSingleAction(e){return e.reduce(t=>t).find(t=>t&&(t.type==="button"||t.type==="toggle"))}_filterActions(e){return e.map(t=>t.filter(i=>i.visible))}_countActions(e){return e.reduce((t,i)=>t+i.length,0)}_triggerAction(e,t){t&&e&&(t.type==="toggle"&&(t.value=!t.value),this.triggerAction(t,e))}_handleCalciteListChange(e){const{selectionMode:t,selectedItems:i}=this;if(t==="none")return;const s=e.target.selectedItems.map(l=>F(l)).filter(Boolean);i.removeAll(),i.addMany(s)}_handleCalciteListItemToggle(e,t){e.stopPropagation(),t.open=e.target.open}_focusSelectedDragEl(e,t){this._selectedDragItemLayerUid===t.layer.uid&&requestAnimationFrame(()=>e==null?void 0:e.setFocus())}_handleCalciteListItemDragHandleChange(e,t){e.stopPropagation();const i=e.target.dragSelected;this._selectedDragItemLayerUid=i?t.layer.uid:null}_handleCalciteListItemSelect(e,t,i){F(e.target)===t&&this.selectionMode==="none"&&(i==null?void 0:i.visibilityMode)!=="inherited"&&this._toggleVisibility(t,i)}_togglePanel(e){e.open=!e.open,e.open&&(this._focusPanelFlowItem=!0)}_toggleVisibility(e,t){if(!e)return;(t==null?void 0:t.visibilityMode)==="exclusive"&&e.visible||(e.visible=!e.visible)}_renderEditingInput(){const{messages:e}=this,{basemapTitle:t}=this.viewModel;return r("div",{class:g.editing},r("calcite-label",null,e.basemapTitle,r("calcite-input",{afterCreate:i=>this._editTitleInput=i,label:e.basemapTitle,name:"basemaptitle",pattern:ve,placeholder:e.basemapTitle,required:!0,title:e.basemapTitle,type:"text",value:t??void 0})))}_renderCancelButton(){const{messagesCommon:{cancel:e}}=this;return r("calcite-button",{appearance:"outline",bind:this,label:e,onclick:this._toggleEditingTitle,slot:"footer",title:e,width:"half"},e)}_renderSubmitButton(){const{messagesCommon:e}=this;return r("calcite-button",{label:e.form.submit,slot:"footer",title:e.form.submit,type:"submit",width:"half"},e.form.ok)}_renderEditingForm(){return this.editingTitle?r("form",{bind:this,onsubmit:this._formSubmit},r("calcite-flow-item",{afterCreate:this._focusEditingFlowItemNode,afterUpdate:this._focusEditingFlowItemNode,bind:this,heading:this.visibleElements.heading?this.messages.basemapTitle:void 0,headingLevel:this.headingLevel,onCalciteFlowItemBack:e=>{e.preventDefault(),this._toggleEditingTitle()}},this._renderEditingInput(),this._renderCancelButton(),this._renderSubmitButton())):null}_renderEditTitleButton(){const{editingTitle:e,visibleElements:t,messagesCommon:i}=this,s=i.edit;return t.editTitleButton&&!e?r("calcite-action",{bind:this,icon:"pencil",onclick:this._toggleEditingTitle,slot:"header-actions-end",text:s,title:s}):null}_renderNoLayersInfoMessage(e){return r("div",{slot:"message"},e)}_renderNoLayersInfo(e,t){return r("div",{class:g.itemMessage},r("calcite-notice",{icon:"information",key:t,kind:"info",open:!0,width:"full"},this._renderNoLayersInfoMessage(e)))}_getFilteredItems(e){return e==null?void 0:e.filter(t=>!t.hidden&&(this.visibleElements.errors||!t.error))}_renderItems(){const{collapsed:e,visible:t,visibleElements:{closeButton:i,collapseButton:s,heading:l,flow:n},messages:m,viewModel:c,referenceItems:p,baseItems:b}=this,_=this.visibleElements.referenceLayers?this._getFilteredItems(p):null,h=this.visibleElements.baseLayers?this._getFilteredItems(b):null,y=[r("calcite-flow-item",{afterCreate:this._focusRootFlowItemNode,afterUpdate:this._focusRootFlowItemNode,bind:this,closable:i,closed:!t,collapsed:e,collapsible:s,heading:l?c.basemapTitle??m.widgetLabel:void 0,headingLevel:this.headingLevel,key:"root-flow-item",onCalciteFlowItemClose:()=>this.visible=!1},this._renderEditTitleButton(),this._renderReferenceSection(_),this._renderBaseSection(h,(h==null?void 0:h.length)===1)),this._renderEditingForm(),this._renderPanelFlowItems(h),this._renderPanelFlowItems(_),this._renderCatalogFlowItem()];return t?[n?r("calcite-flow",{key:"root-flow"},y):y,this._renderItemTooltips(_),this._renderItemTooltips(h)]:null}_renderChildList(e,t,i=[]){var _,h;const{_rootGroupUid:s,dragEnabled:l,viewModel:{listModeDisabled:n},selectionMode:m}=this,{children:c}=e,p=((_=e.layer)==null?void 0:_.type)!=="catalog-dynamic-group"&&me(e),b=!(!n&&pe(e.layer))&&!p&&l&&((h=e.layer)==null?void 0:h.type)==="group";return p||b?r("calcite-list",{canPull:y=>this._canMove(y,"pull"),canPut:y=>this._canMove(y,"put"),"data-basemap-layer-type":t,"data-item":e,"data-layer-type":s,dragEnabled:!!l&&e.childrenSortable&&he(e),group:`${s}-${e.layer.uid}`,key:`child-list-${e.layer.uid}`,selectionAppearance:"border",selectionMode:m},c==null?void 0:c.filter(y=>!y.hidden).toArray().map(y=>this._renderItem(y,t,!1,e,[...i,e.title]))):null}_renderList(e,t,i){const{messages:s,dragEnabled:l,selectionMode:n,filterPlaceholder:m,baseFilterText:c,referenceFilterText:p,_baseFilterEnabled:b,_referenceFilterEnabled:_,_rootGroupUid:h}=this,y=t==="reference"?s.noReferenceLayers:s.noBaseLayers,L=t==="reference"?_:b;return r("calcite-block",{class:g.section,collapsible:!0,heading:t==="reference"?s.referenceHeading:s.baseHeading,headingLevel:ge(this.headingLevel),key:`block-${t}`,open:!0},(e==null?void 0:e.length)===0?this._renderNoLayersInfo(y,t):null,r("calcite-list",{afterCreate:u=>{u.addEventListener("focusin",this._setActiveItem),u.addEventListener("focusout",this._clearActiveItem)},afterRemoved:u=>{u.removeEventListener("focusin",this._setActiveItem),u.removeEventListener("focusout",this._clearActiveItem)},canPull:u=>this._canMove(u,"pull"),canPut:u=>this._canMove(u,"put"),"data-basemap-layer-type":t,"data-layer-type":h,dragEnabled:l,filterEnabled:L,filterPlaceholder:m,filterText:L?t==="reference"?p:c:"",group:h,key:`list-${t}`,label:s.widgetLabel,onmouseleave:this._clearActiveItem,onmouseover:this._setActiveItem,selectionAppearance:"border",selectionMode:n,onCalciteListChange:u=>this._handleCalciteListChange(u),onCalciteListDragEnd:u=>this._handleCalciteListDragEnd(u.detail),onCalciteListFilter:u=>{var C;return this[t==="reference"?"referenceFilterText":"baseFilterText"]=((C=u.target)==null?void 0:C.filterText)??""},onCalciteListOrderChange:u=>this._onCalciteListOrderChange(u.detail)},e==null?void 0:e.toArray().map(u=>this._renderItem(u,t,i)),e!=null&&e.length&&L?r("div",{class:g.filterNoResults,slot:"filter-no-results"},r("calcite-notice",{kind:"info",open:!0,width:"full"},this._renderNoLayersInfoMessage(y))):null))}_renderBaseSection(e,t){return this.visibleElements.baseLayers?this._renderList(e,"base",t):null}_renderReferenceSection(e){return this.visibleElements.referenceLayers?this._renderList(e,"reference",!1):null}_toggleEditingTitle(){const{editingTitle:e}=this,t=!e;this.editingTitle=t,t?this._focusEditingFlowItem=!0:this._focusRootFlowItem=!0}_formSubmit(e){var i;e.preventDefault();const t=(i=this._editTitleInput)==null?void 0:i.value;t!=null&&t.trim()&&(this.basemapTitle=t),this._toggleEditingTitle()}};function $(e){return e==null?void 0:e.getAttribute("data-basemap-layer-type")}a([o()],d.prototype,"_activeItem",void 0),a([o()],d.prototype,"_tooltipReferenceMap",void 0),a([o()],d.prototype,"_focusRootFlowItem",void 0),a([o()],d.prototype,"_focusPanelFlowItem",void 0),a([o()],d.prototype,"_focusEditingFlowItem",void 0),a([o()],d.prototype,"_focusCatalogFlowItem",void 0),a([o()],d.prototype,"_totalBaseItems",null),a([o()],d.prototype,"_totalReferenceItems",null),a([o()],d.prototype,"_baseFilterEnabled",null),a([o()],d.prototype,"_referenceFilterEnabled",null),a([o()],d.prototype,"basemapTitle",null),a([o({readOnly:!0})],d.prototype,"catalogLayerList",void 0),a([o()],d.prototype,"catalogOptions",void 0),a([o()],d.prototype,"collapsed",void 0),a([o()],d.prototype,"dragEnabled",void 0),a([o()],d.prototype,"editingTitle",void 0),a([o()],d.prototype,"filterPlaceholder",void 0),a([o()],d.prototype,"baseFilterText",void 0),a([o()],d.prototype,"referenceFilterText",void 0),a([o()],d.prototype,"listItemCanGiveFunction",void 0),a([o()],d.prototype,"listItemCanReceiveFunction",void 0),a([o()],d.prototype,"baseListItemCreatedFunction",null),a([o()],d.prototype,"editingEnabled",null),a([o()],d.prototype,"headingLevel",void 0),a([o()],d.prototype,"icon",null),a([o()],d.prototype,"label",null),a([o(),Q("esri/widgets/BasemapLayerList/t9n/BasemapLayerList")],d.prototype,"messages",void 0),a([o(),Q("esri/t9n/common")],d.prototype,"messagesCommon",void 0),a([o()],d.prototype,"minFilterItems",void 0),a([o()],d.prototype,"multipleSelectionEnabled",null),a([o()],d.prototype,"referenceListItemCreatedFunction",null),a([o({readOnly:!0})],d.prototype,"baseItems",null),a([o()],d.prototype,"openCatalogItem",void 0),a([o({readOnly:!0})],d.prototype,"referenceItems",null),a([o()],d.prototype,"selectedItems",void 0),a([o()],d.prototype,"selectionMode",void 0),a([o()],d.prototype,"view",null),a([_e("trigger-action"),o({type:Z})],d.prototype,"viewModel",void 0),a([o()],d.prototype,"visibilityAppearance",void 0),a([o({type:G,nonNullable:!0})],d.prototype,"visibleElements",void 0),d=a([q("esri.widgets.BasemapLayerList")],d);const Ge=d;export{Ge as default};
