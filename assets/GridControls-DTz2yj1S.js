const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./calcite-action-Bys6x4p_.js","./action-D0Er9Ef6.js","./jsxFactory-CJa39Fro.js","./tslib.es6-B3Jf3DVX.js","./intl-CChhNOV8.js","./date-DlqISzcw.js","./jsonMap-0cxwUWs2.js","./subclass-BZA_h8Db.js","./locale-C9TlLpzi.js","./messages-OmQvZhAg.js","./Accessor-BLX9ikPh.js","./assets-C43MgM-v.js","./index-Bh2oEzTI.js","./index-2kwcjS9-.css","./Evented-BHRw9x22.js","./Promise-B2Hu02L7.js","./reactiveUtils-C5zUhJQJ.js","./asyncUtils-CWX51uTe.js","./Collection-CEdjem1-.js","./shared-B3wH2qpO.js","./SimpleObservable-KocWTzVy.js","./uuid-fwrPAdZb.js","./cast-Bjksrh93.js","./dom-D_AJDzAj.js","./interactive-y84HQRWL.js","./loadable-DM18hPdE.js","./locale-A4FuYD8q.js","./key-D63ExP77.js","./observers-D2xgmA06.js","./component-6CIDVndn.js","./t9n-D0ry3MEw.js","./icon-BQO9J86c.js","./loader-C-zIPscB.js","./calcite-action-bar-pMVRYUJz.js","./conditionalSlot-R5D9krYS.js","./ExpandToggle-D9_knjDY.js","./action-group-BJ76kEtf.js","./action-menu-C6uYzPu-.js","./array-BMcQdnYi.js","./popover-Q5ruM4hh.js","./floating-ui-Bma_zPVt.js","./debounce-BOqmhDXu.js","./focusTrapComponent-BSUg_DLj.js","./openCloseComponent-CmOrfBN-.js","./Heading-D7P0OjYI.js","./FloatingArrow-BBdsG5MP.js","./calcite-label-B1FxWqaL.js","./label-DEe8AW1C.js","./calcite-icon-Cu0W9dtm.js","./calcite-popover-5MaBc2pF.js","./calcite-tooltip-rE_jVYtd.js","./calcite-color-picker-D30MVPTO.js","./color-picker-swatch-BkkyNtW3.js","./math-CPc4dlb6.js","./button-9P4PM9SO.js","./form-BZPQ5PUM.js","./input-message-CWvsvdFk.js","./input-number-BVYRKcQu.js","./Validation-Bz9yoU6e.js","./input-j1u1wOBY.js","./progress-BXyickl_.js","./input-text-uJGGrtzk.js","./tab-CUfjd98M.js","./tab-nav-D__ErtFr.js","./core-Cpfj44ZG.js","./tab-title-CjKan3lH.js","./tabs-snn1gob8.js","./throttle-MmodMsuz.js","./calcite-input-number-BjjBFtSg.js"])))=>i.map(i=>d[i]);
import{_ as f}from"./index-Bh2oEzTI.js";import{r as o}from"./tslib.es6-B3Jf3DVX.js";import{l as v}from"./Color-BCS62Hs5.js";import{s as Z}from"./intl-CChhNOV8.js";import{when as tt,watch as $,initial as et}from"./reactiveUtils-C5zUhJQJ.js";import{g as it}from"./unitFormatUtils-CZ2bRlFg.js";import{m as n,a as T,n as rt}from"./subclass-BZA_h8Db.js";import{n as s,e as D,B as ot,r as nt,l as st}from"./jsxFactory-CJa39Fro.js";import{e as V}from"./globalCss-CZa70j6i.js";import{r as H,c as at,l as I}from"./SnappingControls-ClZP8Zqn.js";import"./geometry-D964gYQX.js";import"./symbols-CNimns--.js";import{o as lt}from"./Evented-BHRw9x22.js";import{S as q,M as pt}from"./mathUtils-C4_ghTv4.js";import{b as ct,q as E}from"./Accessor-BLX9ikPh.js";import{j as O,I as A}from"./Point-Cg0-ChZE.js";import{B as dt,K as mt}from"./projection-B971H0Re.js";import{o as ht}from"./scaleUtils-D_Nw3nhM.js";import{f as gt}from"./assets-C43MgM-v.js";import{r as ut}from"./enumeration-Ba5njXdz.js";import{e as j}from"./projectVectorToVector-G2uWGoIb.js";import{e as vt}from"./defaultUnit-_T4IY-sW.js";import{t as _t,l as yt,f as bt,u as wt}from"./gridUtils-BX6Ojh6T.js";import{DrawGraphicTool2D as ft}from"./editingTools-DCvBiyJu.js";import{m as U}from"./SnappingManager-BJPyuu7J.js";import{x as St}from"./TextOverlayItem-zxgmE06K.js";import{o as Ct}from"./formatUtils-C08vjXVT.js";import{d as z,y as Mt}from"./TextSymbol-D8QO_KUV.js";import"./colorUtils-0bJDPow9.js";import"./date-DlqISzcw.js";import"./jsonMap-0cxwUWs2.js";import"./locale-C9TlLpzi.js";import"./messages-OmQvZhAg.js";import"./asyncUtils-CWX51uTe.js";import"./Collection-CEdjem1-.js";import"./shared-B3wH2qpO.js";import"./SimpleObservable-KocWTzVy.js";import"./ByteSizeUnit-BsxeN7wM.js";import"./Cyclical-oTUX3aX7.js";import"./quantityUtils-D0GB2dMc.js";import"./Promise-B2Hu02L7.js";import"./uuid-fwrPAdZb.js";import"./cast-Bjksrh93.js";import"./isSupportedObject-6I_Nw0mS.js";import"./SketchLabelOptions-DDQnGNSN.js";import"./angularMeasurementUtils-7e2vxqzG.js";import"./vec2-maR1OrZI.js";import"./common-DQOJ18NT.js";import"./vec2f64-miziP1SN.js";import"./vec32-Dvg_eL9J.js";import"./vec3f64-BLpZdpfb.js";import"./geodesicUtils-FCYOaNwu.js";import"./geodesicConstants-DWQLYX7F.js";import"./Polyline-D9YkgmM_.js";import"./writer-DNAwXnhG.js";import"./Extent-Bf3YTe7m.js";import"./elevationInfoUtils-BC_66_Fg.js";import"./unitConversionUtils-BMfW9yAe.js";import"./lengthUtils-DL1-FDQQ.js";import"./directionModeIcons-Br5woIHu.js";import"./layerListUtils-Cb_jjipP.js";import"./ActionToggle-iT4slXc7.js";import"./Identifiable-B1UbsKNt.js";import"./LayerListViewModel-C5g5Lp46.js";import"./utils-BQBvadb7.js";import"./ListItem-D2lt9R2a.js";import"./widget-DwhGPDuv.js";import"./fieldUtils-tmQlKvWo.js";import"./screenUtils-_ZIvrt5o.js";import"./materialUtils-DarhapKC.js";import"./opacityUtils-C68Tlu6_.js";import"./aaBoundingBox-BE7cC1jD.js";import"./persistableUrlUtils-fa1mAujs.js";import"./collectionUtils-D_lHIu88.js";import"./Portal-C10FKnaA.js";import"./Loadable-BabW5Xcc.js";import"./Clonable-D3rtuBWg.js";import"./projectBuffer-Bs7GwaPY.js";import"./projectPointToVector-GINIbYMz.js";import"./getDefaultUnitForView-Ce2vZZap.js";import"./normalizeUtils-EVmAQ-ak.js";import"./normalizeUtilsCommon-dT81xWiM.js";import"./jsonUtils-CEfjT-BK.js";import"./utils-6jMaHUrH.js";import"./utils-Bema0iXE.js";import"./Graphic-DsxsIjhH.js";import"./PopupTemplate-BHMhS05j.js";import"./SnappingVisualizer2D-Br8KvMdL.js";import"./enums-CmIX1y88.js";import"./SnappingVisualizer-BtjTdiTG.js";import"./PointSnappingHint-D7X20mlb.js";import"./editPlaneUtils-DJAUpVXQ.js";import"./UpdatingHandles-GfwcIh5z.js";import"./coordinateFormatter-Bqv90CKy.js";import"./GraphicsLayer-i3FeUJ_n.js";import"./GraphicsCollection-FfahqxsR.js";import"./Layer-CVt7Hb5J.js";import"./TimeExtent-DocT5yPf.js";import"./timeUtils-8fb_2oAt.js";import"./BlendLayer-CXM4n_Ge.js";import"./jsonUtils-CSnQD004.js";import"./parser-CTsgEym6.js";import"./utils-93yNk4Xc.js";import"./mat4f32-DcsiF_Rp.js";import"./mat4-GpOFENPA.js";import"./ScaleRangeLayer-Bb8Ig1Hz.js";import"./ElevationInfo-CA5m_tHv.js";import"./dehydratedFeatureComparison-06VFTqH5.js";import"./createUtils-ibzYx0GK.js";import"./Circle-BInHZHdw.js";import"./geometryEngine-DGiYLHJy.js";import"./geometryEngineBase-yFIvKOkM.js";import"./_commonjsHelpers-DCkdB7M8.js";import"./hydrated-C9rxSL4a.js";import"./surfaceCoordinateSystems-DhFxihAh.js";import"./memoize-DsJmrG76.js";import"./ReactiveSet-BU2iaegS.js";import"./diffUtils-BP7jmOAy.js";import"./ViewingMode-Dodu7ZZk.js";import"./EditGeometryOperations-Cl8Sbfxr.js";import"./compilerUtils-Dw3R0f-Z.js";import"./vec42-YcqnINSP.js";import"./vec4f64-o2zAXfmz.js";import"./plane-IENfwZlB.js";import"./mat3f64-BBpwCtoL.js";import"./mat4f64-Dk4dwAN8.js";import"./quatf64-CCm9z-pX.js";import"./mathUtils-BG-eq9fO.js";import"./geometry2dUtils-DdyQE7AQ.js";import"./InteractiveToolBase-vg6J8uyT.js";import"./meshVertexSpaceUtils-CXzOFlTI.js";import"./MeshLocalVertexSpace-LEHwMUnu.js";import"./hydratedFeatures-DBKLr8hT.js";import"./interfaces-D6pIddIh.js";import"./SnappingContext-lR2hMWGP.js";import"./SnappingDragPipelineStep-rzVcndp8.js";import"./Scheduler-CJu5awNf.js";import"./signal-D4lghLjV.js";import"./debugFlags-BF6Z0j0F.js";import"./SnappingOperation-CaI4DIP4.js";import"./mat2d-D9DBP-jx.js";import"./mat2df64-CBKYtunK.js";import"./quat-4pa1e6ds.js";import"./helpMessageUtils-M95XMmyR.js";import"./helpMessageUtils3d-TaLw0ElD.js";import"./SketchTooltipInfo-BA57LzDt.js";import"./MeshTransform-D2t3aEmK.js";import"./axisAngleDegrees-Ci2HA7Jo.js";import"./keybindings-DoOdil3D.js";import"./InputManager-Ba9xzDpe.js";import"./Queue-yu3bZ02p.js";import"./themeUtils-C3zvZbsE.js";import"./a11yUtils-cyWndM8Q.js";import"./quantityFormatUtils-CX8UdSzC.js";import"./spatialReferenceEllipsoidUtils-DBE_OFra.js";import"./automaticAreaMeasurementUtils-12dUsEmf.js";import"./geodesicMeasurementUtils-Bt9h4589.js";import"./euclideanAreaMeasurementUtils-CfO9bFtV.js";import"./earcut-Lltz9D9k.js";import"./triangle-PTGDC_xJ.js";import"./sphere-C77djCO6.js";import"./mat3-BRl2i9Bz.js";import"./lineSegment-D7sKPPYf.js";import"./geodesicAreaMeasurementUtils-BILXFcc4.js";import"./automaticLengthMeasurementUtils-BXgXm1JY.js";import"./geodesicLengthMeasurementUtils-he3vjGJN.js";import"./boundedPlane-EV1sS2Ke.js";import"./cimSymbolUtils-DXvZxabN.js";import"./utils-D2PLyMFF.js";import"./GraphicManipulator-Dc-QfW2U.js";import"./defaults-DZ1kfMRx.js";import"./defaultsJSON-GKolV7NZ.js";import"./drapedUtils-HWKOCxgF.js";import"./colorUtils-aL8wj-8G.js";import"./drawUtils-D0InE6Wy.js";import"./hitTestSelectUtils-UXJPjatw.js";import"./screenUtils-WcqhHU65.js";import"./Query-5Xpquc1r.js";import"./DataLayerSource-BKkswDvG.js";import"./Field-ybkHhtnK.js";import"./fieldType-BuzM0UHS.js";import"./FullTextSearch-Csd1Hktu.js";import"./utils-BpB3MnW1.js";import"./Version-BSlAgupz.js";import"./viewUtils-DrPohWV3.js";import"./number-CUaGJe2K.js";let g=class extends gt{constructor(t){super(t),this.center=new O,this.dynamicScaling=!0,this.majorLineColor=v.fromArray([115,115,115,1]),this.majorLineInterval=10,this.minorLineColor=v.fromArray([165,165,165,1]),this.rotateWithMap=!1,this.rotation=0,this.spacing=1,this.type="measured",this.units="miles"}};o([n()],g.prototype,"center",void 0),o([n()],g.prototype,"dynamicScaling",void 0),o([n()],g.prototype,"majorLineColor",void 0),o([n()],g.prototype,"majorLineInterval",void 0),o([n()],g.prototype,"minorLineColor",void 0),o([n()],g.prototype,"rotateWithMap",void 0),o([n()],g.prototype,"rotation",void 0),o([n()],g.prototype,"spacing",void 0),o([ut({measured:"measured"})],g.prototype,"type",void 0),o([n()],g.prototype,"units",void 0),g=o([T("esri.grids.MeasuredGrid")],g);let u=class extends ct{constructor(t){super(t),this.color=new v([255,127,0,1]),this.isDecoration=!0,this.length=34,this.rotation=0,this.thickness=2,this.visible=!0}get _strokeStyle(){return this.color.toCss(!0)}render(){const{x:t,y:e,length:i,thickness:r,rotation:a}=this,p=i/2,c=`0 0 ${i} ${i}`,d=`M${p} 0 V${i} M0 ${p} H${i}`;return s("div",{classes:{"esri-box-overlay-item":!0},styles:{left:`${(t??0)-p}px`,top:`${(e??0)-p}px`,width:`${i}px`,height:`${i}px`,transform:`rotate(${a}deg)`,visibility:this.visible?"visible":"hidden"}},s("svg",{styles:{overflow:"visible"},viewbox:c},s("path",{d,stroke:this._strokeStyle,"stroke-width":r})))}renderCanvas(){}};o([n()],u.prototype,"color",void 0),o([n()],u.prototype,"isDecoration",void 0),o([n()],u.prototype,"length",void 0),o([n()],u.prototype,"rotation",void 0),o([n()],u.prototype,"thickness",void 0),o([n()],u.prototype,"visible",void 0),o([n()],u.prototype,"x",void 0),o([n()],u.prototype,"y",void 0),o([n({readOnly:!0})],u.prototype,"_strokeStyle",null),u=o([T("esri.views.overlay.CrosshairOverlayItem")],u);const It=u,F=t=>{if(t==null||isNaN(t))return 0;const e=t+180;return Math.trunc(q(e,360))},xt=t=>{let e=t;return e==null?0:(typeof e=="string"&&(e=parseInt(e,10)),isNaN(e)?0:q(Math.trunc(e),360)-180)},W=(t,e)=>{if(!t||e.length<3)return;const[i,r,a,p]=e,[c,d]=p===void 0?[1,.25]:[p,.25*p];t.majorLineColor=v.fromArray([i,r,a,c]),t.minorLineColor=v.fromArray([i,r,a,d])},B=Symbol("grid-interactivity");let l=class extends lt.EventedAccessor{constructor(t){super(t),this._drawGraphicTool=null,this._crosshairLabel=null,this._crosshairItem=null,this.snappingManager=null,this.snappingOptions=null,this.view=null,this.placementDisabled=!1,this._mostRecentlyShownGrid=null,this._sketchedVertexCount=0}initialize(){this.addHandles([tt(()=>!this.displayEnabled,()=>{this.interactivePlacementState=null}),$(()=>{var t;return(t=this.view)==null?void 0:t.viewpoint},()=>{this._renderOverlays()}),$(()=>{var t;return((t=this.snappingOptions)==null?void 0:t.gridEnabled)&&this.snappingOptions.enabled},t=>{var e;t!=null&&(this.trySetDisplayEnabled(t),((e=this.snappingOptions)==null?void 0:e.enabled)===!0&&(this.snappingEnabled=t))}),$(()=>{var t;return(t=this.view)==null?void 0:t.grid},(t,e)=>{this._mostRecentlyShownGrid=!t&&e?e:null})])}destroy(){var t,e,i,r;this._resetGridPlacementState(),this._crosshairItem&&((e=(t=this.view)==null?void 0:t.overlay)==null||e.removeItem(this._crosshairItem),this._crosshairItem=E(this._crosshairItem)),this._crosshairLabel&&((r=(i=this.view)==null?void 0:i.overlay)==null||r.removeItem(this._crosshairLabel),this._crosshairLabel=E(this._crosshairLabel))}get displayEnabled(){var t;return!!((t=this.view)!=null&&t.grid)}get dynamicScaling(){var t;return((t=this.grid)==null?void 0:t.dynamicScaling)??!1}set dynamicScaling(t){this.grid&&(this.grid.dynamicScaling=t)}get grid(){var t;return((t=this.view)==null?void 0:t.grid)??this._mostRecentlyShownGrid}set gridColor(t){this._set("gridColor",t);const[e,i,r,a]=t.toArray();W(this.grid,[e,i,r,a/255])}get gridControlsEnabled(){return this.displayEnabled&&!this.interactivePlacementState}set interactivePlacementState(t){this._set("interactivePlacementState",t),this._resetGridPlacementState(),t&&this._startGridManipulation(t)}get majorLineInterval(){var t;return((t=this.grid)==null?void 0:t.majorLineInterval)??10}set majorLineInterval(t){this.grid&&(this.grid.majorLineInterval=t<1?1:t>15?15:t)}get rotateWithMap(){var t;return((t=this.grid)==null?void 0:t.rotateWithMap)??!1}set rotateWithMap(t){this.grid&&(this.grid.rotateWithMap=t)}get rotation(){var t;return((t=this.grid)==null?void 0:t.rotation)??-180}set rotation(t){this.grid&&(this.grid.rotation=t)}get snappingEnabled(){var t;return(this.grid&&((t=this.snappingOptions)==null?void 0:t.gridEnabled))??!1}set snappingEnabled(t){const{snappingOptions:e}=this;e&&(e.gridEnabled=t)}get spacing(){var t;return((t=this.grid)==null?void 0:t.spacing)??1}set spacing(t){this.grid&&t>0&&(this.grid.spacing=t)}get unit(){var t;return(t=this.grid)==null?void 0:t.units}set unit(t){this.grid&&(this.grid.units=t)}get gridOutOfScale(){return!this.dynamicScaling&&this._pixelsPerStride!=null&&this._pixelsPerStride<_t}get effectiveSpacingAfterDynamicScaling(){var t;return this.majorLineInterval<1||!this.dynamicScaling||!this.view||this._pixelsPerStride==null||!((t=this.grid)!=null&&t.spacing)?null:this.grid.spacing*yt(this.majorLineInterval,this._pixelsPerStride,this.dynamicScaling)}get numericSpacingInputShouldBeVisible(){return!(!this.displayEnabled||!this.view)&&bt(this.view.spatialReference)}get _metersPerSRUnit(){if(!(this.view&&this.displayEnabled&&this.grid&&dt(this.grid.center.spatialReference,this.view.spatialReference)))return null;const t=mt(this.grid.center,this.view.spatialReference);return wt(t)}get _pixelsPerStride(){var r;if(!((r=this.view)!=null&&r.scale)||!this.displayEnabled||!this.grid||this._metersPerSRUnit==null)return null;const t=this.grid,{scale:e,spatialReference:i}=this.view;return A(t.spacing,t.units,"meters")/(this._metersPerSRUnit*ht(e,i))}get _isPlacing(){if(!this._drawGraphicTool)return!1;const t=this.interactivePlacementState;return t==="place"||t==="interactive"&&this._sketchedVertexCount===0}get _isRotating(){if(!this._drawGraphicTool)return!1;const t=this.interactivePlacementState;return t==="rotate"||t==="interactive"&&this._sketchedVertexCount===1}get _isScaling(){return this._drawGraphicTool?this.interactivePlacementState==="interactive"&&this._sketchedVertexCount===1:!1}togglePlacementState(t){this.interactivePlacementState=this.interactivePlacementState===t?null:t}trySetDisplayEnabled(t){const{view:e}=this;if(e!=null&&e.ready)if(!e.grid&&t)if(this._mostRecentlyShownGrid)e.grid=this._mostRecentlyShownGrid;else{const i=this.defaultUnit==="imperial"?"feet":"meters";e.grid=new g({units:i,center:e.center??new O,rotateWithMap:!0}),W(this.grid,[115,115,115])}else t||(e.grid=null);else rt.getLogger(this).warn("Attempting to enable grid display while view is not ready")}startPlacement(t){const{view:e,snappingManager:i}=this;if(!e)return;this._set("interactivePlacementState",t),this._sketchedVertexCount=0;const r=new ft({view:e,graphicProperties:{attributes:{[U]:U}},sketchOptions:{tooltips:{enabled:!0,visibleElements:{direction:!1,rotation:!1,totalLength:!1,elevation:!1,distance:!1,area:!1}}},geometryType:"polyline",mode:"click",snapToScene:!1,snappingManager:i,forceUniformSize:!0,centered:!1,cursor:this.interactivePlacementState==="interactive"||this.interactivePlacementState==="place"?"none":null,regularVerticesSymbol:void 0,activeVertexSymbol:$t,activeLineSymbol:N,graphicSymbol:N});this._drawGraphicTool=r,e.addAndActivateTool(r),this._renderOverlays(),this.addHandles([r.on("cursor-update",a=>this._onCursorUpdate(a)),r.on("complete",()=>this._onDrawComplete()),r.on("vertex-add",a=>this._onVertexAdd(a,t))],B)}async _startGridManipulation(t){const{view:e}=this;if(!e)return void(this.interactivePlacementState=null);const i=new CustomEvent("before-placement",{cancelable:!0});this.emit("before-placement",i),i.defaultPrevented||this.startPlacement(t)}_onCursorUpdate(t){var e;try{if(this._isPlacing){const i=t.vertices[0].coordinates;return void this._handlePlace(i)}if(this._drawGraphicTool.cursor=null,this._isRotating&&this._handleRotate(t.vertices[0].coordinates),this._isScaling){const i=(e=this._drawGraphicTool)==null?void 0:e.drawOperation.cursorVertex;this._handleScale(i)}}finally{this._renderOverlays()}}_onDrawComplete(){this._drawGraphicTool.cursor=null,this.interactivePlacementState=null}_onVertexAdd(t,e){const i=t.vertices[0].coordinates;this._isPlacing&&this._handlePlace(i),this._isRotating&&this._sketchedVertexCount>0&&this._handleRotate(i),this._isScaling&&this._sketchedVertexCount>0&&this._handleScale(j(i[0],i[1],void 0,this.view.spatialReference)),this._sketchedVertexCount++,this._drawGraphicTool.cursor=null,this._sketchedVertexCount!==2&&e==="interactive"||(this.interactivePlacementState=null),this._renderOverlays()}_handlePlace(t){const{grid:e,view:i}=this;e&&i&&(e.center=new O({x:t[0],y:t[1],spatialReference:i.spatialReference}))}_handleRotate(t){var R;const{grid:e,view:i}=this;if(!e||!i)return;(R=this._drawGraphicTool)==null||R.sketchOptions.tooltips.set("enabled",!1);const{x:r,y:a}=e.center,[p,c]=t,d=i.toScreen(e.center,{pickClosestTarget:!0}),_=d&&i.toMap(d),h=i.toScreen(j(p,c,void 0,i.spatialReference),{pickClosestTarget:!0}),w=h&&i.toMap(h),C=_?_.x:r,P=_?_.y:a,M=C-(w?w.x:p),k=P-(w?w.y:c);if(M===0&&k===0)return;const J=Math.atan2(k,M),G=pt(J),Q=e.rotateWithMap,X=i.viewpoint.rotation??0,Y=Q?G:G-X;e.rotation=Math.fround(Y)%360}_handleScale(t){const{view:e,grid:i,_drawGraphicTool:r,interactivePlacementState:a,_metersPerSRUnit:p}=this;if(!(t&&e&&i&&r&&p))return;r.sketchOptions.tooltips.enabled=!1;const c=a==="interactive"?i.center:r.drawOperation.firstVertex;if(!c||!t)return;const d=e==null?void 0:e.toScreen(c),_=d&&e.toMap(d),h=e==null?void 0:e.toScreen(t),w=_??c,C=(h&&e.toMap(h))??t,P=Math.sqrt((w.x-C.x)**2+(w.y-C.y)**2),M=A(P*p,"meters",i.units);this.spacing=M}_renderOverlays(){this._renderCrosshairOverlay(),this._renderTextOverlay()}_renderTextOverlay(){const{grid:t,view:e,_drawGraphicTool:i}=this,r=this._getCrosshairLabel();if(!(t&&(e!=null&&e.overlay)&&i&&r))return;const a=e.toScreen(t.center,{pickClosestTarget:!0});a&&(r.position=[a.x+12,a.y+12]),this._isRotating?(r.text=`${F(t.rotation)}${Ct}`,r.visible=!0):r.visible=!1}_renderCrosshairOverlay(){const{grid:t,view:e,_drawGraphicTool:i}=this;if(!t||!(e!=null&&e.overlay)||!i)return;const r=this._getCrosshair();if(!r)return;const a=e.toScreen(t.center);a&&(r.x=a.x,r.y=a.y,r.rotation=t.rotateWithMap?e.viewpoint.rotation-t.rotation:-t.rotation,r.visible=!!i)}_getCrosshairLabel(){if(this._crosshairLabel)return this._crosshairLabel;const{grid:t,view:e,_drawGraphicTool:i}=this;if(!t||!(e!=null&&e.overlay)||!i)return null;const r=new St({anchor:"top-left",fontSize:10,textColor:new v([21,21,21]),backgroundColor:new v([248,248,248]),padding:8,borderRadius:20});return e.overlay.addItem(r),this._crosshairLabel=r,r}_getCrosshair(){var i;const{_crosshairItem:t,view:e}=this;return e!=null&&e.overlay?t&&e.overlay.items.includes(t)?t:(this._crosshairItem=new It({color:e.effectiveTheme.accentColor,thickness:4,length:36,visible:!0}),(i=e.overlay)==null||i.addItem(this._crosshairItem),this._crosshairItem):null}_resetGridPlacementState(){var t,e;this.removeHandles(B),this._crosshairItem&&(this._crosshairItem.visible=!1),this._crosshairLabel&&(this._crosshairLabel.visible=!1),this._drawGraphicTool&&(((t=this.view)==null?void 0:t.activeTool)===this._drawGraphicTool&&(this.view.activeTool=null),(e=this.view)==null||e.tools.remove(this._drawGraphicTool)),this._drawGraphicTool=E(this._drawGraphicTool)}};o([n(vt)],l.prototype,"defaultUnit",void 0),o([n({readOnly:!0})],l.prototype,"displayEnabled",null),o([n()],l.prototype,"dynamicScaling",null),o([n()],l.prototype,"grid",null),o([n()],l.prototype,"gridColor",null),o([n({readOnly:!0})],l.prototype,"gridControlsEnabled",null),o([n()],l.prototype,"interactivePlacementState",null),o([n()],l.prototype,"majorLineInterval",null),o([n()],l.prototype,"rotateWithMap",null),o([n()],l.prototype,"rotation",null),o([n()],l.prototype,"snappingEnabled",null),o([n()],l.prototype,"snappingManager",void 0),o([n()],l.prototype,"snappingOptions",void 0),o([n()],l.prototype,"spacing",null),o([n()],l.prototype,"unit",null),o([n()],l.prototype,"view",void 0),o([n({readOnly:!0})],l.prototype,"gridOutOfScale",null),o([n({readOnly:!0})],l.prototype,"effectiveSpacingAfterDynamicScaling",null),o([n({readOnly:!0})],l.prototype,"numericSpacingInputShouldBeVisible",null),o([n()],l.prototype,"placementDisabled",void 0),o([n()],l.prototype,"_metersPerSRUnit",null),o([n()],l.prototype,"_pixelsPerStride",null),o([n()],l.prototype,"_isPlacing",null),o([n()],l.prototype,"_isRotating",null),o([n()],l.prototype,"_isScaling",null),o([n()],l.prototype,"_mostRecentlyShownGrid",void 0),o([n()],l.prototype,"_sketchedVertexCount",void 0),l=o([T("esri.widgets.support.GridControls.GridControlsViewModel")],l);const K=l,N=new z({width:0}),$t=new Mt({color:v.fromArray([0,0,0,0]),outline:new z({color:v.fromArray([0,0,0,0])})}),y="esri-grid-controls",b={base:y,borderedSwitch:`${y}__switch--bordered`,container:`${y}__container`,numericInputsContainer:`${y}__numeric-inputs__container`,tilegroup:`${y}__tilegroup`,tile:`${y}__tile`,tileDisabled:`${y}__tile--disabled`,tileContent:`${y}__tile__content`,suffixedInputContainer:`${y}__input-with-suffix__container`,inputSuffix:`${y}__input-with-suffix__suffix-part`,inlineIcon:`${y}__inline-icon`},S={widgetIcon:"grid-unit",gridTheme:{light:"circle",dark:"circle-area",custom:"palette"},placementState:{interactive:"maximum-territory-distance",place:"move",rotate:"rotate"},warning:"exclamation-mark-triangle"},x=v.fromArray([115,115,115]),L=v.fromArray([200,200,200]),Tt=["interactive","place","rotate"];let m=class extends ot{constructor(t,e){super(t,e),this.customColor=null,this.messages=null,this.messagesUnits=null,this.viewModel=new K,this.visibleElements=new H}initialize(){this.addHandles([$(()=>{var t,e;return(e=(t=this.view)==null?void 0:t.grid)==null?void 0:e.majorLineColor},t=>{!t||x.equals(t)||L.equals(t)||(this.customColor=t)},et)])}loadDependencies(){return Promise.all([nt({action:()=>f(()=>import("./calcite-action-Bys6x4p_.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32]),import.meta.url),"action-bar":()=>f(()=>import("./calcite-action-bar-pMVRYUJz.js"),__vite__mapDeps([33,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,34,28,23,25,26,27,30,35,36,37,38,1,24,29,31,32,39,40,41,42,43,44,45]),import.meta.url),label:()=>f(()=>import("./calcite-label-B1FxWqaL.js"),__vite__mapDeps([46,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,47,23,29]),import.meta.url),icon:()=>f(()=>import("./calcite-icon-Cu0W9dtm.js"),__vite__mapDeps([48,31,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,28]),import.meta.url),popover:()=>f(()=>import("./calcite-popover-5MaBc2pF.js"),__vite__mapDeps([49,39,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,40,23,41,42,43,44,26,27,28,30,25,45,29,1,24,31,32]),import.meta.url),tooltip:()=>f(()=>import("./calcite-tooltip-rE_jVYtd.js"),__vite__mapDeps([50,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,40,41,43,45]),import.meta.url),"color-picker":()=>f(()=>import("./calcite-color-picker-D30MVPTO.js"),__vite__mapDeps([51,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,52,23,24,27,25,26,28,53,30,54,55,47,29,31,32,56,57,58,59,60,61,62,63,64,65,66,67,41]),import.meta.url),"input-number":()=>f(()=>import("./calcite-input-number-BjjBFtSg.js"),__vite__mapDeps([68,57,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,55,24,27,47,29,25,26,28,30,58,59,31,56,60]),import.meta.url)}),at()])}get icon(){return S.widgetIcon}set icon(t){this._overrideIfSome("icon",t)}get label(){return this.messages.widgetLabel}set label(t){this._overrideIfSome("label",t)}get snappingManager(){return this.viewModel.snappingManager}set snappingManager(t){this.viewModel.snappingManager=t}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(t){this.viewModel.snappingOptions=t}get theme(){var e;const t=(e=this.viewModel.grid)==null?void 0:e.majorLineColor;return t?x.equals(t)?"dark":L.equals(t)?"light":"custom":null}set theme(t){const{viewModel:e,customColor:i,view:r}=this;switch(t){case"light":e.gridColor=L;break;case"dark":e.gridColor=x;break;case"custom":e.gridColor=i??(r==null?void 0:r.effectiveTheme.accentColor)??x}}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}render(){return s("div",{"aria-label":this.label,class:this.classes(b.base,V.widget,V.panel)},s("div",{class:b.container},this._renderContent()))}_renderContent(){const{visibleElements:t}=this;return[t.gridEnabledToggle?this._renderEnabledToggle():null,t.placementButtons?this._renderGridPlacementButtons():null,t.numericInputs?this._renderNumericInputs():null,t.lineIntervalInput?this._renderIntervalInput():null,t.gridSnapEnabledToggle&&this.viewModel.snappingOptions?this._renderSnappingToggle():null,t.dynamicScaleToggle?this._renderDynamicScaleToggle():null,t.rotateWithMapToggle?this._renderRotateToggle():null,t.colorSelection?this._renderColorSelection():null]}_renderGridPlacementButtons(){const{interactivePlacementState:t,placementDisabled:e,gridControlsEnabled:i}=this.viewModel,r=e||!i;return s("calcite-label",{key:"grid-placement-buttons",scale:"s"},this.messages.placementOptions,s("calcite-action-bar",{expandDisabled:!0,layout:"horizontal"},Tt.map(a=>this._renderPlacementModeButton(a,r,t))))}_renderPlacementModeButton(t,e,i){const r=this.messages.placementState[t],a=`__placement-action-${t}`;return s("div",null,s("calcite-action",{active:i===t,alignment:"center",disabled:e,icon:S.placementState[t],id:a,onclick:()=>this.viewModel.togglePlacementState(t),text:r}),s("calcite-tooltip",{placement:"top",referenceElement:a},r))}_renderNumericInputs(){const{rotation:t,spacing:e,effectiveSpacingAfterDynamicScaling:i,numericSpacingInputShouldBeVisible:r,unit:a="meters"}=this.viewModel,p=this.messagesUnits.units[a].abbr,c=this.viewModel.gridControlsEnabled,d=i!=null&&i!==this.viewModel.spacing,_=`__spacing_input_scaled-${this.id}`;return s("div",{class:this.classes(b.numericInputsContainer)},[r?s("calcite-label",{scale:"s"},s("span",null,this.messages.inputLabel.spacing,d?s("calcite-icon",{class:this.classes(b.inlineIcon),icon:S.warning,id:_,scale:"s",tabIndex:0}):void 0),s("div",{class:b.suffixedInputContainer},s("calcite-input-number",{disabled:!c,numberButtonType:"none",suffixText:p,value:`${e==null?void 0:e.toFixed(2)}`,onCalciteInputNumberChange:({target:h})=>{const w=parseFloat(h.value);this.viewModel.spacing=w,w!==this.viewModel.spacing&&(h.value=`${this.viewModel.spacing}`)}}),d?s("calcite-tooltip",{overlayPositioning:"fixed",placement:"leading",referenceElement:_},Z(this.messages.warnings.dynamicSpacing,{actualSpacingIncludingUnit:it(this.messagesUnits,i,a,2,"plural")})):void 0)):void 0,s("calcite-label",{scale:"s"},this.messages.inputLabel.angle,s("calcite-input-number",{disabled:!c,integer:!0,numberButtonType:"none",suffixText:this.messagesUnits.units.degrees.abbr,value:`${F(t)}`,onCalciteInputNumberChange:({target:h})=>this.viewModel.rotation=xt(h.value)}))])}_renderIntervalInput(){const{majorLineInterval:t,gridControlsEnabled:e}=this.viewModel;return s("div",{class:this.classes(b.numericInputsContainer)},s("calcite-label",{scale:"s"},this.messages.inputLabel.interval,s("calcite-input-number",{disabled:!e,integer:!0,max:15,min:1,numberButtonType:"vertical",value:`${t}`,onCalciteInputNumberChange:({target:i})=>{const r=Number.parseInt(i.value,10);this.viewModel.majorLineInterval=r,r!==this.viewModel.majorLineInterval&&(i.value=`${this.viewModel.majorLineInterval}`)}})))}_renderSnappingToggle(){const{snappingOptions:t,gridControlsEnabled:e}=this.viewModel;return s(I,{checked:!!((t==null?void 0:t.gridEnabled)??!1),disabled:!(e&&t),key:"grid-snap-enabled-toggle",label:this.messages.switchLabel.snap,onChange:i=>{var r;return(r=this.viewModel.snappingOptions)==null?void 0:r.set("gridEnabled",i)}})}_renderDynamicScaleToggle(){const{viewModel:t,messages:e}=this,i=this.visibleElements.outOfScaleWarning&&t.gridOutOfScale;return s(I,{checked:t.dynamicScaling,disabled:!t.gridControlsEnabled,hint:i?e.warnings.outOfScale:void 0,hintIcon:S.warning,hintKind:"warning",key:`grid-dynamic-scale-toggle-${this.id}`,label:e.switchLabel.scaling,onChange:r=>t.dynamicScaling=r})}_renderRotateToggle(){const{gridControlsEnabled:t,rotateWithMap:e}=this.viewModel;return s(I,{checked:e,disabled:!t,key:"grid-rotate-map-toggle",label:this.messages.switchLabel.rotateWithMap,onChange:i=>this.viewModel.rotateWithMap=i})}_renderEnabledToggle(){return s("div",{class:b.borderedSwitch},s(I,{checked:this.viewModel.displayEnabled,disabled:!!this.viewModel.interactivePlacementState,key:"grid-enabled-toggle",label:this.messages.switchLabel.display,onChange:t=>this.viewModel.trySetDisplayEnabled(t)}))}_renderColorSelection(){const{customColor:t}=this,e=`${this.id}--custom-grid-color-button`;return s("calcite-label",{scale:"s"},this.messages.inputLabel.theme,s("div",{class:b.tilegroup},[this._renderThemeTile({value:"dark"}),this._renderThemeTile({value:"light"}),this._renderThemeTile({value:"custom",id:e}),s("calcite-popover",{autoClose:!0,label:this.messages.gridLineColorPopoverLabel,overlayPositioning:"fixed",referenceElement:e},s("calcite-color-picker",{alphaChannel:!0,savedDisabled:!0,value:(t==null?void 0:t.toHex({digits:8}))??"#000000ff",onCalciteColorPickerChange:i=>{const r=v.fromHex(i.target.value);r&&(this.customColor=r,this.theme="custom")}}))]))}_renderThemeTile(t){const{theme:e}=this,{value:i}=t,r=this.messages.gridTheme[i],a=`${this.id}--theme_tile_${i}`,p=`${a}__label`,c=S.gridTheme[i],d=this.viewModel.gridControlsEnabled;return s("div",{class:st({[b.tile]:!0,[b.tileDisabled]:!d}),id:t.id,role:"button"},s("input",{"aria-labelledby":p,checked:e===i,disabled:!d,id:a,name:`${this.id}--theme`,onchange:_=>{var h;this.theme=i,(h=_.target)==null||h.focus()},tabIndex:0,type:"radio"}),s("div",{class:b.tileContent},s("calcite-icon",{icon:c,scale:"l"}),s("calcite-label",{for:a,id:p},r)))}};o([n()],m.prototype,"customColor",void 0),o([n()],m.prototype,"icon",null),o([n()],m.prototype,"label",null),o([n(),D("esri/widgets/support/GridControls/t9n/GridControls")],m.prototype,"messages",void 0),o([n(),D("esri/core/t9n/Units")],m.prototype,"messagesUnits",void 0),o([n()],m.prototype,"snappingManager",null),o([n()],m.prototype,"snappingOptions",null),o([n()],m.prototype,"theme",null),o([n()],m.prototype,"view",null),o([n({type:K})],m.prototype,"viewModel",void 0),o([n({type:H,nonNullable:!0})],m.prototype,"visibleElements",void 0),m=o([T("esri.widgets.support.GridControls")],m);const Zr=m;export{Zr as default};
