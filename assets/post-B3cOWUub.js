import{P as v}from"./cast-BA_-jlhc.js";import{r as i,m as a,a as f,s as c}from"./Accessor-BHnuXKD2.js";import{f as l,i as y,s as d}from"./utils-Cy8wFNQo.js";import{r as S}from"./serverVersionUtils-CT0ARoHu.js";import{S as j}from"./JSONSupport-CGdeqxpk.js";import"./index-tefRSezt.js";let t=class extends j{constructor(s){super(s),this.moment=null,this.success=!1}};i([a({type:Date,json:{type:Number,write:{writer:(s,r)=>{r.moment=s?s.getTime():null}}}})],t.prototype,"moment",void 0),i([a({type:Boolean,json:{write:!0}})],t.prototype,"success",void 0),t=i([f("esri.rest.versionManagement.gdbVersion.support.PostResult")],t);const N=t,n=new Map;async function $(s,r,o,u){n.has(s)||await S(n,s);const e=n.get(s);if(((e==null?void 0:e.serverVersion)??0)<=11.1)throw new c("post:enterprise-version","versioning API requires ArcGIS Enterprise version 11.2 or higher");if(!r)throw new c("post:missing-guid","guid for version is missing");const p=l(s),m=o.toJSON();o.rows&&(m.rows=JSON.stringify(o.rows));const w=y(p.query,{query:d({...m,f:"json"}),...u,method:"post"});r.startsWith("{")&&(r=r.slice(1,-1));const g=`${p.path}/versions/${r}/post`,{data:h}=await v(g,w);return N.fromJSON(h)}export{$ as post,n as serverVersionCacheMap};
