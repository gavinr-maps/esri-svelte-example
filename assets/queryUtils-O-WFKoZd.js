const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./geometryEngineJSON-BwrklJA_.js","./geometryEngineBase-yFIvKOkM.js","./_commonjsHelpers-DCkdB7M8.js","./json-Wa8cmqdu.js"])))=>i.map(i=>d[i]);
import{_ as j}from"./index-Bh2oEzTI.js";import{n as v}from"./jsonMap-0cxwUWs2.js";import{af as Z,ag as A,s as c,ah as g,O as f,c as p,ai as N,P,a1 as h}from"./Point-Cg0-ChZE.js";import{O as R,N as T,J as B}from"./projection-B971H0Re.js";import{p as J}from"./Polyline-D9YkgmM_.js";import{f as E,m as _,y as L,s as q}from"./jsonUtils-CEfjT-BK.js";import{R as I}from"./normalizeUtils-EVmAQ-ak.js";import{O as k}from"./subclass-BZA_h8Db.js";import{L as D}from"./Accessor-BLX9ikPh.js";import{t as S}from"./json-Wa8cmqdu.js";const m=[0,0];function d(t,i){if(!i)return null;if("x"in i){const e={x:0,y:0};return[e.x,e.y]=t(i.x,i.y,m),i.z!=null&&(e.z=i.z),i.m!=null&&(e.m=i.m),e}if("xmin"in i){const e={xmin:0,ymin:0,xmax:0,ymax:0};return[e.xmin,e.ymin]=t(i.xmin,i.ymin,m),[e.xmax,e.ymax]=t(i.xmax,i.ymax,m),i.hasZ&&(e.zmin=i.zmin,e.zmax=i.zmax,e.hasZ=!0),i.hasM&&(e.mmin=i.mmin,e.mmax=i.mmax,e.hasM=!0),e}return"rings"in i?{rings:x(i.rings,t),hasM:i.hasM,hasZ:i.hasZ}:"paths"in i?{paths:x(i.paths,t),hasM:i.hasM,hasZ:i.hasZ}:"points"in i?{points:w(i.points,t),hasM:i.hasM,hasZ:i.hasZ}:null}function x(t,i){const e=[];for(const n of t)e.push(w(n,i));return e}function w(t,i){const e=[];for(const n of t){const r=i(n[0],n[1],[0,0]);e.push(r),n.length>2&&r.push(n[2]),n.length>3&&r.push(n[3])}return e}async function M(t,i){if(!t||!i)return;const e=Array.isArray(t)?t.map(n=>n.geometry!=null?n.geometry.spatialReference:null).filter(k):[t];await T(e.map(n=>({source:n,dest:i})))}const b=d.bind(null,Z),z=d.bind(null,A);function O(t,i,e,n){if(!t||(e||(e=i,i=t.spatialReference),!p(i)||!p(e)||c(i,e)))return t;if(g(i,e)){const r=f(e)?b(t):z(t);return r.spatialReference=e,r}return R(S,[t],i,e,null,n)[0]}class K{constructor(){this._jobs=[],this._timer=null,this._process=this._process.bind(this)}async push(i,e,n,r){if(!(i!=null&&i.length)||!e||!n||c(e,n))return i;const s={geometries:i,inSpatialReference:e,outSpatialReference:n,geographicTransformation:r,resolve:D()};return this._jobs.push(s),this._timer??(this._timer=setTimeout(this._process,10)),s.resolve.promise}_process(){this._timer=null;const i=this._jobs.shift();if(!i)return;const{geometries:e,inSpatialReference:n,outSpatialReference:r,resolve:s,geographicTransformation:o}=i;g(n,r)?f(r)?s(e.map(b)):s(e.map(z)):s(R(S,e,n,r,o,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}}const V=new K;function ot(t,i,e,n){return V.push(t,i,e,n)}const $=new v({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),y=Object.freeze({});async function lt(t,i,e){const{outFields:n,orderByFields:r,groupByFieldsForStatistics:s,outStatistics:o}=t;if(n)for(let a=0;a<n.length;a++)n[a]=n[a].trim();if(r)for(let a=0;a<r.length;a++)r[a]=r[a].trim();if(s)for(let a=0;a<s.length;a++)s[a]=s[a].trim();if(o)for(let a=0;a<o.length;a++)o[a].onStatisticField&&(o[a].onStatisticField=o[a].onStatisticField.trim());return t.geometry&&!t.outSR&&(t.outSR=t.geometry.spatialReference),C(t,i,e)}async function C(t,i,e){var s;if(!t)return null;let{where:n}=t;if(t.where=n=n==null?void 0:n.trim(),(!n||/^1 *= *1$/.test(n)||i&&i===n)&&(t.where=null),!t.geometry)return t;let r=await H(t);if(t.distance=0,t.units=null,t.spatialRel==="esriSpatialRelEnvelopeIntersects"){const{spatialReference:o}=t.geometry;r=J(r),r.spatialReference=o}if(r){await M(r.spatialReference,e),r=G(r,e);const o=(await I(E(r)))[0];if(o==null)throw y;const a="quantizationParameters"in t&&((s=t.quantizationParameters)==null?void 0:s.tolerance)||"maxAllowableOffset"in t&&t.maxAllowableOffset||0,U=a&&F(r,e)?{densificationStep:8*a}:void 0,u=o.toJSON(),l=O(u,u.spatialReference,e,U);if(!l)throw y;l.spatialReference=e,t.geometry=l}return t}function F(t,i){if(!t)return!1;const e=t.spatialReference;return(_(t)||L(t)||q(t))&&!c(e,i)&&!B(e,i)}function G(t,i){const e=t.spatialReference;return F(t,i)&&_(t)?{spatialReference:e,rings:[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]}:t}async function H(t){const{distance:i,units:e}=t,n=t.geometry;if(i==null||"vertexAttributes"in n)return n;const r=n.spatialReference,s=e?$.fromJSON(e):N(r),o=r&&(P(r)||f(r))?n:await M(r,h).then(()=>O(n,h));return(await Q())(o.spatialReference,o,i,s)}async function Q(){return(await j(async()=>{const{geodesicBuffer:t}=await import("./geometryEngineJSON-BwrklJA_.js").then(i=>i.g);return{geodesicBuffer:t}},__vite__mapDeps([0,1,2,3]),import.meta.url)).geodesicBuffer}export{$ as R,lt as S,C as a,ot as b,y as g,O as j,M as x};
