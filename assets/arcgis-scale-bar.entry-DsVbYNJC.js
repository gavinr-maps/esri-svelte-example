import{r as C,c as g,f as v,h as r,g as y}from"./index-Bh2oEzTI.js";import{g as p}from"./globalCss-0ea08e9e-ByuaaWTq.js";import{u as B,m as L}from"./useViewModel-5eedd1c7-Chco_mlm.js";import{h as d,a3 as S,i as w,a4 as U,a5 as $}from"./index-5cc0d3e9-BXwdUzLn.js";import{l as f}from"./index-ee4c09de-CPW6V7nq.js";import{u as M,g as D}from"./index-69f02a9e-wRYZXCy2.js";import"./component-utils-42b12dba-BfugynV_.js";/*!
 * All material copyright Esri, All Rights Reserved, unless otherwise specified.
 * See https://js.arcgis.com/4.31/esri/copyright.txt for details.
 * v4.31.2
 */const s="esri-scale-bar",t={base:s,labelContainer:`${s}__label-container`,rulerLabelContainer:`${s}__label-container--ruler`,lineLabelContainer:`${s}__label-container--line`,topLabelContainer:`${s}__label-container--top`,bottomLabelContainer:`${s}__label-container--bottom`,label:`${s}__label`,line:`${s}__line`,topLine:`${s}__line--top`,bottomLine:`${s}__line--bottom`,ruler:`${s}__ruler`,rulerBlock:`${s}__ruler-block`,barContainer:`${s}__bar-container`,rulerBarContainer:`${s}__bar-container--ruler`,lineBarContainer:`${s}__bar-container--line`};function _(e=0,i=0){return{x:e,y:i}}const R=L(S),E=class{constructor(e){C(this,e),this.arcgisReady=g(this,"arcgisReady",7),this.manager=M(this),this.messages=B(),this.reactiveUtils=f(w),this.intlUtils=f(U),this.unitUtils=f($),this.viewModel=R(this),this._scaleComputedFrom=_(),this.autoDestroyDisabled=!1,this.icon="actual-size",this.label=void 0,this.position="top-left",this.referenceElement=void 0,this.barStyle="line",this.unit=D(void 0,{set:i=>i??this._defaultUnit})}componentDidLoad(){this._defaultUnit=this.unitUtils.getDefaultUnitForView(this.viewModel.view),this.unit||(this.unit=this._defaultUnit),this.manager.onLifecycle(()=>this.reactiveUtils.watch(()=>{const e=this.viewModel.view;return[e==null?void 0:e.stationary,e==null?void 0:e.center,e==null?void 0:e.scale,e==null?void 0:e.zoom]},([e])=>{e&&v(this)}))}async destroy(){await this.manager.destroy()}componentDidRender(){this._handleRootCreateOrUpdate()}render(){const e=this.viewModel.state==="disabled",i={[p.disabled]:e};let l,o;if(!e){const{unit:a,barStyle:c}=this,m=a==="imperial"||a==="dual",b=a==="metric"||a==="dual",u=100,h=a==="dual"?"line":c;if(m){const n=this.viewModel.getScaleBarProperties(u,"imperial");n&&(o=h==="ruler"?this._renderRuler(n):this._renderLine(n,"bottom"))}if(b){const n=this.viewModel.getScaleBarProperties(u,"metric");n&&(l=h==="ruler"?this._renderRuler(n):this._renderLine(n,"top"))}}return r("div",{key:"96d4fda4bf925e44d31cc6b8d5ac995f52c378fc",ref:a=>a?this._handleRootCreateOrUpdate():void 0,class:d(t.base,p.widget,i)},l,o)}_renderRuler(e){const{length:i,unit:l,value:o}=e,a=Math.round(i),c=this._formatDistance(o,l);return r("div",{class:d(t.barContainer,t.rulerBarContainer)},r("div",{class:t.ruler,style:{width:`${a}px`}},r("div",{class:t.rulerBlock}),r("div",{class:t.rulerBlock}),r("div",{class:t.rulerBlock}),r("div",{class:t.rulerBlock})),r("div",{class:d(t.labelContainer,t.rulerLabelContainer)},r("div",{class:t.label},"0"),r("div",{class:t.label},c)))}_renderLine(e,i){const{length:l,unit:o,value:a}=e,c=Math.round(l),m=this._formatDistance(a,o),b={[t.topLabelContainer]:i==="top",[t.bottomLabelContainer]:i==="bottom"},u=r("div",{class:d(t.labelContainer,t.lineLabelContainer,b)},r("div",{class:t.label},m)),h={[t.topLine]:i==="top",[t.bottomLine]:i==="bottom"},n=r("div",{class:d(t.line,h),style:{width:`${c}px`}});return r("div",{class:d(t.barContainer,t.lineBarContainer)},[n,u])}_handleRootCreateOrUpdate(){if(!this.viewModel)return;const e=this._scaleComputedFrom,i=this.el.getBoundingClientRect(),l=i.left+window.pageXOffset,o=i.top+window.pageYOffset,a=_(l,o);(a.x!==e.x||a.y!==e.y)&&(this._scaleComputedFrom=a)}_formatDistance(e,i){return this.intlUtils.formatNumber(e,{style:"unit",unit:i,unitDisplay:"short"})}static get assetsDirs(){return["assets"]}get el(){return y(this)}};export{E as arcgis_scale_bar};
