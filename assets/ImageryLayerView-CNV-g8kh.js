import{r as i}from"./tslib.es6-B3Jf3DVX.js";import{m as n,a as g,b as v}from"./subclass-BZA_h8Db.js";import{s as x}from"./Accessor-BLX9ikPh.js";import{j as u}from"./Point-Cg0-ChZE.js";import{i as E}from"./timeSupport-CXKPoROL.js";import{b as $}from"./Query-5Xpquc1r.js";import{p as b}from"./popupUtils-BaLxn3kI.js";const L=l=>{let t=class extends l{constructor(){super(...arguments),this.view=null}get timeExtent(){var e;return E(this.layer,(e=this.view)==null?void 0:e.timeExtent,this._get("timeExtent"))}async fetchPopupFeaturesAtLocation(e,r){const{layer:o}=this;if(!e)throw new v("imagerylayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:o});const{popupEnabled:c}=o,p=b(o,r);if(!c||p==null)return[];const y=await p.getRequiredFields();x(r);const s=new $;s.timeExtent=this.timeExtent,s.geometry=e,s.outFields=y,s.outSpatialReference=e.spatialReference;const{resolution:a,spatialReference:m}=this.view,h=this.view.type==="2d"?new u(a,a,m):new u(.5*a,.5*a,m),{returnTopmostRaster:w,showNoDataRecords:d}=p.layerOptions||{returnTopmostRaster:!0,showNoDataRecords:!1},f={returnDomainValues:!0,returnTopmostRaster:w,pixelSize:h,showNoDataRecords:d,signal:r==null?void 0:r.signal};return o.queryVisibleRasters(s,f).then(R=>R)}canResume(){var e;return!!super.canResume()&&!((e=this.timeExtent)!=null&&e.isEmpty)}};return i([n()],t.prototype,"layer",void 0),i([n()],t.prototype,"suspended",void 0),i([n({readOnly:!0})],t.prototype,"timeExtent",null),i([n()],t.prototype,"view",void 0),t=i([g("esri.views.layers.ImageryLayerView")],t),t};export{L as m};
