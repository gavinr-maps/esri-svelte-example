import{j as B,C as Gt,e as g,aF as st,aG as h,q as bt,aD as $,aH as Ht,aI as Wt,g as Yt,aJ as p,aA as rt,aK as Kt,Z as Zt,Y as lt,aL as Jt,b as Qt,n as Et,v as Xt,aM as At,at as Tt,aN as te,m as ee,a as se,aO as re,a4 as ct,aP as ne}from"./subclass-BZA_h8Db.js";const ut=new WeakMap;function ie(e,t,s=!1){const r=`🛑 DEPRECATED - ${t}`;if(!s)return void e.warn(r);let n=ut.get(e);n||(n=new Set,ut.set(e,n)),n.has(t)||(n.add(t),e.warn(r))}function oe(e,t,s={}){if(B("esri-deprecation-warnings")){const{moduleName:r}=s;nt(e,`Function: ${(r?r+"::":"")+t+"()"}`,s)}}function as(e,t,s={}){if(B("esri-deprecation-warnings")){const{moduleName:r}=s;nt(e,`Property: ${(r?r+"::":"")+t}`,s)}}function ls(e,t,s={}){B("esri-deprecation-warnings")&&nt(e,`Multiple argument constructor: ${t}`,{warnOnce:!0,replacement:`new ${t}({ <your properties here> })`,...s})}function nt(e,t,s={}){if(B("esri-deprecation-warnings")){const{replacement:r,version:n,see:i,warnOnce:a}=s;let o=t;r&&(o+=`
	🛠️ Replacement: ${r}`),n&&(o+=`
	⚙️ Version: ${n}`),i&&(o+=`
	🔗 See ${i} for more details.`),ie(e,o,a)}}function cs(e){const t=[];return function*(){yield*t;for(const s of e)t.push(s),yield s}}function us(e,t){for(const s of e)if(s!=null&&t(s))return s}function ht(e){return e!=null&&typeof e[Symbol.iterator]=="function"}let it=class{constructor(){this._groups=new Map}destroy(){this.removeAll()}get size(){let t=0;return this._groups.forEach(s=>{t+=s.length}),t}add(t,s){if(ht(t)){const r=this._getOrCreateGroup(s);for(const n of t)dt(n)&&r.push(n)}else dt(t)&&this._getOrCreateGroup(s).push(t);return this}forEach(t,s){if(typeof t=="function")this._groups.forEach(r=>r.forEach(t));else{const r=this._getGroup(t);r&&s&&r.forEach(s)}}has(t){return this._groups.has(O(t))}remove(t){if(typeof t!="string"&&ht(t)){for(const s of t)this.remove(s);return this}return this.has(t)?(ft(this._getGroup(t)),this._groups.delete(O(t)),this):this}removeAll(){return this._groups.forEach(ft),this._groups.clear(),this}removeReference(t){return this._groups.delete(t),this}_getOrCreateGroup(t){if(this.has(t))return this._getGroup(t);const s=[];return this._groups.set(O(t),s),s}_getGroup(t){return this._groups.get(O(t))}};function O(e){return e||"_default_"}function ft(e){for(const t of e)t instanceof it?t.removeAll():t.remove()}function dt(e){return e!=null&&(!!e.remove||e instanceof it)}function fs(e,t){if(e==null)throw new Error(t??"value is None")}function ae(e){return e==null||e.destroy(),null}function ds(e){return e==null||e.dispose(),null}function le(e){return e==null||e.remove(),null}function _s(e){return e==null||e.abort(),null}function ps(e){return e==null||e.release(),null}function gs(e,t,s){return e!=null&&t!=null?s!=null?s(e,t):e.equals(t):e===t}function ms(e,t){return e==null?void 0:e[t]}function vs(e,t){let s;return e.some((r,n)=>(s=t(r,n),s!=null)),s??void 0}function ce(e){return(e==null?void 0:e.release)&&typeof e.release=="function"}function ue(e){return(e==null?void 0:e.acquire)&&typeof e.acquire=="function"}let F=class H{constructor(t,s,r,n=1,i=0){this._ctor=t,this._acquireFunction=s,this._releaseFunction=r,this.allocationSize=n,this._pool=new Array(i),this._initialSize=i;for(let a=0;a<i;a++)this._pool[a]=new this._ctor;this.allocationSize=Math.max(n,1)}destroy(){this.prune(0)}acquire(...t){let s;if(H.test.disabled)s=new this._ctor;else{if(this._pool.length===0){const r=this.allocationSize;for(let n=0;n<r;n++)this._pool[n]=new this._ctor}s=this._pool.pop()}return this._acquireFunction?this._acquireFunction(s,...t):ue(s)&&s.acquire(...t),s}release(t){t&&!H.test.disabled&&(this._releaseFunction?this._releaseFunction(t):ce(t)&&t.release(),this._pool.push(t))}prune(t=this._initialSize){if(!(t>=this._pool.length)){for(let s=t;s<this._pool.length;++s){const r=this._pool[s];this._dispose(r)}this._pool.length=t}}_dispose(t){t.dispose&&typeof t.dispose=="function"&&t.dispose()}};F.test={disabled:!1};let he=class{constructor(t,s){this._observers=t,this._observer=s}remove(){Gt(this._observers,this._observer)}},fe=class{constructor(){this._observers=null,this.destroyed=!1}observe(t){if(this.destroyed||t.destroyed)return de;this._observers==null&&(this._observers=[]);const s=this._observers;let r=!1,n=!1;const i=s.length;for(let a=0;a<i;++a){const o=s[a];if(o.destroyed)n=!0;else if(o===t){r=!0;break}}return r||(s.push(t),n&&this._removeDestroyedObservers()),new he(s,t)}_removeDestroyedObservers(){const t=this._observers;if(!t||t.length===0)return;const s=t.length;let r=0;for(let n=0;n<s;++n){for(;n+r<s&&t[n+r].destroyed;)++r;if(r>0){if(!(n+r<s))break;t[n]=t[n+r]}}t.length=s-r}destroy(){if(this.destroyed)return;this.destroyed=!0;const t=this._observers;if(t!=null){for(const s of t)s.onCommitted();this._observers=null}}};const de=g();var f;(function(e){e[e.DEFAULTS=0]="DEFAULTS",e[e.COMPUTED=1]="COMPUTED",e[e.SERVICE=2]="SERVICE",e[e.PORTAL_ITEM=3]="PORTAL_ITEM",e[e.WEB_SCENE=4]="WEB_SCENE",e[e.WEB_MAP=5]="WEB_MAP",e[e.LINK_CHART=6]="LINK_CHART",e[e.USER=7]="USER"})(f||(f={}));const ws=f.USER+1;function _e(e){switch(e){case"defaults":return f.DEFAULTS;case"service":return f.SERVICE;case"portal-item":return f.PORTAL_ITEM;case"web-scene":return f.WEB_SCENE;case"web-map":return f.WEB_MAP;case"link-chart":return f.LINK_CHART;case"user":return f.USER;default:return null}}function W(e){switch(e){case f.DEFAULTS:return"defaults";case f.SERVICE:return"service";case f.PORTAL_ITEM:return"portal-item";case f.WEB_SCENE:return"web-scene";case f.WEB_MAP:return"web-map";case f.LINK_CHART:return"link-chart";case f.USER:return"user"}}function bs(e){return W(e)}let _t=class extends fe{constructor(t,s){super(),this.propertyName=t,this.metadata=s,this.trackingTarget=new st(this),this.flags=0,this.flags=h.Dirty|(s.nonNullable?h.NonNullable:0)|(s.hasOwnProperty("value")?h.HasDefaultValue:0)|(s.get===void 0?h.DepTrackingInitialized:0)|(s.dependsOn===void 0?h.AutoTracked:0)}destroy(){this.flags&h.Dirty&&this.onCommitted(),super.destroy(),this.trackingTarget.destroy()}getComputed(t){t.mutable&&bt(this);const s=t.store,r=this.propertyName,n=this.flags,i=s.get(r);if(n&h.Computing||~n&h.Dirty&&s.has(r))return i;this.flags|=h.Computing;const a=t.host;let o;n&h.AutoTracked?o=$(this.trackingTarget,this.metadata.get,a):(Ht(a,this),o=this.metadata.get.call(a)),this.flags|=h.DepTrackingInitialized,s.set(r,o,f.COMPUTED);const l=s.get(r);return l===i?this.flags&=~h.Dirty:Wt(this.commit,this),this.flags&=~h.Computing,l}notifyChange(){this.onInvalidated(),this.onCommitted()}invalidate(){this.onInvalidated()}commit(){this.flags&=~h.Dirty,this.onCommitted()}onInvalidated(){~this.flags&h.Overridden&&(this.flags|=h.Dirty);const t=this._observers;if(t&&t.length>0)for(const s of t)s.onInvalidated()}onCommitted(){const t=this._observers;if(t&&t.length>0){const s=t.slice();for(const r of s)r.onCommitted()}}},pe=class St{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(t){const s=new St;return this._values.forEach((r,n)=>{t&&t.has(n)||s.set(n,Yt(r))}),s}get(t){return this._values.get(t)}originOf(){return f.USER}keys(){return[...this._values.keys()]}set(t,s){this._values.set(t,s)}delete(t){this._values.delete(t)}has(t){return this._values.has(t)}forEach(t){this._values.forEach(t)}};function C(e,t,s){return e!==void 0}function pt(e,t,s,r){return e!==void 0&&(!(s==null&&e.flags&h.NonNullable)||(r.lifecycle,p.INITIALIZING,!1))}let ge=class{constructor(t){this.host=t,this.propertiesByName=new Map,this.ctorArgs=null,this.lifecycle=p.INITIALIZING,this.store=new pe,this.mutable=!0,this._origin=f.USER;const s=this.host.constructor.__accessorMetadata__;for(const r in s){const n=new _t(r,s[r]);this.propertiesByName.set(r,n)}this.metadata=s}initialize(){this.lifecycle=p.CONSTRUCTING}constructed(){this.lifecycle=p.CONSTRUCTED}destroy(){this.lifecycle=p.DESTROYED,this.propertiesByName.forEach(t=>t.destroy())}get initialized(){return this.lifecycle!==p.INITIALIZING}get(t){const s=this.propertiesByName.get(t);if(s.metadata.get)return s.getComputed(this);this.mutable&&bt(s);const r=this.store;return r.has(t)?r.get(t):s.metadata.value}originOf(t){const s=this.store.originOf(t);if(s===void 0){const r=this.propertiesByName.get(t);if(r!==void 0&&r.flags&h.HasDefaultValue)return"defaults"}return W(s)}has(t){return this.propertiesByName.has(t)&&this.store.has(t)}keys(){return[...this.propertiesByName.keys()]}internalGet(t){const s=this.propertiesByName.get(t);if(C(s))return this.store.has(t)?this.store.get(t):s.metadata.value}internalSet(t,s){const r=this.propertiesByName.get(t);C(r)&&this._internalSet(r,s)}getDependsInfo(t,s,r){const n=this.propertiesByName.get(s);if(!C(n))return"";const i=new st,a=$(i,()=>{var u;return(u=n.metadata.get)==null?void 0:u.call(t)});let o=`${r}${t.declaredClass.split(".").pop()}.${s}: ${a}
`;const l=i.accessed??new Set;if(l.size===0)return o;r+="  ";for(const u of l)u instanceof _t&&(o+=`${r}${u.propertyName}: undefined
`);return o}setAtOrigin(t,s,r){const n=this.propertiesByName.get(t);if(C(n))return this._setAtOrigin(n,s,r)}isOverridden(t){const s=this.propertiesByName.get(t);return s!==void 0&&!!(s.flags&h.Overridden)}clearOverride(t){const s=this.propertiesByName.get(t);s&&s.flags&h.Overridden&&(s.flags&=~h.Overridden,s.notifyChange())}override(t,s){const r=this.propertiesByName.get(t);if(!pt(r,t,s,this))return;const n=r.metadata.cast;if(n){const i=this._cast(n,s),{valid:a,value:o}=i;if(V.release(i),!a)return;s=o}r.flags|=h.Overridden,this._internalSet(r,s)}set(t,s){const r=this.propertiesByName.get(t);if(!pt(r,t,s,this))return;const n=r.metadata.cast;if(n){const a=this._cast(n,s),{valid:o,value:l}=a;if(V.release(a),!o)return;s=l}const i=r.metadata.set;i?i.call(this.host,s):this._internalSet(r,s)}setDefaultOrigin(t){this._origin=_e(t)}getDefaultOrigin(){return W(this._origin)}notifyChange(t){const s=this.propertiesByName.get(t);s!==void 0&&s.notifyChange()}invalidate(t){const s=this.propertiesByName.get(t);s!==void 0&&s.invalidate()}commit(t){const s=this.propertiesByName.get(t);s!==void 0&&s.commit()}_internalSet(t,s){const r=this.lifecycle!==p.INITIALIZING?this._origin:f.DEFAULTS;this._setAtOrigin(t,s,r)}_setAtOrigin(t,s,r){const n=this.store,i=t.propertyName;n.has(i,r)&&rt(s,n.get(i))&&~t.flags&h.Overridden&&r===n.originOf(i)||(t.invalidate(),n.set(i,s,r),t.commit(),Kt(this.host,t))}_cast(t,s){const r=V.acquire();return r.valid=!0,r.value=s,t&&(r.value=t.call(this.host,s,r)),r}},me=class{constructor(){this.value=null,this.valid=!0}acquire(){this.valid=!0}release(){this.value=null}};const V=new F(me);let ve;function ye(){return ve}var gt;(function(e){e[e.Ignore=0]="Ignore",e[e.Destroy=1]="Destroy",e[e.ThrowError=2]="ThrowError"})(gt||(gt={}));function $e(e){e.length=0}let kt=class{constructor(t=50,s=50){this._pool=new F(Array,void 0,$e,s,t)}acquire(){return this._pool.acquire()}release(t){this._pool.release(t)}prune(){this._pool.prune(0)}static acquire(){return x.acquire()}static release(t){return x.release(t)}static prune(){x.prune()}};const x=new kt(100);let we=class extends F{constructor(){super(...arguments),this._set=new Set}destroy(){super.destroy(),this._set=null}acquire(...t){const s=super.acquire(...t);return this._set.delete(s),s}release(t){t&&!this._set.has(t)&&(super.release(t),this._set.add(t))}_dispose(t){this._set.delete(t),super._dispose(t)}};const N=[];function Ot(e){N.push(e),N.length===1&&queueMicrotask(()=>{const t=N.slice();N.length=0;for(const s of t)s()})}let Ct=class{constructor(t,s=30){this.name=t,this._counter=0,this._samples=new Array(s)}push(t){t!=null&&(this._samples[++this._counter%this._samples.length]=t)}set(t){t!=null&&(this._samples[this._counter%this._samples.length]=t)}get median(){return this._samples.slice().sort((t,s)=>t-s)[Math.floor(this._samples.length/2)]}get average(){return this._samples.reduce((t,s)=>t+s,0)/this._samples.length}get last(){return this._samples[this._counter%this._samples.length]}};var Y;(function(e){const t=(i,a,o,l)=>{let u=a,c=a;const _=o>>>1,d=i[u-1];for(;c<=_;){c=u<<1,c<o&&l(i[c-1],i[c])<0&&++c;const b=i[c-1];if(l(b,d)<=0)break;i[u-1]=b,u=c}i[u-1]=d},s=(i,a)=>i<a?-1:i>a?1:0;function r(i,a,o,l){a===void 0&&(a=0),o===void 0&&(o=i.length),l===void 0&&(l=s);for(let c=o>>>1;c>a;c--)t(i,c,o,l);const u=a+1;for(let c=o-1;c>a;c--){const _=i[a];i[a]=i[c],i[c]=_,t(i,u,c,l)}}function*n(i,a,o,l){a===void 0&&(a=0),o===void 0&&(o=i.length),l===void 0&&(l=s);for(let c=o>>>1;c>a;c--)t(i,c,o,l),yield;const u=a+1;for(let c=o-1;c>a;c--){const _=i[a];i[a]=i[c],i[c]=_,t(i,u,c,l),yield}}e.sort=r,e.iterableSort=n})(Y||(Y={}));const mt=Y,be=1.5,Ee=1.1;let Nt=class{constructor(t){this.data=[],this._length=0,this._allocator=void 0,this._deallocator=()=>null,this._shrink=()=>{},this._hint=new Zt,t&&(t.initialSize&&(this.data=new Array(t.initialSize)),t.allocator&&(this._allocator=t.allocator),t.deallocator!==void 0&&(this._deallocator=t.deallocator),t.shrink&&(this._shrink=()=>vt(this)))}toArray(){return this.data.slice(0,this.length)}filter(t){const s=new Array;for(let r=0;r<this._length;r++){const n=this.data[r];t(n)&&s.push(n)}return s}at(t){if((t=Math.trunc(t)||0)<0&&(t+=this._length),!(t<0||t>=this._length))return this.data[t]}includes(t,s){const r=this.data.indexOf(t,s);return r!==-1&&r<this.length}get length(){return this._length}set length(t){if(t>this._length){if(this._allocator){for(;this._length<t;)this.data[this._length++]=this._allocator(this.data[this._length]);return}this._length=t}else{if(this._deallocator)for(let s=t;s<this._length;++s)this.data[s]=this._deallocator(this.data[s]);this._length=t,this._shrink()}}clear(){this.length=0}prune(){this.clear(),this.data=[]}push(t){this.data[this._length++]=t}pushArray(t,s=t.length){for(let r=0;r<s;r++)this.data[this._length++]=t[r]}fill(t,s){for(let r=0;r<s;r++)this.data[this._length++]=t}pushNew(){this._allocator&&(this.data[this.length]=this._allocator(this.data[this.length]));const t=this.data[this._length];return++this._length,t}unshift(t){this.data.unshift(t),this._length++,vt(this)}pop(){if(this.length===0)return;const t=this.data[this.length-1];return this.length=this.length-1,this._shrink(),t}remove(t){const s=lt(this.data,t,this.length,this._hint);if(s!==-1)return this.data.splice(s,1),this.length=this.length-1,t}removeUnordered(t){return this.removeUnorderedIndex(lt(this.data,t,this.length,this._hint))}removeUnorderedIndex(t){if(!(t>=this.length||t<0))return this.swapElements(t,this.length-1),this.pop()}removeUnorderedMany(t,s=t.length,r){this.length=Jt(this.data,t,this.length,s,this._hint,r),this._shrink()}front(){if(this.length!==0)return this.data[0]}back(){if(this.length!==0)return this.data[this.length-1]}swapElements(t,s){if(t>=this.length||s>=this.length||t===s)return;const r=this.data[t];this.data[t]=this.data[s],this.data[s]=r}sort(t){mt.sort(this.data,0,this.length,t)}iterableSort(t){return mt.iterableSort(this.data,0,this.length,t)}some(t,s){for(let r=0;r<this.length;++r)if(t.call(s,this.data[r],r,this.data))return!0;return!1}find(t,s){const{data:r,length:n}=this;for(let i=0;i<n;++i)if(t.call(s,r[i]))return r[i]}filterInPlace(t,s){let r=0;for(let n=0;n<this._length;++n){const i=this.data[n];t.call(s,i,n,this.data)&&(this.data[n]=this.data[r],this.data[r]=i,r++)}if(this._deallocator)for(let n=r;n<this._length;n++)this.data[n]=this._deallocator(this.data[n]);return this._length=r,this._shrink(),this}forAll(t,s){const{data:r,length:n}=this;for(let i=0;i<n;++i)t.call(s,r[i],i,r)}forEach(t,s){this.data.slice(0,this.length).forEach(t,s)}map(t,s){const r=new Array(this.length);for(let n=0;n<this.length;++n)r[n]=t.call(s,this.data[n],n,this.data);return r}reduce(t,s){let r=s;for(let n=0;n<this.length;++n)r=t(r,this.data[n],n,this.data);return r}has(t){const s=this.length,r=this.data;for(let n=0;n<s;++n)if(r[n]===t)return!0;return!1}*[Symbol.iterator](){for(let t=0;t<this.length;t++)yield this.data[t]}};function vt(e){e.data.length>be*e.length&&(e.data.length=Math.floor(e.length*Ee))}function Ae(e){return{setTimeout:(t,s)=>{const r=e.setTimeout(t,s);return g(()=>e.clearTimeout(r))}}}const Te=Ae(globalThis);function It(e){return Se(e)||Dt(e)}function Se(e){return e!=null&&typeof e=="object"&&"on"in e&&typeof e.on=="function"}function Dt(e){return e!=null&&typeof e=="object"&&"addEventListener"in e&&typeof e.addEventListener=="function"}function qt(e,t,s){if(!It(e))throw new TypeError("target is not a Evented or EventTarget object");return Dt(e)?ke(e,t,s):e.on(t,s)}function ke(e,t,s,r){if(Array.isArray(t)){const n=t.slice();for(const i of n)e.addEventListener(i,s,r);return g(()=>{for(const i of n)e.removeEventListener(i,s,r)})}return e.addEventListener(t,s,r),g(()=>e.removeEventListener(t,s,r))}function Rt(e,t,s){if(!It(e))throw new TypeError("target is not a Evented or EventTarget object");if("once"in e)return e.once(t,s);const r=qt(e,t,n=>{r.remove(),s.call(e,n)});return r}function Ns(e,t,s){let r=!1;const n=qt(e,t,i=>{r||s.call(e,i)});return{resume(){r=!1},pause(){r=!0},remove(){n.remove()}}}function A(e="Aborted"){return new Qt("AbortError",e)}function Mt(e,t="Aborted"){if(Pt(e))throw A(t)}function L(e){return e instanceof AbortSignal?e:(e==null?void 0:e.signal)??void 0}function Pt(e){const t=L(e);return t!=null&&t.aborted}function Is(e){if(j(e))throw e}function Ds(e){if(!j(e))throw e}function R(e,t){const s=L(e);if(s!=null){if(!s.aborted)return Rt(s,"abort",()=>t());t()}}function qs(e,t){const s=L(e);if(s!=null)return Mt(s),Rt(s,"abort",()=>t(A()))}function Rs(e,t){return L(t)==null?e:new Promise((s,r)=>{let n=R(t,()=>r(A()));const i=()=>{n=le(n)};e.then(i,i),e.then(s,r)})}function j(e){return(e==null?void 0:e.name)==="AbortError"}async function Ms(e){try{return await e}catch(t){if(!j(t))throw t;return}}async function Ps(e,t=Et.getLogger("esri")){try{return await e}catch(s){j(s)||t.error(s)}}async function Oe(e){if(!e)return;if(typeof e.forEach!="function"){const s=Object.keys(e),r=s.map(a=>e[a]),n=await Oe(r),i={};return s.map((a,o)=>i[a]=n[o]),i}const t=e;return Promise.allSettled(t).then(s=>Array.from(t,(r,n)=>{const i=s[n];return i.status==="fulfilled"?{promise:r,value:i.value}:{promise:r,error:i.reason}}))}async function Us(e){return(await Promise.allSettled(e)).filter(t=>t.status==="fulfilled").map(t=>t.value)}async function zs(e){return(await Promise.allSettled(e)).filter(t=>t.status==="rejected").map(t=>t.reason)}function Ce(e,t=void 0,s){const r=new AbortController;return R(s,()=>r.abort()),new Promise((n,i)=>{let a=setTimeout(()=>{a=0,n(t)},e);R(r,()=>{a&&(clearTimeout(a),i(A()))})})}function Bs(e,t){const s=new AbortController,r=setTimeout(()=>s.abort(),t);return R(e,()=>{s.abort(),clearTimeout(r)}),{...e,signal:s.signal}}function Ne(e){return e&&typeof e.then=="function"}function yt(e){return Ne(e)?e:Promise.resolve(e)}function Fs(e,t=-1){let s,r,n,i,a=null;const o=(...l)=>{if(s){r=l,i&&i.reject(A()),i=K();const d=i.promise;if(a){const b=a;a=null,b.abort()}return d}if(n=i||K(),i=null,t>0){const d=new AbortController;s=yt(e(...l,d.signal));const b=s;Ce(t).then(()=>{s===b&&(i?d.abort():a=d)})}else s=1,s=yt(e(...l));const u=()=>{const d=r;r=n=s=a=null,d!=null&&o(...d)},c=s,_=n;return c.then(u,u),c.then(_.resolve,_.reject),_.promise};return o}function K(){let e,t;const s=new Promise((n,i)=>{e=n,t=i}),r=n=>{e(n)};return r.resolve=n=>e(n),r.reject=n=>t(n),r.timeout=(n,i)=>Te.setTimeout(()=>r.reject(i),n),r.promise=s,r}function Ls(e,t){return e.then(t,t)}async function js(e){await Promise.resolve(),Mt(e)}function Vs(e){return e}function xs(e){return 1e3*e}function Gs(e){return e}function Hs(e){return .001*e}let Ie=class{constructor(t){this.phases=t,this.paused=!1,this.ticks=-1,this.removed=!1}},De=class{constructor(t){this.callback=t,this.isActive=!0}remove(){this.isActive=!1}},Z=0,J=0;const T={time:0,deltaTime:0,elapsedFrameTime:0,frameDuration:0},Q=["prepare","preRender","render","postRender","update","finish"],X=[],w=new Nt;class qe{constructor(t){this._task=t}remove(){this._task.removed=!0}pause(){this._task.paused=!0}resume(){this._task.paused=!1}}function Re(){y!=null&&(cancelAnimationFrame(y),y=requestAnimationFrame(ot))}const M={frameTasks:w,willDispatch:!1,clearFrameTasks:Pe,dispatch:zt,executeFrameTasks:Ue,reschedule:Re};function Me(e){const t=new De(e);return X.push(t),M.willDispatch||(M.willDispatch=!0,Ot(zt)),t}function Ks(e){const t=new Ie(e);return w.push(t),y==null&&(Z=performance.now(),y=requestAnimationFrame(ot)),new qe(t)}let y=null;function Pe(e=!1){w.forAll(t=>{t.removed=!0}),e&&Ut()}function Zs(e){J=Math.max(0,e)}function ot(){const e=performance.now();y=null,y=w.length>0?requestAnimationFrame(ot):null,M.executeFrameTasks(e)}function Ue(e){const t=e-Z;Z=e;const s=J>0?J:1e3/60,r=Math.max(0,t-s);T.time=e,T.frameDuration=s-r;for(let n=0;n<Q.length;n++){const i=performance.now(),a=Q[n];w.forAll(o=>{var l;o.paused||o.removed||(n===0&&o.ticks++,o.phases[a]&&(T.elapsedFrameTime=performance.now()-e,T.deltaTime=o.ticks===0?0:t,(l=o.phases[a])==null||l.call(o,T)))}),Fe[n].push(performance.now()-i)}Ut(),Le.push(performance.now()-e)}const I=new Nt;function Ut(){w.forAll(e=>{e.removed&&I.push(e)}),w.removeUnorderedMany(I.data,I.length),I.clear()}function zt(){for(;X.length;){const e=X.shift();e.isActive&&e.callback()}M.willDispatch=!1}function ze(e=1,t){const s=K(),r=()=>{Pt(t)?s.reject(A()):e===0?s():(--e,Ot(()=>r()))};return r(),s.promise}function Be(e){return ze(1,e)}async function Js(e){await Be(e),await new Promise(t=>requestAnimationFrame(()=>{e!=null&&e.aborted||t()}))}const Fe=Q.map(e=>new Ct(e)),Le=new Ct("total");function je(e,t){for(const s of e.values())if(t(s))return!0;return!1}function $t(e,t){if(!t)return e;for(const s of t)s!=null&&e.add(s);return e}function Qs(e,t){return t!=null&&e.add(t),e}function Ve(e,t){const s=new Set;return $t(s,e),$t(s,t),s}function xe(e,t){const s=new Set;for(const r of t)e.has(r)&&s.add(r);return s}function Xs(e,t){if(!e||!t)return!1;if(e===t)return!0;for(const s of e)if(!t.has(s))return!1;return!0}function tr(e,t){if(e==null&&t==null)return!0;if(e==null||t==null||e.size!==t.size)return!1;for(const s of e)if(!t.has(s))return!1;return!0}function Ge(e,t){const s=new Set(e);for(const r of t)s.delete(r);return s}function er(e,t){return Ge(Ve(e,t),xe(e,t))}function sr(e){let t;for(t of e);return t}let He=0;const rr=0;function G(){return++He}class at extends st{constructor(t){super(new We(t)),this._observer&&wt.register(this,new WeakRef(this._observer),this)}destroy(){var t,s;this._observer&&wt.unregister(this._observer),(t=this.accessed)==null||t.clear(),this.clear(),(s=this._observer)==null||s.destroy()}}let We=class{constructor(t){this._notify=t,this._invalidCount=0,this.destroyed=!1}onInvalidated(){this._invalidCount++}onCommitted(){if(this.destroyed)return;const t=this._invalidCount;if(t===1)return this._invalidCount=0,void this._notify();this._invalidCount=t>0?t-1:0}destroy(){this.destroyed=!0,this._notify=Ye}};const wt=new FinalizationRegistry(e=>{var t;(t=e.deref())==null||t.destroy()});function Ye(){}let E=!1;const P=[];function Bt(e,t){let s=new at(i),r=null,n=!1;function i(){if(!s||n)return;if(E)return void Lt(i);const o=r;s.clear(),E=!0,n=!0,r=$(s,e),n=!1,E=!1,t(r,o),jt()}function a(){s&&(s.destroy(),s=null,r=null)}return n=!0,r=$(s,e),n=!1,g(a)}function Ft(e,t){let s=new at(n),r=null;function n(){t(r,a)}function i(){s&&(s.destroy(),s=null),r=null}function a(){return s?(s.clear(),r=$(s,e),r):null}return a(),g(i)}function ir(e,t){let s=!1,r=!1;const n=!!(t!=null&&t.sync);let i=new at(()=>{s||r||(r=!0,n?a():queueMicrotask(a))});function a(){r=!1,i&&!s&&(E?Lt(a):(i.clear(),E=!0,s=!0,$(i,e),s=!1,E=!1,jt()))}function o(){i&&(i.destroy(),i=null)}return s=!0,$(i,e),s=!1,g(o)}function Lt(e){P.includes(e)||P.unshift(e)}function jt(){for(;P.length;)P.pop()()}var S;(function(e){e[e.Untracked=0]="Untracked",e[e.Tracked=1]="Tracked"})(S||(S={}));let k=class{constructor(){this.uid=G(),this.removed=!1,this.type=null,this.oldValue=null,this.callback=null,this.getValue=null,this.target=null,this.path=null,this.equals=null}static acquireUntracked(t,s,r,n,i){return this.pool.acquire(S.Untracked,t,s,r,n,i,rt)}static acquireTracked(t,s,r,n){return this.pool.acquire(S.Tracked,t,s,r,null,null,n)}notify(t,s){this.type===S.Untracked?this.callback.call(this.target,t,s,this.path,this.target):this.callback.call(null,t,s,void 0,void 0)}acquire(t,s,r,n,i,a,o){this.uid=G(),this.removed=!1,this.type=t,this.oldValue=s,this.callback=r,this.getValue=n,this.target=i,this.path=a,this.equals=o}release(){this.target=this.path=this.oldValue=this.callback=this.getValue=null,this.uid=G(),this.removed=!0}};k.pool=new we(k);const D=new kt,v=new Set;let U;function z(e){v.delete(e),v.add(e),U||(U=Me(Je))}function Ke(e){if(e.removed)return;const t=e.oldValue,s=e.getValue();e.equals(t,s)||(e.oldValue=s,e.notify(s,t))}function Ze(e){for(const t of v.values())t.target===e&&(t.removed=!0)}function Je(){let e=10;for(;U&&e--;){U=null;const t=Qe(),s=D.acquire();for(const r of t){const n=r.uid;Ke(r),n===r.uid&&r.removed&&s.push(r)}for(const r of v)r.removed&&(s.push(r),v.delete(r));for(const r of s)k.pool.release(r);D.release(s),D.release(t),tt.forEach(r=>r())}}function Qe(){const e=D.acquire();e.length=v.size;let t=0;for(const s of v)e[t]=s,++t;return v.clear(),e}const tt=new Set;function ar(e){return tt.add(e),g(()=>tt.delete(e))}function Xe(e,t,s){let r=At(e,t,s,(n,i,a)=>{let o,l,u=Ft(()=>Tt(n,i),(c,_)=>{var d;((d=n.__accessor__)==null?void 0:d.lifecycle)===p.DESTROYED||o&&o.uid!==l?r.remove():(o||(o=k.acquireUntracked(c,a,_,n,i),l=o.uid),z(o))});return g(()=>{u.remove(),o&&(o.uid!==l||o.removed||(o.removed=!0,z(o)),o=null),r=u=null})});return r}function ts(e,t,s){const r=At(e,t,s,(n,i,a)=>{let o=!1;return Bt(()=>Tt(n,i),(l,u)=>{n.__accessor__.lifecycle!==p.DESTROYED?o||(o=!0,rt(u,l)||a.call(n,l,u,i,n),o=!1):r.remove()})});return r}function es(e,t,s,r=!1){return e.__accessor__&&e.__accessor__.lifecycle!==p.DESTROYED?r?ts(e,t,s):Xe(e,t,s):g()}function ss(e,t,s){let r,n,i=Ft(e,(a,o)=>{r&&r.uid!==n?i.remove():(r||(r=k.acquireTracked(a,t,o,s),n=r.uid),z(r))});return g(()=>{i.remove(),r&&(r.uid!==n||r.removed||(r.removed=!0,z(r)),r=null),i=null})}function rs(e,t,s){let r=!1;return Bt(e,(n,i)=>{r||(r=!0,s(i,n)||t(n,i),r=!1)})}function lr(e,t,s=!1,r=Xt){return s?rs(e,t,r):ss(e,t,r)}function cr(e){return je(v,t=>t.oldValue===e)}var Vt,xt;function ns(e){var t;if(e==null)return{value:e};if(Array.isArray(e))return{type:[e[0]],value:null};switch(typeof e){case"object":return(t=e.constructor)!=null&&t.__accessorMetadata__||e instanceof Date?{type:e.constructor,value:e}:e;case"boolean":return{type:Boolean,value:e};case"string":return{type:String,value:e};case"number":return{type:Number,value:e};case"function":return{type:e,value:null};default:return}}const m=Symbol("Accessor-Handles"),et=Symbol("Accessor-Initialized");let is=class q{static createSubclass(t={}){if(Array.isArray(t))throw new Error("Multi-inheritance unsupported since 4.16");const{properties:s,declaredClass:r,constructor:n}=t;delete t.declaredClass,delete t.properties,delete t.constructor;const i=this;class a extends i{constructor(...l){super(...l),this.inherited=null,n&&n.apply(this,l)}}te(a.prototype);for(const o in t){const l=t[o];a.prototype[o]=typeof l=="function"?function(...u){const c=this.inherited;let _;this.inherited=function(...d){if(i.prototype[o])return i.prototype[o].apply(this,d)};try{_=l.apply(this,u)}catch(d){throw this.inherited=c,d}return this.inherited=c,_}:t[o]}for(const o in s){const l=ns(s[o]);ee(l)(a.prototype,o)}return se(r)(a)}static freeze(t){return t instanceof q?t.__accessor__.mutable=!1:Object.freeze(t),t}static isFrozen(t){return t instanceof q?!t.__accessor__.mutable:Object.isFrozen(t)}constructor(...t){var r;if(this[Vt]=null,this[xt]=!1,this.constructor===q)throw new Error("[accessor] cannot instantiate Accessor. This can be fixed by creating a subclass of Accessor");const s=new ge(this);Object.defineProperty(this,"__accessor__",{enumerable:!1,value:s}),t.length>0&&(s.ctorArgs=((r=this.normalizeCtorArgs)==null?void 0:r.apply(this,t))??t[0])}postscript(){const t=this.__accessor__,s=t.ctorArgs;t.initialize(),s&&(this.set(s),t.ctorArgs=null),t.constructed(),this.initialize(),this[et]=!0}initialize(){}[re](){this[m]=ae(this[m])}destroy(){var t;this.destroyed||(Ze(this),this.__accessor__.destroy(),(t=ye())==null||t.onInstanceDestroy(this))}[Symbol.dispose](){this.destroy()}get constructed(){return this.__accessor__&&this.__accessor__.initialized||!1}get initialized(){return this[et]}get destroyed(){var t;return((t=this.__accessor__)==null?void 0:t.lifecycle)===p.DESTROYED||!1}commitProperty(t){ct(this,t)}get(t){return oe(Et.getLogger(this),"`Accessor.get` is deprecated in favor of using optional chaining",{version:"4.28",see:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Optional_chaining"}),ct(this,t)}hasOwnProperty(t){return this.__accessor__?this.__accessor__.has(t):Object.prototype.hasOwnProperty.call(this,t)}keys(){return this.__accessor__?this.__accessor__.keys():[]}set(t,s){return ne(this,t,s),this}watch(t,s,r){return es(this,t,s,r)}addHandles(t,s){if(this.destroyed){const r=Array.isArray(t)?t:[t];for(const n of r)n.remove();return}(this[m]??(this[m]=new it)).add(t,s)}removeHandles(t){var s;(s=this[m])==null||s.remove(t)}removeAllHandles(){var t;(t=this[m])==null||t.removeAll()}removeHandlesReference(t){var s;(s=this[m])==null||s.removeReference(t)}hasHandles(t){var s;return((s=this[m])==null?void 0:s.has(t))===!0}_override(t,s){s===void 0?this.__accessor__.clearOverride(t):this.__accessor__.override(t,s)}_clearOverride(t){return this.__accessor__.clearOverride(t)}_overrideIfSome(t,s){s==null?this.__accessor__.clearOverride(t):this.__accessor__.override(t,s)}_isOverridden(t){return this.__accessor__.isOverridden(t)}notifyChange(t){this.__accessor__.notifyChange(t)}_get(t){return this.__accessor__.internalGet(t)}_set(t,s){return this.__accessor__.internalSet(t,s),this}};Vt=m,xt=et;const ur=Object.freeze(Object.defineProperty({__proto__:null,default:is},Symbol.toStringTag,{value:"Module"}));export{ws as $,nt as A,ds as B,Fs as C,Rs as D,_e as E,ps as F,js as G,gs as H,Ce as I,cs as J,us as K,K as L,Vs as M,W as N,Us as O,zs as P,kt as Q,ht as R,Ne as S,Ot as T,Ds as U,oe as V,it as W,Ks as X,as as Y,xs as Z,Gs as _,G as a,ms as a0,ze as a1,Ps as a2,Ct as a3,yt as a4,Js as a5,Ve as a6,tr as a7,Xs as a8,Ge as a9,xe as aa,Te as ab,Ns as ac,je as ad,we as ae,ar as af,cr as ag,L as ah,Rt as ai,bs as aj,Ls as ak,$t as al,Qs as am,at as an,sr as ao,Be as ap,Bs as aq,er as ar,Hs as as,rr as at,Zs as au,ur as av,is as b,j as c,f as d,_s as e,lr as f,It as g,qt as h,Pt as i,Ms as j,ir as k,le as l,R as m,fs as n,ls as o,Is as p,ae as q,fe as r,Mt as s,Nt as t,A as u,F as v,qs as w,Me as x,Oe as y,vs as z};
