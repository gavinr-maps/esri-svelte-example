const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./calcite-checkbox-B8olv0Y9.js","./jsxFactory-CJa39Fro.js","./tslib.es6-B3Jf3DVX.js","./intl-CChhNOV8.js","./date-DlqISzcw.js","./jsonMap-0cxwUWs2.js","./subclass-BZA_h8Db.js","./locale-C9TlLpzi.js","./messages-OmQvZhAg.js","./Accessor-BLX9ikPh.js","./assets-C43MgM-v.js","./index-Bh2oEzTI.js","./index-2kwcjS9-.css","./Evented-BHRw9x22.js","./Promise-B2Hu02L7.js","./reactiveUtils-C5zUhJQJ.js","./asyncUtils-CWX51uTe.js","./Collection-CEdjem1-.js","./shared-B3wH2qpO.js","./SimpleObservable-KocWTzVy.js","./uuid-fwrPAdZb.js","./cast-Bjksrh93.js","./dom-D_AJDzAj.js","./form-BZPQ5PUM.js","./interactive-y84HQRWL.js","./key-D63ExP77.js","./label-DEe8AW1C.js","./component-6CIDVndn.js","./loadable-DM18hPdE.js","./calcite-label-B1FxWqaL.js","./calcite-tree-t1yeFqKD.js","./calcite-tree-item-Dn1N35sO.js","./conditionalSlot-R5D9krYS.js","./observers-D2xgmA06.js","./icon-BQO9J86c.js","./calcite-fab-CKoU_mWy.js","./button-9P4PM9SO.js","./locale-A4FuYD8q.js","./t9n-D0ry3MEw.js","./loader-C-zIPscB.js","./calcite-action-Bys6x4p_.js","./action-D0Er9Ef6.js","./calcite-loader-DP4PIFO8.js"])))=>i.map(i=>d[i]);
import{_ as L}from"./index-Bh2oEzTI.js";import{r as l}from"./tslib.es6-B3Jf3DVX.js";import{m as o,a as m,a7 as Oe,n as De}from"./subclass-BZA_h8Db.js";import{s as Re}from"./cast-Bjksrh93.js";import{B,r as D,n as a,m as Ae,u as Ie,e as ae,l as T}from"./jsxFactory-CJa39Fro.js";import{b as J,s as me,c as se,h as A}from"./Accessor-BLX9ikPh.js";import{V as N}from"./Collection-CEdjem1-.js";import{n as le}from"./collectionUtils-D_lHIu88.js";import{watch as b,initial as $,whenOnce as G}from"./reactiveUtils-C5zUhJQJ.js";import{c as _e,a as He,i as We,$ as Te,f as ze}from"./BuildingSceneLayer-BINyBR7D.js";import{n as Ue}from"./uuid-fwrPAdZb.js";import{r as he}from"./mathUtils-C4_ghTv4.js";import{e as W}from"./globalCss-CZa70j6i.js";import{e as X}from"./Heading-C-odFCu-.js";import"./intl-CChhNOV8.js";import"./date-DlqISzcw.js";import"./jsonMap-0cxwUWs2.js";import"./locale-C9TlLpzi.js";import"./messages-OmQvZhAg.js";import"./assets-C43MgM-v.js";import"./Evented-BHRw9x22.js";import"./Promise-B2Hu02L7.js";import"./shared-B3wH2qpO.js";import"./SimpleObservable-KocWTzVy.js";import"./asyncUtils-CWX51uTe.js";import"./CollectionFlattener-CQN6i8ZK.js";import"./loadAll-B6mYSptb.js";import"./Loadable-BabW5Xcc.js";import"./MultiOriginJSONSupport-B5nfqtQh.js";import"./writer-DNAwXnhG.js";import"./Point-Cg0-ChZE.js";import"./Layer-CVt7Hb5J.js";import"./geometry-D964gYQX.js";import"./Extent-Bf3YTe7m.js";import"./Polyline-D9YkgmM_.js";import"./Identifiable-B1UbsKNt.js";import"./TimeExtent-DocT5yPf.js";import"./timeUtils-8fb_2oAt.js";import"./BuildingComponentSublayer-BK6r0wKX.js";import"./Graphic-DsxsIjhH.js";import"./PopupTemplate-BHMhS05j.js";import"./Clonable-D3rtuBWg.js";import"./fieldUtils-tmQlKvWo.js";import"./enumeration-Ba5njXdz.js";import"./Color-BCS62Hs5.js";import"./colorUtils-0bJDPow9.js";import"./ActionToggle-iT4slXc7.js";import"./symbols-CNimns--.js";import"./TextSymbol-D8QO_KUV.js";import"./screenUtils-_ZIvrt5o.js";import"./materialUtils-DarhapKC.js";import"./opacityUtils-C68Tlu6_.js";import"./vec3f64-BLpZdpfb.js";import"./aaBoundingBox-BE7cC1jD.js";import"./persistableUrlUtils-fa1mAujs.js";import"./Portal-C10FKnaA.js";import"./jsonUtils-CEfjT-BK.js";import"./ClassBreaksRenderer-BuHwSyVK.js";import"./UniqueValueRenderer-BQtAHUSo.js";import"./diffUtils-BP7jmOAy.js";import"./colorRamps-pKd7I5WZ.js";import"./SizeVariable-936USOrb.js";import"./sizeVariableUtils-Cmcuvw-4.js";import"./visualVariableUtils-DX1kS9Se.js";import"./compilerUtils-Dw3R0f-Z.js";import"./lengthUtils-DL1-FDQQ.js";import"./ColorStop-Dk3U5tCk.js";import"./jsonUtils-Ds2Sqto-.js";import"./layerUtils-BrNoooE9.js";import"./defaults-DZ1kfMRx.js";import"./defaultsJSON-GKolV7NZ.js";import"./RendererLegendOptions-B-4se3aU.js";import"./styleUtils-BYTm14n3.js";import"./jsonUtils-DxpLMo6d.js";import"./LRUCache-B_PHMSGm.js";import"./MemCache-Dx1v3xLC.js";import"./Version-BSlAgupz.js";import"./FieldsIndex-DpwHKAMX.js";import"./UnknownTimeZone-BkowvBs8.js";import"./OverrideHelper-ti072FkP.js";import"./colorUtils-aL8wj-8G.js";import"./vec42-YcqnINSP.js";import"./common-DQOJ18NT.js";import"./vec4f64-o2zAXfmz.js";import"./utils-D2PLyMFF.js";import"./enums-CmIX1y88.js";import"./quantizationUtils-uj_P09aO.js";import"./HeatmapColorStop-BJc5nbwr.js";import"./heatmapUtils-Dwiv9IEa.js";import"./SimpleRenderer-BV2L9G_n.js";import"./FeatureLayer-wa_7EIxE.js";import"./layerContainerType-C5CzMsLd.js";import"./FeatureLayerBase-Ck7-w8TE.js";import"./formUtils-ylzKAM7E.js";import"./Field-ybkHhtnK.js";import"./fieldType-BuzM0UHS.js";import"./HeightModelInfo-9nOoV6LU.js";import"./arcgisLayerUrl-BX1FE5Hm.js";import"./commonProperties-CPyIG_-u.js";import"./ElevationInfo-CA5m_tHv.js";import"./unitConversionUtils-BMfW9yAe.js";import"./AttributeTableTemplate-BZeVyq-j.js";import"./featureLayerUtils-DBsQMhTm.js";import"./featureQueryAll-DnVoEjkM.js";import"./Query-5Xpquc1r.js";import"./DataLayerSource-BKkswDvG.js";import"./FullTextSearch-Csd1Hktu.js";import"./AttachmentQuery-BUlkjzkx.js";import"./RelationshipQuery-DPPNeuLK.js";import"./LayerFloorInfo-CIQjg5Vk.js";import"./Relationship-COPq3qM4.js";import"./serviceCapabilitiesUtils-DAE5z8FP.js";import"./workers-D4HfeYKj.js";import"./Queue-yu3bZ02p.js";import"./editsZScale-Bs7_pSzI.js";import"./queryZScale-w66xFVGx.js";import"./projection-B971H0Re.js";import"./projectBuffer-Bs7GwaPY.js";import"./geodesicConstants-DWQLYX7F.js";import"./FeatureSet-BHEkYP03.js";import"./APIKeyMixin-Di9kcRBS.js";import"./ArcGISService-B5qxetOY.js";import"./BlendLayer-CXM4n_Ge.js";import"./jsonUtils-CSnQD004.js";import"./parser-CTsgEym6.js";import"./utils-93yNk4Xc.js";import"./mat4f32-DcsiF_Rp.js";import"./mat4-GpOFENPA.js";import"./CustomParametersMixin-B4u7wiBT.js";import"./EditBusLayer-DoTks2sU.js";import"./FeatureEffectLayer-CpM66wLd.js";import"./FeatureEffect-BEzQmzeC.js";import"./FeatureFilter-BMHRQSxq.js";import"./FeatureReductionLayer-Ddbk727V.js";import"./FeatureReductionSelection-7vaL4DYT.js";import"./labelingInfo-DYPSPZCH.js";import"./labelUtils-B8petyBk.js";import"./MD5-C9MwAd2G.js";import"./OperationalLayer-CVyVfSPu.js";import"./OrderedLayer-C5VLMHgA.js";import"./OrderByInfo-IYmS1EXF.js";import"./PortalLayer-CKja4bdW.js";import"./PortalItem-DzgXrpyc.js";import"./portalItemUtils-BzVoFAku.js";import"./RefreshableLayer-D7lXUJRS.js";import"./ScaleRangeLayer-Bb8Ig1Hz.js";import"./TemporalLayer-Dpq2hKKV.js";import"./TimeInfo-LUiaSFyX.js";import"./TimeInterval-CNlkea1s.js";import"./FeatureTemplate-CssMa1yk.js";import"./FeatureType-C0q_coeM.js";import"./fieldProperties-Cgxj08ZE.js";import"./versionUtils-CQ_WhYSP.js";import"./styleUtils-KMFBtb6u.js";import"./popupUtils-BBuPGAHd.js";import"./AlphaCutoff-UcccL64p.js";import"./interfaces-CL2NbQte.js";import"./capabilities-Y9lFlGVh.js";import"./I3SIndexInfo-CzWbq05q.js";import"./I3SLayerDefinitions-BZ_CeKMl.js";import"./I3SUtil-BALmNw_P.js";import"./mat4f64-Dk4dwAN8.js";import"./vec32-Dvg_eL9J.js";import"./projectVectorToVector-G2uWGoIb.js";import"./projectPointToVector-GINIbYMz.js";import"./sphere-C77djCO6.js";import"./mat3-BRl2i9Bz.js";import"./mat3f64-BBpwCtoL.js";import"./plane-IENfwZlB.js";import"./quatf64-CCm9z-pX.js";import"./vec2f64-miziP1SN.js";import"./mathUtils-BG-eq9fO.js";import"./I3SBinaryReader-D1r70N_w.js";import"./VertexAttribute-Cq4MnHjR.js";import"./computeTranslationToOriginAndRotation-Q27G6TBL.js";import"./edgeUtils-BUKTgPFR.js";import"./floatRGBA-CfH_2xsy.js";import"./DecodeSymbolColor.glsl-BPIX0fAF.js";import"./interfaces-DDtDqZYj.js";import"./Matrix3DrawUniform-CiBFaSz6.js";import"./BindType-BmZEZMMh.js";import"./Float4DrawUniform-N58YDhuZ.js";import"./orientedBoundingBox-DOAJUK5g.js";import"./quat-4pa1e6ds.js";import"./spatialReferenceEllipsoidUtils-DBE_OFra.js";import"./ViewingMode-Dodu7ZZk.js";import"./layerViewUtils-DhFEu8Rd.js";import"./popupUtils-BaLxn3kI.js";import"./BuildingGroupSublayer-CjfizLnN.js";import"./SceneService-DR5HS-bd.js";import"./originUtils-D69mHv66.js";import"./multiOriginJSONSupportUtils-C0wm8_Yw.js";import"./jsonContext-DueMnVx9.js";import"./resourceUtils-BZzv7-k7.js";import"./resourceUtils-VfNT3fc0.js";import"./saveUtils-gB1pYTqT.js";import"./associatedFeatureServiceUtils-CXx2I5Ic.js";import"./elevationInfoUtils-BC_66_Fg.js";const Ke="overview",ge=t=>e=>{const i=t.toLowerCase();return e.sublayers.find(s=>{var r;return((r=s.modelName)==null?void 0:r.toLowerCase())===i})??null},ye=ge("fullmodel"),qe=ge(Ke);function je(t){const e=ye(t);e!=null&&(e.visible=!0);const i=qe(t);i!=null&&(i.visible=!1)}function ee(t,e){const i=Ge(t,e);if(i==null)return null;const s=i.fieldName;if(s==null||!s)return null;const r=Je(t,s),n=new Map;for(const h of i.mostFrequentValues??[])typeof h=="number"&&n.set(h,r!=null?r.getName(h):String(h));return{fieldName:s,fieldValueMap:n}}function Je(t,e){var i;for(const s of t.allSublayers.items){const r=s.type==="building-component"?(i=s.getFieldDomain)==null?void 0:i.call(s,e):null;if(r&&r.type==="coded-value")return r}return null}function Ge(t,e){var r;const i=((r=t.summaryStatistics)==null?void 0:r.fields)??[],s=e.toLowerCase();return i.find(n=>{var h;return((h=n.modelName)==null?void 0:h.toLowerCase())===s})??null}let v=class extends J{constructor(e){super(e),this.id="root",this.parent=null,this.children=new N,this.layers=new N,this.level=0,this._childIds=new Set,this._layerUniqueIds=new Set}initialize(){this.addHandles([this.layers.on("before-add",e=>{this._layerUniqueIds.has(e.item.uid)?e.preventDefault():this._layerUniqueIds.add(e.item.uid)}),this.layers.on("after-add",({item:e})=>{this.addHandles([b(()=>e.visible,()=>this.notifyChange("visible"),$),b(()=>e.title,()=>this.notifyChange("title"),$)],e.uid)}),this.layers.on("before-remove",({item:e})=>{this.removeHandles(e.uid),this.notifyChange("title"),this.notifyChange("visible")}),this.children.on("before-add",e=>{this._childIds.has(e.item.id)?e.preventDefault():(e.item._set("parent",this),this._childIds.add(e.item.id))})])}destroy(){this.children.forEach(e=>e.destroy())}get hasChildren(){return this.children.length>0}get isDiscipline(){return this.level===1}get visible(){return de(this.layers,e=>e.visible)}get title(){return de(this.layers,e=>e.title)||this.layers.items.map(e=>e.title).join(", ")||null}toggleVisibility(e){const i=e===void 0?!this.visible:e;this.layers.forEach(s=>{s.visible=i}),i&&this.parent!=null&&this.parent.toggleVisibility(!0)}toggleAllSiblingsVisibility(e){const i=e===void 0?!this.visible:e;this.toggleVisibility(i),this.parent!=null&&(this.parent.toggleVisibility(i),this.parent.children.forEach(s=>s.toggleVisibility(i)))}};function de(t,e){let i=null;for(const s of t.items){const r=e(s);if(i!=null&&i!==r)return null;i=r}return i}l([o({nonNullable:!0})],v.prototype,"id",void 0),l([o()],v.prototype,"parent",void 0),l([o({nonNullable:!0,readOnly:!0})],v.prototype,"children",void 0),l([o({nonNullable:!0,readOnly:!0})],v.prototype,"layers",void 0),l([o({nonNullable:!0})],v.prototype,"level",void 0),l([o({readOnly:!0})],v.prototype,"hasChildren",null),l([o({readOnly:!0})],v.prototype,"isDiscipline",null),l([o({readOnly:!0})],v.prototype,"visible",null),l([o({readOnly:!0})],v.prototype,"title",null),v=l([m("esri.widgets.BuildingExplorer.support.LayerTreeNode")],v);function re(){let t=new AbortController;return async e=>{t.abort(),t=new AbortController;const i={signal:t.signal},s=e.toArray().map(r=>Xe(r,i));await Promise.all(s),me(i)}}async function Xe(t,e){await t.load(e),await t.loadAll(),me(e),t.summaryStatistics&&await t.summaryStatistics.load(e)}let F=class extends J{constructor(e){super(e),this.root=new v,this.state="disabled",this._loadLayers=re(),this.layers=new N}initialize(){this.addHandles(this.layers.on("change",()=>this._onLayersChange())),this._onLayersChange()}destroy(){this._set("state","disabled"),this.root.destroy()}set layers(e){const i=this._get("layers");this._set("layers",le(e,i))}_updateLayerTree(){this.root.destroy(),this._set("root",new v);const e=new Map,i=this.layers.length>1?"modelName":"id";return this.layers.forEach(s=>{const r=ye(s);this._addNodesForSublayers(r??s,this.root,e,i)}),this}_addNodeForLayer(e,i,s,r){const n=String(e[r]).toLowerCase();if(n==null||e.isEmpty)return;const h=`${i.id}/${n}`;let p=s.get(h);p||(p=new v({id:n,level:i.level+1}),s.set(h,p)),p.layers.push(e),i.children.push(p),this._addNodesForSublayers(e,p,s,r)}_addNodesForSublayers(e,i,s,r){(e.type==="building-scene"||e.type==="building-group"&&!e.isEmpty)&&e.sublayers.forEach(n=>this._addNodeForLayer(n,i,s,r))}async _onLayersChange(){if(this._set("state","loading"),this.layers.length!==0)try{await this._loadLayers(this.layers),this._updateLayerTree(),this._set("state","ready")}catch(e){se(e)||this._set("state","failed")}}};l([o({readOnly:!0})],F.prototype,"root",void 0),l([o({type:N,nonNullable:!0})],F.prototype,"layers",null),l([o({readOnly:!0,nonNullable:!0})],F.prototype,"state",void 0),F=l([m("esri.widgets.BuildingExplorer.BuildingDisciplinesViewModel")],F);const fe=F;function j(t){const e={fieldValueMap:new Map,allowedValues:[]};for(const i of t){const s=i.fieldValueMap,r=e.fieldValueMap;s.forEach((n,h)=>{r.has(h)||(r.set(h,n),e.allowedValues.push(h))})}return e.allowedValues.sort((i,s)=>i-s),e}function Ye(t){let e=null;for(const i of t)e=e!=null?Math.min(e,i):i;return e}function Ze(t){let e=null;for(const i of t)e=e!=null?Math.max(e,i):i;return e}function Y(t,e){return e.allowedValues.length>0?Qe(t,e.allowedValues):null}function Qe(t,e){if(e.length===0)return t;if(t===1/0)return e[e.length-1];if(t===-1/0)return e[0];let i=e[0],s=Math.abs(i-t);for(const r of e){const n=Math.abs(r-t);n<s&&(i=r,s=n)}return i}let u=class extends J{constructor(e){super(e),this.state="disabled",this._valueBeforeReady=null,this._domainInfo=j([]),this._loadLayers=re(),this.layers=new N}initialize(){this.addHandles(this.layers.on("change",()=>this._onLayersChange())),this._onLayersChange()}destroy(){this._set("state","disabled")}get enabled(){return this.allowedValues.length>0&&this._get("enabled")}set enabled(e){e!==this.enabled&&this.allowedValues.length>0&&this._set("enabled",e)}get value(){return(this.state==="ready"?this._get("value"):this._valueBeforeReady)??0}set value(e){if(this.state!=="ready")return void(this._valueBeforeReady=e);if(e===this.value)return;const i=Y(e,this);i!=null&&this._set("value",i)}get min(){return Ye(this.allowedValues)}get max(){return Ze(this.allowedValues)}get allowedValues(){return this._domainInfo.allowedValues}set allowedValues(e){e==null?this._clearOverride("allowedValues"):this._override("allowedValues",e);const i=Y(this.value,this);i!=null&&(this.value=i)}get hasNext(){if(!this.enabled)return!0;const e=this._valueIndex;return e>=0&&e<this.allowedValues.length-1}get hasPrevious(){return!this.enabled||this._valueIndex>0}set layers(e){const i=this._get("layers");this._set("layers",le(e,i))}get filterExpressions(){return{solid:null,xRay:null}}get _valueIndex(){return Oe(this.allowedValues,this.value)}select(e){if(this.state!=="ready")return void(this._valueBeforeReady=e);Y(e,this)!=null&&(this.enabled=!0,this.value=e)}clear(){this.state==="ready"?this.enabled=!1:this._valueBeforeReady=null}next(){const{state:e,allowedValues:i,enabled:s,hasNext:r,_valueIndex:n}=this;if(e==="ready"||this._valueBeforeReady==null){if(i.length!==0)return s?void(r&&(this.value=i[n+1])):(this.enabled=!0,void(this.value=i[0]))}else this._valueBeforeReady++}previous(){const{state:e,allowedValues:i,enabled:s,hasPrevious:r,_valueIndex:n}=this;if(e==="ready"||this._valueBeforeReady==null){if(i.length!==0)return s?void(r&&(this.value=i[n-1])):(this.enabled=!0,void(this.value=i[i.length-1]))}else this._valueBeforeReady++}getValueLabel(e){return this.layers.length===0?null:this._domainInfo.fieldValueMap.get(e)??null}async _onLayersChange(){if(this._set("state","loading"),this._domainInfo=j([]),this.layers.length!==0)try{await this._loadLayers(this.layers),this._setup()}catch(e){se(e)||this._set("state","failed")}}};l([o({value:!1,nonNullable:!0})],u.prototype,"enabled",null),l([o({nonNullable:!0})],u.prototype,"value",null),l([o({readOnly:!0})],u.prototype,"min",null),l([o({readOnly:!0})],u.prototype,"max",null),l([o()],u.prototype,"allowedValues",null),l([o({readOnly:!0})],u.prototype,"hasNext",null),l([o({readOnly:!0})],u.prototype,"hasPrevious",null),l([o({type:N,nonNullable:!0})],u.prototype,"layers",null),l([o({nonNullable:!0})],u.prototype,"state",void 0),l([o()],u.prototype,"_valueBeforeReady",void 0),l([o({readOnly:!0})],u.prototype,"_valueIndex",null),l([o()],u.prototype,"_domainInfo",void 0),u=l([m("esri.widgets.BuildingExplorer.BuildingNumericFilterViewModel")],u);const be=u,we="__BUILDING_EXPLORER_FILTER__";function et(){return`${Ue()}${we}`}function te(t){const e=typeof t=="string"?t:t.id;return!!e&&e.includes(we)}function $e(t,e){for(const i of t.items)for(const s of i.filters.items){if(!te(s))continue;const r=e(s);if(r!=null)return r}return null}function tt(t,e){t.forEach(i=>{const s=i.filters.filter(n=>!te(n));e!=null&&s.push(e),it(i.filters,s)||(i.filters=s);const r=i.filters.find(n=>te(n));i.activeFilterId=r!=null?r.id:null})}function it(t,e){const i=e.length;if(t==null||t.length!==i)return!1;for(let s=0;s<i;++s){const r=e.at(s).toJSON(),n=t.at(s).toJSON();if(r.id="",n.id="",JSON.stringify(r)!==JSON.stringify(n))return!1}return!0}function st(t){const e=Le(t);return e?new _e({filterExpression:e,filterMode:new He}):null}function lt(t){const e=Le(t);return e?new _e({filterExpression:e,filterMode:new We}):null}function Le(t){return t.filter(e=>!!e).map(e=>`(${e})`).join(" AND ")}const rt="bldglevel";let M=class extends be{constructor(){super(...arguments),this._levelFieldName=null,this._parseValueFromFilter=e=>{var r;const i=new RegExp(`${this._levelFieldName}\\s*=\\s*(\\d+)`,"gi"),s=new RegExp(`${this._levelFieldName}\\s*<\\s*(\\d+)`,"gi");for(const{filterMode:n,filterExpression:h}of((r=e.filterBlocks)==null?void 0:r.items)??[]){if(h==null)continue;let p=null;if(n.type==="solid"?p=i.exec(h):n.type==="x-ray"&&(p=s.exec(h)),p)return parseInt(p[1],10)}return null}}get filterExpressions(){return this.enabled&&this._levelFieldName?{xRay:`${this._levelFieldName} < ${this.value}`,solid:`${this._levelFieldName} = ${this.value}`}:{solid:null,xRay:null}}get _firstValue(){const e=this.allowedValues;return e.length>0?e[0]:0}_setup(){const e=[];this.layers.forEach(r=>{const n=ee(r,rt);n!=null&&(this._levelFieldName=n.fieldName,e.push(n))}),this._domainInfo=j(e);const i=this._valueBeforeReady;this._set("state","ready"),this._valueBeforeReady=null;const s=i??$e(this.layers,this._parseValueFromFilter);s!=null?this.select(s):(this.enabled=!1,this.value=this._firstValue)}};l([o({readOnly:!0})],M.prototype,"filterExpressions",null),l([o()],M.prototype,"_levelFieldName",void 0),l([o({readOnly:!0})],M.prototype,"_firstValue",null),M=l([m("esri.widgets.BuildingExplorer.BuildingLevel")],M);const xe=M,ot="demolishedphase",nt="createdphase";let S=class extends be{constructor(){super(...arguments),this._createdPhaseFieldName=null,this._demolishedPhaseFieldName=null,this._parseValueFromFilter=e=>{var h;const i=this._createdPhaseFieldName,s=new RegExp(`${i}\\s*<=\\s*(\\d+)\\s*OR\\s*${i}\\s*IS\\s*NULL`,"gi"),r=this._demolishedPhaseFieldName,n=new RegExp(`${r}\\s*>\\s*(\\d+)\\s*OR\\s*${r}\\s*IS\\s*NULL`,"gi");for(const{filterExpression:p}of((h=e.filterBlocks)==null?void 0:h.items)??[]){const R=p?s.exec(p)??n.exec(p):null;if(R)return parseInt(R[1],10)}return null}}get filterExpressions(){if(!this.enabled)return{solid:null,xRay:null};const e=[],i=this._createdPhaseFieldName;i&&e.push(`(${i} <= ${this.value} OR ${i} IS NULL)`);const s=this._demolishedPhaseFieldName;s&&e.push(`(${s} > ${this.value} OR ${s} IS NULL)`);const r=e.join(" AND ");return{solid:r,xRay:r}}get _lastValue(){const e=this.allowedValues;return e.length>0?e[e.length-1]:0}_setup(){const e=[];this.layers.forEach(s=>{const r=ee(s,nt);r!=null&&(this._createdPhaseFieldName=r.fieldName,e.push(r));const n=ee(s,ot);n!=null&&(this._demolishedPhaseFieldName=n.fieldName,e.push(n))}),this._domainInfo=j(e);const i=this._valueBeforeReady;if(this._set("state","ready"),this._valueBeforeReady=null,this.allowedValues.length>0){const s=i??$e(this.layers,this._parseValueFromFilter);this.select(s??this._lastValue)}else this.clear()}};l([o({readOnly:!0})],S.prototype,"filterExpressions",null),l([o()],S.prototype,"_createdPhaseFieldName",void 0),l([o()],S.prototype,"_demolishedPhaseFieldName",void 0),l([o({readOnly:!0})],S.prototype,"_lastValue",null),S=l([m("esri.widgets.BuildingExplorer.BuildingPhase")],S);const Ce=S;let g=class extends J{constructor(e){super(e),this.view=null,this.state="disabled",this.level=new xe,this.phase=new Ce,this.disciplines=new fe,this._loadLayers=re(),this.layers=new N}initialize(){this.addHandles([this.layers.on("change",()=>this._onLayersChange()),b(()=>({state:this.state,layers:this.layers,filter:this._filter}),({state:e,layers:i,filter:s})=>{e==="ready"&&tt(i,s)},{initial:!0})]),this._onLayersChange()}destroy(){this.level.destroyed||this.level.destroy(),this.phase.destroyed||this.phase.destroy(),this.disciplines.destroyed||this.disciplines.destroy()}get isSupported(){var e;return((e=this.view)==null?void 0:e.type)==="3d"}get layers(){return this._get("layers")}set layers(e){const i=e.filter(s=>s instanceof Te);i.length!==e.length&&De.getLogger(this).error("Some layers are not BuildingSceneLayers but only BuildingSceneLayers can be passed to the widget."),this._set("layers",le(i,this._get("layers")))}get _filter(){const e=this.level.filterExpressions,i=this.phase.filterExpressions,s=[],r=lt([e.solid,i.solid]);r!=null&&s.push(r);const n=st([e.xRay,i.xRay]);return n!=null&&s.push(n),s.length===0?null:new ze({id:et(),name:"Building Explorer Filter",filterBlocks:s})}async _onLayersChange(){const e=this.layers;if(this.level.layers=e,this.phase.layers=e,this.disciplines.layers=e,e.length!==0){this._set("state","loading");try{await this._loadLayers(e),await Promise.all([G(()=>this.level.state==="ready"),G(()=>this.phase.state==="ready"),G(()=>this.disciplines.state==="ready")]),e.forEach(je),this._set("state","ready")}catch(i){se(i)||this._set("state","failed")}}else this._set("state","disabled")}};l([o({value:null})],g.prototype,"view",void 0),l([o()],g.prototype,"isSupported",null),l([o({type:N,nonNullable:!0})],g.prototype,"layers",null),l([o({readOnly:!0})],g.prototype,"state",void 0),l([o({readOnly:!0,type:xe})],g.prototype,"level",void 0),l([o({readOnly:!0,type:Ce})],g.prototype,"phase",void 0),l([o({readOnly:!0,type:fe})],g.prototype,"disciplines",void 0),l([o()],g.prototype,"_filter",null),g=l([m("esri.widgets.BuildingExplorer.BuildingExplorerViewModel")],g);const Pe=g,x="esri-building-explorer",_={base:x,panelError:`${x}__panel--error`,loadingContainer:`${x}__loading-container`,content:`${x}__content`,section:`${x}__section`,levels:`${x}__levels`,phases:`${x}__phases`,disciplines:`${x}__disciplines`};var ie;const at={expand:"expand",collapse:"collapse",hideSublayer:"hideSublayer",showSublayer:"showSublayer"},Z="esri-building-disciplines-tree-node",pe={base:Z,label:`${Z}__label`,level:t=>`${Z}--level-${t}`};let k=ie=class extends B{constructor(t){super(t),this.messages=at,this.toggleSiblingsVisibility=!1,this._toggledAll=!1,this._onCheckboxClick=e=>{e.stopPropagation(),(e.metaKey||e.ctrlKey)&&this.toggleSiblingsVisibility&&(this.node.toggleAllSiblingsVisibility(),this._toggledAll=!0)},this._onCheckboxToggle=e=>{this._toggledAll?this._toggledAll=!1:this.node.toggleVisibility(e.target.checked)}}loadDependencies(){return D({checkbox:()=>L(()=>import("./calcite-checkbox-B8olv0Y9.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28]),import.meta.url),label:()=>L(()=>import("./calcite-label-B1FxWqaL.js"),__vite__mapDeps([29,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,26,22,27]),import.meta.url),tree:()=>L(()=>import("./calcite-tree-t1yeFqKD.js"),__vite__mapDeps([30,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22]),import.meta.url),"tree-item":()=>L(()=>import("./calcite-tree-item-Dn1N35sO.js"),__vite__mapDeps([31,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,32,33,24,27,34]),import.meta.url)})}render(){const{node:t,messages:e}=this;if(t.isDiscipline&&!t.hasChildren)return a("div",{key:`${t.id}-empty`});const i=t.visible,s=i===!0,r=i===null,n=s?e==null?void 0:e.hideSublayer:e==null?void 0:e.showSublayer;return a("div",{class:pe.base,key:t.id},a("calcite-tree-item",null,a("calcite-label",{class:pe.label,layout:"inline"},a("calcite-checkbox",{checked:s,indeterminate:r,label:n,onclick:this._onCheckboxClick,title:n,onCalciteCheckboxChange:this._onCheckboxToggle}),t.title),this._renderedChildren))}get _renderedChildren(){const{node:t}=this;if(!t.hasChildren)return null;const{messages:e}=this,{toggleSiblingsVisibility:i}=this;return a("calcite-tree",{slot:"children"},this.node.children.toArray().reverse().map(s=>a(ie,{messages:e,node:s,toggleSiblingsVisibility:i})))}};l([o({type:v})],k.prototype,"node",void 0),l([o()],k.prototype,"messages",void 0),l([o({nonNullable:!0})],k.prototype,"toggleSiblingsVisibility",void 0),l([o()],k.prototype,"_renderedChildren",null),k=ie=l([m("esri.widgets.BuildingExplorer.BuildingDisciplinesTree.BuildingDisciplinesNode")],k);const ht=k,dt={expand:"expand",collapse:"collapse",hideSublayer:"hideSublayer",showSublayer:"showSublayer"},pt={base:"esri-building-disciplines-tree"};let O=class extends B{constructor(e){super(e),this.toggleSiblingsVisibility=!1}loadDependencies(){return D({tree:()=>L(()=>import("./calcite-tree-t1yeFqKD.js"),__vite__mapDeps([30,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22]),import.meta.url)})}render(){const{vm:e}=this,i=this.toggleSiblingsVisibility,s=this.messages??dt;return a("div",{class:pt.base},a("calcite-tree",{scale:"s",selectionMode:"none"},e.root.children.toArray().reverse().map(r=>a(ht,{messages:s,node:r,toggleSiblingsVisibility:i}))))}};l([o()],O.prototype,"vm",void 0),l([o()],O.prototype,"messages",void 0),l([o()],O.prototype,"toggleSiblingsVisibility",void 0),O=l([m("esri.widgets.BuildingExplorer.BuildingDisciplinesTree.BuildingDisciplinesTree")],O);const ut=O,Ee=30,Ve=20,Ne=30,Se=10,K=20,q=2,ke=.035,Be=30,Fe=14,Me=80,ct=100,vt=40,mt=Object.freeze(Object.defineProperty({__proto__:null,alphaLevelDependencyFactor:Ne,alphaSpreadFactor:Se,levelHeightDefault:Fe,levelHoveredExtraHeight:Ee,levelHoveredExtraWidth:Ve,levelWidthConstant:vt,levelWidthMax:Me,levelWidthMin:Be,levelWidthNominator:ct,levelsMarginFactor:q,levelsPadding:K,levelsPointerAdjustment:ke},Symbol.toStringTag,{value:"Module"})),C="esri-building-level-picker",P={container:C,noLevel:`${C}--no-level`,animateLevel:`${C}--animate-level`,levelsContainer:`${C}__levels-container`,innerLevelsContainer:`${C}__inner-levels-container`,labelContainer:`${C}__label-container`,arrowUp:`${C}__arrow-up`,arrowDown:`${C}__arrow-down`},I="esri-building-level-picker-label",H={base:I,active:`${I}--active`,hover:`${I}--hover`,empty:`${I}--empty`,clearButton:`${I}__clear-button`},_t={clearLevel:"",selectLevel:""};let E=class extends B{constructor(e,i){super(e,i),this.level=null,this.active=!1,this.hovering=!1,this.onClear=()=>{}}loadDependencies(){return D({fab:()=>L(()=>import("./calcite-fab-CKoU_mWy.js"),__vite__mapDeps([35,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,24,28,36,23,26,27,37,25,33,38,34,39]),import.meta.url)})}render(){const e=this.messages??_t;if(this.level==null)return a("div",{class:H.empty,title:e.selectLevel},e.selectLevel);const i=e.clearLevel;return a("div",{"aria-label":i,bind:this,class:this.classes(H.base,{[H.active]:this.active,[H.hover]:this.hovering}),onclick:this.onClear,title:i},a("span",null,this.level),a("calcite-fab",{appearance:"outline-fill",class:H.clearButton,disabled:!this.active,icon:"x",key:"clear-button",kind:"neutral",onclick:this.onClear,scale:"s"}))}};l([o()],E.prototype,"level",void 0),l([o({nonNullable:!0})],E.prototype,"active",void 0),l([o({nonNullable:!0})],E.prototype,"hovering",void 0),l([o()],E.prototype,"messages",void 0),l([o({nonNullable:!0})],E.prototype,"onClear",void 0),E=l([m("esri.widgets.BuildingExplorer.BuildingLevelPicker.Label")],E);const z="esri-building-level-picker-item",U={container:z,base:`${z}__base`,hover:`${z}--hover`,active:`${z}--active`};let y=class extends B{constructor(t,e){super(t,e),this.active=!1,this.hovering=!1,this.width=0,this.height=0,this.onSelect=()=>{},this.onFocus=()=>{},this.onBlur=()=>{},this._baseElement=null}render(){return a("div",{bind:this,class:this.classes(U.container,{[U.active]:this.active,[U.hover]:this.hovering}),key:this,styles:{height:`${this.height}px`}},this._renderBase())}focus(){this._baseElement!=null&&this._baseElement.focus()}_renderBase(){const t=this.width,e=.8*this.width;return a("div",{class:U.base,styles:{width:`${Math.round(t)}px`,height:`${Math.round(t)}px`}},a("button",{afterCreate:Ae,"aria-label":this.label,bind:this,class:"rect","data-node-ref":"_baseElement",onblur:this.onBlur,onclick:this.onSelect,onfocus:this.onFocus,styles:{width:`${Math.round(e)}px`,height:`${Math.round(e)}px`,transform:`translate(${Ie(this.container),-50}%, -50%) rotateX(66deg) rotateZ(45deg)`},tabIndex:-1,title:this.label??"",type:"button"}))}};l([o({nonNullable:!0})],y.prototype,"level",void 0),l([o({nonNullable:!0})],y.prototype,"active",void 0),l([o({nonNullable:!0})],y.prototype,"hovering",void 0),l([o({nonNullable:!0})],y.prototype,"width",void 0),l([o({nonNullable:!0})],y.prototype,"height",void 0),l([o({nonNullable:!0})],y.prototype,"onSelect",void 0),l([o({nonNullable:!0})],y.prototype,"onFocus",void 0),l([o({nonNullable:!0})],y.prototype,"onBlur",void 0),y=l([m("esri.widgets.BuildingExplorer.BuildingLevelPicker.LevelItem")],y);const Q={selectLevel:"selectLevel",clearLevel:"clearLevel",nextLevel:"nextLevel",previousLevel:"previousLevel",currentLevel:"{{value}}"};let d=class extends B{constructor(t,e){super(t,e),this._levelHandlesKey="levelHandles",this._levelEventHandlesKey="levelEventHandles",this._levelWidgets=[],this._labelWidget=new E({onClear:()=>this.vm.clear()}),this._hoveredLevel=null,this._expandedLevelsHeight=void 0,this._normalizedPointerPosition=0,this._hovering=!1,this._containerPosTop=null,this._levelsContainer=null,this._onKeyDown=i=>{switch(i.key){case"ArrowDown":case"ArrowLeft":i.preventDefault(),i.stopPropagation(),this.vm.previous(),this._focusCurrentLevel();break;case"ArrowUp":case"ArrowRight":i.preventDefault(),i.stopPropagation(),this.vm.next(),this._focusCurrentLevel()}},this._onFocus=()=>{this._hoveredLevel=this._levels.length>0?this._levels[0]:null},this._onArrowUpClick=()=>{this.vm.next()},this._onArrowDownClick=()=>{this.vm.previous()},this._onPointerUp=()=>{var s;if((s=window.getSelection())==null||s.removeAllRanges(),this._hoveredLevel==null)return;const{vm:i}=this;i.enabled&&this._hoveredLevel===i.value?i.clear():i.select(this._hoveredLevel)},this._onPointerEnter=()=>{this._hovering||this._levelsContainer==null||(this._hovering=!0,this._containerPosTop=this._levelsContainer.getBoundingClientRect().top??0)},this._onPointerLeave=()=>{this._hovering&&(this._normalizedPointerPosition=0,this._hoveredLevel=null,this._hovering=!1)},this._onPointerMove=i=>{var s;if(!this._hovering)return!1;if((s=window.getSelection())==null||s.removeAllRanges(),this._containerPosTop!=null){const r=this._containerPosTop,n=K*q,h=this._expandedLevelsMargin;let p=this._levelsHeight,R=r+n+h;const oe=this._levelHeight/2;R+=oe,p-=oe;let ne=(i.clientY-R)/p;ne+=ke,this._normalizedPointerPosition=ne}return!1}}loadDependencies(){return D({action:()=>L(()=>import("./calcite-action-Bys6x4p_.js"),__vite__mapDeps([40,41,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,24,28,37,25,33,27,38,34,39]),import.meta.url)})}postInitialize(){this.addHandles([b(()=>this._levelsContainer,()=>this._onContainerChange(),$),b(()=>this._levels,()=>this._createLevelWidgets(),$),b(()=>this.messages,()=>{this._labelWidget.messages=this.messages??Q},$)])}destroy(){this._levelWidgets.forEach(t=>t.destroy()),this._labelWidget.destroy()}get _levels(){return this.vm.allowedValues}get _numLevels(){return this._levels.length}get _levelsHeight(){return Math.round(this._levelHeight*this._numLevels)}get _expandedLevelsMargin(){return Math.round(((this._expandedLevelsHeight??0)-this._levelsHeight)/2)}get _levelWidth(){const{levelWidthNominator:t,levelWidthConstant:e}=mt,i=t/Math.sqrt(this._numLevels)+e;return Math.round(he(i,Be,Me))}get _levelHeight(){const t=Fe,e=2*t/Math.sqrt(this._numLevels);return Math.round(he(e,2,t))}get _gaussianFactor(){const t=this._numLevels;return t/Math.log(Ne*t)*Se}get _levelClosestToPointer(){if(!this._hovering)return null;const t=this._numLevels-1,e=this._normalizedPointerPosition;return t>=0&&e!=null?this._levels[Math.round((1-e)*t)]:null}render(){const t=this._levelWidgets.length,e=t>1?this._levelWidgets.map(h=>h.render()):null,i=K*q,s=-i/q,r=this._levelsHeight,n=r+2*i;return a("div",{class:this.classes(W.widget,P.container,{[P.animateLevel]:!this._hovering,[P.noLevel]:t<2}),key:this,onkeydown:this._onKeyDown},this._renderLabelContainer(),a("div",{afterCreate:h=>this._levelsContainer=h,class:P.levelsContainer,"data-node-ref":"",onfocus:this._onFocus,styles:{height:`${n}px`,marginBlockStart:`${s}px`,marginBlockEnd:`${s}px`}},a("div",{class:P.innerLevelsContainer,styles:{height:`${r}px`,margin:"0",marginBlockStart:K-this._expandedLevelsMargin+"px"}},e)))}_renderLabelContainer(){const{hasPrevious:t,hasNext:e}=this.vm,i=this.messages??Q,s=i.previousLevel,r=i.nextLevel;return a("div",{class:P.labelContainer,tabIndex:0},ue({className:P.arrowUp,disabled:!e,icon:"chevron-up",onClick:this._onArrowUpClick,text:r}),this._labelWidget.render(),ue({className:P.arrowDown,disabled:!t,icon:"chevron-down",onClick:this._onArrowDownClick,text:s}))}_updateComponents(){const t=this.messages??Q,e=this.vm.enabled?this.vm.value:null,i=this._hoveredLevel!=null?this._hoveredLevel:e;this._levelWidgets.forEach(s=>{var n;const r=this.vm.getValueLabel(s.level);s.label=r??((n=t.currentLevel)==null?void 0:n.replace("{{level}}",String(s.level))),s.active=s.level===e,s.hovering=s.level===this._hoveredLevel}),this._labelWidget.level=i,this._labelWidget.active=i===e,this._labelWidget.hovering=this._hoveredLevel!=null}_createLevelWidgets(){this._levelWidgets.forEach(t=>t.destroy()),this._levelWidgets=this._levels.map(t=>new y({level:t,onSelect:()=>this._onLevelToggle(t)})),this.removeHandles(this._levelHandlesKey),this.addHandles([b(()=>{const{vm:t}=this;return[this.messages,t==null?void 0:t.value,t==null?void 0:t.enabled,this._hoveredLevel,this._hovering]},()=>this._updateComponents(),$),b(()=>[this._normalizedPointerPosition,this._hovering],()=>this._onPointerPositionChange(),$),b(()=>this._levelWidth,t=>this._levelWidgets.forEach(e=>e.width=t),$)],this._levelHandlesKey)}_onContainerChange(){const t=this._levelsContainer;t!=null&&(this.removeHandles(this._levelEventHandlesKey),this.addHandles([A(t,"pointerenter",this._onPointerEnter),A(t,"pointerover",this._onPointerEnter),A(t,"pointerleave",this._onPointerLeave),A(t,"pointerup",this._onPointerUp),A(t,"pointermove",this._onPointerMove)],this._levelEventHandlesKey))}_focusCurrentLevel(){const t=this._levelWidgets.find(e=>e.level===this.vm.value);t==null||t.focus()}_onLevelToggle(t){const{vm:e}=this;e.enabled&&e.value===t?e.clear():e.select(t)}_onPointerPositionChange(){let t=0;this._levelWidgets.forEach((i,s)=>{const{width:r,height:n}=this._getLevelWidgetSize(s);i.height=n,i.width=r,t+=n}),this._hoveredLevel=this._levelClosestToPointer;const e=this._expandedLevelsHeight;(e==null||Math.abs(e-t)>30)&&(this._expandedLevelsHeight=t)}_getLevelWidgetSize(t){const e={width:this._levelWidth,height:this._levelHeight};if(this._hovering){const i=this._getGaussianFactor(t,this._normalizedPointerPosition);e.width+=Ve*i,e.height+=Ee*i}return e}_getGaussianFactor(t,e){const i=this._numLevels-1,s=(i-t)/i,r=this._gaussianFactor*(s-e);return Math.exp(-(r**2))}};function ue(t){return a("calcite-action",{appearance:"transparent",class:t.className,disabled:t.disabled,icon:t.icon,key:t.className,onclick:t.onClick,scale:"s",text:t.text,textEnabled:!1,title:t.text})}l([o()],d.prototype,"vm",void 0),l([o()],d.prototype,"messages",void 0),l([o()],d.prototype,"_levelWidgets",void 0),l([o()],d.prototype,"_labelWidget",void 0),l([o()],d.prototype,"_hoveredLevel",void 0),l([o()],d.prototype,"_levels",null),l([o()],d.prototype,"_numLevels",null),l([o({readOnly:!0})],d.prototype,"_levelsHeight",null),l([o()],d.prototype,"_expandedLevelsHeight",void 0),l([o({readOnly:!0})],d.prototype,"_expandedLevelsMargin",null),l([o({readOnly:!0})],d.prototype,"_levelWidth",null),l([o({readOnly:!0})],d.prototype,"_levelHeight",null),l([o({readOnly:!0})],d.prototype,"_gaussianFactor",null),l([o({readOnly:!0})],d.prototype,"_levelClosestToPointer",null),l([o({type:Number,range:{min:0,max:1}})],d.prototype,"_normalizedPointerPosition",void 0),l([o()],d.prototype,"_hovering",void 0),l([o()],d.prototype,"_containerPosTop",void 0),l([o()],d.prototype,"_levelsContainer",void 0),d=l([m("esri.widgets.BuildingExplorer.BuildingLevelPicker.BuildingLevelPicker")],d);const gt=d,w="esri-building-phase-picker",f={base:`${w}`,phasesContainer:`${w}__phases-container`,phase:`${w}__phase`,phaseActive:`${w}__phase--active`,phaseCurrent:`${w}__phase--current`,divider:`${w}__divider`,dividerActive:`${w}__divider--active`,arrowLeft:`${w}__arrow-left`,arrowRight:`${w}__arrow-right`},yt={nextPhase:"nextPhase",previousPhase:"previousPhase",currentPhase:"{{value}}"};let V=class extends B{constructor(t,e){super(t,e),this._phasesContainer=null,this._shouldScrollCurrentPhaseIntoView=!0,this._shouldFocusCurrentPhase=!1,this._onKeyDown=i=>{const{vm:s}=this;switch(i.key){case"ArrowDown":case"ArrowLeft":i.stopPropagation(),i.preventDefault(),s.previous(),this._shouldFocusCurrentPhase=!0;break;case"ArrowUp":case"ArrowRight":i.stopPropagation(),i.preventDefault(),s.next(),this._shouldFocusCurrentPhase=!0}},this._onArrowLeftClick=()=>{this.vm.previous()},this._onArrowRightClick=()=>{this.vm.next()},this._onPhasesContainerAfterCreate=i=>{this._phasesContainer=i,requestAnimationFrame(this._scrollOrFocusPhase)},this._scrollOrFocusPhase=()=>{const i=this._phasesContainer;if(this.destroyed||i==null)return;const s=i.querySelector(`.${f.phaseCurrent}`);if(s){if(this._shouldScrollCurrentPhaseIntoView){const r=i.offsetWidth,n=s.offsetLeft,h=s.offsetWidth;i.scrollLeft=-r/2+n+h/2,this._shouldScrollCurrentPhaseIntoView=!1}this._shouldFocusCurrentPhase&&(s.focus(),this._shouldFocusCurrentPhase=!1)}}}loadDependencies(){return D({action:()=>L(()=>import("./calcite-action-Bys6x4p_.js"),__vite__mapDeps([40,41,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,24,28,37,25,33,27,38,34,39]),import.meta.url)})}initialize(){this.addHandles(b(()=>[this._currentPhase,this._phasesContainer,this.container],()=>{this._shouldScrollCurrentPhaseIntoView=!0,requestAnimationFrame(this._scrollOrFocusPhase)},$))}get _phases(){return this.vm.allowedValues}get _currentPhase(){const{vm:t}=this;return t.enabled?t.value:null}render(){if(this._phases.length<2)return a("div",{key:"no-phases"});const{vm:t,messages:e}=this,{previousPhase:i,nextPhase:s}=e??yt;return a("div",{class:this.classes(W.widget,f.base),key:this,onkeydown:this._onKeyDown},ce({className:f.arrowLeft,disabled:!t.hasPrevious,icon:"chevron-left",onClick:this._onArrowLeftClick,text:i}),a("div",{afterCreate:this._onPhasesContainerAfterCreate,class:f.phasesContainer},this._renderPhaseButtons()),ce({className:f.arrowRight,disabled:!t.hasNext,icon:"chevron-right",onClick:this._onArrowRightClick,text:s}))}_renderPhaseButtons(){const t=this._phases,e=this._currentPhase,i=[];for(let s=0;s<t.length;++s){const r=t[s],n={phase:r,active:e!=null&&r<=e,current:e!=null&&r===e};s>0&&i.push(this._renderDivider(n)),i.push(this._renderPhaseButton(n))}return i}_renderPhaseButton({phase:t,active:e,current:i}){const{vm:s}=this,r=s.getValueLabel(t);return a("button",{"aria-label":r,class:this.classes(f.phase,{[f.phaseActive]:e,[f.phaseCurrent]:i}),key:`phase-${t}`,onclick:()=>s.select(t),title:r,type:"button"},t)}_renderDivider({phase:t,active:e}){return a("div",{class:this.classes(f.divider,{[f.dividerActive]:e}),key:`phase-divider-${t}`})}};function ce(t){return a("calcite-action",{appearance:"transparent",class:t.className,compact:!0,disabled:t.disabled,icon:t.icon,iconFlipRtl:!0,key:t.className,onclick:t.onClick,scale:"s",text:t.text,textEnabled:!1,title:t.text})}l([o({nonNullable:!0})],V.prototype,"vm",void 0),l([o()],V.prototype,"messages",void 0),l([o()],V.prototype,"_phases",null),l([o()],V.prototype,"_currentPhase",null),l([o()],V.prototype,"_phasesContainer",void 0),V=l([m("esri.widgets.BuildingExplorer.BuildingPhasePicker.BuildingPhasePicker")],V);const ft=V,ve={levels:!0,phases:!0,disciplines:!0};let c=class extends B{constructor(t,e){super(t,e),this._defaultViewModel=new Pe,this.viewModel=this._defaultViewModel,this.visibleElements={...ve},this.headingLevel=3,this.messages=null,this.messagesCommon=null,this.toggleSiblingsVisibility=!1}loadDependencies(){return D({loader:()=>L(()=>import("./calcite-loader-DP4PIFO8.js"),__vite__mapDeps([42,39,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,37,25,33]),import.meta.url)})}destroy(){this.viewModel!==this._defaultViewModel&&this._defaultViewModel.destroy()}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}get layers(){return this.viewModel.layers}set layers(t){this.viewModel.layers=t}_castVisibleElements(t){return{...ve,...t}}get icon(){return"organization"}set icon(t){this._overrideIfSome("icon",t)}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}render(){const t=this.viewModel,e=t.state==="disabled"||!t.isSupported;return a("div",{"aria-label":this.messages.widgetLabel,class:T(W.widget,_.base,W.panel,{[W.widgetDisabled]:e}),key:this},this._renderContent())}_renderContent(){const t=this.viewModel,e=this.messages;if(!t.isSupported)return a("p",{class:_.panelError},e.unsupported);if(!t.layers.length)return a("p",{class:_.panelError},e.noData);switch(t.state){case"loading":return this._renderLoadingIndicator();case"ready":return a("div",{class:_.content,key:"content"},this._renderLevelPickerSection(),this._renderPhasePickerSection(),this._renderDisciplinesSection());case"failed":return a("p",{class:_.panelError},e.failed);default:return null}}_renderLoadingIndicator(){const t=this.messagesCommon.loading;return a("div",{"aria-label":t,class:_.loadingContainer,key:"loading-container",role:"presentation",title:t},a("calcite-loader",{label:t,type:"indeterminate"}))}_renderLevelPickerSection(){var r;const t=this.viewModel.level,e=t.state==="ready",i=t.allowedValues.length>1;if(!this.visibleElements.levels||!e||!i)return null;const s=(r=this.messages)==null?void 0:r.level;return a("div",{class:T(_.section,_.levels),key:"levels"},a(X,{level:this.headingLevel},s==null?void 0:s.title),a(gt,{messages:s,vm:t}))}_renderPhasePickerSection(){const t=this.viewModel.phase,e=t.state==="ready",i=t.allowedValues.length>1;if(!this.visibleElements.phases||!e||!i)return null;const s=this.messages.phase;return a("div",{class:T(_.section,_.phases),key:"phases"},a(X,{level:this.headingLevel},s.title),a(ft,{messages:s,vm:t}))}_renderDisciplinesSection(){var r;const t=this.viewModel.disciplines,e=t.state==="ready",i=t.root.hasChildren;if(!this.visibleElements.disciplines||!e||!i)return null;const s=(r=this.messages)==null?void 0:r.disciplines;return a("div",{class:T(_.section,_.disciplines),key:"disciplines"},a(X,{level:this.headingLevel},s.title),a(ut,{messages:s,toggleSiblingsVisibility:this.toggleSiblingsVisibility,vm:t}))}};l([o({type:Pe})],c.prototype,"viewModel",void 0),l([o()],c.prototype,"view",null),l([o()],c.prototype,"layers",null),l([o()],c.prototype,"visibleElements",void 0),l([Re("visibleElements")],c.prototype,"_castVisibleElements",null),l([o()],c.prototype,"headingLevel",void 0),l([o()],c.prototype,"icon",null),l([o()],c.prototype,"label",null),l([o(),ae("esri/widgets/BuildingExplorer/t9n/BuildingExplorer")],c.prototype,"messages",void 0),l([o(),ae("esri/t9n/common")],c.prototype,"messagesCommon",void 0),l([o({nonNullable:!0})],c.prototype,"toggleSiblingsVisibility",void 0),l([o()],c.prototype,"uiStrings",void 0),c=l([m("esri.widgets.BuildingExplorer")],c);const dr=c;export{dr as default};
