const E=9999999e31,L=2e-7,S={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-34028234663852886e22,34028234663852886e22],f64:[-Number.MAX_VALUE,Number.MAX_VALUE],unknown:void 0,c64:void 0,c128:void 0};function V(t){return S[t]??[-34028234663852886e22,34028234663852886e22]}function v(t,s){return t==null||s==null?"s32":t<0?t>=-128&&s<128?"s8":t>=-32768&&s<32768?"s16":"s32":s<256?"u8":s<65536?"u16":"u32"}function y(t){return((t==null?void 0:t.startsWith("s"))||(t==null?void 0:t.startsWith("u")))??!1}function I(t,s,b){var p,M;if(t.depthCount&&t.depthCount>1)return;const{pixels:h,statistics:i,pixelType:a}=t,k=h[0].length,m=t.bandMasks??[],c=t.mask??new Uint8Array(k).fill(255),g=a==="f32"||a==="f64",d=V(a);let f=!1;for(let u=0;u<h.length;u++){const n=typeof s=="number"?s:s[u];if(n==null)continue;const x=((p=i==null?void 0:i[u])==null?void 0:p.minValue)??d[0],A=((M=i==null?void 0:i[u])==null?void 0:M.maxValue)??d[1];if(x>n+Number.EPSILON||A<n-Number.EPSILON)continue;const r=m[u]||c.slice(),o=h[u],N=b==null?void 0:b.customFloatTolerance;if(g&&N!==0){let e=N;e||(e=Math.abs(n)>=E?L*Math.abs(n):a==="f32"?2**-23:Number.EPSILON);for(let l=0;l<o.length;l++)r[l]&&Math.abs(o[l]-n)<e&&(o[l]=0,r[l]=0,c[l]=0,f=!0)}else for(let e=0;e<o.length;e++)r[e]&&o[e]===n&&(o[e]=0,r[e]=0,c[e]=0,f=!0);m[u]=r}f&&(t.bandMasks=t.bandMasks||t.pixels.length>1?m:null,t.mask=c),f&&"updateStatistics"in t&&t.updateStatistics()}export{y as i,I as l,V as s,v as u};
