import{I as u,q as o,S as c,X as m,V as w,x as S,_ as g}from"./assets-C2mb-ea2.js";import{h as y}from"./persistableUrlUtils-BcifXQ1Z.js";const v={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",knowledgegraphserver:"KnowledgeGraphServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer","3dtilesserver":"3DTilesServer",videoserver:"VideoServer"},f=Object.values(v),p=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${f.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),I=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^/\\n]+)\\/(${f.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),C=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function x(r){return p.test(r)}function d(r){if(r==null)return null;const e=u(r),t=(e==null?void 0:e.path.match(p))||(e==null?void 0:e.path.match(I));if(!t)return null;const[,s,n,l,i]=t,a=n.indexOf("/");return{title:h(a!==-1?n.slice(a+1):n),serverType:v[l.toLowerCase()],sublayer:i!=null&&i!==""?parseInt(i,10):null,url:{path:s}}}function b(r){const e=u(r).path.match(C);return e?{serviceUrl:e[1],sublayerId:Number(e[2])}:null}function h(r){return(r=r.replaceAll(/\s*[/_]+\s*/g," "))[0].toUpperCase()+r.slice(1)}function j(r,e){const t=[];if(r){const s=d(r);s!=null&&s.title&&t.push(s.title)}if(e){const s=h(e);t.push(s)}if(t.length===2){if(t[0].toLowerCase().includes(t[1].toLowerCase()))return t[0];if(t[1].toLowerCase().includes(t[0].toLowerCase()))return t[1]}return t.join(" - ")}function U(r){let e=m(r,!0);return!!e&&(e=e.toLowerCase(),e.endsWith(".arcgis.com")&&(e.startsWith("services")||e.startsWith("tiles")||e.startsWith("features")))}function V(r,e){return r&&o(c(r,e))}function W(r){let{url:e}=r;if(!e)return{url:e};e=c(e,r.logger);const t=u(e),s=d(t.path);let n;if(s!=null)s.sublayer!=null&&r.layer.layerId==null&&(n=s.sublayer),e=s.url.path;else if(r.nonStandardUrlAllowed){const l=b(t.path);l!=null&&(e=l.serviceUrl,n=l.sublayerId)}return{url:o(e),layerId:n}}function T(r,e,t,s,n){y(e,s,"url",n),s.url&&r.layerId!=null&&(s.url=w(s.url,t,r.layerId.toString()))}function q(r){if(!r)return!1;const e=r.toLowerCase(),t=e.includes("/services/"),s=e.includes("/mapserver/wmsserver"),n=e.includes("/imageserver/wmsserver"),l=e.includes("/wmsserver");return t&&(s||n||l)}function A(r){var s;if(!r)return!1;const e=new S(g(r)),t=(s=e.authority)==null?void 0:s.toLowerCase();return t==="server.arcgisonline.com"||t==="services.arcgisonline.com"}export{T as C,A as I,W as S,q as b,d,U as g,b as h,h as m,x as p,j as w,V as y};
