import{G as J}from"./Accessor-BHnuXKD2.js";import{a as D,b as U,m as K}from"./Transformation2D-BSBl8u-h.js";import{N as w,aI as L,E as W,a as f,W as x,aJ as $,aK as b,aL as T,aM as k,aN as Z,aw as j,aO as q}from"./ProjectionTransformation-DzMxxvj3.js";import"./Extent-CBBGeHb-.js";import"./Polyline-BmuD2-ZN.js";import"./Point-XGrwlf63.js";import"./jsonConverter-BddGRRgO.js";import{t as B}from"./SimpleGeometryCursor-B92kdZ15.js";import{getSpatialReference as F,fromSpatialReference as H,fromPolyline as Q,fromGeometry as X,toGeometry as Y}from"./apiConverter-CBpLPeKU.js";var z=q;function g(l,e){return{m_geometry:l,m_side:e}}function tt(l,e,n,t,m,r){if(e.isEmpty()){const a=g(e,0);return void m.push(a)}if(n.isEmpty()){const a=g(e,0);return void m.push(a)}const s=[],o=new x;{const a=o.createGeometryUserIndex(),C=o.addGeometry(e),I=o.addGeometry(n),p=new $(r);let d=0,i=null;if(o.hasCurves()){i=new z;const h=o.getEnvelope2D(r);d=b(t.total());const _=T(t.total(),h);k(o,_,t.total(),12e3,i,null,r)}o.dbgVerifyCurves(),p.setEditShapeCrackAndCluster(o,t),p.cut(l,a,C,I,s);for(const h of s){i!==null&&i.stitchCurves(o,h,d,!1);const _=g(o.getGeometry(h),Z(o.getGeometryUserIndex(h,a)));m.push(_)}i!==null&&i.clearStitcher(o)}}function et(l,e,n,t,m,r){if(e.isEmpty()){const a=g(e,0);return void m.push(a)}if(n.isEmpty()){const a=g(e,0);return void m.push(a)}const s=[],o=new x;{const a=o.createGeometryUserIndex(),C=o.addGeometry(e),I=o.addGeometry(n),p=new $(r);let d=0,i=null;if(o.hasCurves()){i=new z;const u=o.getEnvelope2D(r);d=b(t.total());const y=T(t.total(),u);k(o,y,t.total(),12e3,i,null,r)}o.dbgVerifyCurves(),p.setEditShapeCrackAndCluster(o,t),p.cut(!1,a,C,I,s),i!==null&&i.stitchCurves(o,j,d,!0);let h=o.getGeometry(C);const _=new f,E=new f,G=[];for(let u=0;u<s.length;u++){let y=null;{const c=new x,S=c.addGeometry(h),P=c.addGeometry(o.getGeometry(s[u]));if(c.hasCurves()){const A=c.getEnvelope2D(r);d=b(t.total());const V=T(t.total(),A);k(c,V,t.total(),12e3,i,null,r)}p.setEditShapeCrackAndCluster(c,t);const O=p.intersection(S,P);if(i!==null&&i.stitchCurves(c,j,d,!0),y=c.getGeometry(O),y.isEmpty())continue;const v=o.getGeometryUserIndex(s[u],a);v===2?_.add(y,!1):v===1?E.add(y,!1):G.push(y)}{const c=new x,S=c.addGeometry(h),P=c.addGeometry(o.getGeometry(s[u]));if(c.hasCurves()){const v=c.getEnvelope2D(r);d=b(t.total());const A=T(t.total(),v);k(c,A,t.total(),12e3,i,null,r)}p.setEditShapeCrackAndCluster(c,t);const O=p.difference(S,P);i!==null&&i.stitchCurves(c,j,d,!0),h=c.getGeometry(O)}}if(!h.isEmpty()&&s.length>0&&G.push(h),_.isEmpty()&&E.isEmpty())return;if(!_.isEmpty()){const u=g(_,1);m.push(u)}if(!E.isEmpty()){const u=g(E,2);m.push(u)}for(let u=0,y=G.length;u<y;++u){const c=g(G[u],3);m.push(c)}}}class st{getOperatorType(){return 10005}accelerateGeometry(e,n,t){return!1}canAccelerateGeometry(e){return!1}supportsCurves(){return!0}execute(e,n,t,m,r){return new ot(e,n,t,m,r)}}class ot extends B{constructor(e,n,t,m,r){super(),this.m_cutIndex=-1,this.m_cuts=[],this.m_progressTracker=r,this.m_cuttee=n.clone(),this.m_cutter=new w({copy:t}),this.m_bConsiderTouch=e;const s=L(n,t);this.m_tolerance=W(m,s,!0)}next(){return this.m_cutIndex===-1&&this.generateCuts(),++this.m_cutIndex<this.m_cuts.length?this.m_cuts[this.m_cutIndex]:null}getGeometryID(){return this.m_cutIndex}tock(){return!0}getRank(){return 1}generateCuts(){switch(this.m_cuttee.getGeometryType()){case D.enumPolyline:this.generatePolylineCuts();break;case D.enumPolygon:this.generatePolygonCuts()}}generatePolylineCuts(){const e=new w,n=new w,t=new w;this.m_cuts.length=0,this.m_cuts.push(e),this.m_cuts.push(n);const m=[];tt(this.m_bConsiderTouch,this.m_cuttee,this.m_cutter,this.m_tolerance,m,this.m_progressTracker);for(let r=0;r<m.length;r++){const s=m[r];s.m_side===1?e.add(s.m_geometry,!1):s.m_side===2||s.m_side===4?n.add(s.m_geometry,!1):s.m_side===3?this.m_cuts.push(s.m_geometry):s.m_side===0?t.add(s.m_geometry,!1):U("")}t.isEmpty()||e.isEmpty()&&n.isEmpty()&&!(this.m_cuts.length>=3)||this.m_cuts.push(t),e.isEmpty()&&n.isEmpty()&&this.m_cuts.length<3&&(this.m_cuts.length=0)}generatePolygonCuts(){const e=new f,n=new f,t=new f;this.m_cuts.length=0,this.m_cuts.push(e),this.m_cuts.push(n);const m=[];et(this.m_bConsiderTouch,this.m_cuttee,this.m_cutter,this.m_tolerance,m,this.m_progressTracker);for(let r=0;r<m.length;r++){const s=m[r];s.m_side===1?e.add(s.m_geometry,!1):s.m_side===2?n.add(s.m_geometry,!1):s.m_side===3?this.m_cuts.push(s.m_geometry):s.m_side===0?t.add(s.m_geometry,!1):U("")}K(t.isEmpty()||m.length===1),e.isEmpty()&&n.isEmpty()&&this.m_cuts.length<3&&(this.m_cuts.length=0)}}const M=new st;function nt(l,e,n){const t=M.execute(!0,l,e,n,null);return Array.from(t)}function rt(){return M.supportsCurves()}function N(l,e){const n=F(l);return nt(X(l),Q(e),H(n)).map(t=>Y(t,n)).filter(J)}const R=rt(),yt=Object.freeze(Object.defineProperty({__proto__:null,execute:N,supportsCurves:R},Symbol.toStringTag,{value:"Module"})),_t=Object.freeze(Object.defineProperty({__proto__:null,execute:N,supportsCurves:R},Symbol.toStringTag,{value:"Module"}));export{_t as c,yt as i};
