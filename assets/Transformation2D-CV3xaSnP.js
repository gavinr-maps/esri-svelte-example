function cs(e){switch(e){case 1:return"Unknown error";case 2:return"Corrupted geometry";case 3:return"Empty geometry";case 4:return"Math singularity";case 5:return"Buffer is too small";case 6:return"Invalid shape type";case 7:return"Projection out of supported range";case 8:return"Non simple geometry";case 9:return"Cannot calculate geodesic";case 10:return"Notation conversion";case 11:return"Missing grid file";case 12:return"Invalid call";case 13:return"Internal error";case 14:return"Not implemented";case 15:return"IO error";case 16:return"Invalid 3D";case 17:return"An ambiguous geography edge with antipodal points";case 18:return"Geocentric coordinates require ellipsoidal height";case 19:return"Geography cannot be projected into a gnomonic plane or a result of an operation cannot fit into a gnomonic plane";case 20:return"Geometry is too large to be exported in to a given format";case 22:return"Operation is canceled by the user";case 21:return"The operation, such as projection or geodetic computation, cannot be performed without pe-wasm loaded";default:return"unknown error"}}function _(e,t){try{if(!e)throw new Error(t)}catch(s){throw s}}class U extends Error{constructor(t,s){super(s),this.m_AdditionalMessage=s,this.m_ErrorType=t,this.name="GeometryError"}what(){return cs(this.m_ErrorType)}additionalMessage(){return this.m_AdditionalMessage?this.m_AdditionalMessage:""}code(){return this.m_ErrorType}}let ms=class extends U{constructor(t){super(2,t),this.name="CorruptedGeometryError"}},ys=class extends U{constructor(t){super(3,t),this.name="EmptyGeometryError"}};class fs extends U{constructor(t){super(4,t),this.name="MathSingularityError"}}let xs=class extends U{constructor(t){super(21,t),this.name="ProjectionEngineNotLoadedError"}};class ds extends U{constructor(t){super(8,t),this.name="NonSimpleGeometryError"}}var j;(function(e){e[e.enumUnknown=0]="enumUnknown",e[e.enumPoint=513]="enumPoint",e[e.enumLine=5122]="enumLine",e[e.enumBezier=5123]="enumBezier",e[e.enumEllipticArc=5124]="enumEllipticArc",e[e.enumEnvelope=3077]="enumEnvelope",e[e.enumMultiPoint=8710]="enumMultiPoint",e[e.enumPolyline=25607]="enumPolyline",e[e.enumPolygon=27656]="enumPolygon",e[e.enumMultipatch=40969]="enumMultipatch",e[e.enumGeometryCollection=3594]="enumGeometryCollection",e[e.enumRationalBezier2=5134]="enumRationalBezier2",e[e.enumBezier2=5135]="enumBezier2",e[e.enumRationalBezier23d=5392]="enumRationalBezier23d",e[e.enumGreatArc3d=5393]="enumGreatArc3d"})(j||(j={}));const bs=[0,0,1,1,1,2,0,1,2,3,-1,-1,-1,-1,1,1];function wi(e){return bs[15&e]}function Ni(e){return!!(512&e)}function pi(e){return!!(1024&e)}function Mi(e){return!!(2048&e)}function Yt(e){return!!(4096&e)}function vs(e){return!!(8192&e)}function ws(e){return!!(16384&e)}function Ns(e){return!!(32768&e)}function _i(e){const t=e.getGeometryType();return vs(t)?e.getPointCount():e.isEmpty()?0:t===j.enumEnvelope?4:t===j.enumPoint?1:Yt(t)?2:void Ms("missing type")}function Xt(e){const t=e.getGeometryType();if(ws(t))return e.hasNonLinearSegments();if(t===j.enumGeometryCollection){const s=e;for(let i=0,n=s.getGeometryCount();i<n;i++)if(Xt(s.getGeometry(i)))return!0;return!1}return!!Yt(t)&&t!==j.enumLine}function Ci(e){throw new xs(e)}function gi(e){throw new ms(e)}function Y(e){throw new Error(e)}function ft(e){throw new fs(e)}function Ti(){Y("Geometry type is not supported for 3D operations.")}function Ri(e){throw new U(12,e)}function Ei(e){throw new ys(e)}function K(e){throw new U(14,e)}function ps(e){throw new Error(e)}function Ms(e){throw new U(13,e)}function Ii(e){throw new Error(e)}function Ai(e){throw new ds(e)}function _s(){K("Operation does not support curves.")}function Di(e){e&&Xt(e)&&_s()}function Pi(e){e&&Ns(e.getGeometryType())&&K("Unsupported geometry type.")}function Cs(e){e===j.enumGeometryCollection&&Y("Geometry_collection instances are not supported in this operation")}function qi(e){Cs(e.getGeometryType())}function zi(e){Y(`bad wkid: ${e}`)}function Zi(e){let t="bad wkt: ";t+=e,t+="...",Y(t)}function Si(e,t){e||Y(t)}let xt=class Kt{constructor(t){this.sum=t,this.compensation=0}assign(t){return this.compensation=t.compensation,this.sum=t.sum,this}reset(){this.sum=this.compensation=0}resetToStart(t){this.sum=t,this.compensation=0}normalize(){const t=[Number.NaN];this.sum=it(this.sum,this.compensation,t),this.compensation=t[0]}add(t){const s=this.sum+t;let i;if(Math.abs(this.sum)>=Math.abs(t)){const n=this.sum-s+t;i=this.compensation+n}else{const n=t-s+this.sum;i=this.compensation+n}this.sum=s,this.compensation=i}sub(t){this.add(-t)}addProduct(t,s){const i=[0],n=ht(t,s,i);this.add(n),this.add(i[0])}mul(t){const s=new Kt(0);s.addProduct(this.sum,t),s.addProduct(this.compensation,t),this.assign(s)}getResult(){return this.sum+this.compensation}pe(t){return this.add(t),this}me(t){return this.add(-t),this}};const gs=0x00000000ffffffffn,Ts=0x0000ffffn,Rs=0x000000ffn,Es=0x0fn,Is=0xffff0000n,As=0xff00n,Ds=0xf0n,Ps=[5,1,2,1,3,1,2,1,4,1,2,1,3,1,2,1],qs=[-1,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3];function dt(e){let t=0;return e&Ts||(t+=16,e>>=16n),e&Rs||(t+=8,e>>=8n),e&Es||(t+=4,e>>=4n),t+Ps[Number(BigInt.asUintN(4,e))]}function zs(e){let t=0;return e&Is&&(t+=16,e>>=16n),e&As&&(t+=8,e>>=8n),e&Ds&&(t+=4,e>>=4n),t+qs[Number(BigInt.asUintN(4,e))]+1}function Ft(e){let t=0;return e&gs||(t=32,e>>=32n),t+dt(BigInt.asUintN(32,e))}function Zs(e){let t=0;return 0xffffffff00000000n&e&&(t=32,e>>=32n),t+zs(e)}let Jt=class tt{constructor(t,s){if(this.m_EnvelopeType=1,t!==void 0){if(t instanceof tt)return this.vmin=t.vmin,void(this.vmax=t.vmax);this.vmin=t,this.vmax=s,this.normalize()}else this.setEmpty()}static construct(t,s){return new tt(t,s)}static constructEmpty(){return new tt}setCoords(t,s){this.vmin=t,this.vmax=s,this.normalize()}setCoordsFromEnvelope(t){this.vmin=t.vmin,this.vmax=t.vmax}setEmpty(){this.vmin=Number.NaN,this.vmax=Number.NaN}getCenter(){return .5*(this.vmin+this.vmax)}equalsRange(t,s){return Qt(this.vmin,t)&&Qt(this.vmax,s)}equals(t,s){return!(!this.isEmpty()||!t.isEmpty())||(s!==void 0?Math.abs(this.vmin-t.vmin)<=s&&Math.abs(this.vmax-t.vmax)<=s:this.vmin===t.vmin&&this.vmax===t.vmax)}width(){return this.vmax-this.vmin}isEmpty(){return Number.isNaN(this.vmin)||Number.isNaN(this.vmax)}isZero(){return this.vmin===this.vmax}setInfinite(){this.vmin=Number.NEGATIVE_INFINITY,this.vmax=Number.POSITIVE_INFINITY}move(t){this.isEmpty()||(this.vmin+=t,this.vmax+=t)}contains(t){return t.vmin>=this.vmin&&t.vmax<=this.vmax}containsCoordinate(t){return t>=this.vmin&&t<=this.vmax}containsRightExclusive(t){return t>=this.vmin&&t<this.vmax}containsExclusiveCoordinate(t){return t>this.vmin&&t<this.vmax}containsExclusive(t){return t.vmin>this.vmin&&t.vmax<this.vmax}isIntersecting(t){return this.vmin<=t.vmin?this.vmax>=t.vmin:t.vmax>=this.vmin}mergeCoordinate(t){if(this.isEmpty())return this.vmin=t,void(this.vmax=t);this.mergeNeCoordinate(t)}merge(t){if(t.isEmpty())return;const s=t.vmin,i=t.vmax;this.mergeCoordinate(s),this.mergeCoordinate(i)}mergeNe(t){const s=t.vmin,i=t.vmax;this.mergeNeCoordinate(s),this.mergeNeCoordinate(i)}mergeNeCoordinate(t){t<this.vmin?this.vmin=t:t>this.vmax&&(this.vmax=t)}intersect(t){this.isEmpty()||t.isEmpty()?this.setEmpty():(this.vmin<t.vmin&&(this.vmin=t.vmin),this.vmax>t.vmax&&(this.vmax=t.vmax),this.vmin>this.vmax&&this.setEmpty())}inflate(t){this.isEmpty()||(this.vmin-=t,this.vmax+=t,this.vmax<this.vmin&&this.setEmpty())}normalize(){this.vmin<=this.vmax||(this.vmin>this.vmax?this.vmax=et(this.vmin,this.vmin=this.vmax):this.setEmpty())}isValid(){return this.isEmpty()||this.vmin<=this.vmax}snapClip(t){return ls(t,this.vmin,this.vmax)}calculateToleranceFromEnvelope(){return this.isEmpty()?Vt():(Math.abs(this.vmin)+Math.abs(this.vmax)+1)*Vt()}static unit(){return Ss}normalizeNoNAN(){this.vmin>this.vmax&&(this.vmax=et(this.vmin,this.vmin=this.vmax))}setCoordsNoNAN(t,s){this.vmin=t,this.vmax=s,this.normalizeNoNAN()}clone(){return new tt(this.vmin,this.vmax)}};const Ss=new Jt(0,1);class T{static getNAN(){return new T(Number.NaN)}constructor(t,s){this.m_value=t??0,this.m_eps=s??0}[Symbol.toPrimitive](t){return this}clone(){return new T(this.m_value,this.m_eps)}assign(t){return this.m_value=t.m_value,this.m_eps=t.m_eps,this}scaleError(t){this.m_eps*=t}setError(t){this.m_eps=t}set(t,s){return this.m_value=t,this.m_eps=s??0,this}setWithEps(t,s){return s===void 0&&(s=1),this.m_value=t,this.m_eps=T.ulp(t)*s,this}setE(t){return this.m_value=t.m_value,this.m_eps=t.m_eps,this}precise(){return new T(this.m_value)}value(){return this.m_value}toDouble(){return this.m_value}eps(){return this.m_eps}resetError(){return this.m_eps=0,this}absThis(){return this.m_value=Math.abs(this.m_value),this}add(t){return this.clone().addThis(t)}addE(t){return this.clone().addThisE(t)}addThisE(t){const s=this.m_value+t.m_value,i=this.m_eps+t.m_eps+T.ulp(s);return this.m_value=s,this.m_eps=i,this}addThis(t){const s=this.m_value+t,i=this.m_eps+T.ulp(s);return this.m_value=s,this.m_eps=i,this}subE(t){return this.clone().subThisE(t)}sub(t){return this.clone().subThis(t)}subThisE(t){const s=this.m_value-t.m_value,i=this.m_eps+t.m_eps+T.ulp(s);return this.m_value=s,this.m_eps=i,this}subThis(t){const s=this.m_value-t,i=this.m_eps+T.ulp(s);return this.m_value=s,this.m_eps=i,this}setAddE(t,s){return this.m_value=t.m_value+s.m_value,this.m_eps=t.m_eps+s.m_eps+T.ulp(this.m_value),this}setAdd(t,s){return this.m_value=t+s,this.m_eps=T.ulp(this.m_value),this}setAddEN(t,s){return this.m_value=t.m_value+s,this.m_eps=t.m_eps+T.ulp(this.m_value),this}setAddNE(t,s){return this.m_value=t+s.m_value,this.m_eps=s.m_eps+T.ulp(this.m_value),this}setSubE(t,s){return this.m_value=t.m_value-s.m_value,this.m_eps=t.m_eps+s.m_eps+T.ulp(this.m_value),this}setSub(t,s){return this.m_value=t-s,this.m_eps=T.ulp(this.m_value),this}setSubEN(t,s){return this.m_value=t.m_value-s,this.m_eps=t.m_eps+T.ulp(this.m_value),this}setSubNE(t,s){return this.m_value=t-s.m_value,this.m_eps=s.m_eps+T.ulp(this.m_value),this}mulThisE(t){const s=this.m_value*t.m_value;return this.m_eps=this.m_eps*Math.abs(t.m_value)+t.m_eps*Math.abs(this.m_value)+this.m_eps*t.m_eps+T.ulp(s),this.m_value=s,this}mulThis(t){const s=this.m_value*t;return this.m_eps=this.m_eps*Math.abs(t)+T.ulp(s),this.m_value=s,this}mul(t){return this.clone().mulThis(t)}mulE(t){return this.clone().mulThisE(t)}setMulE(t,s){const i=t.m_value*s.m_value;return this.m_eps=t.m_eps*Math.abs(s.m_value)+s.m_eps*Math.abs(t.m_value)+t.m_eps*s.m_eps+T.ulp(i),this.m_value=i,this}setMul(t,s){return this.m_value=t*s,this.m_eps=T.ulp(this.m_value),this}setMulEN(t,s){return this.setE(t),this.mulThis(s)}setMulNE(t,s){return this.setE(s),this.mulThis(t)}mulThisByPower2(t){return this.m_value*=t,this.m_eps*=Math.abs(t),this}static st_mulByPower2(t,s){return new T(t.m_value,t.m_eps).mulThisByPower2(s)}divE(t){return this.clone().divThisE(t)}divThisE(t){const s=Math.abs(t.m_value),i=this.m_value/t.m_value;let n=(this.m_eps+Math.abs(i)*t.m_eps)/s;if(t.m_eps>.01*s){const r=t.m_eps/s;n*=1+(1+r)*r}return this.m_value=i,this.m_eps=n+T.ulp(i),this}divThis(t){const s=Math.abs(t);return this.m_value/=t,this.m_eps=this.m_eps/s+T.ulp(this.m_value),this}setDivE(t,s){return this.setE(t),this.divThisE(s)}setDiv(t,s){return this.m_value=t/s,this.m_eps=T.ulp(this.m_value),this}setDivEN(t,s){return this.setE(t),this.divThis(s)}setDivNE(t,s){return this.set(t),this.divThisE(s)}divThisByPower2(t){return this.m_value/=t,this.m_eps/=Math.abs(t),this}invThis(){return this.setE(ot.clone().divThisE(this)),this}sqrt(){return this.clone().sqrtThis()}sqrtThis(){let t,s;return this.m_value>=0?(t=Math.sqrt(this.m_value),s=this.m_value>10*this.m_eps?.5*this.m_eps/t:this.m_value>this.m_eps?t-Math.sqrt(this.m_value-this.m_eps):Math.max(t,Math.sqrt(this.m_value+this.m_eps)-t),s+=T.ulp(t)):this.m_value<-this.m_eps?(t=Number.NaN,s=Number.NaN):(t=0,s=Math.sqrt(this.m_eps)),this.m_value=t,this.m_eps=s,this}sqr(){return this.clone().sqrThis()}sqrThis(){const t=this.m_value*this.m_value;return this.m_eps=2*this.m_eps*Math.abs(this.m_value)+this.m_eps*this.m_eps+T.ulp(t),this.m_value=t,this}setSin(t){const s=Math.sin(t.m_value),i=Math.cos(t.m_value);this.m_value=s;const n=Math.abs(s),r=Math.abs(t.value());return this.m_eps=(Math.abs(i)+.5*n*t.m_eps)*t.m_eps+T.ulp(n+r),this}static ulp(t){let s=nt(t);const i=((0x7ff0000000000000n&s)>>52n)-1075n;return i>-1023n?(s=i+0x3ffn<<52n,Js(s)):t===0?0:Number.MIN_VALUE}setCos(t){const s=Math.sin(t.m_value),i=Math.cos(t.m_value);this.m_value=i;const n=Math.abs(i),r=Math.abs(t.value());return this.m_eps=(Math.abs(s)+.5*n*t.m_eps)*t.m_eps+T.ulp(n+r),this}static st_cosAndSin(t,s,i){const n=Math.sin(t.m_value),r=Math.cos(t.m_value);i.m_value=n,s.m_value=r;const o=Math.abs(n),h=Math.abs(r),a=Math.abs(t.value());i.m_eps=(Math.abs(r)+.5*o*t.m_eps)*t.m_eps+T.ulp(o+a),s.m_eps=(Math.abs(n)+.5*h*t.m_eps)*t.m_eps+T.ulp(h+a)}negate(){return this.clone().negateThis()}negateThis(){return this.m_value=-this.m_value,this}setAbs(){return this.m_value=Math.abs(this.m_value),this}isInInterval(t){return Jt.construct(this.m_value-this.m_eps,this.m_value+this.m_eps).isIntersecting(t)}eq(t){return Math.abs(this.m_value-t.m_value)<=this.m_eps+t.m_eps}ne(t){return!this.eq(t)}gt(t){return this.m_value-t.m_value>this.m_eps+t.m_eps}lt(t){return t.m_value-this.m_value>this.m_eps+t.m_eps}ge(t){return!this.lt(t)}le(t){return!this.gt(t)}tolEQ(t,s){return Math.abs(this.m_value-t.m_value)<=s||this.eq(t)}tolNE(t,s){return!this.tolEQ(t,s)}tolGT(t,s){return this.m_value-t.m_value>s&&this.gt(t)}tolLT(t,s){return t.m_value-this.m_value>s&&this.lt(t)}tolGE(t,s){return!this.tolLT(t,s)}tolLE(t,s){return!this.tolGT(t,s)}isZero(){return Math.abs(this.m_value)<=this.m_eps}isFuzzyZero(){return this.isZero()&&this.m_eps!==0}tolIsZero(t){return Math.abs(this.m_value)<=Math.max(this.m_eps,t)}setPi(){this.setE(Fs)}setEuler(){this.set(2.718281828459045,Nt())}static size(){return 1}}function z(e,t){const s=at(e),i=at(t),n=53-Ft(s),r=53-Ft(i);return(n>=0?n:0)+(r>=0?r:0)<=52}function rt(e,t){const s=e+t;return s-e===t&&s-t===e}function $(e,t){const s=e-t;return e-s===t&&t+s===e}function Nt(){return X()}T.dimensions=1;const Fs=new T(Math.PI,.5*Nt()),Fi=new T(0,0),ot=new T(1,0),$i=new T(4,0);function ki(e,t,s){return e.addE(t.subE(e).mulE(s))}function Bi(e,t,s){return t.subE(t.subE(e).mulE(ot.subE(s)))}function $s(e){return Math.atanh(e)}function Li(e){let t;if(e===0)t=1;else if(Math.abs(e)>.01)t=$s(e)/e;else{let s;const i=-36.841361487904734;t=0;const n=e*e;for(let r=2*Math.trunc(i/Math.log(n)+2.5)-1;r>1;r-=2)s=1/r,t=(t+s)*n;t+=1}return t}function bt(e){const t=Math.PI*Math.PI/6;let s;if(e===1)s=t;else if(e>1)s=t;else if(e===0)s=e;else if(e<0){const i=1+(e=Math.abs(e)),n=Math.log(i);s=n*n/-2-bt(e/i)}else if(e>.5){const i=1-e,n=Math.log(e)*Math.log(i);s=t-bt(i)-n}else{s=0;const i=1+Math.trunc(-16*Math.log(10)/Math.log(e)+1.5);let n=i;for(let r=i;r>0;r--,n-=1)s*=e,s+=1/(n*n);s*=e}return s}function Gi(e,t){const s=t*e;if(Math.abs(t)<.1){let i=0;for(let n=60;n>=1;n--)i*=s,i+=1/n/n;return i*=e,i}return bt(s)/t}function Oi(e,t){return e<t?Ot(e,t):Ot(t,e)}function Ui(e,t){const s=Math.abs(e);return t>=0?s:-s}function Qi(e){return Math.round(e)}function ks(e,t,s,i,n){n[0]=t[0]+(s[0]-t[0])*i,n[1]=t[1]+(s[1]-t[1])*i,e===3&&(n[2]=t[2]+(s[2]-t[2])*i)}function Bs(e,t,s,i,n){n[0]=s[0]-(s[0]-t[0])*(1-i),n[1]=s[1]-(s[1]-t[1])*(1-i),e===3&&(n[2]=s[2]-(s[2]-t[2])*(1-i))}function Vi(e,t,s,i,n){i<=.5?ks(e,t,s,i,n):Bs(e,t,s,i,n)}function Wi(e,t,s,i,n){n[0]=t[0].addE(s[0].subE(t[0]).mulE(i)),n[1]=t[1].addE(s[1].subE(t[1]).mulE(i))}function ji(e,t,s,i,n){n[0]=s[0].subE(s[0].subE(t[0]).mulE(ot.subE(i))),n[1]=s[1].subE(s[1].subE(t[1]).mulE(ot.subE(i)))}function vt(e,t,s){let i;return i=s<=.5?e+(t-e)*s:t-(t-e)*(1-s),i}function Yi(e,t,s){return e+(t-e)*s}function Xi(e,t,s){return t-(t-e)*(1-s)}function $t(e,t,s,i){s<=.5?(i.x=e.x+(t.x-e.x)*s,i.y=e.y+(t.y-e.y)*s):(i.x=t.x-(t.x-e.x)*(1-s),i.y=t.y-(t.y-e.y)*(1-s))}function Ki(e,t,s,i){s<=.5?(i.x=e.x+(t.x-e.x)*s,i.y=e.y+(t.y-e.y)*s,i.z=e.z+(t.z-e.z)*s):(i.x=t.x-(t.x-e.x)*(1-s),i.y=t.y-(t.y-e.y)*(1-s),i.z=t.z-(t.z-e.z)*(1-s))}function O(e){return e*e}function Ji(e){return e*e*e}function Hi(e){return 1/Math.sqrt(e)}function te(e){return e<0?-1:e>0?1:0}function se(e,t,s,i){const n=[0],r=[0],o=[0];return it(ht(e,s,n),ht(t,i,r),o)+(n[0]+r[0]+o[0])}const kt=[0],Ls=[0];function ie(e,t,s){return Gs(ht(e,t,kt),s,kt[0],Ls)}const lt=[0],ct=[0],mt=[0],yt=[0];function ht(e,t,s){const i=e*t;return Bt(e,lt,ct),Bt(t,mt,yt),s[0]=ct[0]*yt[0]-(i-lt[0]*mt[0]-ct[0]*mt[0]-lt[0]*yt[0]),i}function Bt(e,t,s){const i=134217729*e;t[0]=i-(i-e),s[0]=e-t[0]}const Lt=[0],Gt=[0];function Gs(e,t,s,i){const n=it(e,t,Lt),r=it(n,s,Gt);return it(r,Lt[0]+Gt[0],i)}function it(e,t,s){const i=e+t;return Math.abs(e)>Math.abs(t)?s[0]=e-i+t:s[0]=t-i+e,i}function ee(e,t){return e%t}function Ht(e){const t=1-e;if(t===0)return 1;let s;if(t<=.01){const i=t,n=Math.log(i);s=1+i*(.4431471805599453-.25*n+i*(.05680519270997949-.09375*n+i*(.02183137044373718-.05859375*n+i*(.011544521417308362-.042724609375*n+i*(.00714200031339596-.0336456298828125*n+i*(.004854743337164948-.027757644653320312*n+i*(.003514687963781376-.023627042770385742*n)))))))}else{if(e<.016){const i=e;return G()*(1-i*(.25+i*(.046875+i*(.01953125+i*(.01068115234375+i*(.0067291259765625+i*(.004626274108886719+i*(.0033752918243408203+i*.0025710230693221092))))))))}s=ts(0,t,1)-e*ss(0,t,1)/3}return ls(s,1,G())}function Os(e,t,s=Number.NaN){if(_(t>=0&&t<=1),t===0)return e;let i=1,n=e;if(n<0&&(n=-n,i=-1),t===1){const m=Math.round(n/Wt()),l=n-m*Wt();return i*(2*m+Math.sin(l))}const r=G(),o=Math.floor(n/r);1&o?n=(o+1)*r-n:n-=o*r;const h=Math.sin(n),a=Number.isNaN(s)?Ht(t):s;let u;if(h===1)u=a+Math.sqrt(1-t)*(n-r);else{const m=n*n;if(.01424*Math.pow(m,4)<=2*X())u=n*(1+m*t*(-1/6+m*((4-3*t)/120-(16+(45*t-60)*t)/5040*m)));else if(t<=.01){const l=Math.sin(2*n),y=Math.sin(4*n),N=Math.sin(6*n),b=Math.sin(8*n),x=Math.sin(10*n);u=n+t*((2*-n+l)/8+t*((-3*n+2*l-.25*y)/64+t*((-20*n+15*l-3*y+N/3)/1024+t*(5*(-140*n+112*l-28*y+16/3*N-.5*b)/65536+7*t*((-63*n+52.5*l-15*y+3.75*N-.625*b+.05*x)/65536+t*(-693*n+594*l-185.625*y+1.375*N-12.375*b+1.8*x-.125*Math.sin(12*n))/1048576)))))}else{const l=h*h,y=Math.cos(n),N=y*y,b=is(h,y,t);u=h*(ts(N,b,1)-t*l*ss(N,b,1)/3)}}return 1&o?u=a*(o+1)-u:u+=a*o,i*u}function ne(e,t,s=Number.NaN){if(e===0)return 0;let i=1,n=e;e<0&&(n=-n,i=-1);const r=Number.isNaN(s)?Ht(t):s,o=Math.floor(n/r);1&o?n=(o+1)*r-n:n-=o*r;let h=n<=0?0:n>=r?G():Us(n,t,r);return 1&o?h=G()*(o+1)-h:h+=G()*o,i*h}function ts(e,t,s){_((e!==0?1:0)+(t!==0?1:0)+1>1);let i=e,n=t,r=s;for(;;){const o=Math.sqrt(i*n)+Math.sqrt(n*r)+Math.sqrt(r*i);i=.25*(i+o),n=.25*(n+o),r=.25*(r+o);const h=(i+n+r)/3,a=(h-i)/h,u=(h-n)/h,m=(h-r)/h;if(Math.abs(a)<=.0024&&Math.abs(u)<=.0024&&Math.abs(m)<=.0024){const l=a*u-m*m,y=a*u*m;return(1+(1/24*l-.1-3/44*y-5*l*l/208+l*y/16)*l+(1/14+3*y/104)*y)/Math.sqrt(h)}}}function ss(e,t,s){_(e!==0||t!==0);let i=e,n=t,r=s;const o=new xt(0);let h=1;for(;;){const a=.2*(i+n+3*r),u=(a-i)/a,m=(a-n)/a,l=(a-r)/a;if(Math.abs(u)<=.0015&&Math.abs(m)<=.0015&&Math.abs(l)<=.0015){const w=u*m,v=l*l,g=w-v,E=w-6*v,I=E+g+g,A=3/26,D=E*(.25*(9/22)*E-.21428571428571427-1.5*A*l*I),R=l*(1/6*I+l*(-.4090909090909091*g+l*A*w));return 3*o.getResult()+h*(1+D+R)/(a*Math.sqrt(a))}const y=Math.sqrt(i),N=Math.sqrt(n),b=Math.sqrt(r),x=y*(N+b)+N*b;o.add(h/(b*(r+x))),h*=.25,i=.25*(i+x),n=.25*(n+x),r=.25*(r+x)}}function is(e,t,s){return e<.999?1-s*O(e):1-s+s*O(t)}function Us(e,t,s){if(t===0)return e;if(t===1)return Math.asin(e);let i=0,n=!0;if(e<.2){const o=e*e,h=e*(1+o*t*(1/6+o*((13*t-4)/120+(16-284*t+493*t*t)/5040*o))),a=Math.abs(t*(4944*t-64-31224*t*t+37369*t*t*t)/362880*Math.pow(e,9));if(a<Math.abs(h)*X())return h;i=h,n=a>.1*h}if(n){const o=1-t,h=1-e/s,a=Math.sqrt(h*h+o*o),u=Math.atan2(o,e+X());i=G()+Math.sqrt(a)*(u-G())}let r=0;for(let o=0;o<7;o++){r=Os(i,t,s);const h=is(Math.sin(i),Math.cos(i),t);if(i-=(r-e)/Math.sqrt(h),o>0&&Math.abs(r-e)<=4*X()*e)break}return i}function re(e,t,s,i,n){return e===0?i===0?t:i===1?s:n:e===1?i===0?t:i===1?s:vt(t,s,i):(e===2&&K("angular interpolation"),void K(""))}function oe(e,t,s,i,n,r,o,h){if(e===0)for(let a=0;a<r;++a)i[a+n]=o===0?t[a]:o===1?s[a]:h;else if(e===1)if(o===0)W(i,t,n,0,r);else if(o===1)W(i,s,n,0,r);else for(let a=0;a<r;++a)i[a+n]=vt(t[a],s[a],o);else if(e===2)if(o===0)W(i,t,n,0,r);else if(o===1)W(i,s,n,0,r);else{let a=0;for(let u=0,m=n;u<r;++u,++m)i[m]=vt(t[u],s[u],o),a+=i[m]*i[m];if(a>0){a=Math.sqrt(a);for(let u=n;u<n+r;++u)i[u]/=a}else{for(let u=n;u<n+r;++u)i[u]=0;i[n]=1}}else K("")}function W(e,t,s,i,n){if(n===0)return;let r=0,o=s,h=i;for(;r++<n;)e[o++]=t[h++]}function he(e,t,s){let i=0;for(let n=0;!i&&n<s;++n)i=e[n]-t[n];return i}function et(e,t){return e}function Qs(e){e.sort((t,s)=>t<s?-1:t>s?1:0)}function ae(e,t){const s=e.slice(0,t);Qs(s),W(e,s,0,0,t)}function ue(e,t,s,i){const n=e.slice(t,t+s);n.sort(i),W(e,n,t,0,s)}function le(e,t){return e<t?-1:e>t?1:0}function ce(e,t,s,i){return e<s?-1:e>s?1:t<i?-1:t>i?1:0}function me(e,t){if(e.length<2)return e.length;let s=0;for(let i=1;i<e.length;++i)t(e[i],e[s])||(s++,e[i]=et(e[s],e[s]=e[i]));return 1+s}function ye(e,t){e[t]=e.at(-1),e.pop()}function fe(e,t=!1){return{[Symbol.dispose](){this.bForget||e()},bForget:t}}function xe(e,t,s){e.length=t,e.fill(s)}function de(e,t,s){e.length=s;for(let i=0;i<s;++i)e[i]=new t}function es(e,t){const s=new Array(t);for(let i=0;i<t;++i)s[i]=new e;return s}function be(e,t,s){for(let i=0;i<s;++i)e[i].assign(t[i]);return s}function ve(e,t){const s=e.slice(0,t);for(let i=0;i<t;++i)s[i]=s[i].clone();return s}function we(e){return Array.from({length:e},()=>null)}function Ne(e,t){return Array.from({length:t},()=>e())}function Vs(e,t){const s=new Array(e);return s.fill(t),s}function pe(e,t){return t in e&&Object.getOwnPropertyNames(e).length===1}class Me{constructor(...t){this.m_elts=t}get length(){return this.m_elts.length}at(t){return this.m_elts[t]}[Symbol.dispose](){for(const t of this.m_elts)t[Symbol.dispose]()}}function Ot(e,t){return{first:e,second:t}}const Ws=Math.PI,js=2*Math.PI,Ys=.5*Math.PI;class _e{constructor(t,s){this.m_cr=t,this.m_cc=s,this.m_v=Vs(t*s,0)}get(t,s){return this.m_v[t*this.m_cc+s]}set(t,s,i){this.m_v[t*this.m_cc+s]=i}inc(t,s){return++this.m_v[t*this.m_cc+s]}}const ns=new ArrayBuffer(8),rs=new Float64Array(ns),os=new BigUint64Array(ns),Xs=0x0fffffffffffffn,Ks=0x7ff0000000000000n;function Ce(){return Number.EPSILON*hi}function nt(e){return rs[0]=e,os[0]}function Js(e){return os[0]=e,rs[0]}function at(e){return nt(e)&Xs}function Ut(e){return Number((nt(e)&Ks)>>52n)}function Q(e){if(e===0n)return-1n;if(e===1n||-1n===e)return 0n;e<0n&&(e=-e);let t=0n,s=512n,i=1n<<t+s;for(;e>=i;)t+=s,s<<=1n,i<<=s;let n=t;s>>=1n;let r=n+s;for(;s>0n;)e<1n<<r||(n=r),s>>=1n,r=n+s;return n}function Qt(e,t){return e===t||Number.isNaN(e)&&Number.isNaN(t)}function ge(e,t,s){return e===t||Math.abs(e-t)<=s||Number.isNaN(e)&&Number.isNaN(t)}function Te(e,t){return e<t?-1:e>t?1:0}function Re(e,t){if(e<t)return-1;if(e>t)return 1;if(e===t)return 0;{const s=Number.isNaN(e),i=Number.isNaN(t);return s<i?-1:s>i?1:0}}function Ee(){return 2147483647}function Ie(){return 32767}function hs(){return 2147483647}function Ae(){return-2147483648}const ut=hs(),Hs=BigInt(ut),as=2166136261,st=16777619;function ti(e){let t=as,s=e;return t=(t^255&s)*st,s>>=8,t=(t^255&s)*st,s>>=8,t=(t^255&s)*st,s>>=8,t=(t^255&s)*st,t&ut}const si=14695981039346656037n,V=1099511628211n;function ii(e){let t=si,s=e;return t=(t^0xffn&s)*V,s>>=8n,t=(t^0xffn&s)*V,s>>=8n,t=(t^0xffn&s)*V,s>>=8n,t=(t^0xffn&s)*V,s>>=8n,t=(t^0xffn&s)*V,s>>=8n,t=(t^0xffn&s)*V,s>>=8n,t=(t^0xffn&s)*V,t&Hs}function ei(e){return 1103515245*e+12345&2147483647}function De(e){let t=as;for(let s=0,i=e.length;s<i;++s)t=(t^e.charCodeAt(s))*st;return t&ut}function pt(e,t){return t+2654435769+(e<<6)+(e>>2)&ut}function Pe(e,t){return pt(e,us(t))}function ni(e){return pt(3735928559,e)}function qe(e,t){return pt(e,ni(t))}function ze(e){return ti(e)}function us(e){return Number(ii(e))}function ri(e){return ui(e)}function Ze(e){return us(nt(ri(e)))}function Se(e){return ei(e)}const oi=100,hi=100;function Vt(){return Number.EPSILON*oi}function Fe(){return .38196601125010515}function $e(){return 1.4142135623730951}function X(){return Number.EPSILON}function ke(e,t,s){return e===t||e===s}function ls(e,t,s){return e>=t?e<=s?e:s:t}function Be(e,t,s){const i=e[0];if(i>=t){if(i<=s)return!1;e[0]=s}else e[0]=t;return!0}function Le(e,t){return e>=t?t:e<-t?-t:e}function Wt(){return Ws}function Ge(){return js}function G(){return Ys}const ai=3*G();function Oe(){return ai}function ui(e){return e+0}function jt(e){return{v:e}}class M{constructor(){this.m_rn=jt(0n),this.m_rd=jt(1n),this.m_bNaN=!1,this.m_bNormalized=!1,this.m_power=0,this.m_sign=0}static constructAssign(t,s){const i=t.clone();return s!==void 0&&i.limitPrecisionThis(s),i}static constructDouble(t){return new M().setDouble(t)}static constructInt64(t){return new M().setInt64(t)}static constructRational(t,s){return new M().setRational(t,s)}static constructInt32(t){return this.constructInt64(BigInt(Math.trunc(t)))}[Symbol.toPrimitive](t){return this}compare(t){return this.lt(t)?-1:this.gt(t)?1:0}assignCopy(t){return this.setThis(t)}abs(){return this.clone().absThis()}absThis(){return this.isNAN()||(this.m_sign*=this.m_sign),this}clone(){return new M().setThis(this)}setThis(t){return this.m_bNaN=t.m_bNaN,this.m_bNormalized=t.m_bNormalized,this.m_rn.v=t.m_rn.v,this.m_rd.v=t.m_rd.v,this.m_power=t.m_power,this.m_sign=t.m_sign,this}setZero(){return this.m_rn.v=0n,this.m_rd.v=1n,this.m_bNaN=!1,this.m_power=0,this.m_bNormalized=!0,this.m_sign=0,this}setDouble(t){if(this.setZero(),t===0)return this;if(Number.isInteger(t)&&Math.abs(t)<hs())return this.setInt32(t);const s=nt(t),i=(s&M.s_em)>>52n,n=!!(s&M.s_sm),r=s&M.s_fm;if(i===M.s_emax)return r?(this.m_rn.v=this.m_rd.v=0n,this.m_bNaN=!0,this):(this.m_rn.v=n?-1n:1n,this.m_rd.v=0n,this);i===0n&&K("denormalized numbers not yet implemented");const o=i-1023n,h=o>=0n?o:0n,a=o<0n?-o:0n;return this.m_rn.v=(1n<<52n|r)<<h,this.m_rd.v=1n<<52n+a,this.m_sign=n?-1:1,this.m_bNormalized=!1,this.normalizeThis()}setInt64(t){return t===0n?this.setZero():(this.m_bNaN=!1,this.m_sign=t>0n?1:-1,this.m_rn.v=t>0n?t:-t,this.m_rd.v=1n,this.m_power=0,this.m_bNormalized=!1,this.normalizeThis())}setRational(t,s){return t===0n?s===0n?this.setNAN():this.setZero():s===0n?t>0n?this.setPositiveInf():this.setNegativeInf():(this.m_sign=(t>0n?1:-1)*(s>0n?1:-1),this.m_rn.v=t>0n?t:-t,this.m_rd.v=s>0n?s:-s,this.m_power=0,this.m_bNormalized=!1,this.normalizeThis())}setInt32(t){return this.setInt64(BigInt(Math.trunc(t)))}getDouble(){return this.convertToDouble()}toDouble(){return this.convertToDouble()}value(){return this.convertToDouble()}isNAN(){return this.m_bNaN}isPositiveInf(){return!this.isNAN()&&this.m_rd.v===0n&&this.m_sign===1}isNegativeInf(){return!this.isNAN()&&this.m_rd.v===0n&&this.m_sign===-1}isFinite(){return!this.isNAN()&&this.m_rd.v!==0n}setNAN(){return this.m_bNaN=!0,this.m_rn.v=0n,this.m_rd.v=0n,this.m_power=0,this.m_bNormalized=!0,this}setPositiveInf(){return this.m_rn.v=1n,this.m_rd.v=0n,this.m_bNaN=!1,this.m_bNormalized=!0,this.m_sign=1,this.m_power=0,this}setNegativeInf(){return this.m_rn.v=1n,this.m_rd.v=0n,this.m_bNaN=!1,this.m_bNormalized=!0,this.m_sign=-1,this.m_power=0,this}subThis(t){if(t.isNAN()&&this.setNAN(),this.isPositiveInf()&&t.isPositiveInf())this.setNAN();else{if(this.isPositiveInf()&&t.isNegativeInf())return this.setPositiveInf(),this;if(this.isNegativeInf()&&t.isNegativeInf())this.setNAN();else if(this.isNegativeInf()&&t.isPositiveInf())return this.setNegativeInf(),this}return this.isNAN()?this:this.opPlusMinus(t,!1)}thisSubAbs(t){return _(0),this}mulThis(t){return t.isNAN()&&this.setNAN(),this.isNAN()?this:(this.m_sign*=t.m_sign,this.m_sign===0?this.setZero():(this.m_rn.v*=t.m_rn.v,this.m_rd.v*=t.m_rd.v,this.m_power+=t.m_power,this.m_bNormalized=!1,this.normalizeThis(),this))}mulDoubleThis(t){return this.mulThis(M.constructDouble(t))}thisMulInt64(t){return _(0),this}thisMulInt32(t){return _(0),this}divThis(t){return this.mulThis(t.clone().invertThis())}divDoubleThis(t){return this.divThis(M.constructDouble(t))}addDoubleThis(t){return this.addThis(M.constructDouble(t))}subDoubleThis(t){return this.subThis(M.constructDouble(t))}mul(t){return this.clone().mulThis(t)}mulBigIntThis(t){return this.mulThis(M.constructInt64(t))}mulDouble(t){return this.clone().mulThis(M.constructDouble(t))}div(t){return this.clone().divThis(t)}divDouble(t){return this.clone().divDoubleThis(t)}add(t){return this.clone().addThis(t)}fmSubThis(t,s){return this.subThis(t.clone().mulThis(s))}fmAddThis(t,s){return this.addThis(t.clone().mulThis(s))}addThis(t){if(t.isNAN()&&this.setNAN(),this.isPositiveInf()&&t.isPositiveInf())return this.setPositiveInf(),this;if(this.isPositiveInf()&&t.isNegativeInf())this.setNAN();else{if(this.isNegativeInf()&&t.isNegativeInf())return this.setNegativeInf(),this;this.isNegativeInf()&&t.isPositiveInf()&&this.setNAN()}return this.isNAN()?this:this.opPlusMinus(t,!0)}addDouble(t){return this.clone().addThis(M.constructDouble(t))}sub(t){return this.clone().subThis(t)}subDouble(t){return this.clone().subThis(M.constructDouble(t))}isZero(){return this.m_sign===0}equals(t){return this.clone().subThis(t).isZero()}lt(t){return!this.isNAN()&&!t.isNAN()&&!(this.isPositiveInf()&&t.isPositiveInf()||this.isNegativeInf()&&t.isNegativeInf())&&!this.isPositiveInf()&&(!!t.isPositiveInf()||this.clone().sub(t).LZ())}absLessAbs(t){return this.abs().lt(t.abs())}gt(t){return this.clone().sub(t).GZ()}lte(t){return this.sub(t).LEZ()}gte(t){return this.sub(t).GEZ()}normalizeThis(){if(this.m_bNormalized)return this;if(this.m_rn.v===0n)return this.setZero();let t=0,s=0xffffffffn;for(;(this.m_rn.v&s)===0n&&s<=this.m_rn.v;)s<<=32n,t+=32;s&=this.m_rn.v,s>>=BigInt(t),t+=dt(BigInt.asUintN(32,s))-1;let i=0;for(s=0xffffffffn;(this.m_rd.v&s)===0n&&s<=this.m_rd.v;)s<<=32n,i+=32;return s&=this.m_rd.v,s>>=BigInt(i),i+=dt(BigInt.asUintN(32,s))-1,this.m_rn.v>>=BigInt(t),this.m_rd.v>>=BigInt(i),this.m_power+=t-i,this.m_rn.v>1n&&this.m_rd.v>1n&&(this.m_rn.v%this.m_rd.v===0n?(this.m_rn.v/=this.m_rd.v,this.m_rd.v=1n):this.m_rd.v%this.m_rn.v===0n&&(this.m_rd.v/=this.m_rn.v,this.m_rn.v=1n)),this.m_bNormalized=!0,this}negateThis(){return this.isNAN()||(this.m_sign*=-1),this}negate(){return this.clone().negateThis()}invertThis(){return this.isNAN()?this:this.isPositiveInf()||this.isNegativeInf()?(this.setZero(),this):this.m_rn.v===0n?(this.setPositiveInf(),this):(this.m_rd=et(this.m_rn,this.m_rn=this.m_rd),this.m_power=-this.m_power,this)}limitPrecisionThis(t){if(t===0)return this;if(this.isZero())return this.setZero();if(!this.isFinite())return this;this.normalizeThis();let s=Number(Q(this.m_rn.v));if(s>t){const i=s-t;this.m_rn.v>>=BigInt(s-t),this.m_power+=i}if(s=Number(Q(this.m_rd.v)),s>t){const i=s-t;this.m_rd.v>>=BigInt(s-t),this.m_power-=i}return this}hiBitIndex(){return Math.max(Number(Q(this.m_rn.v)),Number(Q(this.m_rd.v)))}ldexp(t){return this.clone().ldexpThis(t)}ldexpThis(t){return t&&(this.m_bNormalized=!1,this.m_power+=t,this.normalizeThis()),this}LZ(){return!this.isNAN()&&this.m_sign===-1}GZ(){return!this.isNAN()&&this.m_sign===1}LEZ(){return!this.isNAN()&&this.m_sign<=0}GEZ(){return!this.isNAN()&&this.m_sign>=0}toString(){return this.toDouble().toString()}sqr(){return this.clone().sqrThis()}sqrThis(){return this.mulThis(this.clone())}static sqrt(t,s){if(t.m_sign<0n&&ps("MP_value: sqrt(-1)"),t.isZero())return t.clone();let i=52,n=2220446049250313e-31;for(;i<s;)2*i<=s?(n*=n,i*=2):(n*=2220446049250313e-31,i+=52);i+=52;const r=Q(t.m_rn.v),o=Q(t.m_rd.v);let h,a=t.m_power+Number(r-o);const u=new M;Math.abs(a)>200?(1&Math.abs(a)&&(a+=1),h=M.constructAssign(t,53).ldexpThis(-a).value(),u.setThis(t).ldexpThis(-a),_(Number.isFinite(h))):(u.setThis(t),h=u.value(),_(Number.isFinite(h)),a=0),h=Math.sqrt(h);const m=M.constructDouble(h),l=M.constructDouble(n);l.mulThis(m).ldexpThis(1);const y=n*h*2,N=m.clone(),b=new M;let x;for(let w=0;w<10;++w){N.mulThis(m),b.setThis(u).subThis(N).absThis();let v=b.value();if(x=1,v<.9)for(;v>y;)v*=v,++x;else x=4;if(b.lte(l))break;for(let g=0;g<x;g++)N.setThis(m).divThis(u).invertThis().addThis(m).ldexpThis(-1).limitPrecisionThis(i),m.setThis(N)}return m.ldexpThis(a/2)}static cubicRoot(t,s){if(t.isZero())return t.clone();let i=52,n=2220446049250313e-31;for(;i<s;)2*i<=s?(n*=n,i*=2):(n*=2220446049250313e-31,i+=52);i+=52;const r=Math.pow(Math.abs(t.value()),1/3),o=M.constructDouble(r),h=o.clone();h.sqrThis().mulDoubleThis(3).mulDoubleThis(n),h.limitPrecisionThis(32),t.LZ()&&o.negateThis();for(let a=0;a<10;++a){const u=o.clone();u.sqrThis().mulThis(o);const m=u.clone();if(m.subThis(t),m.absThis().limitPrecisionThis(32),m.lte(h))break;m.setThis(t),m.ldexpThis(1),m.addThis(u);const l=u.clone();l.ldexpThis(1),l.addThis(t),m.divThis(l),o.mulThis(m),o.limitPrecisionThis(i)}return o}isInTheRangeOfDouble(){return _(0),!1}sign(){return this.m_sign}cosAndSin(t,s){_(0)}static nan(){return _(0),new M}convertToDouble(){if(this.m_bNaN)return Number.NaN;if(this.isZero())return 0;if(this.m_rd.v===0n)return this.m_sign===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY;const t=this.m_sign===-1,s=this.m_rn.v<<(this.m_power>=0?BigInt(this.m_power):0n);let i=this.m_rd.v<<(this.m_power<0?BigInt(-this.m_power):0n);const n=s/i;let r=Number(n);if(BigInt(r)!==n)return t?-r:r;let o=s-n*i;if(o){let h=Q(i)-1023n;h>0n&&(i>>=h,o<<=52n,o>>=h);let a=Number(o);Number.isFinite(a)||(o>>=52n,a=Number(o),h=0n),h>0n&&(a/=Math.pow(2,52)),r+=a/Number(i)}return t?-r:r}signVal(){return this.m_sign===1?1n:this.m_sign===-1?-1n:0n}opPlusMinus(t,s){const i=Math.min(this.m_power,t.m_power);let n,r;this.m_power>i?(n=BigInt(this.m_power-i),r=0n):(n=0n,r=BigInt(t.m_power-i));const o=this.signVal()*this.m_rn.v*t.m_rd.v<<n,h=t.signVal()*t.m_rn.v*this.m_rd.v<<r;return this.m_rn.v=s?o+h:o-h,this.m_rd.v*=t.m_rd.v,this.m_power=i,this.m_sign=1,this.m_rn.v<0n&&(this.m_sign=-1,this.m_rn.v=-this.m_rn.v),this.m_bNormalized=!1,this.normalizeThis(),this}}M.s_sm=0x8000000000000000n,M.s_em=0x7ff0000000000000n,M.s_fm=0x000fffffffffffffn,M.s_emax=0x7ffn;const Ue=M.constructInt32(1),Qe=M.constructInt32(0);function li(e,t){return Zs(e^t)}function ci(e,t){let s=Ut(e);const i=Ut(t);return s===i?(s-=53-li(at(e),at(t)),s):s>i?s:i}function Ve(e,t){for(let s=0,i=0,n=e.length;s<n;s+=2,i++)t[i].x=e[s],t[i].y=e[s+1]}function We(e){const t=new Float64Array(2*e.length);for(let s=0,i=e.length;s<i;++s){const n=s<<1;t[n]=e[s].x,t[n+1]=e[s].y}return t}function je(e){const t=es(p,e.length);for(let s=0,i=e.length;s<i;++s)t[s].setCoords(e[s][0],e[s][1]);return t}class p{static construct(t,s){return new p(t,s)}constructor(t,s){t!==void 0?(this.x=t,this.y=s):this.x=this.y=Number.NaN}clone(){return new p(this.x,this.y)}assign(t){this.setCoordsPoint2D(t)}setCoords(t,s){return this.x=t,this.y=s,this}setCoordsPoint2D(t){this.x=t.x,this.y=t.y}isEqualPoint2D(t,s){return s!==void 0?Math.abs(this.x-t.x)<=s&&Math.abs(this.y-t.y)<=s:this.x===t.x&&this.y===t.y}isEqual(t,s,i){return i!==void 0?Math.abs(this.x-t)<=i&&Math.abs(this.y-s)<=i:this.x===t&&this.y===s}equalsPoint2D(t,s){return this.isEqualPoint2D(t,s)}setSub(t,s){this.x=t.x-s.x,this.y=t.y-s.y}addThis(t){return this.x+=t.x,this.y+=t.y,this}setAdd(t,s){return this.x=t.x+s.x,this.y=t.y+s.y,this}absoluteOther(t){}absolute(){return _(0),this}setNegate(){this.x=-this.x,this.y=-this.y}setNegateOther(t){this.x=-t.x,this.y=-t.y}interpolateThis(t,s){}interpolate(t,s,i){_(0)}scaleAddThis(t,s){this.x=this.x*t+s.x,this.y=this.y*t+s.y}setScaleAdd(t,s,i){this.x=s.x*t+i.x,this.y=s.y*t+i.y}scaleOther(t,s){_(0)}scale(t){this.x*=t,this.y*=t}compare(t){return this.y<t.y?-1:this.y>t.y?1:this.x<t.x?-1:this.x>t.x?1:0}compareX(t){return this.x<t.x?-1:this.x>t.x?1:this.y<t.y?-1:this.y>t.y?1:0}normalizeOther(t){_(0)}normalize(){const t=this.length();return t?(this.x/=t,this.y/=t):(this.x=1,this.y=0),this}getUnitVector(){return this.clone().normalize()}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}sqrLength(){return this.x*this.x+this.y*this.y}static averageFast(t,s){return _(0),{}}static average(t,s){const i=new p;if(s===0)return i.setNAN(),i;if(s===1)return i.assign(t[0]),i;const n=new xt(t[0].x),r=new xt(t[0].y);for(let o=1;o<s;o++)n.add(t[o].x),r.add(t[o].y),255&o||(n.normalize(),r.normalize());return i.x=n.getResult()/s,i.y=r.getResult()/s,i}offset(t,s){const i=p.distance(t,s),n=p.construct(this.x,this.y);if(i===0)return p.distance(n,t);const r=s.clone();return r.subThis(t),n.subThis(t),n.crossProduct(r)/i}side(t,s){return t.equals(s)?this.equals(t)?0:1:p.orientationRobust(s,t,this)}static sqrDistance(t,s){const i=t.x-s.x,n=t.y-s.y;return i*i+n*n}static sqrDistanceCoords(t,s,i,n){const r=i-t,o=n-s;return r*r+o*o}static distance(t,s){return Math.sqrt(p.sqrDistance(t,s))}dotProduct(t){return this.x*t.x+this.y*t.y}dotProductAbs(t){return Math.abs(this.x*t.x)+Math.abs(this.y*t.y)}crossProduct(t){return this.x*t.y-this.y*t.x}crossProductAbs(t){return _(0),0}rotateDirect(t,s){const i=this.x*t-this.y*s,n=this.x*s+this.y*t;this.x=i,this.y=n}rotateReverse(t,s){const i=this.x*t+this.y*s,n=-this.x*s+this.y*t;this.x=i,this.y=n}leftPerpendicularThis(){const t=this.x;this.x=-this.y,this.y=t}leftPerpendicularOther(t){const s=t.x;this.x=-t.y,this.y=s}rightPerpendicularThis(){const t=this.x;this.x=this.y,this.y=-t}rightPerpendicularOther(t){const s=t.x;this.x=t.y,this.y=-s}equals(t){return this.x===t.x&&this.y===t.y}notequals(t){return this.x!==t.x||this.y!==t.y}not(){return!this.x&&!this.y}gt(t){return this.y>t.y||this.y===t.y&&this.x>t.x}gte(t){return!this.lt(t)}lt(t){return this.y<t.y||this.y===t.y&&this.x<t.x}lte(t){return!this.gt(t)}subThis(t){return this.x-=t.x,this.y-=t.y,this}divThis(t){return this.x/=t,this.y/=t,this}add(t){return new p(this.x+t.x,this.y+t.y)}sub(t){return new p(this.x-t.x,this.y-t.y)}negateThis(){return this.x=-this.x,this.y=-this.y,this}negate(){return new p(-this.x,-this.y)}mul(t){return new p(this.x*t,this.y*t)}mulThis(t){return this.x*=t,this.y*=t,this}divide(t){return new p(this.x/t,this.y/t)}setNAN(){this.x=this.y=Number.NaN}isNAN(){return Number.isNaN(this.x)||Number.isNaN(this.y)}static getNAN(){return new p(Number.NaN,Number.NaN)}isFinite(){return Number.isFinite(this.x)&&Number.isFinite(this.y)}isZero(){return this.x===0&&this.y===0}norm(t){switch(t){case 0:{const s=Math.abs(this.x),i=Math.abs(this.y),n=s-i;return n>=0?s:n<=0?i:Number.NaN}case 1:return Math.abs(this.x)+Math.abs(this.y);case 2:return Math.sqrt(this.x*this.x+this.y*this.y);default:Y("norm")}}getQuarter(){return p.getQuarterCoords(this.x,this.y)}static getQuarterCoords(t,s){return t>0?s>=0?1:4:s>0?2:t===0?4:3}static compareVectors(t,s){const i=t.getQuarter(),n=s.getQuarter();return n===i?p.orientationRobustImpl(p.construct(0,0),s,t,!0):i<n?-1:1}static compareVectorsOrigin(t,s,i){const n=s.sub(t),r=i.sub(t),o=n.getQuarter(),h=r.getQuarter();return h===o?p.orientationRobustImpl(t,i,s,!0):o<h?-1:1}static orientationRobust(t,s,i){return p.orientationRobustImpl(t,s,i,!1)}static orientationRobustEx(t,s,i,n){if(t.equals(s)||i.equals(n))return 0;const r=s.x-t.x,o=s.y-t.y,h=n.x-i.x,a=n.y-i.y;{const N=p.getQuarterCoords(r,o)-1,b=p.getQuarterCoords(h,a)-1,x=p.d[N][b];if(x!==0)return x}const u=r*a,m=o*h,l=4*X()*(Math.abs(u)+Math.abs(m)),y=u-m;return Math.abs(y)>=l?y<0?-1:y>0?1:0:p.orientationRobustExMp(t,s,i,n)}static orientationRobustExMp(t,s,i,n){const r=M.constructDouble(s.x),o=M.constructDouble(n.x);r.subThis(M.constructDouble(t.x)),o.subThis(M.constructDouble(i.x));const h=M.constructDouble(s.y),a=M.constructDouble(n.y);return h.subThis(M.constructDouble(t.y)),a.subThis(M.constructDouble(i.y)),r.mulThis(a),h.mulThis(o),r.subThis(h),r.LZ()?-1:r.GZ()?1:0}static orientationNonRobust(t,s,i){const n=s.sub(t).crossProduct(i.sub(t));return n<0?-1:n>0?1:0}static orientationRobustImpl(t,s,i,n){if(s.isEqualPoint2D(t)||i.isEqualPoint2D(t)||s.isEqualPoint2D(i))return 0;const r=s.x-t.x,o=s.y-t.y,h=i.x-t.x,a=i.y-t.y;if(!n){const l=p.getQuarterCoords(r,o)-1,y=p.getQuarterCoords(h,a)-1,N=p.d[l][y];if(N!==0)return N}const u=(Math.abs(r)+Math.abs(o)+Math.abs(h)+Math.abs(a))*(Math.abs(s.x)+Math.abs(s.y)+Math.abs(i.x)+Math.abs(i.y))*8*Nt(),m=r*a-o*h;if(Math.abs(m)>u)return m<0?-1:1;if($(s.x,t.x)&&$(i.y,t.y)&&$(s.y,t.y)&&$(i.x,t.x)&&z(r,a)&&z(o,h)){const l=r*a,y=o*h;if($(l,y)){const N=l-y;return N<0?-1:N>0?1:0}}return p.orientationRobustMp(t,s,i)}static orientationRobustMp(t,s,i){const n=M.constructDouble(s.x),r=M.constructDouble(i.x);{const a=M.constructDouble(t.x);n.subThis(a),r.subThis(a)}const o=M.constructDouble(i.y),h=M.constructDouble(s.y);{const a=M.constructDouble(t.y);o.subThis(a),h.subThis(a)}return n.mulThis(o),h.mulThis(r),n.subThis(h),n.LZ()?-1:n.GZ()?1:0}static inCircleRobust(t,s,i,n){const r=new T,o=new T;r.set(t.x),r.subThis(n.x),o.set(t.y),o.subThis(n.y);const h=new T,a=new T;h.set(s.x),h.subThis(n.x),a.set(s.y),a.subThis(n.y);const u=new T,m=new T;u.set(i.x),u.subThis(n.x),m.set(i.y),m.subThis(n.y);const l=r.mulE(a).subE(o.mulE(h)),y=h.mulE(m).subE(a.mulE(u)),N=r.mulE(m).subE(o.mulE(u)),b=r.mulE(r).addE(o.mulE(o)),x=h.mulE(h).addE(a.mulE(a)),w=u.mulE(u).addE(m.mulE(m)),v=b.mulE(y).subE(x.mulE(N)).addE(w.mulE(l));if(!v.isFuzzyZero()){const g=v.value();return g<0?-1:g>0?1:0}return p.inCircleRobustMp(t,s,i,n)}static inCircleRobustMp(t,s,i,n){do{if(!$(t.x,n.x)||!$(t.y,n.y)||!$(s.x,n.x)||!$(s.y,n.y)||!$(i.x,n.x)||!$(i.y,n.y))break;const I=t.x-n.x,A=t.y-n.y,D=s.x-n.x,R=s.y-n.y,F=i.x-n.x,k=i.y-n.y;if(!z(I,R)||!z(A,D)||!z(D,k)||!z(R,F)||!z(I,k)||!z(A,F)||!z(I,I)||!z(A,A)||!z(D,D)||!z(R,R)||!z(F,F)||!z(k,k))break;const J=I*R,q=A*D,c=D*k,C=R*F,f=I*k,d=A*F,Z=I*I,S=A*A,Mt=D*D,_t=R*R,Ct=F*F,gt=k*k;if(!$(J,q)||!$(c,C)||!$(f,d)||!rt(Z,S)||!rt(Mt,_t)||!rt(Ct,gt))break;const Tt=J-q,Rt=c-C,Et=f-d,It=Z+S,At=Mt+_t,Dt=Ct+gt;if(!z(It,Rt)||!z(At,Et)||!z(Dt,Tt))break;const Pt=It*Rt,qt=At*Et,zt=Dt*Tt;if(!$(Pt,qt))break;const Zt=Pt-qt;if(!rt(Zt,zt))break;const St=Zt+zt;return St<0?-1:St>0?1:0}while(!1);const r=M.constructDouble(n.x),o=M.constructDouble(n.y),h=M.constructDouble(t.x),a=M.constructDouble(t.y);h.subThis(r),a.subThis(o);const u=M.constructDouble(s.x),m=M.constructDouble(s.y);u.subThis(r),m.subThis(o);const l=M.constructDouble(i.x),y=M.constructDouble(i.y);l.subThis(r),y.subThis(o);const N=h.mul(m).sub(a.mul(u)),b=u.mul(y).sub(m.mul(l)),x=h.mul(y).sub(a.mul(l)),w=h.mul(h).add(a.mul(a)),v=u.mul(u).add(m.mul(m)),g=l.mul(l).add(y.mul(y)),E=w.mul(b).sub(v.mul(x)).add(g.mul(N));return E.LZ()?-1:E.GZ()?1:0}static inCircleRobustMp3Point(t,s,i){const n=M.constructDouble(t.x),r=M.constructDouble(t.y),o=M.constructDouble(s.x),h=M.constructDouble(s.y),a=M.constructDouble(i.x),u=M.constructDouble(i.y),m=a.mul(a).add(u.mul(u)).sub(a.mul(n).add(u.mul(r)).add(a.mul(o)).add(u.mul(h))).add(n.mul(o).add(r.mul(h)));return m.LZ()?-1:m.GZ()?1:0}static inCircleRobust3Point(t,s,i){const n=new T(t.x),r=new T(t.y),o=new T(s.x),h=new T(s.y),a=new T(i.x),u=new T(i.y),m=a.mulE(a).addE(u.mulE(u)).subE(a.mulE(n).addE(u.mulE(r)).addE(a.mulE(o)).addE(u.mulE(h))).addE(n.mulE(o).addE(r.mulE(h)));if(!m.isFuzzyZero()){const l=m.value();return l<0?-1:l>0?1:0}return p.inCircleRobustMp3Point(t,s,i)}static calculateCircleCenterFromThreePoints(t,s,i){if(t.equals(i)||t.equals(s)||i.equals(s))return p.getNAN();const n=mi(t,s,i);return n.isNAN()?yi(t,s,i):n}static calculateAngle(t,s){return Math.atan2(t.crossProduct(s),t.dotProduct(s))}static isBisectorRobust(t,s,i){return _(0),!1}static size(){return 2}get 0(){return this.x}get 1(){return this.y}set 0(t){this.x=t}set 1(t){this.y=t}static compareZorder(t,s){const i=p.c_compare_zorder_xx[t.x<0?1:0]|p.c_compare_zorder_yy[t.y<0?1:0],n=p.c_compare_zorder_xx[s.x<0?1:0]|p.c_compare_zorder_yy[s.y<0?1:0];if(i===n){let r=0,o=0;for(let h=0;h<2;++h){const a=ci(t[h],s[h]);a>r&&(r=a,o=h)}return t[o]<s[o]}return i<n}static lerp(t,s,i){const n=new p;return $t(t,s,i,n),n}static getClosestCoordinate(t,s,i,n=!1){const r=p.getNAN();r.setSub(s,t);const o=r.sqrLength();if(o===0)return .5;if(s.isEqualPoint2D(i))return 1;const h=p.getNAN();h.setSub(i,t);let a=h.dotProduct(r)/o;return n||(a<0?a=0:a>1&&(a=1)),a}static intersectLinesAtOnePoint(t,s,i,n){if(t.equals(s)||i.equals(n))return p.getNAN();const r=s.x-t.x,o=i.x-n.x,h=s.y-t.y,a=i.y-n.y,u=r*a-o*h;if(!u)return p.getNAN();const m=u;if(m===0)return p.getNAN();let l=(i.x-t.x)*a-(i.y-t.y)*o;l/=m;const y=new p;return $t(t,s,l,y),y.isFinite()?y:p.getNAN()}toString(){return`[${this.x},${this.y}]`}}function mi(e,t,s){const i=new T(t.x);i.subThis(e.x);const n=new T(t.y);n.subThis(e.y);const r=new T(s.x);r.subThis(e.x);const o=new T(s.y);o.subThis(e.y);const h=i.clone();h.mulThisE(o);let a=n.clone();if(a.mulThisE(r),h.subThisE(a),h.value()===0)return p.getNAN();h.mulThis(2);const u=i.clone();u.mulThisE(i);const m=n.clone();m.mulThisE(n);const l=u.clone();l.addThisE(m);const y=r.clone();y.mulThisE(r);const N=o.clone();N.mulThisE(o);const b=y.clone();b.addThisE(N);const x=n.clone();x.mulThisE(b),a=o.clone(),a.mulThisE(l),x.subThisE(a),x.divThisE(h);const w=i.clone();w.mulThisE(b),a=r.clone(),a.mulThisE(l),w.subThisE(a),w.divThisE(h);const v=p.construct(e.x-x.value(),e.y+w.value()),g=e.sub(v).length(),E=t.sub(v).length(),I=s.sub(v).length(),A=1e-15*(g+Math.abs(e.x)+Math.abs(t.x)+Math.abs(s.x)+Math.abs(e.y)+Math.abs(t.y)+Math.abs(s.y));return Math.abs(g-E)<=A&&Math.abs(g-I)<=A&&x.eps()<A&&w.eps()<A?v:p.getNAN()}function yi(e,t,s){const i=M.constructDouble(t.x);i.subDoubleThis(e.x);const n=M.constructDouble(t.y);n.subDoubleThis(e.y);const r=M.constructDouble(s.x);r.subDoubleThis(e.x);const o=M.constructDouble(s.y);o.subDoubleThis(e.y);const h=i.clone();h.mulThis(o);let a=n.clone();if(a.mulThis(r),h.subThis(a),h.isZero())return p.getNAN();h.mulDoubleThis(2);const u=i.clone();u.mulThis(i);const m=n.clone();m.mulThis(n);const l=u.clone();l.addThis(m);const y=r.clone();y.mulThis(r);const N=o.clone();N.mulThis(o);const b=y.clone();b.addThis(N);const x=n.clone();x.mulThis(b),a=o.clone(),a.mulThis(l),x.subThis(a),x.divThis(h);const w=i.clone();return w.mulThis(b),a=r.clone(),a.mulThis(l),w.subThis(a),w.divThis(h),p.construct(e.x-x.value(),e.y+w.value())}p.dimensions=2,p.d=[[0,1,0,-1],[-1,0,1,0],[0,-1,0,1],[1,0,-1,0]],p.c_compare_zorder_xx=[2,0],p.c_compare_zorder_yy=[1,0];class P{constructor(t,s,i){if(t instanceof P)return this.data=t.data,this.N=t.N,this.M=t.M,t.data=null,t.N=0,void(t.M=0);this.data=t,this.N=s,this.M=i}assignCopy(t){return this===t||(_(this.N*this.M==t.N*t.M),this.data.set(t.data),this.N=t.N,this.M=t.M),this}setZero(){var t;return(t=this.data)==null||t.fill(0),this}setIdentity(){for(let i=0;i<this.N;i++)for(let n=0;n<this.M;n++)this.setRowCol(i,n,i===n?1:0);return this}rows(){return this.N}cols(){return this.M}row(t){return _(0),{}}set(t,s){return this.data[t]=s,this}setRowCol(t,s,i){return this.data[t*this.M+s]=i,this}at(t){return this.data[t]}atRowCol(t,s){return this.data[t*this.M+s]}mulScalar(t,s){_(0)}mul(t,s){if(_(this.M===t.rows()),_(this.N===s.rows()),_(t.cols()===s.cols()),s===this){const n=new Float64Array(this.N*this.M),r=new P(n,this.N,this.M);return this.mul(t,r),void s.assignCopy(r)}if(s===t){const n=new Float64Array(t.N*t.M),r=new P(n,t.N,t.M);return this.mul(t,r),void s.assignCopy(r)}const i=t.cols();for(let n=0;n<this.N;n++)for(let r=0;r<i;r++){let o=0;for(let h=0;h<this.M;h++)o+=this.atRowCol(n,h)*t.atRowCol(h,r);s.setRowCol(n,r,o)}}mulTranspose(t,s){if(_(this.M===t.cols()),_(this.N===s.rows()),_(t.rows()===s.cols()),s===this){const n=new Float64Array(this.N*this.M),r=new P(n,this.N,this.M);return this.mulTranspose(t,r),void s.assignCopy(r)}if(s===t){const n=new Float64Array(t.N*t.M),r=new P(n,t.N,t.M);return this.mulTranspose(t,r),void s.assignCopy(r)}const i=t.rows();for(let n=0;n<this.N;n++)for(let r=0;r<i;r++){let o=0;for(let h=0;h<this.M;h++)o+=this.atRowCol(n,h)*t.atRowCol(r,h);s.setRowCol(n,r,o)}}mulLeft(t,s){_(0)}mulLeftTranspose(t,s){_(0)}mulDiag(t,s){if(_(this.M===t.N*t.M),_(this.N===s.rows()),_(this.M===s.cols()),s===this){const n=new Float64Array(this.N*this.M),r=new P(n,this.N,this.M);return this.mulDiag(t,r),void s.assignCopy(r)}const i=this.M;for(let n=0;n<this.N;n++)for(let r=0;r<i;r++)s.setRowCol(n,r,this.atRowCol(n,r)*t.at(r))}transposeInPlace(){if(this.N===this.M){for(let i=0;i<this.N;i++)for(let n=i+1;n<this.M;n++){const r=this.atRowCol(i,n);this.setRowCol(i,n,this.atRowCol(n,i)),this.setRowCol(n,i,r)}return this}const t=new Float64Array(this.N*this.M),s=new P(t,this.N,this.M);return s.assignCopy(this),this.M=et(this.N,this.N=this.M),s.transpose(this),this}transpose(t){if(this!==t){P.checkDims(t,this.M,this.N);for(let s=0;s<this.N;s++)for(let i=0;i<this.M;i++)t.setRowCol(i,s,this.atRowCol(s,i))}else t.transposeInPlace()}add(t,s){}svd(t,s,i,n=!1){if(P.checkDims(t,this.N,this.M),P.checkDims(s,this.M,1),P.checkDims(i,this.M,this.M),n){if(_(this.N===this.M),!this.symmetricEigen(s,i))return!1;for(let c=0;c<this.M;++c)s.at(c)<0&&s.set(c,0);return t.assignCopy(i),!0}let r,o,h,a,u,m,l,y=0,N=0,b=0,x=0,w=0;const v=this.M,g=this.N;t.assignCopy(this);const E=new Float64Array(v),I=new P(E,v,1),A=(c,C)=>C>=0?Math.abs(c):-Math.abs(c),D=(c,C)=>{if((c=Math.abs(c))>(C=Math.abs(C))){const f=C/c;return c*Math.sqrt(f*f+1)}if(C>0){const f=c/C;return C*Math.sqrt(f*f+1)}return 0};for(let c=0;c<v;c++){if(y=c+1,I.set(c,x*b),b=a=x=0,c<g){for(let f=c;f<g;f++)x+=Math.abs(t.atRowCol(f,c));if(x){for(let f=c;f<g;f++)t.setRowCol(f,c,t.atRowCol(f,c)/x),a+=t.atRowCol(f,c)*t.atRowCol(f,c);o=t.atRowCol(c,c),b=-A(Math.sqrt(a),o),h=o*b-a,t.setRowCol(c,c,o-b);for(let f=y;f<v;f++){a=0;for(let d=c;d<g;d++)a+=t.atRowCol(d,c)*t.atRowCol(d,f);o=a/h;for(let d=c;d<g;d++)t.setRowCol(d,f,t.atRowCol(d,f)+o*t.atRowCol(d,c))}for(let f=c;f<g;f++)t.setRowCol(f,c,t.atRowCol(f,c)*x)}}if(s.set(c,x*b),b=a=x=0,c<g&&c!==v-1){for(let f=y;f<v;f++)x+=Math.abs(t.atRowCol(c,f));if(x){for(let f=y;f<v;f++)t.setRowCol(c,f,t.atRowCol(c,f)/x),a+=t.atRowCol(c,f)*t.atRowCol(c,f);o=t.atRowCol(c,y),b=-A(Math.sqrt(a),o),h=o*b-a,t.setRowCol(c,y,o-b);for(let f=y;f<v;f++)I.set(f,t.atRowCol(c,f)/h);for(let f=y;f<g;f++){a=0;for(let d=y;d<v;d++)a+=t.atRowCol(f,d)*t.atRowCol(c,d);for(let d=y;d<v;d++)t.setRowCol(f,d,t.atRowCol(f,d)+a*I.at(d))}for(let f=y;f<v;f++)t.setRowCol(c,f,t.atRowCol(c,f)*x)}}const C=Math.abs(s.at(c))+Math.abs(I.at(c));w=C>w?C:w}for(let c=v-1;c>=0;c--){if(c<v-1){if(b){for(let C=y;C<v;C++)i.setRowCol(C,c,t.atRowCol(c,C)/t.atRowCol(c,y)/b);for(let C=y;C<v;C++){a=0;for(let f=y;f<v;f++)a+=t.atRowCol(c,f)*i.atRowCol(f,C);for(let f=y;f<v;f++)i.setRowCol(f,C,i.atRowCol(f,C)+a*i.atRowCol(f,c))}}for(let C=y;C<v;C++)i.setRowCol(c,C,0),i.setRowCol(C,c,0)}i.setRowCol(c,c,1),b=I.at(c),y=c}for(let c=(g<v?g:v)-1;c>=0;c--){y=c+1,b=s.at(c);for(let C=y;C<v;C++)t.setRowCol(c,C,0);if(b){b=1/b;for(let C=y;C<v;C++){a=0;for(let f=y;f<g;f++)a+=t.atRowCol(f,c)*t.atRowCol(f,C);o=a/t.atRowCol(c,c)*b;for(let f=c;f<g;f++)t.setRowCol(f,C,t.atRowCol(f,C)+o*t.atRowCol(f,c))}for(let C=c;C<g;C++)t.setRowCol(C,c,t.atRowCol(C,c)*b)}else for(let C=c;C<g;C++)t.setRowCol(C,c,0);t.setRowCol(c,c,t.atRowCol(c,c)+1)}for(let c=v-1;c>=0;c--)for(let C=1;;C++){let f=1;for(y=c;y>=0;y--){if(N=y-1,Math.abs(I.at(y))+w===w){f=0;break}if(Math.abs(s.at(N))+w===w)break}if(f){r=0,a=1;for(let d=y;d<=c&&(o=a*I.at(d),I.set(d,I.at(d)*r),Math.abs(o)+w!==w);d++){b=s.at(d),h=D(o,b),s.set(d,h),h=1/h,r=b*h,a=-o*h;for(let Z=0;Z<g;Z++)m=t.atRowCol(Z,N),l=t.atRowCol(Z,d),t.setRowCol(Z,N,m*r+l*a),t.setRowCol(Z,d,l*r-m*a)}}if(l=s.at(c),y===c){if(l<0){s.set(c,-l);for(let d=0;d<v;d++)i.setRowCol(d,c,-i.atRowCol(d,c))}break}if(C===100)return!1;u=s.at(y),N=c-1,m=s.at(N),b=I.at(N),h=I.at(c),o=((m-l)*(m+l)+(b-h)*(b+h))/(2*h*m),b=D(o,1),o=((u-l)*(u+l)+h*(m/(o+A(b,o))-h))/u,r=a=1;for(let d=y;d<=N;d++){const Z=d+1;b=I.at(Z),m=s.at(Z),h=a*b,b*=r,l=D(o,h),I.set(d,l),r=o/l,a=h/l,o=u*r+b*a,b=b*r-u*a,h=m*a,m*=r;for(let S=0;S<v;S++)u=i.atRowCol(S,d),l=i.atRowCol(S,Z),i.setRowCol(S,d,u*r+l*a),i.setRowCol(S,Z,l*r-u*a);l=D(o,h),s.set(d,l),l&&(l=1/l,r=o*l,a=h*l),o=r*b+a*m,u=r*m-a*b;for(let S=0;S<g;S++)m=t.atRowCol(S,d),l=t.atRowCol(S,Z),t.setRowCol(S,d,m*r+l*a),t.setRowCol(S,Z,l*r-m*a)}I.set(y,0),I.set(c,o),s.set(c,u)}const R=new Float64Array(this.N),F=new Float64Array(this.M),k=new P(R,this.N,1),J=new P(F,this.M,1);let q=1;do q*=3,q++;while(q<=this.M);do{q/=3,q=Math.trunc(q);for(let c=q;c<this.M;c++){const C=s.at(c);for(let d=0;d<this.N;d++)k.set(d,t.atRowCol(d,c));for(let d=0;d<this.M;d++)J.set(d,i.atRowCol(d,c));let f=c;for(;s.at(f-q)<C;){s.set(f,s.at(f-q));for(let d=0;d<this.N;d++)t.setRowCol(d,f,t.atRowCol(d,f-q));for(let d=0;d<this.M;d++)i.setRowCol(d,f,i.atRowCol(d,f-q));if(f-=q,f<q)break}s.set(f,C);for(let d=0;d<this.N;d++)t.setRowCol(d,f,k.at(d));for(let d=0;d<this.M;d++)i.setRowCol(d,f,J.at(d))}}while(q>1);for(let c=0;c<this.M;c++){let C=0;for(let f=0;f<this.N;f++)t.atRowCol(f,c)<0&&C++;for(let f=0;f<this.M;f++)i.atRowCol(f,c)<0&&C++;if(C>Math.trunc((this.N+this.M)/2)){for(let f=0;f<this.N;f++)t.setRowCol(f,c,-t.atRowCol(f,c));for(let f=0;f<this.M;f++)i.setRowCol(f,c,-i.atRowCol(f,c))}}return!0}isSymmetric(){if(this.N!==this.M)return!1;for(let t=0;t<this.N;t++)for(let s=t+1;s<this.M;s++)if(this.atRowCol(t,s)!==this.atRowCol(s,t))return!1;return!0}isZero(){return _(0),!1}isIdentity(){return _(0),!1}equals(t,s){if(s!==void 0&&_(0),this.N!==t.N||this.M!==t.M)return!1;for(let i=0;i<this.N*this.M;i++)if(this.data[i]!==t.data[i])return!1;return!0}maxElement(){return _(0),0}minElement(){return _(0),0}determinant(){if(_(this.N===this.M),this.N===1)return this.data[0];if(this.N===2)return this.data[0]*this.data[3]-this.data[1]*this.data[2];if(this.N===3){const r=this;return r.atRowCol(0,0)*(r.atRowCol(1,1)*r.atRowCol(2,2)-r.atRowCol(1,2)*r.atRowCol(2,1))-r.atRowCol(0,1)*(r.atRowCol(1,0)*r.atRowCol(2,2)-r.atRowCol(2,0)*r.atRowCol(1,2))+r.atRowCol(0,2)*(r.atRowCol(1,0)*r.atRowCol(2,1)-r.atRowCol(1,1)*r.atRowCol(2,0))}const t=new Float64Array(this.N*this.N),s=new P(t,this.N,this.N),i=new Float64Array(this.N);if(!this.luDecomposition(s,i))return 0;let n=1;for(let r=0;r<this.N;r++)n*=s.atRowCol(r,r),i[r]!==r&&(n=-n);return n}submatrix(t,s,i){_(0)}inverse(t){_(0)}pseudoInverse(t,s=!1,i=2220446049250313e-31){if(t.setZero(),this.N===1&&this.M===1)return this.atRowCol(0,0)!==0?t.setRowCol(0,0,1/this.atRowCol(0,0)):t.setRowCol(0,0,0),!0;if(this.N===2&&this.M===2){const y=this.atRowCol(0,0)*this.atRowCol(1,1)-this.atRowCol(0,1)*this.atRowCol(1,0),N=1e-5*(Math.abs(this.atRowCol(0,0)*this.atRowCol(1,1))+Math.abs(this.atRowCol(0,1)*this.atRowCol(1,0)));if(Math.abs(y)>N)return t.setRowCol(0,0,this.atRowCol(1,1)/y),t.setRowCol(0,1,-this.atRowCol(0,1)/y),t.setRowCol(1,0,-this.atRowCol(1,0)/y),t.setRowCol(1,1,this.atRowCol(0,0)/y),!0}const n=new Float64Array(this.N*this.M),r=new P(n,this.N,this.M),o=new Float64Array(this.M),h=new P(o,this.M,1),a=new Float64Array(this.M*this.M),u=new P(a,this.M,this.M);if(!this.svd(r,h,u,s))return!1;const m=Math.max(this.N,this.M),l=i*Math.abs(h.at(0))*m;for(let y=0;y<this.M;y++)h.at(y)>l?h.set(y,1/h.at(y)):h.set(y,0);return u.mulDiag(h,t),t.mulTranspose(r,t),!0}luDecomposition(t,s){return _(0),!1}symmetricEigen(t,s){_(this.rows()===this.cols()),_(this.rows()===t.rows()),_(s.rows()===s.cols()&&s.rows()===this.rows()),_(this.isSymmetric());const i=new Float64Array(this.N*this.M),n=new P(i,this.N,this.M);n.assignCopy(this);const r=100/Number.EPSILON,o=this.rows(),h=new Float64Array(o),a=new Float64Array(o),u=new P(h,o,1),m=new P(a,o,1);for(let y=0;y<o;y++)u.set(y,n.atRowCol(y,y)),t.set(y,n.atRowCol(y,y)),m.set(y,0);s.setIdentity();const l=()=>{const y=u;s.transposeInPlace();let N=1;do N*=3,N++;while(N<=o);do{N/=3,N=Math.trunc(N);for(let b=N;b<o;b++){const x=t.at(b),w=Math.abs(x);for(let g=0;g<this.M;g++)y.set(g,s.atRowCol(g,b));let v=b;for(;Math.abs(t.at(v-N))<w;){t.set(v,t.at(v-N));for(let g=0;g<this.M;g++)s.setRowCol(g,v,s.atRowCol(g,v-N));if(v-=N,v<N)break}if(v!==b){t.set(v,x);for(let g=0;g<this.M;g++)s.setRowCol(g,v,y.at(g))}}}while(N>1)};for(let y=1;;y++){let N=0;for(let x=1;x<o;x++)for(let w=0;w<x;w++)N+=Math.abs(n.atRowCol(x,w));if(N===0)return l(),!0;const b=y<4?.2*N/(o*o):0;for(let x=0;x<o;x++)for(let w=x+1;w<o;w++){let v=r*Math.abs(n.atRowCol(w,x));if(y>4&&v<=Math.abs(t.at(x))&&v<=Math.abs(t.at(w)))n.setRowCol(w,x,0);else if(Math.abs(n.atRowCol(w,x))>b){let g,E=t.at(w)-t.at(x);if(v<Math.abs(E))g=n.atRowCol(w,x)/E;else{const F=.5*E/n.atRowCol(w,x);g=1/(Math.abs(F)+Math.sqrt(1+F*F)),F<0&&(g=-g)}const I=1/Math.sqrt(1+g*g),A=g*I,D=A/(1+I);E=g*n.atRowCol(w,x),m.set(x,m.at(x)-E),m.set(w,m.at(w)+E),t.set(x,t.at(x)-E),t.set(w,t.at(w)+E),n.setRowCol(w,x,0);let R=0;for(;R<x;R++)v=n.atRowCol(x,R),E=n.atRowCol(w,R),n.setRowCol(x,R,v-A*(E+v*D)),n.setRowCol(w,R,E+A*(v-E*D));for(R++;R<w;R++)v=n.atRowCol(R,x),E=n.atRowCol(w,R),n.setRowCol(R,x,v-A*(E+v*D)),n.setRowCol(w,R,E+A*(v-E*D));for(R++;R<o;R++)v=n.atRowCol(R,x),E=n.atRowCol(R,w),n.setRowCol(R,x,v-A*(E+v*D)),n.setRowCol(R,w,E+A*(v-E*D));for(R=0;R<o;R++)v=s.atRowCol(x,R),E=s.atRowCol(w,R),s.setRowCol(x,R,v-A*(E+v*D)),s.setRowCol(w,R,E+A*(v-E*D))}}for(let x=0;x<o;x++)u.set(x,u.at(x)+m.at(x)),t.set(x,u.at(x)),m.set(x,0)}}static checkDims(t,s,i){_(t.rows()===s&&t.cols()===i)}}class L extends P{constructor(t){if(t.copy){const i=new Float64Array(t.copy.N*t.copy.M);return super(i,t.copy.N,t.copy.M),this.buffer=i,void this.assignCopy(t.copy)}const s=new Float64Array(t.NN*t.MM);super(s,t.NN,t.MM),this.buffer=s,t.initializerList&&W(this.buffer,t.initializerList,0,0,t.initializerList.length)}assignCopy(t){return this===t||super.assignCopy(t),this}}class B{constructor(t){this.m_TransformationType=1,t===void 0?this.setIdentity():t instanceof B?this.set(t):this.setScale(t)}set(t){return this.xx=t.xx,this.xy=t.xy,this.xd=t.xd,this.yx=t.yx,this.yy=t.yy,this.yd=t.yd,this}clone(){return new B().set(this)}setZero(){this.xx=0,this.yy=0,this.xy=0,this.yx=0,this.xd=0,this.yd=0}isEqual(t){return this===t||this.xx===t.xx&&this.xy===t.xy&&this.xd===t.xd&&this.yx===t.yx&&this.yy===t.yy&&this.yd===t.yd}transformInPlace(t){const s=this.xx*t.x+this.xy*t.y+this.xd,i=this.yx*t.x+this.yy*t.y+this.yd;t.x=s,t.y=i}transform(t){const s=t.clone();return this.transformInPlace(s),s}queryTransform(t,s){const i=this.xx*t.x+this.xy*t.y+this.xd,n=this.yx*t.x+this.yy*t.y+this.yd;s.setCoords(i,n)}transformEnvInPlace(t){if(t.isEmpty())return;const s=es(p,4);t.queryCorners(s),this.transformPoints2D(s,4,s),t.setFromPoints(s,4)}queryTransformEnv(t,s){_(0)}transformPoints2D(t,s,i){for(let n=0;n<s;++n)this.queryTransform(t[n],i[n])}transformInterleavedPoints(t,s,i){s*=2;const n=p.getNAN();for(let r=0;r<s;r+=2)n.x=t[r],n.y=t[r+1],this.transformInPlace(n),i[r]=n.x,i[r+1]=n.y}multiply(t){return B.st_multiply(this,t,this),this}mulLeft(t){return _(0),this}static st_multiply(t,s,i){const n=t.xx*s.xx+t.yx*s.xy,r=t.xy*s.xx+t.yy*s.xy,o=t.xd*s.xx+t.yd*s.xy+s.xd,h=t.xx*s.yx+t.yx*s.yy,a=t.xy*s.yx+t.yy*s.yy,u=t.xd*s.yx+t.yd*s.yy+s.yd;i.xx=n,i.xy=r,i.xd=o,i.yx=h,i.yy=a,i.yd=u}getCoefficients(t){_(t.length>=6),t[0]=this.xx,t[1]=this.xy,t[2]=this.xd,t[3]=this.yx,t[4]=this.yy,t[5]=this.yd}setCoefficients(t){_(t.length>=6),this.xx=t[0],this.xy=t[1],this.xd=t[2],this.yx=t[3],this.yy=t[4],this.yd=t[5]}copyTo(t){_(0)}initializeFromRect(t,s){t.isEmpty()||s.isEmpty()||!t.width()||!t.height()?this.setZero():(this.xy=this.yx=0,this.xx=s.width()/t.width(),this.yy=s.height()/t.height(),this.xd=s.xmin-t.xmin*this.xx,this.yd=s.ymin-t.ymin*this.yy)}initializeFromRectIsotropic(t,s){if(t.isEmpty()||!t.width()||!t.height()||s.isEmpty())this.setZero();else{this.yx=0,this.xy=0,this.xx=s.width()/t.width(),this.yy=s.height()/t.height(),this.xx>this.yy?this.xx=this.yy:this.yy=this.xx;const i=s.getCenter(),n=t.getCenter();this.xd=i.x-n.x*this.xx,this.yd=i.y-n.y*this.yy}}initializeFromTwoPointsArray(t,s){if(t[0].equals(s[0])&&t[1].equals(s[1]))return void this.setIdentity();if(t[0].equals(t[1])){if(s[0].equals(s[1]))return void this.setShift(s[0].sub(t[0]));Y("")}if(!t[0].equals(t[1])&&s[0].equals(s[1]))return this.setZero(),void this.shift(s[0]);this.setShiftCoords(-t[0].x,-t[0].y);const i=p.distance(t[0],t[1]),n=p.distance(s[0],s[1]),r=n/i;this.scale(r,r);const o=t[1].sub(t[0]);o.divThis(i);const h=s[1].sub(s[0]);h.divThis(n);const a=o.crossProduct(h),u=o.dotProduct(h);this.rotate(u,a),this.shiftCoords(s[0].x,s[0].y)}initializeFromTwoPoints(t,s,i,n){const r=[t,s],o=[i,n];this.initializeFromTwoPointsArray(r,o)}transformSizeInPlace(t){_(0)}transformSize(t,s){_(0)}transformTol(t){return _(0),0}transformWithoutTranslateArray(t,s,i){for(let n=0;n<s;++n)this.transformWithoutTranslate(t[n],i[n])}transformWithoutTranslateInPlace(t){const s=this.xx*t.x+this.xy*t.y,i=this.yx*t.x+this.yy*t.y;t.setCoords(s,i)}transformWithoutTranslate(t,s){const i=this.xx*t.x+this.xy*t.y,n=this.yx*t.x+this.yy*t.y;s.setCoords(i,n)}setIdentity(){this.xx=1,this.xy=0,this.xd=0,this.yx=0,this.yy=1,this.yd=0}isIdentity(){return!(this.xx!==1||this.yy!==1||this.xy||this.xd||this.yx||this.yd)}isIdentityTol(t){const s=t*t;return!(O(this.xd)+O(this.yd)>s)&&!(O(this.xy+this.xd)+O(this.yy+this.yd-1)>s)&&!(O(this.xx+this.xd-1)+O(this.yx+this.yd)>s)}isReflective(){return this.xx*this.yy-this.yx*this.xy<0}isUniform(t){const s=this.xx*this.xx+this.yx*this.yx,i=this.xy*this.xy+this.yy*this.yy,n=(s+i)*t;return Math.abs(s-i)<=n&&Math.abs(this.xx*this.xy+this.yx*this.yy)<=n}isUniformNoRotation(){return this.xx!==0&&Math.abs(this.xx)===Math.abs(this.yy)&&this.xy===0&&this.yx===0}isTranslate(){return this.xx===1&&this.yy===1&&!this.xy&&!this.yx}isTranslateTol(t){const s=new p;return s.setCoords(0,1),this.transformWithoutTranslateInPlace(s),s.y-=1,!(s.sqrLength()>t*t)&&(s.setCoords(1,0),this.transformWithoutTranslateInPlace(s),s.x-=1,s.sqrLength()<=t*t)}isOrthonormal(t){const s=new B;return s.xx=this.xx*this.xx+this.xy*this.xy,s.xy=this.xx*this.yx+this.xy*this.yy,s.yx=this.yx*this.xx+this.yy*this.xy,s.yy=this.yx*this.yx+this.yy*this.yy,s.xd=0,s.yd=0,s.isIdentityTol(t)}isDegenerate(t){return Math.abs(this.xx*this.yy-this.yx*this.xy)<=2*t*(Math.abs(this.xx*this.yy)+Math.abs(this.yx*this.xy))}isZero(){return this.xx===0&&this.yy===0&&this.xy===0&&this.yx===0&&this.xd===0&&this.yd===0}isScaleAndTranslateTol(t){return this.xy*this.xy+this.yx*this.yx<=(this.xx*this.xx+this.yy*this.yy)*t}setTranslate(t,s){return this.xx=1,this.xy=0,this.xd=t,this.yx=0,this.yy=1,this.yd=s,this}setShiftCoords(t,s){return this.xx=1,this.xy=0,this.xd=t,this.yx=0,this.yy=1,this.yd=s,this}setShift(t){return this.xx=1,this.xy=0,this.xd=t.x,this.yx=0,this.yy=1,this.yd=t.y,this}setScaleCoords(t,s){return this.xx=t,this.xy=0,this.xd=0,this.yx=0,this.yy=s,this.yd=0,this}setScale(t){return this.setScaleCoords(t,t),this}setFlipX(t,s){return this.xx=-1,this.xy=0,this.xd=t+s,this.yx=0,this.yy=1,this.yd=0,this}setFlipY(t,s){return this.xx=1,this.xy=0,this.xd=0,this.yx=0,this.yy=-1,this.yd=t+s,this}setShear(t,s){return this.xx=1,this.xy=t,this.xd=0,this.yx=s,this.yy=1,this.yd=0,this}scale(t,s){return this.xx*=t,this.xy*=t,this.xd*=t,this.yx*=s,this.yy*=s,this.yd*=s,this}setRotateAngle(t){return this.setRotate(Math.cos(t),Math.sin(t))}setRotate(t,s){return this.xx=t,this.xy=-s,this.xd=0,this.yx=s,this.yy=t,this.yd=0,this}setRotateAngleAbout(t,s){return this.setRotateAbout(Math.cos(t),Math.sin(t),s)}setRotateAbout(t,s,i){return this.setTranslate(-i.x,-i.y),this.rotate(t,s),this.translate(i.x,i.y)}setSwapCoordinates(){return this.xx=0,this.xy=1,this.xd=0,this.yx=1,this.yy=0,this.yd=0,this}setRotateCw90(){return this.xx=0,this.xy=1,this.xd=0,this.yx=-1,this.yy=0,this.yd=0,this}setRotateCcw90(){return this.xx=0,this.xy=-1,this.xd=0,this.yx=1,this.yy=0,this.yd=0,this}shiftCoords(t,s){return this.xd+=t,this.yd+=s,this}shift(t){return this.xd+=t.x,this.yd+=t.y,this}translate(t,s){return this.xd+=t,this.yd+=s,this}flipX(t,s){return this.xx=-this.xx,this.xy=-this.xy,this.xd=t+s-this.xd,this}flipY(t,s){return this.yx=-this.yx,this.yy=-this.yy,this.yd=t+s-this.yd,this}shear(t,s){const i=new B;return i.setShear(t,s),this.multiply(i)}rotateAngle(t){const s=new B;return s.setRotateAngle(t),this.multiply(s)}rotate(t,s){const i=new B;return i.setRotate(t,s),this.multiply(i)}rotateAbout(t,s,i){return this.translate(-i.x,-i.y),this.rotate(t,s),this.translate(i.x,i.y)}rotateAngleAbout(t,s){return this.rotateAbout(Math.cos(t),Math.sin(t),s)}setInvert(t){return this.set(t),this.invertThis()}invertThis(){let t=this.xx*this.yy-this.xy*this.yx;if(t===0)return this.setZero(),this;t=1/t;const s=(this.xy*this.yd-this.xd*this.yy)*t,i=(this.xd*this.yx-this.xx*this.yd)*t,n=this.yy*t,r=-this.xy*t,o=-this.yx*t,h=this.xx*t;return this.xd=s,this.yd=i,this.xx=n,this.yy=h,this.xy=r,this.yx=o,this}invertPrecise(t){return this.set(t),this.invertPreciseThis()}invertPreciseThis(){const t=M.constructDouble(this.xy),s=M.constructDouble(this.xx),i=s.mulDouble(this.yy).sub(t.mulDouble(this.yx));if(i.isZero())return this.setZero(),this;const n=i.clone();n.invertThis();const r=M.constructDouble(this.xd),o=t.mulDouble(this.yd).sub(r.mulDouble(this.yy)).mul(n).toDouble(),h=r.mulDouble(this.yx).sub(s.mulDouble(this.yd)).mul(n).toDouble(),a=n.mulDouble(this.yy).toDouble(),u=n.mulDouble(-this.xy).toDouble(),m=n.mulDouble(-this.yx).toDouble(),l=n.mulDouble(this.xx).toDouble();return this.xd=o,this.yd=h,this.xx=a,this.yy=l,this.xy=u,this.yx=m,this}extractScaleTransform(t,s){const i=Math.sqrt(this.xx*this.xx+this.xy*this.xy),n=Math.sqrt(this.yx*this.yx+this.yy*this.yy);s.setScaleCoords(1/i,1/n),s.multiply(this),t.setScaleCoords(i,n)}setFromTwoTriangles(t,s){let i=!0;for(let m=0;m<3;++m)i=i&&t[m].equals(s[m]);if(i)return this.setIdentity(),!0;const n=new p;n.setSub(t[0],t[1]);const r=new p;r.setSub(t[0],t[2]);const o=new p;o.setSub(s[0],s[1]);const h=new p;h.setSub(s[0],s[2]);const a=4*Number.EPSILON*(Math.abs(n.x*r.y)+Math.abs(r.x*n.y));let u=n.x*r.y-n.y*r.x;return Math.abs(u)>a?(u=1/u,this.xx=(o.x*r.y-n.y*h.x)*u,this.xy=(n.x*h.x-o.x*r.x)*u,this.yx=(o.y*r.y-n.y*h.y)*u,this.yy=(n.x*h.y-o.y*r.x)*u,this.xd=s[0].x-(this.xx*t[0].x+this.xy*t[0].y),this.yd=s[0].y-(this.yx*t[0].x+this.yy*t[0].y),!0):(this.setZero(),!1)}initializeFromControlPoints(t,s,i,n,r=null){return s===0?(this.setIdentity(),void(r&&r.setIdentity())):s===1?(this.setShift(n[0].sub(i[0])),void(r&&r.setShift(i[0].sub(n[0])))):(s<3&&(t=1),void(t===4&&s>2?fi(this,s,i,n,r):xi(t,this,s,i,n,r)))}calculateErrors(t,s,i,n){_(t>0&&s!==null&&i!==null);let r=0;for(let o=0;o<t;++o){const h=this.transform(s[o]),a=p.sqrDistance(i[o],h);r+=a,n&&(n[o]=Math.sqrt(a))}return Math.sqrt(r/t)}}const H=[43,11,41,9,61];function wt(e,t){_(!(t.rows()!==2&&t.rows()!==3||t.cols()!==2&&t.rows()!==3)),e.xx=t.atRowCol(0,0),e.xy=t.atRowCol(0,1),e.yx=t.atRowCol(1,0),e.yy=t.atRowCol(1,1),t.cols()===3?(e.xd=t.atRowCol(0,2),e.yd=t.atRowCol(1,2)):(e.xd=0,e.yd=0)}function fi(e,t,s,i,n){const r=p.average(s,t),o=p.average(i,t),h=new L({NN:2,MM:2});h.setZero();const a=new L({NN:2,MM:2});a.setZero();for(let l=0;l<t;++l)h.setRowCol(0,0,h.atRowCol(0,0)+(s[l].x-r.x)*(s[l].x-r.x)),h.setRowCol(0,1,h.atRowCol(0,1)+(s[l].x-r.x)*(s[l].y-r.y)),h.setRowCol(1,1,h.atRowCol(1,1)+(s[l].y-r.y)*(s[l].y-r.y)),a.setRowCol(0,0,a.atRowCol(0,0)+(i[l].x-o.x)*(s[l].x-r.x)),a.setRowCol(0,1,a.atRowCol(0,1)+(i[l].x-o.x)*(s[l].y-r.y)),a.setRowCol(1,0,a.atRowCol(1,0)+(i[l].y-o.y)*(s[l].x-r.x)),a.setRowCol(1,1,a.atRowCol(1,1)+(i[l].y-o.y)*(s[l].y-r.y));h.setRowCol(1,0,h.atRowCol(0,1));const u=new L({NN:2,MM:2});h.pseudoInverse(u,!0)||ft("Failed to compute pseudo inverse"),a.mul(u,a),wt(e,a);const m=r.clone();e.transformInPlace(m),e.xd=o.x-m.x,e.yd=o.y-m.y,n&&(a.pseudoInverse(u,!1)||ft("Failed to compute pseudo inverse"),wt(n,u),n.transformInPlace(o),n.xd=r.x-o.x,n.yd=r.y-o.y)}function xi(e,t,s,i,n,r){_(e===1||e===0||e===2||e===3),t.setIdentity();const o=p.average(i,s),h=p.average(n,s);if(_(e<H.length&&e>0),8&H[e]){const u=new L({NN:2,MM:2});u.setZero();for(let w=0;w<s;++w)u.setRowCol(0,0,u.atRowCol(0,0)+(n[w].x-h.x)*(i[w].x-o.x)),u.setRowCol(1,0,u.atRowCol(1,0)+(n[w].x-h.x)*(i[w].y-o.y)),u.setRowCol(0,1,u.atRowCol(0,1)+(n[w].y-h.y)*(i[w].x-o.x)),u.setRowCol(1,1,u.atRowCol(1,1)+(n[w].y-h.y)*(i[w].y-o.y));const m=new L({NN:2,MM:2}),l=new L({NN:2,MM:1}),y=new L({NN:2,MM:2});u.svd(m,l,y)||ft("Failed to compute svd");const N=new L({NN:2,MM:2});m.transpose(N);const b=new L({NN:2,MM:2});y.mul(N,b),!(32&H[e])&&b.determinant()<0&&(N.setRowCol(1,0,-N.atRowCol(1,0)),N.setRowCol(1,1,-N.atRowCol(1,1)),y.mul(N,b));const x=new B;wt(x,b),t.set(x)}if(2&H[e]){let u=0,m=0;for(let l=0;l<s;++l){const y=i[l].sub(o);u+=y.sqrLength(),t.transformInPlace(y),m+=y.dotProduct(n[l].sub(h))}if(u===0)m===0?t.setIdentity():t.setZero();else{const l=m/u;t.scale(l,l)}}else _(!(4&H[e]));const a=o.clone();t.transformInPlace(a),t.xd=h.x-a.x,t.yd=h.y-a.y,r&&(r.set(t),r.invertThis(),r.isZero()&&(r.xd=o.x,r.yd=o.y))}export{O as $,ps as A,Ui as B,Ri as C,Vt as D,Xt as E,ge as F,Me as G,Ei as H,oe as I,se as J,Se as K,Vs as L,et as M,Di as N,Ee as O,Y as P,Ot as Q,es as R,Qt as S,W as T,js as U,_e as V,re as W,te as X,Ys as Y,xe as Z,Ii as _,j as a,Pe as a$,G as a0,Si as a1,$t as a2,pe as a3,T as a4,ue as a5,Yi as a6,Xi as a7,ae as a8,Vi as a9,Qe as aA,Ue as aB,me as aC,ce as aD,ve as aE,$e as aF,Ji as aG,ui as aH,ie as aI,Hi as aJ,Fe as aK,_i as aL,Ci as aM,pt as aN,Cs as aO,qi as aP,wi as aQ,we as aR,Ti as aS,ye as aT,be as aU,Qi as aV,Zi as aW,zi as aX,Be as aY,Re as aZ,Ai as a_,vt as aa,Wt as ab,Le as ac,Oe as ad,ke as ae,ot as af,Fi as ag,Wi as ah,ji as ai,X as aj,Te as ak,ks as al,Bs as am,$i as an,le as ao,Ge as ap,ee as aq,Qs as ar,Os as as,ne as at,de as au,M as av,ki as aw,Bi as ax,Ht as ay,Ws as az,Ms as b,ze as b0,Oi as b1,De as b2,Ie as b3,Ce as b4,je as b5,We as b6,Ve as b7,qe as b8,Ze as b9,ni as ba,fe as c,Jt as d,p as e,Yt as f,_ as g,ws as h,Ae as i,Pi as j,Ne as k,Ni as l,hs as m,xt as n,he as o,Ns as p,Mi as q,pi as r,Ki as s,Li as t,Gi as u,gi as v,ls as w,B as x,vs as y,K as z};
