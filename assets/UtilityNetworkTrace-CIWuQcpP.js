const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./calcite-action-Bys6x4p_.js","./action-D0Er9Ef6.js","./jsxFactory-CJa39Fro.js","./tslib.es6-B3Jf3DVX.js","./intl-CChhNOV8.js","./date-DlqISzcw.js","./jsonMap-0cxwUWs2.js","./subclass-BZA_h8Db.js","./locale-C9TlLpzi.js","./messages-OmQvZhAg.js","./Accessor-BLX9ikPh.js","./assets-C43MgM-v.js","./index-Bh2oEzTI.js","./index-2kwcjS9-.css","./Evented-BHRw9x22.js","./Promise-B2Hu02L7.js","./reactiveUtils-C5zUhJQJ.js","./asyncUtils-CWX51uTe.js","./Collection-CEdjem1-.js","./shared-B3wH2qpO.js","./SimpleObservable-KocWTzVy.js","./uuid-fwrPAdZb.js","./cast-Bjksrh93.js","./dom-D_AJDzAj.js","./interactive-y84HQRWL.js","./loadable-DM18hPdE.js","./locale-A4FuYD8q.js","./key-D63ExP77.js","./observers-D2xgmA06.js","./component-6CIDVndn.js","./t9n-D0ry3MEw.js","./icon-BQO9J86c.js","./loader-C-zIPscB.js","./calcite-action-group-Dp-CUDEe.js","./action-group-BJ76kEtf.js","./conditionalSlot-R5D9krYS.js","./action-menu-C6uYzPu-.js","./array-BMcQdnYi.js","./popover-Q5ruM4hh.js","./floating-ui-Bma_zPVt.js","./debounce-BOqmhDXu.js","./focusTrapComponent-BSUg_DLj.js","./openCloseComponent-CmOrfBN-.js","./Heading-D7P0OjYI.js","./FloatingArrow-BBdsG5MP.js","./calcite-action-pad-D3cShEGp.js","./ExpandToggle-D9_knjDY.js","./calcite-block-M0XyV5ob.js","./handle-Ct1HP3bl.js","./scrim-DPa2aeKh.js","./calcite-block-section-BPfKIFKK.js","./switch-Drd7BD6R.js","./form-BZPQ5PUM.js","./label-DEe8AW1C.js","./calcite-button-D_Agetwz.js","./button-9P4PM9SO.js","./calcite-checkbox-B8olv0Y9.js","./calcite-color-picker-swatch-CXRxr1X7.js","./color-picker-swatch-BkkyNtW3.js","./calcite-combobox-DZ_miEwS.js","./combobox-CAZmwDcP.js","./core-Cpfj44ZG.js","./filter-yN6-jZOU.js","./Validation-Bz9yoU6e.js","./utils2-COUKy2o1.js","./chip-ZieJjxzJ.js","./combobox-item-DwxSVkl7.js","./input-message-CWvsvdFk.js","./calcite-combobox-item-BtecfP0L.js","./calcite-flow-BrE9BG4l.js","./calcite-flow-item-B0xZ0mWX.js","./panel-BdAbXPwM.js","./calcite-icon-Cu0W9dtm.js","./calcite-input-number-BjjBFtSg.js","./input-number-BVYRKcQu.js","./input-j1u1wOBY.js","./progress-BXyickl_.js","./calcite-label-B1FxWqaL.js","./calcite-list-C4jOVpC-.js","./resources4-DXHY1U7R.js","./utils3-BrU6GrkI.js","./input2-BReyTnf4.js","./calcite-list-item-vbKS6alm.js","./calcite-loader-DP4PIFO8.js","./calcite-notice-DSp0z_Oh.js","./resources2-DjkgwdyM.js","./calcite-option-BMqKJDtM.js","./calcite-panel-qSfJTr42.js","./calcite-popover-5MaBc2pF.js","./calcite-scrim-B8_2DHG_.js","./calcite-select-CIxePAn2.js","./calcite-tab-DjqulRBq.js","./tab-CUfjd98M.js","./calcite-tab-nav-ICHHDzWW.js","./tab-nav-D__ErtFr.js","./calcite-tab-title-C-22SPvO.js","./tab-title-CjKan3lH.js","./calcite-tabs-DnbX01M5.js","./tabs-snn1gob8.js","./calcite-tooltip-rE_jVYtd.js"])))=>i.map(i=>d[i]);
import{_ as y}from"./index-Bh2oEzTI.js";import{r as p}from"./tslib.es6-B3Jf3DVX.js";import{V as z}from"./Accessor-BLX9ikPh.js";import{n as x,b as Q,m as d,a as he}from"./subclass-BZA_h8Db.js";import{whenOnce as be,watch as B,when as Y}from"./reactiveUtils-C5zUhJQJ.js";import{i as pe}from"./Field-ybkHhtnK.js";import{e as V,B as Ae,n as o,r as Te,m as Re}from"./jsxFactory-CJa39Fro.js";import{e as H}from"./globalCss-CZa70j6i.js";import{e as Se}from"./vmEvent-D4Ubqkbq.js";import{i as ke}from"./assets-C43MgM-v.js";import{V as de}from"./Collection-CEdjem1-.js";import{o as Fe}from"./Evented-BHRw9x22.js";import{u as ee,l as Ie}from"./jsonUtils-CEfjT-BK.js";import{h as me}from"./messages-OmQvZhAg.js";import Ce from"./FeatureLayer-wa_7EIxE.js";import ge from"./GraphicsLayer-i3FeUJ_n.js";import{r as J,x as Me}from"./layerUtils-BrNoooE9.js";import{T as Ne,n as Ge}from"./UtilityNetwork-BcQB-qCr.js";import{b as Ee}from"./Portal-C10FKnaA.js";import{s as Pe}from"./utils-ChpoPxsr.js";import{trace as Oe}from"./trace-zvfzcOP9.js";import{m as Le,a as D}from"./TraceParameters-B2mPCC1o.js";import"./geometry-D964gYQX.js";import{geodesicBuffer as te,buffer as ie,convexHull as $,geodesicArea as xe,planarArea as Be,cut as re,planarLength as N}from"./geometryEngine-DGiYLHJy.js";import{d as Ve}from"./Polyline-D9YkgmM_.js";import{K as U,W as He}from"./projection-B971H0Re.js";import{g as O}from"./Point-Cg0-ChZE.js";import{d as ye}from"./Graphic-DsxsIjhH.js";import{S as K,d as De,y as se}from"./TextSymbol-D8QO_KUV.js";import{u as $e,t as Ue}from"./SnappingManager-BJPyuu7J.js";import{c as je}from"./SketchViewModel-BKa9ySXO.js";import{n as We,q as qe}from"./PopupTemplate-BHMhS05j.js";import"./asyncUtils-CWX51uTe.js";import"./shared-B3wH2qpO.js";import"./SimpleObservable-KocWTzVy.js";import"./jsonMap-0cxwUWs2.js";import"./enumeration-Ba5njXdz.js";import"./writer-DNAwXnhG.js";import"./fieldType-BuzM0UHS.js";import"./intl-CChhNOV8.js";import"./date-DlqISzcw.js";import"./locale-C9TlLpzi.js";import"./Promise-B2Hu02L7.js";import"./uuid-fwrPAdZb.js";import"./cast-Bjksrh93.js";import"./Extent-Bf3YTe7m.js";import"./ClassBreaksRenderer-BuHwSyVK.js";import"./symbols-CNimns--.js";import"./fieldUtils-tmQlKvWo.js";import"./mathUtils-C4_ghTv4.js";import"./Color-BCS62Hs5.js";import"./colorUtils-0bJDPow9.js";import"./screenUtils-_ZIvrt5o.js";import"./materialUtils-DarhapKC.js";import"./opacityUtils-C68Tlu6_.js";import"./vec3f64-BLpZdpfb.js";import"./aaBoundingBox-BE7cC1jD.js";import"./persistableUrlUtils-fa1mAujs.js";import"./collectionUtils-D_lHIu88.js";import"./Clonable-D3rtuBWg.js";import"./UniqueValueRenderer-BQtAHUSo.js";import"./diffUtils-BP7jmOAy.js";import"./colorRamps-pKd7I5WZ.js";import"./SizeVariable-936USOrb.js";import"./sizeVariableUtils-Cmcuvw-4.js";import"./visualVariableUtils-DX1kS9Se.js";import"./compilerUtils-Dw3R0f-Z.js";import"./lengthUtils-DL1-FDQQ.js";import"./ActionToggle-iT4slXc7.js";import"./Identifiable-B1UbsKNt.js";import"./Loadable-BabW5Xcc.js";import"./ColorStop-Dk3U5tCk.js";import"./jsonUtils-Ds2Sqto-.js";import"./defaults-DZ1kfMRx.js";import"./defaultsJSON-GKolV7NZ.js";import"./RendererLegendOptions-B-4se3aU.js";import"./styleUtils-BYTm14n3.js";import"./jsonUtils-DxpLMo6d.js";import"./LRUCache-B_PHMSGm.js";import"./MemCache-Dx1v3xLC.js";import"./Version-BSlAgupz.js";import"./FieldsIndex-DpwHKAMX.js";import"./UnknownTimeZone-BkowvBs8.js";import"./OverrideHelper-ti072FkP.js";import"./colorUtils-aL8wj-8G.js";import"./vec42-YcqnINSP.js";import"./common-DQOJ18NT.js";import"./vec4f64-o2zAXfmz.js";import"./utils-D2PLyMFF.js";import"./enums-CmIX1y88.js";import"./quantizationUtils-uj_P09aO.js";import"./HeatmapColorStop-BJc5nbwr.js";import"./heatmapUtils-Dwiv9IEa.js";import"./SimpleRenderer-BV2L9G_n.js";import"./MultiOriginJSONSupport-B5nfqtQh.js";import"./layerContainerType-C5CzMsLd.js";import"./FeatureLayerBase-Ck7-w8TE.js";import"./formUtils-ylzKAM7E.js";import"./HeightModelInfo-9nOoV6LU.js";import"./arcgisLayerUrl-BX1FE5Hm.js";import"./commonProperties-CPyIG_-u.js";import"./ElevationInfo-CA5m_tHv.js";import"./unitConversionUtils-BMfW9yAe.js";import"./AttributeTableTemplate-BZeVyq-j.js";import"./featureLayerUtils-DBsQMhTm.js";import"./featureQueryAll-DnVoEjkM.js";import"./Query-5Xpquc1r.js";import"./DataLayerSource-BKkswDvG.js";import"./FullTextSearch-Csd1Hktu.js";import"./TimeExtent-DocT5yPf.js";import"./timeUtils-8fb_2oAt.js";import"./AttachmentQuery-BUlkjzkx.js";import"./RelationshipQuery-DPPNeuLK.js";import"./LayerFloorInfo-CIQjg5Vk.js";import"./Relationship-COPq3qM4.js";import"./serviceCapabilitiesUtils-DAE5z8FP.js";import"./Layer-CVt7Hb5J.js";import"./workers-D4HfeYKj.js";import"./Queue-yu3bZ02p.js";import"./editsZScale-Bs7_pSzI.js";import"./queryZScale-w66xFVGx.js";import"./FeatureSet-BHEkYP03.js";import"./APIKeyMixin-Di9kcRBS.js";import"./ArcGISService-B5qxetOY.js";import"./BlendLayer-CXM4n_Ge.js";import"./jsonUtils-CSnQD004.js";import"./parser-CTsgEym6.js";import"./utils-93yNk4Xc.js";import"./mat4f32-DcsiF_Rp.js";import"./mat4-GpOFENPA.js";import"./CustomParametersMixin-B4u7wiBT.js";import"./EditBusLayer-DoTks2sU.js";import"./FeatureEffectLayer-CpM66wLd.js";import"./FeatureEffect-BEzQmzeC.js";import"./FeatureFilter-BMHRQSxq.js";import"./FeatureReductionLayer-Ddbk727V.js";import"./FeatureReductionSelection-7vaL4DYT.js";import"./labelingInfo-DYPSPZCH.js";import"./labelUtils-B8petyBk.js";import"./MD5-C9MwAd2G.js";import"./OperationalLayer-CVyVfSPu.js";import"./OrderedLayer-C5VLMHgA.js";import"./OrderByInfo-IYmS1EXF.js";import"./PortalLayer-CKja4bdW.js";import"./PortalItem-DzgXrpyc.js";import"./portalItemUtils-BzVoFAku.js";import"./RefreshableLayer-D7lXUJRS.js";import"./ScaleRangeLayer-Bb8Ig1Hz.js";import"./TemporalLayer-Dpq2hKKV.js";import"./TimeInfo-LUiaSFyX.js";import"./TimeInterval-CNlkea1s.js";import"./FeatureTemplate-CssMa1yk.js";import"./FeatureType-C0q_coeM.js";import"./fieldProperties-Cgxj08ZE.js";import"./versionUtils-CQ_WhYSP.js";import"./styleUtils-KMFBtb6u.js";import"./popupUtils-BBuPGAHd.js";import"./AlphaCutoff-UcccL64p.js";import"./interfaces-CL2NbQte.js";import"./projectBuffer-Bs7GwaPY.js";import"./geodesicConstants-DWQLYX7F.js";import"./GraphicsCollection-FfahqxsR.js";import"./NetworkElement-CyYx535m.js";import"./utils-6jMaHUrH.js";import"./geometryEngineBase-yFIvKOkM.js";import"./_commonjsHelpers-DCkdB7M8.js";import"./hydrated-C9rxSL4a.js";import"./elevationInfoUtils-BC_66_Fg.js";import"./projectVectorToVector-G2uWGoIb.js";import"./projectPointToVector-GINIbYMz.js";import"./vec32-Dvg_eL9J.js";import"./InputManager-Ba9xzDpe.js";import"./signal-D4lghLjV.js";import"./keybindings-DoOdil3D.js";import"./utils-BpB3MnW1.js";import"./vec2-maR1OrZI.js";import"./vec2f64-miziP1SN.js";import"./geodesicUtils-FCYOaNwu.js";import"./plane-IENfwZlB.js";import"./mat3f64-BBpwCtoL.js";import"./mat4f64-Dk4dwAN8.js";import"./quatf64-CCm9z-pX.js";import"./mathUtils-BG-eq9fO.js";import"./sphere-C77djCO6.js";import"./mat3-BRl2i9Bz.js";import"./geometry2dUtils-DdyQE7AQ.js";import"./viewUtils-DrPohWV3.js";import"./isSupportedObject-6I_Nw0mS.js";import"./SketchLabelOptions-DDQnGNSN.js";import"./angularMeasurementUtils-7e2vxqzG.js";import"./Cyclical-oTUX3aX7.js";import"./quantityUtils-D0GB2dMc.js";import"./layerUtils-BS1Di3Pm.js";import"./hitTestSelectUtils-UXJPjatw.js";import"./screenUtils-WcqhHU65.js";function j(s){return s.type==="polygon"||s.type==="polyline"}function ze(s){return s.hasOwnProperty("points")}function Je(s){return ze(s)&&s.points.length===2}class _e{createBuffer(e,t,i,r){if(Array.isArray(e)){if(e.length>0){const a=O.fromJSON(e[0].spatialReference);return a.isWGS84||a.isWebMercator?te(e,t,i,r):ie(e,t,i,r)}return}const l=O.fromJSON(e.spatialReference);return l.isWGS84||l.isWebMercator?te(e,t[0],i):ie(e,t[0],i)}createConvexHull(e){if(Array.isArray(e)){if(e.length===1&&Je(e[0])){const i=$(e[0]);if(j(i))return i}return $(e,!0).filter(j)}const t=$(e);if(j(t))return t}calculateArea(e,t){const i=new O({wkid:e.spatialReference.wkid});return i.isWGS84||i.isWebMercator?parseFloat(xe(e,t).toFixed(2)):parseFloat(Be(e,t).toFixed(2))}mergeAggregatedToGeometries(e){const t=[],{line:i,multipoint:r,polygon:l}=e;return i&&t.push(i),r&&t.push(r),l&&t.push(l),t}getPercentageAlong(e,t,i){let r=e;const l=this._createPolyline(e.paths,i.wkid);if(t.type==="point"){const n=t.x-.5,u=t.x+.5,h=[[[n,t.y-.5],[u,t.y+.5]]];r=this._createPolyline(h,t.spatialReference.wkid),r=U(r,i);const c=re(l,r);if(c.length>0){const g=N(l,"feet");let f;return f=c[0].paths[0][0][0]===l.paths[0][0][0]?N(c[0],"feet"):N(c[1],"feet"),[f/g]}return[.5]}r=U(t,i);const a=re(l,r);if(a.length>0){const n=N(l,"feet");return[N(a[0],"feet")/n]}return[.5]}async projectGeometry(e,t){return await He(),U(e,t)}_createPolyline(e,t){return new Ve({hasZ:!1,hasM:!0,paths:e,spatialReference:new O({wkid:t})})}}const we=[227,27,21,.6],fe=[21,244,21,.6],L=12,X=[{color:[255,0,0,.6],haloOpacity:.9,fillOpacity:.2,hex:"#ff0000"},{color:[255,0,255,.6],haloOpacity:.9,fillOpacity:.2,hex:"#ff00ff"},{color:[217,188,255,.6],haloOpacity:.9,fillOpacity:.2,hex:"#D9BCFF"},{color:[0,255,0,.6],haloOpacity:.9,fillOpacity:.2,hex:"#00ff00"},{color:[255,255,0,.6],haloOpacity:.9,fillOpacity:.2,hex:"#ffff00"},{color:[0,0,255,.6],haloOpacity:.9,fillOpacity:.2,hex:"#0000ff"},{color:[255,165,0,.5],haloOpacity:.9,fillOpacity:.2,hex:"#ffa500"},{color:[0,0,0,.5],haloOpacity:.9,fillOpacity:.2,hex:"#000000"}];let Ke=class{constructor(){this.highlightColor=[...X]}addCustomColor(e){this.highlightColor=[...X],this.highlightColor.some(t=>t.hex.toLowerCase()===e.hex.toLowerCase())||this.highlightColor.push(e)}getFlagGraphic(e,t,i,r){const l=t==="starting-point"?fe:we;if(e.type==="polygon"){const a=e;a.centroid&&(e=a.centroid)}return r?this.makeGraphic(e,l,i==null?void 0:i.attributes,null,r):this.makeGraphic(e,l,i==null?void 0:i.attributes)}initializeSketch(e,t,i){const r=new de;return i.forEach(l=>r.add(new $e({layer:l,enabled:!0}))),new je({layer:t,view:e,snappingOptions:new Ue({enabled:!0,featureEnabled:!0,featureSources:r})})}makeGraphic(e,t,i,r,l){let a,n=e;switch(e.type){case"multipoint":a=new se({color:t,size:L,outline:{color:t,width:0}}),r&&(n=e);break;case"point":a=l||new se({color:t,size:L,outline:{color:t,width:0}}),r&&(n=e);break;case"polyline":a=new De({color:t,width:L}),r&&(n=e);break;case"polygon":a=new K({color:t,outline:{color:t,width:L}}),r&&(n=e)}return new ye({geometry:n,symbol:a,attributes:i??null})}};const F=`utility-network-trace-result-area-${Date.now()}`;function G(s){return s.type==="graphics"}class Xe{constructor(){this.traceInformation={},this._geometryHandler=new _e}addResultAreaToMap(e,t){const i=this.createGraphicLayer(t);i&&G(i)&&i.add(e)}changeResultAreaColor(e,t,i){const r=new K({color:t.color,style:"solid",outline:{color:t.color,width:1}}),l=this._findGraphicsByTraceId(e,i);return l&&l.forEach(a=>{a.symbol=r}),r}createBuffer(e,t,i,r){return this._geometryHandler.createBuffer(e,t,i,r)}createConvexHull(e,t,i){const r=this._geometryHandler.createConvexHull(e);return t>0&&r?this.createBuffer(r,[t],i,!1):r}createResultAreaGraphic(e,t,i,r,l,a){var h;const n=new K({color:a.color,style:"solid",outline:{color:a.color,width:1}}),u=[];for(const c in t)u.push(new We({fieldName:c,label:c==="areaStatistic"?r.attributeStrings[c]+" ("+((h=l.units[i])==null?void 0:h.abbr)+")":r.attributeStrings[c]}));return new ye({geometry:e,symbol:n,attributes:t,popupTemplate:new qe({title:t.traceName,content:[{type:"fields",fieldInfos:u}]})})}removeResultArea(e,t){const i=t.findLayerById(F);if(i&&G(i)){const r=this._findGraphicsByTraceId(e,t);return r&&i.removeMany(r),r}return null}removeAllResultAreaGraphics(e){if(e){const t=e.findLayerById(F);t&&G(t)&&t.removeAll()}}createGraphicLayer(e,t){const i=e.findLayerById(F);if(i&&G(i))return i;const r=new ge({title:t??F,listMode:"hide",id:F});return e.add(r),r}_findGraphicsByTraceId(e,t){const i=t.findLayerById(F);if(i&&G(i)){const r=i.graphics.filter(l=>l.attributes.traceId===e);return r.length>0?r.toArray():null}return null}}function le(s){return s.type==="feature"}function W(s,e){return s.url.includes(e)}function ae(s,e){var t;return(((t=s.dataElement)==null?void 0:t.domainNetworks)||[]).some(i=>i.subnetworkLayerId===e.layerId)}class Ze{getValidUtilityNetworkLayers(e,t){const i=[];return e==null||e.allLayers.forEach(r=>{r.type==="group"?i.push(...r.layers.filter(J).filter(l=>le(l)&&t.isUtilityLayer(l)&&!ae(t,l)).filter(l=>W(l,t.featureServiceUrl)).toArray()):r.type==="subtype-group"?i.push(...r.sublayers.filter(l=>W(l,t.featureServiceUrl)).toArray()):J(r)&&le(r)&&t.isUtilityLayer(r)&&!ae(t,r)&&W(r,t.featureServiceUrl)&&i.push(r)}),i}}const Qe=()=>me("esri/widgets/UtilityNetworkTrace/t9n/UtilityNetworkTrace"),Ye=()=>me("esri/core/t9n/Units"),k=`utility-network-trace-flags-${Date.now()}`,E=`utility-network-trace-results-${Date.now()}`;function et(s){return s instanceof pe}function tt(s){return s.layer.type==="feature"||s.layer.type==="subtype-group"}function it(s){return"layer"in s}function oe(s){return s.layerViews!==void 0}function rt(s){return s.type==="graphics"}function ne(s){return s.type==="feature"||s.type==="subtype-group"||s.type==="group"}async function st(s){var i;const e=new Ce({url:s.networkSystemLayers.dirtyAreasLayerUrl});await e.load();const t=e.version;if(Number(t)<=11.1){const r=await Me(s.layerUrl),l=new Ee({url:r});await l.load();const a=(i=l==null?void 0:l.user)==null?void 0:i.username;return!!a&&Pe(l,a,"utilityNetwork")}return!0}let w=class extends Fe.EventedAccessor{constructor(e){super(e),this._activeProgress=!1,this._clickHandler=null,this._flags=[],this._flagId=0,this._geometryHandler=null,this._highlightHandler=[],this._resultAreaHandler=null,this._utilityHelper=new Ze,this._watchHandler=null,this._validUNLayers=[],this._traceTimeout=6e5,this._sketchViewModel=null,this.traces=[],this.graphicHandler=null,this.defaultGraphicColor={color:[255,255,0,.6],haloOpacity:.9,fillOpacity:.2,hex:"#FFFF00"},this.enableResultArea=!1,this.flags=[],this.gdbVersion="sde.DEFAULT",this.messages=null,this.messagesUnits=null,this.defaultResultAreaProperties={type:"convexhull",distance:10,unit:"meters",areaUnit:"square-meters",color:{color:[255,165,0,.5],haloOpacity:.9,fillOpacity:.2,hex:"#ffa500"},show:!1},this.selectedTraces=[],this.selectOnComplete=!0,this.showGraphicsOnComplete=!0,this.showSelectionAttributes=!0,this.traceResults=[],this.utilityNetwork=null}initialize(){z(x.getLogger(this),"gdbVersion will be removed and the gdbVersion of the UtilityNetwork will be consumed directly.",{replacement:"UtilityNetwork.gdbVersion",version:"4.31"}),this._geometryHandler=new _e,this.graphicHandler=new Ke,this._resultAreaHandler=new Xe,(async()=>{const[e,t]=await Promise.all([Qe(),Ye()]);this.set({messages:e,messagesUnits:t})})()}destroy(){this.view=null}get resultAreaProperties(){return this.defaultResultAreaProperties}set resultAreaProperties(e){this._set("resultAreaProperties",{...this.defaultResultAreaProperties,...e}),this.graphicHandler.addCustomColor(this.resultAreaProperties.color),this.traceResults.forEach(t=>{var r;const i=(r=t.resultArea)==null?void 0:r.show;t.resultArea={...this.defaultResultAreaProperties,...e},this.removeResultAreaFromMap(t),this.enableResultArea&&this.createResultAreaGraphic(t).then(l=>{if(l){t.resultAreaGraphic=l;const a=(e==null?void 0:e.show)??i;t.resultArea&&(t.resultArea.show=a),a&&this.addResultAreaToMap(t,l)}})})}get state(){var e;return(e=this.view)!=null&&e.ready?"ready":"loading"}get view(){return this._get("view")}set view(e){e&&e.type!=="2d"&&x.getLogger(this).error(new Q("view:invalid-view","SceneView is not supported",{view:e})),this._set("view",e),this.utilityNetwork&&this.reset(),this.utilityNetwork=null,this.loadUtilityNetwork().then(t=>{t&&this.selectTracesOnLoad()})}addFlagByHit(e,t){const i=r=>{var l;(l=this.view)!=null&&l.popup&&(this.view.popupEnabled=r)};return new Promise((r,l)=>{var a;i(!1),(a=this._clickHandler)==null||a.remove(),this._clickHandler=this._sketchViewModel.on("create",n=>{if(n.state==="complete"){const u=this._getGraphicLayer(k);u&&n.graphic&&u.remove(n.graphic),this.queryFlagByHitTest(n,e,t).then(h=>{var c;i(!0),(c=this._clickHandler)==null||c.remove(),this.emit("add-flag-complete",{type:e,symbol:t}),r(h)}).catch(h=>{var c;i(!0),(c=this._clickHandler)==null||c.remove(),this.emit("add-flag-error",{type:e,symbol:t}),l(h)})}}),this._sketchViewModel.create("point"),this.emit("add-flag",{type:e})})}async addFlagsOnLoad(){return this._flags.length>0?[]:(await be(()=>this.view!=null&&!this.view.updating),(await Promise.all(this.flags.map(async e=>{if(!e.mapPoint)return null;const{type:t}=e,i=e.mapPoint.clone(),r=t==="barrier"?we:fe,l={graphic:this.graphicHandler.makeGraphic(i,r),state:"complete",tool:"point",toolEventInfo:null,type:"create"};try{return await this.queryFlagByHitTest(l,e.type,null),this.emit("add-flag-complete",{type:t}),null}catch{return this.emit("add-flag-error",{type:t}),t==="barrier"?"barrier":"starting-point"}}))).filter(e=>!e))}async addResultAreaToMap(e,t){var i,r;if(this.view){if(e.resultArea.show=!0,t)(i=this._resultAreaHandler)==null||i.addResultAreaToMap(t,this.view.map),this.emit("add-result-area",{graphic:t});else if(e.results){const l=await this.createResultAreaGraphic(e);l&&(e.resultAreaGraphic=l,(r=this._resultAreaHandler)==null||r.addResultAreaToMap(l,this.view.map),this.emit("add-result-area",{graphic:l}))}}}async addResultGraphicToView(e,t){var l;const{view:i}=this,{results:r}=e;if(i&&r&&this.utilityNetwork){for(const a in r.aggregatedGeometry)if("line,multipoint,polygon".includes(a)){const n=a,u=r.aggregatedGeometry[n];if(u!=null){u.spatialReference=this.utilityNetwork.spatialReference,e.graphicEnabled=!0;const h=await this._geometryHandler.projectGeometry(u,i.spatialReference),c={globalid:e.trace.globalId};if(h!==null){const g=this.graphicHandler.makeGraphic(h,t.color,c,i.spatialReference);(l=this._getGraphicLayer(E))==null||l.add(g)}}}}}addTerminal(e,t){const i=[...this._flags];i.forEach(r=>{var l,a;r.globalId===t.globalId&&((l=t.selectedTerminals)!=null&&l.includes(parseInt(e,10))||((a=r.selectedTerminals)==null||a.push(parseInt(e,10))))}),this._flags=i}async callTrace(){const e=this.traces.filter(t=>t.selected);return e.length>0&&(this.traceResults.length>0&&this.traceResults.forEach(t=>{this.removeResultGraphicFromView(t)}),this.traceResults=[],this.removeSelection(),await Promise.all(e.map(async(t,i)=>{var a,n,u;const r=t,l=new Le({gdbVersion:(a=this.utilityNetwork)==null?void 0:a.gdbVersion,moment:(n=this.utilityNetwork)==null?void 0:n.historicMoment,namedTraceConfigurationGlobalId:r.globalId,outSpatialReference:null,resultTypes:null,traceType:r.traceType,traceLocations:this._flags,traceConfiguration:null});await this.executeTrace(r,(u=this.utilityNetwork)==null?void 0:u.networkServiceUrl,l).then(h=>{if(h.hasOwnProperty("results")){const c={...h};if(c.results!==null){c.resultArea={...this.resultAreaProperties};const g=[...c.results.elements];c.results.elements.length=0;const f=new Map;for(const v of g)f.has(v.globalId)||(f.set(v.globalId,!0),c.results.elements.push(v));const _=[...this.traceResults];_.splice(i,0,c),this.traceResults=_,c.results!==null&&(this.selectOnComplete&&this.mergeSelection(!0,c.trace),this.showGraphicsOnComplete&&this.addResultGraphicToView(c,c.graphicColor),this.enableResultArea&&this.createResultAreaGraphic(c).then(v=>{var R;v&&(c.resultAreaGraphic=v,(R=c.resultArea)!=null&&R.show&&this.addResultAreaToMap(c,c.resultAreaGraphic))}))}else{const g=[...this.traceResults];g.splice(i,0,h),this.traceResults=g}this._activeProgress=!1}else{this._activeProgress=!1;const c=[...this.traceResults];c.splice(i,0,h),this.traceResults=c}}).catch(h=>{throw this._activeProgress=!1,h})})),!0)}changeResultAreaColor(e,t){var r;if(!e.resultArea)return;e.resultArea.color=t;const i=(r=this._resultAreaHandler)==null?void 0:r.changeResultAreaColor(e.trace.globalId,t,this.view.map);e.resultAreaGraphic&&(e.resultAreaGraphic.symbol=i)}changeResultGraphicColor(e,t){const i=[...this.traceResults];i.length>0&&i.forEach(r=>{r.trace.globalId===t.trace.globalId&&(r.graphicColor=e,r.graphicEnabled=!0)}),this.traceResults=i,this.removeResultGraphicFromView(t),this.addResultGraphicToView(t,e)}changeFlagSymbol(e,t){this._flags.length>0&&this._flags.forEach(i=>{i.type===e&&t&&i.mapGraphic&&(i.mapGraphic.symbol=t)})}checkCanTrace(){const e={status:!0,issues:[]};let t=!1;const i=this._flags.some(a=>a.type==="starting-point"),r=this._flags.filter(a=>a.allTerminals!==null);r.length>0&&(t=r.some(a=>a.selectedTerminals.length<=0));let l=[];return i?(l=this.traces.filter(a=>a.selected),l.length<=0?(e.status=!1,e.issues=["noTrace"],t&&(e.status=!1,e.issues=["noTrace","noTerminalSelected"])):t&&(e.status=!1,e.issues=["noTerminalSelected"])):(l=this.traces.filter(a=>a.selected===!0),l.length>0?(e.status=!1,e.issues=["noStart"],t&&(e.status=!1,e.issues=["noStart","noTerminalSelected"])):(e.status=!1,e.issues=["noStart","noTrace"],t&&(e.status=!1,e.issues=["noStart","noTrace","noTerminalSelected"]))),e}checkSelectionExist(){return this._highlightHandler.some(e=>e)}clearResult(e){if(!this.view)return;let t=this.traceResults;if(t.length>0){const i=t.filter(r=>r.trace.globalId===e.globalId);i.length>0&&(this.removeResultGraphicFromView(i[0]),this.removeResultAreaFromMap(i[0])),t=t.filter(r=>r.trace.globalId!==e.globalId)}this.traceResults=t,t.length===0?(this.removeAllResultAreaGraphics(),this.removeSelection(),this.emit("clear-selection",{resultSet:[]})):this.mergeSelection(!1,e)}createResultAreaGeometries(e,t,i){var a,n,u,h,c,g,f,_,v,R,I,C,M,b;if(!this.view||!this.resultAreaProperties)return;let r;if(r=((a=this.resultAreaProperties)==null?void 0:a.type)==="convexhull"?t.length===1&&(ee(t[0])||Ie(t[0])&&t[0].points.length===1)?(u=this._resultAreaHandler)==null?void 0:u.createBuffer(t,i,(n=e.resultArea)==null?void 0:n.unit,!0):(g=this._resultAreaHandler)==null?void 0:g.createConvexHull(t,(h=e.resultArea)==null?void 0:h.distance,(c=e.resultArea)==null?void 0:c.unit):(_=this._resultAreaHandler)==null?void 0:_.createBuffer(t,i,(f=e.resultArea)==null?void 0:f.unit,!0),!r)return;if(Array.isArray(r)){for(const S of r){const P=this.getResultAreaAttributes(e,S),Z=(I=this._resultAreaHandler)==null?void 0:I.createResultAreaGraphic(S,P,(v=e.resultArea)==null?void 0:v.areaUnit,this.messages,this.messagesUnits,(R=e.resultArea)==null?void 0:R.color);if(Z)return Z}return}const l=this.getResultAreaAttributes(e,r);return(b=this._resultAreaHandler)==null?void 0:b.createResultAreaGraphic(r,l,(C=e.resultArea)==null?void 0:C.areaUnit,this.messages,this.messagesUnits,(M=e.resultArea)==null?void 0:M.color)}async createResultAreaGraphic(e){var t;if(e.results){const i=await this._createResultAreaInputGeometry(e.results);if(i.length>0){const r=Array(i.length).fill((t=e.resultArea)==null?void 0:t.distance),l=this.createResultAreaGeometries(e,i,r);return this.emit("create-result-area",{graphic:l}),l}}}executeTrace(e,t,i){const r=this._processFlags(i.traceLocations);return i.traceLocations=r,Oe(t,i,{timeout:this._traceTimeout}).then(l=>({trace:e,results:l,selectionEnabled:!1,graphicEnabled:!1,graphicColor:this.defaultGraphicColor,status:"success",date:new Date})).catch(l=>({trace:e,results:null,selectionEnabled:!1,graphicEnabled:!1,graphicColor:this.defaultGraphicColor,status:l.message,date:new Date}))}getResultAreaAttributes(e,t){var n,u,h;const{messages:i}=this,r=[],l=[];this._flags.forEach(c=>{var f,_,v,R;const g=((f=c.displayValue)==null?void 0:f.field)+":"+((_=c.displayValue)==null?void 0:_.value)+";"+i.attributeStrings.globalid+":"+c.globalId+";"+i.attributeStrings.terminalid+":"+c.terminalId+";"+i.attributeStrings.x+":"+((v=c.mapPoint)==null?void 0:v.x)+";"+i.attributeStrings.y+":"+((R=c.mapPoint)==null?void 0:R.y);c.type==="starting-point"?r.push(g):l.push(g)});const a=this.utilityNetwork?this.utilityNetwork.gdbVersion:this.gdbVersion;return{traceId:e.trace.globalId,traceName:e.trace.title,traceDescription:e.trace.description??"",startingPoints:r.toString(),barriers:l.toString(),version:a??void 0,username:ke.credentials[0].userId,date:e.date,elementCount:(n=e.results)==null?void 0:n.elements.length,functionResult:JSON.stringify((u=e.results)==null?void 0:u.globalFunctionResults),areaStatistic:t?this._geometryHandler.calculateArea(t,(h=e.resultArea)==null?void 0:h.areaUnit):0}}getValidSources(){var i,r;let e=[];const t=((r=(i=this.utilityNetwork)==null?void 0:i.dataElement)==null?void 0:r.domainNetworks)??[];for(const l of t)e=e.concat(l.junctionSources),e=e.concat(l.edgeSources);return e}groupResultsByNetworkSource(e){return e.length===0?[]:this._groupBy(e,"networkSourceId")}async loadUtilityNetwork(){var r;const{view:e}=this;if(!e)return null;if(await e.when(),this.utilityNetwork){if(this.utilityNetwork.loaded||await this.utilityNetwork.load(),this.utilityNetwork instanceof Ne){try{await e.map.loadAll(),this._loadUNSupportItems()}catch{this._loadUNSupportItems()}return this.utilityNetwork}return null}const t=e.map,i=(r=t.utilityNetworks)==null?void 0:r.at(0);if(i){if(await i.load(),this.utilityNetwork=i,!await st(i))throw new Q("utility-network:no-user-type-extension","User type extension not found");try{await t.loadAll(),this._loadUNSupportItems()}catch{}finally{this._loadUNSupportItems()}return i}return null}manageFilterBarrier(e,t){const i=[...this._flags];i.forEach(r=>{r.globalId===t.globalId&&t.type==="barrier"&&r.id===t.id&&(r.isFilterBarrier=e)}),this._flags=i}mergeSelection(e,t){let i=[];const r=[...this.traceResults],l=t.globalId;r.forEach(a=>{var n,u;l===a.trace.globalId&&(a.selectionEnabled=e),a.selectionEnabled&&((n=a.results)==null?void 0:n.elements)!==null&&(i=[...i,...((u=a.results)==null?void 0:u.elements)??[]])}),this.selectResults([...new Set(i)])}async queryFeaturesById(e){var n;const{view:t}=this;if(!t||!this.utilityNetwork)return null;const i=this.utilityNetwork.getObjectIdsFromElements(e),r={layerUrl:i[0].layerUrl,objectIds:i[0].objectIds,outFields:["*"]},l=((n=t.map)==null?void 0:n.allTables.toArray().filter(u=>{var h;return((h=u==null?void 0:u.parsedUrl)==null?void 0:h.path)===i[0].layerUrl}).filter(J))??[];this._getUniqueMapLayerViews(t).filter(({layer:u})=>{var h;return((h=u==null?void 0:u.parsedUrl)==null?void 0:h.path)===i[0].layerUrl}).forEach(({layer:u})=>{u.type!=="feature"&&u.type!=="subtype-group"||l.push(u)});const a=(await Promise.all(l.map(async u=>{const h={layers:new de([u]),layerInfos:[r],returnGeometry:!0,outSpatialReference:t.spatialReference},[c]=await Ge(h);return c}))).filter(({featureSet:u})=>u.features.length>0);return a.length>0?a:null}queryFlagByHitTest(e,t,i){return this._lookupFlagByHit(e).then(r=>{const{view:l}=this;if(!l)return!1;if(r.length>0){const a=[...this._flags],n=i;return r.forEach(u=>{var g,f;const h=u.graphic,c=h.attributes.hasOwnProperty("GLOBALID")?h.attributes.GLOBALID:h.attributes.globalid;if(a.filter(_=>_.globalId===c).length<=0){const _=this.graphicHandler.getFlagGraphic(h.attributes.mapPoint,t,h,n);(g=this._getGraphicLayer(k))==null||g.add(_);const v=this._createFlagProperty(h,t,_);a.push(v)}else if(h.attributes.percentAlong!==null){const _=this.graphicHandler.getFlagGraphic(h.attributes.mapPoint,t,h,n);(f=this._getGraphicLayer(k))==null||f.add(_);const v=this._createFlagProperty(h,t,_);a.push(v)}}),this._flags=a,!0}return!1})}removeResultGraphicFromView(e){var l;const{view:t}=this;if(!t)return;const i=(l=this._getGraphicLayer(E))==null?void 0:l.graphics;e.graphicEnabled=!1;const r=i==null?void 0:i.filter(a=>a.attributes[a.attributes.hasOwnProperty("GLOBALID")?"GLOBALID":"globalid"]===e.trace.globalId);r==null||r.forEach(a=>{var n;(n=this._getGraphicLayer(E))==null||n.remove(a)})}removeFlag(e){const t=this._flags.filter(i=>{if(i.id!==e.id)return i});this._removeGraphic(e),this._flags=t}removeAllResultAreaGraphics(){var e;(e=this._resultAreaHandler)==null||e.removeAllResultAreaGraphics(this.view.map)}removeResultAreaFromMap(e){var t,i;if(e.resultArea){e.resultArea.show=!1;const r=(i=this._resultAreaHandler)==null?void 0:i.removeResultArea(e.trace.globalId,(t=this.view)==null?void 0:t.map);r&&this.emit("remove-result-area",{graphic:r})}}removeSelection(){this._highlightHandler.forEach(e=>{e&&e.remove()}),this._highlightHandler=[]}removeTerminal(e,t){const i=[...this._flags];i.forEach(r=>{var l,a;if(r.globalId===t.globalId&&((l=t.selectedTerminals)!=null&&l.includes(parseInt(e,10)))){const n=t.selectedTerminals.indexOf(parseInt(e,10));(a=r.selectedTerminals)==null||a.splice(n,1)}}),this._flags=i}removeFlagsOnLoadWatcher(){this._watchHandler&&this._watchHandler!==null&&this._watchHandler.remove()}removeClickHandler(){this._clickHandler&&(this._sketchViewModel.cancel(),this._clickHandler.remove())}reset(){var t,i;this._flags=[],this.traceResults=[];const e=[...this.traces];e.forEach(r=>{r.selected=!1}),this.traces=e,this.view&&((t=this._getGraphicLayer(E))==null||t.removeAll(),(i=this._getGraphicLayer(k))==null||i.removeAll(),this.removeAllResultAreaGraphics(),this.removeSelection(),this.emit("clear-selection",{resultSet:[]}),this.emit("reset"))}selectFeaturesById(e){const{view:t}=this;if(!t||!this.utilityNetwork)return;const i=this.utilityNetwork.getObjectIdsFromElements(e);this._getUniqueMapLayerViews(t).forEach(r=>{var l,a;it(r)&&((a=(l=r.layer)==null?void 0:l.parsedUrl)==null?void 0:a.path)===i[0].layerUrl&&tt(r)&&this._highlightHandler.push(r.highlight(i[0].objectIds))})}selectResults(e){if(e.length>0){this.removeSelection();const t=this.groupResultsByNetworkSource(e),i=[];for(const r in t)this.selectFeaturesById(t[r]),i.push(this.queryFeaturesById(t[r]));Promise.all(i).then(r=>{this.emit("select-features",{resultSet:r})})}else this.removeSelection(),this.emit("clear-selection",{resultSet:[]})}selectTraces(e,t){const i=[...this.traces];i.forEach(r=>{t===r.globalId&&(r.selected=e)}),this.traces=i}selectTracesOnLoad(){var e;(e=this.utilityNetwork)!=null&&e.hasOwnProperty("sharedNamedTraceConfigurations")&&(this.traces=[...this.utilityNetwork.sharedNamedTraceConfigurations],this.traces.forEach(t=>{t.selected=!1,this.selectedTraces.includes(t.globalId)&&(t.selected=!0)}))}zoomToAsset(e){var t;(t=this.view)==null||t.goTo(e).catch(i=>console.error(i))}async _createResultAreaInputGeometry(e){if(e.aggregatedGeometry!=null)return this._geometryHandler.mergeAggregatedToGeometries(e.aggregatedGeometry);const t=this.groupResultsByNetworkSource(e.elements),i=[];for(const r in t)i.push(this.queryFeaturesById(t[r]));try{const r=await Promise.all(i),l=[];for(const a of r)if(a)for(const n of a)for(const u of n.featureSet.features)u.geometry&&l.push(u.geometry);return l}catch{return[]}}_loadUNSupportItems(){var i;if(!this.utilityNetwork)return;const{map:e}=this.view,{messages:t}=this;this._populateOutfields(),this._createGraphicLayer(k),this._createGraphicLayer(E),(i=this._resultAreaHandler)==null||i.createGraphicLayer(e,t==null?void 0:t.alertsStrings.genericResultHeader),this._validUNLayers=this._utilityHelper.getValidUtilityNetworkLayers(e,this.utilityNetwork),this._sketchViewModel=this.graphicHandler.initializeSketch(this.view,this._getGraphicLayer(k),this._validUNLayers)}_getUniqueMapLayerViews(e){const t=[],i=e.layerViews.filter(({layer:{type:l}})=>l==="feature"||l==="group"||l==="subtype-group").toArray(),r=l=>{for(const a of l.layerViews)oe(a)?r(a):t.push(a)};return i.forEach(l=>{switch(l.layer.type){case"group":oe(l)&&r(l);break;case"subtype-group":t.push(l);break;default:t.some(a=>a.layer.id===l.layer.id)||t.push(l)}}),t}_processFlags(e){const t=[];return e.forEach(i=>{if(i.selectedTerminals!==null&&i.selectedTerminals.length>0)i.selectedTerminals.forEach(r=>{const l=new D({globalId:i.globalId,percentAlong:i.percentAlong,terminalId:r,type:i.type,isFilterBarrier:i.isFilterBarrier});t.push(l)});else{const r=new D({globalId:i.globalId,percentAlong:i.percentAlong,type:i.type,isFilterBarrier:i.isFilterBarrier});t.push(r)}}),t}_getDisplayField(e){var t;return((t=e==null?void 0:e.layer)==null?void 0:t.type)==="subtype-sublayer"?this._getDisplayFieldBySublayer(e):this._getDisplayFieldByFeatureLayer(e)}_getDisplayFieldBySublayer(e){let t="",i="";const r=e.layer;t=this._checkParentForData(r,"displayField");for(const l in e.attributes){const a=l.toLowerCase();a===(t==null?void 0:t.toLowerCase())?(i=e.attributes[l],a==="assetgroup"||a==="assettype"?i=this._checkSubtype(r,r.subtypeCode):(i=this._checkDomain(r.fields,l,i),typeof i=="string"&&(i=this._defaultDisplayField(i,r)))):(i=this._checkDomain(r.fields,l,i),typeof i=="string"&&(i=this._defaultDisplayField(i,r)))}return{field:t,value:i.toString()}}_getDisplayFieldByFeatureLayer(e){var l,a;const t=e.layer;let i=t.displayField,r="";for(const n in e.attributes){const u=n.toLowerCase();if(u===(i==null?void 0:i.toLowerCase()))if(r=e.attributes[n],u==="assetgroup"||u==="assettype"){let h=e.attributes[t.typeIdField.toUpperCase()];h||(h=e.attributes[t.typeIdField.toLowerCase()]),i=t.typeIdField,r=this._checkSubtype(t,h),i===""&&(t.templates&&t.templates.length>0?(i=(l=t.templates[0])==null?void 0:l.name,r=(a=t.templates[0])==null?void 0:a.name):(i=t.displayField,r=e.attributes[n]))}else r=this._checkDomain(t.fields,n,r),typeof r=="string"&&(r=this._defaultDisplayField(r,t));else r=this._checkDomain(t.fields,n,r),typeof r=="string"&&(r=this._defaultDisplayField(r,t))}return{field:i,value:r?r.toString():""}}_checkSubtype(e,t){let i=t;if(e.type==="subtype-sublayer"){const r=this._checkParentForData(e,"subtypes");(r==null?void 0:r.length)>0&&r.forEach(l=>{l.code===t&&(i=l.name)})}else if(e.types!=null&&e.types.length>0){const r=e.types.filter(l=>l.id===t);r.length>0&&(i=r[0].name)}return i}_checkDomain(e,t,i){var a;let r=i;const l=e.filter(n=>n.name.toLowerCase()===t.toLowerCase());if(l.length>0&&et(l[0].domain)&&((a=l[0].domain)!=null&&a.codedValues)){const n=l[0].domain.codedValues.filter(({code:u})=>u===i);n.length>0&&(r=n[0].name)}return r}_checkParentForData(e,t){var i;return((i=e.parent)==null?void 0:i[t])??null}_defaultDisplayField(e,t){var i;return e.trim()?e:t.templates&&((i=t.templates)==null?void 0:i.length)>0?t.templates[0].name:t.title}get _uniqueFlagId(){return this._flagId++}_groupBy(e,t){return e.reduce((i,r)=>((i[r[t]]=i[r[t]]||[]).push(r),i),{})}async _lookupFlagByHit(e){var r,l,a,n;const t=(r=e.graphic)==null?void 0:r.geometry,i=[];if(t&&ee(t)&&this.view){const u=this.view.toScreen(t);if(u){const h=await this.view.hitTest(u,{include:this._validUNLayers});if(h&&h.results.length>0){const c=h.results.find(g=>g.layer!==null);if(((l=c.graphic)==null?void 0:l.geometry)!=null){if(c.graphic.geometry.type==="polyline"){const g={terminalId:null,isFilterBarrier:!1,allTerminals:null,selectedTerminals:null,percentAlong:this._geometryHandler.getPercentageAlong(c.graphic.geometry,(a=e.graphic)==null?void 0:a.geometry,c.graphic.geometry.spatialReference),displayValue:this._getDisplayField(c.graphic),mapPoint:c.mapPoint};c.graphic.attributes={...c.graphic.attributes,...g},i.push(c)}else if((c.graphic.geometry.type==="point"||c.graphic.geometry.type==="polygon")&&this.utilityNetwork!==null){const g=(n=this.utilityNetwork)==null?void 0:n.getTerminalConfiguration(c.graphic),f=this._getDisplayField(c.graphic),_={terminalId:g?g.terminals[0].id||null:1,isFilterBarrier:!1,allTerminals:g??null,selectedTerminals:[g?g.terminals[0].id||null:1],percentAlong:null,displayValue:f,mapPoint:c.mapPoint};c.graphic.attributes={...c.graphic.attributes,..._},i.push(c)}}}}}return i}_createFlagProperty(e,t,i){const r=new D;r.terminalId=e.attributes.terminalId,r.isFilterBarrier=e.attributes.isFilterBarrier,r.percentAlong=e.attributes.percentAlong,r.globalId=e.attributes.globalid||e.attributes.GLOBALID,r.type=t;const l=r;return l.details=e,l.mapGraphic=i,l.id=this._uniqueFlagId,l.allTerminals=e.attributes.allTerminals,l.selectedTerminals=e.attributes.selectedTerminals,l.displayValue=e.attributes.displayValue,l.mapPoint=e.attributes.mapPoint,l}async _populateOutfields(){if(!this.view)return;const{map:e}=this.view,t=this.getValidSources(),i=r=>{r.type==="group"?r.layers.forEach(l=>{ne(l)&&i(l)}):t.some(l=>l.layerId===r.layerId)&&r.fields.some(l=>l.name.toLowerCase()==="assetgroup")&&(r.outFields=["assetgroup","assettype","globalid","objectid"])};for(const r of e.layers)ne(r)&&i(r)}_removeGraphic(e){var t;(t=this._getGraphicLayer(k))==null||t.remove(e.mapGraphic)}_createGraphicLayer(e){const{map:t}=this.view;if(!t.findLayerById(e)){const i=new ge({title:e,listMode:"hide",id:e});t.add(i)}}_getGraphicLayer(e){const{map:t}=this.view;if(t){const i=t.findLayerById(e);if(i&&rt(i))return i}return null}};p([d()],w.prototype,"_activeProgress",void 0),p([d()],w.prototype,"_flags",void 0),p([d()],w.prototype,"traces",void 0),p([d()],w.prototype,"defaultGraphicColor",void 0),p([d()],w.prototype,"enableResultArea",void 0),p([d()],w.prototype,"flags",void 0),p([d()],w.prototype,"gdbVersion",void 0),p([d()],w.prototype,"messages",void 0),p([d()],w.prototype,"messagesUnits",void 0),p([d()],w.prototype,"resultAreaProperties",null),p([d()],w.prototype,"selectedTraces",void 0),p([d()],w.prototype,"selectOnComplete",void 0),p([d()],w.prototype,"showGraphicsOnComplete",void 0),p([d()],w.prototype,"showSelectionAttributes",void 0),p([d({readOnly:!0})],w.prototype,"state",null),p([d()],w.prototype,"traceResults",void 0),p([d()],w.prototype,"utilityNetwork",void 0),p([d({value:null})],w.prototype,"view",null),w=p([he("esri.widgets.UtilityNetworkTrace.UtilityNetworkTraceViewModel")],w);const ve=w,A="esri-utility-trace-network",T={base:A,loaderContainer:`${A}__loader-container`,loader:`${A}__loader`,fadeIn:`${A}--fade-in`,addButtonContainer:`${A}__add-button-container`,noticeContainer:`${A}__notice-container`,listContainer:`${A}__list-container`,resultsContainer:`${A}__results-container`,flow:`${A}__flow`,numberInput:`${A}__number-input`,clearPrompt:`${A}__reset-prompt`,promptDivider:`${A}__divider`,paddingTop:`${A}__padTop`};function lt(s){return{height:s+"px"}}function at(s){return{width:s+"px"}}function ot(){return{width:"75%"}}function ce(){return{textAlign:"center",padding:"1rem"}}function nt(s){return{width:"100%",height:window.getComputedStyle(s).getPropertyValue("max-height")}}function q(){return{height:"100%"}}function ue(s){return{display:"flex",flexDirection:s}}function ct(s){return s instanceof pe}const ut={noExtension:-2147208474};let m=class extends Ae{constructor(s,e){super(s,e),this._selectToolActive=!1,this._activeTrace=null,this._activeSwatch="",this._traceHeaderForFlow="",this._assetGroupHeader="",this._assetTypeHeader="",this._traceResultsFunctions=[],this._traceResultsAssetGroup=[],this._traceResultsAssetType=[],this._traceResultsIndividual=[],this._showTraceResultFunctions=!1,this._showTraceResultAssetGroup=!1,this._showTraceResultAssetType=!1,this._showIndividualRecords=!1,this._activeTab="input",this._flagViewType="starting-point",this._alertRemoveModal=!1,this._warningNoFlag=!1,this._warningNoTraceSelected=!1,this._warningNoStartAssetFound=!1,this._warningNoBarrierAssetFound=!1,this._warningNoTerminal=!1,this._confirmReset=!1,this._showResultOptions=!1,this._resultObjectIdField="objectid",this._resultDisplayField="objectid",this._resultSortField="objectid",this._resultSortOrder="desc",this._swatchNode=null,this._individualResultNode=null,this._symbolStartFlag=null,this._symbolBarrier=null,this._watchHandler=null,this._loadUNError=!0,this._errorMessage="",this.disabled=!0,this.inputSettings=[],this.messages=null,this.messagesCommon=null,this.messagesUnits=null,this.viewModel=new ve,this._afterComponentCreate=this._afterComponentCreate.bind(this)}initialize(){this._utilityNetworkTraceInitialized(),this.addHandles(B(()=>{var s;return(s=this.viewModel)==null?void 0:s.resultAreaProperties},()=>this.scheduleRender()))}get defaultGraphicColor(){return this.viewModel.defaultGraphicColor}set defaultGraphicColor(s){this.viewModel.defaultGraphicColor=s}get flags(){return this.viewModel.flags}set flags(s){this.viewModel.flags=s}get gdbVersion(){return z(x.getLogger(this),"gdbVersion will be removed and the gdbVersion of the UtilityNetwork will be consumed directly.",{replacement:"UtilityNetwork.gdbVersion",version:"4.31"}),this.viewModel.gdbVersion}set gdbVersion(s){z(x.getLogger(this),"gdbVersion will be removed and the gdbVersion of the UtilityNetwork will be consumed directly.",{replacement:"UtilityNetwork.gdbVersion",version:"4.31"}),this.viewModel.gdbVersion=s}get icon(){return"utility-network-trace"}set icon(s){this._overrideIfSome("icon",s)}get label(){var s;return((s=this.messages)==null?void 0:s.widgetLabel)??""}set label(s){this._overrideIfSome("label",s)}get resultAreaProperties(){return this.viewModel.resultAreaProperties}set resultAreaProperties(s){this.viewModel.resultAreaProperties=s}get selectedTraces(){return this.viewModel.selectedTraces}set selectedTraces(s){this.viewModel.selectedTraces=s}get selectOnComplete(){return this.viewModel.selectOnComplete}set selectOnComplete(s){this.viewModel.selectOnComplete=s}get showGraphicsOnComplete(){return this.viewModel.showGraphicsOnComplete}set showGraphicsOnComplete(s){this.viewModel.showGraphicsOnComplete=s}get enableResultArea(){return this.viewModel.enableResultArea}set enableResultArea(s){this.viewModel.enableResultArea=s}get showSelectionAttributes(){return this.viewModel.showSelectionAttributes}set showSelectionAttributes(s){this.viewModel.showSelectionAttributes=s}get utilityNetwork(){return this.viewModel.utilityNetwork}set utilityNetwork(s){this.viewModel.utilityNetwork=s}get view(){return this.viewModel.view}set view(s){this.viewModel.view=s}async checkCanTrace(){this._confirmReset=!1;const s=this.viewModel.checkCanTrace();s.status?(this._warningNoFlag=!1,this._warningNoTraceSelected=!1,this._warningNoTraceSelected=!1,this._warningNoTerminal=!1,this._showTraceResultFunctions=!1,this._showTraceResultAssetGroup=!1,this._showTraceResultAssetType=!1,this._showIndividualRecords=!1,this.switchTab("result"),this.viewModel._activeProgress=!0,this.viewModel.removeAllResultAreaGraphics(),await this.viewModel.callTrace(),this.viewModel._activeProgress=!1):s.issues.forEach(e=>{switch(e){case"noStart":this._warningNoFlag=!0;break;case"noTerminalSelected":this._warningNoTerminal=!0;break;default:this._warningNoTraceSelected=!0}})}confirmReset(){this._confirmReset=!0}render(){const{state:s}=this.viewModel;this._mixCustomStrings(),this._overrideFlagSymbol();const e=s==="loading"?this._renderWarningMessage("noTraceConfig",!1):this._renderUtilityNetworkTrace();return o("div",{class:this.classes(T.base,H.widget,H.panel,{[H.widgetDisabled]:this.disabled}),styles:q()},e)}loadDependencies(){return Te({action:()=>y(()=>import("./calcite-action-Bys6x4p_.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32]),import.meta.url),"action-group":()=>y(()=>import("./calcite-action-group-Dp-CUDEe.js"),__vite__mapDeps([33,34,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,35,28,25,26,23,27,30,36,37,1,24,29,31,32,38,39,40,41,42,43,44]),import.meta.url),"action-pad":()=>y(()=>import("./calcite-action-pad-D3cShEGp.js"),__vite__mapDeps([45,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,35,28,23,25,26,27,30,46,34,36,37,1,24,29,31,32,38,39,40,41,42,43,44]),import.meta.url),block:()=>y(()=>import("./calcite-block-M0XyV5ob.js"),__vite__mapDeps([47,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,35,28,23,24,26,27,30,43,25,42,39,40,1,29,31,32,36,37,38,41,44,48,49]),import.meta.url),"block-section":()=>y(()=>import("./calcite-block-section-BPfKIFKK.js"),__vite__mapDeps([50,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,27,26,28,30,25,31,51,52,24,53,29]),import.meta.url),button:()=>y(()=>import("./calcite-button-D_Agetwz.js"),__vite__mapDeps([54,55,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,52,23,24,53,29,25,26,27,28,30,31,32]),import.meta.url),checkbox:()=>y(()=>import("./calcite-checkbox-B8olv0Y9.js"),__vite__mapDeps([56,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,52,24,27,53,29,25]),import.meta.url),"color-picker-swatch":()=>y(()=>import("./calcite-color-picker-swatch-CXRxr1X7.js"),__vite__mapDeps([57,58,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]),import.meta.url),combobox:()=>y(()=>import("./calcite-combobox-DZ_miEwS.js"),__vite__mapDeps([59,60,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,61,62,40,23,39,52,24,53,29,25,26,27,28,42,30,63,64,65,31,66,35,67]),import.meta.url),"combobox-item":()=>y(()=>import("./calcite-combobox-item-BtecfP0L.js"),__vite__mapDeps([68,66,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,35,28,23,24,64,29,31]),import.meta.url),flow:()=>y(()=>import("./calcite-flow-BrE9BG4l.js"),__vite__mapDeps([69,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,28,25]),import.meta.url),"flow-item":()=>y(()=>import("./calcite-flow-item-B0xZ0mWX.js"),__vite__mapDeps([70,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,30,71,36,37,1,29,31,32,38,39,40,41,42,43,44,49]),import.meta.url),icon:()=>y(()=>import("./calcite-icon-Cu0W9dtm.js"),__vite__mapDeps([72,31,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,28]),import.meta.url),"input-number":()=>y(()=>import("./calcite-input-number-BjjBFtSg.js"),__vite__mapDeps([73,74,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,52,24,27,53,29,25,26,28,30,63,75,31,67,76]),import.meta.url),label:()=>y(()=>import("./calcite-label-B1FxWqaL.js"),__vite__mapDeps([77,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,53,23,29]),import.meta.url),list:()=>y(()=>import("./calcite-list-C4jOVpC-.js"),__vite__mapDeps([78,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,28,79,80,25,30,26,27,62,40,31,81,52,53,29,63,75,67,76,32,49]),import.meta.url),"list-item":()=>y(()=>import("./calcite-list-item-vbKS6alm.js"),__vite__mapDeps([82,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,26,27,28,30,25,80,79,1,29,31,32,48]),import.meta.url),loader:()=>y(()=>import("./calcite-loader-DP4PIFO8.js"),__vite__mapDeps([83,32,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,26,27,28]),import.meta.url),notice:()=>y(()=>import("./calcite-notice-DSp0z_Oh.js"),__vite__mapDeps([84,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,35,28,23,25,26,27,30,85,42,29,31]),import.meta.url),option:()=>y(()=>import("./calcite-option-BMqKJDtM.js"),__vite__mapDeps([86,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,28]),import.meta.url),panel:()=>y(()=>import("./calcite-panel-qSfJTr42.js"),__vite__mapDeps([87,71,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,28,36,37,27,1,26,29,30,31,32,38,39,40,41,42,43,44,49]),import.meta.url),popover:()=>y(()=>import("./calcite-popover-5MaBc2pF.js"),__vite__mapDeps([88,38,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,39,23,40,41,42,43,26,27,28,30,25,44,29,1,24,31,32]),import.meta.url),scrim:()=>y(()=>import("./calcite-scrim-B8_2DHG_.js"),__vite__mapDeps([89,49,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,26,23,27,28,30,32]),import.meta.url),select:()=>y(()=>import("./calcite-select-CIxePAn2.js"),__vite__mapDeps([90,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,52,24,53,29,25,28,63,31,67]),import.meta.url),tab:()=>y(()=>import("./calcite-tab-DjqulRBq.js"),__vite__mapDeps([91,92,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]),import.meta.url),"tab-nav":()=>y(()=>import("./calcite-tab-nav-ICHHDzWW.js"),__vite__mapDeps([93,94,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,61,23,28,26,27,30,55,52,24,53,29,25,31,32]),import.meta.url),"tab-title":()=>y(()=>import("./calcite-tab-title-C-22SPvO.js"),__vite__mapDeps([95,96,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,28,26,27,30,29,31]),import.meta.url),tabs:()=>y(()=>import("./calcite-tabs-DnbX01M5.js"),__vite__mapDeps([97,98,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]),import.meta.url),tooltip:()=>y(()=>import("./calcite-tooltip-rE_jVYtd.js"),__vite__mapDeps([99,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,39,40,42,44]),import.meta.url)})}switchTab(s){this._activeTab=s}switchToFunctions(s,e){this._traceResultsFunctions=s,this._showTraceResultFunctions=e}switchToAssetGroup(s,e,t){this._traceHeaderForFlow=e,this._traceResultsAssetGroup=s,this._showTraceResultAssetGroup=t}switchToAssetType(s,e,t){this._assetGroupHeader=e,this._traceResultsAssetType=s,this._showTraceResultAssetType=t}switchToIndividualRecords(s,e,t){this._assetTypeHeader=e,this._traceResultsIndividual=s,this._showIndividualRecords=t}_renderUtilityNetworkTrace(){const{messages:s,messagesCommon:e}=this;let t=o("calcite-tabs",{layout:"center",position:"top",styles:nt(this.container)},o("calcite-tab-nav",{slot:"title-group"},o("calcite-tab-title",{onclick:()=>{this.switchTab("input")},selected:this._activeTab==="input"},s.inputsStrings.headerTabInputs),o("calcite-tab-title",{onclick:()=>{this.switchTab("result")},selected:this._activeTab==="result"},s.resultsStrings.headerTabResults)),o("calcite-tab",{selected:this._activeTab==="input"},this._renderInputPanel()),o("calcite-tab",{selected:this._activeTab==="result"},this.viewModel._activeProgress?o("calcite-loader",{label:s.alertsStrings.traceExecuting,text:s.alertsStrings.traceExecuting,type:"indeterminate"}):this.viewModel.traceResults.length>0?this._renderResultPanel():this._renderWarningMessage("noTraceExecuted",!1),this._confirmReset?o("calcite-scrim",{key:"prompt"},o("div",{class:T.clearPrompt},o("h3",{slot:"header"},s.resultsStrings.startOverButton),o("div",{slot:"content"},s.resultsStrings.startOverValidation),o("div",{class:T.promptDivider}),o("div",{styles:ue("row")},o("calcite-button",{appearance:"outline",onclick:()=>{this._confirmReset=!1},slot:"secondary",width:"full"},e.cancel),o("calcite-button",{onclick:()=>{this._confirmReset=!1,this.viewModel.reset(),this.switchTab("input")},slot:"primary",width:"full"},e.form.ok)))):null));return this.viewModel.traces.length===0&&(t=o("calcite-panel",null,this._renderWarningMessage("noTraceConfig",!1))),this._loadUNError||(t=o("calcite-panel",null,this._renderWarningMessage("loadUNError",!1,this._errorMessage))),t}_renderInputPanel(){const{messages:s}=this;return o("calcite-flow",{class:T.flow},o("calcite-flow-item",null,this._warningNoFlag?this._renderWarningMessage("flag",!0):null,this._warningNoTerminal?this._renderWarningMessage("noTerminal",!0):null,this._warningNoTraceSelected?this._renderWarningMessage("trace",!0):null,this._renderTraceSelectorContainer(),this._renderStartFlagsContainer(),this._renderBarriersFlagsContainer(),this._warningNoFlag&&this._warningNoTraceSelected?o("div",{styles:lt(10)}):null,o("calcite-button",{kind:"brand",onclick:()=>{this.checkCanTrace()},slot:"footer",width:"full"},s.tracingStrings.runTrace)),this._selectToolActive?this._renderActiveTool():null)}_renderResultPanel(){return o("calcite-flow",{styles:q()},this._renderTraceResults(),this._showTraceResultFunctions?this._renderTraceResultFunctions():null,this._showTraceResultAssetGroup?this._renderTraceResultByAssetGroup():null,this._showTraceResultAssetType?this._renderTraceResultByAssetType():null,this._showIndividualRecords?this._renderTraceResultIndividual():null,this._showIndividualRecords?this._renderTraceResultIndividualPopover():null)}_renderStartFlagsContainer(){const{messages:s}=this,e=[];let t=[];t=this.viewModel._flags.filter(r=>r.type==="starting-point"),t.forEach(r=>{r.displayValue&&e.push(this._renderFlagRow(r,"start"))});let i=null;return this._symbolStartFlag&&(i=this._getSymbolIcon(this._symbolStartFlag)),o("calcite-block",{collapsible:!0,heading:s.inputsStrings.headerStartingPoint+" ("+t.length+")",open:!0,overlayPositioning:"fixed"},o("div",{slot:"icon"},i||o("calcite-icon",{icon:"pin",scale:"s"})),o("div",null,s.inputsStrings.startingPointHint),o("div",{class:T.listContainer},e),this._warningNoStartAssetFound?this._renderWarningMessage("noStartAsset",!0):null,o("div",{class:T.addButtonContainer},o("calcite-button",{alignment:"center",appearance:"outline",href:"",iconStart:"plus",label:s.inputsStrings.addPointOption,onclick:()=>{this._changeCursor("crosshair"),this._flagViewType="starting-point",this._selectToolActive=!0,this._warningNoStartAssetFound=!1,this.viewModel.addFlagByHit("starting-point",this._symbolStartFlag).then(r=>{this._changeCursor("default"),r?this._warningNoFlag=!1:this._warningNoStartAssetFound=!0,this._selectToolActive=!1})},round:!0})))}_renderBarriersFlagsContainer(){const{messages:s}=this,e=[];let t=[];t=this.viewModel._flags.filter(r=>r.type==="barrier"),t.forEach(r=>{r.displayValue&&e.push(this._renderFlagRow(r,"barrier"))});let i=null;return this._symbolBarrier&&(i=this._getSymbolIcon(this._symbolBarrier)),o("calcite-block",{collapsible:!0,heading:s.inputsStrings.headerBarrier+" ("+t.length+")",open:!1,overlayPositioning:"fixed"},o("div",{slot:"icon"},i||o("calcite-icon",{icon:"x-circle-f",scale:"s"})),o("div",null,s.inputsStrings.barrierPointHint),o("div",{class:T.listContainer},e),this._warningNoBarrierAssetFound?this._renderWarningMessage("noBarrierAsset",!0):null,o("div",{class:T.addButtonContainer},o("calcite-button",{alignment:"center",appearance:"outline",href:"",iconStart:"plus",kind:"brand",label:s.inputsStrings.addPointOption,onclick:()=>{this._changeCursor("crosshair"),this._flagViewType="barrier",this._selectToolActive=!0,this._warningNoBarrierAssetFound=!1,this.viewModel.addFlagByHit("barrier",this._symbolBarrier).then(r=>{this._changeCursor("default"),r||(this._warningNoBarrierAssetFound=!0),this._selectToolActive=!1})},round:!0})))}_renderFlagRow(s,e){var a;const{messages:t,messagesCommon:i}=this,r=[];let l=!1;return s.allTerminals!=null&&s.allTerminals.terminals.length>0&&(l=!0,s.allTerminals.terminals.forEach(n=>{var h;let u=!1;(h=s==null?void 0:s.selectedTerminals)!=null&&h.includes(n.id)&&(u=!0),r.push(o("calcite-combobox-item",{key:n.name,selected:u,textLabel:n.name,value:n.id}))})),o("calcite-block",{collapsible:s.allTerminals!==null||s.type==="barrier",heading:((a=s.displayValue)==null?void 0:a.value)??"",key:"pop"+s.globalId+s.type+s.id+e,overlayPositioning:"fixed"},o("calcite-action",{icon:"trash",label:i.remove,onclick:()=>{this.viewModel.removeFlag(s)},scale:"s",slot:"header-menu-actions",text:i.remove,textEnabled:!0}),o("calcite-action",{icon:"zoom-to-object",label:t.globalStrings.zoomToFeature,onclick:()=>{this.viewModel.zoomToAsset(s.details.geometry)},scale:"s",slot:"header-menu-actions",text:t.globalStrings.zoomToFeature,textEnabled:!0}),s.type==="barrier"?o("calcite-label",{layout:"inline",scale:"s"},o("calcite-checkbox",{checked:s.isFilterBarrier,onclick:()=>{this.viewModel.manageFilterBarrier(!s.isFilterBarrier,s)},scale:"s"}),t.inputsStrings.barrierFilter):null,l?o("calcite-combobox",{label:t.globalStrings.selectTerminalPlaceholder,maxItems:0,placeholder:t.globalStrings.selectTerminalPlaceholder,scale:"s",selectionMode:"multiple",onCalciteComboboxChange:n=>{n.target.selectedItems.length>0?(s.selectedTerminals=[],n.target.selectedItems.forEach(u=>{this.viewModel.addTerminal(u.value,s)})):s.selectedTerminals=[]},onCalciteComboboxChipClose:n=>{n.preventDefault(),this.viewModel.removeTerminal(n.target.value,s)}},r):null)}_renderActiveTool(){const{messages:s}=this;let e=null;return this._flagViewType==="starting-point"?this._symbolStartFlag&&(e=this._getSymbolIcon(this._symbolStartFlag)):this._symbolBarrier&&(e=this._getSymbolIcon(this._symbolBarrier)),o("calcite-flow-item",{heading:s.inputsStrings.addPointOption,onCalciteFlowItemBack:()=>{var t;this.viewModel.removeClickHandler(),(t=this.view)!=null&&t.popup&&(this.view.popupEnabled=!0),this._changeCursor("default"),this._selectToolActive=!1}},o("calcite-block",{collapsible:!1,heading:"",open:!0,overlayPositioning:"fixed"},o("div",{styles:ce()},e||o("calcite-icon",{icon:this._flagViewType==="starting-point"?"pin-plus":"x-circle-f"})),o("div",{styles:ce()},s.inputsStrings.addPointHint)))}_renderTraceSelectorContainer(){const{messages:s}=this,e=[];let t=s.tracingStrings.traceOperation,i=0;return this.viewModel.traces.length>0&&this.viewModel.traces.forEach(r=>{e.push(o("calcite-combobox-item",{key:r.globalId,selected:r.selected,textLabel:r.title,value:r.globalId,onCalciteComboboxItemChange:l=>{const a=l.target;this.viewModel.selectTraces(a.selected,a.value),this.viewModel.traces.length>0&&(this._warningNoTraceSelected=!1)}})),r.selected&&i++}),t+=` (${i})`,o("calcite-block",{collapsible:!0,heading:t,open:!0,overlayPositioning:"fixed"},o("calcite-icon",{icon:"utility-network-trace",scale:"s",slot:"icon"}),o("calcite-combobox",{label:s.inputsStrings.selectTraces,maxItems:0,overlayPositioning:"fixed",placeholder:s.inputsStrings.selectTraces,scale:"s",selectionMode:"multiple"},e))}_renderStartOverContainer(){const{messages:s}=this;return o("calcite-button",{kind:"brand",onclick:()=>{this.confirmReset()},slot:"footer",width:"full"},s.resultsStrings.startOverButton)}_renderWarningMessage(s,e,t){const{messages:i}=this;let r=i.alertsStrings.NoRunAlertHeader,l=i.alertsStrings.noResultsInfo;switch(s){case"flag":r=i.alertsStrings.startingPointAlertHeader,l=i.alertsStrings.startingPointAlert;break;case"noTerminal":r=i.alertsStrings.noTerminalDefinedHeader,l=i.alertsStrings.noTerminalDefined;break;case"trace":r=i.alertsStrings.selectTraceAlertHeader,l=i.alertsStrings.selectTraceAlert;break;case"noTraceExecuted":r=i.alertsStrings.NoRunAlertHeader,l=i.alertsStrings.noResultsInfo;break;case"noBarrierAsset":case"noStartAsset":r=i.alertsStrings.noAssetsFoundHeader,l=i.alertsStrings.noAssetFound;break;case"noTraceConfig":r="",l=i.alertsStrings.noTraceSupported;break;default:r=i.alertsStrings.genericErrorHeader,l=t||""}return o("div",{class:T.noticeContainer,key:s},o("calcite-notice",{closable:e,icon:!0,key:s,kind:"danger",open:!0,scale:"s",width:"auto",onCalciteNoticeClose:()=>{switch(s){case"flag":this._warningNoFlag=!1;break;case"noTerminal":this._warningNoTerminal=!1;break;case"trace":this._warningNoTraceSelected=!1;break;case"noStartAsset":this._warningNoStartAssetFound=!1;break;case"noBarrierAsset":this._warningNoBarrierAssetFound=!1}}},o("div",{slot:"title"},r),o("div",{slot:"message"},l)))}_renderRemoveTraceContainer(s){const{messages:e}=this;return o("calcite-action",{icon:"trash",label:e.globalStrings.clearResults,onclick:()=>{this._alertRemoveModal=!0,this._activeTrace=s.trace},scale:"s",slot:"header-menu-actions",text:e.globalStrings.clearResults,textEnabled:!0})}_renderHighlightColorPicker(s,e,t){const{messages:i}=this,{graphicHandler:r}=this.viewModel,l=[],a=new RegExp(`^${s.hex}$`,"i"),n=r.highlightColor.length>X.length?5:4;for(const u of r.highlightColor)l.push(o("calcite-action",{active:a.test(u.hex),key:u.hex,label:i.resultsStrings.graphicColor,onclick:()=>{t==="aggregate"?this.viewModel.changeResultGraphicColor(u,e):this.viewModel.changeResultAreaColor(e,u)},scale:"s",text:i.resultsStrings.graphicColor},o("calcite-color-picker-swatch",{active:a.test(u.hex),color:u.hex,scale:"s"})));return o("calcite-action-pad",{expandDisabled:!0,layout:"grid",position:"start"},o("calcite-action-group",{columns:n,layout:"grid"},l))}_renderTraceResults(){const{messages:s,messagesCommon:e}=this,{selectFeatures:t}=s.resultsStrings,i=this.viewModel.traceResults,r=[];return i.forEach((l,a)=>{var _,v,R,I,C,M;let n=[],u=[],h=!1,c=!1,g=!1,f="";l.results!==null&&l.results.hasOwnProperty("elements")?(l.results.aggregatedGeometry!==null&&(c=!0),l.results.globalFunctionResults!==null&&l.results.globalFunctionResults.length>0&&(u=l.results.globalFunctionResults,u.length>0&&(g=!0)),l.results.elements&&l.results.elements.length>0&&(n=l.results.elements,n.length>0&&(h=!0)),(c||h)&&(f=(v=this.messagesUnits.units[(_=l.resultArea)==null?void 0:_.unit])==null?void 0:v.abbr),r.push(o("calcite-block",{collapsible:!0,description:l.trace.description??"",heading:l.trace.title,key:`${l.trace.title}${a}`,open:!0,overlayPositioning:"fixed"},this._renderRemoveTraceContainer(l),o("calcite-list",null,g?o("calcite-list-item",{label:s.resultsStrings.functionHeader+" ("+u.length+")",onCalciteListItemSelect:()=>{this.switchToFunctions(u,!0)}},o("calcite-icon",{icon:"chevron-right",scale:"s",slot:"content-end"})):null,h&&this.viewModel.showSelectionAttributes?o("calcite-list-item",{key:this.id,label:s.resultsStrings.viewFeatures+" ("+n.length+")",onCalciteListItemSelect:()=>{this.switchToAssetGroup(this._groupResultsByAssetGroup(l),l.trace.title+" ("+n.length+")",!0)}},o("calcite-icon",{icon:"chevron-right",scale:"s",slot:"content-end"})):this.viewModel.showSelectionAttributes?o("calcite-label",{layout:"inline",scale:"s"},s.resultsStrings.noSelectionResults):null),h?o("div",{class:T.paddingTop},o("calcite-label",{layout:"inline",onclick:b=>{b.preventDefault(),b.stopPropagation(),this.viewModel.mergeSelection(!l.selectionEnabled,l.trace)},scale:"s"},o("calcite-checkbox",{checked:l.selectionEnabled,onclick:b=>{b.preventDefault(),b.stopPropagation(),this.viewModel.mergeSelection(!l.selectionEnabled,l.trace)}}),this.viewModel.showSelectionAttributes?t:`${t} (${n.length})`)):null,c?o("calcite-block-section",{key:`aggregate-${l.trace.title}-${a}`,open:l.graphicEnabled,text:s.resultsStrings.highlightTrace,toggleDisplay:"switch",onCalciteBlockSectionToggle:b=>{b.target.open?this.viewModel.changeResultGraphicColor(l.graphicColor,l):this.viewModel.removeResultGraphicFromView(l)}},o("calcite-list",{selectionMode:"none"},o("calcite-list-item",{label:s.resultsStrings.graphicColor,onclick:b=>{const S=b.target;this._swatchNode=S,this._activeSwatch="aggGeom_"+a}},o("calcite-color-picker-swatch",{color:l.graphicColor.hex,scale:"s",slot:"actions-end"})))):null,this.enableResultArea&&(c||h)?o("calcite-block-section",{key:`area-${l.trace.title}-${a}`,open:(R=l.resultArea)==null?void 0:R.show,text:s.resultsStrings.resultAreaHeader,toggleDisplay:"switch",onCalciteBlockSectionToggle:b=>{b.target.open?l.resultAreaGraphic?this.viewModel.addResultAreaToMap(l,l.resultAreaGraphic):this.viewModel.addResultAreaToMap(l):this.viewModel.removeResultAreaFromMap(l)}},o("calcite-list",{selectionMode:"none"},o("calcite-list-item",{label:s.resultsStrings.graphicColor,onclick:b=>{const S=b.target;this._swatchNode=S,this._activeSwatch="resultArea_"+a}},o("calcite-color-picker-swatch",{color:(I=l.resultArea)==null?void 0:I.color.hex,scale:"s",slot:"actions-end"}))),o("calcite-list",{selectionMode:"none"},o("calcite-list-item",{label:s.resultsStrings.resultAreaBuffer},o("calcite-input-number",{afterCreate:this._afterComponentCreate,class:T.numberInput,max:999999,maxLength:999999,min:0,scale:"s",slot:"actions-end",suffixText:f,value:(C=l.resultArea)==null?void 0:C.distance.toString(),onCalciteInputNumberChange:b=>{var P;if(!((P=this.view)!=null&&P.popup))return;this.view.popup.visible&&this.view.closePopup();const S=b.target;l.resultArea.distance>=0?(l.resultArea.distance=parseInt(S.value,10),this.viewModel.removeResultAreaFromMap(l),this.viewModel.addResultAreaToMap(l)):(l.resultArea.distance=0,this.viewModel.removeResultAreaFromMap(l),this.viewModel.addResultAreaToMap(l))}})))):null,o("calcite-popover",{autoClose:!0,closable:!0,label:s.resultsStrings.graphicColor,offsetDistance:0,offsetSkidding:0,open:this._activeSwatch==="aggGeom_"+a||this._activeSwatch==="resultArea_"+a,placement:"auto-start",referenceElement:this._swatchNode,scale:"s",onCalcitePopoverClose:()=>{this._swatchNode=null,this._activeSwatch=null}},this._renderHighlightColorPicker(this._activeSwatch==="resultArea_"+a?(M=l.resultArea)==null?void 0:M.color:l.graphicColor,l,this._activeSwatch==="resultArea_"+a?"resultArea":"aggregate"))))):r.push(o("calcite-block",{collapsible:!1,heading:l.trace.title,key:"error-"+a,open:!0,overlayPositioning:"fixed"},this._renderRemoveTraceContainer(l),this._renderWarningMessage("noController",!1,l.status)))}),o("calcite-flow-item",{key:"traceResults",styles:q()},r,this._renderStartOverContainer(),this._alertRemoveModal?o("calcite-scrim",{key:"prompt"},o("div",{class:T.clearPrompt},o("h3",{slot:"header"},s.globalStrings.clearResults),o("div",{slot:"content"},s.alertsStrings.clearResultsAlert),o("div",{class:T.promptDivider}),o("div",{styles:ue("row")},o("calcite-button",{appearance:"outline",onclick:()=>{this._alertRemoveModal=!1},slot:"secondary",width:"full"},e.cancel),o("calcite-button",{onclick:()=>{this._activeTrace&&this.viewModel.clearResult(this._activeTrace),this._alertRemoveModal=!1,this.viewModel.traceResults.length===0?this.switchTab("input"):(this._activeTrace=this.viewModel.traceResults[0].trace,this._showTraceResultFunctions=!1,this._showTraceResultAssetGroup=!1,this._showTraceResultAssetType=!1,this._showIndividualRecords=!1)},slot:"primary",width:"full"},e.form.ok)))):null)}_renderTraceResultFunctions(){const{messages:s}=this,e=this._traceResultsFunctions,t=[];return e.forEach(i=>{t.push(this._renderResultRowFunctions(i))}),o("calcite-flow-item",{heading:s.resultsStrings.functionHeader,key:"functionResultMultiple",onCalciteFlowItemBack:()=>{this.switchToFunctions([],!1)}},t,this._renderStartOverContainer())}_renderTraceResultByAssetGroup(){const s=this._traceResultsAssetGroup,e=[];for(const t in s){const i=s[t];for(const r in i)e.push(this._renderResultRowAssetGroup(i[r]))}return o("calcite-flow-item",{heading:this._traceHeaderForFlow,key:"assetGroupResultMultiple",onCalciteFlowItemBack:()=>{this.switchToAssetGroup([],"",!1)}},o("calcite-list",null,e),this._renderStartOverContainer())}_renderTraceResultByAssetType(){const s=this._traceResultsAssetType,e=[];for(const t in s)s[t].length>0&&e.push(this._renderResultRowAssetType(s[t]));return o("calcite-flow-item",{heading:this._assetGroupHeader,key:"assetTypeResult",onCalciteFlowItemBack:()=>{this.switchToAssetType([],"",!1)}},o("calcite-list",{selectionMode:"none"},e),this._renderStartOverContainer())}_renderTraceResultIndividual(){var i;const{messages:s}=this,e=this._traceResultsIndividual;e.sort(this._compare(this._resultSortField,this._resultSortOrder));const t=[];return e.length>0&&((((i=e[0].details)==null?void 0:i.fields.some(({name:r})=>r.toLowerCase()===this._resultDisplayField.toLocaleLowerCase()))??!1)||(this._resultDisplayField=this._resultObjectIdField,this._resultSortField=this._resultObjectIdField),e.forEach(r=>{r!=null&&r.details&&t.push(this._renderResultRowIndividual(r))}),t.length===0&&t.push(o("calcite-list-item",{label:s.resultsStrings.noFeaturesInMap}))),o("calcite-flow-item",{heading:this._assetTypeHeader,key:"individualResult",onCalciteFlowItemBack:()=>{this._showResultOptions=!1,this.switchToIndividualRecords([],"",!1)}},o("calcite-action",{afterCreate:Re,bind:this,"data-node-ref":"_individualResultNode",icon:"gear",id:"field_options"+this.id,label:s.resultsStrings.displayAttribute,onclick:()=>{this._showResultOptions=!0},slot:"header-actions-end",text:s.resultsStrings.displayAttribute}),o("calcite-list",{selectionMode:"none"},t),this._renderStartOverContainer())}_renderTraceResultIndividualPopover(){const{messages:s}=this,e=this._traceResultsIndividual,t=[],i=[];return e.length>0&&(e[0].details?e[0].details.fields.forEach(({name:r,alias:l})=>{t.push(o("calcite-option",{key:`display-${r}`,label:l??r,selected:r===this._resultDisplayField,value:r})),i.push(o("calcite-option",{key:`sort-${r}`,label:l??r,selected:r===this._resultSortField,value:r}))}):(t.push(o("calcite-option",{key:`display-${this._resultDisplayField}`,label:this._resultDisplayField,value:this._resultDisplayField})),i.push(o("calcite-option",{key:`sort-${this._resultDisplayField}`,label:this._resultDisplayField,value:this._resultDisplayField})))),o("calcite-popover",{autoClose:!0,label:s.resultsStrings.displayAttribute,offsetDistance:0,offsetSkidding:0,open:this._showResultOptions,overlayPositioning:"fixed",placement:"left-start",referenceElement:this._individualResultNode,styles:this.domNode!==null?at(.75*this.domNode.clientWidth):ot()},o("calcite-block",{heading:"",open:!0,overlayPositioning:"fixed"},o("calcite-label",{scale:"s"},s.resultsStrings.displayAttribute,o("calcite-select",{label:s.resultsStrings.displayAttribute,scale:"s",onCalciteSelectChange:r=>{const l=r.target;this._resultDisplayField=l.selectedOption.value,this._showResultOptions=!1}},t)),o("calcite-label",{scale:"s"},s.resultsStrings.sortBy,o("calcite-select",{label:s.resultsStrings.sortBy,scale:"s",onCalciteSelectChange:r=>{const l=r.target;this._resultSortField=l.selectedOption.value,e.sort(this._compare(this._resultSortField,this._resultSortOrder)),this._traceResultsIndividual=e,this._showResultOptions=!1}},i))))}_renderResultRowFunctions(s){return o("calcite-block",{collapsible:!1,heading:s.networkAttributeName+" "+s.functionType+" = "+s.result,overlayPositioning:"fixed"})}_renderResultRowAssetGroup(s){const e=this._getAssetGroupName(s[0]);return o("calcite-list-item",{label:e+" ("+s.length+")",onCalciteListItemSelect:()=>{this.switchToAssetType(this._groupResultsByAssetType(s),e+" ("+s.length+")",!0)}},o("calcite-icon",{icon:"chevron-right",scale:"s",slot:"content-end"}))}_renderResultRowAssetType(s){const e=this._getAssetTypeName(s[0]);return o("calcite-list-item",{label:e+" ("+s.length+")",onCalciteListItemSelect:()=>{this.viewModel.queryFeaturesById(s).then(t=>{if(t!=null&&t.length){this._resultObjectIdField=t[0].layer.objectIdField,this._resultDisplayField==="objectid"&&(this._resultDisplayField=t[0].layer.objectIdField),this._resultSortField==="objectid"&&(this._resultSortField=t[0].layer.objectIdField);const i=this._appendAttributes(s,t,"objectId");this.switchToIndividualRecords(i,e+" ("+s.length+")",!0)}else this.switchToIndividualRecords(s,e+" ("+s.length+")",!0)})}},o("calcite-icon",{icon:"chevron-right",scale:"s",slot:"content-end"}))}_renderResultRowIndividual(s){var n,u,h;const{messages:e}=this,t=`display-${s.objectId}-nso`,{nonSpatialObject:i,zoomToFeature:r}=e.globalStrings;let l="",a=null;if(a=(n=s==null?void 0:s.details)==null?void 0:n.fields.find(({name:c})=>c===this._resultDisplayField),(a==null?void 0:a.type)==="date")l=new Date(s.details.attributes[this._resultDisplayField]).toDateString();else if(this._resultDisplayField.toLowerCase()==="assetgroup")l=this._getAssetGroupName(s);else if(this._resultDisplayField.toLowerCase()==="assettype")l=this._getAssetTypeName(s);else if(a!=null&&a.domain&&ct(a.domain)){const c=a.domain.codedValues.find(({code:g})=>g===s.details.attributes[this._resultDisplayField]);l=c==null?void 0:c.name}else l=((u=s.details)==null?void 0:u.attributes[this._resultDisplayField])??s.objectId;return l&&l!==""&&l!==null?typeof l=="string"&&(l.trim()||(l=e.resultsStrings.noValue)):l=e.resultsStrings.noValue,((h=s==null?void 0:s.details)==null?void 0:h.geometry)!==null?o("calcite-list-item",{label:l,onCalciteListItemSelect:()=>{this.viewModel.zoomToAsset(s.details.geometry)}},o("calcite-icon",{icon:"zoom-to-object",scale:"s",slot:"content-end",textLabel:r})):o("calcite-list-item",{label:l},o("calcite-icon",{icon:"table",id:t,scale:"s",slot:"content-end",textLabel:i}),o("calcite-tooltip",{label:i,referenceElement:t},o("span",null,i)))}_afterComponentCreate(s){"value"in s&&s.value!=null&&"setNumberValue"in s&&s.setNumberValue({committing:!1,value:s.value,origin:"direct"})}_mixCustomStrings(){const{messages:s}=this;this.inputSettings.length>0&&this.inputSettings.forEach(e=>{e.type==="starting-point"&&(s.inputsStrings.headerStartingPoint=e.label,s.inputsStrings.startingPointHint=e.description),e.type==="barrier"&&(s.inputsStrings.headerBarrier=e.label,s.inputsStrings.barrierPointHint=e.description)})}_overrideFlagSymbol(){this.inputSettings.length>0&&this.inputSettings.forEach(s=>{s.type==="starting-point"?this._symbolStartFlag=s.symbol:this._symbolBarrier=s.symbol,this.viewModel.changeFlagSymbol(s.type,s.symbol)})}_utilityNetworkTraceInitialized(){return this.viewModel.loadUtilityNetwork().then(s=>{var e;if(s)return this.viewModel.selectTracesOnLoad(),this._registerWatchers(),this.viewModel.flags.length>0&&this._processFlagOnLoad(),(e=this.view)==null?void 0:e.when().then(()=>{this._watchViewState()});this.disabled=!1}).catch(s=>{const{messages:e}=this;this._loadUNError=!1,s.name==="utility-network:no-user-type-extension"||s.details.raw.extendedCode===ut.noExtension?this._errorMessage=e.alertsStrings.noUserExtension:this._errorMessage=s.message,this.disabled=!1})}_processFlagOnLoad(){var s;return(s=this.view)==null?void 0:s.when().then(()=>{this._watchHandler=Y(()=>{var e;return!((e=this.view)!=null&&e.updating)},async()=>{this._warningNoFlag=!1,this._warningNoBarrierAssetFound=!1,this._warningNoStartAssetFound=!1;const e=await this.viewModel.addFlagsOnLoad();this.viewModel.removeFlagsOnLoadWatcher(),e.includes("barrier")&&(this._warningNoBarrierAssetFound=!0),e.includes("starting-point")&&(this._warningNoStartAssetFound=!0),this.disabled=!1,this._watchHandler!==null&&this._watchHandler.remove()})})}_registerWatchers(){this.addHandles([B(()=>this.selectedTraces,()=>{this.viewModel.selectTracesOnLoad(),this.scheduleRender()}),B(()=>this.defaultGraphicColor,()=>{this.viewModel.traceResults.length>0&&this.viewModel.traceResults.forEach(s=>{this.viewModel.changeResultGraphicColor(this.viewModel.defaultGraphicColor,s)}),this.scheduleRender()})])}_groupResultsByAssetGroup(s){var r;const e=[],t=(r=s.results)==null?void 0:r.elements,i=this._groupBy(t??[],"networkSourceId");for(const l in i)e.push(this._groupBy(i[l],"assetGroupCode"));return e}_groupResultsByAssetType(s){return this._groupBy(s,"assetTypeCode")}_appendAttributes(s,e,t){const i=[];return s.forEach(r=>{e.forEach(l=>{l.featureSet.features.forEach(a=>{r[t]===a.attributes[this._resultObjectIdField]&&(r.details=a,r.details.fields=l.featureSet.fields,i.push(r))})})}),i}_getAssetGroupName(s){let e=s.assetGroupCode.toString();const t=s.assetGroupCode,i=this.viewModel.getValidSources().find(r=>r.sourceId===s.networkSourceId);if(i){const r=i.assetGroups.find(l=>l.assetGroupCode===t);r&&(e=r.assetGroupName)}return e}_getAssetTypeName(s){let e=s.assetTypeCode.toString();const t=s.assetGroupCode,i=this.viewModel.getValidSources().find(r=>r.sourceId===s.networkSourceId);if(i){const r=i.assetGroups.find(l=>l.assetGroupCode===t);if(r){const l=r.assetTypes.find(a=>a.assetTypeCode===s.assetTypeCode);l&&(e=l.assetTypeName)}}return e}_compare(s,e){return(t,i)=>{var n,u;let r=0,l=((n=t.details)==null?void 0:n.attributes[s])??t.objectId,a=((u=i.details)==null?void 0:u.attributes[s])??i.objectId;return isNaN(l)&&(l=l.toLowerCase()),isNaN(a)&&(a=a.toLowerCase()),e==="desc"?l>a?r=1:l<a&&(r=-1):l<a?r=1:l>a&&(r=-1),r}}_groupBy(s,e){return s.reduce((t,i)=>((t[i[e]]=t[i[e]]||[]).push(i),t),{})}_getSymbolIcon(s){return s.type==="picture-marker"?o("img",{height:s.height,src:s.url??void 0,width:s.width}):null}_watchViewState(){this._watchHandler=Y(()=>{var s;return!((s=this.view)!=null&&s.updating)},()=>{this.disabled=!1,this._watchHandler!==null&&this._watchHandler.remove()},{initial:!0})}_changeCursor(s="default"){var t,i;const e=(i=(t=this.view)==null?void 0:t.container)==null?void 0:i.style;e&&(e.cursor=s)}};p([d()],m.prototype,"_selectToolActive",void 0),p([d()],m.prototype,"_activeTrace",void 0),p([d()],m.prototype,"_activeSwatch",void 0),p([d()],m.prototype,"_traceHeaderForFlow",void 0),p([d()],m.prototype,"_assetGroupHeader",void 0),p([d()],m.prototype,"_assetTypeHeader",void 0),p([d()],m.prototype,"_traceResultsFunctions",void 0),p([d()],m.prototype,"_traceResultsAssetGroup",void 0),p([d()],m.prototype,"_traceResultsAssetType",void 0),p([d()],m.prototype,"_traceResultsIndividual",void 0),p([d()],m.prototype,"_showTraceResultFunctions",void 0),p([d()],m.prototype,"_showTraceResultAssetGroup",void 0),p([d()],m.prototype,"_showTraceResultAssetType",void 0),p([d()],m.prototype,"_showIndividualRecords",void 0),p([d()],m.prototype,"_activeTab",void 0),p([d()],m.prototype,"_alertRemoveModal",void 0),p([d()],m.prototype,"_warningNoFlag",void 0),p([d()],m.prototype,"_warningNoTraceSelected",void 0),p([d()],m.prototype,"_confirmReset",void 0),p([d()],m.prototype,"_swatchNode",void 0),p([d()],m.prototype,"_errorMessage",void 0),p([d()],m.prototype,"defaultGraphicColor",null),p([d()],m.prototype,"disabled",void 0),p([d()],m.prototype,"flags",null),p([d()],m.prototype,"gdbVersion",null),p([d()],m.prototype,"icon",null),p([d()],m.prototype,"inputSettings",void 0),p([d()],m.prototype,"label",null),p([d(),V("esri/widgets/UtilityNetworkTrace/t9n/UtilityNetworkTrace")],m.prototype,"messages",void 0),p([d(),V("esri/t9n/common")],m.prototype,"messagesCommon",void 0),p([d(),V("esri/core/t9n/Units")],m.prototype,"messagesUnits",void 0),p([d()],m.prototype,"resultAreaProperties",null),p([d()],m.prototype,"selectedTraces",null),p([d()],m.prototype,"selectOnComplete",null),p([d()],m.prototype,"showGraphicsOnComplete",null),p([d()],m.prototype,"enableResultArea",null),p([d()],m.prototype,"showSelectionAttributes",null),p([d()],m.prototype,"utilityNetwork",null),p([d()],m.prototype,"view",null),p([Se(["add-flag","add-flag-complete","add-flag-error","select-features","clear-selection","add-result-area","remove-result-area","create-result-area","reset"]),d({type:ve})],m.prototype,"viewModel",void 0),m=p([he("esri.widgets.UtilityNetworkTrace")],m);const qs=m;export{qs as default};
