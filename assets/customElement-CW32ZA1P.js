const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-BPm91e5Z.js","./index-CMxz6F2k.js","./jsxFactory-Cnml7uXM.js","./Accessor-BmwT4B0c.js","./intl-Duiy0OzY.js","./Promise-DfET-uns.js","./cast-CsZslgGN.js","./index-4eY77cms.js","./index-Cx51aysm.css","./JSONSupport-DcrLLGjL.js","./Evented-Dw4_VOGn.js","./reactiveUtils-XM7cS2OP.js","./SimpleObservable-CvOkykwM.js","./uuid-Cl5lrJ4c.js","./guid-ejniuQmw.js","./useT9n-C1Hrfc-A.js","./index-DwIhxbHs.js","./dom-DEluURzl.js","./observers-Co4E8E8j.js","./keyed-CU1C-h1n.js","./directive-helpers-DaBykg1t.js","./ref-D9wHsL_T.js","./interactive-DTzfFku4.js","./loadable-XBvaWFYY.js","./component-CBVlbUuE.js","./index-jjUP6Yam.js","./static-DLD4WjLv.js","./form-BzoUrXC7.js","./label-CHHpnzD0.js","./index-CFf472S_.js","./index-BtUFGore.js","./key-CZcQa38B.js","./index-Dd_Yvsgp.js","./index-CMdCteX_.js","./index-Z5_W1-0F.js","./index-DMeQur4V.js","./floating-ui-IixYHfbQ.js","./debounce-DbkufipY.js","./openCloseComponent-nqWrSaIH.js","./FloatingArrow-BZRr6Zld.js","./useFocusTrap-COeL24Kx.js","./focusTrapComponent-D1wJZ4RD.js","./index-DK5B8inx.js","./array-BbE1dLa5.js","./index-DyXGQ9Xl.js","./index-C6rrpqn6.js","./index-pyEU_klK.js","./index-fFnlo_g2.js","./index-DWeq-ojO.js","./live-D7NQ-TrC.js","./locale-CXx8I9ox.js","./Validation-BYp9DS84.js","./input-DI9tZAPS.js","./index--OBudxYA.js","./index-BCDLx0rN.js","./filter-D4A4y0z5.js","./escapeRegExp-CdLjXKbf.js","./utils-Dtivty39.js","./index-B0pN5y8B.js","./index-DVGzfobf.js","./dynamicClasses-pKEMtFzB.js","./index-C7Sgjfzm.js","./resources6-Cs2_VmEC.js","./index-XCNLEnDV.js","./customElement-_nG5icNK.js","./resources5-SciNIBSe.js","./index-CV25o1as.js","./resources4-Crg87oFz.js","./index-BciJpaKz.js","./index-DF8g17W2.js","./index-LR3fUxQA.js","./responsive-C2Q8-dq_.js","./global-BYws3GYH.js","./index-BrUADYAu.js","./index-CkBUNtFu.js","./index-eIUyIhNj.js"])))=>i.map(i=>d[i]);
import{_ as c,L as Y,u as tt,c as et,n as ot,i as it,a as rt}from"./index-4eY77cms.js";import{r as P}from"./index-C5b9dHRB.js";import{g as j,r as s,m as n,a as D,s as E,G as at}from"./Accessor-BmwT4B0c.js";import{n as st}from"./Identifiable-BHVfzH03.js";import{E as V,e as q,j as H}from"./Promise-DfET-uns.js";import{u as A}from"./timeProperties-DLK_VrPU.js";import{O as lt,c as nt,n as r,T as S,e as G}from"./jsxFactory-Cnml7uXM.js";import{m as dt}from"./Viewpoint-DvyUmqUt.js";import{V as mt}from"./reactiveUtils-XM7cS2OP.js";import{i as ut}from"./Evented-Dw4_VOGn.js";import{a as ct}from"./cast-CsZslgGN.js";import{y as z}from"./Bookmark-Bpns-J48.js";import{t as ht}from"./GoTo-zPv0y7kC.js";import{e as C}from"./globalCss-vQlnDsEX.js";import{e as kt}from"./Heading-BcR6CGTM.js";import{t as pt}from"./listUtils-vswmtyNy.js";import{e as _t}from"./vmEvent-D4Ubqkbq.js";import{P as bt}from"./useWidget-BajufX8l.js";import"./JSONSupport-DcrLLGjL.js";import"./TimeExtent-BO6BsF_x.js";import"./timeUtils-C1c_L2Fd.js";import"./writer-DKgfqj4X.js";import"./intl-Duiy0OzY.js";import"./uuid-Cl5lrJ4c.js";import"./Camera-CdyTfTAk.js";import"./Clonable-Z-AWS-16.js";import"./Cyclical-Dlbl-cQK.js";import"./mathUtils-Cfq9PL9W.js";import"./Point-Cz2JYYmX.js";import"./jsonUtils-CwFG8yN4.js";import"./Extent-g5W9hy0j.js";import"./Polyline-s-JzsQqo.js";import"./typeUtils-B6WBEKDM.js";import"./SimpleObservable-CvOkykwM.js";import"./component-utils-D0ciaaZ_.js";let g=class extends j{constructor(e){super(e)}get editedBookmark(){const{bookmark:e}=this;return e?this._get("editedBookmark")||e.clone():null}get customUrl(){var e,o;return(o=(e=this.editedBookmark)==null?void 0:e.thumbnail)!=null&&o.isSecureUrl?this.editedBookmark.thumbnail.url:null}set customUrl(e){this._override("customUrl",e)}get screenshotUrl(){var e,o;return(o=(e=this.editedBookmark)==null?void 0:e.thumbnail)!=null&&o.isDataURI?this.editedBookmark.thumbnail.url:null}set screenshotUrl(e){this._override("screenshotUrl",e)}get state(){return this._get("state")}set state(e){this.validationState=void 0,this.loading=void 0,this._set("state",e)}get thumbnailState(){var e,o,i,a;return(o=(e=this.editedBookmark)==null?void 0:e.thumbnail)!=null&&o.url?(a=(i=this.editedBookmark)==null?void 0:i.thumbnail)!=null&&a.isSecureUrl?"url":"screenshot":"none"}set thumbnailState(e){this._overrideIfSome("thumbnailState",e)}};s([n()],g.prototype,"bookmark",void 0),s([n({readOnly:!0})],g.prototype,"editedBookmark",null),s([n()],g.prototype,"customUrl",null),s([n()],g.prototype,"screenshotUrl",null),s([n()],g.prototype,"state",null),s([n()],g.prototype,"thumbnailState",null),s([n()],g.prototype,"validationState",void 0),s([n()],g.prototype,"loading",void 0),g=s([D("esri.widgets.Bookmarks.BookmarksUserState")],g);const R=g,J=mt.ofType(z),gt={width:128,height:128,format:"png"},x={takeScreenshot:!0,captureViewpoint:!0,captureRotation:!0,captureScale:!0,captureTimeExtent:!0},Z={time:!0};let v=class extends ht(ut.EventedAccessor){constructor(t){super(t),this.capabilities={...Z},this.activeBookmark=null,this.view=null}destroy(){this.view=null,this._set("activeBookmark",null)}castCapabilities(t){return{...Z,...t}}get bookmarks(){var t,e;return((e=(t=this.view)==null?void 0:t.map)==null?void 0:e.bookmarks)??new J}set bookmarks(t){this._overrideIfSome("bookmarks",t)}set defaultCreateOptions(t){this._set("defaultCreateOptions",{...x,...t})}get defaultCreateOptions(){return x}set defaultEditOptions(t){this._set("defaultEditOptions",{...x,...t})}get defaultEditOptions(){return x}get state(){const{view:t}=this;return t&&!t.ready?"loading":"ready"}async createBookmark(t){const{view:e,defaultCreateOptions:o,capabilities:i}=this;if(!e)throw new E("create-bookmark:invalid-view","Cannot create a bookmark without a view.");const{takeScreenshot:a,screenshotSettings:l,captureViewpoint:m,captureRotation:u,captureScale:_,captureTimeExtent:f}={...o,...t},k=a?await this._createThumbnail(l):void 0,w=i.time&&f&&e.timeExtent!=null?e.timeExtent.clone():void 0;return new z({...k&&{thumbnail:k},...f&&{timeExtent:w},...m&&{viewpoint:this._createViewpoint({view:e,captureScale:_,captureRotation:u})}})}async editBookmark(t,e){if(!t)return t;const{view:o,defaultEditOptions:i}=this;if(!o)throw new E("edit-bookmark:invalid-view","Cannot edit a bookmark without a view.");const{takeScreenshot:a,screenshotSettings:l,captureViewpoint:m,captureRotation:u,captureScale:_,captureTimeExtent:f}={...i,...e},k=a?await this._createThumbnail(l):void 0;return k&&(t.thumbnail=k),m&&(t.viewpoint=this._createViewpoint({view:o,captureScale:_,captureRotation:u})),f&&o.timeExtent!=null&&(t.timeExtent=o.timeExtent.clone()),this.emit("bookmark-edit",{bookmark:t}),t}goTo(t){const{capabilities:e,view:o}=this;if(!o)throw new E("go-to:invalid-view","Cannot go to a bookmark without a view");const i=t==null?void 0:t.viewpoint;if(!i)throw new E("go-to:invalid-bookmark","Cannot go to a bookmark that does not contain a 'viewpoint'.",{bookmark:t});this._set("activeBookmark",t);const a=this.callGoTo({target:i}),l=t==null?void 0:t.timeExtent;return e.time&&l&&(o.timeExtent=l),this.emit("bookmark-select",{bookmark:t}),a.catch(()=>{}).then(()=>this._set("activeBookmark",null)),a}async _createThumbnail(t){const{view:e}=this;if(!e)throw new E("bookmark:invalid-view","Cannot create slide thumbnail without a view");const o=await e.takeScreenshot({...gt,...t});return new A({url:o.dataUrl})}_createViewpoint({view:t,captureRotation:e,captureScale:o}){var a,l;const i=(a=t.viewpoint)==null?void 0:a.clone();return new dt({targetGeometry:(l=t.extent)==null?void 0:l.clone(),rotation:(e?i==null?void 0:i.rotation:null)??0,scale:(o?i==null?void 0:i.scale:null)??0})}};s([n()],v.prototype,"capabilities",void 0),s([ct("capabilities")],v.prototype,"castCapabilities",null),s([n({readOnly:!0})],v.prototype,"activeBookmark",void 0),s([n({type:J})],v.prototype,"bookmarks",null),s([n()],v.prototype,"defaultCreateOptions",null),s([n()],v.prototype,"defaultEditOptions",null),s([n({readOnly:!0})],v.prototype,"state",null),s([n()],v.prototype,"view",void 0),v=s([D("esri.widgets.Bookmarks.BookmarksViewModel")],v);const K=v;let b=class extends j{constructor(){super(...arguments),this.addBookmarkButton=!1,this.closeButton=!1,this.collapseButton=!1,this.editBookmarkButton=!1,this.filter=!1,this.flow=!0,this.heading=!1,this.thumbnail=!0,this.time=!0}};s([n({type:Boolean,nonNullable:!0})],b.prototype,"addBookmarkButton",void 0),s([n({type:Boolean,nonNullable:!0})],b.prototype,"closeButton",void 0),s([n({type:Boolean,nonNullable:!0})],b.prototype,"collapseButton",void 0),s([n({type:Boolean,nonNullable:!0})],b.prototype,"editBookmarkButton",void 0),s([n({type:Boolean,nonNullable:!0})],b.prototype,"filter",void 0),s([n({type:Boolean,nonNullable:!0})],b.prototype,"flow",void 0),s([n({type:Boolean,nonNullable:!0})],b.prototype,"heading",void 0),s([n({type:Boolean,nonNullable:!0})],b.prototype,"thumbnail",void 0),s([n({type:Boolean,nonNullable:!0})],b.prototype,"time",void 0),b=s([D("esri.widgets.Bookmarks.BookmarksVisibleElements")],b);const Q=b,p="esri-bookmarks",$=`${p}__authoring`,U=`${p}__bookmark`,h={base:p,noBookmarksHeader:`${p}__no-bookmarks-heading`,noBookmarksDescription:`${p}__no-bookmarks-description`,form:`${p}__form`,list:`${p}__list`,loader:`${p}__loader`,filterNoResults:`${p}__filter-no-results`,formContent:`${p}__form-content`,addBookmarkButton:`${p}__add-bookmark-button`,editBookmarkInput:`${p}__edit-bookmark-input`,addBookmarkInput:`${p}__add-bookmark-input`,dragEnabled:`${p}--drag-enabled`,bookmarkImage:`${p}__image`,bookmarkImageContainer:`${U}-image-container`,bookmarkContent:`${U}-content`,bookmarkContentLabel:`${U}-content-label`,authoring:$,authoringImageContainer:`${$}-image-container`,authoringRefreshThumbnailButton:`${$}-refresh-thumbnail-button`};let d=class extends st.IdentifiableMixin(lt){constructor(t,e){super(t,e),this._addInputNode=null,this._editInputNode=null,this._urlEditInputNode=null,this._lastDragDetail=null,this._selectedDragBookmarkUid=null,this._editIncludeTimeExtent=void 0,this._userState=null,this._focusRootFlowItem=!1,this._focusAddFlowItem=!1,this._focusEditFlowItem=!1,this.disabled=!1,this.dragEnabled=!1,this.filterPlaceholder="",this.filterText="",this.headingLevel=2,this.messages=null,this.messagesCommon=null,this.viewModel=new K,this.visibleElements=new Q,this._onCalciteListOrderChange=o=>{const{_lastDragDetail:i,bookmarks:a}=this,{toEl:l,fromEl:m,dragEl:u,newIndex:_}=o;if(!a.length||!m||!l||(i==null?void 0:i.newIndex)===_&&(i==null?void 0:i.dragEl)===u&&(i==null?void 0:i.toEl)===l&&(i==null?void 0:i.fromEl)===m)return;this._lastDragDetail=o;const f=Array.from(m.children).filter(k=>k==null?void 0:k.matches("calcite-list-item")).map(k=>k.value);a.sort((k,w)=>{const I=f.indexOf(k.uid),T=f.indexOf(w.uid);return I>T?1:I<T?-1:0}),this._selectedDragBookmarkUid=u.value}}loadDependencies(){return nt({action:()=>c(()=>import("./index-BPm91e5Z.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24]),import.meta.url),button:()=>c(()=>import("./index-jjUP6Yam.js"),__vite__mapDeps([25,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,21,20,26,27,22,28,23,24]),import.meta.url),"chip-group":()=>c(()=>import("./index-CFf472S_.js"),__vite__mapDeps([29,2,3,4,5,6,7,8,9,10,11,12,13,21,20,17,14,22,23]),import.meta.url),chip:()=>c(()=>import("./index-BtUFGore.js"),__vite__mapDeps([30,16,2,3,4,5,6,7,8,9,10,11,12,13,17,14,18,21,20,23,22,31,24,15]),import.meta.url),fab:()=>c(()=>import("./index-Dd_Yvsgp.js"),__vite__mapDeps([32,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,25,21,20,26,27,22,28,23,24]),import.meta.url),flow:()=>c(()=>import("./index-CMdCteX_.js"),__vite__mapDeps([33,2,3,4,5,6,7,8,9,10,11,12,13,21,20,18,23,17,14]),import.meta.url),"flow-item":()=>c(()=>import("./index-Z5_W1-0F.js"),__vite__mapDeps([34,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,0,19,20,21,22,23,24,35,36,37,38,26,39,40,41,31,42,43,44,45]),import.meta.url),icon:()=>c(()=>import("./index-DwIhxbHs.js").then(t=>t.i),__vite__mapDeps([16,2,3,4,5,6,7,8,9,10,11,12,13,17,14,18]),import.meta.url),input:()=>c(()=>import("./index-pyEU_klK.js"),__vite__mapDeps([46,16,2,3,4,5,6,7,8,9,10,11,12,13,17,14,18,47,48,49,20,19,21,26,27,22,31,28,23,50,24,51,15,52]),import.meta.url),"input-message":()=>c(()=>import("./index-fFnlo_g2.js"),__vite__mapDeps([47,16,2,3,4,5,6,7,8,9,10,11,12,13,17,14,18]),import.meta.url),label:()=>c(()=>import("./index--OBudxYA.js"),__vite__mapDeps([53,2,3,4,5,6,7,8,9,10,11,12,13,28,17,14]),import.meta.url),list:()=>c(()=>import("./index-BCDLx0rN.js"),__vite__mapDeps([54,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,44,21,20,18,17,19,16,47,48,46,49,26,27,22,31,28,23,50,24,51,52,55,56,37,57]),import.meta.url),"list-item":()=>c(()=>import("./index-B0pN5y8B.js"),__vite__mapDeps([58,16,2,3,4,5,6,7,8,9,10,11,12,13,17,14,18,59,21,20,36,37,22,31,23,38,60,1,15,0,19,24,61,62,63,64,57,65]),import.meta.url),loader:()=>c(()=>import("./index-CMxz6F2k.js"),__vite__mapDeps([1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]),import.meta.url),notice:()=>c(()=>import("./index-CV25o1as.js"),__vite__mapDeps([66,16,2,3,4,5,6,7,8,9,10,11,12,13,17,14,18,21,20,23,67,38,24,15]),import.meta.url),scrim:()=>c(()=>import("./index-DyXGQ9Xl.js"),__vite__mapDeps([44,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,21,20,18,17]),import.meta.url),switch:()=>c(()=>import("./index-BciJpaKz.js"),__vite__mapDeps([68,2,3,4,5,6,7,8,9,10,11,12,13,21,20,17,14,27,22,31,28,23]),import.meta.url),table:()=>c(()=>import("./index-DF8g17W2.js"),__vite__mapDeps([69,16,2,3,4,5,6,7,8,9,10,11,12,13,17,14,18,30,21,20,23,22,31,24,15,1,25,26,27,28,70,19,50,71,72]),import.meta.url),"table-cell":()=>c(()=>import("./index-BrUADYAu.js"),__vite__mapDeps([73,2,3,4,5,6,7,8,9,10,11,12,13,21,20,23,22,17,14,15]),import.meta.url),"table-header":()=>c(()=>import("./index-CkBUNtFu.js"),__vite__mapDeps([74,16,2,3,4,5,6,7,8,9,10,11,12,13,17,14,18,21,20,23,24,15]),import.meta.url),"table-row":()=>c(()=>import("./index-eIUyIhNj.js"),__vite__mapDeps([75,16,2,3,4,5,6,7,8,9,10,11,12,13,17,14,18,74,21,20,23,24,15,73,22,19,31]),import.meta.url)})}get defaultCreateOptions(){return this.viewModel.defaultCreateOptions}set defaultCreateOptions(t){this.viewModel.defaultCreateOptions=t}get defaultEditOptions(){return this.viewModel.defaultEditOptions}set defaultEditOptions(t){this.viewModel.defaultEditOptions=t}get bookmarks(){return this.viewModel.bookmarks}set bookmarks(t){this.viewModel.bookmarks=t}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(t){this.viewModel.goToOverride=t}get icon(){return"bookmark"}set icon(t){this._overrideIfSome("icon",t)}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}endAddBookmark(){this._userState=null}goTo(t){return this.viewModel.goTo(t)}render(){return r("div",{class:this.classes(h.base,C.widget,C.panel)},this._renderBookmarksContainer())}startAddBookmark(){this._userState=new R({state:"add"}),this._focusAddFlowItem=!0}_renderNoBookmarksContainer(t){const{messages:e,viewModel:{state:o}}=this;return t.length||o==="loading"?null:r("div",{class:C.empty,key:"no-bookmarks"},r("calcite-icon",{icon:"bookmark",scale:"l"}),r(kt,{class:this.classes(C.heading,h.noBookmarksHeader),level:this.headingLevel},e==null?void 0:e.noBookmarksHeading),r("p",{class:h.noBookmarksDescription},e.noBookmarksDescription))}_renderEditBookmarkFlowItems(){const{_userState:t}=this,e=t==null?void 0:t.editedBookmark;return e&&(t==null?void 0:t.state)==="edit"?this._renderEditingBookmark(e):[]}_renderBookmarkItems(t){return t?t.toArray().map(e=>this._renderBookmark(e)):[]}_handleCalciteListDragEnd(t){const{fromEl:e,dragEl:o,oldIndex:i}=t;e.insertBefore(o,e.children[i])}_renderBookmarksContainer(){var M;const{viewModel:{state:t,bookmarks:e},dragEnabled:o,messages:i,disabled:a,filterPlaceholder:l,filterText:m,visible:u,headingLevel:_,visibleElements:{closeButton:f,collapseButton:k,filter:w,heading:I,flow:T},uid:W}=this,O=e.filter(at),X=O.length?r("calcite-list",{class:h.list,displayMode:"flat",dragEnabled:o,filterEnabled:w,filterPlaceholder:l,filterProps:pt,filterText:m,group:`bookmarks-${W}`,key:"bookmark-list",label:i.widgetLabel,selectionAppearance:"border",selectionMode:"none",onCalciteListDragEnd:B=>this._handleCalciteListDragEnd(B.detail),onCalciteListFilter:B=>{var N;return this.filterText=((N=B.currentTarget)==null?void 0:N.filterText)??""},onCalciteListOrderChange:B=>this._onCalciteListOrderChange(B.detail)},this._renderBookmarkItems(O),w?r("div",{class:h.filterNoResults,slot:"filter-no-results"},r("calcite-notice",{kind:"info",open:!0,width:"full"},r("div",{slot:"message"},i.noBookmarksHeading),";")):null):null,F=[r("calcite-flow-item",{afterCreate:this._focusRootFlowItemNode,afterUpdate:this._focusRootFlowItemNode,bind:this,closable:f,closed:!u,collapsible:k,disabled:a,heading:I?i.widgetLabel:void 0,headingLevel:_,loading:t==="loading",selected:!((M=this._userState)!=null&&M.state),onCalciteFlowItemClose:()=>this.visible=!1},this._renderNoBookmarksContainer(O),X,this._renderAddBookmarkButton()),this._renderAddingBookmark(),this._renderEditBookmarkFlowItems()];return u?T?r("calcite-flow",{key:"root-flow"},F):F:null}_renderAddBookmarkButton(){const{messages:t,_userState:e,disabled:o,viewModel:{view:i,state:a},visibleElements:{addBookmarkButton:l}}=this,m=(e==null?void 0:e.loading)??!1;return i&&a!=="loading"&&l?r("calcite-fab",{appearance:"outline-fill",bind:this,class:h.addBookmarkButton,disabled:o||m,icon:"plus",key:"add-bookmark-item",kind:"neutral",loading:m,onclick:this.startAddBookmark,slot:"fab",text:t.addBookmark,textEnabled:!0,title:t.addBookmark,type:"button"}):null}_renderEditContainer(t){const{messagesCommon:e,visibleElements:{editBookmarkButton:o}}=this,i=`${e.edit} ${this._getBookmarkTitle(t)}`;return o?r("calcite-action",{appearance:"transparent",icon:"pencil",key:"edit-action",onclick:()=>this._showEditBookmarkForm(t),slot:"actions-end",text:i,title:i}):null}_renderBookmarkImage(t,e){var o;return e?r("img",{alt:"",class:h.bookmarkImage,key:"bookmark-image",src:(o=t.thumbnail)==null?void 0:o.url}):null}_renderBookmarkTimeSwitch(t){const{messages:e,viewModel:{view:o}}=this,{timeExtent:i}=t;return(o==null?void 0:o.timeExtent)??i?r("calcite-label",{layout:"inline-space-between"},e.includeTimeExtent,r("calcite-switch",{checked:!!i,onCalciteSwitchChange:a=>{this._editIncludeTimeExtent=!!a.currentTarget.checked}})):null}_renderEditBookmarkTimeExtent(t){return this._editIncludeTimeExtent?this._renderBookmarkTimeExtent(t):null}_getTimeExtentStrings(t){const{visibleElements:e}=this,{timeExtent:o}=t;if(!o)return{};const{start:i,end:a}=o,l=a!=null&&(i==null||i.getTime()!==a.getTime()),m=i?this._formatDate(i):"",u=i&&e.time?this._formatTime(i):"";return l?{startDate:m,startTime:u,endDate:this._formatDate(a),endTime:e.time?this._formatTime(a):""}:{startDate:m,startTime:u}}_renderTimeExtentDescription(t){const{startDate:e,startTime:o,endDate:i,endTime:a}=this._getTimeExtentStrings(t);if(!e)return"";const l=`${e} ${o}`;return i?`${l} - ${`${i} ${a}`}`:l}_renderBookmarkTimeExtent(t,e=!1){const{messages:o}=this,{startDate:i,startTime:a,endDate:l,endTime:m}=this._getTimeExtentStrings(t),u=e?null:r("calcite-table-row",{slot:"table-header"},r("calcite-table-header",{heading:o.startDate}),l?r("calcite-table-header",{heading:o.endDate}):null);return i?r("calcite-table",{caption:o.timeExtent,scale:"s"},u,r("calcite-table-row",null,r("calcite-table-cell",null,i," ",a?[r("br",null),a]:null),l?r("calcite-table-cell",null,l,m?[r("br",null),m]:null):null)):null}_renderBookmarkActiveScrim(t,e){return this.viewModel.activeBookmark===t&&e?r("calcite-scrim",{key:"bookmark-active-scrim",loading:!0}):null}_renderBookmarkActiveLoader(t,e){return this.viewModel.activeBookmark!==t||e?null:r("calcite-loader",{class:h.loader,inline:!0,key:"bookmark-active-loader",label:this.messagesCommon.loading})}_renderBookmarkImageIcon(t,e){return this.viewModel.activeBookmark===t||e?null:r("calcite-icon",{icon:"bookmark",key:"bookmark-icon",scale:"s"})}_renderBookmarkThumbnail(t){var o;const e=this.visibleElements.thumbnail&&!!((o=t.thumbnail)!=null&&o.url);return r("div",{class:h.bookmarkImageContainer,slot:"content-start"},this._renderBookmarkActiveScrim(t,e),this._renderBookmarkImage(t,e),this._renderBookmarkActiveLoader(t,e),this._renderBookmarkImageIcon(t,e))}_focusSelectedDragEl(t,e){this._selectedDragBookmarkUid===e.uid&&(S(t),this._selectedDragBookmarkUid=null)}_renderBookmark(t){return r("calcite-list-item",{afterCreate:e=>this._focusSelectedDragEl(e,t),afterUpdate:e=>this._focusSelectedDragEl(e,t),class:this.classes({[h.dragEnabled]:this.dragEnabled}),description:this._renderTimeExtentDescription(t),key:t.uid,label:this._getBookmarkTitle(t),value:t.uid,onCalciteListItemSelect:()=>this._goToBookmark(t)},this._renderBookmarkThumbnail(t),this._renderBookmarkContent(t),this._renderEditContainer(t))}_renderBookmarkContent(t){return r("div",{class:h.bookmarkContent,slot:"content"},r("span",{class:h.bookmarkContentLabel},this._getBookmarkTitle(t)),this._renderBookmarkTimeExtent(t,!0))}_renderEditingBookmarkName(t){const{messages:e,_userState:o}=this,i=(o==null?void 0:o.validationState)==="name-required";return r("calcite-label",null,e.title,r("calcite-input",{afterCreate:this._storeEditInput,bind:this,class:h.editBookmarkInput,name:"bookmark-name",placeholder:e.titlePlaceholder,required:!0,type:"text",value:t.name}),i?r("calcite-input-message",{icon:"exclamation-mark-triangle",status:"invalid"},e.invalidTitle):null)}_renderEditingBookmarkActions(){const{messagesCommon:t,_userState:e}=this,o=e==null?void 0:e.bookmark;return[r("calcite-button",{appearance:"transparent",kind:"danger",onclick:()=>this._deleteBookmark(o),slot:"footer",type:"button",width:"full"},t.delete),r("calcite-button",{appearance:"outline",bind:this,onclick:this._closeEditBookmarkForm,slot:"footer",type:"button",width:"full"},t.cancel),r("calcite-button",{slot:"footer",type:"submit",width:"full"},t.save)]}_handleUrlEditInputChange(){var a,l;const{_userState:t,_urlEditInputNode:e}=this,o=e==null?void 0:e.value;if(!(t!=null&&t.editedBookmark)||!o)return;t.validationState=void 0,(a=t.editedBookmark.thumbnail)!=null&&a.isDataURI&&(t.screenshotUrl=(l=t.editedBookmark.thumbnail)==null?void 0:l.url);const i=new A({url:o});i.isSecureUrl&&(t.customUrl=o,t.editedBookmark.thumbnail=i)}_renderEditingTimeExtent(t){const{capabilities:e,view:o}=this.viewModel,{timeExtent:i}=t;return e.time&&((o==null?void 0:o.timeExtent)??i)?r("div",{key:"edit-bookmark-time-container"},this._renderBookmarkTimeSwitch(t),this._renderEditBookmarkTimeExtent(t)):null}_renderEditingBookmarkImage(t){var a,l;const{_userState:e}=this,o=e==null?void 0:e.thumbnailState,i=(a=t.thumbnail)!=null&&a.isSecureUrl?o==="url":(l=t.thumbnail)!=null&&l.isDataURI?o==="screenshot":null;if(i)return this._renderBookmarkImage(t,i)}_renderEditingThumbnail(t){const{_userState:e,visibleElements:o}=this,i=e==null?void 0:e.thumbnailState;return o.thumbnail&&i!=="none"?r("div",{class:h.authoringImageContainer},this._renderEditingBookmarkImage(t)):null}_renderUpdateThumbnailButton(){const{visibleElements:t,messages:e,_userState:o}=this,i=o==null?void 0:o.thumbnailState;return t.thumbnail&&i==="screenshot"?r("calcite-button",{appearance:"outline",class:h.authoringRefreshThumbnailButton,iconStart:"refresh",key:"update-thumbnail",kind:"neutral",onclick:()=>{this._updateThumbnail()},width:"full"},e.updateThumbnail):null}_renderEditingBookmarkUrlInput(t){var u,_;const{messages:e,_userState:o}=this,i=(u=t.thumbnail)==null?void 0:u.url,a=(_=t.thumbnail)!=null&&_.isSecureUrl?i:void 0,l=i&&(o==null?void 0:o.validationState)==="absolute-url-required";return(o==null?void 0:o.thumbnailState)==="url"?r("calcite-label",{key:"thumbnail-url-input"},r("calcite-input",{afterCreate:this._storeUrlEditInput,bind:this,name:"bookmark-thumbnail-url",pattern:"https://.*",placeholder:e?`https://<${e.imageUrlPlaceholder}>`:void 0,required:!0,title:e.imageUrlTooltip,type:"text",value:a,onCalciteInputChange:this._handleUrlEditInputChange,onCalciteInputInput:this._handleUrlEditInputChange}),l?r("calcite-input-message",{icon:"exclamation-mark-triangle",status:"invalid"},e.invalidImageUrl):null):null}_renderThumbnailSelector(){const{visibleElements:t,messages:e,_userState:o}=this,i=o==null?void 0:o.thumbnailState;return t.thumbnail?r("calcite-label",{key:"thumbnail-chip-group"},e.thumbnail,r("calcite-chip-group",{label:e.thumbnail,selectionMode:"single-persist",onCalciteChipGroupSelect:a=>this._handleThumbnailTypeSelect(a.currentTarget.selectedItems[0].value)},r("calcite-chip",{label:e.screenshot,selected:i==="screenshot",value:"screenshot"},e.screenshot),r("calcite-chip",{label:e.url,selected:i==="url",value:"url"},e.url),r("calcite-chip",{label:e.none,selected:i==="none",value:"none"},e.none))):null}_renderEditingBookmark(t){var a;const{disabled:e,messagesCommon:o,headingLevel:i}=this;return t?r("form",{bind:this,class:h.form,disabled:this.disabled,onsubmit:this._editBookmarkSubmit},r("calcite-flow-item",{afterCreate:this._focusEditFlowItemNode,afterUpdate:this._focusEditFlowItemNode,bind:this,disabled:e,heading:o.edit,headingLevel:i,key:"edit-bookmark-form",selected:((a=this._userState)==null?void 0:a.state)==="edit",onCalciteFlowItemBack:l=>{l.preventDefault(),this._closeEditBookmarkForm()}},r("div",{class:h.formContent},r("div",{class:h.authoring},this._renderEditingBookmarkName(t),this._renderThumbnailSelector(),this._renderEditingThumbnail(t),this._renderEditingBookmarkUrlInput(t),this._renderUpdateThumbnailButton(),this._renderEditingTimeExtent(t))),this._renderEditingBookmarkActions())):null}_renderAddingBookmarkName(){const{_userState:t,messages:e}=this,o=(t==null?void 0:t.validationState)==="name-required";return r("calcite-label",null,e.title,r("calcite-input",{afterCreate:this._storeAddInput,bind:this,class:h.addBookmarkInput,name:"bookmark-name",placeholder:e.titlePlaceholder,required:!0,type:"text",value:""}),o?r("calcite-input-message",{icon:"exclamation-mark-triangle",status:"invalid"},e.invalidTitle):null)}_renderAddingBookmarkActions(){const{messagesCommon:t}=this;return[r("calcite-button",{appearance:"outline",bind:this,onclick:this._endAddBookmark,slot:"footer",type:"button",width:"full"},t.cancel),r("calcite-button",{slot:"footer",type:"submit",width:"full"},t.add)]}_renderAddingBookmark(){var a;const{disabled:t,messages:e,headingLevel:o,_userState:i}=this;return(i==null?void 0:i.state)==="add"?r("form",{bind:this,class:h.form,disabled:t,onsubmit:this._addBookmarkSubmitClick},r("calcite-flow-item",{afterCreate:this._focusAddFlowItemNode,afterUpdate:this._focusAddFlowItemNode,bind:this,disabled:t,heading:e.addBookmark,headingLevel:o,key:"add-bookmark-form",selected:((a=this._userState)==null?void 0:a.state)==="add",onCalciteFlowItemBack:l=>{l.preventDefault(),this._endAddBookmark()}},r("div",{class:h.formContent},this._renderAddingBookmarkName()),this._renderAddingBookmarkActions())):null}_getBookmarkTitle(t){return(t==null?void 0:t.name)||this.messagesCommon.untitled}_formatDate(t){var e;return t?V(t,{...H("short-date"),timeZone:((e=this.viewModel.view)==null?void 0:e.timeZone)??q}):""}_formatTime(t){var e;return t?V(t,{...H("long-time"),timeZone:((e=this.viewModel.view)==null?void 0:e.timeZone)??q}):""}_endAddBookmark(){this.endAddBookmark(),this._focusRootFlowItem=!0}_showEditBookmarkForm(t){t&&(this._editIncludeTimeExtent=!!t.timeExtent,this._userState=new R({bookmark:t,state:"edit"}),this._focusEditFlowItem=!0,this.viewModel.goTo(t))}async _createNewScreenshotUrl(){var e;return((e=(await this.viewModel.createBookmark()).thumbnail)==null?void 0:e.url)??null}_storeCurrentUrl(){var o,i,a,l,m,u;const{_userState:t}=this,e=(i=(o=t==null?void 0:t.editedBookmark)==null?void 0:o.thumbnail)==null?void 0:i.url;e&&((l=(a=t==null?void 0:t.editedBookmark)==null?void 0:a.thumbnail)!=null&&l.isSecureUrl?t.customUrl=e:(u=(m=t==null?void 0:t.editedBookmark)==null?void 0:m.thumbnail)!=null&&u.isDataURI&&(t.screenshotUrl=e))}async _handleThumbnailTypeSelect(t){const{_userState:e}=this;if(!e)return;const{screenshotUrl:o,customUrl:i,editedBookmark:a}=e,l=t==="screenshot"?o??await this._createNewScreenshotUrl():t==="url"&&i?i:null;this._storeCurrentUrl(),a&&l&&(a.thumbnail=new A({url:l})),e.validationState=void 0,e.thumbnailState=t}_closeEditBookmarkForm(){this._userState=null,this._focusRootFlowItem=!0}_addBookmarkSubmitClick(t){t.preventDefault(),this._addBookmarkSubmit()}async _addBookmarkSubmit(){const{_addInputNode:t,_userState:e,viewModel:o,viewModel:{bookmarks:i}}=this;if(!e)return;const a=t?t.value.trim():null;if(!a)return void(e.validationState="name-required");e.loading=!0;const l=await o.createBookmark();l.name=a,i.add(l),this._endAddBookmark()}async _editBookmarkAndClose(t,e){const{viewModel:o,viewModel:{defaultEditOptions:i}}=this;await o.editBookmark(t,{...i,...e}),this._closeEditBookmarkForm()}_editBookmarkSubmit(t){t.preventDefault();const{_editInputNode:e,_userState:o,_editIncludeTimeExtent:i,_urlEditInputNode:a}=this;if(!(o!=null&&o.bookmark)||!o.editedBookmark)return;o.validationState=void 0,o.customUrl=void 0,o.screenshotUrl=void 0;const l=e==null?void 0:e.value.trim();if(!l)return void(o.validationState="name-required");o.bookmark.name=l,o.bookmark.thumbnail=o.editedBookmark.thumbnail,i||(o.bookmark.timeExtent=null);const m=o.thumbnailState;if(m==="url"&&a){const u=a.value,_=new A({url:u});if(!_.isSecureUrl)return void(o.validationState="absolute-url-required");o.bookmark.thumbnail=_}else m==="none"&&(o.bookmark.thumbnail=null);this._editBookmarkAndClose(o.bookmark,{takeScreenshot:!1,captureTimeExtent:i})}_storeEditInput(t){this._editInputNode=t}_storeAddInput(t){this._addInputNode=t}_storeUrlEditInput(t){this._urlEditInputNode=t}_deleteBookmark(t){this._closeEditBookmarkForm(),t&&(this.viewModel.bookmarks.remove(t),t.destroy())}_goToBookmark(t){this.endAddBookmark(),this.viewModel.goTo(t)}async _updateThumbnail(){const{_userState:t,viewModel:e}=this;t&&(t.validationState=void 0,await e.editBookmark(t.editedBookmark,{takeScreenshot:!0,captureViewpoint:!1,captureRotation:!1,captureScale:!1,captureTimeExtent:!1}))}_focusRootFlowItemNode(t){this._focusRootFlowItem&&(this._focusRootFlowItem=!1,S(t))}_focusEditFlowItemNode(t){this._focusEditFlowItem&&(this._focusEditFlowItem=!1,S(t))}_focusAddFlowItemNode(t){this._focusAddFlowItem&&(this._focusAddFlowItem=!1,S(t))}};s([n()],d.prototype,"_editIncludeTimeExtent",void 0),s([n({type:R})],d.prototype,"_userState",void 0),s([n()],d.prototype,"_focusRootFlowItem",void 0),s([n()],d.prototype,"_focusAddFlowItem",void 0),s([n()],d.prototype,"_focusEditFlowItem",void 0),s([n()],d.prototype,"defaultCreateOptions",null),s([n()],d.prototype,"defaultEditOptions",null),s([n()],d.prototype,"bookmarks",null),s([n()],d.prototype,"disabled",void 0),s([n()],d.prototype,"dragEnabled",void 0),s([n()],d.prototype,"filterPlaceholder",void 0),s([n()],d.prototype,"filterText",void 0),s([n()],d.prototype,"headingLevel",void 0),s([n()],d.prototype,"goToOverride",null),s([n()],d.prototype,"icon",null),s([n()],d.prototype,"label",null),s([n(),G("esri/widgets/Bookmarks/t9n/Bookmarks")],d.prototype,"messages",void 0),s([n(),G("esri/t9n/common")],d.prototype,"messagesCommon",void 0),s([n()],d.prototype,"uiStrings",void 0),s([n()],d.prototype,"view",null),s([n({type:K}),_t(["select-bookmark","bookmark-edit","bookmark-select"])],d.prototype,"viewModel",void 0),s([n({type:Q,nonNullable:!0})],d.prototype,"visibleElements",void 0),s([n()],d.prototype,"endAddBookmark",null),s([n()],d.prototype,"startAddBookmark",null),d=s([D("esri.widgets.Bookmarks")],d);const vt=d;/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.32/esri/copyright.txt for details.
v4.32.12 */const ft=it`@layer{arcgis-bookmarks{display:block}}`,wt=bt(vt),y=class y extends Y{constructor(){super(...arguments),this.widget=wt(this),this.viewModel=this.widget.viewModel,this.autoDestroyDisabled=!1,this.bookmarks=this.widget.bookmarks,this.defaultCreateOptions=this.widget.defaultCreateOptions,this.defaultEditOptions=this.widget.defaultEditOptions,this.disabled=this.widget.disabled,this.dragEnabled=this.widget.dragEnabled,this.filterPlaceholder=this.widget.filterPlaceholder,this.filterText=this.widget.filterText,this.hideFlow=this.widget.visibleElements.flow,this.hideThumbnail=this.widget.visibleElements.thumbnail,this.hideTime=this.widget.visibleElements.time,this.icon=this.widget.icon,this.label=this.widget.label,this.position="bottom-left",this.showAddBookmarkButton=this.widget.visibleElements.addBookmarkButton,this.showCloseButton=this.widget.visibleElements.closeButton,this.showCollapseButton=this.widget.visibleElements.collapseButton,this.showEditBookmarkButton=this.widget.visibleElements.editBookmarkButton,this.showFilter=this.widget.visibleElements.filter,this.showHeading=this.widget.visibleElements.heading,this.state=this.viewModel.state,this.arcgisEdit=P(()=>this.widget,"bookmark-edit"),this.arcgisPropertyChange=tt()("state"),this.arcgisReady=et(),this.arcgisSelect=P(()=>this.widget,"bookmark-select")}async destroy(){await this.manager.destroy()}};y.properties={autoDestroyDisabled:5,bookmarks:0,defaultCreateOptions:0,defaultEditOptions:0,disabled:7,dragEnabled:5,filterPlaceholder:1,filterText:1,hideFlow:5,hideThumbnail:5,hideTime:5,icon:1,label:1,position:1,referenceElement:1,showAddBookmarkButton:5,showCloseButton:5,showCollapseButton:5,showEditBookmarkButton:5,showFilter:5,showHeading:5,state:3},y.shadowRootOptions=ot,y.styles=ft;let L=y;rt("arcgis-bookmarks",L);export{L as ArcgisBookmarks};
