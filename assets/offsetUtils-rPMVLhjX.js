import{m as M,f as $}from"./builderUtils-Dksd-iQf.js";import{m as I,u as S,g as b,x as k,d as z,M as D,r as y}from"./shapeUtils-CBsrJolv.js";import{n as O}from"./customElement-Cbe8ahDx.js";import{m as C}from"./offsetOperator-DQhzjFlA.js";import{s as q}from"./jsonUtils-Cu7OBRmN.js";var N,l;function Q({templatePart:i,edits:r,relationships:u,shape:d,distance:p,isProportional:B,offsetDistance:s,vertexBeforeOffset:A,vertexPlacement:a,mode:v}){const t=A||s===0?d:w(d,s);if(t===null||!q(t))return;const c=M(t);s=A?s:0;let o=0,g=null,h=0;for(let e=0;e<t.paths.length;e++){if(r.length>O&&v==="digitizing")return;const f=t.paths[e].length,V=e===t.paths.length-1;for(let n=0;n<f;n++){if(r.length>O&&v==="digitizing")return;if(n>0&&p!==0&&(o+=t.hasZ?I(t.paths[e][n-1],t.paths[e][n],c):S(t.paths[e][n-1],t.paths[e][n])),(n!==0||a!==N.NotBeginning)&&!(n===f-1&&a===N.NotEnd&&V||(n===0||n===f-1&&V)&&a===N.Interior||n===0&&p<0&&B||n===f-1&&p>0&&B)){if(p!==0){let E=1;if(B){const Z=p<0?n-1:n+1;if(Z>=f||Z<0)continue;E=t.hasZ?I(t.paths[e][n],t.paths[e][Z],c):S(t.paths[e][n],t.paths[e][Z])}const m=o+E*p;g=t.hasZ?b(t,m,s,c):k(t,m,0)}else g=z(t,e,n),s!==0&&(g=D(g,n===f-1?[t.paths[e][n-1],t.paths[e][n]]:[t.paths[e][n],t.paths[e][n+1]],s));g&&$({templatePart:i,shape:g,edits:r,relationships:u,mode:v},`V${(h+n).toString()}`)}}h+=f}}function w(i,r){return C(i,r,{unit:"meters",joins:"miter",miterLimit:2})}function L(i){let r=0;for(const u of i.paths)r+=u.length;return r}function R({templatePart:i,edits:r,relationships:u,shape:d,distance:p,isProportional:B,offsetDistance:s,vertexBeforeOffset:A,vertexPlacement:a,mode:v}){const t=A||s===0?d:w(d,s);if(t===null||!q(t))return;const c=M(t);s=A?s:0;let o=null,g="";if(p!==0){const h=a===l.AtBeginning?0:t.paths.length-1,e=a===l.AtBeginning?0:t.paths[t.paths.length-1].length-1,f=a===l.AtBeginning?0:y(t),V=a===l.AtBeginning?t.paths[0].length:t.paths[t.paths.length-1].length;let n=1;if(B){const m=p<0?e-1:e+1;if(m>=V||m<0)return;n=t.hasZ?I(t.paths[h][e],t.paths[h][m],c):S(t.paths[h][e],t.paths[h][m])}const E=f+n*p;o=t.hasZ?b(t,E,s,c):k(t,E,s),g=a===l.AtBeginning?"V0":`V${(L(t)-1).toString()}`}else{if(o=a===l.AtBeginning?z(t,0,0):z(t,t.paths.length-1,t.paths[t.paths.length-1].length-1),s!==0)if(a===l.AtBeginning)o=D(o,[t.paths[0][0],t.paths[0][1]],s);else{const h=t.paths[t.paths.length-1];o=D(o,[h[h.length-2],h[h.length-1]],s)}g=a===l.AtBeginning?"V0":`V${(L(t)-1).toString()}`}o&&$({templatePart:i,shape:o,edits:r,relationships:u,mode:v},g)}(function(i){i[i.All=0]="All",i[i.NotBeginning=1]="NotBeginning",i[i.NotEnd=2]="NotEnd",i[i.Interior=3]="Interior"})(N||(N={})),function(i){i[i.AtBeginning=4]="AtBeginning",i[i.AtEnd=5]="AtEnd"}(l||(l={}));export{R as B,l as c,N as f,Q as m,w as u};
