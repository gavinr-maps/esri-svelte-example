import{c as E,u as c,p as g,be as h,bf as _,bg as J,bh as p,bi as y,bj as O,ax as w,bk as D,s as T,B as j,ab as P,ad as x,r as m,a as v,g as z}from"./Accessor-BHnuXKD2.js";let A=class S{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(r){const e=new S;return this._values.forEach((t,i)=>{r&&r.has(i)||e.set(i,E(t.value),t.origin)}),e}get(r,e){e=this._normalizeOrigin(e);const t=this._values.get(r);return e==null||(t==null?void 0:t.origin)===e?t==null?void 0:t.value:void 0}originOf(r){var e;return((e=this._values.get(r))==null?void 0:e.origin)??c.USER}keys(r){r=this._normalizeOrigin(r);const e=[...this._values.keys()];return r==null?e:e.filter(t=>{var i;return((i=this._values.get(t))==null?void 0:i.origin)===r})}set(r,e,t){if((t=this._normalizeOrigin(t))===c.DEFAULTS){const i=this._values.get(r);if((i==null?void 0:i.origin)!=null&&i.origin>t)return}this._values.set(r,new U(e,t))}delete(r,e){var t;(e=this._normalizeOrigin(e))!=null&&((t=this._values.get(r))==null?void 0:t.origin)!==e||this._values.delete(r)}has(r,e){var t;return(e=this._normalizeOrigin(e))!=null?((t=this._values.get(r))==null?void 0:t.origin)===e:this._values.has(r)}forEach(r){this._values.forEach(({value:e},t)=>r(e,t))}_normalizeOrigin(r){if(r!=null)return r===c.DEFAULTS?r:c.USER}};class U{constructor(r,e){this.value=r,this.origin=e}}function k(n,r,e){r.keys().forEach(i=>{e.set(i,r.get(i),c.DEFAULTS)});const t=n.metadata;Object.keys(t).forEach(i=>{n.internalGet(i)&&e.set(i,n.internalGet(i),c.DEFAULTS)})}function C(n,r,e){if(!(n!=null&&n.read)||n.read.enabled===!1||!n.read.source)return!1;const t=n.read.source;if(typeof t=="string"){if(t===r||t.includes(".")&&t.indexOf(r)===0&&p(t,e))return!0}else for(const i of t)if(i===r||i.includes(".")&&i.indexOf(r)===0&&p(i,e))return!0;return!1}function L(n){return n&&(!n.read||n.read.enabled!==!1&&!n.read.source)}function q(n,r,e,t,i){let s=h(r[e],i);L(s)&&(n[e]=!0);for(const o of Object.getOwnPropertyNames(r))s=h(r[o],i),C(s,e,t)&&(n[o]=!0)}function F(n,r,e,t){const i=e.metadata,s=J(i[r],t),o=s==null?void 0:s.default;if(o===void 0)return;const a=typeof o=="function"?o.call(n,r,t):o;a!==void 0&&e.set(r,a)}const N={origin:"service"};function M(n,r,e=N){if(!r||typeof r!="object")return;const t=g(n),i=t.metadata,s={};for(const o of Object.getOwnPropertyNames(r))q(s,i,o,r,e);t.setDefaultOrigin(e.origin);for(const o of Object.getOwnPropertyNames(s)){const a=h(i[o],e).read,u=a==null?void 0:a.source;let l;l=u&&typeof u=="string"?_(r,u):r[o],a!=null&&a.reader&&(l=a.reader.call(n,l,r,e)),l!==void 0&&t.set(o,l)}if(!e||!e.ignoreDefaults){t.setDefaultOrigin("defaults");for(const o of Object.getOwnPropertyNames(i))s[o]||F(n,o,t,e)}t.setDefaultOrigin("user")}function I(n,r,e,t=N){var s;const i={...t,messages:[]};e(i),(s=i.messages)==null||s.forEach(o=>{o.type!=="warning"||n.loaded?t!=null&&t.messages&&t.messages.push(o):n.loadWarnings.push(o)})}function R(n,r,e,t,i){var o,a;const s={};return(a=(o=r.write)==null?void 0:o.writer)==null||a.call(n,t,s,e,i),s}function $(n,r,e,t,i,s){if(!(t!=null&&t.write))return!1;const o=w(n,e);if(!i&&t.write.overridePolicy){const a=t.write.overridePolicy.call(n,o,e,s??void 0);a!==void 0&&(i=a)}if(i||(i=t.write),!i||i.enabled===!1||i.layerContainerTypes&&(s!=null&&s.layerContainerType)&&!i.layerContainerTypes.includes(s.layerContainerType))return!1;if((o===null&&!i.allowNull&&!i.writerEnsuresNonNull||o===void 0)&&i.isRequired){const a=new T("web-document-write:property-required",`Missing value for required property '${e}' on '${n.declaredClass}'`,{propertyName:e,target:n});return a&&(s!=null&&s.messages)?s.messages.push(a):a&&!s&&j.getLogger("esri.core.accessorSupport.write").error(a.name,a.message),!1}return!(o===void 0||o===null&&!i.allowNull&&!i.writerEnsuresNonNull||!i.alwaysWriteDefaults&&(!r.store.multipleOriginsSupported||r.store.originOf(e)===c.DEFAULTS)&&G(n,e,s,t,o)||!i.ignoreOrigin&&(s!=null&&s.origin)&&r.store.multipleOriginsSupported&&r.store.originOf(e)<P(s.origin))}function G(n,r,e,t,i){const s=t.default;if(s===void 0)return!1;if(t.defaultEquals!=null)return t.defaultEquals(i);if(typeof s=="function"){if(Array.isArray(i)){const o=s.call(n,r,e??void 0);return x(o,i)}return!1}return s===i}function K(n,r,e,t){const i=g(n),s=i.metadata,o=y(s[r],t);return!!o&&$(n,i,r,o,e,t)}function W(n,r,e){var s,o;if(n&&typeof n.toJSON=="function"&&(!n.toJSON.isDefaultToJSON||!n.write))return O(r,n.toJSON(e));const t=g(n),i=t.metadata;for(const a in i){const u=y(i[a],e);if(!$(n,t,a,u,void 0,e))continue;const l=w(n,a),d=R(n,u,u.write&&typeof u.write.target=="string"?u.write.target:a,l,e);Object.keys(d).length>0&&(r=O(r,d),(o=(s=e==null?void 0:e.resources)==null?void 0:s.pendingOperations)!=null&&o.length&&e.resources.pendingOperations.push(Promise.all(e.resources.pendingOperations).then(()=>O(r,d,()=>"replace-arrays"))),e!=null&&e.writtenProperties&&e.writtenProperties.push({target:n,propName:a,oldOrigin:D(t.store.originOf(a)),newOrigin:e.origin}))}return r}const b=n=>{let r=class extends n{constructor(...e){super(...e);const t=g(this),i=t.store,s=new A;t.store=s,k(t,i,s)}read(e,t){M(this,e,t)}write(e,t){return W(this,e??{},t)}toJSON(e){return this.write({},e)}static fromJSON(e,t){return B.call(this,e,t)}};return r=m([v("esri.core.JSONSupport")],r),r.prototype.toJSON.isDefaultToJSON=!0,r};function B(n,r){if(!n)return null;if(n.declaredClass)throw new Error("JSON object is already hydrated");const e=new this;return e.read(n,r),e}let f=class extends b(z){};f=m([v("esri.core.JSONSupport")],f),function(n){function r(e){return e&&typeof e=="object"&&"toJSON"in e&&typeof e.toJSON=="function"}n.JSONSupportMixin=b,n.isSerializable=r}(f||(f={}));const Q=f;export{Q as S,W as a,I as d,k as e,K as g,M as u};
