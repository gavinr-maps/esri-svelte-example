const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-BnH8ZLT5.js","./index-73bQemcW.js","./jsxFactory-CLjKarlq.js","./Accessor-BHnuXKD2.js","./intl-Do3GEEJ7.js","./Promise-CmQqe-ke.js","./cast-BA_-jlhc.js","./index-tefRSezt.js","./index-Cx51aysm.css","./JSONSupport-CGdeqxpk.js","./Evented-DCWccWGU.js","./reactiveUtils-BR0C1Kq4.js","./SimpleObservable-7oieNGD8.js","./uuid-Cl5lrJ4c.js","./dom--xxYYVQF.js","./guid-ejniuQmw.js","./observers-BdozwIHb.js","./ref-Ccn4I0kT.js","./directive-helpers-C0aXnQdc.js","./loadable-DOQnSSjG.js","./interactive-B8siLByk.js","./key-CZcQa38B.js","./component-CFGnHAqh.js","./useT9n-CJAswmP1.js","./index-DbjTV4Hc.js","./index-CjrYEQXz.js","./index-cLdK6V3t.js","./keyed-CdPY5MOf.js","./index-Ch_sYKt7.js","./index-svtat3zr.js","./index-Wn4pOF_U.js","./live-BIBBLA6F.js","./static-g4FJ4v8I.js","./form-B15gmg4q.js","./label-BLne9qNB.js","./locale-CXx8I9ox.js","./Validation-O1TFEQW-.js","./input-DI9tZAPS.js","./filter-Cs9GmjDF.js","./escapeRegExp-UP7ghjt8.js","./debounce-DbkufipY.js","./utils-CYuC4O71.js","./index-d5Yy4krW.js","./index-Df8-0rWt.js","./floating-ui-BkLjHVN3.js","./openCloseComponent-dw_x67D_.js","./dynamicClasses-pKEMtFzB.js","./index-DVEy4f7w.js","./index-DIB7yhJF.js","./resources6-Cs2_VmEC.js","./index-BfAp5_ga.js","./customElement-kBYuBfHB.js","./resources5-SciNIBSe.js","./index-DqW6JA5s.js","./FloatingArrow-D9X-HbKW.js","./Feature-B-8YZl_M.js","./Attachments-DB43Iyjz.js","./unitFormatUtils-Dbksq3U5.js","./ByteSizeUnit-BsxeN7wM.js","./Cyclical-CPiNl4ru.js","./mathUtils-DV9iOXpW.js","./quantityUtils-1LswOhxZ.js","./Point-XGrwlf63.js","./writer-B2bQV2uU.js","./Graphic-CFXUQZlS.js","./Clonable-DvJsj5LF.js","./opacityUtils-CSd4XoR2.js","./enumeration-Cr5WIZs4.js","./Color-gncXBiLc.js","./colorUtils-Rxh2V3ai.js","./ActionToggle-__-l4AdQ.js","./Identifiable-BrT7zvUW.js","./jsonUtils-Cu7OBRmN.js","./Extent-CBBGeHb-.js","./Polyline-BmuD2-ZN.js","./typeUtils-BSg8Y507.js","./TextSymbol-BQ_NW9Xo.js","./screenUtils-_ZIvrt5o.js","./collectionUtils-CbaToa73.js","./Portal-CTRRujjZ.js","./vec3f64-BLpZdpfb.js","./aaBoundingBox-CeBivBRq.js","./AttachmentInfo-mF-dnIj-.js","./AttachmentQuery-BceVlzuF.js","./featureUtils-x0Mr5AqG.js","./layerUtils-dJgsXxkC.js","./utils-DLmnG8WZ.js","./mat4f32-DcsiF_Rp.js","./mat4-Fi6iAz29.js","./common-DQOJ18NT.js","./timeZoneUtils-COos5xIr.js","./attachmentUtils-CmLhj4mw.js","./globalCss-CZa70j6i.js","./legacyIcon-CEIp6Pa9.js","./FeatureRelationshipViewModel-D-pAIuUr.js","./Heading-DYbI16WN.js","./ReactiveMap-Dwhwbx9R.js","./NetworkElement-Dpf4duUb.js","./Query-DCBIeen2.js","./Field-Cyk7Ur5d.js","./fieldType-L-VlbZqy.js","./FullTextSearch-BWm_kPUE.js","./TimeExtent-J5qnUFx_.js","./timeUtils-D2X862bk.js","./RelationshipQuery-W-4bfgaH.js","./featureFormUtils-BLdtQWdc.js","./formUtils-DXUHP5lI.js","./dateUtils-DDHuDOGz.js","./substitute-D1XJWgT5.js","./widget-AxfSz_k8.js","./uriUtils-C_sgAgIJ.js","./a11yUtils-CSYUX1kC.js","./utils-p7rkm04s.js","./ColorStop-CDpeFWOz.js","./utils-9nq77ifz.js","./jsonUtils-TjZmCq6l.js","./utils-DYurMneM.js","./cimSymbolUtils-azhJhO4Y.js","./utils-B91u8350.js","./defaultCIMValues-DII_GG3u.js","./enums-BJSSbDkD.js","./LRUCache-DS2O1kTf.js","./MemCache-CDoaVBHf.js","./HeatmapColorStop-c4wClnpW.js","./executeQueryJSON-CLYdIUdF.js","./utils-Cy8wFNQo.js","./query-BS_L6I0Q.js","./normalizeUtils-XRAPXbWa.js","./normalizeUtilsCommon-D0zPTJCj.js","./utils-CkSELPnj.js","./pbfQueryUtils-AwPAOS5M.js","./pbf-CFI-xDDp.js","./memoryEstimations-5gFNwkKK.js","./OptimizedGeometry-7IxBWtHr.js","./OptimizedFeature-DcMLlxvB.js","./OptimizedFeatureSet-Blu9Ckm7.js","./queryZScale-DwN6mTru.js","./projection-B2I9Bzj_.js","./projectBuffer-DOU0xvVi.js","./geodesicConstants-yASAK_zX.js","./FeatureSet-DpCN730g.js","./themeUtils-C3zvZbsE.js","./throttle-jjSnxk80.js","./shared-M7rSkUll.js","./TimeOnly-yGYcAQQJ.js","./FeatureLayer-9fyQxXYm.js","./MultiOriginJSONSupport-nGLpCFeg.js","./layerContainerType-C5CzMsLd.js","./FeatureLayerBase-DsahGowz.js","./HeightModelInfo-B3GZyQFz.js","./commonProperties-C0eC30J9.js","./ElevationInfo-Di4W6v5U.js","./unitConversionUtils-C4AR5obr.js","./lengthUtils-DjJgJFRg.js","./AttributeTableTemplate-B7rH2qLr.js","./featureLayerUtils-BzWCGee1.js","./featureQueryAll-xezK3WCp.js","./SimpleRenderer-gSw1WaJS.js","./commonProperties-bGHL1a5M.js","./colorRamps-Dkx8zIVn.js","./SizeVariable-IzD1bP2e.js","./visualVariableUtils-Bp9QCb8E.js","./jsonUtils-Dzgxk9pw.js","./defaults-Dwxdhopq.js","./defaultsJSON-GKolV7NZ.js","./UniqueValueRenderer-Cri3tgP5.js","./diffUtils-CMkuJvD2.js","./RendererLegendOptions-mgfHoilI.js","./styleUtils-BB-zx7mT.js","./NormalizationBinParametersMixin-D6iHLB7I.js","./LayerFloorInfo-BXAHB-yQ.js","./Relationship-BBBusoKs.js","./serviceCapabilitiesUtils-BuKg0yWx.js","./infoFor3D-CsJzgCF0.js","./Layer-C9uQlTBT.js","./workers-D8Q3pEzK.js","./Queue-BOnccek2.js","./editsZScale-BKYnJc2O.js","./APIKeyMixin-Btq102Nx.js","./ArcGISService-BHkTabnw.js","./ScaleRangeLayer-C59zG_yk.js","./CustomParametersMixin-uo3x70vd.js","./DisplayFilteredLayer-BFGyM6i5.js","./scaleUtils-CfLu-sg1.js","./displayFilterUtils-DV_nOx_h.js","./EditBusLayer-Cx9SJosU.js","./FeatureEffectLayer-D3Dl2pXD.js","./FeatureEffect-xxsfLT-y.js","./FeatureFilter-DEE1jTWq.js","./FeatureReductionLayer-x8j38_gH.js","./FeatureReductionSelection-BpUGF9oj.js","./labelingInfo-BvMdv93l.js","./labelUtils-Dq8OkaT-.js","./jsonUtils-DD1NMzWj.js","./typeUtils-CfF4cYo5.js","./ClassBreaksRenderer-BBSNkSFx.js","./Version-9k2AOv05.js","./FieldsIndex-DFdVonga.js","./heatmapUtils-DA7NmY3d.js","./vec42-YcqnINSP.js","./vec4f64-o2zAXfmz.js","./MD5-C9MwAd2G.js","./OperationalLayer-Bts9W3HA.js","./OrderedLayer-BP2hvfL_.js","./OrderByInfo-E-O9nvtm.js","./PortalLayer-jhi5QQgB.js","./PortalItem-CXk7DqVv.js","./portalItemUtils-rm7sAgcm.js","./RefreshableLayer-Cn2UpWQD.js","./TemporalLayer-CYEvmdjr.js","./TimeInfo-LjqhhubF.js","./TimeInterval-BDTTJ9Uw.js","./TrackableLayer-D6paP6wl.js","./FeatureTemplate-DqbLvkbZ.js","./FeatureType-DjGGrg1i.js","./fieldProperties-B9JP3-ue.js","./TitleCreator-Zm6TQ_ec.js","./versionUtils-DSsYFI36.js","./styleUtils-BQ_uVsZf.js","./popupUtils-pQ0CVidQ.js","./interfaces-CL2NbQte.js"])))=>i.map(i=>d[i]);
import{_ as m}from"./index-tefRSezt.js";import{r as a,m as d,a as A,av as f}from"./Accessor-BHnuXKD2.js";import"./intl-Do3GEEJ7.js";import{c as y}from"./popupUtils-pQ0CVidQ.js";import{_ as g,i as h}from"./FeatureRelationshipViewModel-D-pAIuUr.js";import{c as F,n as r,i as E}from"./jsxFactory-CLjKarlq.js";import{e as V}from"./globalCss-CZa70j6i.js";import{h as T,n as v,a as L,b}from"./isConnectivityMidspan-DZikspN3.js";import{s as $}from"./substitute-D1XJWgT5.js";import"./Promise-CmQqe-ke.js";import"./cast-BA_-jlhc.js";import"./JSONSupport-CGdeqxpk.js";import"./Graphic-CFXUQZlS.js";import"./Clonable-DvJsj5LF.js";import"./reactiveUtils-BR0C1Kq4.js";import"./Evented-DCWccWGU.js";import"./SimpleObservable-7oieNGD8.js";import"./writer-B2bQV2uU.js";import"./opacityUtils-CSd4XoR2.js";import"./Point-XGrwlf63.js";import"./enumeration-Cr5WIZs4.js";import"./Color-gncXBiLc.js";import"./colorUtils-Rxh2V3ai.js";import"./mathUtils-DV9iOXpW.js";import"./ActionToggle-__-l4AdQ.js";import"./Identifiable-BrT7zvUW.js";import"./jsonUtils-Cu7OBRmN.js";import"./Extent-CBBGeHb-.js";import"./Polyline-BmuD2-ZN.js";import"./typeUtils-BSg8Y507.js";import"./TextSymbol-BQ_NW9Xo.js";import"./screenUtils-_ZIvrt5o.js";import"./collectionUtils-CbaToa73.js";import"./Portal-CTRRujjZ.js";import"./vec3f64-BLpZdpfb.js";import"./aaBoundingBox-CeBivBRq.js";import"./Heading-DYbI16WN.js";import"./ReactiveMap-Dwhwbx9R.js";import"./layerUtils-dJgsXxkC.js";import"./NetworkElement-Dpf4duUb.js";import"./Query-DCBIeen2.js";import"./Field-Cyk7Ur5d.js";import"./fieldType-L-VlbZqy.js";import"./FullTextSearch-BWm_kPUE.js";import"./TimeExtent-J5qnUFx_.js";import"./timeUtils-D2X862bk.js";import"./featureUtils-x0Mr5AqG.js";import"./utils-DLmnG8WZ.js";import"./mat4f32-DcsiF_Rp.js";import"./mat4-Fi6iAz29.js";import"./common-DQOJ18NT.js";import"./timeZoneUtils-COos5xIr.js";import"./RelationshipQuery-W-4bfgaH.js";import"./featureFormUtils-BLdtQWdc.js";import"./formUtils-DXUHP5lI.js";import"./dateUtils-DDHuDOGz.js";import"./uuid-Cl5lrJ4c.js";var w;const M="esri-feature-utility-network-associations",I={base:M,listItemHidden:`${M}__list-item--hidden`},C="nested";let l=w=class extends T{constructor(e,t){super(e,t),this.description=null,this.flowItems=null,this.flowType="feature-utility-network-association-type",this.listType=null,this.parentFeatureViewModel=null,this.title=null,this.viewModel=new g,this.visibleElements=new h}initialize(){this.setUpObserver()}loadDependencies(){return F({chip:()=>m(()=>import("./index-BnH8ZLT5.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]),import.meta.url),icon:()=>m(()=>import("./index-73bQemcW.js").then(e=>e.i),__vite__mapDeps([1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]),import.meta.url),list:()=>m(()=>import("./index-DbjTV4Hc.js"),__vite__mapDeps([24,25,2,3,4,5,6,7,8,9,10,11,12,13,15,23,26,17,18,16,14,27,1,28,29,30,31,32,33,20,21,34,19,35,22,36,37,38,39,40,41]),import.meta.url),"list-item":()=>m(()=>import("./index-d5Yy4krW.js"),__vite__mapDeps([42,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,43,17,18,44,40,20,21,19,45,46,25,23,47,27,22,48,49,50,51,41,52]),import.meta.url),tooltip:()=>m(()=>import("./index-DqW6JA5s.js"),__vite__mapDeps([53,2,3,4,5,6,7,8,9,10,11,12,13,17,18,44,14,15,40,45,54,27]),import.meta.url)})}destroy(){this.tooltipReferenceMap.clear()}render(){var s;const e=this.viewModel.associationViewModels,{state:t,showAllEnabled:o}=this.viewModel,{state:i}=this.parentFeatureViewModel??{};return r("div",{class:this.classes(I.base,V.widget)},t==="loading"||t==="querying"||i==="loading"?this.renderLoading():r("calcite-list",{displayMode:C,label:((s=this.selectedLayer)==null?void 0:s.title)??this.messagesCommon.untitled},o&&this.selectedLayer?r(E,null,this.renderFilter(),this.renderFeatureCountWarning(),this._renderAssociatedFeatureListPage(),this.renderFeatureObserver()):Array.from(e.keys(),n=>this._renderTypeList(n,e.get(n)))))}_showAllAssociations(e){const{flowItems:t,viewModel:o,description:i}=this;if(!t||!e)return;o.showAllEnabled=!0;const s=new w({selectedLayer:e,title:e==null?void 0:e.title,flowItems:t,parentFeatureViewModel:this.parentFeatureViewModel,featureVisibleElements:this.featureVisibleElements,description:i,visibleElements:new h({title:!1,description:!1}),viewModel:o});t.push(s)}_renderAssociatedFeatureListPage(){const e=this.viewModel.associationViewModels.get(this.selectedLayer).filter(t=>y(t.featureViewModel).toLowerCase().includes(this.filterText)).slice(0,this.endIndex);return[...this._renderTooltips(e),...this._renderAssociatedFeatureList(e)]}_renderItemTooltip(e){const{tooltipReferenceMap:t}=this;return v(e.association)?r("calcite-tooltip",{key:`tooltip-${e.featureViewModel.uid}`,overlayPositioning:"fixed",referenceElement:t.get(e.featureViewModel.uid)},this.getConnectivityTooltip(e.association.associationType)):null}_renderAssociatedFeature(e){const{featureViewModel:t}=e,o=y(t),i=t.state==="loading",s=this._findFlowItem(t),n=s<0&&this._isParentFeature(t),p=n||s>=0;return r("calcite-list-item",{class:i?I.listItemHidden:void 0,description:f(e.terminalName??""),key:`associated-feature-type-${t.uid}`,label:f(o),onCalciteListItemSelect:()=>this._handleFeatureClick(n,s,t)},v(e.association)?this.renderConnectivityIcon(e.association.associationType,e.featureViewModel.uid):null,L(e.association)?r("calcite-chip",{label:b(e.association),scale:"s",slot:"content-end"},b(e.association)):null,this._renderChevronIconNode(p))}async _selectAssociation(e){const{flowItems:t,featureVisibleElements:o}=this;if(!t)return;e.abilities={utilityNetworkAssociationsContent:!0};const{default:i}=await m(()=>import("./Feature-B-8YZl_M.js").then(s=>s.F),__vite__mapDeps([55,7,8,3,4,5,6,9,11,10,12,2,13,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220]),import.meta.url);t.push(new i({flowItems:t,flowType:"feature-association",viewModel:e,visibleElements:o}))}_handleFeatureClick(e,t,o){if(e)this.flowItems.drain(i=>{"showAllEnabled"in i.viewModel&&(i.viewModel.showAllEnabled=!1),i.viewModel=null,i.destroy()});else if(t<0||!this.flowItems)this._selectAssociation(o);else for(;this.flowItems.length>t+1;){const i=this.flowItems.pop();i&&("showAllEnabled"in i.viewModel&&(i.viewModel.showAllEnabled=!1),i.viewModel=null,i.destroy())}}_featureViewModelMatch(e,t){const o=e.graphic,i=o==null?void 0:o.layer;let s=null;(i==null?void 0:i.type)==="subtype-sublayer"&&i.parent?s=i.parent.globalIdField??null:i&&"globalIdField"in i&&(s=i.globalIdField);const n=s?o==null?void 0:o.attributes[s]:null,p=t.graphic,c=p==null?void 0:p.layer;let u=null;(c==null?void 0:c.type)==="subtype-sublayer"&&c.parent?u=c.parent.globalIdField??null:c&&"globalIdField"in c&&(u=c.globalIdField);const _=u?p==null?void 0:p.attributes[u]:null;return n&&_&&n===_}_isParentFeature(e){var i;const t=(i=this.flowItems)==null?void 0:i.getItemAt(0);if(!t)return!1;const o=t.parentFeatureViewModel;return this._featureViewModelMatch(o,e)}_findFlowItem(e){var t;return((t=this.flowItems)==null?void 0:t.findIndex(o=>{if(o.flowType!=="feature-association")return!1;const i=o.viewModel;return this._featureViewModelMatch(i,e)}))??-1}_renderTooltips(e){return e.toArray().map(t=>this._renderItemTooltip(t))}_renderAssociatedFeatureList(e){return e.toArray().map(t=>this._renderAssociatedFeature(t))}_renderChevronIconNode(e){return r("calcite-icon",{flipRtl:!0,icon:e?"move-up":"chevron-right",scale:"s",slot:"content-end"})}_renderTypeList(e,t){const{messagesFeature:o}=this,{displayCount:i}=this.viewModel,s=t.slice(0,i),n=s.length<t.length;return r("calcite-list-item",{key:"show-all",label:e.title,open:!0,value:e.id},r("calcite-chip",{label:String(t.length),scale:"s",slot:"content-end"},t.length),r("calcite-list",{group:e.id,label:e.title??""},[this._renderTooltips(s),this._renderAssociatedFeatureList(s)],n?r("calcite-list-item",{description:$(o==null?void 0:o.numberRecords,{number:t.length.toString()}),key:"show-all-item",label:o.showAll,onCalciteListItemSelect:()=>this._showAllAssociations(e)},r("calcite-icon",{icon:"list",scale:"s",slot:"content-end"})):null))}};a([d()],l.prototype,"description",void 0),a([d()],l.prototype,"featureVisibleElements",void 0),a([d()],l.prototype,"flowItems",void 0),a([d()],l.prototype,"flowType",void 0),a([d()],l.prototype,"listType",void 0),a([d()],l.prototype,"parentFeatureViewModel",void 0),a([d()],l.prototype,"title",void 0),a([d({type:g})],l.prototype,"viewModel",void 0),a([d({type:h,nonNullable:!0})],l.prototype,"visibleElements",void 0),l=w=a([A("esri.widgets.Feature.FeatureUtilityNetworkAssociationList")],l);const Oe=l;export{Oe as default};
