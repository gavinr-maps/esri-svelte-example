const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-B7QXL93z.js","./jsxFactory-CLjKarlq.js","./Accessor-BHnuXKD2.js","./intl-Do3GEEJ7.js","./Promise-CmQqe-ke.js","./cast-BA_-jlhc.js","./index-tefRSezt.js","./index-Cx51aysm.css","./JSONSupport-CGdeqxpk.js","./Evented-DCWccWGU.js","./reactiveUtils-BR0C1Kq4.js","./SimpleObservable-7oieNGD8.js","./uuid-Cl5lrJ4c.js","./ref-Ccn4I0kT.js","./directive-helpers-C0aXnQdc.js","./dom--xxYYVQF.js","./guid-ejniuQmw.js","./form-B15gmg4q.js","./interactive-B8siLByk.js","./key-CZcQa38B.js","./label-BLne9qNB.js","./loadable-DOQnSSjG.js","./index-D130RxMY.js","./index-BB34I4Ur.js","./index-CZNvXa5f.js","./index-73bQemcW.js","./observers-BdozwIHb.js","./keyed-CdPY5MOf.js","./component-CFGnHAqh.js","./index-DrimfvRg.js","./index-CjrYEQXz.js","./useT9n-CJAswmP1.js","./index-BtF7Kdcs.js","./static-g4FJ4v8I.js","./index-DVEy4f7w.js"])))=>i.map(i=>d[i]);
import{_ as x,i as Ie,L as Ae,u as He,c as We,n as Te,a as ze}from"./index-tefRSezt.js";import{r as l,m as r,a as m,g as Y,D as ye,E as oe,aL as Ue,B as Ke,at as A}from"./Accessor-BHnuXKD2.js";import{a as qe}from"./cast-BA_-jlhc.js";import{O as D,c as O,n as a,y as je,g as Je,e as de,v as U}from"./jsxFactory-CLjKarlq.js";import{V as k,d as w,P as L,w as Z}from"./reactiveUtils-BR0C1Kq4.js";import{n as ne}from"./collectionUtils-CbaToa73.js";import{c as fe,i as Ge,p as Xe,$ as Ye,f as Ze}from"./BuildingSceneLayer-BZxJNhHm.js";import{n as Qe}from"./uuid-Cl5lrJ4c.js";import{r as pe}from"./mathUtils-DV9iOXpW.js";import{e as T}from"./globalCss-CZa70j6i.js";import{e as Q}from"./Heading-DYbI16WN.js";import{P as et}from"./useWidget-Dlf3SkC7.js";import"./JSONSupport-CGdeqxpk.js";import"./intl-Do3GEEJ7.js";import"./Promise-CmQqe-ke.js";import"./Evented-DCWccWGU.js";import"./SimpleObservable-7oieNGD8.js";import"./CollectionFlattener-B9CFCLSp.js";import"./loadAll-Do8S8AWH.js";import"./Portal-CTRRujjZ.js";import"./writer-B2bQV2uU.js";import"./Extent-CBBGeHb-.js";import"./Point-XGrwlf63.js";import"./MultiOriginJSONSupport-nGLpCFeg.js";import"./Layer-C9uQlTBT.js";import"./Identifiable-BrT7zvUW.js";import"./TimeExtent-J5qnUFx_.js";import"./timeUtils-D2X862bk.js";import"./BuildingComponentSublayer-ChbJSc37.js";import"./Graphic-CFXUQZlS.js";import"./Clonable-DvJsj5LF.js";import"./opacityUtils-CSd4XoR2.js";import"./enumeration-Cr5WIZs4.js";import"./Color-gncXBiLc.js";import"./colorUtils-Rxh2V3ai.js";import"./ActionToggle-__-l4AdQ.js";import"./jsonUtils-Cu7OBRmN.js";import"./Polyline-BmuD2-ZN.js";import"./typeUtils-BSg8Y507.js";import"./TextSymbol-BQ_NW9Xo.js";import"./screenUtils-_ZIvrt5o.js";import"./vec3f64-BLpZdpfb.js";import"./aaBoundingBox-CeBivBRq.js";import"./FeatureLayer-9fyQxXYm.js";import"./layerContainerType-C5CzMsLd.js";import"./FeatureLayerBase-DsahGowz.js";import"./formUtils-DXUHP5lI.js";import"./Field-Cyk7Ur5d.js";import"./fieldType-L-VlbZqy.js";import"./HeightModelInfo-B3GZyQFz.js";import"./commonProperties-C0eC30J9.js";import"./ElevationInfo-Di4W6v5U.js";import"./unitConversionUtils-C4AR5obr.js";import"./lengthUtils-DjJgJFRg.js";import"./AttributeTableTemplate-B7rH2qLr.js";import"./timeZoneUtils-COos5xIr.js";import"./featureLayerUtils-BzWCGee1.js";import"./featureQueryAll-xezK3WCp.js";import"./Query-DCBIeen2.js";import"./FullTextSearch-BWm_kPUE.js";import"./layerUtils-dJgsXxkC.js";import"./SimpleRenderer-gSw1WaJS.js";import"./commonProperties-bGHL1a5M.js";import"./colorRamps-Dkx8zIVn.js";import"./SizeVariable-IzD1bP2e.js";import"./visualVariableUtils-Bp9QCb8E.js";import"./ColorStop-CDpeFWOz.js";import"./jsonUtils-Dzgxk9pw.js";import"./defaults-Dwxdhopq.js";import"./defaultsJSON-GKolV7NZ.js";import"./UniqueValueRenderer-Cri3tgP5.js";import"./diffUtils-CMkuJvD2.js";import"./RendererLegendOptions-mgfHoilI.js";import"./styleUtils-BB-zx7mT.js";import"./AttachmentQuery-BceVlzuF.js";import"./NormalizationBinParametersMixin-D6iHLB7I.js";import"./RelationshipQuery-W-4bfgaH.js";import"./LayerFloorInfo-BXAHB-yQ.js";import"./Relationship-BBBusoKs.js";import"./serviceCapabilitiesUtils-BuKg0yWx.js";import"./infoFor3D-CsJzgCF0.js";import"./workers-D8Q3pEzK.js";import"./Queue-BOnccek2.js";import"./editsZScale-BKYnJc2O.js";import"./queryZScale-DwN6mTru.js";import"./projection-B2I9Bzj_.js";import"./projectBuffer-DOU0xvVi.js";import"./geodesicConstants-yASAK_zX.js";import"./FeatureSet-DpCN730g.js";import"./APIKeyMixin-Btq102Nx.js";import"./ArcGISService-BHkTabnw.js";import"./ScaleRangeLayer-C59zG_yk.js";import"./jsonUtils-TjZmCq6l.js";import"./utils-DYurMneM.js";import"./mat4f32-DcsiF_Rp.js";import"./mat4-Fi6iAz29.js";import"./common-DQOJ18NT.js";import"./CustomParametersMixin-uo3x70vd.js";import"./DisplayFilteredLayer-BFGyM6i5.js";import"./scaleUtils-CfLu-sg1.js";import"./displayFilterUtils-DV_nOx_h.js";import"./EditBusLayer-Cx9SJosU.js";import"./FeatureEffectLayer-D3Dl2pXD.js";import"./FeatureEffect-xxsfLT-y.js";import"./FeatureFilter-DEE1jTWq.js";import"./FeatureReductionLayer-x8j38_gH.js";import"./FeatureReductionSelection-BpUGF9oj.js";import"./labelingInfo-BvMdv93l.js";import"./labelUtils-Dq8OkaT-.js";import"./jsonUtils-DD1NMzWj.js";import"./typeUtils-CfF4cYo5.js";import"./ClassBreaksRenderer-BBSNkSFx.js";import"./LRUCache-DS2O1kTf.js";import"./MemCache-CDoaVBHf.js";import"./Version-9k2AOv05.js";import"./FieldsIndex-DFdVonga.js";import"./utils-B91u8350.js";import"./defaultCIMValues-DII_GG3u.js";import"./enums-BJSSbDkD.js";import"./HeatmapColorStop-c4wClnpW.js";import"./heatmapUtils-DA7NmY3d.js";import"./vec42-YcqnINSP.js";import"./vec4f64-o2zAXfmz.js";import"./MD5-C9MwAd2G.js";import"./OperationalLayer-Bts9W3HA.js";import"./OrderedLayer-BP2hvfL_.js";import"./OrderByInfo-E-O9nvtm.js";import"./PortalLayer-jhi5QQgB.js";import"./PortalItem-CXk7DqVv.js";import"./portalItemUtils-rm7sAgcm.js";import"./RefreshableLayer-Cn2UpWQD.js";import"./TemporalLayer-CYEvmdjr.js";import"./TimeInfo-LjqhhubF.js";import"./TimeInterval-BDTTJ9Uw.js";import"./TrackableLayer-D6paP6wl.js";import"./FeatureTemplate-DqbLvkbZ.js";import"./FeatureType-DjGGrg1i.js";import"./fieldProperties-B9JP3-ue.js";import"./TitleCreator-Zm6TQ_ec.js";import"./versionUtils-DSsYFI36.js";import"./styleUtils-BQ_uVsZf.js";import"./popupUtils-pQ0CVidQ.js";import"./interfaces-CL2NbQte.js";import"./capabilities-De4i-OzG.js";import"./I3SIndexInfo-DP6w_-xh.js";import"./I3SLayerDefinitions-qdtC2E3S.js";import"./I3SUtil-nzJI4wHN.js";import"./mat4f64-Dk4dwAN8.js";import"./vec32-Dvg_eL9J.js";import"./projectVectorToVector-dS8io47t.js";import"./projectPointToVector-BS0u8fq6.js";import"./sphere-DQxj5tsv.js";import"./mat3-CR8GKnhD.js";import"./mat3f64-BBpwCtoL.js";import"./plane-4dpuo6-e.js";import"./quatf64-CCm9z-pX.js";import"./vec2f64-Dy6m9Nrb.js";import"./mathUtils-B9R7G-2c.js";import"./I3SBinaryReader-BTB-H69N.js";import"./VertexAttribute-Cq4MnHjR.js";import"./computeTranslationToOriginAndRotation-BT43Xu5d.js";import"./edgeUtils-52Urp6s4.js";import"./floatRGBA-CR2j2c7-.js";import"./NormalAttribute.glsl-BPQl43kJ.js";import"./glsl-BH37Aalp.js";import"./Matrix3PassUniform-Bhi2fM3C.js";import"./BindType-BBwFZqyN.js";import"./RgbaFloatEncoding.glsl-_io2eW3M.js";import"./Float4DrawUniform-C_Hqa-pI.js";import"./Matrix3DrawUniform-B_gSHO7v.js";import"./orientedBoundingBox-9z4w3ZAL.js";import"./quat-4pa1e6ds.js";import"./spatialReferenceEllipsoidUtils-DM073JUd.js";import"./ViewingMode-Dodu7ZZk.js";import"./Attribute-B-NAci_J.js";import"./layerViewUtils-tkZ5z_iY.js";import"./popupUtils-Bp0XPfzq.js";import"./BuildingGroupSublayer-4u3UEvj0.js";import"./SceneService-BGGirg43.js";import"./originUtils-D69mHv66.js";import"./multiOriginJSONSupportUtils-C0wm8_Yw.js";import"./jsonContext-CdRtpU_S.js";import"./resourceUtils-sguC8912.js";import"./resourceUtils-t6ydfQSV.js";import"./saveUtils-DLMLWtvP.js";import"./associatedFeatureServiceUtils-Bfw5GA1N.js";import"./elevationInfoUtils-RSZ4Logn.js";import"./index-BkKcLxWB.js";import"./component-utils-DWY0IMHC.js";const tt="overview",be=t=>e=>{const i=t.toLowerCase();return e.sublayers.find(s=>{var o;return((o=s.modelName)==null?void 0:o.toLowerCase())===i})??null},we=be("fullmodel"),it=be(tt);function st(t){const e=we(t);e!=null&&(e.visible=!0);const i=it(t);i!=null&&(i.visible=!1)}function se(t,e){const i=rt(t,e);if(i==null)return null;const s=i.fieldName;if(s==null||!s)return null;const o=lt(t,s),n=new Map;for(const h of i.mostFrequentValues??[])typeof h=="number"&&n.set(h,o!=null?o.getName(h):String(h));return{fieldName:s,fieldValueMap:n}}function lt(t,e){var i;for(const s of t.allSublayers.items){const o=s.type==="building-component"?(i=s.getFieldDomain)==null?void 0:i.call(s,e):null;if(o&&o.type==="coded-value")return o}return null}function rt(t,e){var o;const i=((o=t.summaryStatistics)==null?void 0:o.fields)??[],s=e.toLowerCase();return i.find(n=>{var h;return((h=n.modelName)==null?void 0:h.toLowerCase())===s})??null}let v=class extends Y{constructor(e){super(e),this.id="root",this.parent=null,this.children=new k,this.layers=new k,this.level=0,this._childIds=new Set,this._layerUniqueIds=new Set}initialize(){this.addHandles([this.layers.on("before-add",e=>{this._layerUniqueIds.has(e.item.uid)?e.preventDefault():this._layerUniqueIds.add(e.item.uid)}),this.layers.on("after-add",({item:e})=>{this.addHandles([w(()=>e.visible,()=>this.notifyChange("visible"),L),w(()=>e.title,()=>this.notifyChange("title"),L)],e.uid)}),this.layers.on("before-remove",({item:e})=>{this.removeHandles(e.uid),this.notifyChange("title"),this.notifyChange("visible")}),this.children.on("before-add",e=>{this._childIds.has(e.item.id)?e.preventDefault():(e.item._set("parent",this),this._childIds.add(e.item.id))})])}destroy(){this.children.forEach(e=>e.destroy())}get hasChildren(){return this.children.length>0}get isDiscipline(){return this.level===1}get visible(){return ue(this.layers,e=>e.visible)}get title(){return ue(this.layers,e=>e.title)||this.layers.items.map(e=>e.title).join(", ")||null}toggleVisibility(e){const i=e===void 0?!this.visible:e;this.layers.forEach(s=>{s.visible=i}),i&&this.parent!=null&&this.parent.toggleVisibility(!0)}toggleAllSiblingsVisibility(e){const i=e===void 0?!this.visible:e;this.toggleVisibility(i),this.parent!=null&&(this.parent.toggleVisibility(i),this.parent.children.forEach(s=>s.toggleVisibility(i)))}};function ue(t,e){let i=null;for(const s of t.items){const o=e(s);if(i!=null&&i!==o)return null;i=o}return i}l([r({nonNullable:!0})],v.prototype,"id",void 0),l([r()],v.prototype,"parent",void 0),l([r({nonNullable:!0,readOnly:!0})],v.prototype,"children",void 0),l([r({nonNullable:!0,readOnly:!0})],v.prototype,"layers",void 0),l([r({nonNullable:!0})],v.prototype,"level",void 0),l([r({readOnly:!0})],v.prototype,"hasChildren",null),l([r({readOnly:!0})],v.prototype,"isDiscipline",null),l([r({readOnly:!0})],v.prototype,"visible",null),l([r({readOnly:!0})],v.prototype,"title",null),v=l([m("esri.widgets.BuildingExplorer.support.LayerTreeNode")],v);function ae(){let t=new AbortController;return async e=>{t.abort(),t=new AbortController;const i={signal:t.signal},s=e.toArray().map(o=>ot(o,i));await Promise.all(s),ye(i)}}async function ot(t,e){await t.load(e),await t.loadAll(),ye(e),t.summaryStatistics&&await t.summaryStatistics.load(e)}let F=class extends Y{constructor(e){super(e),this.root=new v,this.state="disabled",this._loadLayers=ae(),this.layers=new k}initialize(){this.addHandles(this.layers.on("change",()=>this._onLayersChange())),this._onLayersChange()}destroy(){this._set("state","disabled"),this.root.destroy()}set layers(e){const i=this._get("layers");this._set("layers",ne(e,i))}_updateLayerTree(){this.root.destroy(),this._set("root",new v);const e=new Map,i=this.layers.length>1?"modelName":"id";return this.layers.forEach(s=>{const o=we(s);this._addNodesForSublayers(o??s,this.root,e,i)}),this}_addNodeForLayer(e,i,s,o){const n=String(e[o]).toLowerCase();if(n==null||e.isEmpty)return;const h=`${i.id}/${n}`;let p=s.get(h);p||(p=new v({id:n,level:i.level+1}),s.set(h,p)),p.layers.push(e),i.children.push(p),this._addNodesForSublayers(e,p,s,o)}_addNodesForSublayers(e,i,s,o){(e.type==="building-scene"||e.type==="building-group"&&!e.isEmpty)&&e.sublayers.forEach(n=>this._addNodeForLayer(n,i,s,o))}async _onLayersChange(){if(this._set("state","loading"),this.layers.length!==0)try{await this._loadLayers(this.layers),this._updateLayerTree(),this._set("state","ready")}catch(e){oe(e)||this._set("state","failed")}}};l([r({readOnly:!0})],F.prototype,"root",void 0),l([r({type:k,nonNullable:!0})],F.prototype,"layers",null),l([r({readOnly:!0,nonNullable:!0})],F.prototype,"state",void 0),F=l([m("esri.widgets.BuildingExplorer.BuildingDisciplinesViewModel")],F);const $e=F;function X(t){const e={fieldValueMap:new Map,allowedValues:[]};for(const i of t){const s=i.fieldValueMap,o=e.fieldValueMap;s.forEach((n,h)=>{o.has(h)||(o.set(h,n),e.allowedValues.push(h))})}return e.allowedValues.sort((i,s)=>i-s),e}function nt(t){let e=null;for(const i of t)e=e!=null?Math.min(e,i):i;return e}function at(t){let e=null;for(const i of t)e=e!=null?Math.max(e,i):i;return e}function ee(t,e){return e.allowedValues.length>0?ht(t,e.allowedValues):null}function ht(t,e){if(e.length===0)return t;if(t===1/0)return e[e.length-1];if(t===-1/0)return e[0];let i=e[0],s=Math.abs(i-t);for(const o of e){const n=Math.abs(o-t);n<s&&(i=o,s=n)}return i}let u=class extends Y{constructor(e){super(e),this.state="disabled",this._valueBeforeReady=null,this._domainInfo=X([]),this._loadLayers=ae(),this.layers=new k}initialize(){this.addHandles(this.layers.on("change",()=>this._onLayersChange())),this._onLayersChange()}destroy(){this._set("state","disabled")}get enabled(){return this.allowedValues.length>0&&this._get("enabled")}set enabled(e){e!==this.enabled&&this.allowedValues.length>0&&this._set("enabled",e)}get value(){return(this.state==="ready"?this._get("value"):this._valueBeforeReady)??0}set value(e){if(this.state!=="ready")return void(this._valueBeforeReady=e);if(e===this.value)return;const i=ee(e,this);i!=null&&this._set("value",i)}get min(){return nt(this.allowedValues)}get max(){return at(this.allowedValues)}get allowedValues(){return this._domainInfo.allowedValues}set allowedValues(e){e==null?this._clearOverride("allowedValues"):this._override("allowedValues",e);const i=ee(this.value,this);i!=null&&(this.value=i)}get hasNext(){if(!this.enabled)return!0;const e=this._valueIndex;return e>=0&&e<this.allowedValues.length-1}get hasPrevious(){return!this.enabled||this._valueIndex>0}set layers(e){const i=this._get("layers");this._set("layers",ne(e,i))}get filterExpressions(){return{solid:null,xRay:null}}get _valueIndex(){return Ue(this.allowedValues,this.value)}select(e){if(this.state!=="ready")return void(this._valueBeforeReady=e);ee(e,this)!=null&&(this.enabled=!0,this.value=e)}clear(){this.state==="ready"?this.enabled=!1:this._valueBeforeReady=null}next(){const{state:e,allowedValues:i,enabled:s,hasNext:o,_valueIndex:n}=this;if(e==="ready"||this._valueBeforeReady==null){if(i.length!==0)return s?void(o&&(this.value=i[n+1])):(this.enabled=!0,void(this.value=i[0]))}else this._valueBeforeReady++}previous(){const{state:e,allowedValues:i,enabled:s,hasPrevious:o,_valueIndex:n}=this;if(e==="ready"||this._valueBeforeReady==null){if(i.length!==0)return s?void(o&&(this.value=i[n-1])):(this.enabled=!0,void(this.value=i[i.length-1]))}else this._valueBeforeReady++}getValueLabel(e){return this.layers.length===0?null:this._domainInfo.fieldValueMap.get(e)??null}async _onLayersChange(){if(this._set("state","loading"),this._domainInfo=X([]),this.layers.length!==0)try{await this._loadLayers(this.layers),this._setup()}catch(e){oe(e)||this._set("state","failed")}}};l([r({value:!1,nonNullable:!0})],u.prototype,"enabled",null),l([r({nonNullable:!0})],u.prototype,"value",null),l([r({readOnly:!0})],u.prototype,"min",null),l([r({readOnly:!0})],u.prototype,"max",null),l([r()],u.prototype,"allowedValues",null),l([r({readOnly:!0})],u.prototype,"hasNext",null),l([r({readOnly:!0})],u.prototype,"hasPrevious",null),l([r({type:k,nonNullable:!0})],u.prototype,"layers",null),l([r({nonNullable:!0})],u.prototype,"state",void 0),l([r()],u.prototype,"_valueBeforeReady",void 0),l([r({readOnly:!0})],u.prototype,"_valueIndex",null),l([r()],u.prototype,"_domainInfo",void 0),u=l([m("esri.widgets.BuildingExplorer.BuildingNumericFilterViewModel")],u);const Le=u,xe="__BUILDING_EXPLORER_FILTER__";function dt(){return`${Qe()}${xe}`}function le(t){const e=typeof t=="string"?t:t.id;return!!e&&e.includes(xe)}function Ce(t,e){for(const i of t.items)for(const s of i.filters.items){if(!le(s))continue;const o=e(s);if(o!=null)return o}return null}function pt(t,e){t.forEach(i=>{const s=i.filters.filter(n=>!le(n));e!=null&&s.push(e),ut(i.filters,s)||(i.filters=s);const o=i.filters.find(n=>le(n));i.activeFilterId=o!=null?o.id:null})}function ut(t,e){const i=e.length;if(t==null||t.length!==i)return!1;for(let s=0;s<i;++s){const o=e.at(s).toJSON(),n=t.at(s).toJSON();if(o.id="",n.id="",JSON.stringify(o)!==JSON.stringify(n))return!1}return!0}function ct(t){const e=Pe(t);return e?new fe({filterExpression:e,filterMode:new Ge}):null}function vt(t){const e=Pe(t);return e?new fe({filterExpression:e,filterMode:new Xe}):null}function Pe(t){return t.filter(e=>!!e).map(e=>`(${e})`).join(" AND ")}const mt="bldglevel";let R=class extends Le{constructor(e){super(e),this._levelFieldName=null,this._parseValueFromFilter=i=>{var n;const s=new RegExp(`${this._levelFieldName}\\s*=\\s*(\\d+)`,"gi"),o=new RegExp(`${this._levelFieldName}\\s*<\\s*(\\d+)`,"gi");for(const{filterMode:h,filterExpression:p}of((n=i.filterBlocks)==null?void 0:n.items)??[]){if(p==null)continue;let _=null;if(h.type==="solid"?_=s.exec(p):h.type==="x-ray"&&(_=o.exec(p)),_)return parseInt(_[1],10)}return null}}get filterExpressions(){return this.enabled&&this._levelFieldName?{xRay:`${this._levelFieldName} < ${this.value}`,solid:`${this._levelFieldName} = ${this.value}`}:{solid:null,xRay:null}}get _firstValue(){const e=this.allowedValues;return e.length>0?e[0]:0}_setup(){const e=[];this.layers.forEach(o=>{const n=se(o,mt);n!=null&&(this._levelFieldName=n.fieldName,e.push(n))}),this._domainInfo=X(e);const i=this._valueBeforeReady;this._set("state","ready"),this._valueBeforeReady=null;const s=i??Ce(this.layers,this._parseValueFromFilter);s!=null?this.select(s):(this.enabled=!1,this.value=this._firstValue)}};l([r({readOnly:!0})],R.prototype,"filterExpressions",null),l([r()],R.prototype,"_levelFieldName",void 0),l([r({readOnly:!0})],R.prototype,"_firstValue",null),R=l([m("esri.widgets.BuildingExplorer.BuildingLevel")],R);const Ee=R,gt="demolishedphase",_t="createdphase";let B=class extends Le{constructor(e){super(e),this._createdPhaseFieldName=null,this._demolishedPhaseFieldName=null,this._parseValueFromFilter=i=>{var p;const s=this._createdPhaseFieldName,o=new RegExp(`${s}\\s*<=\\s*(\\d+)\\s*OR\\s*${s}\\s*IS\\s*NULL`,"gi"),n=this._demolishedPhaseFieldName,h=new RegExp(`${n}\\s*>\\s*(\\d+)\\s*OR\\s*${n}\\s*IS\\s*NULL`,"gi");for(const{filterExpression:_}of((p=i.filterBlocks)==null?void 0:p.items)??[]){const I=_?o.exec(_)??h.exec(_):null;if(I)return parseInt(I[1],10)}return null}}get filterExpressions(){if(!this.enabled)return{solid:null,xRay:null};const e=[],i=this._createdPhaseFieldName;i&&e.push(`(${i} <= ${this.value} OR ${i} IS NULL)`);const s=this._demolishedPhaseFieldName;s&&e.push(`(${s} > ${this.value} OR ${s} IS NULL)`);const o=e.join(" AND ");return{solid:o,xRay:o}}get _lastValue(){const e=this.allowedValues;return e.length>0?e[e.length-1]:0}_setup(){const e=[];this.layers.forEach(s=>{const o=se(s,_t);o!=null&&(this._createdPhaseFieldName=o.fieldName,e.push(o));const n=se(s,gt);n!=null&&(this._demolishedPhaseFieldName=n.fieldName,e.push(n))}),this._domainInfo=X(e);const i=this._valueBeforeReady;if(this._set("state","ready"),this._valueBeforeReady=null,this.allowedValues.length>0){const s=i??Ce(this.layers,this._parseValueFromFilter);this.select(s??this._lastValue)}else this.clear()}};l([r({readOnly:!0})],B.prototype,"filterExpressions",null),l([r()],B.prototype,"_createdPhaseFieldName",void 0),l([r()],B.prototype,"_demolishedPhaseFieldName",void 0),l([r({readOnly:!0})],B.prototype,"_lastValue",null),B=l([m("esri.widgets.BuildingExplorer.BuildingPhase")],B);const Ve=B;let y=class extends Y{constructor(e){super(e),this.view=null,this.state="disabled",this.level=new Ee,this.phase=new Ve,this.disciplines=new $e,this._loadLayers=ae(),this.layers=new k}initialize(){this.addHandles([this.layers.on("change",()=>this._onLayersChange()),w(()=>({state:this.state,layers:this.layers,filter:this._filter}),({state:e,layers:i,filter:s})=>{e==="ready"&&pt(i,s)},{initial:!0})]),this._onLayersChange()}destroy(){this.level.destroyed||this.level.destroy(),this.phase.destroyed||this.phase.destroy(),this.disciplines.destroyed||this.disciplines.destroy()}get isSupported(){var e;return((e=this.view)==null?void 0:e.type)==="3d"}get layers(){return this._get("layers")}set layers(e){const i=e.filter(s=>s instanceof Ye);i.length!==e.length&&Ke.getLogger(this).error("Some layers are not BuildingSceneLayers but only BuildingSceneLayers can be passed to the widget."),this._set("layers",ne(i,this._get("layers")))}get _filter(){const e=this.level.filterExpressions,i=this.phase.filterExpressions,s=[],o=vt([e.solid,i.solid]);o!=null&&s.push(o);const n=ct([e.xRay,i.xRay]);return n!=null&&s.push(n),s.length===0?null:new Ze({id:dt(),name:"Building Explorer Filter",filterBlocks:s})}async _onLayersChange(){const e=this.layers;if(this.level.layers=e,this.phase.layers=e,this.disciplines.layers=e,e.length!==0){this._set("state","loading");try{await this._loadLayers(e),await Promise.all([Z(()=>this.level.state==="ready"),Z(()=>this.phase.state==="ready"),Z(()=>this.disciplines.state==="ready")]),e.forEach(st),this._set("state","ready")}catch(i){oe(i)||this._set("state","failed")}}else this._set("state","disabled")}};l([r({value:null})],y.prototype,"view",void 0),l([r()],y.prototype,"isSupported",null),l([r({type:k,nonNullable:!0})],y.prototype,"layers",null),l([r({readOnly:!0})],y.prototype,"state",void 0),l([r({readOnly:!0,type:Ee})],y.prototype,"level",void 0),l([r({readOnly:!0,type:Ve})],y.prototype,"phase",void 0),l([r({readOnly:!0,type:$e})],y.prototype,"disciplines",void 0),l([r()],y.prototype,"_filter",null),y=l([m("esri.widgets.BuildingExplorer.BuildingExplorerViewModel")],y);const Ne=y,C="esri-building-explorer",g={base:C,panelError:`${C}__panel--error`,loadingContainer:`${C}__loading-container`,content:`${C}__content`,section:`${C}__section`,levels:`${C}__levels`,phases:`${C}__phases`,disciplines:`${C}__disciplines`};var j;const yt={expand:"expand",collapse:"collapse",hideSublayer:"hideSublayer",showSublayer:"showSublayer"},te="esri-building-disciplines-tree-node",ce={base:te,label:`${te}__label`,level:t=>`${te}--level-${t}`};let V=j=class extends D{constructor(t){super(t),this.messages=yt,this.toggleSiblingsVisibility=!1,this._onCheckboxClick=e=>{e.stopPropagation(),(e.metaKey||e.ctrlKey)&&this.toggleSiblingsVisibility&&(this.node.toggleVisibility(),this.node.toggleAllSiblingsVisibility())},this._onCheckboxToggle=e=>{this.node.toggleVisibility(e.currentTarget.checked)}}static loadDependencies(){return O({checkbox:()=>x(()=>import("./index-B7QXL93z.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21]),import.meta.url),label:()=>x(()=>import("./index-D130RxMY.js"),__vite__mapDeps([22,1,2,3,4,5,6,7,8,9,10,11,12,20,15,16]),import.meta.url),tree:()=>x(()=>import("./index-BB34I4Ur.js"),__vite__mapDeps([23,1,2,3,4,5,6,7,8,9,10,11,12,15,16]),import.meta.url),"tree-item":()=>x(()=>import("./index-CZNvXa5f.js"),__vite__mapDeps([24,25,1,2,3,4,5,6,7,8,9,10,11,12,15,16,26,27,14,13,18,28]),import.meta.url)})}loadDependencies(){return j.loadDependencies()}render(){const{node:t,messages:e}=this;if(t.isDiscipline&&!t.hasChildren)return a("div",{key:`${t.id}-empty`});const i=t.visible,s=i===!0,o=i===null,n=s?e==null?void 0:e.hideSublayer:e==null?void 0:e.showSublayer;return a("calcite-tree-item",{class:ce.base,key:t.id},a("calcite-label",{class:ce.label,layout:"inline"},a("calcite-checkbox",{checked:s,indeterminate:o,label:n,onclick:this._onCheckboxClick,title:n,onCalciteCheckboxChange:this._onCheckboxToggle}),t.title),this._renderedChildren)}get _renderedChildren(){const{node:t}=this;if(!t.hasChildren)return null;const{messages:e}=this,{toggleSiblingsVisibility:i}=this;return a("calcite-tree",{slot:"children"},this.node.children.toArray().reverse().map(s=>a(j,{messages:e,node:s,toggleSiblingsVisibility:i})))}};V.vnodeSelector="calcite-tree-item",l([r({type:v})],V.prototype,"node",void 0),l([r()],V.prototype,"messages",void 0),l([r({nonNullable:!0})],V.prototype,"toggleSiblingsVisibility",void 0),l([r()],V.prototype,"_renderedChildren",null),V=j=l([m("esri.widgets.BuildingExplorer.BuildingDisciplinesTree.BuildingDisciplinesNode")],V);const ve=V,ft={expand:"expand",collapse:"collapse",hideSublayer:"hideSublayer",showSublayer:"showSublayer"},bt={base:"esri-building-disciplines-tree"};let M=class extends D{constructor(e){super(e),this.toggleSiblingsVisibility=!1}loadDependencies(){return Promise.allSettled([O({tree:()=>x(()=>import("./index-BB34I4Ur.js"),__vite__mapDeps([23,1,2,3,4,5,6,7,8,9,10,11,12,15,16]),import.meta.url)}),ve.loadDependencies()])}render(){const{vm:e}=this,i=this.toggleSiblingsVisibility,s=this.messages??ft;return a("calcite-tree",{class:bt.base,scale:"s",selectionMode:"none"},e.root.children.toArray().reverse().map(o=>a(ve,{messages:s,node:o,toggleSiblingsVisibility:i})))}};M.vnodeSelector="calcite-tree",l([r()],M.prototype,"vm",void 0),l([r()],M.prototype,"messages",void 0),l([r()],M.prototype,"toggleSiblingsVisibility",void 0),M=l([m("esri.widgets.BuildingExplorer.BuildingDisciplinesTree.BuildingDisciplinesTree")],M);const wt=M,Se=30,ke=20,Be=30,Me=10,J=20,G=2,De=.035,Fe=30,Re=14,Oe=80,$t=100,Lt=40,xt=Object.freeze(Object.defineProperty({__proto__:null,alphaLevelDependencyFactor:Be,alphaSpreadFactor:Me,levelHeightDefault:Re,levelHoveredExtraHeight:Se,levelHoveredExtraWidth:ke,levelWidthConstant:Lt,levelWidthMax:Oe,levelWidthMin:Fe,levelWidthNominator:$t,levelsMarginFactor:G,levelsPadding:J,levelsPointerAdjustment:De},Symbol.toStringTag,{value:"Module"})),P="esri-building-level-picker",E={container:P,noLevel:`${P}--no-level`,animateLevel:`${P}--animate-level`,levelsContainer:`${P}__levels-container`,innerLevelsContainer:`${P}__inner-levels-container`,labelContainer:`${P}__label-container`,arrowUp:`${P}__arrow-up`,arrowDown:`${P}__arrow-down`},H="esri-building-level-picker-label",W={base:H,active:`${H}--active`,hover:`${H}--hover`,empty:`${H}--empty`,clearButton:`${H}__clear-button`},Ct={clearLevel:"",selectLevel:""};let N=class extends D{constructor(e,i){super(e,i),this.level=null,this.active=!1,this.hovering=!1,this.onClear=()=>{}}loadDependencies(){return O({fab:()=>x(()=>import("./index-DrimfvRg.js"),__vite__mapDeps([29,30,1,2,3,4,5,6,7,8,9,10,11,12,16,31,25,15,26,32,13,14,33,17,18,20,21,28]),import.meta.url)})}render(){const e=this.messages??Ct;if(this.level==null)return a("div",{class:W.empty,title:e.selectLevel},e.selectLevel);const i=e.clearLevel;return a("div",{"aria-label":i,bind:this,class:this.classes(W.base,{[W.active]:this.active,[W.hover]:this.hovering}),onclick:this.onClear,title:i},a("span",null,this.level),a("calcite-fab",{appearance:"outline-fill",class:W.clearButton,disabled:!this.active,icon:"x",key:"clear-button",kind:"neutral",onclick:this.onClear,scale:"s"}))}};l([r()],N.prototype,"level",void 0),l([r({nonNullable:!0})],N.prototype,"active",void 0),l([r({nonNullable:!0})],N.prototype,"hovering",void 0),l([r()],N.prototype,"messages",void 0),l([r({nonNullable:!0})],N.prototype,"onClear",void 0),N=l([m("esri.widgets.BuildingExplorer.BuildingLevelPicker.Label")],N);const K="esri-building-level-picker-item",q={container:K,base:`${K}__base`,hover:`${K}--hover`,active:`${K}--active`};let f=class extends D{constructor(t,e){super(t,e),this.active=!1,this.hovering=!1,this.width=0,this.height=0,this.onSelect=()=>{},this.onFocus=()=>{},this.onBlur=()=>{},this._baseElement=null}render(){return a("div",{bind:this,class:this.classes(q.container,{[q.active]:this.active,[q.hover]:this.hovering}),key:this,styles:{height:`${this.height}px`}},this._renderBase())}focus(){this._baseElement!=null&&this._baseElement.focus()}_renderBase(){const t=this.width,e=.8*this.width;return a("div",{class:q.base,styles:{width:`${Math.round(t)}px`,height:`${Math.round(t)}px`}},a("button",{afterCreate:je,"aria-label":this.label,bind:this,class:"rect","data-node-ref":"_baseElement",onblur:this.onBlur,onclick:this.onSelect,onfocus:this.onFocus,styles:{width:`${Math.round(e)}px`,height:`${Math.round(e)}px`,transform:`translate(${Je(this.container),-50}%, -50%) rotateX(66deg) rotateZ(45deg)`},tabIndex:-1,title:this.label??"",type:"button"}))}};l([r({nonNullable:!0})],f.prototype,"level",void 0),l([r({nonNullable:!0})],f.prototype,"active",void 0),l([r({nonNullable:!0})],f.prototype,"hovering",void 0),l([r({nonNullable:!0})],f.prototype,"width",void 0),l([r({nonNullable:!0})],f.prototype,"height",void 0),l([r({nonNullable:!0})],f.prototype,"onSelect",void 0),l([r({nonNullable:!0})],f.prototype,"onFocus",void 0),l([r({nonNullable:!0})],f.prototype,"onBlur",void 0),f=l([m("esri.widgets.BuildingExplorer.BuildingLevelPicker.LevelItem")],f);const ie={selectLevel:"selectLevel",clearLevel:"clearLevel",nextLevel:"nextLevel",previousLevel:"previousLevel",currentLevel:"{{value}}"};let d=class extends D{constructor(t,e){super(t,e),this._levelHandlesKey="levelHandles",this._levelEventHandlesKey="levelEventHandles",this._levelWidgets=[],this._labelWidget=new N({onClear:()=>this.vm.clear()}),this._hoveredLevel=null,this._expandedLevelsHeight=void 0,this._normalizedPointerPosition=0,this._hovering=!1,this._containerPosTop=null,this._levelsContainer=null,this._onKeyDown=i=>{switch(i.key){case"ArrowDown":case"ArrowLeft":i.preventDefault(),i.stopPropagation(),this.vm.previous(),this._focusCurrentLevel();break;case"ArrowUp":case"ArrowRight":i.preventDefault(),i.stopPropagation(),this.vm.next(),this._focusCurrentLevel()}},this._onFocus=()=>{this._hoveredLevel=this._levels.length>0?this._levels[0]:null},this._onArrowUpClick=()=>{this.vm.next()},this._onArrowDownClick=()=>{this.vm.previous()},this._onPointerUp=()=>{var s;if((s=window.getSelection())==null||s.removeAllRanges(),this._hoveredLevel==null)return;const{vm:i}=this;i.enabled&&this._hoveredLevel===i.value?i.clear():i.select(this._hoveredLevel)},this._onPointerEnter=()=>{this._hovering||this._levelsContainer==null||(this._hovering=!0,this._containerPosTop=this._levelsContainer.getBoundingClientRect().top??0)},this._onPointerLeave=()=>{this._hovering&&(this._normalizedPointerPosition=0,this._hoveredLevel=null,this._hovering=!1)},this._onPointerMove=i=>{var s;if(!this._hovering)return!1;if((s=window.getSelection())==null||s.removeAllRanges(),this._containerPosTop!=null){const o=this._containerPosTop,n=J*G,h=this._expandedLevelsMargin;let p=this._levelsHeight,_=o+n+h;const I=this._levelHeight/2;_+=I,p-=I;let he=(i.clientY-_)/p;he+=De,this._normalizedPointerPosition=he}return!1}}loadDependencies(){return O({action:()=>x(()=>import("./index-DVEy4f7w.js"),__vite__mapDeps([34,30,1,2,3,4,5,6,7,8,9,10,11,12,16,31,25,15,26,27,14,13,18,21,28]),import.meta.url)})}postInitialize(){this.addHandles([w(()=>this._levelsContainer,()=>this._onContainerChange(),L),w(()=>this._levels,()=>this._createLevelWidgets(),L),w(()=>this.messages,()=>{this._labelWidget.messages=this.messages??ie},L)])}destroy(){this._levelWidgets.forEach(t=>t.destroy()),this._labelWidget.destroy()}get _levels(){return this.vm.allowedValues}get _numLevels(){return this._levels.length}get _levelsHeight(){return Math.round(this._levelHeight*this._numLevels)}get _expandedLevelsMargin(){return Math.round(((this._expandedLevelsHeight??0)-this._levelsHeight)/2)}get _levelWidth(){const{levelWidthNominator:t,levelWidthConstant:e}=xt,i=t/Math.sqrt(this._numLevels)+e;return Math.round(pe(i,Fe,Oe))}get _levelHeight(){const t=Re,e=2*t/Math.sqrt(this._numLevels);return Math.round(pe(e,2,t))}get _gaussianFactor(){const t=this._numLevels;return t/Math.log(Be*t)*Me}get _levelClosestToPointer(){if(!this._hovering)return null;const t=this._numLevels-1,e=this._normalizedPointerPosition;return t>=0&&e!=null?this._levels[Math.round((1-e)*t)]:null}render(){const t=this._levelWidgets.length,e=t>1?this._levelWidgets.map(h=>h.render()):null,i=J*G,s=-40/G,o=this._levelsHeight,n=o+2*i;return a("div",{class:this.classes(T.widget,E.container,{[E.animateLevel]:!this._hovering,[E.noLevel]:t<2}),key:this,onkeydown:this._onKeyDown},this._renderLabelContainer(),a("div",{afterCreate:h=>this._levelsContainer=h,class:E.levelsContainer,"data-node-ref":"",onfocus:this._onFocus,styles:{height:`${n}px`,marginBlockStart:`${s}px`,marginBlockEnd:`${s}px`}},a("div",{class:E.innerLevelsContainer,styles:{height:`${o}px`,margin:"0",marginBlockStart:J-this._expandedLevelsMargin+"px"}},e)))}_renderLabelContainer(){const{hasPrevious:t,hasNext:e}=this.vm,i=this.messages??ie,s=i.previousLevel,o=i.nextLevel;return a("div",{class:E.labelContainer,tabIndex:0},me({className:E.arrowUp,disabled:!e,icon:"chevron-up",onClick:this._onArrowUpClick,text:o}),this._labelWidget.render(),me({className:E.arrowDown,disabled:!t,icon:"chevron-down",onClick:this._onArrowDownClick,text:s}))}_updateComponents(){const t=this.messages??ie,e=this.vm.enabled?this.vm.value:null,i=this._hoveredLevel!=null?this._hoveredLevel:e;this._levelWidgets.forEach(s=>{var n;const o=this.vm.getValueLabel(s.level);s.label=o??((n=t.currentLevel)==null?void 0:n.replace("{{level}}",String(s.level))),s.active=s.level===e,s.hovering=s.level===this._hoveredLevel}),this._labelWidget.level=i,this._labelWidget.active=i===e,this._labelWidget.hovering=this._hoveredLevel!=null}_createLevelWidgets(){this._levelWidgets.forEach(t=>t.destroy()),this._levelWidgets=this._levels.map(t=>new f({level:t,onSelect:()=>this._onLevelToggle(t)})),this.removeHandles(this._levelHandlesKey),this.addHandles([w(()=>{const{vm:t}=this;return[this.messages,t==null?void 0:t.value,t==null?void 0:t.enabled,this._hoveredLevel,this._hovering]},()=>this._updateComponents(),L),w(()=>[this._normalizedPointerPosition,this._hovering],()=>this._onPointerPositionChange(),L),w(()=>this._levelWidth,t=>this._levelWidgets.forEach(e=>e.width=t),L)],this._levelHandlesKey)}_onContainerChange(){const t=this._levelsContainer;t!=null&&(this.removeHandles(this._levelEventHandlesKey),this.addHandles([A(t,"pointerenter",this._onPointerEnter),A(t,"pointerover",this._onPointerEnter),A(t,"pointerleave",this._onPointerLeave),A(t,"pointerup",this._onPointerUp),A(t,"pointermove",this._onPointerMove)],this._levelEventHandlesKey))}_focusCurrentLevel(){const t=this._levelWidgets.find(e=>e.level===this.vm.value);t==null||t.focus()}_onLevelToggle(t){const{vm:e}=this;e.enabled&&e.value===t?e.clear():e.select(t)}_onPointerPositionChange(){let t=0;this._levelWidgets.forEach((i,s)=>{const{width:o,height:n}=this._getLevelWidgetSize(s);i.height=n,i.width=o,t+=n}),this._hoveredLevel=this._levelClosestToPointer;const e=this._expandedLevelsHeight;(e==null||Math.abs(e-t)>30)&&(this._expandedLevelsHeight=t)}_getLevelWidgetSize(t){const e={width:this._levelWidth,height:this._levelHeight};if(this._hovering){const i=this._getGaussianFactor(t,this._normalizedPointerPosition);e.width+=ke*i,e.height+=Se*i}return e}_getGaussianFactor(t,e){const i=this._numLevels-1,s=(i-t)/i,o=this._gaussianFactor*(s-e);return Math.exp(-(o**2))}};function me(t){return a("calcite-action",{appearance:"transparent",class:t.className,disabled:t.disabled,icon:t.icon,key:t.className,onclick:t.onClick,scale:"s",text:t.text,textEnabled:!1,title:t.text})}l([r()],d.prototype,"vm",void 0),l([r()],d.prototype,"messages",void 0),l([r()],d.prototype,"_levelWidgets",void 0),l([r()],d.prototype,"_labelWidget",void 0),l([r()],d.prototype,"_hoveredLevel",void 0),l([r()],d.prototype,"_levels",null),l([r()],d.prototype,"_numLevels",null),l([r({readOnly:!0})],d.prototype,"_levelsHeight",null),l([r()],d.prototype,"_expandedLevelsHeight",void 0),l([r({readOnly:!0})],d.prototype,"_expandedLevelsMargin",null),l([r({readOnly:!0})],d.prototype,"_levelWidth",null),l([r({readOnly:!0})],d.prototype,"_levelHeight",null),l([r({readOnly:!0})],d.prototype,"_gaussianFactor",null),l([r({readOnly:!0})],d.prototype,"_levelClosestToPointer",null),l([r({type:Number,range:{min:0,max:1}})],d.prototype,"_normalizedPointerPosition",void 0),l([r()],d.prototype,"_hovering",void 0),l([r()],d.prototype,"_containerPosTop",void 0),l([r()],d.prototype,"_levelsContainer",void 0),d=l([m("esri.widgets.BuildingExplorer.BuildingLevelPicker.BuildingLevelPicker")],d);const Pt=d,$="esri-building-phase-picker",b={base:`${$}`,phasesContainer:`${$}__phases-container`,phase:`${$}__phase`,phaseActive:`${$}__phase--active`,phaseCurrent:`${$}__phase--current`,divider:`${$}__divider`,dividerActive:`${$}__divider--active`,arrowLeft:`${$}__arrow-left`,arrowRight:`${$}__arrow-right`},Et={nextPhase:"nextPhase",previousPhase:"previousPhase",currentPhase:"{{value}}"};let S=class extends D{constructor(t,e){super(t,e),this._phasesContainer=null,this._shouldScrollCurrentPhaseIntoView=!0,this._shouldFocusCurrentPhase=!1,this._onKeyDown=i=>{const{vm:s}=this;switch(i.key){case"ArrowDown":case"ArrowLeft":i.stopPropagation(),i.preventDefault(),s.previous(),this._shouldFocusCurrentPhase=!0;break;case"ArrowUp":case"ArrowRight":i.stopPropagation(),i.preventDefault(),s.next(),this._shouldFocusCurrentPhase=!0}},this._onArrowLeftClick=()=>{this.vm.previous()},this._onArrowRightClick=()=>{this.vm.next()},this._onPhasesContainerAfterCreate=i=>{this._phasesContainer=i,requestAnimationFrame(this._scrollOrFocusPhase)},this._scrollOrFocusPhase=()=>{const i=this._phasesContainer;if(this.destroyed||i==null)return;const s=i.querySelector(`.${b.phaseCurrent}`);if(s){if(this._shouldScrollCurrentPhaseIntoView){const o=i.offsetWidth,n=s.offsetLeft,h=s.offsetWidth;i.scrollLeft=-o/2+n+h/2,this._shouldScrollCurrentPhaseIntoView=!1}this._shouldFocusCurrentPhase&&(s.focus(),this._shouldFocusCurrentPhase=!1)}}}loadDependencies(){return O({action:()=>x(()=>import("./index-DVEy4f7w.js"),__vite__mapDeps([34,30,1,2,3,4,5,6,7,8,9,10,11,12,16,31,25,15,26,27,14,13,18,21,28]),import.meta.url)})}initialize(){this.addHandles(w(()=>[this._currentPhase,this._phasesContainer,this.container],()=>{this._shouldScrollCurrentPhaseIntoView=!0,requestAnimationFrame(this._scrollOrFocusPhase)},L))}get _phases(){return this.vm.allowedValues}get _currentPhase(){const{vm:t}=this;return t.enabled?t.value:null}render(){if(this._phases.length<2)return a("div",{key:"no-phases"});const{vm:t,messages:e}=this,{previousPhase:i,nextPhase:s}=e??Et;return a("div",{class:this.classes(T.widget,b.base),key:this,onkeydown:this._onKeyDown},ge({className:b.arrowLeft,disabled:!t.hasPrevious,icon:"chevron-left",onClick:this._onArrowLeftClick,text:i}),a("div",{afterCreate:this._onPhasesContainerAfterCreate,class:b.phasesContainer},this._renderPhaseButtons()),ge({className:b.arrowRight,disabled:!t.hasNext,icon:"chevron-right",onClick:this._onArrowRightClick,text:s}))}_renderPhaseButtons(){const t=this._phases,e=this._currentPhase,i=[];for(let s=0;s<t.length;++s){const o=t[s],n={phase:o,active:e!=null&&o<=e,current:e!=null&&o===e};s>0&&i.push(this._renderDivider(n)),i.push(this._renderPhaseButton(n))}return i}_renderPhaseButton({phase:t,active:e,current:i}){const{vm:s}=this,o=s.getValueLabel(t);return a("button",{"aria-label":o,class:this.classes(b.phase,{[b.phaseActive]:e,[b.phaseCurrent]:i}),key:`phase-${t}`,onclick:()=>s.select(t),title:o,type:"button"},t)}_renderDivider({phase:t,active:e}){return a("div",{class:this.classes(b.divider,{[b.dividerActive]:e}),key:`phase-divider-${t}`})}};function ge(t){return a("calcite-action",{appearance:"transparent",class:t.className,disabled:t.disabled,icon:t.icon,iconFlipRtl:!0,key:t.className,onclick:t.onClick,scale:"s",text:t.text,textEnabled:!1,title:t.text})}l([r({nonNullable:!0})],S.prototype,"vm",void 0),l([r()],S.prototype,"messages",void 0),l([r()],S.prototype,"_phases",null),l([r()],S.prototype,"_currentPhase",null),l([r()],S.prototype,"_phasesContainer",void 0),S=l([m("esri.widgets.BuildingExplorer.BuildingPhasePicker.BuildingPhasePicker")],S);const Vt=S,_e={levels:!0,phases:!0,disciplines:!0};let c=class extends D{constructor(t,e){super(t,e),this._defaultViewModel=new Ne,this.viewModel=this._defaultViewModel,this.visibleElements={..._e},this.headingLevel=3,this.messages=null,this.messagesCommon=null,this.toggleSiblingsVisibility=!1}loadDependencies(){return O({loader:()=>x(()=>import("./index-CjrYEQXz.js"),__vite__mapDeps([30,1,2,3,4,5,6,7,8,9,10,11,12,16,31]),import.meta.url)})}destroy(){this.viewModel!==this._defaultViewModel&&this._defaultViewModel.destroy()}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}get layers(){return this.viewModel.layers}set layers(t){this.viewModel.layers=t}_castVisibleElements(t){return{..._e,...t}}get icon(){return"organization"}set icon(t){this._overrideIfSome("icon",t)}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}render(){const t=this.viewModel,e=t.state==="disabled"||!t.isSupported;return a("div",{"aria-label":this.messages.widgetLabel,class:U(T.widget,g.base,T.panel,{[T.widgetDisabled]:e}),key:this},this._renderContent())}_renderContent(){const t=this.viewModel,e=this.messages;if(!t.isSupported)return a("p",{class:g.panelError},e.unsupported);if(!t.layers.length)return a("p",{class:g.panelError},e.noData);switch(t.state){case"loading":return this._renderLoadingIndicator();case"ready":return a("div",{class:g.content,key:"content"},this._renderLevelPickerSection(),this._renderPhasePickerSection(),this._renderDisciplinesSection());case"failed":return a("p",{class:g.panelError},e.failed);default:return null}}_renderLoadingIndicator(){const t=this.messagesCommon.loading;return a("div",{"aria-label":t,class:g.loadingContainer,key:"loading-container",role:"presentation",title:t},a("calcite-loader",{label:t,type:"indeterminate"}))}_renderLevelPickerSection(){var o;const t=this.viewModel.level,e=t.state==="ready",i=t.allowedValues.length>1;if(!this.visibleElements.levels||!e||!i)return null;const s=(o=this.messages)==null?void 0:o.level;return a("div",{class:U(g.section,g.levels),key:"levels"},a(Q,{level:this.headingLevel},s==null?void 0:s.title),a(Pt,{messages:s,vm:t}))}_renderPhasePickerSection(){const t=this.viewModel.phase,e=t.state==="ready",i=t.allowedValues.length>1;if(!this.visibleElements.phases||!e||!i)return null;const s=this.messages.phase;return a("div",{class:U(g.section,g.phases),key:"phases"},a(Q,{level:this.headingLevel},s.title),a(Vt,{messages:s,vm:t}))}_renderDisciplinesSection(){var o;const t=this.viewModel.disciplines,e=t.state==="ready",i=t.root.hasChildren;if(!this.visibleElements.disciplines||!e||!i)return null;const s=(o=this.messages)==null?void 0:o.disciplines;return a("div",{class:U(g.section,g.disciplines),key:"disciplines"},a(Q,{level:this.headingLevel},s.title),a(wt,{messages:s,toggleSiblingsVisibility:this.toggleSiblingsVisibility,vm:t}))}};l([r({type:Ne})],c.prototype,"viewModel",void 0),l([r()],c.prototype,"view",null),l([r()],c.prototype,"layers",null),l([r()],c.prototype,"visibleElements",void 0),l([qe("visibleElements")],c.prototype,"_castVisibleElements",null),l([r()],c.prototype,"headingLevel",void 0),l([r()],c.prototype,"icon",null),l([r()],c.prototype,"label",null),l([r(),de("esri/widgets/BuildingExplorer/t9n/BuildingExplorer")],c.prototype,"messages",void 0),l([r(),de("esri/t9n/common")],c.prototype,"messagesCommon",void 0),l([r({nonNullable:!0})],c.prototype,"toggleSiblingsVisibility",void 0),l([r()],c.prototype,"uiStrings",void 0),c=l([m("esri.widgets.BuildingExplorer")],c);const Nt=c;/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.32/esri/copyright.txt for details.
v4.32.12 */const St=Ie`@layer{arcgis-building-explorer{display:block}}`,kt=et(Nt),z=class z extends Ae{constructor(){super(...arguments),this.widget=kt(this),this.viewModel=this.widget.viewModel,this.autoDestroyDisabled=!1,this.headingLevel=this.widget.headingLevel,this.hideDisciplines=this.widget.visibleElements.disciplines,this.hideLevels=this.widget.visibleElements.levels,this.hidePhases=this.widget.visibleElements.phases,this.icon=this.widget.icon,this.label=this.widget.label,this.layers=this.widget.layers,this.level=this.viewModel.level,this.phase=this.viewModel.phase,this.position="bottom-left",this.state=this.viewModel.state,this.arcgisPropertyChange=He()("level","phase","state"),this.arcgisReady=We()}async destroy(){await this.manager.destroy()}};z.properties={autoDestroyDisabled:5,headingLevel:9,hideDisciplines:5,hideLevels:5,hidePhases:5,icon:1,label:1,layers:0,level:0,phase:0,position:1,referenceElement:1,state:3},z.shadowRootOptions=Te,z.styles=St;let re=z;ze("arcgis-building-explorer",re);export{re as ArcgisBuildingExplorer};
