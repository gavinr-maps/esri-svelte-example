import{aR as I}from"./Accessor-BHnuXKD2.js";import{c as f}from"./vec32-Dvg_eL9J.js";import{r as S,n as O}from"./vec3f64-BLpZdpfb.js";import{r as R}from"./vec4f64-o2zAXfmz.js";import{o as y}from"./projectBuffer-DOU0xvVi.js";import{t as $}from"./Attribute-B-NAci_J.js";import{e as j}from"./Material-Ba8x5bbY.js";import{f as v}from"./FloatArray-BCfeX8wo.js";import{W as L,a as W,A as x}from"./RibbonLine.glsl-D3IEIaDR.js";import{e as z}from"./VertexAttribute-Cq4MnHjR.js";var l,M,w;(function(t){t[t.RasterImage=0]="RasterImage",t[t.Features=1]="Features"})(l||(l={})),function(t){t[t.MapLayer=0]="MapLayer",t[t.ViewLayer=1]="ViewLayer",t[t.Outline=2]="Outline",t[t.SnappingHint=3]="SnappingHint"}(M||(M={})),function(t){t[t.WithRasterImage=0]="WithRasterImage",t[t.WithoutRasterImage=1]="WithoutRasterImage"}(w||(w={}));class A{constructor(i,n){this.vec3=i,this.id=n}}function b(t,i,n,s){return new A(S(t,i,n),s)}class C{constructor(i){this._originSR=i,this._rootOriginId="root/"+I(),this._origins=new Map,this._objects=new Map,this._gridSize=5e5}getOrigin(i){const n=this._origins.get(this._rootOriginId);if(n==null){const c=b(i[0]+Math.random()-.5,i[1]+Math.random()-.5,i[2]+Math.random()-.5,this._rootOriginId);return this._origins.set(this._rootOriginId,c),c}const s=this._gridSize,m=Math.round(i[0]/s),g=Math.round(i[1]/s),_=Math.round(i[2]/s),h=`${m}/${g}/${_}`;let o=this._origins.get(h);const e=.5*s;if(f(r,i,n.vec3),r[0]=Math.abs(r[0]),r[1]=Math.abs(r[1]),r[2]=Math.abs(r[2]),r[0]<e&&r[1]<e&&r[2]<e){if(o){const c=Math.max(...r);if(f(r,i,o.vec3),r[0]=Math.abs(r[0]),r[1]=Math.abs(r[1]),r[2]=Math.abs(r[2]),Math.max(...r)<c)return o}return n}return o||(o=b(m*s,g*s,_*s,h),this._origins.set(h,o)),o}_drawOriginBox(i,n=R(1,1,0,1)){const s=window.view,m=s._stage,g=n.toString();if(!this._objects.has(g)){this._material=new L({width:2,color:n}),m.add(this._material);const a=new W(m,{pickable:!1}),u=new x({castShadow:!1});m.add(u),a.add(u),this._objects.set(g,u)}const _=this._objects.get(g),h=[0,1,5,4,0,2,1,7,6,2,0,1,3,7,5,4,6,2,0],o=h.length,e=new Array(3*o),c=new Array,d=.5*this._gridSize;for(let a=0;a<o;a++)e[3*a]=i[0]+(1&h[a]?d:-d),e[3*a+1]=i[1]+(2&h[a]?d:-d),e[3*a+2]=i[2]+(4&h[a]?d:-d),a>0&&c.push(a-1,a);y(e,this._originSR,0,e,s.renderSpatialReference,0,o);const p=new v(this._material,[[z.POSITION,new $(e,c,3,!0)]],null,j.Line);m.add(p),_.addGeometry(p)}get test(){}}const r=O();export{C as _,M as a,b,l as e,w as t};
