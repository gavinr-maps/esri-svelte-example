const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./calcite-button-D_QRw8fR.js","./button-CT5wDIjk.js","./jsxFactory-CbAu6VfF.js","./Evented-CXIxDjmW.js","./Accessor-D6mNnsWy.js","./subclass-BR3PhgZG.js","./intl-Dpfm8vPB.js","./Promise-CZrWwByK.js","./jsonMap-DCC6W5ex.js","./assets-C2mb-ea2.js","./index-CeCSsEgo.js","./index-CjOb8WjV.css","./reactiveUtils-BFQ0BtrB.js","./shared-B3wH2qpO.js","./uuid-fwrPAdZb.js","./form-DcBTx4ZC.js","./dom-Cv0oa6So.js","./interactive-Dtpmn6Ls.js","./label-rdYpV4K5.js","./component-ByvC-PUv.js","./loadable-CTFTnu2T.js","./locale-BUTTOPma.js","./key-D5DPfjW0.js","./observers-EizV_Lvc.js","./t9n-DfK3dFGw.js","./icon-DIKjN-ev.js","./loader-wfvKSvDR.js","./calcite-checkbox-y1r16Xxb.js","./calcite-input-EEDQOvVg.js","./input2-ChLBQj0V.js","./Validation-BBJwLSGg.js","./input-Dt5r39B0.js","./input-message-CKyGNFPw.js","./progress-B-8bmD6j.js","./calcite-label-CI84R5fD.js","./calcite-option-CkcBseNz.js","./calcite-select-PMbeJemP.js"])))=>i.map(i=>d[i]);
import{_ as R}from"./index-CeCSsEgo.js";import{e as a,o as pt}from"./Evented-CXIxDjmW.js";import{y as c,b as U,c as S,n as B}from"./subclass-BR3PhgZG.js";import{S as at,a6 as ht}from"./Accessor-D6mNnsWy.js";import{s as lt}from"./jsonMap-DCC6W5ex.js";import{e as K,B as mt,r as vt,n as d,o as Q,s as gt}from"./jsxFactory-CbAu6VfF.js";import{n as _t}from"./assets-C2mb-ea2.js";import{d as bt}from"./Graphic-Dc7F67nR.js";import"./intl-Dpfm8vPB.js";import{V as W,d as j,P as ft,p as wt}from"./reactiveUtils-BFQ0BtrB.js";import{_ as q,f as N,G as yt,a6 as Ct}from"./Point-DB4Hp4hH.js";import{_ as Pt,K as $t,W as St}from"./projection-A9yUaaTs.js";import{n as xt}from"./symbols-CsUQ5BxR.js";import"./geometry-DpwwkAX1.js";import{r as dt,s as Mt,p as Et}from"./number-CrcpkfNb.js";import{d as Z,e as Tt,h as It}from"./Promise-CZrWwByK.js";import{P as Dt,G as Ft,T as Rt,E as Lt,v as Vt,M as Bt,p as kt,k as At}from"./coordinateFormatter-C5AdO4H_.js";import{t as Ot}from"./GoTo-CyjNnle5.js";import{e as O}from"./globalCss-CZa70j6i.js";import{e as tt}from"./Heading-ynVMbJ8d.js";import{i as Gt}from"./legacyIcon-CtsJ0OTG.js";import{t as T}from"./accessibleHandler-DFh8uIGE.js";import"./uuid-fwrPAdZb.js";import"./PopupTemplate-ByHks6sq.js";import"./Clonable-cKbRam6-.js";import"./writer-3zufXUNV.js";import"./fieldUtils-CNduWQU9.js";import"./mathUtils-ClvKsMak.js";import"./enumeration--HlxOQ_N.js";import"./Color-DDUWtbqR.js";import"./colorUtils-CS9vdHXB.js";import"./ActionToggle-C0Z1k2jc.js";import"./Identifiable-BLvpQbOc.js";import"./jsonUtils-Cma_7A64.js";import"./Extent-DHjqVB-p.js";import"./Polyline-D97hl-6E.js";import"./shared-B3wH2qpO.js";import"./projectBuffer-vsa0P_cF.js";import"./geodesicConstants-XRAvAZCD.js";import"./TextSymbol-gKE-H_J6.js";import"./screenUtils-PfxkaaMN.js";import"./materialUtils-CQ3JLQ1x.js";import"./opacityUtils-BT7mQkwC.js";import"./aaBoundingBox-rJEWaOSN.js";import"./persistableUrlUtils-BcifXQ1Z.js";import"./collectionUtils-Dm1icNvk.js";import"./Portal-liet8xHC.js";let V=class extends at{constructor(i){super(i),this.format=null,this.position={coordinate:null,location:null}}get displayCoordinate(){var i,t;return(t=this.format)==null?void 0:t.getDisplayCoordinate((i=this.position)==null?void 0:i.coordinate)}};a([c({readOnly:!0})],V.prototype,"displayCoordinate",null),a([c()],V.prototype,"format",void 0),a([c()],V.prototype,"position",void 0),V=a([U("esri.widgets.CoordinateConversion.support.Conversion")],V);const k=V;function Wt(e,i){const t=ct(i);return[e[0].toFixed(t),e[1].toFixed(t)]}function ct(e){return e>=500?6:e<500&&e>=50?7:e<50&&e>=5?8:9}function Xt(e,i){const t=e.includes(",")?",":" ",[o,n,r]=e.split(t).map(p=>{const h=p.trim();return h?Number(h):null});if(!H(o)||!H(n))return null;const l=new q({x:o,y:n,spatialReference:i||N.WGS84});return r&&(l.z=r,l.hasZ=!0),l}function H(e){return typeof e=="number"&&isFinite(e)}function J(e){return!!e&&H(e.x)&&H(e.y)}function et(e,i){if(e.spatialReference.isGeographic&&i){const[t,o]=Wt([e.x,e.y],i);return`${t}, ${o}`}return`${e.x.toFixed(3)}, ${e.y.toFixed(3)}`}const Yt=["dd","dms","ddm","mgrs","usng","utm"];function Nt(e){return Yt.includes(e)}let C=class extends at{constructor(e){super(e),this.conversionInfo=null,this.coordinateSegments=null,this._currentPattern=void 0,this.defaultPattern=null,this.name=null,this.viewModel=null}get currentPattern(){return(this._currentPattern||this.defaultPattern)??""}set currentPattern(e){this._currentPattern=e}get label(){return this.name??""}set label(e){this._overrideIfSome("label",e)}get hasDisplayProperties(){return!(!this.defaultPattern||!this.coordinateSegments)}get spatialReference(){var e;return this.name==="basemap"?this._viewSpatialReference:((e=this.conversionInfo)==null?void 0:e.spatialReference)??N.WGS84}set spatialReference(e){this._overrideIfSome("spatialReference",e)}get _viewSpatialReference(){var e,i;return((i=(e=this.viewModel)==null?void 0:e.view)==null?void 0:i.spatialReference)??N.WGS84}get _additionalCharactersPattern(){const e=this.coordinateSegments;if(!e)return null;const i=e.map(o=>o.alias),t=this.currentPattern.replaceAll(new RegExp(`["nsew${i.join()}]`,"gi"),"").replaceAll(" ","");return new RegExp(`[${t}]`,"g")}get test(){}async convert(e){var o;if(!J(e))throw new S("format:invalid-point","Could not convert invalid point.",{point:e});const i=(o=this.conversionInfo)==null?void 0:o.convert;if(i)return Promise.resolve().then(()=>i(e));const t=await this._project(e,this.spatialReference);return{location:t,coordinate:await this._getCoordinate(t)}}getConversionStrategy(){var i,t;const e=this._viewSpatialReference;return(i=this.conversionInfo)!=null&&i.convert||(t=this.viewModel)!=null&&t.formatterAvailable||this.name==="xy"&&(e.isWebMercator||e.isWGS84)||this.name==="basemap"?"client":"server"}getDisplayCoordinate(e){if(!e)return null;if(!this.coordinateSegments||!this.currentPattern)return e;let i=this.currentPattern;const t=this._getSegmentMatches(e,!1);for(let o=this.coordinateSegments.length-1;o>=0;o--){const n=this.coordinateSegments[o];i=i.replace(n.alias,t[o])}return i}_parseUserInput(e){const{defaultPattern:i,_additionalCharactersPattern:t,coordinateSegments:o}=this;if(!i||!t)return"";let n=i.replace(t,"");e=e.replace(t,"");const r=this._getSegmentMatches(e,!0);if(o)for(let l=o.length-1;l>=0;l--){const p=o[l];n=n.replace(p.alias,r[l])}return n}_getSegmentMatches(e,i){const t=new Array,{coordinateSegments:o}=this;if(!o)return t;for(let n=0;n<o.length;n++){const r=o[n],l=e.match(r.searchPattern);if(!l){t.push("");continue}let p=l[0];if(e=e.replace(p,"").trim(),r.substitution){const h=i?r.substitution.input(p):r.substitution.output(p);h&&(p=`${h}`)}t.push(p)}return t}async reverseConvert(e){var n,r;const i=this._parseUserInput(e),t=(n=this.conversionInfo)==null?void 0:n.reverseConvert;let o;if(t)o=t(i);else if(this.name==="xy"||this.name==="basemap")o=Xt(i,this.spatialReference);else if((r=this.viewModel)!=null&&r.formatterAvailable)switch(this.name){case"dd":case"ddm":case"dms":o=Lt(i,this.spatialReference);break;case"mgrs":{o=Rt(i,this.spatialReference,"automatic");break}case"utm":{o=Ft(i,this.spatialReference,"latitude-band-indicators");break}case"usng":o=Dt(i,this.spatialReference);break;default:o=null}if(!o)throw new S("format:invalid-input","Could not parse input into point.",{userInput:e});return this._project(o,this._viewSpatialReference)}async _getCoordinate(e){var t,o,n;const i=((o=(t=this.viewModel)==null?void 0:t.view)==null?void 0:o.scale)??0;if(!J(e))throw new S("format:invalid-point","Could not transform invalid point into coordinate.",{point:e});if((n=this.viewModel)!=null&&n.formatterAvailable||this.name==="basemap"||this.name==="xy")switch(this.name){case"dd":case"ddm":case"dms":{const r=ct(i);return At(e,this.name,r)}case"mgrs":return kt(e,"automatic",5,!1);case"usng":return Bt(e,5,!1);case"utm":return Vt(e,"latitude-band-indicators",!0);default:return et(e,i)}return et(e,i)}async _project(e,i){var t,o;if(yt(e.spatialReference,i)||!i)return e;if((t=this.viewModel)!=null&&t.formatterAvailable&&Pt())return $t(e,i);if(!((o=this.viewModel)!=null&&o.formatterAvailable)){const n=Ct(e,i);if(n!=null)return n}return null}};a([c()],C.prototype,"conversionInfo",void 0),a([c()],C.prototype,"coordinateSegments",void 0),a([c()],C.prototype,"currentPattern",null),a([c()],C.prototype,"_currentPattern",void 0),a([c()],C.prototype,"label",null),a([c()],C.prototype,"defaultPattern",void 0),a([c({readOnly:!0})],C.prototype,"hasDisplayProperties",null),a([c()],C.prototype,"name",void 0),a([c({type:N})],C.prototype,"spatialReference",null),a([c()],C.prototype,"viewModel",void 0),a([c({readOnly:!0})],C.prototype,"_viewSpatialReference",null),a([c({readOnly:!0})],C.prototype,"_additionalCharactersPattern",null),C=a([U("esri.widgets.CoordinateConversion.support.Format")],C);const M=C,I=dt().decimal,L={N:"north",S:"south",E:"east",W:"west"},f="°‎",X=new RegExp(`-?\\d+[\\.|\\${I}]?\\d*`),Ht=/^[\\0]+(?=\d)/;function it(e,i){const t=Z()==="ar",o=e.abbreviatedDirections.north,n=e.abbreviatedDirections.south,r=e.abbreviatedDirections.east,l=e.abbreviatedDirections.west,p=dt().decimal,h={[o]:"N",[n]:"S",[r]:"E",[l]:"W"},b=new RegExp(`-?\\d+[\\.|\\${p}]?\\d*`),w=new RegExp(`N|S|${o}|${n}`,"i"),E=new RegExp(`E|W|${r}|${l}`,"i"),D={ddm:`Y${f} A'${e.abbreviatedDirections.north}, X${f} B'${e.abbreviatedDirections.east}`,dms:`Y${f} A' B"${e.abbreviatedDirections.north}, X${f} C' D"${e.abbreviatedDirections.east}`,dd:`Y${f}${e.abbreviatedDirections.north}, X${f}${e.abbreviatedDirections.east}`,xy:`X${f}, Y${f}`,basemap:"X, Y"},A={ddm:`${e.abbreviatedDirections.north}${f}Y 'A ,${e.abbreviatedDirections.east}${f}X 'B`,dms:`${e.abbreviatedDirections.north}${f}Y 'A "B ,${e.abbreviatedDirections.east}${f}X 'C "D`,dd:`${e.abbreviatedDirections.north}${f}Y ,${e.abbreviatedDirections.east}${f}X`,xy:`X${f} ,Y${f}`,basemap:"X ,Y"},G=P=>P!=null&&Object.keys(D).includes(P),$=new RegExp(`\\d{1,2}[\\.|\\${p}]?\\d*`,"i"),z=new RegExp(`\\d{1,3}[\\.|\\${p}]?\\d*`,"i");i.forEach(P=>{const{name:F}=P;if(F==="dd"?P.coordinateSegments=[{alias:"Y",description:"degrees latitude",searchPattern:$,substitution:{input:s=>v(s),output:s=>m(s)}},{alias:e.abbreviatedDirections.north,description:"north/south indicator",searchPattern:w,substitution:{input:s=>h[s],output:s=>e.abbreviatedDirections[L[s]]}},{alias:"X",description:"degrees longitude",searchPattern:z,substitution:{input:s=>v(s),output:s=>m(s)}},{alias:e.abbreviatedDirections.east,description:"east/west indicator",searchPattern:E,substitution:{input:s=>h[s],output:s=>e.abbreviatedDirections[L[s]]}}]:F==="ddm"?P.coordinateSegments=[{alias:"Y",description:"degrees latitude",searchPattern:$,substitution:{input:s=>v(s),output:s=>m(s)}},{alias:"A",description:"minutes latitude",searchPattern:$,substitution:{input:s=>v(s),output:s=>m(s)}},{alias:e.abbreviatedDirections.north,description:"north/south indicator",searchPattern:w,substitution:{input:s=>h[s],output:s=>e.abbreviatedDirections[L[s]]}},{alias:"X",description:"degrees longitude",searchPattern:z,substitution:{input:s=>v(s),output:s=>m(s)}},{alias:"B",description:"minutes longitude",searchPattern:$,substitution:{input:s=>v(s),output:s=>m(s)}},{alias:e.abbreviatedDirections.east,description:"east/west indicator",searchPattern:E,substitution:{input:s=>h[s],output:s=>e.abbreviatedDirections[L[s]]}}]:F==="dms"?P.coordinateSegments=[{alias:"Y",description:"degrees latitude",searchPattern:$,substitution:{input:s=>v(s),output:s=>m(s)}},{alias:"A",description:"minutes latitude",searchPattern:$,substitution:{input:s=>v(s),output:s=>m(s)}},{alias:"B",description:"seconds latitude",searchPattern:$,substitution:{input:s=>v(s),output:s=>m(s)}},{alias:e.abbreviatedDirections.north,description:"north/south indicator",searchPattern:w,substitution:{input:s=>h[s],output:s=>e.abbreviatedDirections[L[s]]}},{alias:"X",description:"degrees longitude",searchPattern:z,substitution:{input:s=>v(s),output:s=>m(s)}},{alias:"C",description:"minutes longitude",searchPattern:$,substitution:{input:s=>v(s),output:s=>m(s)}},{alias:"D",description:"seconds longitude",searchPattern:$,substitution:{input:s=>v(s),output:s=>m(s)}},{alias:e.abbreviatedDirections.east,description:"east/west indicator",searchPattern:E,substitution:{input:s=>h[s],output:s=>e.abbreviatedDirections[L[s]]}}]:(P.name==="xy"||P.name==="basemap")&&(P.coordinateSegments=[{alias:"X",description:"easting",searchPattern:b,substitution:{input:s=>v(s),output:s=>m(s)}},{alias:"Y",description:"northing",searchPattern:b,substitution:{input:s=>v(s),output:s=>m(s)}}]),G(F)){const s=t?A[F]:D[F];P.defaultPattern=s,P.currentPattern=s}})}function Ut(){const e=new RegExp("N|S","i"),i=new RegExp("E|W","i");return[new M({name:"basemap",coordinateSegments:[{alias:"X",description:"easting",searchPattern:X,substitution:{input:t=>v(t),output:t=>m(t)}},{alias:"Y",description:"northing",searchPattern:X,substitution:{input:t=>v(t),output:t=>m(t)}}],defaultPattern:"X, Y",viewModel:null}),new M({name:"dd",coordinateSegments:[{alias:"Y",description:"degrees latitude",searchPattern:new RegExp(`\\d{1,2}[\\.|\\${I}]?\\d*(?=\\D*?[N|S])`,"i"),substitution:{input:t=>v(t),output:t=>m(t)}},{alias:"N",description:"north/south indicator",searchPattern:e},{alias:"X",description:"degrees longitude",searchPattern:new RegExp(`\\d{1,3}[\\.|\\${I}]?\\d*(?=\\D*?[E|W|])`,"i"),substitution:{input:t=>v(t),output:t=>m(t)}},{alias:"E",description:"east/west indicator",searchPattern:i}],defaultPattern:`Y${f}N, X${f}E`,viewModel:null}),new M({name:"ddm",coordinateSegments:[{alias:"Y",description:"degrees latitude",searchPattern:new RegExp("\\d{1,2}(?=.*?\\s+.*?[N|S])","i"),substitution:{input:t=>v(t),output:t=>m(t)}},{alias:"A",description:"minutes latitude",searchPattern:new RegExp(`\\d{1,2}[\\.\\${I}]?\\d*(?=.*?[N|S])`,"i"),substitution:{input:t=>v(t),output:t=>m(t)}},{alias:"N",description:"north/south indicator",searchPattern:e},{alias:"X",description:"degrees longitude",searchPattern:new RegExp("\\d{1,3}(?=\\D*?\\s+.*?[E|W])","i"),substitution:{input:t=>v(t),output:t=>m(t)}},{alias:"B",description:"minutes longitude",searchPattern:new RegExp(`\\d{1,2}[\\.|\\|${I}]?\\d*(?=.*?[E|W])`,"i"),substitution:{input:t=>v(t),output:t=>m(t)}},{alias:"E",description:"east/west indicator",searchPattern:i}],defaultPattern:`Y${f} A'N, X${f} B'E`,viewModel:null}),new M({name:"dms",coordinateSegments:[{alias:"Y",description:"degrees latitude",searchPattern:new RegExp("\\d{1,2}(?=.*?\\s+.*?[N|S])","i"),substitution:{input:t=>v(t),output:t=>m(t)}},{alias:"A",description:"minutes latitude",searchPattern:new RegExp("\\d{1,2}(?=.*?[N|S])","i"),substitution:{input:t=>v(t),output:t=>m(t)}},{alias:"B",description:"seconds latitude",searchPattern:new RegExp(`\\d{1,2}[\\.|\\${I}]?\\d*(?=.*?[N|S])`,"i"),substitution:{input:t=>v(t),output:t=>m(t)}},{alias:"N",description:"north/south indicator",searchPattern:e},{alias:"X",description:"degrees longitude",searchPattern:new RegExp("\\d{1,3}(?=.*?\\s+.*?[E|W])","i"),substitution:{input:t=>v(t),output:t=>m(t)}},{alias:"C",description:"minutes longitude",searchPattern:new RegExp("\\d{1,2}(?=.*?[E|W])","i"),substitution:{input:t=>v(t),output:t=>m(t)}},{alias:"D",description:"seconds longitude",searchPattern:new RegExp(`\\d{1,2}[\\.|\\${I}]?\\d*(?=.*?[E|W])`,"i"),substitution:{input:t=>v(t),output:t=>m(t)}},{alias:"E",description:"east/west indicator",searchPattern:i}],defaultPattern:`Y${f} A' B"N, X${f} C' D"E`,viewModel:null}),new M({name:"xy",coordinateSegments:[{alias:"X",description:"longitude",searchPattern:X,substitution:{input:t=>v(t),output:t=>m(t)}},{alias:"Y",description:"latitude",searchPattern:X,substitution:{input:t=>v(t),output:t=>m(t)}}],defaultPattern:`X${f}, Y${f}`,viewModel:null}),new M({name:"mgrs",coordinateSegments:[{alias:"Z",description:"grid zone",searchPattern:/\d{1,2}\w|[abyz]/i},{alias:"S",description:"grid square",searchPattern:/\w{2}/},{alias:"X",description:"easting",searchPattern:/^\d{5}(?=.?\d{5}$)|^\d{4}(?=.?\d{4}$)|^\d{3}(?=.?\d{3}$)|^\d{2}(?=.?\d{2}$)|^\d(?=.?\d$)/},{alias:"Y",description:"northing",searchPattern:/^\d{1,5}/}],defaultPattern:"Z S X Y",viewModel:null}),new M({name:"usng",coordinateSegments:[{alias:"Z",description:"grid zone",searchPattern:/\d{1,2}\w|[abyz]/i},{alias:"S",description:"grid square",searchPattern:/\w{2}/},{alias:"X",description:"easting",searchPattern:/^\d{5}(?=.?\d{5}$)|^\d{4}(?=.?\d{4}$)|^\d{3}(?=.?\d{3}$)|^\d{2}(?=.?\d{2}$)|^\d(?=.?\d$)/},{alias:"Y",description:"northing",searchPattern:/^\d{1,5}/}],defaultPattern:"Z S X Y",viewModel:null}),new M({name:"utm",coordinateSegments:[{alias:"Z",description:"zone number",searchPattern:/\d{1,2}|[abyz]/i},{alias:"B",description:"latitude band",searchPattern:/^\D/},{alias:"X",description:"easting",searchPattern:/\d{1,7}(?=\s*\d{7}$)/},{alias:"Y",description:"northing",searchPattern:/\d{1,7}/}],defaultPattern:"ZB X Y",viewModel:null})]}function m(e){const i=e.match(Ht),t=i?i[0]:"",o=e.includes(".")?e.split(".")[1].length:0;return t+Mt(Number(e),{pattern:"###0.###",places:o,round:-1})}function v(e){return Et(e)}const Y={default:"default",crosshair:"crosshair"},zt=new q([0,0,500]),jt="xy",Zt=["mgrs","utm","usng","dd","dms","ddm"],ot="esri__coordinateConversionWidgetState",x={conversions:"conversions",formats:"formats",view:"view",viewChange:"view-change"},Jt="esri/images/search/search-symbol-32.png";let y=class extends Ot(pt.EventedAccessor){constructor(i){super(i),this._conversionPromise=null,this._locationGraphic=null,this._pointerCount=0,this.conversions=new W,this.formats=new W,this.formatterAvailable=!1,this.messages=null,this.filteredFormats=new W,this.locationSymbol=new xt({url:_t(Jt),width:24,height:24}),this.storageEnabled=!0,this.storageType="session",this.view=null,this._saveWidgetState=this._saveWidgetState.bind(this),this._handleFormatChange=this._handleFormatChange.bind(this),this._handleConversionChange=this._handleConversionChange.bind(this),this._handleViewChange=this._handleViewChange.bind(this),this._onClick=this._onClick.bind(this),this._onPointerMove=this._onPointerMove.bind(this),this._onPointerDown=this._onPointerDown.bind(this),this._onPointerUp=this._onPointerUp.bind(this)}initialize(){const i=async()=>this.messages=await It("esri/widgets/CoordinateConversion/t9n/CoordinateConversion");this.formats.addMany(Ut()),i().then(()=>{if(!this.destroyed&&(it(this.messages,this.formats),this.storageEnabled&&this._loadWidgetState(),this.formats.forEach(t=>{t.viewModel=this,this.addHandles(j(()=>t.currentPattern,this._saveWidgetState),t.name??"unnamed-format")}),this.addHandles(this.conversions.on("change",this._handleConversionChange),x.conversions),this.addHandles(this.formats.on("change",this._handleFormatChange),x.formats),this.addHandles(Tt(()=>{i().then(()=>{it(this.messages,this.formats)})})),St().then(()=>{this.formatterAvailable=!0}).catch(t=>{B.getLogger(this).error(new S("coordinate-conversion:projection-load-failed","Failed to load the projection module.",{error:t})),this.formatterAvailable=!1,this._filterFormatsAndConversions()}).then(()=>this.addHandles(j(()=>this.view,this._handleViewChange,ft),x.viewChange)),this.conversions.length===0)){const t=this.formats.find(o=>o.name===jt)||this.formats.at(0);this.conversions.add(new k({format:t}))}})}destroy(){this.removeHandles(),this._cleanUpView(this.view),this.view=null}castConversions(i){return this._castToConversions(i)}set currentLocation(i){this._set("currentLocation",i),this._updateConversions()}get currentLocation(){return this._get("currentLocation")||null}set mode(i){switch(i){case"capture":this.currentLocation=null,this._startCaptureMode(),this._set("mode",i);break;case"live":this._startLiveMode(),this._set("mode",i)}}get mode(){return this._get("mode")||"live"}get state(){const{messages:i,view:t}=this,o=t==null?void 0:t.ready;return i?o?"ready":t?"loading":"disabled":"disabled"}get storage(){const{storageType:i}=this;return i==="session"?sessionStorage:localStorage}get waitingForConversions(){return this._conversionPromise!=null}setLocation(i){var o,n;if(this._locationGraphic&&((o=this.view)==null||o.graphics.remove(this._locationGraphic)),!i)return;const t=i.clone();t.hasZ&&(t.z=void 0),this._locationGraphic=new bt({geometry:t,symbol:this.locationSymbol}),(n=this.view)==null||n.graphics.add(this._locationGraphic)}async convert(i,t){if(!J(t))throw new S("coordinate-conversion:invalid-point","Invalid point cannot be converted.",{point:t});return Promise.resolve().then(()=>i.convert(t))}async goToLocation(i){var r,l,p;const{view:t}=this;if(!t)throw new S("coordinate-conversion:go-to-failed","no view");const o=t.type==="3d"?t.clippingArea:null,n=(l=(r=t.map)==null?void 0:r.basemap)==null?void 0:l.baseLayers;if(o||(n==null?void 0:n.length)>0){const h=o??((p=n.at(0))==null?void 0:p.fullExtent);if(h!=null&&!h.contains(i))throw new S("coordinate-conversion:go-to-failed","Point outside basemap extent.",{point:i})}return this.callGoTo({target:i})}pause(){this.currentLocation=null,this.removeHandles(x.view),this.view&&(this.view.cursor=Y.default,this._locationGraphic&&this.view.graphics.remove(this._locationGraphic))}async previewConversion(i,t=this.currentLocation||zt){return(await nt(i,t)).displayCoordinate}resume(){this.mode==="capture"?this._startCaptureMode():this._startLiveMode()}reverseConvert(i,t){return t.reverseConvert(i)}async updateConversions(i,t){if((t==null?void 0:t.type)!=="point")throw this._clearConversions(this.conversions),new S("coordinate-conversion:invalid-input-point","Point is invalid, conversions cannot be updated.",{point:t});return this._convertMany(i,t)}_castToConversions(i){const t=new W;return i.forEach(o=>{let n=null;if(o instanceof k)n=o;else if(typeof o=="string"){const r=this.formats.find(l=>l.name===o);r&&(n=new k({format:r}))}n&&t.add(n)}),t}_cleanUpView(i){i&&(this._locationGraphic&&i.graphics.remove(this._locationGraphic),this.removeHandles(x.view),i.cursor=Y.default)}_clearConversions(i){i.forEach(t=>{t.position={location:null,coordinate:null}})}async _convertMany(i,t){return Promise.all(i.map(o=>nt(o,t)))}_handleConversionChange(i){for(const t of i.added){const{format:o}=t;o&&(o.viewModel=this,this.currentLocation&&(this._set("waitingForConversions",!0),this.convert(o,this.currentLocation).then(n=>{t.position=n,this._set("waitingForConversions",!1)})))}this._saveWidgetState()}_handleFormatChange(i){i.added.forEach(t=>{this.addHandles(j(()=>t.currentPattern,this._saveWidgetState),t.name??"unnamed-format"),t.viewModel=this}),i.removed.forEach(t=>{t.viewModel=null;const o=this.conversions.filter(n=>n.format===t);this.conversions.removeMany(o),t.name&&this.removeHandles(t.name)})}_loadWidgetState(){try{const i=JSON.parse(this.storage.getItem(ot));i&&this._setWidgetState(i)}catch(i){B.getLogger(this).error(new S("coordinate-conversion:invalid-session-storage-json","Could not read from storage.",{error:i}))}}_startCaptureMode(){this.removeHandles(x.view),this.view&&(this.view.cursor=Y.crosshair,this.currentLocation&&this.setLocation(this.currentLocation),this.addHandles(this.view.on("click",this._onClick),x.view))}_startLiveMode(){this._pointerCount=0,this.removeHandles(x.view),this.view&&(this.view.cursor=Y.default,this._locationGraphic&&this.view.graphics.remove(this._locationGraphic),this.addHandles([this.view.on("pointer-down",this._onPointerDown),this.view.on("pointer-up",this._onPointerUp),this.view.on("pointer-move",this._onPointerMove)],x.view))}_handleViewChange(i,t){t&&t!==i&&this._cleanUpView(t),i&&(this.mode==="capture"?this._startCaptureMode():this._startLiveMode(),t&&this._filterFormatsAndConversions())}_onClick(i){var t;if(i.button===0){const o=(t=this.view)==null?void 0:t.toMap(i),n=o==null?void 0:o.normalize();this.setLocation(n),this.currentLocation=n}}_onPointerDown(i){var o;const{pointerType:t}=i;if(this._pointerCount++,(t==="touch"||t==="pen")&&this._pointerCount===1){const n=(o=this.view)==null?void 0:o.toMap(i);this.currentLocation=n==null?void 0:n.normalize()}}_onPointerMove(i){var o;const{pointerType:t}=i;if(t==="mouse"||this._pointerCount===1){const n=(o=this.view)==null?void 0:o.toMap(i);this.currentLocation=n==null?void 0:n.normalize()}}_onPointerUp(){this._pointerCount--}_setWidgetState(i){try{i.formats.forEach(t=>{const o=this.formats.find(n=>n.name===t.name);o&&i.locale===Z()&&t.currentPattern&&(o.currentPattern=t.currentPattern),o&&t.index>=0&&this.conversions.add(new k({format:o}))})}catch(t){B.getLogger(this).warn(new S("coordinate-conversion:session-storage-read-error","Could not get widget state from stored JSON.",{error:t}))}}_saveWidgetState(){if(!this.storageEnabled)return;const i=this._toJSON();try{this.storage.setItem(ot,JSON.stringify({formats:i,locale:Z()}))}catch(t){B.getLogger(this).error(new S("coordinate-conversion:local-storage-write-error","Could not write to localStorage.",{error:t}))}}async _updateConversions(){try{await this.updateConversions(this.conversions.toArray(),this.currentLocation)}catch{}}_toJSON(){return this.formats.filter(i=>{const t=i.name;return t==="xy"||t==="basemap"||Nt(t)}).map(i=>({name:i.name,currentPattern:i.currentPattern,defaultPattern:i.defaultPattern,index:this.conversions.findIndex(t=>t.format===i)})).sort((i,t)=>i.index-t.index).toArray()}_filterFormatsAndConversions(){const{formatterAvailable:i,conversions:t,formats:o}=this;i||this.addHandles(wt(()=>{var n;return(n=this.view)==null?void 0:n.spatialReference},n=>{const r=n.isWebMercator||n.isWGS84,l=o.filter(b=>{const{name:w}=b;return!!qt(w)||w==="xy"&&!r}),p=this.filteredFormats.filter(b=>b.name==="xy"&&r&&!this.formats.includes(b)),h=t.filter(b=>l.includes(b.format));o.removeMany(l),t.removeMany(h),this.filteredFormats.addMany(l.filter(b=>!this.filteredFormats.includes(b))),o.addMany(p)},{once:!0,initial:!0}),x.view)}};async function nt(e,i){var t;try{e.position=await((t=e.format)==null?void 0:t.convert(i))}catch{e.position=null}return e}function qt(e){return Zt.includes(e)}a([c()],y.prototype,"conversions",void 0),a([lt("conversions")],y.prototype,"castConversions",null),a([c({type:q})],y.prototype,"currentLocation",null),a([c()],y.prototype,"formats",void 0),a([c()],y.prototype,"messages",void 0),a([c()],y.prototype,"mode",null),a([c()],y.prototype,"filteredFormats",void 0),a([c({readOnly:!0})],y.prototype,"state",null),a([c()],y.prototype,"locationSymbol",void 0),a([c({readOnly:!0,dependsOn:["storageType"]})],y.prototype,"storage",null),a([c()],y.prototype,"storageEnabled",void 0),a([c()],y.prototype,"storageType",void 0),a([c({readOnly:!0})],y.prototype,"waitingForConversions",null),a([c()],y.prototype,"view",void 0),y=a([U("esri.widgets.CoordinateConversion.CoordinateConversionViewModel")],y);const ut=y,_="esri-coordinate-conversion",u={base:_,captureMode:`${_}--capture-mode`,noBasemap:`${_}--no-basemap`,popup:`${_}__popup`,clipboardPopup:`${_}__clipboard-popup`,conversionList:`${_}__conversion-list`,conversionRow:`${_}__row`,coordDisplay:`${_}__display`,expandButton:`${_}__expand-button`,expanded:`${_}__conversions-view--expanded`,expandDown:`${_}__conversions-view--expand-down`,expandUp:`${_}__conversions-view--expand-up`,conversionsView:`${_}__conversions-view`,rowSelect:`${_}__select-row`,toolDisplay:`${_}__tools`,modeToggle:`${_}__mode-toggle`,rowButton:`${_}__row-button`,coordinateInput:`${_}__input-coordinate`,inputForm:`${_}__input-form`,inputFormGroup:`${_}__input-group`,inputSelect:`${_}__input-select`,sectionHeading:`${_}__heading`,patternInput:`${_}__pattern-input`,settings:`${_}__settings`,settingsFormGroup:`${_}__settings-group`,settingsFormGroupHorizontal:`${_}__settings-group-horizontal`,previewCoordinate:`${_}__preview-coordinate`},st={settingsButton:!0,inputButton:!0,captureButton:!0,expandButton:!0},Kt=750,Qt=2500;let g=class extends mt{constructor(e,i){super(e,i),this._popupMessage=null,this._popupTimeoutId=void 0,this._clipboardPopupTimeoutId=void 0,this._coordinateInput=null,this._badInput=!1,this._goToEnabled=!1,this._conversionFormat=null,this._settingsFormat=null,this._previewConversion=null,this._expanded=!1,this._clipboardPopupVisible=!1,this._popupVisible=!1,this._settingsVisible=!1,this._inputVisible=!1,this.headingLevel=4,this.messages=null,this.messagesCommon=null,this.orientation="auto",this.viewModel=new ut,this.visibleElements={...st}}loadDependencies(){return vt({button:()=>R(()=>import("./calcite-button-D_QRw8fR.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]),import.meta.url),checkbox:()=>R(()=>import("./calcite-checkbox-y1r16Xxb.js"),__vite__mapDeps([27,2,3,4,5,6,7,8,9,10,11,12,13,14,16,15,17,22,18,19,20]),import.meta.url),input:()=>R(()=>import("./calcite-input-EEDQOvVg.js"),__vite__mapDeps([28,29,2,3,4,5,6,7,8,9,10,11,12,13,14,16,15,17,22,18,19,20,21,23,24,30,31,25,32,33]),import.meta.url),label:()=>R(()=>import("./calcite-label-CI84R5fD.js"),__vite__mapDeps([34,2,3,4,5,6,7,8,9,10,11,12,13,14,18,16,19]),import.meta.url),option:()=>R(()=>import("./calcite-option-CkcBseNz.js"),__vite__mapDeps([35,2,3,4,5,6,7,8,9,10,11,12,13,14,23]),import.meta.url),select:()=>R(()=>import("./calcite-select-PMbeJemP.js"),__vite__mapDeps([36,2,3,4,5,6,7,8,9,10,11,12,13,14,16,15,17,18,19,20,23,30,25,32]),import.meta.url)})}get conversions(){return this.viewModel.conversions}set conversions(e){this.viewModel.conversions=e}get currentLocation(){return this.viewModel.currentLocation}set currentLocation(e){this.viewModel.currentLocation=e}get formats(){return this.viewModel.formats}set formats(e){this.viewModel.formats=e}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get icon(){return"coordinate-system"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get mode(){return this.viewModel.mode}set mode(e){this.viewModel.mode=e}set multipleConversions(e){e===!1&&(this._expanded=!1,this.conversions.splice(1,this.conversions.length-1)),this._set("multipleConversions",e)}get multipleConversions(){const e=this._get("multipleConversions");return typeof e!="boolean"||e}get locationSymbol(){return this.viewModel.locationSymbol}set locationSymbol(e){this.viewModel.locationSymbol=e}get storageEnabled(){return this.viewModel.storageEnabled}set storageEnabled(e){this.viewModel.storageEnabled=e}get storageType(){return this.viewModel.storageType}set storageType(e){this.viewModel.storageType=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}castVisibleElements(e){return{...st,...e}}reverseConvert(e,i){return this.viewModel.reverseConvert(e,i)}render(){var p,h;const e=(p=this.viewModel)==null?void 0:p.state,i=e==="disabled"?d("div",{key:"esri-coordinate__no-basemap"},(h=this.messages)==null?void 0:h.noBasemap):null,t=!i&&this._inputVisible?this._renderInputForm():null,o=!i&&this._settingsVisible?this._renderSettings():null,n=i||t||o?null:this._renderConversionsView(),r=this._popupVisible?this._renderPopup():null,l={[u.captureMode]:this.mode==="capture",[O.disabled]:e==="loading",[u.noBasemap]:e==="disabled"};return d("div",{class:this.classes(u.base,O.widget,l)},r,i,n,o,t)}_addConversion(e){const i=e.target,t=i.selectedOption.value,o=rt(i);if(t==null||o==null)return;const n=new k({format:t});i.value="default",o>=0?(this.conversions.removeAt(o),this.conversions.add(n,o)):this.conversions.add(n)}_findSettingsFormat(){return this._settingsFormat||this.conversions.reduceRight((e,i)=>{const t=i.format;return t!=null&&t.hasDisplayProperties?t:e},null)||this.formats.find(e=>e.hasDisplayProperties)}_hidePopup(){this._popupTimeoutId&&(clearTimeout(this._popupTimeoutId),this._popupTimeoutId=void 0),this._popupVisible=!1,this._popupMessage=null,this.scheduleRender()}_hideClipboardPopup(){this._clipboardPopupTimeoutId&&(clearTimeout(this._clipboardPopupTimeoutId),this._clipboardPopupTimeoutId=void 0),this._clipboardPopupVisible=!1,this.scheduleRender()}_onConvertComplete(){this._inputVisible=!1,this._coordinateInput.value=""}_onCopy(e){var t,o;const i=(t=te(e.currentTarget))==null?void 0:t.displayCoordinate;i!=null&&((o=e.clipboardData)==null||o.setData("text/plain",i),this._showClipboardPopup(),e.preventDefault())}_processUserInput(e){const i=ht(e,"key"),t=this.viewModel;if(i!=="Enter"&&i)this._badInput&&(this._badInput=!1);else{const o=this._conversionFormat||this.conversions.at(0).format;if(!o)return;const n=this._coordinateInput.value;this._reverseConvert(n,o).then(r=>{this.mode==="capture"?t.resume():this.mode="capture",this.currentLocation=r,t.setLocation(r),this._onConvertComplete()}).catch(r=>{var l;B.getLogger(this).error(r),this._showPopup((l=this.messages)==null?void 0:l.invalidCoordinate),this._badInput=!0})}}async _reverseConvert(e,i){const t=this.viewModel,o=await i.reverseConvert(e);return this._goToEnabled&&o&&t.goToLocation(o).catch(n=>{var r;B.getLogger(this).warn(n),this._showPopup((r=this.messages)==null?void 0:r.locationOffBasemap)}),o}_setInputFormat(e){const i=e.target.selectedOption.value;i!=null&&(this._conversionFormat=i)}_setPreviewConversion(){var t,o;const e=this._findSettingsFormat(),i=this.viewModel;if(e){const n=this.conversions.find(r=>r.format===e);this._previewConversion=new k({format:e,position:{location:this.currentLocation,coordinate:(t=n==null?void 0:n.position)==null?void 0:t.coordinate}}),(o=this._previewConversion.position)!=null&&o.coordinate||i.previewConversion(this._previewConversion)}}_setSettingsFormat(e){const i=e.target.selectedOption.value;i!=null&&(this._settingsFormat=i,this._setPreviewConversion())}_showClipboardPopup(){this._clipboardPopupVisible?clearTimeout(this._clipboardPopupTimeoutId):this._clipboardPopupVisible=!0,this.scheduleRender(),this._popupTimeoutId=setTimeout(()=>{this._popupTimeoutId=void 0,this._hideClipboardPopup()},Kt)}_showPopup(e,i=Qt){this._popupMessage=e,this._popupVisible?clearTimeout(this._popupTimeoutId):this._popupVisible=!0,this.scheduleRender(),this._popupTimeoutId=setTimeout(()=>{this._popupTimeoutId=void 0,this._hidePopup()},i)}_toggleGoTo(){this._goToEnabled=!this._goToEnabled}_updateCurrentPattern(e){e.stopPropagation();const i=e.target,t=this._findSettingsFormat();t&&(t.currentPattern=i.value)}_renderConversion(e,i){const{messages:t}=this;if(!t)return d("li",null);const{format:o}=e,n=(o==null?void 0:o.label)??"",r=`${this.id}__list-item-${i}`,l=`${n} ${t.conversionOutputSuffix}`,p=i===0,h=p||this._expanded,b=p?this._renderFirstConversion(e):this._renderTools(i,e,r),w=p&&!e.displayCoordinate?t.noLocation:e.displayCoordinate,E=d("div",{"aria-label":w,class:u.coordDisplay,"data-conversion":e,role:"listitem",tabIndex:0,title:w??""},w),D=this._renderOptions(this.formats.filter(A=>A!==o));return h?d("li",{"aria-label":l,class:u.conversionRow,id:r,key:e,role:"group",tabIndex:0,title:l},d("calcite-select",{"aria-controls":r,bind:this,class:u.rowSelect,"data-index":i,label:t.selectFormat,scale:"s",onCalciteSelectChange:this._addConversion},d("calcite-option",{label:n.toUpperCase(),selected:!0},n.toUpperCase()),D),E,b):null}_renderCopyButton(e){const i=this._clipboardPopupVisible&&this._renderClipboardPopup(),{messagesCommon:t}=this;return t?d("li",{"aria-label":t.copy,bind:this,class:this.classes(O.widgetButton,u.rowButton),"data-conversion":e,onclick:this._copyCoordinateOutput,oncopy:this._onCopy,onkeydown:this._copyCoordinateOutput,role:"button",tabIndex:0,title:t.copy},i,d("span",{"aria-hidden":"true",class:Gt.duplicate})):d("li",null)}_renderFirstConversion(e){const i=this.id,{messages:t,messagesCommon:o,multipleConversions:n,visibleElements:r}=this;if(!o||!t)return d("ul",null);const l=this.mode==="live"?t.captureMode:t.liveMode,p=this._expanded?o.collapse:o.expand,h=e.displayCoordinate&&this.mode==="capture"?this._renderCopyButton(e):null,b=n&&r.expandButton&&this._renderIconButton({iconType:this._expanded?"chevron-down":"chevron-up",clickFunction:this._toggleExpand,classes:[u.expandButton],attributes:{"aria-controls":`${i}__${u.conversionList}`,label:p}}),w=!n&&r.captureButton&&this._renderIconButton({iconType:this.mode==="live"?"pin-tear":"pin-tear-f",clickFunction:this._toggleMode,classes:[u.modeToggle],attributes:{label:l}});return d("ul",{class:u.toolDisplay},h,b,w)}_renderInputForm(){const e=this._conversionFormat||this.conversions.at(0).format,i=this.formats.findIndex(w=>w.name===(e==null?void 0:e.name)),t=this.id,o=`${t}__${u.coordinateInput}`,n=`${t}__${u.coordinateInput}__header`,r=this._renderOptions(this.formats,!0,i),{messages:l,messagesCommon:p,headingLevel:h}=this;if(!p||!l)return d("div",null);const b=this._renderIconButton({iconType:Q(this.container)?"arrow-right":"arrow-left",clickFunction:this._toggleInputVisibility,attributes:{label:p.back}});return d("div",{"aria-labelledby":n,class:u.inputForm,key:"esri-coordinate-conversion__input-form",role:"search"},d("div",{class:u.sectionHeading},b,d(tt,{class:O.heading,id:n,level:h},l.inputCoordTitle)),d("div",{class:u.inputFormGroup},d("calcite-select",{"aria-controls":o,bind:this,class:u.inputSelect,label:l.selectFormat,scale:"s",onCalciteSelectChange:this._setInputFormat},r),d("calcite-input",{afterCreate:gt,"aria-labelledby":n,bind:this,class:u.coordinateInput,"data-format":e,"data-node-ref":"_coordinateInput",id:o,onkeydown:this._processUserInput,placeholder:l.inputCoordTitle,required:!0,scale:"s",spellcheck:!1,status:this._badInput?"invalid":"idle"})),d("div",{class:u.inputFormGroup},d("calcite-label",{layout:"inline",scale:"s"},d("calcite-checkbox",{bind:this,checked:this._goToEnabled,onCalciteCheckboxChange:this._toggleGoTo}),l.goTo),d("calcite-button",{appearance:"outline",bind:this,kind:"neutral",onclick:this._processUserInput,type:"button",width:"auto"},l.convert)))}_renderConversionsView(){const{messages:e}=this;if(!e)return d("div",null);const i=`${this.id}__${u.conversionList}`,t=this._renderPrimaryTools(),o=this._renderOptions(this.formats),n=this.conversions.map((p,h)=>this._renderConversion(p,h)).toArray(),r=this._expanded?d("div",{class:u.conversionRow},d("calcite-select",{"aria-controls":i,bind:this,"data-index":-1,label:e.addConversion,scale:"s",onCalciteSelectChange:this._addConversion},d("calcite-option",{disabled:!0,selected:!0,value:"default"},e.addConversion),o),t):null,l={[u.expanded]:this._expanded,[u.expandUp]:this.orientation==="expand-up",[u.expandDown]:this.orientation==="expand-down"};return d("div",{class:this.classes(u.conversionsView,l),key:"esri-coordinate-conversion__main-view"},d("ul",{"aria-expanded":this._expanded?"true":"false",class:u.conversionList,id:i},n),r)}_renderOptions(e,i,t){var r;const o=this.conversions.at(0),n=(r=o.format)==null?void 0:r.name;return e.map((l,p)=>{const h=!(i||!o)&&(n===l.name||this.conversions.map(b=>{var w;return(w=b.format)==null?void 0:w.name}).includes(l.name));return d("calcite-option",{disabled:h,key:l.name??"unnamed-format",label:l.label.toUpperCase(),selected:p===t,value:l},l.label)}).toArray()}_renderPopup(){return d("div",{class:u.popup,role:"alert"},this._popupMessage)}_renderClipboardPopup(){const{messages:e}=this;return e?d("div",{class:this.classes(u.popup,u.clipboardPopup),role:"alert"},e.copySuccessMessage):d("div",null)}_renderPrimaryTools(){const{messages:e,visibleElements:i}=this;if(!e)return d("ul",null);const t=this.mode==="live"?e.captureMode:e.liveMode,o=i.inputButton&&this._renderIconButton({iconType:"pencil",clickFunction:this._toggleInputVisibility,attributes:{label:e.inputCoordTitle}}),n=i.captureButton&&this._renderIconButton({iconType:this.mode==="live"?"pin-tear":"pin-tear-f",clickFunction:this._toggleMode,classes:[u.modeToggle],attributes:{label:t}}),r=i.settingsButton&&this._renderIconButton({iconType:"gear",clickFunction:this._toggleSettingsVisibility,attributes:{label:e.settingsTitle}});return d("ul",{class:u.toolDisplay},o,n,r)}_renderSettings(){var G;const e=this.id,i=`${e}__${u.patternInput}`,t=`${e}__${u.patternInput}__header`,o=`${e}__${u.previewCoordinate}`,n=this.formats.filter($=>$.hasDisplayProperties),r=this._findSettingsFormat(),l=r?n.indexOf(r):-1,p=this._renderOptions(n,!0,l),h=r==null?void 0:r.currentPattern,{messages:b,messagesCommon:w,headingLevel:E}=this;if(!w||!b)return d("div",null);const D=this._renderIconButton({iconType:Q(this.container)?"arrow-right":"arrow-left",clickFunction:this._toggleSettingsVisibility,attributes:{label:w.back}}),A=this._renderIconButton({iconType:"refresh",clickFunction:this._setDefaultPattern,attributes:{label:b.defaultPattern}});return d("div",{"aria-labelledby":t,class:u.settings,key:u.settings},d("div",{class:u.sectionHeading},D,d(tt,{class:O.heading,id:t,level:E},b.settingsTitle)),d("div",{class:u.settingsFormGroup},d("label",{for:i},b.changeCoordinateDisplay),d("calcite-select",{bind:this,label:b.selectFormat,width:"full",onCalciteSelectChange:this._setSettingsFormat},p),d("div",{class:u.settingsFormGroupHorizontal},d("calcite-input",{"aria-controls":o,bind:this,class:u.patternInput,id:i,spellcheck:!1,type:"text",value:h,onCalciteInputInput:this._updateCurrentPattern}),A)),d("div",{class:u.settingsFormGroup},d("label",null,w.preview,d("div",{class:u.previewCoordinate,id:o,tabIndex:0},(G=this._previewConversion)==null?void 0:G.displayCoordinate))))}_renderIconButton(e){const{iconType:i,clickFunction:t,classes:o,attributes:n}=e;return d("calcite-button",{appearance:"transparent",bind:this,class:this.classes(o),iconStart:i,kind:"neutral",onclick:t,onkeydown:t,...n})}_renderTools(e,i,t){const o=i.displayCoordinate&&this.mode==="capture"?this._renderCopyButton(i):null,{messages:n}=this;if(!n)return d("ul",null);const r=this._renderIconButton({iconType:"x",clickFunction:this._removeConversion,attributes:{"aria-controls":t,label:n.removeConversion,"data-index":e}});return d("ul",{class:u.toolDisplay,role:"listitem"},o,d("li",{class:this.classes(u.rowButton)},r))}_copyCoordinateOutput(e){const i=e.target;if(!("createTextRange"in document.body)){const t=window.getSelection(),o=document.createRange();o.selectNodeContents(i),t==null||t.removeAllRanges(),t==null||t.addRange(o)}document.execCommand("copy")}_removeConversion(e){const i=rt(e.currentTarget);i!=null&&this.conversions.removeAt(i)}_setDefaultPattern(e){e.stopPropagation();const i=this._findSettingsFormat();i&&(i.currentPattern=i.defaultPattern)}_toggleExpand(){this._expanded=!this._expanded}_toggleInputVisibility(){this._inputVisible=!this._inputVisible,this._popupVisible&&this._hidePopup(),this._inputVisible?this.viewModel.pause():this.viewModel.resume()}_toggleMode(){this.mode=this.mode==="live"?"capture":"live"}_toggleSettingsVisibility(){this._settingsVisible=!this._settingsVisible,this._popupVisible&&this._hidePopup(),this._settingsVisible?(this._setPreviewConversion(),this.viewModel.pause()):this.viewModel.resume()}};a([c()],g.prototype,"conversions",null),a([c()],g.prototype,"currentLocation",null),a([c()],g.prototype,"formats",null),a([c()],g.prototype,"goToOverride",null),a([c()],g.prototype,"headingLevel",void 0),a([c()],g.prototype,"icon",null),a([c()],g.prototype,"label",null),a([c(),K("esri/widgets/CoordinateConversion/t9n/CoordinateConversion")],g.prototype,"messages",void 0),a([c(),K("esri/t9n/common")],g.prototype,"messagesCommon",void 0),a([c()],g.prototype,"mode",null),a([c()],g.prototype,"orientation",void 0),a([c()],g.prototype,"multipleConversions",null),a([c()],g.prototype,"locationSymbol",null),a([c()],g.prototype,"storageEnabled",null),a([c()],g.prototype,"storageType",null),a([c()],g.prototype,"view",null),a([c({type:ut})],g.prototype,"viewModel",void 0),a([c()],g.prototype,"visibleElements",void 0),a([lt("visibleElements")],g.prototype,"castVisibleElements",null),a([T()],g.prototype,"_copyCoordinateOutput",null),a([T()],g.prototype,"_removeConversion",null),a([T()],g.prototype,"_setDefaultPattern",null),a([T()],g.prototype,"_toggleExpand",null),a([T()],g.prototype,"_toggleInputVisibility",null),a([T()],g.prototype,"_toggleMode",null),a([T()],g.prototype,"_toggleSettingsVisibility",null),g=a([U("esri.widgets.CoordinateConversion")],g);const Je=g;function rt(e){return e["data-index"]}function te(e){return e["data-conversion"]}export{Je as default};
