import{h as f}from"./subclass-BR3PhgZG.js";import{h as a}from"./PooledRBush-CGlhTzFe.js";import{i as u}from"./MeshLocalVertexSpace-sBjAuOT3.js";import{M as l}from"./vertexSpaceConversion-CtySDdI9.js";import"./Accessor-D6mNnsWy.js";import"./quickselect-D0_cvEX6.js";import"./_commonjsHelpers-DCkdB7M8.js";import"./Evented-CXIxDjmW.js";import"./Clonable-cKbRam6-.js";import"./assets-BNizZMOZ.js";import"./index-BVncS3aY.js";import"./enumeration--HlxOQ_N.js";import"./jsonMap-DCC6W5ex.js";import"./mathUtils-ClvKsMak.js";import"./Point-TlcsOcXV.js";import"./writer-3zufXUNV.js";import"./mat3-DRqs2t5W.js";import"./mat3f64-BBpwCtoL.js";import"./mat4-ybYUU6jq.js";import"./mat4f64-Dk4dwAN8.js";import"./spatialReferenceEllipsoidUtils-DuE2W35w.js";import"./computeTranslationToOriginAndRotation-CFxYfzBj.js";import"./projectBuffer-iyGwL2dv.js";import"./geodesicConstants-kj1AtlGg.js";import"./projectPointToVector-C-hGM2ap.js";import"./projection-tSh-0UvX.js";import"./reactiveUtils-BFQ0BtrB.js";import"./shared-B3wH2qpO.js";import"./Extent-B4rrMrqp.js";import"./Polyline-BQFeqYXi.js";import"./meshVertexSpaceUtils-BfF6O78E.js";import"./vec3-C3Q-RF_i.js";import"./projection-CODyCdLE.js";import"./DoubleArray-CF_CpVBS.js";import"./BufferView-B7Z-dzh4.js";import"./vec2-B_ymkwGp.js";import"./vec42-B1mBkh1w.js";import"./vec4-L9zJLV3y.js";class rt{async createIndex(r,o){var m;const i=new Array;if(!((m=r.vertexAttributes)!=null&&m.position))return new a;const n=d(r),e=o!=null?await o.invoke("createIndexThread",n,{transferList:i}):this.createIndexThread(n).result;return s().fromJSON(e)}createIndexThread(r){const o=s();if(!r)return{result:o.toJSON()};const i=new Float64Array(r.position);return r.components?h(o,i,r.components.map(n=>new Uint32Array(n))):x(o,i)}}function x(t,r){const o=new Array(r.length/9);let i=0;for(let n=0;n<r.length;n+=9)o[i++]=c(r,n,n+3,n+6);return t.load(o),{result:t.toJSON()}}function h(t,r,o){let i=0;for(const m of o)i+=m.length/3;const n=new Array(i);let e=0;for(const m of o)for(let p=0;p<m.length;p+=3)n[e++]=c(r,3*m[p],3*m[p+1],3*m[p+2]);return t.load(n),{result:t.toJSON()}}function d(t){var m;const{vertexAttributes:{position:r},vertexSpace:o,spatialReference:i,transform:n}=t,e=(m=l({vertexAttributes:{position:r},vertexSpace:o,spatialReference:i,transform:n},new u,{allowBufferReuse:!0}))==null?void 0:m.position;return e?!t.components||t.components.some(p=>!p.faces)?{position:e.buffer}:{position:e.buffer,components:t.components.map(p=>p.faces)}:null}function s(){return new a(9,f("esri-csp-restrictions")?t=>t:[".minX",".minY",".maxX",".maxY"])}function c(t,r,o,i){return{minX:Math.min(t[r],t[o],t[i]),maxX:Math.max(t[r],t[o],t[i]),minY:Math.min(t[r+1],t[o+1],t[i+1]),maxY:Math.max(t[r+1],t[o+1],t[i+1]),p0:[t[r],t[r+1],t[r+2]],p1:[t[o],t[o+1],t[o+2]],p2:[t[i],t[i+1],t[i+2]]}}export{rt as default};
