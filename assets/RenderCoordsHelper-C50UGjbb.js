import{M as $}from"./mathUtils-C4_ghTv4.js";import{g as x,i as _,z as R,X as h}from"./Point-Cg0-ChZE.js";import{n as M,r as b}from"./mat4-GpOFENPA.js";import{o as B,P as f,s as m,A as G,_ as S}from"./vec32-Dvg_eL9J.js";import{a as g}from"./spatialReferenceEllipsoidUtils-DBE_OFra.js";import{c as E}from"./projectPointToVector-GINIbYMz.js";import{t as k}from"./projectVectorToPoint-DcLtSZYw.js";import{n as y}from"./projectVectorToVector-G2uWGoIb.js";import{n as c,b as z}from"./Polyline-D9YkgmM_.js";import{n as P}from"./vec3f64-BLpZdpfb.js";import{J as U,k as Z}from"./boundedPlane-EV1sS2Ke.js";import{V as F,f as I}from"./sphere-C77djCO6.js";import{c as s,u as L,x as O}from"./plane-IENfwZlB.js";import{t as A}from"./dehydratedFeatureUtils-B--Sgpdi.js";import{l as u}from"./ViewingMode-Dodu7ZZk.js";function T(r){const{value:t,operations:e}=r;return{operations:e,value:e.create(t)}}function V(r,t,e){return r.operations.setExtent(r.value,t,e.value),e}function X(r,t){return r.operations.getExtent(r.value,t),t}function Y(r){return{operations:r,value:r.create()}}function w(r,t,e=Y(r)){return e.operations=r,r.copy(t,e.value),e}function j(r){return w(I,F(0,0,0,_(r).radius))}const v=2**50;function q(){return w(Z,U([0,0,0],[v,0,0],[0,v,0]))}function D(r,t,e){return r.operations.axisAt(r.value,t,c.Z,e)}function J(r,t,e,o){return r.operations.axisAt(r.value,t,e,o)}function H(r,t,e){return r.operations.intersectRay(r.value,t,e)}function K(r,t,e){return r.operations.intersectRayClosestSilhouette(r.value,t,e)}function N(r,t){return r.operations.altitudeAt(r.value,t)}function C(r,t,e,o){return r.operations.setAltitudeAt(r.value,t,e,o)}function Q(r,t,e,o){return t!==o&&M(o,t),B(a,o[12],o[13],o[14]),C(r,a,e,a),o[12]=a[0],o[13]=a[1],o[14]=a[2],o}function p(r,t,e){return r.operations.elevate(r.value,t,e.value)}const a=P();function dt(r,t,e,o,n){return n[0]=f(r,t),n[1]=f(r,e),n[2]=f(r,o),n}function ht(r,t,e,o,n){m(e,r),m(l,t),G(l,l),S(o,l,e),S(n,o,e)}function St(r,t){return r?g(t):t.isGeographic?x.PlateCarree:t}const l=P();class d{constructor(t,e,o,n){this.viewingMode=t,this.spatialReference=e,this.unitInMeters=o,this._coordinateSystem=n,this._tmpCoordinateSystem=T(n),this.referenceEllipsoid=_(e),this.sphericalPCPF=g(e)}set extent(t){t&&V(this._coordinateSystem,t,this._coordinateSystem)}get extent(){return X(this._coordinateSystem,z())}getAltitude(t){return N(this._coordinateSystem,t)}setAltitude(t,e,o=t){return C(this._coordinateSystem,o,e,t)}setAltitudeOfTransformation(t,e){Q(this._coordinateSystem,e,t,e)}worldUpAtPosition(t,e){return D(this._coordinateSystem,t,e)}worldBasisAtPosition(t,e,o){return J(this._coordinateSystem,t,e,o)}basisMatrixAtPosition(t,e){const o=this.worldBasisAtPosition(t,c.X,s.get()),n=this.worldBasisAtPosition(t,c.Y,s.get()),i=this.worldBasisAtPosition(t,c.Z,s.get());return b(e,o[0],o[1],o[2],0,n[0],n[1],n[2],0,i[0],i[1],i[2],0,0,0,0,1),e}headingAtPosition(t,e){const o=this.worldUpAtPosition(t,s.get()),n=this.worldBasisAtPosition(t,c.Y,s.get()),i=L(e,n,o);return $(i)}intersectManifoldClosestSilhouette(t,e,o){return p(this._coordinateSystem,e,this._tmpCoordinateSystem),K(this._tmpCoordinateSystem,t,o),o}intersectManifold(t,e,o){p(this._coordinateSystem,e,this._tmpCoordinateSystem);const n=s.get();return H(this._tmpCoordinateSystem,t,n)?m(o,n):null}intersectInfiniteManifold(t,e,o){if(this.viewingMode===u.Global)return this.intersectManifold(t,e,o);p(this._coordinateSystem,e,this._tmpCoordinateSystem);const n=this._tmpCoordinateSystem.value,i=s.get();return O(n.plane,t,i)?m(o,i):null}toRenderCoords(t,e,o){return A(t)?E(t,e,this.spatialReference):y(t,e,o,this.spatialReference)}fromRenderCoords(t,e,o=null){return A(e)?(o!=null&&(e.spatialReference=o),k(t,this.spatialReference,e)?e:null):y(t,this.spatialReference,e,o)?e:null}static create(t,e){switch(t){case u.Local:return new d(u.Local,e,R(e),q());case u.Global:return new d(u.Global,e,1,j(e))}}static renderUnitScaleFactor(t,e){return h(t)/h(e)}}export{d as B,St as a,dt as w,ht as z};
