const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./editingTools-DCvBiyJu.js","./tslib.es6-B3Jf3DVX.js","./geometry-D964gYQX.js","./subclass-BZA_h8Db.js","./Extent-Bf3YTe7m.js","./Point-Cg0-ChZE.js","./Accessor-BLX9ikPh.js","./cast-Bjksrh93.js","./writer-DNAwXnhG.js","./assets-C43MgM-v.js","./index-Bh2oEzTI.js","./index-2kwcjS9-.css","./jsonMap-0cxwUWs2.js","./Polyline-D9YkgmM_.js","./mathUtils-C4_ghTv4.js","./Graphic-DsxsIjhH.js","./PopupTemplate-BHMhS05j.js","./Clonable-D3rtuBWg.js","./Collection-CEdjem1-.js","./Evented-BHRw9x22.js","./shared-B3wH2qpO.js","./SimpleObservable-KocWTzVy.js","./fieldUtils-tmQlKvWo.js","./intl-CChhNOV8.js","./date-DlqISzcw.js","./locale-C9TlLpzi.js","./messages-OmQvZhAg.js","./enumeration-Ba5njXdz.js","./Color-BCS62Hs5.js","./colorUtils-0bJDPow9.js","./ActionToggle-iT4slXc7.js","./Identifiable-B1UbsKNt.js","./symbols-CNimns--.js","./TextSymbol-D8QO_KUV.js","./screenUtils-_ZIvrt5o.js","./materialUtils-DarhapKC.js","./opacityUtils-C68Tlu6_.js","./vec3f64-BLpZdpfb.js","./aaBoundingBox-BE7cC1jD.js","./persistableUrlUtils-fa1mAujs.js","./collectionUtils-D_lHIu88.js","./Portal-C10FKnaA.js","./Loadable-BabW5Xcc.js","./Promise-B2Hu02L7.js","./reactiveUtils-C5zUhJQJ.js","./asyncUtils-CWX51uTe.js","./jsonUtils-CEfjT-BK.js","./SnappingVisualizer2D-Br8KvMdL.js","./vec2-maR1OrZI.js","./common-DQOJ18NT.js","./vec2f64-miziP1SN.js","./enums-CmIX1y88.js","./SnappingManager-BJPyuu7J.js","./projection-B971H0Re.js","./projectBuffer-Bs7GwaPY.js","./geodesicConstants-DWQLYX7F.js","./elevationInfoUtils-BC_66_Fg.js","./unitConversionUtils-BMfW9yAe.js","./lengthUtils-DL1-FDQQ.js","./projectVectorToVector-G2uWGoIb.js","./projectPointToVector-GINIbYMz.js","./timeUtils-8fb_2oAt.js","./vec32-Dvg_eL9J.js","./Query-5Xpquc1r.js","./DataLayerSource-BKkswDvG.js","./Field-ybkHhtnK.js","./fieldType-BuzM0UHS.js","./FullTextSearch-Csd1Hktu.js","./TimeExtent-DocT5yPf.js","./InputManager-Ba9xzDpe.js","./Queue-yu3bZ02p.js","./signal-D4lghLjV.js","./keybindings-DoOdil3D.js","./utils-BpB3MnW1.js","./Version-BSlAgupz.js","./vec42-YcqnINSP.js","./vec4f64-o2zAXfmz.js","./geodesicUtils-FCYOaNwu.js","./plane-IENfwZlB.js","./mat3f64-BBpwCtoL.js","./mat4f64-Dk4dwAN8.js","./quatf64-CCm9z-pX.js","./mathUtils-BG-eq9fO.js","./sphere-C77djCO6.js","./mat4-GpOFENPA.js","./mat3-BRl2i9Bz.js","./geometry2dUtils-DdyQE7AQ.js","./viewUtils-DrPohWV3.js","./SnappingVisualizer-BtjTdiTG.js","./PointSnappingHint-D7X20mlb.js","./editPlaneUtils-DJAUpVXQ.js","./UpdatingHandles-GfwcIh5z.js","./coordinateFormatter-Bqv90CKy.js","./GraphicsLayer-i3FeUJ_n.js","./GraphicsCollection-FfahqxsR.js","./Layer-CVt7Hb5J.js","./BlendLayer-CXM4n_Ge.js","./jsonUtils-CSnQD004.js","./parser-CTsgEym6.js","./utils-93yNk4Xc.js","./mat4f32-DcsiF_Rp.js","./ScaleRangeLayer-Bb8Ig1Hz.js","./ElevationInfo-CA5m_tHv.js","./dehydratedFeatureComparison-06VFTqH5.js","./createUtils-ibzYx0GK.js","./Circle-BInHZHdw.js","./geometryEngine-DGiYLHJy.js","./geometryEngineBase-yFIvKOkM.js","./_commonjsHelpers-DCkdB7M8.js","./hydrated-C9rxSL4a.js","./surfaceCoordinateSystems-DhFxihAh.js","./memoize-DsJmrG76.js","./ReactiveSet-BU2iaegS.js","./diffUtils-BP7jmOAy.js","./ViewingMode-Dodu7ZZk.js","./EditGeometryOperations-Cl8Sbfxr.js","./compilerUtils-Dw3R0f-Z.js","./InteractiveToolBase-vg6J8uyT.js","./meshVertexSpaceUtils-CXzOFlTI.js","./MeshLocalVertexSpace-LEHwMUnu.js","./hydratedFeatures-DBKLr8hT.js","./interfaces-D6pIddIh.js","./quantityUtils-D0GB2dMc.js","./angularMeasurementUtils-7e2vxqzG.js","./Cyclical-oTUX3aX7.js","./SketchLabelOptions-DDQnGNSN.js","./SnappingContext-lR2hMWGP.js","./SnappingDragPipelineStep-rzVcndp8.js","./Scheduler-CJu5awNf.js","./debugFlags-BF6Z0j0F.js","./SnappingOperation-CaI4DIP4.js","./mat2d-D9DBP-jx.js","./mat2df64-CBKYtunK.js","./quat-4pa1e6ds.js","./helpMessageUtils-M95XMmyR.js","./helpMessageUtils3d-TaLw0ElD.js","./SketchTooltipInfo-BA57LzDt.js","./MeshTransform-D2t3aEmK.js","./axisAngleDegrees-Ci2HA7Jo.js","./themeUtils-C3zvZbsE.js","./jsxFactory-CJa39Fro.js","./uuid-fwrPAdZb.js","./a11yUtils-cyWndM8Q.js","./unitFormatUtils-CZ2bRlFg.js","./ByteSizeUnit-BsxeN7wM.js","./getDefaultUnitForView-Ce2vZZap.js","./quantityFormatUtils-CX8UdSzC.js","./spatialReferenceEllipsoidUtils-DBE_OFra.js","./directionModeIcons-Br5woIHu.js","./automaticAreaMeasurementUtils-12dUsEmf.js","./geodesicMeasurementUtils-Bt9h4589.js","./euclideanAreaMeasurementUtils-CfO9bFtV.js","./earcut-Lltz9D9k.js","./triangle-PTGDC_xJ.js","./lineSegment-D7sKPPYf.js","./geodesicAreaMeasurementUtils-BILXFcc4.js","./automaticLengthMeasurementUtils-BXgXm1JY.js","./geodesicLengthMeasurementUtils-he3vjGJN.js","./isSupportedObject-6I_Nw0mS.js","./boundedPlane-EV1sS2Ke.js","./cimSymbolUtils-DXvZxabN.js","./utils-D2PLyMFF.js","./GraphicManipulator-Dc-QfW2U.js","./defaults-DZ1kfMRx.js","./defaultsJSON-GKolV7NZ.js","./drapedUtils-HWKOCxgF.js","./colorUtils-aL8wj-8G.js","./drawUtils-D0InE6Wy.js","./hitTestSelectUtils-UXJPjatw.js","./screenUtils-WcqhHU65.js","./editingTools-COUq-DTn.js","./TextOverlayItem-zxgmE06K.js","./SnappingVisualizer3D-BL4wyEeI.js","./ExtendedLineVisualElement-BaVIzd5h.js","./frustum-CQrOepbv.js","./EngineVisualElement-DAbK0X3b.js","./RibbonLine.glsl-BZu1FDpE.js","./computeTranslationToOriginAndRotation-Q27G6TBL.js","./dehydratedFeatureUtils-B--Sgpdi.js","./intersectorUtils-BK9EUwUf.js","./verticalOffsetUtils-BDQLpfho.js","./orientedBoundingBox-DOAJUK5g.js","./ElevationProvider-C95wyCKc.js","./VertexAttribute-Cq4MnHjR.js","./Material-_xx7OZxD.js","./interfaces-DDtDqZYj.js","./Texture-Fac_8AOC.js","./BindType-BmZEZMMh.js","./Util-BIfApRF5.js","./Texture-Begq2x5n.js","./enums-D9v74xTE.js","./renderState-DQLu6AJX.js","./Matrix3DrawUniform-CiBFaSz6.js","./ShaderTechniqueConfiguration-CBbn2DCi.js","./Indices-DflDlU4Z.js","./AlphaCutoff-UcccL64p.js","./requestImageUtils-DgMiQwsm.js","./sdfPrimitives-CUWZbMRe.js","./vec3f32-nZdmKIgz.js","./doublePrecisionUtils-B0owpBza.js","./floatRGBA-CfH_2xsy.js","./Octree-C8d4sqjv.js","./InterleavedLayout-e-di2fxs.js","./BufferView-_QDXRCew.js","./Float4DrawUniform-N58YDhuZ.js","./MergedRenderer-Dli9s1X5.js","./VertexArrayObject-lPxPk5E-.js","./NestedMap-GuqgquCN.js","./glUtil-D0YUa0ow.js","./VertexElementDescriptor-BOD-G50G.js","./VisualElement-Bz1W-x8t.js","./LaserlineVisualElement-CUgS0u0n.js","./Blit-B-VutIER.js","./BufferObject-BVi1lwBq.js","./OverlayCompositing.glsl-CiE3Tt8y.js","./weather-eV4wTXCK.js","./HighlightDefaults-D4ckYWWJ.js","./Intersector-wXoCuQ8W.js","./LaserlinePath.glsl-CV6hrJ4l.js","./Object3DVisualElement-BVfa8i_P.js","./HUDMaterial.glsl-D6WRipwF.js","./graphicUtils-CWEFaVJb.js","./VertexColor.glsl-_ARMpsAT.js","./RightAngleQuadVisualElement-9e1qCkJI.js","./ColorMaterial.glsl-BF1fDRqL.js","./TriangleMaterial-BiHR3MKx.js","./interfaces-DkjgzG8v.js","./settings-BHWvAK7h.js","./lineStippleUtils-C89mzWlO.js","./OutlineVisualElement-JiMQm3sc.js","./line-CML3g7Ng.js","./line-DxZlo8wx.js","./triangulationUtils-DWWEtF_0.js","./deduplicate-DIJK2kGw.js","./VerticesVisualElement-B1xfXpYJ.js","./RenderObject-CuwfmXYe.js","./Compositing.glsl-DMM7CJmu.js","./GraphicState-Ch3zkYKf.js","./manipulatorUtils--FgdKArx.js","./MoveManipulation-DDXwpmjU.js","./dragEventPipeline3D-BzC_kbE1.js","./SelectedVertexTooltipInfo-Jy1UVcy1.js","./TranslateTooltipInfo-BDJmumyy.js","./utils-Ce7L3imC.js","./LRUCache-B_PHMSGm.js","./MemCache-Dx1v3xLC.js","./IViewEvents-Bci6PjlS.js","./SlicePlaneMaterial.glsl-CvGYpiku.js","./sliceToolConfig-D0gkc1PF.js","./ImageMaterial.glsl-toQN6zid.js","./DefaultLayouts-BuE1efcQ.js","./SlicePlane-CdDvBULA.js","./persistable-DjaiFmiM.js","./MD5-C9MwAd2G.js","./multiOriginJSONSupportUtils-C0wm8_Yw.js","./resourceExtension-D8MnQ6oV.js","./LineVisualElement-mUtX7dGi.js","./ShaderTechniqueRepository-hTzew41Z.js","./RenderCoordsHelper-C50UGjbb.js","./projectVectorToPoint-DcLtSZYw.js","./Factory-Bm3bRF5y.js","./ExtentScaleTooltipInfo-Da4eAeVm.js","./GraphicsLayerView3D-DNNmqDUu.js","./LayerView3D-Dkb0AiwM.js","./heightModelInfoUtils-C6gW75mB.js","./HeightModelInfo-9nOoV6LU.js","./arcgisLayerUrl-BX1FE5Hm.js","./queryForSymbologySnapping-KE3-mimJ.js","./GraphicsProcessor-CRgvUk3O.js","./renderingInfoUtils-DAsRBUXK.js","./visualVariableUtils-DX1kS9Se.js","./sizeVariableUtils-Cmcuvw-4.js","./LineCallout.glsl-C1R4fy2f.js","./vec2f32-BbH2jxlN.js","./dehydratedFeatures-BiOblf0d.js","./quantizationUtils-uj_P09aO.js","./featureConversionUtils-D14h8iad.js","./OptimizedFeature-6cJ-QFG5.js","./OptimizedGeometry-BF8iz5FO.js","./OptimizedFeatureSet-Blu9Ckm7.js","./edgeUtils-BUKTgPFR.js","./DecodeSymbolColor.glsl-BPIX0fAF.js","./RealisticTree.glsl-CAmeC2w1.js","./DefaultMaterial-DgOvtNL9.js","./ExtentSet-BhWFQ8Zv.js","./ClassBreaksRenderer-BuHwSyVK.js","./UniqueValueRenderer-BQtAHUSo.js","./colorRamps-pKd7I5WZ.js","./SizeVariable-936USOrb.js","./ColorStop-Dk3U5tCk.js","./jsonUtils-Ds2Sqto-.js","./layerUtils-BrNoooE9.js","./RendererLegendOptions-B-4se3aU.js","./styleUtils-BYTm14n3.js","./jsonUtils-DxpLMo6d.js","./FieldsIndex-DpwHKAMX.js","./UnknownTimeZone-BkowvBs8.js","./OverrideHelper-ti072FkP.js","./HeatmapColorStop-BJc5nbwr.js","./heatmapUtils-Dwiv9IEa.js","./SimpleRenderer-BV2L9G_n.js","./rendererConversion-CcWsy4Z5.js","./basemapUtils-B9TjOm47.js","./Basemap-DVYOaWHz.js","./loadAll-B6mYSptb.js","./PortalItem-DzgXrpyc.js","./writeUtils-Dz7BsE1e.js","./optimizedFeatureQueryEngineAdapter-BOPMFOve.js","./centroid-DdLmOD72.js","./PooledRBush-D7s4d_Fs.js","./quickselect-QQC62dOK.js","./popupUtils-BaLxn3kI.js","./layerViewUtils-DhFEu8Rd.js","./Graphics3DObjectStates-DLTNWJbN.js","./highlightUtils-BYmbiZ48.js","./languageUtils-JGnUBrxZ.js","./TimeOnly-DOn_Hy89.js","./ImmutableArray-BPVd6ESQ.js","./shared-OyXfj1UM.js","./number-CUaGJe2K.js","./projectExtentUtils-BJX_ptLZ.js","./geometryServiceUtils-C6Kg3Uew.js","./project-DlMfXva8.js","./utils-6jMaHUrH.js","./utils-Bema0iXE.js","./LayerView-CGYm21KA.js","./GraphicMover-LrqTUoJ7.js","./HighlightHelper-BXjDLAgC.js","./layerUtils-BS1Di3Pm.js","./featureUtils-Do2jvOGL.js","./utils-BwQ00KBJ.js","./Box-DcfZ4eM8.js","./settings-Bydk1FJ-.js","./Reshape-DeuLtJts.js"])))=>i.map(i=>d[i]);
import{_ as S}from"./index-Bh2oEzTI.js";import{r as y}from"./tslib.es6-B3Jf3DVX.js";import{k as nt,l as pt,j as k}from"./symbols-CNimns--.js";import{V as W}from"./Collection-CEdjem1-.js";import{m,a as L,ag as A,n as lt,b as ht}from"./subclass-BZA_h8Db.js";import{o as at}from"./Evented-BHRw9x22.js";import{q as D,e as V,u as Z,D as ct}from"./Accessor-BLX9ikPh.js";import{on as N,watch as I,syncAndInitial as j,when as dt,whenOnce as q}from"./reactiveUtils-C5zUhJQJ.js";import{s as ut,i as yt}from"./Point-Cg0-ChZE.js";import{J as mt,_ as gt,W as vt,K as _t}from"./projection-B971H0Re.js";import{e as Y}from"./Polyline-D9YkgmM_.js";import ft from"./GraphicsLayer-i3FeUJ_n.js";import{m as bt}from"./layerUtils-BrNoooE9.js";import{P as E,l as it,r as Ot,E as z,a as wt,b as Gt}from"./isSupportedObject-6I_Nw0mS.js";import{v as Et,l as Tt,f as St}from"./elevationInfoUtils-BC_66_Fg.js";import{e as B}from"./layerUtils-BS1Di3Pm.js";import{_ as O}from"./InputManager-Ba9xzDpe.js";import{p as _}from"./keybindings-DoOdil3D.js";import{c as At}from"./SketchLabelOptions-DDQnGNSN.js";import{t as rt,I as J,G as Mt}from"./SnappingManager-BJPyuu7J.js";import{r as Ct}from"./hitTestSelectUtils-UXJPjatw.js";import{n as Q}from"./screenUtils-WcqhHU65.js";import{n as Rt}from"./compilerUtils-Dw3R0f-Z.js";import{y as X,S as kt,d as Dt}from"./TextSymbol-D8QO_KUV.js";function It(t){return Ht(t).result}function Ht(t){var a;if(t.graphic&&((a=t.graphic.layer)==null?void 0:a.type)!=="graphics")return{result:E.GRAPHICS_LAYER_MISSING};if(!t.operations)return{result:E.GEOMETRY_MISSING};if(Et(t.elevationInfo))return{result:E.ELEVATION_MODE_UNSUPPORTED};const e=t.operations.data.type,o=t.operations.data.geometry;return e==="point"||e==="mesh"||e==="polyline"||e==="polygon"?{result:E.SUPPORTED,geometry:o}:{result:E.GEOMETRY_TYPE_UNSUPPORTED}}function Pt(t){var o;if(((o=t.layer)==null?void 0:o.type)!=="graphics")return E.GRAPHICS_LAYER_MISSING;if(t.geometry==null)return E.GEOMETRY_MISSING;switch(t.geometry.type){case"point":break;case"polygon":case"polyline":case"multipoint":case"extent":case"mesh":return E.SUPPORTED;default:return E.GEOMETRY_TYPE_UNSUPPORTED}const e=t.symbol!=null&&t.symbol.type==="point-3d"&&t.symbol.symbolLayers;return!e||!e.some(a=>a.type==="object")?E.SYMBOL_TYPE_UNSUPPORTED:Tt(t)!=="on-the-ground"&&St(t)?E.ELEVATION_MODE_UNSUPPORTED:E.SUPPORTED}let w=class extends at.EventedAccessor{constructor(t){super(t),this.cancelled=!1,this.history={undo:[],redo:[]},this.type=null}get tool(){if(!this.activeComponent)return null;switch(this.activeComponent.type){case"graphic-mover":case"move-3d":return"move";case"box":case"transform-3d":return"transform";case"reshape":case"reshape-3d":return"reshape";case"draw-2d":case"draw-3d":return this.activeComponent.geometryType;default:Rt(this.activeComponent)}return null}addToHistory(t){this.history.redo=[],this.history.undo.push(t)}resetHistory(){this.history.redo=[],this.history.undo=[]}canUndo(){return this.history.undo.length>0}canRedo(){return this.history.redo.length>0}complete(){this._reset(),this.onEnd(),this.emit("complete")}cancel(){this.cancelled=!0,this.complete()}_reset(){var t;(t=this.activeComponent)==null||t.reset()}refreshComponent(){const t=this.activeComponent;t&&(t.type!=="box"&&t.type!=="reshape"&&t.type!=="graphic-mover"||t.refresh())}set undo(t){this._set("undo",()=>{this.canUndo()&&t()})}set redo(t){this._set("redo",()=>{this.canRedo()&&t()})}};y([m()],w.prototype,"activeComponent",void 0),y([m()],w.prototype,"cancelled",void 0),y([m()],w.prototype,"history",void 0),y([m()],w.prototype,"tool",null),y([m()],w.prototype,"type",void 0),y([m()],w.prototype,"canUndo",null),y([m()],w.prototype,"canRedo",null),y([m()],w.prototype,"onEnd",void 0),y([m()],w.prototype,"undo",null),y([m()],w.prototype,"redo",null),y([m()],w.prototype,"toggleTool",void 0),y([m()],w.prototype,"addToSelection",void 0),y([m()],w.prototype,"removeFromSelection",void 0),w=y([L("esri.widgets.Sketch.support.OperationHandle")],w);let x=class extends w{};y([m()],x.prototype,"activeComponent",void 0),x=y([L("esri.widgets.Sketch.support.OperationHandle.CreateOperationHandle")],x);let M=class extends w{};y([m()],M.prototype,"activeComponent",void 0),M=y([L("esri.widgets.Sketch.support.OperationHandle.UpdateOperationHandle")],M);const tt={defaultZ:0},R={reshapeOptions:{edgeOperation:"split",shapeOperation:"move",vertexOperation:"move"},enableMoveAllGraphics:!0,enableRotation:!0,enableScaling:!0,multipleSelectionEnabled:!0,preserveAspectRatio:!1,toggleToolOnClick:!0,enableZ:!0,highlightOptions:{enabled:!0},tool:"transform"};let v=class extends at.EventedAccessor{constructor(t){var e;super(t),this._numUpdating=0,this._defaultSnappingManager=null,this._internalGraphicsLayer=new ft({listMode:"hide",internal:!0,title:"SVM Internal"}),this._operationHandle=null,this._viewHandlesKey="viewHandles",this.activeFillSymbol=null,this.activeLineSymbol=null,this.activeVertexSymbol=null,this.allowDeleteKey=!0,this.layer=null,this.pointSymbol=new X({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this.polygonSymbol=new kt({color:[150,150,150,.2],outline:{color:[50,50,50],width:2}}),this.polylineSymbol=new Dt({color:[130,130,130,1],width:2}),this.meshSymbol=new nt({symbolLayers:new W([new pt])}),this.updateGraphics=new W,this.updateOnGraphicClick=!0,this.vertexSymbol=new X({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this.sketchOptions=new it,this._moduleLoaderAbortController=null,this._viewReadyAbortController=null,this._originalPopupEnabled=null,this.defaultCreateOptions=tt,this.defaultUpdateOptions=R,this.snappingOptions=((e=t==null?void 0:t.snappingManager)==null?void 0:e.options)??(t==null?void 0:t.snappingOptions)??new rt}initialize(){this.addHandles([N(()=>{var t,e;return(e=(t=this.view)==null?void 0:t.map)==null?void 0:e.layers},"change",t=>{t.removed.includes(this.layer)&&this.cancel()}),N(()=>{var t;return(t=this.layer)==null?void 0:t.graphics},"change",t=>{if(this._operationHandle!=null)for(const e of t.removed)this.updateGraphics.includes(e)&&(this.updateGraphics.length>1?this._operationHandle.removeFromSelection(e):this._operationHandle.cancel())}),I(()=>{var t;return((t=this.layer)==null?void 0:t.elevationInfo)??null},t=>{t!==this._internalGraphicsLayer.elevationInfo&&(this.cancel(),this._internalGraphicsLayer.elevationInfo=t)},j),I(()=>this.view,t=>{this._defaultSnappingManager=D(this._defaultSnappingManager),t&&(this.snappingManager||(this._defaultSnappingManager=new J({view:t,options:this.snappingOptions})),t.type==="2d"?S(()=>import("./editingTools-DCvBiyJu.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169]),import.meta.url):t.type==="3d"&&(S(()=>import("./editingTools-COUq-DTn.js"),__vite__mapDeps([170,1,166,28,29,14,3,75,49,76,6,44,45,18,19,20,21,62,37,56,5,7,8,9,10,11,12,57,58,102,22,23,24,25,26,2,4,13,34,87,48,146,122,59,54,55,60,53,147,124,143,144,50,78,79,80,81,82,145,41,42,43,171,140,141,156,157,106,107,108,109,77,150,172,173,174,83,84,85,154,175,31,176,177,178,114,179,159,180,181,133,182,183,120,15,16,17,27,30,32,33,35,36,38,39,40,46,184,185,186,187,188,189,190,191,192,116,193,194,153,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,71,138,215,216,217,128,129,218,219,220,221,222,118,119,223,224,225,52,61,63,64,65,66,67,68,69,70,72,73,74,86,88,89,226,227,228,229,230,231,232,152,233,234,235,236,121,237,90,91,92,93,94,95,96,97,98,99,100,101,103,104,105,110,111,112,113,115,117,123,125,126,127,130,131,132,134,135,136,137,139,142,148,149,151,155,158,238,239,240,241,242,243,160,161,51,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,162,163,164,165]),import.meta.url),S(()=>import("./GraphicsLayerView3D-DNNmqDUu.js"),__vite__mapDeps([262,1,3,6,44,45,18,19,20,21,263,264,265,12,9,10,11,5,7,8,266,39,267,2,4,13,14,37,60,53,54,55,59,56,57,58,176,84,49,80,177,178,62,75,76,83,85,79,78,81,50,82,114,179,159,154,180,181,133,147,182,183,120,15,16,17,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,38,40,41,42,43,46,184,185,186,187,188,189,190,191,192,116,48,193,194,153,195,196,197,198,199,200,201,174,202,203,204,268,113,91,95,68,61,269,270,271,63,64,65,66,67,272,221,222,118,119,273,274,275,276,277,278,279,280,281,282,283,128,71,129,284,285,286,287,288,289,290,291,163,164,292,293,294,244,245,74,295,296,297,166,161,51,298,299,300,301,302,303,304,305,306,99,100,307,308,309,310,311,69,70,312,313,314,315,316,317,318,319,320,321,322,323,324,325,216]),import.meta.url)))},j),I(()=>{var t;return(t=this.view)==null?void 0:t.spatialReference},(t,e)=>{t&&e&&!t.equals(e)&&this.cancel()})]),Mt(this)}destroy(){this.cancel(),this._removeDefaultLayer(),this._defaultSnappingManager=D(this._defaultSnappingManager),this._set("snappingManager",null),this._set("view",null),this.emit("destroy")}get updating(){return this._numUpdating>0||this.snappingManager!=null&&this.snappingManager.updating}get activeTool(){var t;return((t=this._operationHandle)==null?void 0:t.tool)??null}get activeTooltip(){const{activeComponent:t,destroyed:e}=this,o=!e&&t&&"tooltip"in t?t.tooltip:null;return o!=null&&o.visible?o:null}get activeComponent(){var t;return((t=this._operationHandle)==null?void 0:t.activeComponent)??null}get createGraphic(){return this.activeComponent==null||this.activeComponent.type!=="draw-3d"&&this.activeComponent.type!=="draw-2d"?this._get("createGraphic"):this.activeComponent.graphic}get defaultCreateOptions(){return this._get("defaultCreateOptions")}set defaultCreateOptions(t){this._set("defaultCreateOptions",{...tt,...t})}get defaultUpdateOptions(){return this._get("defaultUpdateOptions")}set defaultUpdateOptions(t){this._set("defaultUpdateOptions",{...R,...t,reshapeOptions:{...R.reshapeOptions,...t==null?void 0:t.reshapeOptions},highlightOptions:{...R.highlightOptions,...t==null?void 0:t.highlightOptions}})}get labelOptions(){return this.sketchOptions.labels}set labelOptions(t){this.sketchOptions.labels=t}get snappingOptions(){var t;return((t=this.snappingManager)==null?void 0:t.options)??this._get("snappingOptions")}set snappingOptions(t){this._defaultSnappingManager!=null&&(this._defaultSnappingManager.options=t),this._set("snappingOptions",t)}get snappingManager(){return this._isOverridden("snappingManager")&&this._get("snappingManager"),this._defaultSnappingManager}set snappingManager(t){if(t)this._isOverridden("snappingManager")||(this._defaultSnappingManager=D(this._defaultSnappingManager)),this._override("snappingManager",t);else{const{view:e}=this;!this._defaultSnappingManager&&e&&(this._defaultSnappingManager=new J({options:this.snappingOptions,view:e})),this._clearOverride("snappingManager")}}get state(){var o;const t=!(!((o=this.view)!=null&&o.ready)||!this.layer),e=this._operationHandle;return t&&e?"active":t?"ready":"disabled"}get tooltipOptions(){return this.sketchOptions.tooltips}set tooltipOptions(t){this.sketchOptions.tooltips=t}get valueOptions(){return this.sketchOptions.values}set valueOptions(t){this.sketchOptions.values=t}get view(){return this._get("view")}set view(t){const e=this._get("view");if(e){const{container:a,map:i}=e;a&&(e.cursor=null),i==null||i.remove(this._internalGraphicsLayer),this.removeHandles(this._viewHandlesKey),this.cancel()}const o="view-ready";this.removeHandles(o),t&&this.addHandles(dt(()=>t.ready,a=>{this.removeHandles(this._viewHandlesKey),a&&this.addHandles(this._generateViewHandles(t),this._viewHandlesKey)},j),o),this._set("view",t)}cancel(){this._moduleLoaderAbortController=V(this._moduleLoaderAbortController),this._viewReadyAbortController=V(this._viewReadyAbortController),this._operationHandle&&this._operationHandle.cancel()}complete(){this._operationHandle&&this._operationHandle.complete()}delete(){const{state:t,updateGraphics:e}=this;if(t==="active"&&e.length){const{activeTool:o,layer:a}=this,i=e.toArray();a.removeMany(i),this.cancel(),this._emitDeleteEvent({graphics:i,tool:o})}}duplicate(){if(this.state==="active"&&this.updateGraphics.length){const t=this.updateGraphics.map(e=>e.clone()).toArray();return this.layer.addMany(t),this.emit("duplicate",{graphics:t,type:"duplicate"}),t}return[]}async create(t,e){this.cancel(),await this._waitViewReady();const{view:o,layer:a}=this;if(!o||this.state==="disabled")throw a||this._logMissingLayer(),Z();if(o.activeTool!=null&&(o.activeTool=null),!t)return void this._logError("sketch:missing-parameter","Missing parameter 'tool'.");B(o,this._internalGraphicsLayer);const i=await this._setupCreateOperation(t,e);if(i==null||this.destroyed)return void o.map.remove(this._internalGraphicsLayer);const r=()=>{var h;if(i===this._operationHandle){const s=this.createGraphic,c=this._operationHandle.cancelled;this._operationHandle.destroy(),this._operationHandle=null,this._set("createGraphic",null),(h=this.view)!=null&&h.map&&this.view.map.remove(this._internalGraphicsLayer),i.cancelled||s==null||a.add(s),this.emit("create",{graphic:s,state:c?"cancel":"complete",tool:t,toolEventInfo:null,type:"create"})}};i.on("complete",r),this._operationHandle=i,o.ready&&o.focus()}async place(t,e){return this.create("mesh",{mode:"click",hasZ:t.hasZ,geometryToPlace:t,...e})}async update(t,e){this.cancel(),await this._waitViewReady();const{layer:o,view:a,state:i}=this;if(!a||i==="disabled")throw o||this._logMissingLayer(),Z();a.activeTool!=null&&(a.activeTool=null);const r=Array.isArray(t)?t:[t];if(t==null||!(r!=null&&r.length))return void this._logError("sketch:missing-parameter","Missing parameter 'graphics'.");if(r.some(s=>s.layer!==o?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics missing from the supplied GraphicsLayer."),!0):s.geometry==null&&(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with an unsupported geometry."),!0)))return;const h=await this._setupUpdateOperation(r,e);this.destroyed||h==null||b(h)||(B(a,this._internalGraphicsLayer),this._setUpdateOperationHandle(h,e),this.emit("update",{graphics:r,state:"start",aborted:!1,tool:h.tool,toolEventInfo:null,type:"update"}))}async _updateSpatialReference(t){const e=this.view;if(e){this._beginAsyncOperation(),t=Array.isArray(t)?t:[t];for(const o of t)o.geometry==null||o.geometry.type==="mesh"||ut(o.geometry.spatialReference,e.spatialReference)||(mt(o.geometry.spatialReference,e.spatialReference)||gt()||await vt(),o.geometry=_t(o.geometry,e.spatialReference));this._endAsyncOperation()}else this._logMissingView()}undo(){var t;this.canUndo()&&((t=this._operationHandle)==null||t.undo())}redo(){var t;this.canRedo()&&((t=this._operationHandle)==null||t.redo())}canUndo(){var t;return!!((t=this._operationHandle)!=null&&t.canUndo())}canRedo(){var t;return!!((t=this._operationHandle)!=null&&t.canRedo())}toggleUpdateTool(){var t;(t=this._operationHandle)==null||t.toggleTool()}async _getFirstHit(t){const e=this.view;if(!e)return this._logMissingView(),null;if(e.type==="2d"){const i=[];e.map.allLayers.forEach(h=>{h.type!=="vector-tile"&&h.type!=="imagery"||i.push(h)});const r=await e.hitTest(t,{exclude:i});return Ct(r.results)}const o=[e.map.ground];e.map.allLayers.forEach(i=>{bt(i.type)&&o.push(i)});const a=await e.hitTest(t,{exclude:o});if(a.results.length>0){const i=a.results[0];if(i!=null&&i.type==="graphic"&&i.graphic&&(!a.ground.mapPoint||e.map.ground.opacity<1||a.ground.distance-(i.distance??0)>-Math.min(3*a.ground.distance,e.viewingMode==="global"?yt(e.renderCoordsHelper.spatialReference).radius/e.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY)))return i}return null}_generateViewHandles(t){return[t.on("immediate-click",async e=>{var r;const o=this.state==="active"&&((r=this._operationHandle)==null?void 0:r.type)==="create";if(this.state==="disabled"||o||!this.updateOnGraphicClick)return;this._beginAsyncOperation();const a=await e.async(()=>this._getFirstHit(Q(e)));let i=null;if(a!=null){const h=a.graphic;this.updateGraphics.includes(h)||h.layer===this.layer?(e.stopPropagation(),i=h):t.type!=="2d"||this._isComponentGraphic(h)||this.state!=="active"||this.cancel()}else this.state==="active"&&this.cancel();i==null||this.updateGraphics.includes(i)||await this.update([i],{...this.defaultUpdateOptions,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions}}),this._endAsyncOperation()},O.WIDGET)]}async _setupCreateOperation(t,e){const o=this.view;if(!o)return this._logMissingView(),null;const a={hasZ:o.type==="3d",...this.defaultCreateOptions,...e},i=await this._setupDrawGraphicTool(t,o,a);return i==null?null:(o.tools.add(i),o.activeTool=i,this._setupCreateOperationHandle(i))}async _setupDrawGraphicTool(t,e,o){if(t==="multipoint"&&e.type==="3d")return this._logError("sketch:create","Multipoint geometries are not supported in SceneView."),null;if(!e)return this._logMissingView(),null;const{cursor:a,defaultZ:i,hasZ:r,geometryToPlace:h,graphicProperties:s,mode:c,preserveAspectRatio:n}=o,l=t==="rectangle"||t==="circle"?"hybrid":"click",p=n??t!=="rectangle",g={centered:t!=="rectangle"&&!(t==="circle"&&!p),cursor:a,defaultZ:i,forceUniformSize:p,graphicProperties:s,geometryToPlace:h,geometryType:t,graphicSymbol:this._getGraphicSymbolFromTool(t),hasZ:r,mode:c??l,snappingManager:this.snappingManager,snapToScene:!1,view:e};return e.type==="2d"?this._makeDrawGraphicTool2D(g):this._makeDrawGraphicTool3D(g)}async _makeDrawGraphicTool2D(t){const e=await this._requireModule(S(()=>import("./editingTools-DCvBiyJu.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169]),import.meta.url));return b(e)||this.destroyed?null:new e.module.DrawGraphicTool2D({...t,activeVertexSymbol:this.activeVertexSymbol,regularVerticesSymbol:this.vertexSymbol,activeLineSymbol:this.activeLineSymbol,activeFillSymbol:xt(t.geometryType)?this.activeFillSymbol:null,sketchOptions:this.sketchOptions})}async _makeDrawGraphicTool3D(t){const e=await this._requireModule(S(()=>import("./editingTools-COUq-DTn.js"),__vite__mapDeps([170,1,166,28,29,14,3,75,49,76,6,44,45,18,19,20,21,62,37,56,5,7,8,9,10,11,12,57,58,102,22,23,24,25,26,2,4,13,34,87,48,146,122,59,54,55,60,53,147,124,143,144,50,78,79,80,81,82,145,41,42,43,171,140,141,156,157,106,107,108,109,77,150,172,173,174,83,84,85,154,175,31,176,177,178,114,179,159,180,181,133,182,183,120,15,16,17,27,30,32,33,35,36,38,39,40,46,184,185,186,187,188,189,190,191,192,116,193,194,153,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,71,138,215,216,217,128,129,218,219,220,221,222,118,119,223,224,225,52,61,63,64,65,66,67,68,69,70,72,73,74,86,88,89,226,227,228,229,230,231,232,152,233,234,235,236,121,237,90,91,92,93,94,95,96,97,98,99,100,101,103,104,105,110,111,112,113,115,117,123,125,126,127,130,131,132,134,135,136,137,139,142,148,149,151,155,158,238,239,240,241,242,243,160,161,51,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,162,163,164,165]),import.meta.url));if(b(e)||this.destroyed)return null;const{elevationInfo:o}=this.layer;return new e.module.DrawGraphicTool3D({...t,elevationInfo:o,snapToScene:!0,sketchOptions:this.sketchOptions})}_setupCreateOperationHandle(t){const e=this.view;if(!e)return this._logMissingView(),null;let o=null;const a=t.forceUniformSize,i=t.centered,r=[e.on("key-down",s=>{if(s.key===_.pan)s.stopPropagation(),s.repeat||(t.enabled=!1);else if(s.key===_.complete)s.stopPropagation(),t.completeCreateOperation();else if(s.key!==_.vertexAdd||s.repeat)s.key===_.undo?(s.stopPropagation(),h.undo()):s.key===_.redo?(s.stopPropagation(),h.redo()):s.key!==_.constraint||t.geometryType!=="rectangle"&&t.geometryType!=="circle"||s.repeat?s.key===_.center&&(s.repeat||(t.centered=!i,s.stopPropagation())):(t.forceUniformSize=!a,s.stopPropagation());else{const c=t.drawOperation.geometryType;c!=="polyline"&&c!=="polygon"&&c!=="multipoint"||(s.stopPropagation(),t.drawOperation.commitStagedVertex())}},O.WIDGET),e.on("key-up",s=>{s.key===_.pan?t.enabled=!0:s.key!==_.constraint||t.geometryType!=="rectangle"&&t.geometryType!=="circle"?s.key===_.center&&(t.centered=i,s.stopPropagation()):(t.forceUniformSize=a,s.stopPropagation())},O.WIDGET),t.on("vertex-add",s=>{switch(o=o==null?"start":"active",s.operation){case"apply":this.emit("create",{graphic:t.graphic,state:o,tool:this.activeTool,toolEventInfo:s,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[t.graphic],tool:t.geometryType});break;case"redo":this._emitRedoEvent({graphics:[t.graphic],tool:t.geometryType})}}),t.on("cursor-update",s=>{t.drawOperation.numCommittedVertices>0&&this.emit("create",{graphic:t.graphic,state:"active",tool:this.activeTool,toolEventInfo:{coordinates:s.vertices[0].coordinates,type:"cursor-update"},type:"create"})}),t.on("vertex-remove",s=>{switch(s.operation){case"apply":this.emit("create",{graphic:t.graphic,state:"active",tool:this.activeTool,toolEventInfo:s,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[t.graphic],tool:t.geometryType});break;case"redo":this._emitRedoEvent({graphics:[t.graphic],tool:t.geometryType})}}),t.on("complete",s=>{this._set("createGraphic",s.graphic),o="complete",s.aborted?h&&h.cancel():h&&h.complete()}),I(()=>this._getGraphicSymbolFromTool(t.geometryType),s=>{t.graphicSymbol=s})],h=new x({activeComponent:t,tool:t.geometryType,type:"create",onEnd:()=>{var s;A(r),(s=e.tools)==null||s.remove(t)},undo:()=>{t.canUndo&&t.undo()},redo:()=>{t.canRedo&&t.redo()},canUndo:()=>t.canUndo,canRedo:()=>t.canRedo});return h}_getGraphicSymbolFromTool(t){switch(t){case"point":case"multipoint":return this.pointSymbol;case"polyline":return this.polylineSymbol;case"circle":case"rectangle":case"polygon":return this.polygonSymbol;case"mesh":return this.meshSymbol}}async _setupUpdateOperation(t,e){var h;const{layer:o,view:a}=this;if(!a)return this._logMissingView(),null;const i={...this.defaultUpdateOptions,...e,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions,...e==null?void 0:e.reshapeOptions},highlightOptions:{...this.defaultUpdateOptions.highlightOptions,...e==null?void 0:e.highlightOptions}};let r=i.tool??R.tool;for(const s of t)o.remove(s),o.add(s);if(a.type==="3d"){if(t.length===0)return null;switch(r){case"move":return this._setupMove3DOperation(t,i,a,r);case"reshape":return t.length>1?(this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null):this._setupReshape3DOperation(t[0],i,a);case"transform":return this._setupGraphicTransform3DOperation(t,i,a)}}switch(r){case"move":return this._setupMove2DOperation(t,i,a);case"reshape":return t.length>1?(this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null):this._setupTransformOrReshape2DOperation(t,r,i,a);case"transform":if(t.length===1){const s=(h=t[0].geometry)==null?void 0:h.type;s!=="point"&&s!=="multipoint"||(r="reshape")}return this._setupTransformOrReshape2DOperation(t,r,i,a)}}async _setupMove3DOperation(t,e,o,a,i=!1){const r=await this._requireModule(S(()=>import("./editingTools-COUq-DTn.js"),__vite__mapDeps([170,1,166,28,29,14,3,75,49,76,6,44,45,18,19,20,21,62,37,56,5,7,8,9,10,11,12,57,58,102,22,23,24,25,26,2,4,13,34,87,48,146,122,59,54,55,60,53,147,124,143,144,50,78,79,80,81,82,145,41,42,43,171,140,141,156,157,106,107,108,109,77,150,172,173,174,83,84,85,154,175,31,176,177,178,114,179,159,180,181,133,182,183,120,15,16,17,27,30,32,33,35,36,38,39,40,46,184,185,186,187,188,189,190,191,192,116,193,194,153,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,71,138,215,216,217,128,129,218,219,220,221,222,118,119,223,224,225,52,61,63,64,65,66,67,68,69,70,72,73,74,86,88,89,226,227,228,229,230,231,232,152,233,234,235,236,121,237,90,91,92,93,94,95,96,97,98,99,100,101,103,104,105,110,111,112,113,115,117,123,125,126,127,130,131,132,134,135,136,137,139,142,148,149,151,155,158,238,239,240,241,242,243,160,161,51,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,162,163,164,165]),import.meta.url));if(b(r))return r;const{ManipulatedObject3DGraphic:h,MoveTool3D:s}=r.module,c=new Map,n=()=>{c.forEach(u=>u.destroy()),c.clear()};for(const u of t){const d=new h({view:o,graphic:u}),G=Ot(d);if(G!==E.SUPPORTED)return n(),this._logError("sketch:move",`Move operation not supported for provided graphic(s) (${z(G)}).`),null;c.set(u,d)}const l=new s({view:o,enableZ:e.enableZ,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});o.tools.add(l),l.objects.addMany(Array.from(c.values())),i||this.updateGraphics.addMany(t);const p=[],g=new M({activeComponent:l,tool:a,type:"update",onEnd:()=>{A(p),U(o,l),n()},undo:()=>{ot(this.view,l),H(g,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:a})},redo:()=>{P(g,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:a})},addToSelection:u=>{this.updateGraphics.push(u);const d=new h({view:o,graphic:u});c.set(u,d),l.objects.push(d),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[u],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:u=>{const d=this.updateGraphics.indexOf(u);if(g.history.undo.forEach(T=>T.updates.splice(d,1)),g.history.redo.forEach(T=>T.updates.splice(d,1)),this.updateGraphics.remove(u),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[u],type:"selection-change"},type:"update"}),this.updateGraphics.length===0)return void g.complete();const G=c.get(u);G&&(l.objects.remove(G),G.destroy(),c.delete(u))},toggleTool:async()=>{if(this.updateGraphics.length!==1||e.toggleToolOnClick===!1||a!=="transform")return;const u=this.updateGraphics.at(0),d=await this._setupReshape3DOperation(u,e,o,!0);d&&!b(d)&&(g.onEnd(),g.destroy(),this._setUpdateOperationHandle(d,e))}});return p.push(...this._getHandlesForComponent(g,e),o.on("immediate-click",u=>this._getCommonUpdateOperationClickHandlers(g,u,e),O.WIDGET),o.on("key-down",u=>{this._getCommonUpdateOperationKeyDownHandlers(g,u)},O.WIDGET)),g}_setupGraphicTransform3DOperation(t,e,o,a=!1){if(t.length===1&&Pt(t[0])===E.SUPPORTED){const i=t[0],r=i.geometry;if(r!=null&&(r.type==="point"||r.type==="mesh"))return this._setupPointTransform3DOperation(i,e,o);if(r!=null&&(r.type==="polygon"||r.type==="polyline"))return this._setupPolyTransform3DOperation(i,e,o,a)}return this._setupMove3DOperation(t,e,o,"transform",a)}async _setupPointTransform3DOperation(t,e,o){const a="transform",{enableRotation:i,enableScaling:r,enableZ:h}=e,s=await this._requireModule(S(()=>import("./editingTools-COUq-DTn.js"),__vite__mapDeps([170,1,166,28,29,14,3,75,49,76,6,44,45,18,19,20,21,62,37,56,5,7,8,9,10,11,12,57,58,102,22,23,24,25,26,2,4,13,34,87,48,146,122,59,54,55,60,53,147,124,143,144,50,78,79,80,81,82,145,41,42,43,171,140,141,156,157,106,107,108,109,77,150,172,173,174,83,84,85,154,175,31,176,177,178,114,179,159,180,181,133,182,183,120,15,16,17,27,30,32,33,35,36,38,39,40,46,184,185,186,187,188,189,190,191,192,116,193,194,153,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,71,138,215,216,217,128,129,218,219,220,221,222,118,119,223,224,225,52,61,63,64,65,66,67,68,69,70,72,73,74,86,88,89,226,227,228,229,230,231,232,152,233,234,235,236,121,237,90,91,92,93,94,95,96,97,98,99,100,101,103,104,105,110,111,112,113,115,117,123,125,126,127,130,131,132,134,135,136,137,139,142,148,149,151,155,158,238,239,240,241,242,243,160,161,51,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,162,163,164,165]),import.meta.url));if(b(s))return s;const{TransformTool3D:c,ManipulatedObject3DGraphic:n}=s.module,l=new n({graphic:t,view:o}),p=new c({object:l,view:o,enableRotation:i,enableScaling:r,enableZ:h,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});o.tools.add(p),this.updateGraphics.add(t);const g=[],u=new M({activeComponent:p,tool:a,type:"update",onEnd:()=>{A(g),U(o,p),l.destroy()},undo:()=>{ot(this.view,p),H(u,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:a})},redo:()=>{P(u,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:a})},addToSelection:async d=>{this.updateGraphics.add(d),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[d],removed:[],type:"selection-change"},type:"update"}),u.onEnd(),u.destroy();const G=await this._setupMove3DOperation(this.updateGraphics.toArray(),e,o,"transform",!0);b(G)||this._setUpdateOperationHandle(G,e)},removeFromSelection:d=>{this.updateGraphics.remove(d),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[d],type:"selection-change"},type:"update"}),u.complete()},toggleTool:()=>{}});return g.push(...this._getHandlesForComponent(u,e),o.on("immediate-click",d=>this._getCommonUpdateOperationClickHandlers(u,d,e),O.WIDGET),o.on("key-down",d=>{this._getCommonUpdateOperationKeyDownHandlers(u,d)},O.WIDGET)),u}async _setupPolyTransform3DOperation(t,e,o,a=!1){var F,$;const i="transform",{enableRotation:r,enableScaling:h,enableZ:s,preserveAspectRatio:c}=e,n=await this._requireModule(S(()=>import("./editingTools-COUq-DTn.js"),__vite__mapDeps([170,1,166,28,29,14,3,75,49,76,6,44,45,18,19,20,21,62,37,56,5,7,8,9,10,11,12,57,58,102,22,23,24,25,26,2,4,13,34,87,48,146,122,59,54,55,60,53,147,124,143,144,50,78,79,80,81,82,145,41,42,43,171,140,141,156,157,106,107,108,109,77,150,172,173,174,83,84,85,154,175,31,176,177,178,114,179,159,180,181,133,182,183,120,15,16,17,27,30,32,33,35,36,38,39,40,46,184,185,186,187,188,189,190,191,192,116,193,194,153,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,71,138,215,216,217,128,129,218,219,220,221,222,118,119,223,224,225,52,61,63,64,65,66,67,68,69,70,72,73,74,86,88,89,226,227,228,229,230,231,232,152,233,234,235,236,121,237,90,91,92,93,94,95,96,97,98,99,100,101,103,104,105,110,111,112,113,115,117,123,125,126,127,130,131,132,134,135,136,137,139,142,148,149,151,155,158,238,239,240,241,242,243,160,161,51,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,162,163,164,165]),import.meta.url));if(b(n))return n;const{ManipulatedObject3DGraphic:l,ExtentTransformTool:p}=n.module,g=($=(F=this.view)==null?void 0:F.inputManager)==null?void 0:$.isModifierKeyDown(_.constraint),u=new l({view:o,graphic:t}),d=new p({object:u,view:o,enableRotation:r,enableScaling:h,enableZ:s,preserveAspectRatio:!!c!=!!g,sketchOptions:this.sketchOptions});o.tools.add(d),a||this.updateGraphics.add(t);const G=[],T=new M({activeComponent:d,tool:i,type:"update",onEnd:()=>{A(G),U(o,d),u.destroy()},canUndo:()=>!d.destroyed&&d.canUndo,undo:()=>{d.destroyed||(d.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:i}))},canRedo:()=>!d.destroyed&&d.canRedo,redo:()=>{d.destroyed||(d.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:i}))},addToSelection:async f=>{this.updateGraphics.add(f),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[f],removed:[],type:"selection-change"},type:"update"}),T.onEnd(),T.destroy();const K=await this._setupMove3DOperation(this.updateGraphics.toArray(),e,o,"transform",!0);b(K)||this._setUpdateOperationHandle(K,e)},removeFromSelection:f=>{this.updateGraphics.remove(f),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[f],type:"selection-change"},type:"update"}),T.complete()},toggleTool:async()=>{if(this.updateGraphics.length!==1||e.toggleToolOnClick===!1)return;const f=await this._setupReshape3DOperation(t,e,o,!0);f&&!b(f)&&(T.onEnd(),T.destroy(),this._setUpdateOperationHandle(f,e))}});return G.push(...this._getHandlesForComponent(T,e),o.on("immediate-click",f=>this._getCommonUpdateOperationClickHandlers(T,f,e),O.WIDGET),o.on("key-down",f=>this._getCommonUpdateOperationKeyDownHandlers(T,f),O.WIDGET),o.on("key-down",f=>{f.key!==_.constraint||f.repeat||(d.preserveAspectRatio=!d.preserveAspectRatio,f.stopPropagation())},O.WIDGET),o.on("key-up",f=>{f.key===_.constraint&&(d.preserveAspectRatio=!d.preserveAspectRatio,f.stopPropagation())},O.WIDGET)),T}async _setupMove2DOperation(t,e,o){const a="move";this.updateGraphics.addMany(t),await this._updateSpatialReference(t);const i=await this._getGraphicMover(t,e,o);if(b(i))return i;const r=new M({activeComponent:i,tool:a,type:"update",onEnd:()=>{var n;this._displayDefaultCursor(),A(c),A(s),i.destroy(),(n=this._internalGraphicsLayer)==null||n.removeMany([...this.updateGraphics.toArray()])},undo:()=>{const n=this.updateGraphics.toArray();H(r,n),r.refreshComponent(),this._emitUndoEvent({graphics:n,tool:a})},redo:()=>{const n=this.updateGraphics.toArray();P(r,n),r.refreshComponent(),this._emitRedoEvent({graphics:n,tool:a})},addToSelection:async n=>{await this._updateSpatialReference(n),this.updateGraphics.push(n),i.graphics=this.updateGraphics.toArray(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[n],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:n=>{const l=this.updateGraphics.indexOf(n);r.history.undo.forEach(g=>g.updates.splice(l,1)),r.history.redo.forEach(g=>g.updates.splice(l,1)),this.updateGraphics.remove(n);const p=this.updateGraphics.toArray();this.emit("update",{graphics:p,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[n],type:"selection-change"},type:"update"}),this.updateGraphics.length!==0?i.graphics=p:r.complete()}});let h=!1;const s=[o.on("immediate-click",n=>this._getCommonUpdateOperationClickHandlers(r,n,e),O.WIDGET),o.on("key-down",n=>{this._getCommonUpdateOperationKeyDownHandlers(r,n),n.key!==_.constraint||n.repeat||(h=!0,i.enableMoveAllGraphics=!i.enableMoveAllGraphics)},O.WIDGET),o.on("key-up",n=>{n.key===_.constraint&&h&&(h=!1,i.enableMoveAllGraphics=!i.enableMoveAllGraphics)},O.WIDGET)],c=this._getHandlesForComponent(r,e);return r}async _setupReshape3DOperation(t,e,o,a=!1){const i="reshape",r=await this._requireModule(S(()=>import("./editingTools-COUq-DTn.js"),__vite__mapDeps([170,1,166,28,29,14,3,75,49,76,6,44,45,18,19,20,21,62,37,56,5,7,8,9,10,11,12,57,58,102,22,23,24,25,26,2,4,13,34,87,48,146,122,59,54,55,60,53,147,124,143,144,50,78,79,80,81,82,145,41,42,43,171,140,141,156,157,106,107,108,109,77,150,172,173,174,83,84,85,154,175,31,176,177,178,114,179,159,180,181,133,182,183,120,15,16,17,27,30,32,33,35,36,38,39,40,46,184,185,186,187,188,189,190,191,192,116,193,194,153,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,71,138,215,216,217,128,129,218,219,220,221,222,118,119,223,224,225,52,61,63,64,65,66,67,68,69,70,72,73,74,86,88,89,226,227,228,229,230,231,232,152,233,234,235,236,121,237,90,91,92,93,94,95,96,97,98,99,100,101,103,104,105,110,111,112,113,115,117,123,125,126,127,130,131,132,134,135,136,137,139,142,148,149,151,155,158,238,239,240,241,242,243,160,161,51,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,162,163,164,165]),import.meta.url));if(b(r))return r;const{ManipulatedObject3DGraphic:h,ReshapeTool3D:s}=r.module,c=new h({view:o,graphic:t}),n=It(c);if(n!==E.SUPPORTED)return c.destroy(),this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${z(n)}).`),null;const l=e.reshapeOptions,p=new s({view:o,object:c,enableZVertex:e.enableZ&&(l==null?void 0:l.vertexOperation)==="move",enableZShape:e.enableZ&&(l==null?void 0:l.shapeOperation)==="move",enableMoveObject:(l==null?void 0:l.shapeOperation)==="move"||(l==null?void 0:l.shapeOperation)==="move-xy",enableMidpoints:(l==null?void 0:l.edgeOperation)==="split",enableEdgeOffset:(l==null?void 0:l.edgeOperation)==="offset",snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});o.tools.add(p),a||this.updateGraphics.add(c.graphic);const g=[],u=new M({activeComponent:p,tool:i,type:"update",onEnd:()=>{A(g),U(o,p),c.destroy()},canUndo:()=>!p.destroyed&&p.canUndo,undo:()=>{p.destroyed||(p.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:i}))},canRedo:()=>!p.destroyed&&p.canRedo,redo:()=>{p.destroyed||(p.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:i}))},addToSelection:async d=>{this.updateGraphics.add(d),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[d],removed:[],type:"selection-change"},type:"update"}),u.onEnd(),u.destroy();const G=await this._setupMove3DOperation(this.updateGraphics.toArray(),e,o,"transform",!0);b(G)||this._setUpdateOperationHandle(G,e)},removeFromSelection:d=>{this.updateGraphics.remove(d),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[d],type:"selection-change"},type:"update"}),u.complete()},toggleTool:async()=>{if(e.toggleToolOnClick===!1)return;u.onEnd(),u.destroy();const d=await this._setupGraphicTransform3DOperation(this.updateGraphics.toArray(),e,o,!0);b(d)||this._setUpdateOperationHandle(d,e)}});return g.push(...this._getHandlesForComponent(u,e),o.on("immediate-click",d=>this._getCommonUpdateOperationClickHandlers(u,d,e),O.WIDGET),o.on("key-down",d=>{this._getCommonUpdateOperationKeyDownHandlers(u,d)},O.WIDGET)),u}async _setupTransformOrReshape2DOperation(t,e,o,a){this.updateGraphics.addMany(t),await this._updateSpatialReference(t);const i=e==="transform"?await this._getBox(t,o,a):await this._getReshape(t,o,a);if(b(i))return i;const r=new M({activeComponent:i,type:"update",onEnd:()=>{A(s),A(h),r.activeComponent&&!r.activeComponent.destroyed&&r.activeComponent.destroy(),this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray())},undo:()=>{H(r,this.updateGraphics.toArray()),r.refreshComponent(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:r.tool})},redo:()=>{P(r,this.updateGraphics.toArray()),r.refreshComponent(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:r.tool})},addToSelection:async c=>{let n=r.activeComponent;if((n==null?void 0:n.type)==="reshape"){const l=[...this.updateGraphics,c];this.updateGraphics.removeAll(),r.onEnd(),r.destroy();const p=await this._setupTransformOrReshape2DOperation(l,"transform",o,a);if(b(p))return;this._setUpdateOperationHandle(p,o)}else this.updateGraphics.add(c),n.graphics=this.updateGraphics.toArray(),n.refresh(),r.resetHistory();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[c],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:async c=>{const n=this.updateGraphics.indexOf(c);r.history.undo.forEach(p=>p.updates.splice(n,1)),r.history.redo.forEach(p=>p.updates.splice(n,1)),this.updateGraphics.remove(c);const l=this.updateGraphics.toArray();if(l.length===0)r.complete();else{const p=l[0].geometry;l.length!==1||p==null||p.type!=="point"&&p.type!=="multipoint"?r.activeComponent.graphics=l:r.toggleTool()}this.emit("update",{graphics:l,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[c],type:"selection-change"},type:"update"})},toggleTool:async()=>{var p;if(this.updateGraphics.length>1)return;const c=this.updateGraphics.at(0),n=c.geometry;if(n!=null&&(r.tool==="reshape"&&(n.type==="point"||n.type==="multipoint")||r.tool==="transform"&&n.type==="extent"))return;let l=null;r.tool==="transform"?l=await this._getReshape([c],o,a):r.tool==="reshape"&&(l=await this._getBox([c],o,a)),b(l)||((p=r.activeComponent)==null||p.destroy(),r.activeComponent=l,r.activeComponent&&(A(s),s=this._getHandlesForComponent(r,o)))}}),h=[a.on("immediate-click",c=>this._getCommonUpdateOperationClickHandlers(r,c,o),O.WIDGET),a.on("key-down",c=>{if(this._getCommonUpdateOperationKeyDownHandlers(r,c),c.key===_.constraint&&!c.repeat&&r){const n=r.activeComponent;n&&n.type==="box"&&(n.preserveAspectRatio=!n.preserveAspectRatio)}},O.WIDGET),a.on("key-up",c=>{if(c.key===_.constraint&&r){const n=r.activeComponent;n&&n.type==="box"&&(n.preserveAspectRatio=!n.preserveAspectRatio)}},O.WIDGET)];let s=this._getHandlesForComponent(r,o);return r}async _getGraphicMover(t,e,o){const{enableMoveAllGraphics:a,highlightOptions:i}=e,r=await this._requireModule(S(()=>import("./GraphicMover-LrqTUoJ7.js"),__vite__mapDeps([326,1,32,3,27,12,8,22,6,10,11,23,24,25,26,9,14,2,4,5,7,13,33,28,29,34,35,36,37,38,39,18,19,20,21,40,41,42,43,17,44,45,93,94,15,16,30,31,46,95,68,61,96,97,98,99,100,84,49,101,102,57,58,167,327,328,312,329,291,330,303,304,305,306,69,70,71,162,48,62,53,54,55,60,56,163,164,165,169]),import.meta.url));return b(r)?r:new r.module.default({enableMoveAllGraphics:a,highlightsEnabled:!!(i!=null&&i.enabled),indicatorsEnabled:!1,graphics:t,view:o,callbacks:{onGraphicMoveStart:({dx:h,dy:s,graphic:c})=>{this._displayGrabbingCursor(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:h,dy:s,mover:c,type:"move-start"},type:"update"})},onGraphicMove:({dx:h,dy:s,graphic:c})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:h,dy:s,mover:c,type:"move"},type:"update"}),onGraphicMoveStop:({dx:h,dy:s,graphic:c})=>{this._displayPointerCursor(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:h,dy:s,mover:c,type:"move-stop"},type:"update"})},onGraphicPointerOver:()=>this._displayPointerCursor(),onGraphicPointerOut:()=>this._displayDefaultCursor()}})}async _getBox(t,e,o){var n,l;const{enableRotation:a,enableScaling:i,highlightOptions:r,preserveAspectRatio:h}=e,s=await this._requireModule(S(()=>import("./Box-DcfZ4eM8.js"),__vite__mapDeps([331,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,122,167,326,93,94,95,68,61,96,97,98,99,100,84,49,101,102,57,58,327,328,312,329,291,330,303,304,305,306,69,70,71,162,48,62,53,54,55,60,56,163,164,165,169,332,158,125,123,124,50,59,77,136,92,137,80,133,79,81,75,138,118,119,72,139,140,141,142,111,143,144,145,146,147,148,261,156,157,106,107,108,109,150,242]),import.meta.url));if(b(s))return s;const c=(l=(n=this.view)==null?void 0:n.inputManager)==null?void 0:l.isModifierKeyDown(_.constraint);return new s.module.default({graphics:t,enableRotation:a,enableScaling:i,highlightsEnabled:!!(r!=null&&r.enabled),preserveAspectRatio:!!h!=!!c,layer:this._internalGraphicsLayer,view:o,sketchOptions:this.sketchOptions,callbacks:{onMoveStart:p=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...p},type:"update"}),onMove:p=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...p},type:"update"}),onMoveStop:p=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...p},type:"update"}),onScaleStart:p=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...p},type:"update"}),onScale:p=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...p},type:"update"}),onScaleStop:p=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...p},type:"update"}),onRotateStart:p=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...p},type:"update"}),onRotate:p=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...p},type:"update"}),onRotateStop:p=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...p},type:"update"})}})}async _getReshape(t,e,o){var s,c,n;const a=((s=e.reshapeOptions)==null?void 0:s.edgeOperation)==="split",i=((c=e.reshapeOptions)==null?void 0:c.shapeOperation)==="move",r=!!((n=e.highlightOptions)!=null&&n.enabled),h=await this._requireModule(S(()=>import("./Reshape-DeuLtJts.js"),__vite__mapDeps([333,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,93,94,95,68,61,96,97,98,99,100,84,49,101,102,57,58,114,47,48,50,51,52,53,54,55,56,59,60,62,63,64,65,66,67,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,85,86,87,88,89,167,326,327,328,312,329,291,330,303,304,305,306,162,163,164,165,169,122,136,92,137,133,138,118,119,139,140,141,142,111,143,144,124,145,146,147,123,148,241,149,150,151,152,153,154,155,106,107,108,109,242,156,157,332,115,116,158,125,126]),import.meta.url));return b(h)?h:new h.module.default({enableMidpoints:a,enableMovement:i,graphic:t[0],highlightsEnabled:r,layer:this._internalGraphicsLayer,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions,view:o,callbacks:{onReshapeStart:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onReshape:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onReshapeStop:({mover:l,type:p})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:l,type:p},type:"update"}),onMoveStart:({dx:l,dy:p,mover:g,type:u})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:l,dy:p,mover:g,type:u},type:"update"}),onMove:({dx:l,dy:p,mover:g,type:u})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:l,dy:p,mover:g,type:u},type:"update"}),onMoveStop:({dx:l,dy:p,mover:g,type:u})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:l,dy:p,mover:g,type:u},type:"update"}),onVertexAdd:({added:l,type:p,vertices:g})=>{const u=l.map(d=>Y(d.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:u,vertices:g,type:p},type:"update"})},onVertexRemove:({removed:l,type:p,vertices:g})=>{const u=l.map(d=>Y(d.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{removed:u,vertices:g,type:p},type:"update"})}}})}_getHandlesForComponent(t,e){const o=t.activeComponent;if(!o)return[];switch(o.type){case"graphic-mover":return[o.on("graphic-click",({graphic:a,viewEvent:i})=>{var r;(r=i.native)!=null&&r.shiftKey&&(i.stopPropagation(),t.removeFromSelection(a))}),o.on("graphic-move-start",a=>t.addToHistory(C(a.allGraphics)))];case"box":return[o.on("graphic-click",a=>this._onTransformOrReshape2DGraphicClick(t,e,a)),o.on("move-start",a=>t.addToHistory(C(a.graphics))),o.on("rotate-start",a=>t.addToHistory(C(a.graphics))),o.on("scale-start",a=>t.addToHistory(C(a.graphics)))];case"reshape":return[o.on("graphic-click",a=>this._onTransformOrReshape2DGraphicClick(t,e,a)),o.on("move-start",a=>t.addToHistory(C([a.mover]))),o.on("reshape-start",a=>t.addToHistory(C([a.graphic]))),o.on("vertex-add",a=>t.addToHistory(C([a.oldGraphic]))),o.on("vertex-remove",a=>t.addToHistory(C([a.oldGraphic])))];case"move-3d":return[o.events.on("record-undo",({updates:a})=>{t.addToHistory({updates:a})}),o.events.on("move-start",a=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:a.objects.length>0?a.objects[0].graphic:null,type:"move-start"},type:"update"})}),o.events.on("move",a=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:a.dx,dy:a.dy,mover:a.objects.length>0?a.objects[0].graphic:null,type:"move"},type:"update"})}),o.events.on("move-stop",a=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:a.objects.length>0?a.objects[0].graphic:null,type:"move-stop"},type:"update"})}),o.events.on("immediate-click",a=>{a.shiftKey?this._toggleSelection([a.object.graphic],t,e):t.toggleTool()})];case"transform-3d":return[o.events.on("record-undo",({updates:a})=>{t.addToHistory({updates:a})}),o.events.on("translate-start",a=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:a.object.graphic,dx:a.dxScreen,dy:a.dyScreen,type:"move-start"},type:"update"})}),o.events.on("translate-stop",a=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:a.object.graphic,dx:a.dxScreen,dy:a.dyScreen,type:"move-stop"},type:"update"})}),o.events.on("rotate-start",a=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:a.object.graphic,angle:a.angle,type:"rotate-start"},type:"update"})}),o.events.on("rotate-stop",a=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:a.object.graphic,angle:a.angle,type:"rotate-stop"},type:"update"})}),o.events.on("scale-start",a=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:a.object.graphic,xScale:a.xScale,yScale:a.yScale,type:"scale-start"},type:"update"})}),o.events.on("scale-stop",a=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:a.object.graphic,xScale:a.xScale,yScale:a.yScale,type:"scale-stop"},type:"update"})}),o.events.on("translate",a=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:a.object.graphic,dx:a.dxScreen,dy:a.dyScreen,type:"move"},type:"update"})}),o.events.on("rotate",a=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:a.object.graphic,angle:a.angle,type:"rotate"},type:"update"})}),o.events.on("scale",a=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:a.object.graphic,xScale:a.xScale,yScale:a.yScale,type:"scale"},type:"update"})}),o.events.on("immediate-click",a=>{a.shiftKey?this._toggleSelection([a.object.graphic],t,e):t.toggleTool()})];case"reshape-3d":return[o.events.on("reshape",a=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...a,mover:a.object.graphic},type:"update"})}),o.events.on("move",a=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...a,mover:a.object.graphic},type:"update"})}),o.events.on("vertex-add",a=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:a,type:"update"})}),o.events.on("vertex-remove",a=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:a,type:"update"})}),o.events.on("immediate-click",a=>{a.shiftKey?this._toggleSelection([a.object.graphic],t,e):t.toggleTool()})]}}_onTransformOrReshape2DGraphicClick(t,e,o){var r;const{graphic:a,viewEvent:i}=o;return(r=i.native)!=null&&r.shiftKey&&a.layer===this.layer?(i.stopPropagation(),t.removeFromSelection(a)):e.toggleToolOnClick?(i.stopPropagation(),t.toggleTool()):void 0}_setUpdateOperationHandle(t,e){var i;this._operationHandle=t;const o=(i=this.view)==null?void 0:i.map;this._disablePopup(e);const a=()=>{if(t===this._operationHandle){const r=this.updateGraphics.toArray(),h=this._operationHandle.tool;this._operationHandle.destroy(),this._operationHandle=null,this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray()),this.updateGraphics.removeAll(),o&&o.remove(this._internalGraphicsLayer),this._restorePopup(e),this.emit("update",{graphics:r,state:"complete",aborted:t.cancelled,tool:h,toolEventInfo:null,type:"update"})}};t.on("complete",a)}async _getCommonUpdateOperationClickHandlers(t,e,o){const a=Q(e),i=await e.async(()=>this._getFirstHit(a));if(i==null)return void t.complete();if(e.native.shiftKey&&this._toggleSelection([i.graphic],t,o))return void e.stopPropagation();this.updateGraphics.includes(i.graphic)?e.stopPropagation():t.complete()}_toggleSelection(t,e,o){const a=!!o.multipleSelectionEnabled;return t.some(i=>i!=null&&!(!a||i.layer!==this.layer)&&(this.updateGraphics.includes(i)?e.removeFromSelection(i):e.addToSelection(i),!0))}_getCommonUpdateOperationKeyDownHandlers(t,e){if(!t)return;const o=e.key;o===_.undo&&t.canUndo()?(e.stopPropagation(),t.undo()):o===_.redo&&t.canRedo()?(e.stopPropagation(),t.redo()):o===_.cancel?(e.stopPropagation(),t.cancel()):this.allowDeleteKey&&_.delete.includes(o)&&this._onDeleteKey(e)}_onDeleteKey(t){var a;if(!this._operationHandle||this._operationHandle.type!=="update")return;const e=this.activeComponent,o=this.updateGraphics.toArray();e!=null&&(e.type!=="reshape"||o.length===1&&((a=o[0].geometry)==null?void 0:a.type)==="point")&&(t.stopPropagation(),this.delete())}_removeDefaultLayer(){var t,e;this._internalGraphicsLayer&&((e=(t=this.view)==null?void 0:t.map)==null||e.remove(this._internalGraphicsLayer),this._internalGraphicsLayer=D(this._internalGraphicsLayer))}_isComponentGraphic(t){var o;const{activeComponent:e}=this;return!(!t||e==null)&&(((o=t.attributes)==null?void 0:o.esriSketchTool)||e.type==="draw-2d"&&e.graphic===t||(e.type==="box"||e.type==="reshape")&&e.isUIGraphic(t))}_displayPointerCursor(){var t;(t=this.view)!=null&&t.container&&this.view.cursor!=="pointer"&&(this.view.cursor="pointer")}_displayGrabbingCursor(){var t;(t=this.view)!=null&&t.container&&this.view.cursor!=="grabbing"&&(this.view.cursor="grabbing")}_displayDefaultCursor(){var t;(t=this.view)!=null&&t.container&&this.view.cursor!==null&&(this.view.cursor=null)}_logError(t,e,o){lt.getLogger(this).error(new ht(t,e,o))}async _requireModule(t){const e=new AbortController;this._moduleLoaderAbortController=e;const o=await t;return this._moduleLoaderAbortController!==e||e.signal.aborted?{requireError:"aborted"}:{module:o}}_emitUndoEvent(t){this.emit("undo",{...t,type:"undo"})}_emitRedoEvent(t){this.emit("redo",{...t,type:"redo"})}_emitDeleteEvent(t){this.emit("delete",{...t,type:"delete"})}get test(){}wait(){return q(()=>!this.updating)}_beginAsyncOperation(){this._numUpdating+=1,this.notifyChange("updating")}_endAsyncOperation(){this._numUpdating-=1,this.notifyChange("updating")}_disablePopupEnabled(t){var e;return((e=this.view)==null?void 0:e.type)!=="3d"||this.updateOnGraphicClick||((t==null?void 0:t.toggleToolOnClick)??!1)}_disablePopup(t){this._disablePopupEnabled(t)&&this.view&&this._originalPopupEnabled==null&&(this._originalPopupEnabled=this.view.popupEnabled,this.view.popupEnabled=!1)}_restorePopup(t){this._disablePopupEnabled(t)&&this.view&&this._originalPopupEnabled!=null&&(this.view.popupEnabled=this._originalPopupEnabled,this._originalPopupEnabled=null)}async _waitViewReady(){const t=this.view;t?(V(this._viewReadyAbortController),this._viewReadyAbortController=new AbortController,await ct(q(()=>t==null?void 0:t.ready),this._viewReadyAbortController.signal)):this._logMissingView()}_logMissingView(){this._logError("sketch:missing-property",et("view"))}_logMissingLayer(){this._logError(Ut,et("layer"))}};y([m()],v.prototype,"_defaultSnappingManager",void 0),y([m()],v.prototype,"updating",null),y([m()],v.prototype,"_operationHandle",void 0),y([m({readOnly:!0})],v.prototype,"activeTool",null),y([m()],v.prototype,"activeTooltip",null),y([m()],v.prototype,"activeFillSymbol",void 0),y([m()],v.prototype,"activeLineSymbol",void 0),y([m()],v.prototype,"activeVertexSymbol",void 0),y([m()],v.prototype,"allowDeleteKey",void 0),y([m({readOnly:!0})],v.prototype,"createGraphic",null),y([m()],v.prototype,"defaultCreateOptions",null),y([m()],v.prototype,"defaultUpdateOptions",null),y([m({type:At,nonNullable:!0})],v.prototype,"labelOptions",null),y([m()],v.prototype,"layer",void 0),y([m({types:k})],v.prototype,"pointSymbol",void 0),y([m({types:k})],v.prototype,"polygonSymbol",void 0),y([m({types:k})],v.prototype,"polylineSymbol",void 0),y([m()],v.prototype,"meshSymbol",void 0),y([m({type:rt,nonNullable:!0})],v.prototype,"snappingOptions",null),y([m()],v.prototype,"snappingManager",null),y([m({readOnly:!0})],v.prototype,"state",null),y([m({type:wt,nonNullable:!0})],v.prototype,"tooltipOptions",null),y([m({readOnly:!0})],v.prototype,"updateGraphics",void 0),y([m()],v.prototype,"updateOnGraphicClick",void 0),y([m({type:Gt,nonNullable:!0})],v.prototype,"valueOptions",null),y([m({types:k})],v.prototype,"vertexSymbol",void 0),y([m({value:null})],v.prototype,"view",null),y([m({constructOnly:!0,type:it})],v.prototype,"sketchOptions",void 0),v=y([L("esri.widgets.Sketch.SketchViewModel")],v);const Ut="sketch:missing-property",et=t=>`Property '${t}' is missing on SketchViewModel.`;function xt(t){return t==="polygon"||t==="rectangle"||t==="circle"}function H(t,e){st("undo",t.history.undo,t.history.redo,e)}function P(t,e){st("redo",t.history.redo,t.history.undo,e)}function st(t,e,o,a){const i=e.pop();if(!i)return;const r=i.updates,h=[];a.forEach((s,c)=>{const n=r[c];n!=null&&("geometry"in n&&n.geometry!=null&&(h.push({geometry:s.geometry}),s.geometry=n.geometry),"symbol"in n&&n.symbol!=null&&(h.push({symbol:s.symbol}),s.symbol=n.symbol),"undo"in n&&(h.push(n),n[t](s)))}),o.push({updates:h})}function ot(t,e){t!=null&&e.hasGrabbedManipulators&&(t.activeTool=null)}function C(t){return{updates:t.map(({geometry:e})=>(e==null?void 0:e.type)==="mesh"?{geometry:e.cloneShallow()}:{geometry:e})}}function U(t,e){var o;(o=t.tools)==null||o.remove(e),e.destroyed||e.destroy()}function b(t){return"requireError"in t&&t.requireError==="aborted"}const pe=v;export{pe as c};
