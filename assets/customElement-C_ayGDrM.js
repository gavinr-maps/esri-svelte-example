const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-BtF7Kdcs.js","./index-CjrYEQXz.js","./jsxFactory-CLjKarlq.js","./Accessor-BHnuXKD2.js","./intl-Do3GEEJ7.js","./Promise-CmQqe-ke.js","./cast-BA_-jlhc.js","./index-tefRSezt.js","./index-Cx51aysm.css","./JSONSupport-CGdeqxpk.js","./Evented-DCWccWGU.js","./reactiveUtils-BR0C1Kq4.js","./SimpleObservable-7oieNGD8.js","./uuid-Cl5lrJ4c.js","./guid-ejniuQmw.js","./useT9n-CJAswmP1.js","./index-73bQemcW.js","./dom--xxYYVQF.js","./observers-BdozwIHb.js","./ref-Ccn4I0kT.js","./directive-helpers-C0aXnQdc.js","./static-g4FJ4v8I.js","./form-B15gmg4q.js","./interactive-B8siLByk.js","./label-BLne9qNB.js","./loadable-DOQnSSjG.js","./component-CFGnHAqh.js","./index-B7QXL93z.js","./key-CZcQa38B.js","./index-Wn4pOF_U.js","./index-Ch_sYKt7.js","./index-svtat3zr.js","./live-BIBBLA6F.js","./keyed-CdPY5MOf.js","./locale-CXx8I9ox.js","./Validation-O1TFEQW-.js","./input-DI9tZAPS.js","./index-D130RxMY.js","./index-DxcTRSkS.js","./index-CQ1gJMW-.js"])))=>i.map(i=>d[i]);
import{_ as C,i as Z,L as Q,u as X,c as Y,n as tt,a as et}from"./index-tefRSezt.js";import{r,m as d,a as B,g as it,B as T,s as b,b8 as ot}from"./Accessor-BHnuXKD2.js";import{n as st,a as N}from"./cast-BA_-jlhc.js";import{e as O,O as nt,c as rt,n as s,g as D,y as at}from"./jsxFactory-CLjKarlq.js";import{f as lt,b as dt,M as pt}from"./Graphic-CFXUQZlS.js";import{f as ct}from"./intl-Do3GEEJ7.js";import{V as M,d as E,p as ht,P as ut}from"./reactiveUtils-BR0C1Kq4.js";import{i as mt}from"./Evented-DCWccWGU.js";import{j as J}from"./Point-XGrwlf63.js";import{K as vt}from"./projection-B2I9Bzj_.js";import{R as j,p as _t,c as A,u as gt,f as wt}from"./formatUtils-DMCnWBkV.js";import{t as bt}from"./GoTo-BsXOAO95.js";import{h as yt,r as G}from"./Promise-CmQqe-ke.js";import{e as $}from"./globalCss-CZa70j6i.js";import{e as R}from"./Heading-DYbI16WN.js";import{i as ft}from"./legacyIcon-CEIp6Pa9.js";import{t as y}from"./accessibleHandler-rIBXQ52V.js";import{P as Ct}from"./useWidget-Dlf3SkC7.js";import"./JSONSupport-CGdeqxpk.js";import"./uuid-Cl5lrJ4c.js";import"./Clonable-DvJsj5LF.js";import"./writer-B2bQV2uU.js";import"./opacityUtils-CSd4XoR2.js";import"./enumeration-Cr5WIZs4.js";import"./Color-gncXBiLc.js";import"./colorUtils-Rxh2V3ai.js";import"./mathUtils-DV9iOXpW.js";import"./ActionToggle-__-l4AdQ.js";import"./Identifiable-BrT7zvUW.js";import"./jsonUtils-Cu7OBRmN.js";import"./Extent-CBBGeHb-.js";import"./Polyline-BmuD2-ZN.js";import"./typeUtils-BSg8Y507.js";import"./TextSymbol-BQ_NW9Xo.js";import"./screenUtils-_ZIvrt5o.js";import"./collectionUtils-CbaToa73.js";import"./Portal-CTRRujjZ.js";import"./vec3f64-BLpZdpfb.js";import"./aaBoundingBox-CeBivBRq.js";import"./SimpleObservable-7oieNGD8.js";import"./projectBuffer-DOU0xvVi.js";import"./geodesicConstants-yASAK_zX.js";import"./number-BWHn6sm2.js";import"./coordinateFormatter-DRC3YXJ-.js";import"./index-BkKcLxWB.js";import"./component-utils-DWY0IMHC.js";let P=class extends it{constructor(t){super(t),this.format=null,this.position={coordinate:null,location:null}}get displayCoordinate(){var t,e;return(e=this.format)==null?void 0:e.getDisplayCoordinate((t=this.position)==null?void 0:t.coordinate)}};r([d({readOnly:!0})],P.prototype,"displayCoordinate",null),r([d({type:j})],P.prototype,"format",void 0),r([d()],P.prototype,"position",void 0),P=r([B("esri.widgets.CoordinateConversion.support.Conversion")],P);const f=P,x={default:"default",crosshair:"crosshair"},Pt=new J([0,0,500]),Tt="xy",Mt=["mgrs","utm","usng","dd","dms","ddm"],H="esri__coordinateConversionWidgetState",w={conversions:"conversions",formats:"formats",view:"view",viewChange:"view-change"},$t="esri/images/search/search-symbol-32.png";let v=class extends bt(mt.EventedAccessor){constructor(t){super(t),this._conversionPromise=null,this._locationGraphic=null,this._pointerCount=0,this.conversions=new M,this.formats=new M,this.formatterAvailable=!1,this.messages=null,this.filteredFormats=new M,this.locationSymbol=new lt({url:st($t),width:24,height:24}),this.storageEnabled=!0,this.storageType="session",this.view=null,this._saveWidgetState=this._saveWidgetState.bind(this),this._handleFormatChange=this._handleFormatChange.bind(this),this._handleConversionChange=this._handleConversionChange.bind(this),this._handleViewChange=this._handleViewChange.bind(this),this._onClick=this._onClick.bind(this),this._onPointerMove=this._onPointerMove.bind(this),this._onPointerDown=this._onPointerDown.bind(this),this._onPointerUp=this._onPointerUp.bind(this)}initialize(){const t=async()=>this.messages=await ct("esri/widgets/CoordinateConversion/t9n/CoordinateConversion");this.formats.addMany(_t()),t().then(()=>{if(!this.destroyed&&(A(this.messages,this.formats),this.storageEnabled&&this._loadWidgetState(),this.formats.forEach(e=>{e.viewModel=this,this.addHandles(E(()=>e.currentPattern,this._saveWidgetState),e.name??"unnamed-format")}),this.addHandles(this.conversions.on("change",this._handleConversionChange),w.conversions),this.addHandles(this.formats.on("change",this._handleFormatChange),w.formats),this.addHandles(yt(()=>{t().then(()=>{A(this.messages,this.formats)})})),vt().then(()=>{this.formatterAvailable=!0}).catch(e=>{T.getLogger(this).error(new b("coordinate-conversion:projection-load-failed","Failed to load the projection module.",{error:e})),this.formatterAvailable=!1,this._filterFormatsAndConversions()}).then(()=>this.addHandles(E(()=>this.view,this._handleViewChange,ut),w.viewChange)),this.conversions.length===0)){const e=this.formats.find(i=>i.name===Tt)||this.formats.at(0);this.conversions.add(new f({format:e}))}})}destroy(){this.removeHandles(),this._cleanUpView(this.view),this.view=null}castConversions(t){return this._castToConversions(t)}set currentLocation(t){this._set("currentLocation",t),this._updateConversions()}get currentLocation(){return this._get("currentLocation")||null}set mode(t){switch(t){case"capture":this.currentLocation=null,this._startCaptureMode(),this._set("mode",t);break;case"live":this._startLiveMode(),this._set("mode",t)}}get mode(){return this._get("mode")||"live"}get state(){const{messages:t,view:e}=this,i=e==null?void 0:e.ready;return t?i?"ready":e?"loading":"disabled":"disabled"}get storage(){const{storageType:t}=this;return t==="session"?sessionStorage:localStorage}get waitingForConversions(){return this._conversionPromise!=null}setLocation(t){var i,o;if(this._locationGraphic&&((i=this.view)==null||i.graphics.remove(this._locationGraphic)),!t)return;const e=t.clone();e.hasZ&&(e.z=void 0),this._locationGraphic=new dt({geometry:e,symbol:this.locationSymbol}),(o=this.view)==null||o.graphics.add(this._locationGraphic)}async convert(t,e){if(!gt(e))throw new b("coordinate-conversion:invalid-point","Invalid point cannot be converted.",{point:e});return Promise.resolve().then(()=>t.convert(e))}async goToLocation(t){var n,a,p;const{view:e}=this;if(!e)throw new b("coordinate-conversion:go-to-failed","no view");const i=e.type==="3d"?e.clippingArea:null,o=(a=(n=e.map)==null?void 0:n.basemap)==null?void 0:a.baseLayers;if(i||((o==null?void 0:o.length)??0)>0){const m=i??((p=o==null?void 0:o.at(0))==null?void 0:p.fullExtent);if(m!=null&&!m.contains(t))throw new b("coordinate-conversion:go-to-failed","Point outside basemap extent.",{point:t})}return this.callGoTo({target:t})}pause(){this.currentLocation=null,this.removeHandles(w.view),this.view&&(this.view.cursor=x.default,this._locationGraphic&&this.view.graphics.remove(this._locationGraphic))}async previewConversion(t,e=this.currentLocation||Pt){return(await U(t,e)).displayCoordinate}resume(){this.mode==="capture"?this._startCaptureMode():this._startLiveMode()}reverseConvert(t,e){return e.reverseConvert(t)}async updateConversions(t,e){if((e==null?void 0:e.type)!=="point")throw this._clearConversions(this.conversions),new b("coordinate-conversion:invalid-input-point","Point is invalid, conversions cannot be updated.",{point:e});return this._convertMany(t,e)}_castToConversions(t){const e=new M;return t.forEach(i=>{let o=null;if(i instanceof f)o=i;else if(typeof i=="string"){const n=this.formats.find(a=>a.name===i);n&&(o=new f({format:n}))}o&&e.add(o)}),e}_cleanUpView(t){t&&(this._locationGraphic&&t.graphics.remove(this._locationGraphic),this.removeHandles(w.view),t.cursor=x.default)}_clearConversions(t){t.forEach(e=>{e.position={location:null,coordinate:null}})}async _convertMany(t,e){return Promise.all(t.map(i=>U(i,e)))}_handleConversionChange(t){for(const e of t.added){const{format:i}=e;i&&(i.viewModel=this,this.currentLocation&&(this._set("waitingForConversions",!0),this.convert(i,this.currentLocation).then(o=>{e.position=o,this._set("waitingForConversions",!1)})))}this._saveWidgetState()}_handleFormatChange(t){t.added.forEach(e=>{this.addHandles(E(()=>e.currentPattern,this._saveWidgetState),e.name??"unnamed-format"),e.viewModel=this}),t.removed.forEach(e=>{e.viewModel=null;const i=this.conversions.filter(o=>o.format===e);this.conversions.removeMany(i),e.name&&this.removeHandles(e.name)})}_loadWidgetState(){try{const t=JSON.parse(this.storage.getItem(H));t&&this._setWidgetState(t)}catch(t){T.getLogger(this).error(new b("coordinate-conversion:invalid-session-storage-json","Could not read from storage.",{error:t}))}}_startCaptureMode(){this.removeHandles(w.view),this.view&&(this.view.cursor=x.crosshair,this.currentLocation&&this.setLocation(this.currentLocation),this.addHandles(this.view.on("click",this._onClick),w.view))}_startLiveMode(){this._pointerCount=0,this.removeHandles(w.view),this.view&&(this.view.cursor=x.default,this._locationGraphic&&this.view.graphics.remove(this._locationGraphic),this.addHandles([this.view.on("pointer-down",this._onPointerDown),this.view.on("pointer-up",this._onPointerUp),this.view.on("pointer-move",this._onPointerMove)],w.view))}_handleViewChange(t,e){e&&e!==t&&this._cleanUpView(e),t&&(this.mode==="capture"?this._startCaptureMode():this._startLiveMode(),e&&this._filterFormatsAndConversions())}_onClick(t){var e;if(t.button===0){const i=(e=this.view)==null?void 0:e.toMap(t),o=i==null?void 0:i.normalize();this.setLocation(o),this.currentLocation=o}}_onPointerDown(t){var i;const{pointerType:e}=t;if(this._pointerCount++,(e==="touch"||e==="pen")&&this._pointerCount===1){const o=(i=this.view)==null?void 0:i.toMap(t);this.currentLocation=o==null?void 0:o.normalize()}}_onPointerMove(t){var i;const{pointerType:e}=t;if(e==="mouse"||this._pointerCount===1){const o=(i=this.view)==null?void 0:i.toMap(t);this.currentLocation=o==null?void 0:o.normalize()}}_onPointerUp(){this._pointerCount--}_setWidgetState(t){try{t.formats.forEach(e=>{const i=this.formats.find(o=>o.name===e.name);i&&t.locale===G()&&e.currentPattern&&(i.currentPattern=e.currentPattern),i&&e.index>=0&&this.conversions.add(new f({format:i}))})}catch(e){T.getLogger(this).warn(new b("coordinate-conversion:session-storage-read-error","Could not get widget state from stored JSON.",{error:e}))}}_saveWidgetState(){if(!this.storageEnabled)return;const t=this._toJSON();try{this.storage.setItem(H,JSON.stringify({formats:t,locale:G()}))}catch(e){T.getLogger(this).error(new b("coordinate-conversion:local-storage-write-error","Could not write to localStorage.",{error:e}))}}async _updateConversions(){try{await this.updateConversions(this.conversions.toArray(),this.currentLocation)}catch{}}_toJSON(){return this.formats.filter(t=>{const e=t.name;return e==="xy"||e==="basemap"||wt(e)}).map(t=>({name:t.name,currentPattern:t.currentPattern,defaultPattern:t.defaultPattern,index:this.conversions.findIndex(e=>e.format===t)})).sort((t,e)=>t.index-e.index).toArray()}_filterFormatsAndConversions(){const{formatterAvailable:t,conversions:e,formats:i}=this;t||this.addHandles(ht(()=>{var o;return(o=this.view)==null?void 0:o.spatialReference},o=>{const n=o.isWebMercator||o.isWGS84,a=i.filter(u=>{const{name:_}=u;return!!It(_)||_==="xy"&&!n}),p=this.filteredFormats.filter(u=>u.name==="xy"&&n&&!this.formats.includes(u)),m=e.filter(u=>a.includes(u.format));i.removeMany(a),e.removeMany(m),this.filteredFormats.addMany(a.filter(u=>!this.filteredFormats.includes(u))),i.addMany(p)},{once:!0,initial:!0}),w.view)}};async function U(t,e){var i;try{t.position=await((i=t.format)==null?void 0:i.convert(e))}catch{t.position=null}return t}function It(t){return Mt.includes(t)}r([d({type:M.ofType(f)})],v.prototype,"conversions",void 0),r([N("conversions")],v.prototype,"castConversions",null),r([d({type:J})],v.prototype,"currentLocation",null),r([d({type:M.ofType(j)})],v.prototype,"formats",void 0),r([d()],v.prototype,"messages",void 0),r([d()],v.prototype,"mode",null),r([d()],v.prototype,"filteredFormats",void 0),r([d({readOnly:!0})],v.prototype,"state",null),r([d({types:pt})],v.prototype,"locationSymbol",void 0),r([d({readOnly:!0,dependsOn:["storageType"]})],v.prototype,"storage",null),r([d()],v.prototype,"storageEnabled",void 0),r([d()],v.prototype,"storageType",void 0),r([d({readOnly:!0})],v.prototype,"waitingForConversions",null),r([d()],v.prototype,"view",void 0),v=r([B("esri.widgets.CoordinateConversion.CoordinateConversionViewModel")],v);const q=v,h="esri-coordinate-conversion",l={base:h,captureMode:`${h}--capture-mode`,noBasemap:`${h}--no-basemap`,popup:`${h}__popup`,clipboardPopup:`${h}__clipboard-popup`,conversionList:`${h}__conversion-list`,conversionRow:`${h}__row`,coordDisplay:`${h}__display`,expandButton:`${h}__expand-button`,expanded:`${h}__conversions-view--expanded`,expandDown:`${h}__conversions-view--expand-down`,expandUp:`${h}__conversions-view--expand-up`,conversionsView:`${h}__conversions-view`,rowSelect:`${h}__select-row`,toolDisplay:`${h}__tools`,modeToggle:`${h}__mode-toggle`,rowButton:`${h}__row-button`,coordinateInput:`${h}__input-coordinate`,inputForm:`${h}__input-form`,inputFormGroup:`${h}__input-group`,inputSelect:`${h}__input-select`,sectionHeading:`${h}__heading`,patternInput:`${h}__pattern-input`,settings:`${h}__settings`,settingsFormGroup:`${h}__settings-group`,settingsFormGroupHorizontal:`${h}__settings-group-horizontal`,previewCoordinate:`${h}__preview-coordinate`},W={settingsButton:!0,inputButton:!0,captureButton:!0,expandButton:!0},xt=750,Lt=2500;let c=class extends nt{constructor(t,e){super(t,e),this._popupMessage=null,this._popupTimeoutId=void 0,this._clipboardPopupTimeoutId=void 0,this._coordinateInput=null,this._badInput=!1,this._goToEnabled=!1,this._conversionFormat=null,this._settingsFormat=null,this._previewConversion=null,this._expanded=!1,this._clipboardPopupVisible=!1,this._popupVisible=!1,this._settingsVisible=!1,this._inputVisible=!1,this.headingLevel=4,this.messages=null,this.messagesCommon=null,this.orientation="auto",this.viewModel=new q,this.visibleElements={...W}}loadDependencies(){return rt({button:()=>C(()=>import("./index-BtF7Kdcs.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]),import.meta.url),checkbox:()=>C(()=>import("./index-B7QXL93z.js"),__vite__mapDeps([27,2,3,4,5,6,7,8,9,10,11,12,13,19,20,17,14,22,23,28,24,25]),import.meta.url),input:()=>C(()=>import("./index-Wn4pOF_U.js"),__vite__mapDeps([29,16,2,3,4,5,6,7,8,9,10,11,12,13,17,14,18,30,31,32,20,33,19,21,22,23,28,24,25,34,26,35,15,36]),import.meta.url),label:()=>C(()=>import("./index-D130RxMY.js"),__vite__mapDeps([37,2,3,4,5,6,7,8,9,10,11,12,13,24,17,14]),import.meta.url),option:()=>C(()=>import("./index-DxcTRSkS.js"),__vite__mapDeps([38,2,3,4,5,6,7,8,9,10,11,12,13,18]),import.meta.url),select:()=>C(()=>import("./index-CQ1gJMW-.js"),__vite__mapDeps([39,16,2,3,4,5,6,7,8,9,10,11,12,13,17,14,18,30,19,20,22,23,24,25,26,35]),import.meta.url)})}get conversions(){return this.viewModel.conversions}set conversions(t){this.viewModel.conversions=t}get currentLocation(){return this.viewModel.currentLocation}set currentLocation(t){this.viewModel.currentLocation=t}get formats(){return this.viewModel.formats}set formats(t){this.viewModel.formats=t}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(t){this.viewModel.goToOverride=t}get icon(){return"coordinate-system"}set icon(t){this._overrideIfSome("icon",t)}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}get mode(){return this.viewModel.mode}set mode(t){this.viewModel.mode=t}set multipleConversions(t){t===!1&&(this._expanded=!1,this.conversions.splice(1,this.conversions.length-1)),this._set("multipleConversions",t)}get multipleConversions(){const t=this._get("multipleConversions");return typeof t!="boolean"||t}get locationSymbol(){return this.viewModel.locationSymbol}set locationSymbol(t){this.viewModel.locationSymbol=t}get storageEnabled(){return this.viewModel.storageEnabled}set storageEnabled(t){this.viewModel.storageEnabled=t}get storageType(){return this.viewModel.storageType}set storageType(t){this.viewModel.storageType=t}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}castVisibleElements(t){return{...W,...t}}reverseConvert(t,e){return this.viewModel.reverseConvert(t,e)}render(){var m,u;const t=(m=this.viewModel)==null?void 0:m.state,e=t==="disabled"?s("div",{key:"esri-coordinate__no-basemap"},(u=this.messages)==null?void 0:u.noBasemap):null,i=!e&&this._inputVisible?this._renderInputForm():null,o=!e&&this._settingsVisible?this._renderSettings():null,n=e||i||o?null:this._renderConversionsView(),a=this._popupVisible?this._renderPopup():null,p={[l.captureMode]:this.mode==="capture",[$.disabled]:t==="loading",[l.noBasemap]:t==="disabled"};return s("div",{class:this.classes(l.base,$.widget,p)},a,e,n,o,i)}_addConversion(t){const e=t.target,i=e.selectedOption.value,o=z(e);if(i==null||o==null)return;const n=new f({format:i});e.value="default",o>=0?(this.conversions.removeAt(o),this.conversions.add(n,o)):this.conversions.add(n)}_findSettingsFormat(){return this._settingsFormat||this.conversions.reduceRight((t,e)=>{const i=e.format;return i!=null&&i.hasDisplayProperties?i:t},null)||this.formats.find(t=>t.hasDisplayProperties)}_hidePopup(){this._popupTimeoutId&&(clearTimeout(this._popupTimeoutId),this._popupTimeoutId=void 0),this._popupVisible=!1,this._popupMessage=null,this.scheduleRender()}_hideClipboardPopup(){this._clipboardPopupTimeoutId&&(clearTimeout(this._clipboardPopupTimeoutId),this._clipboardPopupTimeoutId=void 0),this._clipboardPopupVisible=!1,this.scheduleRender()}_onConvertComplete(){this._inputVisible=!1,this._coordinateInput.value=""}_onCopy(t){var i,o;const e=(i=Ft(t.currentTarget))==null?void 0:i.displayCoordinate;e!=null&&((o=t.clipboardData)==null||o.setData("text/plain",e),this._showClipboardPopup(),t.preventDefault())}_processUserInput(t){const e=ot(t,"key"),i=this.viewModel;if(e!=="Enter"&&e)this._badInput&&(this._badInput=!1);else{const o=this._conversionFormat||this.conversions.at(0).format;if(!o)return;const n=this._coordinateInput.value;this._reverseConvert(n,o).then(a=>{this.mode==="capture"?i.resume():this.mode="capture",this.currentLocation=a,i.setLocation(a),this._onConvertComplete()}).catch(a=>{var p;T.getLogger(this).error(a),this._showPopup((p=this.messages)==null?void 0:p.invalidCoordinate),this._badInput=!0})}}async _reverseConvert(t,e){const i=this.viewModel,o=await e.reverseConvert(t);return this._goToEnabled&&o&&i.goToLocation(o).catch(n=>{var a;T.getLogger(this).warn(n),this._showPopup((a=this.messages)==null?void 0:a.locationOffBasemap)}),o}_setInputFormat(t){const e=t.target.selectedOption.value;e!=null&&(this._conversionFormat=e)}_setPreviewConversion(){var i,o;const t=this._findSettingsFormat(),e=this.viewModel;if(t){const n=this.conversions.find(a=>a.format===t);this._previewConversion=new f({format:t,position:{location:this.currentLocation,coordinate:(i=n==null?void 0:n.position)==null?void 0:i.coordinate}}),(o=this._previewConversion.position)!=null&&o.coordinate||e.previewConversion(this._previewConversion)}}_setSettingsFormat(t){const e=t.target.selectedOption.value;e!=null&&(this._settingsFormat=e,this._setPreviewConversion())}_showClipboardPopup(){this._clipboardPopupVisible?clearTimeout(this._clipboardPopupTimeoutId):this._clipboardPopupVisible=!0,this.scheduleRender(),this._popupTimeoutId=setTimeout(()=>{this._popupTimeoutId=void 0,this._hideClipboardPopup()},xt)}_showPopup(t,e=Lt){this._popupMessage=t,this._popupVisible?clearTimeout(this._popupTimeoutId):this._popupVisible=!0,this.scheduleRender(),this._popupTimeoutId=setTimeout(()=>{this._popupTimeoutId=void 0,this._hidePopup()},e)}_toggleGoTo(){this._goToEnabled=!this._goToEnabled}_updateCurrentPattern(t){t.stopPropagation();const e=t.target,i=this._findSettingsFormat();i&&(i.currentPattern=e.value)}_renderConversion(t,e){const{messages:i}=this;if(!i)return s("li",null);const{format:o}=t,n=(o==null?void 0:o.label)??"",a=`${this.id}__list-item-${e}`,p=`${n} ${i.conversionOutputSuffix}`,m=e===0,u=m||this._expanded,_=m?this._renderFirstConversion(t):this._renderTools(e,t,a),g=m&&!t.displayCoordinate?i.noLocation:t.displayCoordinate,L=s("div",{"aria-label":g,class:l.coordDisplay,"data-conversion":t,role:"listitem",tabIndex:0,title:g??""},g),S=this._renderOptions(this.formats.filter(F=>F!==o));return u?s("li",{"aria-label":p,class:l.conversionRow,id:a,key:t,role:"group",tabIndex:0,title:p},s("calcite-select",{"aria-controls":a,bind:this,class:l.rowSelect,"data-index":e,label:i.selectFormat,scale:"s",onCalciteSelectChange:this._addConversion},s("calcite-option",{label:n.toUpperCase(),selected:!0},n.toUpperCase()),S),L,_):null}_renderCopyButton(t){const e=this._clipboardPopupVisible&&this._renderClipboardPopup(),{messagesCommon:i}=this;return i?s("li",{"aria-label":i.copy,bind:this,class:this.classes($.widgetButton,l.rowButton),"data-conversion":t,onclick:this._copyCoordinateOutput,oncopy:this._onCopy,onkeydown:this._copyCoordinateOutput,role:"button",tabIndex:0,title:i.copy},e,s("span",{"aria-hidden":"true",class:ft.duplicate})):s("li",null)}_renderFirstConversion(t){const e=this.id,{messages:i,messagesCommon:o,multipleConversions:n,visibleElements:a}=this;if(!o||!i)return s("ul",null);const p=this.mode==="live"?i.captureMode:i.liveMode,m=this._expanded?o.collapse:o.expand,u=t.displayCoordinate&&this.mode==="capture"?this._renderCopyButton(t):null,_=n&&a.expandButton&&this._renderIconButton({iconType:this._expanded?"chevron-down":"chevron-up",clickFunction:this._toggleExpand,classes:[l.expandButton],attributes:{"aria-controls":`${e}__${l.conversionList}`,label:m}}),g=!n&&a.captureButton&&this._renderIconButton({iconType:this.mode==="live"?"pin-tear":"pin-tear-f",clickFunction:this._toggleMode,classes:[l.modeToggle],attributes:{label:p}});return s("ul",{class:l.toolDisplay},u,_,g)}_renderInputForm(){const t=this._conversionFormat||this.conversions.at(0).format,e=this.formats.findIndex(g=>g.name===(t==null?void 0:t.name)),i=this.id,o=`${i}__${l.coordinateInput}`,n=`${i}__${l.coordinateInput}__header`,a=this._renderOptions(this.formats,!0,e),{messages:p,messagesCommon:m,headingLevel:u}=this;if(!m||!p)return s("div",null);const _=this._renderIconButton({iconType:D(this.container)?"arrow-right":"arrow-left",clickFunction:this._toggleInputVisibility,attributes:{label:m.back}});return s("div",{"aria-labelledby":n,class:l.inputForm,key:"esri-coordinate-conversion__input-form",role:"search"},s("div",{class:l.sectionHeading},_,s(R,{class:$.heading,id:n,level:u},p.inputCoordTitle)),s("div",{class:l.inputFormGroup},s("calcite-select",{"aria-controls":o,bind:this,class:l.inputSelect,label:p.selectFormat,scale:"s",onCalciteSelectChange:this._setInputFormat},a),s("calcite-input",{afterCreate:at,"aria-labelledby":n,bind:this,class:l.coordinateInput,"data-format":t,"data-node-ref":"_coordinateInput",id:o,onkeydown:this._processUserInput,placeholder:p.inputCoordTitle,required:!0,scale:"s",spellcheck:!1,status:this._badInput?"invalid":"idle"})),s("div",{class:l.inputFormGroup},s("calcite-label",{layout:"inline",scale:"s"},s("calcite-checkbox",{bind:this,checked:this._goToEnabled,onCalciteCheckboxChange:this._toggleGoTo}),p.goTo),s("calcite-button",{appearance:"outline",bind:this,kind:"neutral",onclick:this._processUserInput,type:"button",width:"auto"},p.convert)))}_renderConversionsView(){const{messages:t}=this;if(!t)return s("div",null);const e=`${this.id}__${l.conversionList}`,i=this._renderPrimaryTools(),o=this._renderOptions(this.formats),n=this.conversions.map((m,u)=>this._renderConversion(m,u)).toArray(),a=this._expanded?s("div",{class:l.conversionRow},s("calcite-select",{"aria-controls":e,bind:this,"data-index":-1,label:t.addConversion,scale:"s",onCalciteSelectChange:this._addConversion},s("calcite-option",{disabled:!0,selected:!0,value:"default"},t.addConversion),o),i):null,p={[l.expanded]:this._expanded,[l.expandUp]:this.orientation==="expand-up",[l.expandDown]:this.orientation==="expand-down"};return s("div",{class:this.classes(l.conversionsView,p),key:"esri-coordinate-conversion__main-view"},s("ul",{"aria-expanded":this._expanded?"true":"false",class:l.conversionList,id:e},n),a)}_renderOptions(t,e,i){var a;const o=this.conversions.at(0),n=(a=o.format)==null?void 0:a.name;return t.map((p,m)=>{const u=!(e||!o)&&(n===p.name||this.conversions.map(_=>{var g;return(g=_.format)==null?void 0:g.name}).includes(p.name));return s("calcite-option",{disabled:u,key:p.name??"unnamed-format",label:p.label.toUpperCase(),selected:m===i,value:p},p.label)}).toArray()}_renderPopup(){return s("div",{class:l.popup,role:"alert"},this._popupMessage)}_renderClipboardPopup(){const{messages:t}=this;return t?s("div",{class:this.classes(l.popup,l.clipboardPopup),role:"alert"},t.copySuccessMessage):s("div",null)}_renderPrimaryTools(){const{messages:t,visibleElements:e}=this;if(!t)return s("ul",null);const i=this.mode==="live"?t.captureMode:t.liveMode,o=e.inputButton&&this._renderIconButton({iconType:"pencil",clickFunction:this._toggleInputVisibility,attributes:{label:t.inputCoordTitle}}),n=e.captureButton&&this._renderIconButton({iconType:this.mode==="live"?"pin-tear":"pin-tear-f",clickFunction:this._toggleMode,classes:[l.modeToggle],attributes:{label:i}}),a=e.settingsButton&&this._renderIconButton({iconType:"gear",clickFunction:this._toggleSettingsVisibility,attributes:{label:t.settingsTitle}});return s("ul",{class:l.toolDisplay},o,n,a)}_renderSettings(){var k;const t=this.id,e=`${t}__${l.patternInput}`,i=`${t}__${l.patternInput}__header`,o=`${t}__${l.previewCoordinate}`,n=this.formats.filter(K=>K.hasDisplayProperties),a=this._findSettingsFormat(),p=a?n.indexOf(a):-1,m=this._renderOptions(n,!0,p),u=a==null?void 0:a.currentPattern,{messages:_,messagesCommon:g,headingLevel:L}=this;if(!g||!_)return s("div",null);const S=this._renderIconButton({iconType:D(this.container)?"arrow-right":"arrow-left",clickFunction:this._toggleSettingsVisibility,attributes:{label:g.back}}),F=this._renderIconButton({iconType:"refresh",clickFunction:this._setDefaultPattern,attributes:{label:_.defaultPattern}});return s("div",{"aria-labelledby":i,class:l.settings,key:l.settings},s("div",{class:l.sectionHeading},S,s(R,{class:$.heading,id:i,level:L},_.settingsTitle)),s("div",{class:l.settingsFormGroup},s("label",{for:e},_.changeCoordinateDisplay),s("calcite-select",{bind:this,label:_.selectFormat,width:"full",onCalciteSelectChange:this._setSettingsFormat},m),s("div",{class:l.settingsFormGroupHorizontal},s("calcite-input",{"aria-controls":o,bind:this,class:l.patternInput,id:e,spellcheck:!1,type:"text",value:u,onCalciteInputInput:this._updateCurrentPattern}),F)),s("div",{class:l.settingsFormGroup},s("label",null,g.preview,s("div",{class:l.previewCoordinate,id:o,tabIndex:0},(k=this._previewConversion)==null?void 0:k.displayCoordinate))))}_renderIconButton(t){const{iconType:e,clickFunction:i,classes:o,attributes:n}=t;return s("calcite-button",{appearance:"transparent",bind:this,class:this.classes(o),iconStart:e,kind:"neutral",onclick:i,onkeydown:i,...n})}_renderTools(t,e,i){const o=e.displayCoordinate&&this.mode==="capture"?this._renderCopyButton(e):null,{messages:n}=this;if(!n)return s("ul",null);const a=this._renderIconButton({iconType:"x",clickFunction:this._removeConversion,attributes:{"aria-controls":i,label:n.removeConversion,"data-index":t}});return s("ul",{class:l.toolDisplay,role:"listitem"},o,s("li",{class:this.classes(l.rowButton)},a))}_copyCoordinateOutput(t){const e=t.target;if(!("createTextRange"in document.body)){const i=window.getSelection(),o=document.createRange();o.selectNodeContents(e),i==null||i.removeAllRanges(),i==null||i.addRange(o)}document.execCommand("copy")}_removeConversion(t){const e=z(t.currentTarget);e!=null&&this.conversions.removeAt(e)}_setDefaultPattern(t){t.stopPropagation();const e=this._findSettingsFormat();e&&(e.currentPattern=e.defaultPattern)}_toggleExpand(){this._expanded=!this._expanded}_toggleInputVisibility(){this._inputVisible=!this._inputVisible,this._popupVisible&&this._hidePopup(),this._inputVisible?this.viewModel.pause():this.viewModel.resume()}_toggleMode(){this.mode=this.mode==="live"?"capture":"live"}_toggleSettingsVisibility(){this._settingsVisible=!this._settingsVisible,this._popupVisible&&this._hidePopup(),this._settingsVisible?(this._setPreviewConversion(),this.viewModel.pause()):this.viewModel.resume()}};r([d()],c.prototype,"conversions",null),r([d()],c.prototype,"currentLocation",null),r([d()],c.prototype,"formats",null),r([d()],c.prototype,"goToOverride",null),r([d()],c.prototype,"headingLevel",void 0),r([d()],c.prototype,"icon",null),r([d()],c.prototype,"label",null),r([d(),O("esri/widgets/CoordinateConversion/t9n/CoordinateConversion")],c.prototype,"messages",void 0),r([d(),O("esri/t9n/common")],c.prototype,"messagesCommon",void 0),r([d()],c.prototype,"mode",null),r([d()],c.prototype,"orientation",void 0),r([d()],c.prototype,"multipleConversions",null),r([d()],c.prototype,"locationSymbol",null),r([d()],c.prototype,"storageEnabled",null),r([d()],c.prototype,"storageType",null),r([d()],c.prototype,"view",null),r([d({type:q})],c.prototype,"viewModel",void 0),r([d()],c.prototype,"visibleElements",void 0),r([N("visibleElements")],c.prototype,"castVisibleElements",null),r([y()],c.prototype,"_copyCoordinateOutput",null),r([y()],c.prototype,"_removeConversion",null),r([y()],c.prototype,"_setDefaultPattern",null),r([y()],c.prototype,"_toggleExpand",null),r([y()],c.prototype,"_toggleInputVisibility",null),r([y()],c.prototype,"_toggleMode",null),r([y()],c.prototype,"_toggleSettingsVisibility",null),c=r([B("esri.widgets.CoordinateConversion")],c);const St=c;function z(t){return t["data-index"]}function Ft(t){return t["data-conversion"]}/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.32/esri/copyright.txt for details.
v4.32.12 */const Et=Z`@layer{arcgis-coordinate-conversion{display:block}}`,Vt=Ct(St),I=class I extends Q{constructor(){super(...arguments),this.widget=Vt(this),this.viewModel=this.widget.viewModel,this.autoDestroyDisabled=!1,this.conversions=this.widget.conversions,this.currentLocation=this.widget.currentLocation,this.formats=this.widget.formats,this.headingLevel=this.widget.headingLevel,this.hideCaptureButton=this.widget.visibleElements.captureButton,this.hideEditButton=this.widget.visibleElements.editButton,this.hideExpandButton=this.widget.visibleElements.expandButton,this.hideSettingsButton=this.widget.visibleElements.settingsButton,this.icon=this.widget.icon,this.label=this.widget.label,this.locationSymbol=this.widget.locationSymbol,this.mode=this.widget.mode,this.multipleConversionsDisabled=this.widget.multipleConversions,this.orientation=this.widget.orientation,this.position="bottom-left",this.state=this.viewModel.state,this.storageDisabled=this.widget.storageEnabled,this.storageType=this.widget.storageType,this.arcgisPropertyChange=X()("currentLocation","state"),this.arcgisReady=Y()}async destroy(){await this.manager.destroy()}async reverseConvert(e,i){var o;return await((o=this.widget)==null?void 0:o.reverseConvert(e,i))}};I.properties={autoDestroyDisabled:5,conversions:0,currentLocation:0,formats:0,headingLevel:9,hideCaptureButton:5,hideEditButton:5,hideExpandButton:5,hideSettingsButton:5,icon:1,label:1,locationSymbol:0,mode:1,multipleConversionsDisabled:5,orientation:1,position:1,referenceElement:1,state:3,storageDisabled:5,storageType:1},I.shadowRootOptions=tt,I.styles=Et;let V=I;et("arcgis-coordinate-conversion",V);export{V as ArcgisCoordinateConversion};
