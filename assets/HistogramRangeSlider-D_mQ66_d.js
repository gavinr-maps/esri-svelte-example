import{e as r}from"./Evented-CXIxDjmW.js";import{u}from"./Color-DDUWtbqR.js";import{d as p}from"./reactiveUtils-BFQ0BtrB.js";import{y as a,b as y,N as _}from"./subclass-BR3PhgZG.js";import C from"./Histogram-B37ff69-.js";import{l as w,A as B}from"./Slider-DkMBFju2.js";import{e as $,B as D,n as v}from"./jsxFactory-Be5PKa9i.js";import{r as x,s as M,a as T}from"./utils-CTGWN8EM.js";import{e as F}from"./globalCss-CZa70j6i.js";import"./Accessor-D6mNnsWy.js";import"./colorUtils-CS9vdHXB.js";import"./mathUtils-ClvKsMak.js";import"./shared-B3wH2qpO.js";import"./intl-CArXn1et.js";import"./Promise-CZrWwByK.js";import"./jsonMap-DCC6W5ex.js";import"./assets-BNizZMOZ.js";import"./index-BVncS3aY.js";import"./substitute-CNca968n.js";import"./uuid-fwrPAdZb.js";import"./utils-DTMemtCi.js";import"./fieldUtils-C5R42-PY.js";import"./geometry-CnaxvJsv.js";import"./Extent-B4rrMrqp.js";import"./Point-TlcsOcXV.js";import"./writer-3zufXUNV.js";import"./Polyline-BQFeqYXi.js";import"./ColorStop-DEfc5Idt.js";import"./Basemap-CKBB4cRW.js";import"./collectionUtils-Dm1icNvk.js";import"./Portal-DCqdz-K4.js";import"./loadAll-z9YY33Kx.js";import"./PortalItem-CaeKabGc.js";import"./persistableUrlUtils-Dx61-x4K.js";import"./writeUtils-BUKZUL8X.js";import"./layerUtils-BzjQnEdj.js";import"./mat4f32-DcsiF_Rp.js";import"./mat4-ybYUU6jq.js";import"./utils-CvMr5svk.js";import"./symbols-CfvYGR4J.js";import"./enumeration--HlxOQ_N.js";import"./TextSymbol-zZq0BA1M.js";import"./screenUtils-PfxkaaMN.js";import"./materialUtils-CQ3JLQ1x.js";import"./opacityUtils-BT7mQkwC.js";import"./aaBoundingBox-BGxkJAW0.js";import"./Clonable-cKbRam6-.js";import"./jsonUtils-C4Wp5KpV.js";import"./parser-BN6zmHl-.js";import"./utils-D20M4_S8.js";import"./cimSymbolUtils-Ctf0ZrmH.js";import"./utils-D8D39sLt.js";import"./LRUCache-ju6LnIBZ.js";import"./MemCache-C6WUx-5V.js";import"./timeUtils-DQR2jUPL.js";import"./utils-HfpQY-3e.js";import"./HeatmapColorStop-7F2_sZ2U.js";import"./SizeVariable-Bq7jlw1r.js";import"./sizeVariableUtils-Cmcuvw-4.js";import"./visualVariableUtils-CrTsYJ9f.js";import"./Graphic-Bi5hWHps.js";import"./PopupTemplate-D8mXPxzU.js";import"./ActionToggle-C0Z1k2jc.js";import"./Identifiable-BLvpQbOc.js";import"./jsonUtils-DtWlwXHP.js";import"./compilerUtils-BA04t1lN.js";import"./lengthUtils-vgIBtB6M.js";let m=class extends w{constructor(t){super(t),this.average=null,this.bins=null,this.hasTimeData=!1,this.labelFormatFunction=o=>{if(this.hasTimeData)return x(o);const{max:d,min:e,precision:h}=this,l=d-e>10?2:h;return M(parseFloat(o.toFixed(l)))},this.rangeType="equal",this.standardDeviation=null}generateWhereClause(t){const{rangeType:o,state:d,values:e}=this;if(d!=="ready"||!(e!=null&&e.length)||t==null)return null;const h=e[0],l=e.length>1?e[e.length-1]:null;switch(o){case"equal":return`${t} = ${h}`;case"not-equal":return`${t} <> ${h}`;case"less-than":return`${t} < ${h}`;case"greater-than":return`${t} > ${h}`;case"at-least":return`${t} >= ${h}`;case"at-most":return`${t} <= ${h}`;case"between":return`${t} BETWEEN ${h} AND ${l}`;case"not-between":return`${t} NOT BETWEEN ${h} AND ${l}`;default:return null}}};r([a()],m.prototype,"average",void 0),r([a()],m.prototype,"bins",void 0),r([a()],m.prototype,"hasTimeData",void 0),r([a()],m.prototype,"labelFormatFunction",void 0),r([a()],m.prototype,"rangeType",void 0),r([a()],m.prototype,"standardDeviation",void 0),m=r([y("esri.widgets.HistogramRangeSlider.HistogramRangeSliderViewModel")],m);const f=m,g="esri-histogram-range-slider",c={base:g,sliderContainer:`${g}__slider-container`,histogramContainer:`${g}__histogram-container`,rangeTypePrefix:`${g}__range-type--`};let s=class extends D{constructor(t,o){super(t,o),this._barElements=[],this._histogram=null,this._slider=null,this.barCreatedFunction=null,this.dataLines=null,this.dataLineCreatedFunction=null,this.excludedBarColor=new u("#d7e5f0"),this.includedBarColor=new u("#599dd4"),this.messages=null,this.standardDeviationCount=1,this.viewModel=new f}initialize(){const{average:t,bins:o,hasTimeData:d,max:e,min:h,viewModel:l}=this;this._updateBarFill=this._updateBarFill.bind(this),this._histogram=new C({average:t,bins:o,barCreatedFunction:(i,n)=>{i===0&&(this._barElements=[]),this._barElements.push(n),this._updateBarFill(i,n),this.barCreatedFunction&&this.barCreatedFunction(i,n)},dataLines:this._getDataLines(),dataLineCreatedFunction:(i,n)=>{this.dataLineCreatedFunction&&this.dataLineCreatedFunction(i,n)},labelFormatFunction:this.labelFormatFunction,layout:"horizontal",max:e,min:h}),this._slider=new B({labelFormatFunction:this.labelFormatFunction,layout:"horizontal",visibleElements:{labels:!0,rangeLabels:!0},rangeLabelInputsEnabled:!d,viewModel:l}),this.addHandles([this._slider.on("max-change",i=>this.emit("max-change",i)),this._slider.on("min-change",i=>this.emit("min-change",i)),this._slider.on("segment-drag",i=>{this._updateBarFills(),this.emit("segment-drag",i)}),this._slider.on("thumb-change",i=>{this._updateBarFills(),this.emit("thumb-change",i)}),this._slider.on("thumb-drag",i=>{this._updateBarFills(),this.emit("thumb-drag",i)}),p(()=>this.bins,i=>{if(i&&this._histogram.bins){const n=this._histogram.bins.length-i.length;this._barElements.splice(-n,n)}else this._barElements=[];this._histogram.set({bins:i}),this._updateBarFills(),this.scheduleRender()}),p(()=>[this.max,this.min,this.rangeType,this.values],([i,n])=>{this._histogram.set({max:i,min:n}),this._updateBarFills(),this.scheduleRender()}),p(()=>[this.average,this.dataLines,this.standardDeviation,this.standardDeviationCount],([i])=>{this._histogram.set({average:i,dataLines:this._getDataLines()})}),p(()=>this.labelFormatFunction,i=>{this._histogram.set({labelFormatFunction:i})}),p(()=>this.hasTimeData,i=>{this._slider.set({rangeLabelInputsEnabled:!i})})])}get average(){return this.viewModel.average}set average(t){this.viewModel.average=t}get bins(){return this.viewModel.bins}set bins(t){this.viewModel.bins=t}get hasTimeData(){return this.viewModel.hasTimeData}set hasTimeData(t){this.viewModel.hasTimeData=t}get icon(){return"arrow-double-horizontal"}set icon(t){this._overrideIfSome("icon",t)}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}get labelFormatFunction(){return this.viewModel.labelFormatFunction}set labelFormatFunction(t){this.viewModel.labelFormatFunction=t}get max(){return this.viewModel.max}set max(t){this.viewModel.max=t}get min(){return this.viewModel.min}set min(t){this.viewModel.min=t}get precision(){return this.viewModel.precision}set precision(t){this.viewModel.precision=t}get rangeType(){return this.viewModel.rangeType}set rangeType(t){this.viewModel.rangeType=t}get standardDeviation(){return this.viewModel.standardDeviation}set standardDeviation(t){this.viewModel.standardDeviation=t}get values(){return this.viewModel.values}set values(t){this.viewModel.values=t}generateWhereClause(t){return this.viewModel.generateWhereClause(t)}render(){const{rangeType:t,viewModel:o,label:d}=this,e=this.classes(c.base,F.widget,`${c.rangeTypePrefix}${t}`,o.state==="disabled"?F.disabled:null);return v("div",{"aria-label":d,class:e},o.state==="disabled"?null:this._renderContent())}_renderContent(){return[this._renderHistogram(),this._renderSlider()]}_renderSlider(){return v("div",{class:c.sliderContainer,key:`${this.id}-slider-container`},this._slider.render())}_renderHistogram(){return v("div",{class:c.histogramContainer},this._histogram.render())}_getDataLines(){return[...this._getStandardDeviationDataLines(),...this.dataLines||[]]}_getStandardDeviationDataLines(){const{average:t,standardDeviation:o,standardDeviationCount:d}=this;return T(o,t,d).map(e=>({value:e}))}_updateBarFills(){this._barElements.forEach((t,o)=>this._updateBarFill(o,t))}_updateBarFill(t,o){var d;o.setAttribute("fill",((d=this._getFillForBar(t))==null?void 0:d.toHex())??"")}_getFillForBar(t){const{bins:o,rangeType:d,values:e}=this;if(t===-1||!(o!=null&&o.length)||!d||!(e!=null&&e.length))return null;const h=o[t];if(!h)return null;const{maxValue:l,minValue:i}=h,n=l-i,b=e[0]>i&&e[0]<l;switch(d){case"equal":case"not-equal":return this.includedBarColor;case"less-than":case"at-most":return b?this._getBlendedColor((e[0]-i)/n):l<=e[0]?this.includedBarColor:this.excludedBarColor;case"greater-than":case"at-least":return b?this._getBlendedColor(1-(e[0]-i)/n):i>=e[0]?this.includedBarColor:this.excludedBarColor;case"between":if(e.length===2)return e[0]>i&&e[0]<l?this._getBlendedColor(1-(e[0]-i)/n):e[1]>i&&e[1]<l?this._getBlendedColor((e[1]-i)/n):i>=e[0]&&l<=e[1]?this.includedBarColor:this.excludedBarColor;break;case"not-between":if(e.length===2)return e[0]>i&&e[0]<l?this._getBlendedColor((e[0]-i)/n):e[1]>i&&e[1]<l?this._getBlendedColor(1-(e[1]-i)/n):i>e[0]&&l<e[1]?this.excludedBarColor:this.includedBarColor}return this.includedBarColor}_getBlendedColor(t){return u.blendColors(this.excludedBarColor,this.includedBarColor,t)}};r([a()],s.prototype,"average",null),r([a()],s.prototype,"barCreatedFunction",void 0),r([a()],s.prototype,"bins",null),r([a()],s.prototype,"dataLines",void 0),r([a()],s.prototype,"dataLineCreatedFunction",void 0),r([a({type:u,json:{type:[_],write:!0}})],s.prototype,"excludedBarColor",void 0),r([a()],s.prototype,"hasTimeData",null),r([a({type:u,json:{type:[_],write:!0}})],s.prototype,"includedBarColor",void 0),r([a()],s.prototype,"icon",null),r([a()],s.prototype,"label",null),r([a()],s.prototype,"labelFormatFunction",null),r([a()],s.prototype,"max",null),r([a(),$("esri/widgets/HistogramRangeSlider/t9n/HistogramRangeSlider")],s.prototype,"messages",void 0),r([a()],s.prototype,"min",null),r([a()],s.prototype,"precision",null),r([a()],s.prototype,"rangeType",null),r([a()],s.prototype,"standardDeviation",null),r([a()],s.prototype,"standardDeviationCount",void 0),r([a()],s.prototype,"values",null),r([a()],s.prototype,"viewModel",void 0),s=r([y("esri.widgets.HistogramRangeSlider")],s);const kt=s;export{kt as default};
