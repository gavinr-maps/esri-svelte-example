import{s as c}from"./Accessor-BmwT4B0c.js";import{b as h}from"./layerUtils-B__v9OBu.js";import{s as f,t as u,w as y,u as x,v as L,x as v,y as F,S as k,A as p,f as T,B as U,C as V}from"./Graphic-Dt0LgVGU.js";import{d as z,y as E,S as P,m as W}from"./TextSymbol-BLIQ6RKX.js";import{h as S}from"./Color-VJEMvW-n.js";import{V as w}from"./reactiveUtils-XM7cS2OP.js";import{e as g}from"./screenUtils-_ZIvrt5o.js";import{c as j,u as A,S as B}from"./defaults-FkBa0ybj.js";import{e as q,i as G}from"./defaultsJSON-GKolV7NZ.js";const H=y.fromSimpleMarkerSymbol(B),J=u.fromSimpleLineSymbol(A),K=f.fromSimpleFillSymbol(j),N=new x({symbolLayers:new w([new L({material:{color:q},edges:new F({size:g(1),color:new S(G)})})])}),O=new u({symbolLayers:new w([new v({material:{color:new S([0,0,0])},size:g(1)})])}),Q=new f({symbolLayers:new w([new L({outline:{color:new S([0,0,0]),size:g(1)}})])});function te(e){if(e==null)return null;switch(e.type){case"mesh":return N;case"point":case"multipoint":return H;case"polyline":return J;case"polygon":case"extent":return K}return null}const M="#useCIMFallbackSymbology()",a={retainId:!1,ignoreDrivers:!1,hasLabelingContext:!0};function R(e,n=a){var i,$,d,C;if(!e)return{symbol:null};const{retainId:t=a.retainId,ignoreDrivers:o=a.ignoreDrivers,hasLabelingContext:r=a.hasLabelingContext,retainCIM:m=a.retainCIM,cimFallbackEnabled:s=a.cimFallbackEnabled}=n;let l=null;if(k(e)||e instanceof p)l=e.clone();else if(e.type==="cim"){const b=($=(i=e.data)==null?void 0:i.symbol)==null?void 0:$.type;switch(b){case"CIMPointSymbol":l=m?e.clone():y.fromCIMSymbol(e);break;case"CIMLineSymbol":s&&(l=O.clone(),(d=n==null?void 0:n.logWarning)==null||d.call(n,M,"Unsupported CIM line symbology converted to fallback 3D line symbology"));break;case"CIMPolygonSymbol":s&&(l=Q.clone(),(C=n==null?void 0:n.logWarning)==null||C.call(n,M,"Unsupported CIM polygon symbology converted to fallback 3D polygon symbology"))}if(!l)return{error:new c("symbol-conversion:unsupported-cim-symbol",`CIM symbol of type '${b||"unknown"}' is unsupported in 3D`,{symbol:e})}}else if(e instanceof z)l=u.fromSimpleLineSymbol(e);else if(e instanceof E)l=y.fromSimpleMarkerSymbol(e);else if(e instanceof T)l=y.fromPictureMarkerSymbol(e);else if(e instanceof P)l=n.geometryType&&n.geometryType==="mesh"?x.fromSimpleFillSymbol(e):f.fromSimpleFillSymbol(e);else{if(!(e instanceof W))return{error:new c("symbol-conversion:unsupported-2d-symbol",`2D symbol of type '${e.type||e.declaredClass}' is unsupported in 3D`,{symbol:e})};l=r?U.fromTextSymbol(e):y.fromTextSymbol(e)}return t&&l&&l.type!=="cim"&&(l.id=e.id),!o||l.type==="cim"||l instanceof p||l.symbolLayers.forEach(b=>b.ignoreDrivers=!0),{symbol:l}}function ie(e,n,t,o){const r=D(e,{},{context:o,isLabelSymbol:!1});r!=null&&(n[t]=r)}function ae(e,n,t,o){const r=D(e,{},{context:o,isLabelSymbol:!0});r!=null&&(n[t]=r)}function I(e){return k(e)||e instanceof p}function X(e){return(e==null?void 0:e.type)==="polygon-3d"||(e==null?void 0:e.type)==="line-3d"}function D(e,n,t){var l;if(e==null)return null;const{context:o,isLabelSymbol:r}=t,m=o==null?void 0:o.origin,s=o==null?void 0:o.messages;if(m==="web-scene"&&!I(e)){const i=R(e,{retainCIM:!0,hasLabelingContext:r});return i.symbol!=null?i.symbol.write(n,o):(s==null||s.push(new c("symbol:unsupported",`Symbols of type '${e.declaredClass}' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView`,{symbol:e,context:o,error:i.error})),null)}return h(o==null?void 0:o.layer)&&X(e)?(s==null||s.push(new c("symbol:unsupported",`Symbols of type '${e.declaredClass}' are not supported on layers of type '${(l=o==null?void 0:o.layer)==null?void 0:l.declaredClass}'.`,{symbol:e,context:o})),null):(m==="web-map"||m==="portal-item"&&!h(o==null?void 0:o.layer))&&I(e)?(s==null||s.push(new c("symbol:unsupported",`Symbols of type '${e.declaredClass}' are not supported in web maps and portal items. Use 2D symbology and CIMSymbol instead when working with MapView`,{symbol:e,context:o})),null):e.write(n,o)}function me(e,n){return V(e,null,n)}export{te as d,a as g,ae as i,me as m,ie as r,R as u};
