import{x as I,c as d,i as h}from"./symbols-CfvYGR4J.js";import{c as v,a as S}from"./devEnvironmentUtils-D6qIi8Ky.js";import{c as N}from"./subclass-BR3PhgZG.js";import{I as u,R as D}from"./assets-BNizZMOZ.js";import{C as U}from"./Portal-DCqdz-K4.js";import{p as w}from"./persistableUrlUtils-Dx61-x4K.js";import{b as P}from"./jsonUtils-aUmUTP_F.js";import{y as A,b as j,p as O,w as C,d as E}from"./styleUtils-C7rrjuqd.js";import"./Evented-CXIxDjmW.js";import"./Accessor-D6mNnsWy.js";import"./enumeration--HlxOQ_N.js";import"./jsonMap-DCC6W5ex.js";import"./writer-3zufXUNV.js";import"./fieldUtils-C5R42-PY.js";import"./index-BVncS3aY.js";import"./intl-CArXn1et.js";import"./Promise-CZrWwByK.js";import"./mathUtils-ClvKsMak.js";import"./geometry-CnaxvJsv.js";import"./Extent-B4rrMrqp.js";import"./Point-TlcsOcXV.js";import"./Polyline-BQFeqYXi.js";import"./TextSymbol-zZq0BA1M.js";import"./Color-DDUWtbqR.js";import"./colorUtils-CS9vdHXB.js";import"./screenUtils-PfxkaaMN.js";import"./materialUtils-CQ3JLQ1x.js";import"./opacityUtils-BT7mQkwC.js";import"./aaBoundingBox-BGxkJAW0.js";import"./reactiveUtils-BFQ0BtrB.js";import"./shared-B3wH2qpO.js";import"./collectionUtils-Dm1icNvk.js";import"./Clonable-cKbRam6-.js";import"./layerUtils-BzjQnEdj.js";import"./defaults-CIM29kXM.js";import"./defaultsJSON-GKolV7NZ.js";function wt(t,r,o,e){const m=t.name;return m==null?Promise.reject(new N("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):t.styleName&&t.styleName==="Esri2DPointSymbolsStyle"?W(m,r,e):A(t,r,e).then(l=>T(l,m,r,o,E,e))}function M(t,r){return r.items.find(o=>o.name===t)}function T(t,r,o,e,m,l){var c,g;const n=(o==null?void 0:o.portal)!=null?o.portal:U.getDefault(),f={portal:n,url:u(t.baseUrl),origin:"portal-item"},a=M(r,t.data);if(!a){const y=`The symbol name '${r}' could not be found`;return Promise.reject(new N("symbolstyleutils:symbol-name-not-found",y,{symbolName:r}))}let p=w(m(a,e),f),s=((c=a.thumbnail)==null?void 0:c.href)??null;const b=(g=a.thumbnail)==null?void 0:g.imageData;v()&&(p=S(p)??"",s=S(s));const R={portal:n,url:u(D(p)),origin:"portal-item"};return j(p,l).then(y=>{const x=e==="cimRef"?O(y.data):y.data,i=P(x,R);if(i&&I(i)){if(s){const F=w(s,f);i.thumbnail=new d({url:F})}else b&&(i.thumbnail=new d({url:`data:image/png;base64,${b}`}));t.styleUrl?i.styleOrigin=new h({portal:o.portal,styleUrl:t.styleUrl,name:r}):t.styleName&&(i.styleOrigin=new h({portal:o.portal,styleName:t.styleName,name:r}))}return i})}function W(t,r,o){const e=C.replaceAll(/\{SymbolName\}/gi,t),m=r.portal!=null?r.portal:U.getDefault();return j(e,o).then(l=>{const n=O(l.data);return P(n,{portal:m,url:u(D(e)),origin:"portal-item"})})}export{T as fetchSymbolFromStyle,M as getStyleItemFromStyle,wt as resolveWebStyleSymbol};
