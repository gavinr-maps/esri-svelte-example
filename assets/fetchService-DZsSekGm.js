import{t as i}from"./requestPresets-D39VZbLJ.js";const l=new Set(["Catalog Layer","Feature Layer","Oriented Imagery Layer"]);async function h(e,t){const{loadContext:a,...r}=t||{},n=a?await a.fetchServiceMetadata(e,r):await i(e,r);u(n),o(n);const s={serviceJSON:n};if((n.currentVersion??0)<10.5)return s;const y=`${e}/layers`,c=a?await a.fetchServiceMetadata(y,r):await i(y,r);return u(c),o(c),s.layersJSON={layers:c.layers,tables:c.tables},s}function f(e){const{type:t}=e;return!!t&&l.has(t)}function L(e){return e.type==="Table"}function o(e){var t,a;e.layers=(t=e.layers)==null?void 0:t.filter(f),e.tables=(a=e.tables)==null?void 0:a.filter(L)}function b(e){e.type||(e.type="Feature Layer")}function d(e){e.type||(e.type="Table")}function u(e){var t,a;(t=e.layers)==null||t.forEach(b),(a=e.tables)==null||a.forEach(d)}function p(e){switch(e){case"Feature Layer":case"Table":return"FeatureLayer";case"Oriented Imagery Layer":return"OrientedImageryLayer";case"Catalog Layer":return"CatalogLayer"}return"FeatureLayer"}export{p as i,h as t};
