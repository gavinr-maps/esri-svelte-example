const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./calcite-button-D_Agetwz.js","./button-9P4PM9SO.js","./jsxFactory-CJa39Fro.js","./tslib.es6-B3Jf3DVX.js","./intl-CChhNOV8.js","./date-DlqISzcw.js","./jsonMap-0cxwUWs2.js","./subclass-BZA_h8Db.js","./locale-C9TlLpzi.js","./messages-OmQvZhAg.js","./Accessor-BLX9ikPh.js","./assets-C43MgM-v.js","./index-Bh2oEzTI.js","./index-2kwcjS9-.css","./Evented-BHRw9x22.js","./Promise-B2Hu02L7.js","./reactiveUtils-C5zUhJQJ.js","./asyncUtils-CWX51uTe.js","./Collection-CEdjem1-.js","./shared-B3wH2qpO.js","./SimpleObservable-KocWTzVy.js","./uuid-fwrPAdZb.js","./cast-Bjksrh93.js","./form-BZPQ5PUM.js","./dom-D_AJDzAj.js","./interactive-y84HQRWL.js","./label-DEe8AW1C.js","./component-6CIDVndn.js","./loadable-DM18hPdE.js","./locale-A4FuYD8q.js","./key-D63ExP77.js","./observers-D2xgmA06.js","./t9n-D0ry3MEw.js","./icon-BQO9J86c.js","./loader-C-zIPscB.js","./calcite-icon-Cu0W9dtm.js","./calcite-scrim-B8_2DHG_.js","./scrim-DPa2aeKh.js","./calcite-label-B1FxWqaL.js","./calcite-radio-button-C1tLzCtg.js","./array-BMcQdnYi.js","./calcite-radio-button-group-D-kr_xkz.js","./Validation-Bz9yoU6e.js","./input-message-CWvsvdFk.js"])))=>i.map(i=>d[i]);
import{_ as b}from"./index-Bh2oEzTI.js";import{r as k,n as h,w as M}from"./jsxFactory-CJa39Fro.js";import{e as S}from"./Heading-C-odFCu-.js";import{r as n}from"./tslib.es6-B3Jf3DVX.js";import{m as r,a as w,b as F}from"./subclass-BZA_h8Db.js";import{watch as q,sync as U}from"./reactiveUtils-C5zUhJQJ.js";import{m as V,S as P,V as E,B as C,W,X as O,p as T,y as D,b as A,Y as H,$ as B,a0 as Z,a1 as j,E as K,a2 as X,A as z,o as G}from"./fieldUtils-tmQlKvWo.js";import{$ as L}from"./utils-BwQ00KBJ.js";import{K as Y}from"./featureUtils-Do2jvOGL.js";import{O as J}from"./layerUtils-BrNoooE9.js";import{b as Q}from"./Accessor-BLX9ikPh.js";import{U as ee,h as te,z as ie,V as I,N,S as R}from"./featureFormUtils-Cdlj8laq.js";const le={danger:"exclamation-mark-circle",info:"information",success:"check",warning:"exclamation-mark-triangle",brand:void 0,neutral:void 0,inverse:void 0},x="esri-editor__prompt",_={base:x,header:`${x}__header`,heading:`${x}__header__heading`,message:`${x}__message`,divider:`${x}__divider`,actions:`${x}__actions`},Ee=()=>k({button:()=>b(()=>import("./calcite-button-D_Agetwz.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34]),import.meta.url),icon:()=>b(()=>import("./calcite-icon-Cu0W9dtm.js"),__vite__mapDeps([35,33,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,24,31]),import.meta.url),scrim:()=>b(()=>import("./calcite-scrim-B8_2DHG_.js"),__vite__mapDeps([36,37,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,29,24,30,31,32,34]),import.meta.url),label:()=>b(()=>import("./calcite-label-B1FxWqaL.js"),__vite__mapDeps([38,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,26,24,27]),import.meta.url),"radio-button":()=>b(()=>import("./calcite-radio-button-C1tLzCtg.js"),__vite__mapDeps([39,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,40,24,23,25,26,27,28]),import.meta.url),"radio-button-group":()=>b(()=>import("./calcite-radio-button-group-D-kr_xkz.js"),__vite__mapDeps([41,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,31,24,28,42,33,43]),import.meta.url)});function xe({actions:e,context:t,headingLevel:l,message:i,title:a,...o}){const{primary:d,secondary:p}=e;let u;switch(t){case"danger":u="danger";break;case"info":u="brand";break;default:u="neutral"}const m=h("calcite-button",{afterCreate:f=>M(f),appearance:"solid","data-testid":"primary-prompt-button",key:"prompt-primary-button",kind:u,onclick:d.action,width:p?"half":"full"},d.label),g=p&&h("calcite-button",{appearance:"outline","data-testid":"secondary-prompt-button",key:"prompt-secondary-button",kind:u,onclick:p.action,width:"half"},p.label);return h("calcite-scrim",{"data-testid":"prompt",key:"prompt"},h("div",{class:`${_.base}--${t}`},h("div",{class:_.header},h("calcite-icon",{icon:le.warning}),h(S,{class:_.heading,level:l},a)),h("div",{class:_.message},i),ne(o)??h("div",{class:_.divider}),h("div",{class:_.actions},g,m)))}function ne({radios:e,onRadioSelection:t,defaultRadioSelection:l}){return e!=null&&e.length?h("calcite-radio-button-group",{name:"PromptChoiceList"},e.map(i=>h("calcite-label",{layout:"inline"},h("calcite-radio-button",{checked:i.value===l,value:i.value,onCalciteRadioButtonChange:()=>t==null?void 0:t(i.value)}),i.label))):void 0}let c=class extends Q{constructor(e){super(e),this.element=null,this.feature=null,this.layer=null,this.timeZone=null,this.type=null,this.visibilityExpressionExecutor=null}get description(){var e;return this.getFormattedLabel((e=this.element)==null?void 0:e.description)}get evaluatedVisibilityExpression(){const{visibilityExpressionExecutor:e}=this;return e!=null?!!e.lastEvaluatedValue:null}get label(){var e;return this.getFormattedLabel((e=this.element)==null?void 0:e.label)}get updating(){return!1}get visible(){return this.evaluatedVisibilityExpression!=null?this.evaluatedVisibilityExpression:this.element!=null}getFormattedLabel(e){const{feature:t,layer:l,timeZone:i}=this;return l==null||e==null?e:ee({label:e,attributes:t.attributes,fieldsIndex:l.fieldsIndex,timeZone:i})}};n([r({readOnly:!0})],c.prototype,"description",null),n([r({constructOnly:!0})],c.prototype,"element",void 0),n([r()],c.prototype,"evaluatedVisibilityExpression",null),n([r()],c.prototype,"feature",void 0),n([r()],c.prototype,"label",null),n([r()],c.prototype,"layer",void 0),n([r()],c.prototype,"timeZone",void 0),n([r()],c.prototype,"type",void 0),n([r()],c.prototype,"updating",null),n([r()],c.prototype,"visible",null),n([r()],c.prototype,"visibilityExpressionExecutor",void 0),c=n([w("esri.widgets.FeatureForm.InputBase")],c);const re=c;var y;(function(e){e.Text="text",e.Number="number",e.Date="date",e.Unsupported="unsupported"})(y||(y={}));const ae=(e,t)=>{if(!e)return!0;const{operations:l}=e;switch(t){case"INSERT":return l.supportsAdd;case"UPDATE":case"DELETE":return l.supportsUpdate;default:return!0}};let v=class extends re{constructor(e){super(e),this.arcadeEditType="NA",this.editableExpressionExecutor=null}get editable(){return!!this.layerAllowsEdits&&(this.evaluatedEditableExpression??!0)}get evaluatedEditableExpression(){const{editableExpressionExecutor:e}=this;return e!=null?!!e.lastEvaluatedValue:null}get layerAllowsEdits(){const{layer:e}=this;if(!e)return!1;const t=J(e),l=t==null?void 0:t.operations.supportsEditing,i=ae(t,this.arcadeEditType);return!(!l||!i)}};n([r()],v.prototype,"arcadeEditType",void 0),n([r()],v.prototype,"editable",null),n([r()],v.prototype,"editableExpressionExecutor",void 0),n([r()],v.prototype,"evaluatedEditableExpression",null),n([r()],v.prototype,"layerAllowsEdits",null),v=n([w("esri.widgets.FeatureForm.EditableInput")],v);const se=v;let s=class extends se{constructor(e){super(e),this._storedValue=null,this.error=null,this.preservesValueWhenHidden=!0,this.field=null,this.group=null,this.requiredExpressionExecutor=null,this.type="field",this._fieldInputWasVisibleDuringLifetime=!1,this.valueExpressionExecutor=null}initialize(){this.addHandles(q(()=>this.feature,()=>this._fieldInputWasVisibleDuringLifetime=!1,U))}get _dateFormRange(){const{element:e,field:t}=this;if(this.dataType!=="date")return{};const l=e!=null&&e.domain?V(t,e.domain):null;if(!(e!=null&&e.input))return l??{};const i=e.input,{type:a}=i;let o={};if(a!=="date-picker"&&a!=="time-picker"&&a!=="datetimeoffset-picker"||(o=P(t,i.max,i.min)),a==="datetime-picker"){const{max:u,min:m}=i;o={max:u!=null&&$(u)?u.getTime():null,min:m!=null&&$(m)?m.getTime():null}}const{max:d,min:p}=o;if(l){const{max:u,min:m}=l,g=E(u)&&(d==null||d!=null&&u<d),f=E(m)&&(p==null||p!=null&&m>p);return{max:g?u:d??null,min:f?m:p??null,rawMax:g?l.rawMax:(o==null?void 0:o.rawMax)??null,rawMin:f?l.rawMin:(o==null?void 0:o.rawMin)??null}}return{min:p,max:d,rawMax:(o==null?void 0:o.rawMax)??null,rawMin:(o==null?void 0:o.rawMin)??null}}get _dateRange(){const{_dateFormRange:e,field:t}=this;if(this.dataType!=="date")return{};const l=V(t);if(!l)return e;const{max:i,min:a,rawMax:o,rawMin:d}=e;if(t.type==="date"){const{max:p,min:u}=l;return{max:E(i)&&(p===null||p!=null&&i<p)?i:p??null,min:E(a)&&(u===null||u!=null&&a>u)?a:u??null}}if(t.type==="date-only"||t.type==="time-only"||t.type==="timestamp-offset"){const{max:p,min:u,rawMax:m,rawMin:g}=l,f=E(i)&&o&&(p==null||i<p);return{max:f?i:p,min:E(a)&&d&&(u==null||a>u)?a:u,rawMax:f?o:m,rawMin:f?d:g}}return{max:null,min:null}}get _configAllowsEdits(){var a,o;const{element:e,layer:t,name:l}=this;if(e!=null)return e.editableExpression?!!this.evaluatedEditableExpression:e.editable!==!1;if(t!=null&&t.userHasUpdateItemPrivileges)return!0;const i=t&&"popupTemplate"in t?(o=(a=t==null?void 0:t.popupTemplate)==null?void 0:a.fieldInfos)==null?void 0:o.find(({fieldName:d})=>d===l):null;return(i==null?void 0:i.isEditable)??!0}get _layerAndFieldAllowEdits(){var e;return this.layerAllowsEdits&&((e=this.field)==null?void 0:e.editable)}get _isVisibleByDefault(){const{field:e,layer:t}=this;return!!(e!=null&&e.visible)&&C(e,t)}get _isEditTrackingField(){var e;return W(this.layer).includes((e=this.name)==null?void 0:e.toLowerCase())}get _shouldUseValueExpression(){return this._layerAndFieldAllowEdits&&!this._configAllowsEdits&&this.valueExpressionExecutor!=null}get isSubtypeField(){var t;const{layer:e}=this;if(e&&"subtypeField"in e){const{subtypeField:l,fieldsIndex:i}=e;return(((t=i.get(l))==null?void 0:t.name)??l)===this.name}return!1}get valueIsOutOfDomain(){const{domain:e,value:t,field:l}=this;return!(!e||t==null)&&O(l,t,e)!==null}get dataType(){const{field:e}=this;return T(e)?y.Number:D(e)?y.Text:L(e)||A(e)?y.Date:y.Unsupported}get dateDataType(){if(this.dataType===y.Date)return this.field.type!=="date"?"string":"number"}get domain(){const{layer:e,feature:t,name:l,element:i}=this,a=i==null?void 0:i.domain;return a!=null&&this._isDomainCompatible(a)?a:e.getFieldDomain(l,{feature:t})}get editable(){return!!this._layerAndFieldAllowEdits&&(this.evaluatedEditableExpression??this._configAllowsEdits)}get evaluatedRequiredExpression(){const{requiredExpressionExecutor:e}=this;return e!=null?!!e.lastEvaluatedValue:null}get evaluatedValueExpression(){const{valueExpressionExecutor:e}=this;return e!=null?e.lastEvaluatedValue:null}get hint(){var e;return(e=this.element)==null?void 0:e.hint}get includeDate(){return!(this.dataType!==y.Date||this.field.type==="time-only")}get includeTime(){var i;const{element:e,field:t}=this;if(this.dataType!==y.Date)return!1;if(t.type==="time-only")return!0;if(t.type==="date-only")return!1;const l=((i=e==null?void 0:e.input)==null?void 0:i.type)==="datetime-picker"?e.input.includeTime:void 0;return l===void 0||l}get includeTimeOffset(){var t;if(this.field.type!=="timestamp-offset")return!1;const e=(t=this.element)==null?void 0:t.input;return!e||e.type==="datetimeoffset-picker"&&e.includeTimeOffset}set initialFeature(e){this._set("initialFeature",e),this.notifyChange("valid")}get inputType(){var e,t;return(t=(e=this.element)==null?void 0:e.input)==null?void 0:t.type}get hasInvalidSwitchValue(){const{element:e}=this,t=te(e,"switch")?e.input:null;return!t||ie(this.value,t)}get isRelationshipKeyField(){var l;const{field:e,layer:t}=this;return Y(t)&&!!((l=t.relationships)!=null&&l.some(i=>i.keyField===e.name))}get label(){var t;const{field:e}=this;return this.getFormattedLabel((t=this.element)==null?void 0:t.label)??e.alias??e.name}get maxLength(){if(this.dataType===y.Date)return-1;const{field:t,element:l}=this,i=(t==null?void 0:t.length)??-1,a=I(l)?l.input.maxLength:NaN;return a!=null&&!isNaN(a)&&a>=-1&&(i===-1||a<=i)?a:i}get minLength(){if(this.dataType===y.Date)return-1;const{field:t,element:l}=this,i=(t==null?void 0:t.length)??-1,a=I(l)?l.input.minLength:NaN;return a!=null&&!isNaN(a)&&a>=-1&&(i===-1||a<=i)?a:-1}get name(){var e;return(e=this.field)==null?void 0:e.name}get range(){const{domain:e,element:t,field:l}=this;if(this.dataType==="date")return this._dateRange;const i=V(l,e)||H(l,e),a=(i==null?void 0:i.max)===Number.MAX_VALUE?null:(i==null?void 0:i.max)??null,o=(i==null?void 0:i.min)===-Number.MAX_VALUE?null:(i==null?void 0:i.min)??null;if(!(t!=null&&t.domain)||t.domain.type!=="range")return{max:a,min:o};const{max:d,min:p}=V(l)||{};return{max:d!=null&&(a===null||a!=null&&d<a)?d:a,min:p!=null&&(o===null||o!=null&&p>o)?p:o}}get required(){var o;const{editable:e,evaluatedRequiredExpression:t,field:l,visible:i,isSubtypeField:a}=this;return e?(l==null?void 0:l.nullable)===!1||a?!0:!(!i||((o=this.group)==null?void 0:o.visible)===!1||t==null)&&t:!1}set required(e){this._overrideIfSome("required",e)}get showNoValueOptionEnabled(){const{element:e}=this;return!this.required&&(!N(e)||e.input.showNoValueOption)}get showNoValueLabel(){const{element:e}=this;return N(e)?e.input.noValueOptionLabel:null}get submittable(){const{field:e,required:t,valid:l,value:i}=this;return(!t||i!=null)&&(!!l||this.initialFeature.getAttribute(e.name)===i)}get timeResolution(){var t;const e=(t=this.element)==null?void 0:t.input;if(e&&(e.type==="datetimeoffset-picker"||e.type==="time-picker"))return e.timeResolution??"minutes"}get timeStep(){return this.timeResolution!=null?B.get(this.timeResolution):void 0}get updating(){const{editableExpressionExecutor:e,valueExpressionExecutor:t,visibilityExpressionExecutor:l,preservesValueWhenHidden:i}=this;return t!=null&&t.updating||e!=null&&e.updating||i===!1&&l!=null&&l.updating}get valid(){const e=this.editable?this._validate():null;return this._set("error",e),e===null}get value(){var e,t,l,i;if(this._fieldInputWasVisibleDuringLifetime=this._fieldInputWasVisibleDuringLifetime||this.visible&&((e=this.group)==null?void 0:e.visible)!==!1,this.preservesValueWhenHidden===!1&&this._fieldInputWasVisibleDuringLifetime&&(((t=this.visibilityExpressionExecutor)==null?void 0:t.lastEvaluatedValue)===!1||((i=(l=this.group)==null?void 0:l.visibilityExpressionExecutor)==null?void 0:i.lastEvaluatedValue)===!1))return this._storedValue!==null&&this.set("_storedValue",null),null;if(this._shouldUseValueExpression){const a=this.evaluatedValueExpression;return this.dataType===y.Date?this._arcadeOutputToDateFieldValue(a):a!=null&&typeof a=="object"?a.toString():a}return this._storedValue}set value(e){this.notifyChange("evaluatedVisibilityExpression"),this.set("_storedValue",e)}get visible(){var e;return!this._isEditTrackingField&&(this.evaluatedVisibilityExpression!=null?this.evaluatedVisibilityExpression:this.element!=null&&((e=this.field)==null?void 0:e.visible)!==!1||this._isVisibleByDefault)}_arcadeOutputToDateFieldValue(e){const t=this.field.type;try{if(typeof e=="object"){if(e===null)throw new F("feature-form:invalid-date-value");if(Z(e))return j(e,t);if("getTime"in e&&typeof e.getTime=="function"&&t==="date")return parseInt(e.getTime(),10);if(t==="date-only"||t==="time-only"||t==="timestamp-offset")return e.toString()}else{if(typeof e=="string")return t==="date"?parseInt(e,10):e;if(typeof e=="number"&&t==="date")return e}throw new F("feature-form:invalid-date-value")}catch{return t==="date"?NaN:""}}_isDomainCompatible(e){const{field:t}=this;if((e==null?void 0:e.type)==="coded-value"){const l=typeof e.codedValues[0].code;if(l==="string"&&D(t)||l==="number"&&T(t))return!0}return!!((e==null?void 0:e.type)==="range"&&T(t)||L(t)||A(t))}_validate(){const{dataType:e,domain:t,field:l,initialFeature:i,minLength:a,range:o,required:d,valid:p,value:u,maxLength:m}=this,g=d&&u==null,f=p!==void 0;if(!g&&i.getAttribute(l.name)===u&&f)return null;if(g)return K.INVALID_TYPE;if(e==="text"&&typeof u=="string"){if(a>-1&&u.length<a)return R.TOO_SHORT;if(m>-1&&u.length>m)return R.TOO_LONG}return e!=="date"||u==null||X({type:l.type,range:o,value:u})?t?u!==null||d?O(l,u,t):null:z(l,u):G.OUT_OF_RANGE}};n([r()],s.prototype,"_dateFormRange",null),n([r()],s.prototype,"_dateRange",null),n([r()],s.prototype,"_storedValue",void 0),n([r()],s.prototype,"_configAllowsEdits",null),n([r()],s.prototype,"_layerAndFieldAllowEdits",null),n([r()],s.prototype,"_isVisibleByDefault",null),n([r()],s.prototype,"_isEditTrackingField",null),n([r()],s.prototype,"_shouldUseValueExpression",null),n([r()],s.prototype,"isSubtypeField",null),n([r()],s.prototype,"valueIsOutOfDomain",null),n([r()],s.prototype,"dataType",null),n([r()],s.prototype,"dateDataType",null),n([r()],s.prototype,"domain",null),n([r()],s.prototype,"editable",null),n([r({readOnly:!0})],s.prototype,"error",void 0),n([r({constructOnly:!0})],s.prototype,"preservesValueWhenHidden",void 0),n([r()],s.prototype,"evaluatedRequiredExpression",null),n([r()],s.prototype,"evaluatedValueExpression",null),n([r()],s.prototype,"field",void 0),n([r()],s.prototype,"group",void 0),n([r({readOnly:!0})],s.prototype,"hint",null),n([r()],s.prototype,"includeDate",null),n([r()],s.prototype,"includeTime",null),n([r()],s.prototype,"includeTimeOffset",null),n([r()],s.prototype,"initialFeature",null),n([r({readOnly:!0})],s.prototype,"inputType",null),n([r()],s.prototype,"hasInvalidSwitchValue",null),n([r()],s.prototype,"isRelationshipKeyField",null),n([r()],s.prototype,"label",null),n([r()],s.prototype,"maxLength",null),n([r()],s.prototype,"minLength",null),n([r({readOnly:!0})],s.prototype,"name",null),n([r()],s.prototype,"range",null),n([r()],s.prototype,"required",null),n([r()],s.prototype,"requiredExpressionExecutor",void 0),n([r()],s.prototype,"showNoValueOptionEnabled",null),n([r()],s.prototype,"submittable",null),n([r()],s.prototype,"timeResolution",null),n([r()],s.prototype,"timeStep",null),n([r({readOnly:!0})],s.prototype,"type",void 0),n([r()],s.prototype,"updating",null),n([r()],s.prototype,"valid",null),n([r({value:null})],s.prototype,"value",null),n([r()],s.prototype,"valueExpressionExecutor",void 0),n([r()],s.prototype,"visible",null),s=n([w("esri.widgets.FeatureForm.FieldInput")],s);const $=e=>e&&!Number.isNaN(e.valueOf()),_e=s;export{_e as M,se as a,re as l,le as n,xe as r,Ee as s};
