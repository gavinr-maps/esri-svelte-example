const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./editingSupport-CA_XWXsU.js","./Graphic-DsxsIjhH.js","./tslib.es6-B3Jf3DVX.js","./geometry-D964gYQX.js","./subclass-BZA_h8Db.js","./Extent-Bf3YTe7m.js","./Point-Cg0-ChZE.js","./Accessor-BLX9ikPh.js","./cast-Bjksrh93.js","./writer-DNAwXnhG.js","./assets-C43MgM-v.js","./index-Bh2oEzTI.js","./index-2kwcjS9-.css","./jsonMap-0cxwUWs2.js","./Polyline-D9YkgmM_.js","./mathUtils-C4_ghTv4.js","./PopupTemplate-BHMhS05j.js","./Clonable-D3rtuBWg.js","./Collection-CEdjem1-.js","./Evented-BHRw9x22.js","./shared-B3wH2qpO.js","./SimpleObservable-KocWTzVy.js","./fieldUtils-tmQlKvWo.js","./intl-CChhNOV8.js","./date-DlqISzcw.js","./locale-C9TlLpzi.js","./messages-OmQvZhAg.js","./enumeration-Ba5njXdz.js","./Color-BCS62Hs5.js","./colorUtils-0bJDPow9.js","./ActionToggle-iT4slXc7.js","./Identifiable-B1UbsKNt.js","./symbols-CNimns--.js","./TextSymbol-D8QO_KUV.js","./screenUtils-_ZIvrt5o.js","./materialUtils-DarhapKC.js","./opacityUtils-C68Tlu6_.js","./vec3f64-BLpZdpfb.js","./aaBoundingBox-BE7cC1jD.js","./persistableUrlUtils-fa1mAujs.js","./collectionUtils-D_lHIu88.js","./Portal-C10FKnaA.js","./Loadable-BabW5Xcc.js","./Promise-B2Hu02L7.js","./reactiveUtils-C5zUhJQJ.js","./asyncUtils-CWX51uTe.js","./jsonUtils-CEfjT-BK.js","./uuid-fwrPAdZb.js","./normalizeUtils-EVmAQ-ak.js","./normalizeUtilsCommon-dT81xWiM.js","./utils-6jMaHUrH.js","./utils-Bema0iXE.js","./EditBusLayer-DoTks2sU.js","./infoFor3D-C0hFfS1m.js","./layerUtils-BrNoooE9.js"])))=>i.map(i=>d[i]);
import{_ as F}from"./index-Bh2oEzTI.js";import{i as y}from"./assets-C43MgM-v.js";import{h as A}from"./symbols-CNimns--.js";import{b as O}from"./asyncUtils-CWX51uTe.js";import{u as P,b as i}from"./subclass-BZA_h8Db.js";import{n as j}from"./jsonMap-0cxwUWs2.js";import{e as E}from"./fieldUtils-tmQlKvWo.js";import{p as x,i as q}from"./Field-ybkHhtnK.js";import{r as L}from"./featureQueryAll-DnVoEjkM.js";import{x as S}from"./layerUtils-BrNoooE9.js";import{p as R}from"./SimpleRenderer-BV2L9G_n.js";import{A as C}from"./UniqueValueRenderer-BQtAHUSo.js";import{c as M}from"./AttachmentQuery-BUlkjzkx.js";import{b as m}from"./Query-5Xpquc1r.js";import v from"./RelationshipQuery-DPPNeuLK.js";const tt=new j({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"});async function et(t,e,r,n){const o=await f(t);if(await w(t,e,n),!o.addAttachment)throw new i(n,"Layer source does not support addAttachment capability");return o.addAttachment(e,r)}function w(t,e,r){var a,s;const{attributes:n}=e,{objectIdField:o}=t;return(s=(a=t.capabilities)==null?void 0:a.data)!=null&&s.supportsAttachment?e?n?o&&n[o]?Promise.resolve():Promise.reject(new i(r,`feature is missing the identifying attribute ${o}`)):Promise.reject(new i(r,"'attributes' are required on a feature to query attachments")):Promise.reject(new i(r,"A feature is required to add/delete/update attachments")):Promise.reject(new i(r,"this layer doesn't support attachments"))}async function nt(t,e,r,n,o){const a=await f(t);if(await w(t,e,o),!a.updateAttachment)throw new i(o,"Layer source does not support updateAttachment capability");return a.updateAttachment(e,r,n)}async function rt(t,e,r){const{applyEdits:n}=await F(()=>import("./editingSupport-CA_XWXsU.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54]),import.meta.url),o=await t.load();let a=r;return o.type==="feature"&&o.infoFor3D&&e.deleteFeatures!=null&&o.globalIdField!=null&&(a={...a,globalIdToObjectId:await D(o,e.deleteFeatures,o.globalIdField)}),n(o,o.source,e,r)}async function ot(t,e,r){const{uploadAssets:n}=await F(()=>import("./editingSupport-CA_XWXsU.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54]),import.meta.url),o=await t.load();return n(o,o.source,e,r)}async function at(t,e,r,n){const o=await f(t);if(await w(t,e,n),!o.deleteAttachments)throw new i(n,"Layer source does not support deleteAttachments capability");return o.deleteAttachments(e,r)}async function it(t,e,r){const n=(await t.load({signal:e==null?void 0:e.signal})).source;if(!n.fetchRecomputedExtents)throw new i(r,"Layer source does not support fetchUpdates capability");return n.fetchRecomputedExtents(e)}async function st(t,e,r,n){var g,I;e=M.from(e),await t.load();const o=t.source,a=t.capabilities;if(!((g=a==null?void 0:a.data)!=null&&g.supportsAttachment))throw new i(n,"this layer doesn't support attachments");const{attachmentTypes:s,objectIds:u,globalIds:p,num:c,size:l,start:d,where:b}=e;if(!((I=a==null?void 0:a.operations)!=null&&I.supportsQueryAttachments)&&((s==null?void 0:s.length)>0||(p==null?void 0:p.length)>0||(l==null?void 0:l.length)>0||c||d||b))throw new i(n,"when 'capabilities.operations.supportsQueryAttachments' is false, only objectIds is supported",e);if(!(u!=null&&u.length||p!=null&&p.length||b))throw new i(n,"'objectIds', 'globalIds', or 'where' are required to perform attachment query",e);if(!o.queryAttachments)throw new i(n,"Layer source does not support queryAttachments capability",e);return o.queryAttachments(e)}async function ut(t,e,r,n){const o=await f(t);if(!o.queryObjectIds)throw new i(n,"Layer source does not support queryObjectIds capability");return o.queryObjectIds(m.from(e)??t.createQuery(),r)}async function ct(t,e,r,n){const o=await f(t);if(!o.queryFeatureCount)throw new i(n,"Layer source does not support queryFeatureCount capability");return o.queryFeatureCount(m.from(e)??t.createQuery(),r)}async function lt(t,e,r,n){const o=await f(t);if(!o.queryExtent)throw new i(n,"Layer source does not support queryExtent capability");return o.queryExtent(m.from(e)??t.createQuery(),r)}async function pt(t,e,r,n){const o=await f(t);if(!o.queryRelatedFeatures)throw new i(n,"Layer source does not support queryRelatedFeatures capability");return o.queryRelatedFeatures(v.from(e),r)}async function dt(t,e,r,n){const o=await f(t);if(!o.queryRelatedFeaturesCount)throw new i(n,"Layer source does not support queryRelatedFeaturesCount capability");return o.queryRelatedFeaturesCount(v.from(e),r)}async function ft(t){const e=t.source;if(e!=null&&e.refresh)try{const{dataChanged:r,updates:n}=await e.refresh();if(n!=null&&(t.sourceJSON={...t.sourceJSON,...n},t.read(n,{origin:"service",url:t.parsedUrl})),r)return!0}catch{}if(t.definitionExpression)try{return(await E(t.definitionExpression,t.fieldsIndex)).hasDateFunctions}catch{}return!1}function yt(t){var s,u;const e=new m,r=(s=t.capabilities)==null?void 0:s.data,n=(u=t.capabilities)==null?void 0:u.query;e.historicMoment=t.historicMoment,e.gdbVersion=t.gdbVersion,e.returnGeometry=!0,n&&(e.compactGeometryEnabled=n.supportsCompactGeometry,e.defaultSpatialReferenceEnabled=n.supportsDefaultSpatialReference),r&&(r.supportsZ&&t.returnZ!=null&&(e.returnZ=t.returnZ),r.supportsM&&t.returnM!=null&&(e.returnM=t.returnM)),e.outFields=["*"];const{timeOffset:o,timeExtent:a}=t;return e.timeExtent=o!=null&&a!=null?a.offset(-o.value,o.unit):a||null,e.multipatchOption=t.geometryType==="multipatch"?"xyFootprint":null,e}function mt(t){const{globalIdField:e,fields:r}=t;if(e)return e;if(r){for(const n of r)if(n.type==="esriFieldTypeGlobalID")return n.name}}function ht(t){const{objectIdField:e,fields:r}=t;if(e)return e;if(r){for(const n of r)if(n.type==="esriFieldTypeOID")return n.name}}function wt(t){return t.currentVersion?t.currentVersion:t.hasOwnProperty("capabilities")||t.hasOwnProperty("drawingInfo")||t.hasOwnProperty("hasAttachments")||t.hasOwnProperty("htmlPopupType")||t.hasOwnProperty("relationships")||t.hasOwnProperty("timeInfo")||t.hasOwnProperty("typeIdField")||t.hasOwnProperty("types")?10:9.3}function bt(t,e){const{subtypes:r,subtypeField:n}=t;if(!(e!=null&&e.attributes)||!(r!=null&&r.length)||!n)return null;const o=e.attributes[n];return o==null?null:r.find(a=>a.code===o)}function gt(t,e){var a,s;const{fieldsIndex:r,subtypeField:n}=t,{name:o}=r.get(e)??{};if(!o)return null;if((n&&((a=r.get(n))==null?void 0:a.name))===o&&((s=t.subtypes)!=null&&s.length)){const u=t.subtypes.map(p=>new x({code:p.code,name:p.name}));if(u!=null&&u.length)return new q({codedValues:u})}return null}function It(t,e){var o,a;const{fieldsIndex:r}=t,{name:n}=r.get(e)??{};if(!n)return null;if(("typeIdField"in t?(o=r.get(t.typeIdField))==null?void 0:o.name:null)===n&&"types"in t&&((a=t.types)!=null&&a.length)){const s=t.types.map(u=>new x({code:u.id,name:u.name}));return new q({codedValues:s})}return null}async function f(t){return(await t.load()).source}async function _(t,e){if(!y||y.findCredential(t))return;let r;try{const n=await S(t,e);n&&(r=await y.checkSignInStatus(`${n}/sharing`))}catch{}if(r)try{const n=e!=null?e.signal:null;await y.getCredential(t,{signal:n})}catch{}}async function Ft(t,e,r){var o;const n=(o=t.parsedUrl)==null?void 0:o.path;n&&t.authenticationTriggerEvent===e&&await _(n,r)}function xt(t){return!T(t)&&(t.userHasUpdateItemPrivileges||t.editingEnabled)}const h=P({types:A});function qt(t,e){var r;if(t.defaultSymbol)return(r=t.types)!=null&&r.length?new C({defaultSymbol:h(t.defaultSymbol,t,e),field:t.typeIdField,uniqueValueInfos:t.types.map(n=>({id:n.id,symbol:h(n.symbol,n,e)}))}):new R({symbol:h(t.defaultSymbol,t,e)})}function vt(t){var n,o,a;let e=(n=t.sourceJSON)==null?void 0:n.cacheMaxAge;if(!e)return!1;const r=(a=(o=t.editingInfo)==null?void 0:o.lastEditDate)==null?void 0:a.getTime();return r==null||(e*=1e3,Date.now()-r<e)}async function D(t,e,r){if(e==null)return null;const n=[],{objectIdField:o}=t;if(e.forEach(c=>{let l=null;if("attributes"in c){const{attributes:d}=c;l={globalId:d[r],objectId:d[o]!=null&&d[o]!==-1?d[o]:null}}else l={globalId:c.globalId,objectId:c.objectId!=null&&c.objectId!==-1?c.objectId:null};l.globalId!=null&&(l.objectId!=null&&l.objectId!==-1||n.push(l.globalId))}),n.length===0)return null;const a=t.createQuery();a.where=n.map(c=>`${r}='${c}'`).join(" OR "),a.returnGeometry=!1,a.outFields=[o,r],a.cacheHint=!1;const s=await O(L(t,a));if(!s.ok)return null;const u=new Map,p=s.value.features;for(const c of p){const l=c.attributes[r],d=c.attributes[o];l!=null&&d!=null&&d!==-1&&u.set(l,d)}return u}function At(t,e,r){if(!e||!r||!t)return null;const n=r.getAttribute(e);return n==null?null:t.find(o=>{const{id:a}=o;return a!=null&&a.toString()===n.toString()})??null}function T(t){var e;return((e=t.sourceJSON)==null?void 0:e.isMultiServicesView)||G(t)}function G(t){var e,r;return!!((r=(e=t.sourceJSON)==null?void 0:e.capabilities)!=null&&r.toLowerCase().split(",").map(n=>n.trim()).includes("map"))}function Ot(t,e,r){const n=e==null?void 0:e.queryBins;if(!n)throw new i(r,"Layer source does not support binning");switch(t.binParameters.type){case"auto-interval":if(!n.supportsAutoInterval)throw new i(r,"Layer source does not support auto-interval binning");break;case"date":if(!n.supportsDate)throw new i(r,"Layer source does not support date binning");break;case"fixed-boundaries":if(!n.supportsFixedBoundaries)throw new i(r,"Layer source does not support fixed-boundaries binning");break;case"fixed-interval":if(!n.supportsFixedInterval)throw new i(r,"Layer source does not support fixed-interval binning")}const o=n==null?void 0:n.supportedStatistics;if(t.outStatistics&&o){const a=new Map([["count","count"],["sum","sum"],["min","min"],["max","max"],["avg","avg"],["stddev","stddev"],["var","var"],["percentile-continuous","percentileContinuous"],["percentile-discrete","percentileDiscrete"],["centroid-aggregate","centroid"],["convex-hull-aggregate","convexHull"],["envelope-aggregate","envelope"]]);for(const{statisticType:s}of t.outStatistics){const u=a.get(s);if(u&&!o[u])throw new i(r,`Layer source does not support ${s} statistic type`)}}}export{vt as $,ut as A,mt as C,gt as D,ft as E,at as F,It as G,At as H,rt as I,Ot as K,yt as L,wt as M,qt as N,pt as O,dt as P,ht as R,lt as S,_ as T,Ft as U,bt as V,D as Z,nt as g,tt as h,ot as j,xt as k,it as q,ct as v,et as w,st as x,T as z};
