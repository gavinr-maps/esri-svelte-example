const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-BtF7Kdcs.js","./index-CjrYEQXz.js","./jsxFactory-CLjKarlq.js","./Accessor-BHnuXKD2.js","./intl-Do3GEEJ7.js","./Promise-CmQqe-ke.js","./cast-BA_-jlhc.js","./index-tefRSezt.js","./index-Cx51aysm.css","./JSONSupport-CGdeqxpk.js","./Evented-DCWccWGU.js","./reactiveUtils-BR0C1Kq4.js","./SimpleObservable-7oieNGD8.js","./uuid-Cl5lrJ4c.js","./guid-ejniuQmw.js","./useT9n-CJAswmP1.js","./index-73bQemcW.js","./dom--xxYYVQF.js","./observers-BdozwIHb.js","./ref-Ccn4I0kT.js","./directive-helpers-C0aXnQdc.js","./static-g4FJ4v8I.js","./form-B15gmg4q.js","./interactive-B8siLByk.js","./label-BLne9qNB.js","./loadable-DOQnSSjG.js","./component-CFGnHAqh.js"])))=>i.map(i=>d[i]);
import{_ as B,i as L,L as V,u as O,c as D,n as S,a as H}from"./index-tefRSezt.js";import{r as s,m as o,a as T,g as I,t as N,j as k}from"./Accessor-BHnuXKD2.js";import{e as P,O as x,c as E,n as l}from"./jsxFactory-CLjKarlq.js";import{v as A}from"./LineOfSightAnalysis-DbzBthny.js";import{u as R,f as G}from"./LineOfSightAnalysisTarget-lDG5k5Zs.js";import{V as j,d as v,A as z,C as b}from"./reactiveUtils-BR0C1Kq4.js";import{t as W,n as Z}from"./collectionUtils-CbaToa73.js";import{j as w}from"./Point-XGrwlf63.js";import{u as U,m as F,j as q}from"./elevationInfoUtils-RSZ4Logn.js";import{b as J}from"./Graphic-CFXUQZlS.js";import{_ as K}from"./AnalysisViewModel-BSSEPi0d.js";import{e as M}from"./globalCss-CZa70j6i.js";import{P as Q}from"./useWidget-Dlf3SkC7.js";import"./intl-Do3GEEJ7.js";import"./Promise-CmQqe-ke.js";import"./cast-BA_-jlhc.js";import"./JSONSupport-CGdeqxpk.js";import"./Evented-DCWccWGU.js";import"./uuid-Cl5lrJ4c.js";import"./Analysis-BnA3eZRj.js";import"./Clonable-DvJsj5LF.js";import"./Identifiable-BrT7zvUW.js";import"./projection-B2I9Bzj_.js";import"./SimpleObservable-7oieNGD8.js";import"./vec3f64-BLpZdpfb.js";import"./Extent-CBBGeHb-.js";import"./Polyline-BmuD2-ZN.js";import"./writer-B2bQV2uU.js";import"./mathUtils-DV9iOXpW.js";import"./projectBuffer-DOU0xvVi.js";import"./geodesicConstants-yASAK_zX.js";import"./aaBoundingBox-CeBivBRq.js";import"./featureReferenceUtils-B05j576q.js";import"./vec32-Dvg_eL9J.js";import"./common-DQOJ18NT.js";import"./sphere-DQxj5tsv.js";import"./mat4-Fi6iAz29.js";import"./vec42-YcqnINSP.js";import"./vec4f64-o2zAXfmz.js";import"./mat3-CR8GKnhD.js";import"./mat3f64-BBpwCtoL.js";import"./plane-4dpuo6-e.js";import"./mat4f64-Dk4dwAN8.js";import"./quatf64-CCm9z-pX.js";import"./vec2f64-Dy6m9Nrb.js";import"./mathUtils-B9R7G-2c.js";import"./intersectorUtils-l6zkk4nF.js";import"./boundedPlane-Dyz2ub5d.js";import"./lineSegment-C-CDF7QX.js";import"./intersectorUtilsConversions-CZnn6t-z.js";import"./Intersector-DPK4WnQE.js";import"./persistable-t26j-4kt.js";import"./MD5-C9MwAd2G.js";import"./multiOriginJSONSupportUtils-C0wm8_Yw.js";import"./resourceExtension-DBdDmYtS.js";import"./ElevationInfo-Di4W6v5U.js";import"./opacityUtils-CSd4XoR2.js";import"./unitConversionUtils-C4AR5obr.js";import"./lengthUtils-DjJgJFRg.js";import"./enumeration-Cr5WIZs4.js";import"./Color-gncXBiLc.js";import"./colorUtils-Rxh2V3ai.js";import"./ActionToggle-__-l4AdQ.js";import"./jsonUtils-Cu7OBRmN.js";import"./typeUtils-BSg8Y507.js";import"./TextSymbol-BQ_NW9Xo.js";import"./screenUtils-_ZIvrt5o.js";import"./Portal-CTRRujjZ.js";import"./index-BkKcLxWB.js";import"./component-utils-DWY0IMHC.js";let p=class extends I{constructor(t){super(t),this.location=null,this.intersectedLocation=null,this.intersectedGraphic=null,this.visible=void 0}};s([o({type:w})],p.prototype,"location",void 0),s([o({type:w})],p.prototype,"intersectedLocation",void 0),s([o({type:J})],p.prototype,"intersectedGraphic",void 0),s([o({type:Boolean})],p.prototype,"visible",void 0),p=s([T("esri.widgets.LineOfSight.LineOfSightTarget")],p);const $=p,_=j.ofType($);let c=class extends K{constructor(e){super(e),this.analysis=null,this.supportedViewType="3d",this.unsupportedErrorMessage="LineOfSightViewModel is only supported in 3D views.",this._vmTargetsToConnection=new Map,this._analysisTargetsToConnection=new Map}initialize(){this.addHandles([this.targets.on("after-add",e=>this._onViewModelTargetAdded(e.item)),this.targets.on("after-remove",e=>this._onViewModelTargetRemoved(e.item)),v(()=>this.analysis,e=>this._onAnalysisChange(e),z)])}destroy(){this._analysisTargetsToConnection.forEach(e=>e.remove())}get state(){return this.disabled||!this.ready?"disabled":this.tool==null?"ready":this.tool.state}get observer(){const{observer:e}=this.analysis;return(e==null?void 0:e.position)==null?null:this._convertAnalysisPointToAbsoluteHeight(e.position,e.elevationInfo)}set observer(e){let t=null;e&&(t=e.clone(),t.hasZ||(t.z=0)),this.analysis.observer=new R({position:t})}get targets(){return this._get("targets")||new _}set targets(e){this._set("targets",Z(e,this.targets,_))}continue(){this.tool!=null&&this.tool.continue()}stop(){this.tool!=null&&this.tool.stop()}get testInfo(){}constructAnalysis(){return new A}async onConnectToAnalysisView(e){this.addHandles([e.on("result-changed",t=>{const i=this._analysisTargetsToConnection.get(t.target);i&&(t.result!=null?(i.viewModelTarget.intersectedGraphic=t.result.intersectedGraphic,i.viewModelTarget.intersectedLocation=t.result.intersectedLocation,i.viewModelTarget.visible=t.result.visible):(i.viewModelTarget.intersectedGraphic=null,i.viewModelTarget.intersectedLocation=null,i.viewModelTarget.visible=void 0))})],"view")}onDisconnectFromAnalysisView(){this.removeHandles("view")}_onViewModelTargetAdded(e){if(this._vmTargetsToConnection.get(e))return;const t=new G({position:e.location});this._connectViewModelWithAnalysisTarget(e,t),this.analysis.targets.add(t)}_onViewModelTargetRemoved(e){const t=this._vmTargetsToConnection.get(e);t&&(t.remove(),this.analysis.targets.remove(t.analysisTarget))}_onAnalysisTargetAdded(e){if(this._analysisTargetsToConnection.get(e))return;const{position:t}=e,i=new $({location:t?this._convertAnalysisPointToAbsoluteHeight(t,e.elevationInfo):null});this._connectViewModelWithAnalysisTarget(i,e),this.targets.add(i)}_onAnalysisTargetRemoved(e){const t=this._analysisTargetsToConnection.get(e);t&&(t.remove(),this.targets.remove(t.viewModelTarget))}_connectViewModelWithAnalysisTarget(e,t){let i=!1;const m=N([v(()=>({position:t.position,elevationInfo:t.elevationInfo}),({position:d,elevationInfo:a})=>{i||(i=!0,e.location=d?this._convertAnalysisPointToAbsoluteHeight(d,a):null,i=!1)},b),v(()=>e.location,d=>{if(!i){i=!0;let a=null;d&&(a=d.clone(),a.hasZ||(a.z=0)),t.position=a,t.elevationInfo=null,i=!1}},b)]),g={analysisTarget:t,viewModelTarget:e,remove:()=>{m.remove(),this._vmTargetsToConnection.delete(e),this._analysisTargetsToConnection.delete(t)}};this._vmTargetsToConnection.set(e,g),this._analysisTargetsToConnection.set(t,g)}_onAnalysisChange(e){const t="analysis";this.removeHandles(t),this.addHandles([this.analysis.targets.on("after-add",i=>this._onAnalysisTargetAdded(i.item)),this.analysis.targets.on("after-remove",i=>this._onAnalysisTargetRemoved(i.item))],t),this.targets.removeAll(),e.targets.forEach(i=>{this._onAnalysisTargetAdded(i)})}_convertAnalysisPointToAbsoluteHeight(e,t){const i=e.clone();if(this.view!=null){const m=U(e.hasZ,t);i.z=F(this.view,e,m,q)}return i}};s([o({type:A})],c.prototype,"analysis",void 0),s([o({readOnly:!0})],c.prototype,"state",null),s([o({type:w})],c.prototype,"observer",null),s([o({type:_,cast:W,nonNullable:!0})],c.prototype,"targets",null),c=s([T("esri.widgets.LineOfSight.LineOfSightViewModel")],c);const C=c,r="esri-line-of-sight",h={base:r,actions:`${r}__actions`,container:`${r}__container`,error:`${r}__error`,hint:`${r}__hint`,hintText:`${r}__hint-text`,newAnalysisButton:`${r}__new-analysis-button`},y={newAnalysisButton:`${r}__new-button`,continueButton:`${r}__continue-button`,doneButton:`${r}__done-button`};let n=class extends x{constructor(t,i){super(t,i),this.messages=null,this.viewModel=new C,this._onNewAnalysis=()=>{k(this.viewModel.start())},this._onDone=()=>{this.viewModel.stop()},this._onContinue=()=>{this.viewModel.continue()}}loadDependencies(){return E({button:()=>B(()=>import("./index-BtF7Kdcs.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]),import.meta.url)})}get active(){return this.viewModel.active}get analysis(){return this.viewModel.analysis}set analysis(t){this.viewModel.analysis=t}get icon(){return"line-of-sight"}set icon(t){this._overrideIfSome("icon",t)}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}get visible(){return this.viewModel.visible}set visible(t){this.viewModel.visible=t}render(){return l("div",{class:this.classes(h.base,M.widget,M.panel),role:"presentation"},this._renderContainerNode())}_renderContainerNode(){if(!this.visible)return null;if(!this.viewModel.supported)return this._renderUnsupportedMessage();let t=null;const i=[this._renderNewAnalysisButton()];return this.viewModel.state==="creating"?(t=this._renderHint(),i.unshift(this._renderDoneButton())):this.viewModel.state==="created"&&this.viewModel.targets.length>0&&i.unshift(this._renderContinueButton()),l("div",{class:h.container},t,l("div",{class:h.actions},i))}_renderUnsupportedMessage(){return l("div",{class:h.error,key:"esri-line-of-sight__unsupported"},l("p",null,this.messages.unsupported))}_renderHint(){return l("div",{class:h.hint,key:"esri-line-of-sight__hint"},l("p",{class:h.hintText},this.messages.hint))}_renderNewAnalysisButton(){return this._renderButton({className:h.newAnalysisButton,id:y.newAnalysisButton,label:this.messages.newAnalysis,onClick:this._onNewAnalysis,primary:!0})}_renderDoneButton(){return this._renderButton({id:y.doneButton,label:this.messages.done,onClick:this._onDone,primary:!1})}_renderContinueButton(){return this._renderButton({id:y.newAnalysisButton,label:this.messages.continueAnalysis,onClick:this._onContinue,primary:!1})}_renderButton({className:t,id:i,label:m,onClick:g,primary:d}){const a=this.viewModel.state==="disabled";return l("calcite-button",{appearance:d?"solid":"outline-fill",class:t,"data-id":i,disabled:a,key:i,onclick:g},m)}get test(){}};s([o()],n.prototype,"active",null),s([o({constructOnly:!0,nonNullable:!0})],n.prototype,"analysis",null),s([o()],n.prototype,"icon",null),s([o()],n.prototype,"label",null),s([o(),P("esri/widgets/LineOfSight/t9n/LineOfSight")],n.prototype,"messages",void 0),s([o()],n.prototype,"view",null),s([o({type:C})],n.prototype,"viewModel",void 0),s([o()],n.prototype,"visible",null),n=s([T("esri.widgets.LineOfSight")],n);const X=n;/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.32/esri/copyright.txt for details.
v4.32.12 */const Y=L`@layer{arcgis-line-of-sight{display:block}}`,tt=Q(X),u=class u extends V{constructor(){super(...arguments),this.widget=tt(this),this.viewModel=this.widget.viewModel,this.analysis=this.widget.analysis,this.autoDestroyDisabled=!1,this.icon=this.widget.icon,this.label=this.widget.label,this.position="bottom-left",this.state=this.viewModel.state,this.arcgisPropertyChange=O()("analysis","state"),this.arcgisReady=D()}async clear(){var t;(t=this.widget)==null||t.viewModel.clear()}async continue(){var t;(t=this.widget)==null||t.viewModel.continue()}async destroy(){await this.manager.destroy()}async start(){var t;(t=this.widget)==null||t.viewModel.start()}async stop(){var t;(t=this.widget)==null||t.viewModel.stop()}};u.properties={analysis:0,autoDestroyDisabled:5,icon:1,label:1,position:1,referenceElement:1,state:3},u.shadowRootOptions=S,u.styles=Y;let f=u;H("arcgis-line-of-sight",f);export{f as ArcgisLineOfSight};
