const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./symbolLayerUtils-DDqSMkfS.js","./index-4eY77cms.js","./index-Cx51aysm.css","./cast-CsZslgGN.js","./Accessor-BmwT4B0c.js","./JSONSupport-DcrLLGjL.js","./LRUCache-CXiGQWMN.js","./MemCache-CmojB_Z1.js","./vec3f64-BLpZdpfb.js","./aaBoundingBox-Dw3yBk2f.js","./Extent-g5W9hy0j.js","./Point-Cz2JYYmX.js","./writer-DKgfqj4X.js","./Polyline-s-JzsQqo.js","./mathUtils-Cfq9PL9W.js","./Graphic-Dt0LgVGU.js","./Clonable-Z-AWS-16.js","./reactiveUtils-XM7cS2OP.js","./Evented-Dw4_VOGn.js","./SimpleObservable-CvOkykwM.js","./opacityUtils-Dim20wpZ.js","./Promise-DfET-uns.js","./enumeration-DpvDkLNI.js","./Color-VJEMvW-n.js","./colorUtils-Rxh2V3ai.js","./ActionToggle-D7439N1A.js","./Identifiable-BHVfzH03.js","./jsonUtils-CwFG8yN4.js","./typeUtils-B6WBEKDM.js","./TextSymbol-BLIQ6RKX.js","./screenUtils-_ZIvrt5o.js","./collectionUtils-CTT-51g7.js","./Portal-CmmHxpLg.js"])))=>i.map(i=>d[i]);
import{_ as z}from"./index-4eY77cms.js";import{h as f}from"./Color-VJEMvW-n.js";import{e as v}from"./reactiveUtils-XM7cS2OP.js";import"./Accessor-BmwT4B0c.js";import{u,e as S}from"./screenUtils-_ZIvrt5o.js";import{s as _}from"./vec3f64-BLpZdpfb.js";import{i as E}from"./jsonUtils-DZz5FrgB.js";import{C as w}from"./cimSymbolUtils-DzhKvmq_.js";import{n as R,P as C}from"./cast-CsZslgGN.js";import{e as O}from"./LRUCache-CXiGQWMN.js";import{S as p,o as y,r as P}from"./Graphic-Dt0LgVGU.js";const g="picture-fill",k="simple-fill",A="simple-line",$="simple-marker",D="text",M="cim",b=new Map([["dash",[4,3]],["dashdot",[4,3,1,3]],["dot",[1,3]],["longdash",[8,3]],["longdashdot",[8,3,1,3]],["longdashdotdot",[8,3,1,3,1,3]],["shortdash",[4,1]],["shortdashdot",[4,1,1,1]],["shortdashdotdot",[4,1,1,1,1,1]],["shortdot",[1,1]],["solid",[]]]),d=new O(1e3);function ct(t){const n=t.style;let r=null;if(t)switch(t.type){case $:n!=="cross"&&n!=="x"&&(r=t.color);break;case k:n&&n!=="solid"?n!=="none"&&(r={type:"pattern",x:0,y:0,src:R(`esri/symbols/patterns/${n}.png`),width:5,height:5}):r=t.color;break;case g:r={type:"pattern",src:t.url,width:u(t.width)*t.xscale,height:u(t.height)*t.yscale,x:u(t.xoffset),y:u(t.yoffset)};break;case D:r=t.color;break;case M:r=w(t)}return r}function ut(t,n){const r=t+"-"+n;return d.get(r)!==void 0?Promise.resolve(d.get(r)):C(t,{responseType:"image"}).then(o=>{const e=o.data,l=e.naturalWidth,i=e.naturalHeight,a=document.createElement("canvas");a.width=l,a.height=i;const s=a.getContext("2d");s.fillStyle=n,s.fillRect(0,0,l,i),s.globalCompositeOperation="destination-in",s.drawImage(e,0,0);const c=a.toDataURL();return d.put(r,c),c})}function x(t){if(!t)return null;let n=null;switch(t.type){case k:case g:case $:n=x(t.outline);break;case A:{const r=u(t.width);t.style!=null&&t.style!=="none"&&r!==0&&(n={color:t.color,style:I(t.style),width:r,cap:t.cap,join:t.join==="miter"?u(t.miterLimit):t.join},n.dashArray=N(n).join(",")||"none");break}default:n=null}return n}function N(t){if(!(t!=null&&t.style))return[];const{dashArray:n,style:r,width:o}=t;if(typeof n=="string"&&n!=="none")return n.split(",").map(i=>Number(i));const e=o??0,l=b.has(r)?b.get(r).map(i=>i*e):[];if(t.cap!=="butt")for(const[i,a]of l.entries())l[i]=i%2==1?a+e:Math.max(a-e,1);return l}const I=(()=>{const t={};return n=>{if(t[n])return t[n];const r=n.replaceAll("-","");return t[n]=r,r}})(),ft=new f([128,128,128]),J=new f("white");function T(t){var r,o;const n=(r=t.symbolLayers)==null?void 0:r.at(-1);if(n&&"outline"in n)return(o=n==null?void 0:n.outline)==null?void 0:o.size}function ht(t){var n;if(!t)return 0;if(p(t)){const r=T(t);return r??0}return S((n=x(t))==null?void 0:n.width)}function mt(t){if(t==null||!("symbolLayers"in t)||t.symbolLayers==null)return!1;switch(t.type){case"point-3d":return t.symbolLayers.some(n=>n.type==="object");case"line-3d":return t.symbolLayers.some(n=>n.type==="path");case"polygon-3d":return t.symbolLayers.some(n=>n.type==="object"||n.type==="extrude");default:return!1}}function pt(t){var n;return((n=t.resource)==null?void 0:n.href)??""}function yt(t,n){if(!t)return null;let r=null;return p(t)?r=U(t):y(t)&&(r=t.type==="cim"?w(t):t.color?new f(t.color):null),r?m(r,n):null}function U(t){const n=t.symbolLayers;if(!n)return null;let r=null;return n.forEach(o=>{var e;o.type==="object"&&((e=o.resource)!=null&&e.href)||(r=o.type==="water"?o.color:o.material?o.material.color:null)}),r?new f(r):null}function m(t,n){if(n==null||t==null)return t;const r=t.toRgba();return r[3]=r[3]*n,new f(r)}function H(t,n,r){const o=t.symbolLayers;if(!o)return;const e=l=>m(n=n??l??(r!=null?J:null),r);o.forEach(l=>{var i,a;if(l.type!=="object"||!((i=l.resource)!=null&&i.href)||n)if(l.type==="water")l.color=e(l.color);else{const s=l.material!=null?l.material.color:null,c=e(s);l.material==null?l.material=new P({color:c}):l.material.color=c,r!=null&&"outline"in l&&((a=l.outline)==null?void 0:a.color)!=null&&(l.outline.color=m(l.outline.color,r))}})}function V(t,n,r){var o;(n=n??t.color)&&(t.color=m(n,r)),r!=null&&"outline"in t&&((o=t.outline)!=null&&o.color)&&(t.outline.color=m(t.outline.color,r))}function dt(t,n,r){t&&(n||r!=null)&&(n&&(n=new f(n)),p(t)?H(t,n,r):y(t)&&V(t,n,r))}async function W(t,n){const r=t.symbolLayers;r&&await v(r,async o=>q(o,n))}async function q(t,n){switch(t.type){case"extrude":F(t,n);break;case"icon":case"line":case"text":B(t,n);break;case"path":K(t,n);break;case"object":await G(t,n)}}function B(t,n){const r=L(n);r!=null&&(t.size=r)}function L(t){for(const n of t)if(typeof n=="number")return n;return null}function F(t,n){t.size=typeof n[2]=="number"?n[2]:0}async function G(t,n){const{resourceSize:r,symbolSize:o}=await Q(t),e=j(n,r,o);t.width=h(n[0],o[0],r[0],e),t.depth=h(n[1],o[1],r[1],e),t.height=h(n[2],o[2],r[2],e)}function K(t,n){const r=j(n,_,[t.width,void 0,t.height]);t.width=h(n[0],t.width,1,r),t.height=h(n[2],t.height,1,r)}function j(t,n,r){for(let o=0;o<3;o++){const e=t[o];switch(e){case"symbol-value":{const l=r[o];return l!=null?l/n[o]:1}case"proportional":break;default:if(e&&n[o])return e/n[o]}}return 1}async function Q(t){const{computeObjectLayerResourceSize:n}=await z(()=>import("./symbolLayerUtils-DDqSMkfS.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32]),import.meta.url),r=await n(t,10),{width:o,height:e,depth:l}=t,i=[o,l,e];let a=1;for(let s=0;s<3;s++){const c=i[s];if(c!=null){a=c/r[s];break}}for(let s=0;s<3;s++)i[s]==null&&(i[s]=r[s]*a);return{resourceSize:r,symbolSize:i}}function h(t,n,r,o){switch(t){case"proportional":return r*o;case"symbol-value":return n??r;default:return t}}function X(t,n){const r=L(n);if(r!=null)switch(t.type){case"simple-marker":t.size=r;break;case"picture-marker":{const o=t.width/t.height;o>1?(t.width=r,t.height=r*o):(t.width=r*o,t.height=r);break}case"simple-line":t.width=r;break;case"text":t.font.size=r}}async function bt(t,n){if(t&&n)return p(t)?W(t,n):void(y(t)&&X(t,n))}function wt(t,n,r){if(t&&n!=null)if(p(t)){const o=t.symbolLayers;o&&o.forEach(e=>{if(e.type==="object")switch(r){case"tilt":e.tilt=(e.tilt??0)+n;break;case"roll":e.roll=(e.roll??0)+n;break;default:e.heading=(e.heading??0)+n}e.type==="icon"&&(e.angle+=n)})}else y(t)&&(t.type!=="simple-marker"&&t.type!=="picture-marker"&&t.type!=="text"||(t.angle+=n))}function gt(t){if(!t)return null;const n=t.effects.filter(r=>r.type!=="bloom").map(r=>r.toJSON());return E(n)}function kt(t){return t!=null&&t.type==="polygon-3d"&&t.symbolLayers.some(n=>n.type==="extrude")}export{bt as D,wt as J,gt as M,kt as N,dt as a,ft as b,mt as c,ut as f,N as g,yt as h,ht as m,pt as p,ct as u,I as w,x as y};
