import{r as l}from"./tslib.es6-B3Jf3DVX.js";import{a as c,m as r,s as g,b as h}from"./subclass-BZA_h8Db.js";import{w as b,e as f}from"./Accessor-BLX9ikPh.js";import{m as C}from"./Promise-B2Hu02L7.js";const w="not-loaded",S="loading",E="failed",u="loaded",m=e=>{let t=class extends e{constructor(...o){super(...o),this._loadController=null,this.loadError=null,this.loadStatus="not-loaded",this._set("loadWarnings",[]),this.addResolvingPromise(new Promise(a=>{const p=this.load.bind(this);this.load=_=>{const y=new Promise((n,d)=>{const i=b(_,d);this.destroyed&&d(new h("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this})),this.when(n,d).finally(()=>{i&&i.remove()})});if(this.loadStatus===w){this._set("loadStatus",S);const n=this._loadController=new AbortController;p({signal:n.signal})}return a(),y}})),this.when(()=>{this._set("loadStatus",u),this._loadController=null},a=>{this._set("loadStatus",E),this._set("loadError",a),this._loadController=null})}destroy(){this._loadController&&(this._loadController=f(this._loadController),this._promiseProps.abort()),this._set("loadError",null),this._set("loadWarnings",[])}get loaded(){return this.loadStatus===u}get loadWarnings(){return this._get("loadWarnings")}load(){return null}cancelLoad(){var o;return this.isFulfilled()||(this._set("loadError",new h("load:cancelled","Cancelled")),(o=this._loadController)==null||o.abort(),this._promiseProps.abort()),this}};return l([r({readOnly:!0})],t.prototype,"loaded",null),l([r({readOnly:!0})],t.prototype,"loadError",void 0),l([r({clonable:!1})],t.prototype,"loadStatus",void 0),l([r({type:[g],readOnly:!0})],t.prototype,"loadWarnings",null),t=l([c("esri.core.Loadable")],t),t};let s=class extends m(C){};s=l([c("esri.core.Loadable")],s),function(e){function t(o){return!(!o||!o.load)}e.LoadableMixin=m,e.isLoadable=t}(s||(s={}));const x=s;export{x as m};
