import{e as a}from"./subclass-BZA_h8Db.js";import{T as p}from"./Accessor-BLX9ikPh.js";import{V as c}from"./Collection-CEdjem1-.js";import{watch as s,syncAndInitial as u}from"./reactiveUtils-C5zUhJQJ.js";import{t as f,p as l,u as m,I as d}from"./SnappingManager-BJPyuu7J.js";function y(t,e){const r=new f({enabled:!0,selfEnabled:!1,featureEnabled:!0,distance:e==null?void 0:e.distance,touchSensitivityMultiplier:(e==null?void 0:e.touchSensitivityMultiplier)??l.touchSensitivityMultiplier});return{...s(()=>{var n,o;return((o=(n=t.map)==null?void 0:n.allLayers)==null?void 0:o.toArray())??[]},n=>{r.featureSources=new c(n).map(o=>new m({layer:o}))},u),options:r}}const i=new Map;function S(t){if(!i.has(t)){const n=y(t,{distance:10}),o=v(t,n.options);i.set(t,{referenceCount:0,snappingManager:o,remove:()=>{n.remove(),o.destroy()}})}const e=i.get(t);e.referenceCount++;const r=a(()=>g(t,e));return{snappingManager:e.snappingManager,...r}}function g(t,e){e.referenceCount--,e.referenceCount>0||p(()=>{e.referenceCount===0&&(e.remove(),i.delete(t))})}function v(t,e){return new d({view:t,options:e})}export{S as a};
