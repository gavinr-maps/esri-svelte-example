const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./calcite-button-D_Agetwz.js","./button-9P4PM9SO.js","./jsxFactory-CJa39Fro.js","./tslib.es6-B3Jf3DVX.js","./intl-CChhNOV8.js","./date-DlqISzcw.js","./jsonMap-0cxwUWs2.js","./subclass-BZA_h8Db.js","./locale-C9TlLpzi.js","./messages-OmQvZhAg.js","./Accessor-BLX9ikPh.js","./assets-C43MgM-v.js","./index-Bh2oEzTI.js","./index-2kwcjS9-.css","./Evented-BHRw9x22.js","./Promise-B2Hu02L7.js","./reactiveUtils-C5zUhJQJ.js","./asyncUtils-CWX51uTe.js","./Collection-CEdjem1-.js","./shared-B3wH2qpO.js","./SimpleObservable-KocWTzVy.js","./uuid-fwrPAdZb.js","./cast-Bjksrh93.js","./form-BZPQ5PUM.js","./dom-D_AJDzAj.js","./interactive-y84HQRWL.js","./label-DEe8AW1C.js","./component-6CIDVndn.js","./loadable-DM18hPdE.js","./locale-A4FuYD8q.js","./key-D63ExP77.js","./observers-D2xgmA06.js","./t9n-D0ry3MEw.js","./icon-BQO9J86c.js","./loader-C-zIPscB.js"])))=>i.map(i=>d[i]);
import{_ as $}from"./index-Bh2oEzTI.js";import{r as o}from"./tslib.es6-B3Jf3DVX.js";import{m as s,a as _,t as C}from"./subclass-BZA_h8Db.js";import{b as B,j as L}from"./Accessor-BLX9ikPh.js";import{e as V,B as H,r as I,n as a}from"./jsxFactory-CJa39Fro.js";import{v as b}from"./LineOfSightAnalysis-DHWGaskk.js";import{u as O,f as N}from"./LineOfSightAnalysisTarget-Czs0z8lJ.js";import{V as S}from"./Collection-CEdjem1-.js";import{t as k,n as D}from"./collectionUtils-D_lHIu88.js";import{watch as g,syncAndInitial as x,sync as w}from"./reactiveUtils-C5zUhJQJ.js";import{u as P,m as E,j as G}from"./elevationInfoUtils-BC_66_Fg.js";import{d as R}from"./Graphic-DsxsIjhH.js";import{j as T}from"./Point-Cg0-ChZE.js";import{_ as j}from"./AnalysisViewModel-2GZlQIqD.js";import{e as f}from"./globalCss-CZa70j6i.js";import"./intl-CChhNOV8.js";import"./date-DlqISzcw.js";import"./jsonMap-0cxwUWs2.js";import"./locale-C9TlLpzi.js";import"./messages-OmQvZhAg.js";import"./assets-C43MgM-v.js";import"./Evented-BHRw9x22.js";import"./Promise-B2Hu02L7.js";import"./uuid-fwrPAdZb.js";import"./cast-Bjksrh93.js";import"./Analysis-605EM8LG.js";import"./Clonable-D3rtuBWg.js";import"./Identifiable-B1UbsKNt.js";import"./projection-B971H0Re.js";import"./SimpleObservable-KocWTzVy.js";import"./vec3f64-BLpZdpfb.js";import"./Extent-Bf3YTe7m.js";import"./Polyline-D9YkgmM_.js";import"./writer-DNAwXnhG.js";import"./mathUtils-C4_ghTv4.js";import"./projectBuffer-Bs7GwaPY.js";import"./geodesicConstants-DWQLYX7F.js";import"./aaBoundingBox-BE7cC1jD.js";import"./featureReferenceUtils-DBGXy8CW.js";import"./vec32-Dvg_eL9J.js";import"./common-DQOJ18NT.js";import"./sphere-C77djCO6.js";import"./mat4-GpOFENPA.js";import"./vec42-YcqnINSP.js";import"./vec4f64-o2zAXfmz.js";import"./mat3-BRl2i9Bz.js";import"./mat3f64-BBpwCtoL.js";import"./plane-IENfwZlB.js";import"./mat4f64-Dk4dwAN8.js";import"./quatf64-CCm9z-pX.js";import"./vec2f64-miziP1SN.js";import"./mathUtils-BG-eq9fO.js";import"./intersectorUtils-BK9EUwUf.js";import"./boundedPlane-EV1sS2Ke.js";import"./lineSegment-D7sKPPYf.js";import"./intersectorUtilsConversions-D_fcRVdX.js";import"./Intersector-wXoCuQ8W.js";import"./Intersector-BQ92CPLA.js";import"./persistable-DjaiFmiM.js";import"./MD5-C9MwAd2G.js";import"./multiOriginJSONSupportUtils-C0wm8_Yw.js";import"./resourceExtension-D8MnQ6oV.js";import"./persistableUrlUtils-fa1mAujs.js";import"./ElevationInfo-CA5m_tHv.js";import"./fieldUtils-tmQlKvWo.js";import"./geometry-D964gYQX.js";import"./unitConversionUtils-BMfW9yAe.js";import"./lengthUtils-DL1-FDQQ.js";import"./shared-B3wH2qpO.js";import"./asyncUtils-CWX51uTe.js";import"./PopupTemplate-BHMhS05j.js";import"./enumeration-Ba5njXdz.js";import"./Color-BCS62Hs5.js";import"./colorUtils-0bJDPow9.js";import"./ActionToggle-iT4slXc7.js";import"./symbols-CNimns--.js";import"./TextSymbol-D8QO_KUV.js";import"./screenUtils-_ZIvrt5o.js";import"./materialUtils-DarhapKC.js";import"./opacityUtils-C68Tlu6_.js";import"./Portal-C10FKnaA.js";import"./Loadable-BabW5Xcc.js";import"./jsonUtils-CEfjT-BK.js";let d=class extends B{constructor(e){super(e),this.location=null,this.intersectedLocation=null,this.intersectedGraphic=null,this.visible=void 0}};o([s({type:T})],d.prototype,"location",void 0),o([s({type:T})],d.prototype,"intersectedLocation",void 0),o([s({type:R})],d.prototype,"intersectedGraphic",void 0),o([s({type:Boolean})],d.prototype,"visible",void 0),d=o([_("esri.widgets.LineOfSight.LineOfSightTarget")],d);const A=d,y=S.ofType(A);let m=class extends j{constructor(t){super(t),this.analysis=null,this.supportedViewType="3d",this.unsupportedErrorMessage="LineOfSightViewModel is only supported in 3D views.",this._vmTargetsToConnection=new Map,this._analysisTargetsToConnection=new Map}initialize(){this.addHandles([this.targets.on("after-add",t=>this._onViewModelTargetAdded(t.item)),this.targets.on("after-remove",t=>this._onViewModelTargetRemoved(t.item)),g(()=>this.analysis,t=>this._onAnalysisChange(t),x)])}destroy(){this._analysisTargetsToConnection.forEach(t=>t.remove())}get state(){return this.disabled||!this.ready?"disabled":this.tool==null?"ready":this.tool.state}get observer(){const{observer:t}=this.analysis;return(t==null?void 0:t.position)==null?null:this._convertAnalysisPointToAbsoluteHeight(t.position,t.elevationInfo)}set observer(t){let e=null;t&&(e=t.clone(),e.hasZ||(e.z=0)),this.analysis.observer=new O({position:e})}get targets(){return this._get("targets")||new y}set targets(t){this._set("targets",D(t,this.targets,y))}continue(){this.tool!=null&&this.tool.continue()}stop(){this.tool!=null&&this.tool.stop()}get testInfo(){}constructAnalysis(){return new b}async onConnectToAnalysisView(t){this.addHandles([t.on("result-changed",e=>{const i=this._analysisTargetsToConnection.get(e.target);i&&(e.result!=null?(i.viewModelTarget.intersectedGraphic=e.result.intersectedGraphic,i.viewModelTarget.intersectedLocation=e.result.intersectedLocation,i.viewModelTarget.visible=e.result.visible):(i.viewModelTarget.intersectedGraphic=null,i.viewModelTarget.intersectedLocation=null,i.viewModelTarget.visible=void 0))})],"view")}onDisconnectFromAnalysisView(){this.removeHandles("view")}_onViewModelTargetAdded(t){if(this._vmTargetsToConnection.get(t))return;const e=new N({position:t.location});this._connectViewModelWithAnalysisTarget(t,e),this.analysis.targets.add(e)}_onViewModelTargetRemoved(t){const e=this._vmTargetsToConnection.get(t);e&&(e.remove(),this.analysis.targets.remove(e.analysisTarget))}_onAnalysisTargetAdded(t){if(this._analysisTargetsToConnection.get(t))return;const{position:e}=t,i=new A({location:e?this._convertAnalysisPointToAbsoluteHeight(e,t.elevationInfo):null});this._connectViewModelWithAnalysisTarget(i,t),this.targets.add(i)}_onAnalysisTargetRemoved(t){const e=this._analysisTargetsToConnection.get(t);e&&(e.remove(),this.targets.remove(e.viewModelTarget))}_connectViewModelWithAnalysisTarget(t,e){let i=!1;const c=C([g(()=>({position:e.position,elevationInfo:e.elevationInfo}),({position:l,elevationInfo:h})=>{i||(i=!0,t.location=l?this._convertAnalysisPointToAbsoluteHeight(l,h):null,i=!1)},w),g(()=>t.location,l=>{if(!i){i=!0;let h=null;l&&(h=l.clone(),h.hasZ||(h.z=0)),e.position=h,e.elevationInfo=null,i=!1}},w)]),u={analysisTarget:e,viewModelTarget:t,remove:()=>{c.remove(),this._vmTargetsToConnection.delete(t),this._analysisTargetsToConnection.delete(e)}};this._vmTargetsToConnection.set(t,u),this._analysisTargetsToConnection.set(e,u)}_onAnalysisChange(t){const e="analysis";this.removeHandles(e),this.addHandles([this.analysis.targets.on("after-add",i=>this._onAnalysisTargetAdded(i.item)),this.analysis.targets.on("after-remove",i=>this._onAnalysisTargetRemoved(i.item))],e),this.targets.removeAll(),t.targets.forEach(i=>{this._onAnalysisTargetAdded(i)})}_convertAnalysisPointToAbsoluteHeight(t,e){const i=t.clone();if(this.view!=null){const c=P(t.hasZ,e);i.z=E(this.view,t,c,G)}return i}};o([s({type:b})],m.prototype,"analysis",void 0),o([s({readOnly:!0})],m.prototype,"state",null),o([s()],m.prototype,"observer",null),o([s({type:y,cast:k,nonNullable:!0})],m.prototype,"targets",null),m=o([_("esri.widgets.LineOfSight.LineOfSightViewModel")],m);const M=m,r="esri-line-of-sight",p={base:r,actions:`${r}__actions`,container:`${r}__container`,error:`${r}__error`,hint:`${r}__hint`,hintText:`${r}__hint-text`,newAnalysisButton:`${r}__new-analysis-button`},v={newAnalysisButton:`${r}__new-button`,continueButton:`${r}__continue-button`,doneButton:`${r}__done-button`};let n=class extends H{constructor(t,e){super(t,e),this.messages=null,this.viewModel=new M,this._onNewAnalysis=()=>{L(this.viewModel.start())},this._onDone=()=>{this.viewModel.stop()},this._onContinue=()=>{this.viewModel.continue()}}loadDependencies(){return I({button:()=>$(()=>import("./calcite-button-D_Agetwz.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34]),import.meta.url)})}get active(){return this.viewModel.active}get analysis(){return this.viewModel.analysis}set analysis(t){this.viewModel.analysis=t}get icon(){return"line-of-sight"}set icon(t){this._overrideIfSome("icon",t)}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}get visible(){return this.viewModel.visible}set visible(t){this.viewModel.visible=t}render(){return a("div",{class:this.classes(p.base,f.widget,f.panel),role:"presentation"},this._renderContainerNode())}_renderContainerNode(){if(!this.visible)return null;if(!this.viewModel.supported)return this._renderUnsupportedMessage();let t=null;const e=[this._renderNewAnalysisButton()];return this.viewModel.state==="creating"?(t=this._renderHint(),e.unshift(this._renderDoneButton())):this.viewModel.state==="created"&&this.viewModel.targets.length>0&&e.unshift(this._renderContinueButton()),a("div",{class:p.container},t,a("div",{class:p.actions},e))}_renderUnsupportedMessage(){return a("div",{class:p.error,key:"esri-line-of-sight__unsupported"},a("p",null,this.messages.unsupported))}_renderHint(){return a("div",{class:p.hint,key:"esri-line-of-sight__hint"},a("p",{class:p.hintText},this.messages.hint))}_renderNewAnalysisButton(){return this._renderButton({className:p.newAnalysisButton,id:v.newAnalysisButton,label:this.messages.newAnalysis,onClick:this._onNewAnalysis,primary:!0})}_renderDoneButton(){return this._renderButton({id:v.doneButton,label:this.messages.done,onClick:this._onDone,primary:!1})}_renderContinueButton(){return this._renderButton({id:v.newAnalysisButton,label:this.messages.continueAnalysis,onClick:this._onContinue,primary:!1})}_renderButton({className:t,id:e,label:i,onClick:c,primary:u}){const l=this.viewModel.state==="disabled";return a("calcite-button",{appearance:u?"solid":"outline-fill",class:t,"data-id":e,disabled:l,key:e,onclick:c},i)}get test(){}};o([s()],n.prototype,"active",null),o([s({constructOnly:!0,nonNullable:!0})],n.prototype,"analysis",null),o([s()],n.prototype,"icon",null),o([s()],n.prototype,"label",null),o([s(),V("esri/widgets/LineOfSight/t9n/LineOfSight")],n.prototype,"messages",void 0),o([s()],n.prototype,"view",null),o([s({type:M})],n.prototype,"viewModel",void 0),o([s()],n.prototype,"visible",null),n=o([_("esri.widgets.LineOfSight")],n);const we=n;export{we as default};
