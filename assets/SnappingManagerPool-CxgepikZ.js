import{k as a}from"./subclass-BR3PhgZG.js";import{N as p}from"./Accessor-D6mNnsWy.js";import{d as s,P as c,V as u}from"./reactiveUtils-BFQ0BtrB.js";import{k as f,p as l,l as m,I as d,P as g}from"./SnappingManager-DFm0py-D.js";function v(n,e){const r=new f({enabled:!0,selfEnabled:!1,featureEnabled:!0,distance:e==null?void 0:e.distance,touchSensitivityMultiplier:(e==null?void 0:e.touchSensitivityMultiplier)??l.touchSensitivityMultiplier});return{...s(()=>{var t,o;return((o=(t=n.map)==null?void 0:t.allLayers)==null?void 0:o.toArray())??[]},t=>{r.featureSources=new u(t.map(o=>new m({layer:o})))},c),options:r}}const i=new Map;function S(n){if(!i.has(n)){const t=v(n,{distance:10}),o=y(n,t.options);i.set(n,{referenceCount:0,snappingManager:o,remove:()=>{t.remove(),o.destroy()}})}const e=i.get(n);e.referenceCount++;const r=a(()=>w(n,e));return{snappingManager:e.snappingManager,...r}}function w(n,e){e.referenceCount--,e.referenceCount>0||p(()=>{e.referenceCount===0&&(e.remove(),i.delete(n))})}function y(n,e){return new d({view:n,options:e,snappingEnginesFactory:(r,t)=>[new g({view:n,spatialReference:n.spatialReference,options:t})]})}export{S as a};
