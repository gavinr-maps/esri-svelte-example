const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./calcite-action-Bys6x4p_.js","./action-D0Er9Ef6.js","./jsxFactory-CJa39Fro.js","./tslib.es6-B3Jf3DVX.js","./intl-CChhNOV8.js","./date-DlqISzcw.js","./jsonMap-0cxwUWs2.js","./subclass-BZA_h8Db.js","./locale-C9TlLpzi.js","./messages-OmQvZhAg.js","./Accessor-BLX9ikPh.js","./assets-C43MgM-v.js","./index-Bh2oEzTI.js","./index-2kwcjS9-.css","./Evented-BHRw9x22.js","./Promise-B2Hu02L7.js","./reactiveUtils-C5zUhJQJ.js","./asyncUtils-CWX51uTe.js","./Collection-CEdjem1-.js","./shared-B3wH2qpO.js","./SimpleObservable-KocWTzVy.js","./uuid-fwrPAdZb.js","./cast-Bjksrh93.js","./dom-D_AJDzAj.js","./interactive-y84HQRWL.js","./loadable-DM18hPdE.js","./locale-A4FuYD8q.js","./key-D63ExP77.js","./observers-D2xgmA06.js","./component-6CIDVndn.js","./t9n-D0ry3MEw.js","./icon-BQO9J86c.js","./loader-C-zIPscB.js","./calcite-button-D_Agetwz.js","./button-9P4PM9SO.js","./form-BZPQ5PUM.js","./label-DEe8AW1C.js","./calcite-chip-group-BedxdOvW.js","./calcite-chip-C9GKwE1v.js","./chip-ZieJjxzJ.js","./calcite-fab-CKoU_mWy.js","./calcite-flow-BrE9BG4l.js","./calcite-flow-item-B0xZ0mWX.js","./panel-BdAbXPwM.js","./action-menu-C6uYzPu-.js","./array-BMcQdnYi.js","./popover-Q5ruM4hh.js","./floating-ui-Bma_zPVt.js","./debounce-BOqmhDXu.js","./focusTrapComponent-BSUg_DLj.js","./openCloseComponent-CmOrfBN-.js","./Heading-D7P0OjYI.js","./FloatingArrow-BBdsG5MP.js","./scrim-DPa2aeKh.js","./calcite-icon-Cu0W9dtm.js","./calcite-input-DAafN6Cc.js","./input2-BReyTnf4.js","./Validation-Bz9yoU6e.js","./input-j1u1wOBY.js","./input-message-CWvsvdFk.js","./progress-BXyickl_.js","./calcite-input-message-Do0tN7uT.js","./calcite-label-B1FxWqaL.js","./calcite-list-C4jOVpC-.js","./resources4-DXHY1U7R.js","./utils3-BrU6GrkI.js","./filter-yN6-jZOU.js","./calcite-list-item-vbKS6alm.js","./handle-Ct1HP3bl.js","./calcite-loader-DP4PIFO8.js","./calcite-notice-DSp0z_Oh.js","./conditionalSlot-R5D9krYS.js","./resources2-DjkgwdyM.js","./calcite-scrim-B8_2DHG_.js","./calcite-switch-CkUGVtze.js","./switch-Drd7BD6R.js","./calcite-table-CYZeyj9Z.js","./pagination-BBsfobXC.js","./calcite-table-cell-BIW6P6yZ.js","./table-cell-DKtYbUJ5.js","./calcite-table-header-Db313LL8.js","./table-header-d8lbHigx.js","./calcite-table-row-DTn6Oqgh.js"])))=>i.map(i=>d[i]);
import{_ as c}from"./index-Bh2oEzTI.js";import{r as n}from"./tslib.es6-B3Jf3DVX.js";import{m as l,a as O,b as w,n as D,O as Q}from"./subclass-BZA_h8Db.js";import{b as G,Y as A}from"./Accessor-BLX9ikPh.js";import{s as W}from"./Identifiable-B1UbsKNt.js";import{j as V,E as P,o as q}from"./date-DlqISzcw.js";import{u as x}from"./timeProperties-BBnV2Dje.js";import{B as X,r as tt,n as r,w as T,e as H}from"./jsxFactory-CJa39Fro.js";import{m as et}from"./Viewpoint-C4FqWA2d.js";import{V as ot}from"./Collection-CEdjem1-.js";import{o as it}from"./Evented-BHRw9x22.js";import{s as rt}from"./cast-Bjksrh93.js";import{f as j}from"./Bookmark-BoJ0Z38Y.js";import{t as at}from"./GoTo-Wtu9mgoE.js";import{e as S}from"./globalCss-CZa70j6i.js";import{e as nt}from"./Heading-C-odFCu-.js";import{t as lt}from"./listUtils-vswmtyNy.js";import{e as st}from"./vmEvent-D4Ubqkbq.js";import"./jsonMap-0cxwUWs2.js";import"./locale-C9TlLpzi.js";import"./assets-C43MgM-v.js";import"./TimeExtent-DocT5yPf.js";import"./timeUtils-8fb_2oAt.js";import"./writer-DNAwXnhG.js";import"./intl-CChhNOV8.js";import"./messages-OmQvZhAg.js";import"./Promise-B2Hu02L7.js";import"./reactiveUtils-C5zUhJQJ.js";import"./asyncUtils-CWX51uTe.js";import"./shared-B3wH2qpO.js";import"./SimpleObservable-KocWTzVy.js";import"./uuid-fwrPAdZb.js";import"./Clonable-D3rtuBWg.js";import"./Cyclical-oTUX3aX7.js";import"./mathUtils-C4_ghTv4.js";import"./Point-Cg0-ChZE.js";import"./geometry-D964gYQX.js";import"./Extent-Bf3YTe7m.js";import"./Polyline-D9YkgmM_.js";import"./jsonUtils-CEfjT-BK.js";let g=class extends G{constructor(e){super(e)}get editedBookmark(){const{bookmark:e}=this;return e?this._get("editedBookmark")||e.clone():null}get customUrl(){var e,o;return(o=(e=this.editedBookmark)==null?void 0:e.thumbnail)!=null&&o.isSecureUrl?this.editedBookmark.thumbnail.url:null}set customUrl(e){this._override("customUrl",e)}get screenshotUrl(){var e,o;return(o=(e=this.editedBookmark)==null?void 0:e.thumbnail)!=null&&o.isDataURI?this.editedBookmark.thumbnail.url:null}set screenshotUrl(e){this._override("screenshotUrl",e)}get state(){return this._get("state")}set state(e){this.validationState=void 0,this.loading=void 0,this._set("state",e)}get thumbnailState(){var e,o,i,a;return(o=(e=this.editedBookmark)==null?void 0:e.thumbnail)!=null&&o.url?(a=(i=this.editedBookmark)==null?void 0:i.thumbnail)!=null&&a.isSecureUrl?"url":"screenshot":"none"}set thumbnailState(e){this._overrideIfSome("thumbnailState",e)}};n([l()],g.prototype,"bookmark",void 0),n([l({readOnly:!0})],g.prototype,"editedBookmark",null),n([l()],g.prototype,"customUrl",null),n([l()],g.prototype,"screenshotUrl",null),n([l()],g.prototype,"state",null),n([l()],g.prototype,"thumbnailState",null),n([l()],g.prototype,"validationState",void 0),n([l()],g.prototype,"loading",void 0),g=n([O("esri.widgets.Bookmarks.BookmarksUserState")],g);const R=g,z=ot.ofType(j),dt={width:128,height:128,format:"png"},C={takeScreenshot:!0,captureViewpoint:!0,captureRotation:!0,captureScale:!0,captureTimeExtent:!0},Z={time:!0};let v=class extends at(it.EventedAccessor){constructor(t){super(t),this.capabilities={...Z},this.activeBookmark=null,this.view=null}destroy(){this.view=null,this._set("activeBookmark",null)}castCapabilities(t){return{...Z,...t}}get bookmarks(){var t,e;return((e=(t=this.view)==null?void 0:t.map)==null?void 0:e.bookmarks)??new z}set bookmarks(t){this._overrideIfSome("bookmarks",t)}set defaultCreateOptions(t){this._set("defaultCreateOptions",{...C,...t})}get defaultCreateOptions(){return C}set defaultEditOptions(t){this._set("defaultEditOptions",{...C,...t})}get defaultEditOptions(){return C}get state(){const{view:t}=this;return t&&!t.ready?"loading":"ready"}async createBookmark(t){const{view:e,defaultCreateOptions:o,capabilities:i}=this;if(!e)throw new w("create-bookmark:invalid-view","Cannot create a bookmark without a view.");const{takeScreenshot:a,screenshotSettings:s,captureViewpoint:d,captureRotation:u,captureScale:_,captureTimeExtent:B}={...o,...t},h=a?await this._createThumbnail(s):void 0,E=i.time&&B&&e.timeExtent!=null?e.timeExtent.clone():void 0;return new j({...h&&{thumbnail:h},...B&&{timeExtent:E},...d&&{viewpoint:this._createViewpoint({view:e,captureScale:_,captureRotation:u})}})}async editBookmark(t,e){if(!t)return t;const{view:o,defaultEditOptions:i}=this;if(!o)throw new w("edit-bookmark:invalid-view","Cannot edit a bookmark without a view.");const{takeScreenshot:a,screenshotSettings:s,captureViewpoint:d,captureRotation:u,captureScale:_,captureTimeExtent:B}={...i,...e},h=a?await this._createThumbnail(s):void 0;return h&&(t.thumbnail=h),d&&(t.viewpoint=this._createViewpoint({view:o,captureScale:_,captureRotation:u})),B&&o.timeExtent!=null&&(t.timeExtent=o.timeExtent.clone()),this.emit("bookmark-edit",{bookmark:t}),t}goTo(t){const{capabilities:e,view:o}=this;if(!o)throw new w("go-to:invalid-view","Cannot go to a bookmark without a view");const i=t==null?void 0:t.viewpoint;if(!i)throw new w("go-to:invalid-bookmark","Cannot go to a bookmark that does not contain a 'viewpoint'.",{bookmark:t});this._set("activeBookmark",t);const a={target:i},s=this.callGoTo(a),d=t==null?void 0:t.timeExtent;return e.time&&d&&(o.timeExtent=d),this.emit("bookmark-select",{bookmark:t}),s.catch(()=>{}).then(()=>this._set("activeBookmark",null)),s}async _createThumbnail(t){const{view:e}=this;if(!e)throw new w("bookmark:invalid-view","Cannot create slide thumbnail without a view");const o=await e.takeScreenshot({...dt,...t});return new x({url:o.dataUrl})}_createViewpoint({view:t,captureRotation:e,captureScale:o}){var a,s;const i=(a=t.viewpoint)==null?void 0:a.clone();return new et({targetGeometry:(s=t.extent)==null?void 0:s.clone(),rotation:(e?i==null?void 0:i.rotation:null)??0,scale:(o?i==null?void 0:i.scale:null)??0})}};n([l()],v.prototype,"capabilities",void 0),n([rt("capabilities")],v.prototype,"castCapabilities",null),n([l({readOnly:!0})],v.prototype,"activeBookmark",void 0),n([l({type:z})],v.prototype,"bookmarks",null),n([l()],v.prototype,"defaultCreateOptions",null),n([l()],v.prototype,"defaultEditOptions",null),n([l({readOnly:!0})],v.prototype,"state",null),n([l()],v.prototype,"view",void 0),v=n([O("esri.widgets.Bookmarks.BookmarksViewModel")],v);const Y=v;let b=class extends G{constructor(){super(...arguments),this.addBookmarkButton=!1,this.closeButton=!1,this.collapseButton=!1,this.editBookmarkButton=!1,this.filter=!1,this.flow=!0,this.heading=!1,this.thumbnail=!0,this.time=!0}get addBookmark(){return A(D.getLogger(this),"addBookmark",{replacement:"addBookmarkButton",version:"4.29",warnOnce:!0}),this.addBookmarkButton}set addBookmark(e){A(D.getLogger(this),"addBookmark",{replacement:"addBookmarkButton",version:"4.29",warnOnce:!0}),this.addBookmarkButton=e}};n([l({type:Boolean,nonNullable:!0})],b.prototype,"addBookmark",null),n([l({type:Boolean,nonNullable:!0})],b.prototype,"addBookmarkButton",void 0),n([l({type:Boolean,nonNullable:!0})],b.prototype,"closeButton",void 0),n([l({type:Boolean,nonNullable:!0})],b.prototype,"collapseButton",void 0),n([l({type:Boolean,nonNullable:!0})],b.prototype,"editBookmarkButton",void 0),n([l({type:Boolean,nonNullable:!0})],b.prototype,"filter",void 0),n([l({type:Boolean,nonNullable:!0})],b.prototype,"flow",void 0),n([l({type:Boolean,nonNullable:!0})],b.prototype,"heading",void 0),n([l({type:Boolean,nonNullable:!0})],b.prototype,"thumbnail",void 0),n([l({type:Boolean,nonNullable:!0})],b.prototype,"time",void 0),b=n([O("esri.widgets.Bookmarks.BookmarksVisibleElements")],b);const N=b,p="esri-bookmarks",U=`${p}__authoring`,L=`${p}__bookmark`,k={base:p,noBookmarksHeader:`${p}__no-bookmarks-heading`,noBookmarksDescription:`${p}__no-bookmarks-description`,form:`${p}__form`,list:`${p}__list`,loader:`${p}__loader`,filterNoResults:`${p}__filter-no-results`,formContent:`${p}__form-content`,addBookmarkButton:`${p}__add-bookmark-button`,editBookmarkInput:`${p}__edit-bookmark-input`,addBookmarkInput:`${p}__add-bookmark-input`,dragEnabled:`${p}--drag-enabled`,bookmarkImage:`${p}__image`,bookmarkImageContainer:`${L}-image-container`,bookmarkContent:`${L}-content`,bookmarkContentLabel:`${L}-content-label`,authoring:U,authoringImageContainer:`${U}-image-container`,authoringRefreshThumbnailButton:`${U}-refresh-thumbnail-button`};let m=class extends W(X){constructor(t,e){super(t,e),this._addInputNode=null,this._editInputNode=null,this._urlEditInputNode=null,this._lastDragDetail=null,this._selectedDragBookmarkUid=null,this._editIncludeTimeExtent=void 0,this._userState=null,this._focusRootFlowItem=!1,this._focusAddFlowItem=!1,this._focusEditFlowItem=!1,this.disabled=!1,this.dragEnabled=!1,this.filterPlaceholder="",this.filterText="",this.headingLevel=2,this.messages=null,this.messagesCommon=null,this.viewModel=new Y,this.visibleElements=new N,this._onCalciteListOrderChange=o=>{const{_lastDragDetail:i,bookmarks:a}=this,{toEl:s,fromEl:d,dragEl:u,newIndex:_}=o;if(!a.length||!d||!s||(i==null?void 0:i.newIndex)===_&&(i==null?void 0:i.dragEl)===u&&(i==null?void 0:i.toEl)===s&&(i==null?void 0:i.fromEl)===d)return;this._lastDragDetail=o;const B=Array.from(d.children).filter(h=>h==null?void 0:h.matches("calcite-list-item")).map(h=>h.value);a.sort((h,E)=>{const I=B.indexOf(h.uid),y=B.indexOf(E.uid);return I>y?1:I<y?-1:0})}}normalizeCtorArgs(t){return(t==null?void 0:t.editingEnabled)!=null&&t.visibleElements!=null?{...t,visibleElements:new N({...t.visibleElements,addBookmarkButton:t.editingEnabled,editBookmarkButton:t.editingEnabled})}:t}loadDependencies(){return tt({action:()=>c(()=>import("./calcite-action-Bys6x4p_.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32]),import.meta.url),button:()=>c(()=>import("./calcite-button-D_Agetwz.js"),__vite__mapDeps([33,34,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,35,23,24,36,29,25,26,27,28,30,31,32]),import.meta.url),"chip-group":()=>c(()=>import("./calcite-chip-group-BedxdOvW.js"),__vite__mapDeps([37,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25]),import.meta.url),chip:()=>c(()=>import("./calcite-chip-C9GKwE1v.js"),__vite__mapDeps([38,39,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,25,30,26,27,28,24,29,31]),import.meta.url),fab:()=>c(()=>import("./calcite-fab-CKoU_mWy.js"),__vite__mapDeps([40,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,34,35,36,29,26,27,28,30,31,32]),import.meta.url),flow:()=>c(()=>import("./calcite-flow-BrE9BG4l.js"),__vite__mapDeps([41,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,28,25]),import.meta.url),"flow-item":()=>c(()=>import("./calcite-flow-item-B0xZ0mWX.js"),__vite__mapDeps([42,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,30,43,44,45,1,29,31,32,46,47,48,49,50,51,52,53]),import.meta.url),icon:()=>c(()=>import("./calcite-icon-Cu0W9dtm.js"),__vite__mapDeps([54,31,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,28]),import.meta.url),input:()=>c(()=>import("./calcite-input-DAafN6Cc.js"),__vite__mapDeps([55,56,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,35,24,27,36,29,25,26,28,30,57,58,31,59,60]),import.meta.url),"input-message":()=>c(()=>import("./calcite-input-message-Do0tN7uT.js"),__vite__mapDeps([61,59,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,31,28]),import.meta.url),label:()=>c(()=>import("./calcite-label-B1FxWqaL.js"),__vite__mapDeps([62,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,36,23,29]),import.meta.url),list:()=>c(()=>import("./calcite-list-C4jOVpC-.js"),__vite__mapDeps([63,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,28,64,65,25,30,26,27,66,48,31,56,35,36,29,57,58,59,60,32,53]),import.meta.url),"list-item":()=>c(()=>import("./calcite-list-item-vbKS6alm.js"),__vite__mapDeps([67,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,26,27,28,30,25,65,64,1,29,31,32,68]),import.meta.url),loader:()=>c(()=>import("./calcite-loader-DP4PIFO8.js"),__vite__mapDeps([69,32,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,26,27,28]),import.meta.url),notice:()=>c(()=>import("./calcite-notice-DSp0z_Oh.js"),__vite__mapDeps([70,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,71,28,23,25,26,27,30,72,50,29,31]),import.meta.url),scrim:()=>c(()=>import("./calcite-scrim-B8_2DHG_.js"),__vite__mapDeps([73,53,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,26,23,27,28,30,32]),import.meta.url),switch:()=>c(()=>import("./calcite-switch-CkUGVtze.js"),__vite__mapDeps([74,75,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,35,24,27,36,29,25]),import.meta.url),table:()=>c(()=>import("./calcite-table-CYZeyj9Z.js"),__vite__mapDeps([76,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,25,30,26,23,27,28,34,35,24,36,29,31,32,39,77]),import.meta.url),"table-cell":()=>c(()=>import("./calcite-table-cell-BIW6P6yZ.js"),__vite__mapDeps([78,79,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,25,30,26,23,27,28,24]),import.meta.url),"table-header":()=>c(()=>import("./calcite-table-header-Db313LL8.js"),__vite__mapDeps([80,81,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,25,30,26,23,27,28,29,31]),import.meta.url),"table-row":()=>c(()=>import("./calcite-table-row-DTn6Oqgh.js"),__vite__mapDeps([82,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,27,24,29,31,28,79,25,30,26,81]),import.meta.url)})}get defaultCreateOptions(){return this.viewModel.defaultCreateOptions}set defaultCreateOptions(t){this.viewModel.defaultCreateOptions=t}get defaultEditOptions(){return this.viewModel.defaultEditOptions}set defaultEditOptions(t){this.viewModel.defaultEditOptions=t}get bookmarks(){return this.viewModel.bookmarks}set bookmarks(t){this.viewModel.bookmarks=t}get editingEnabled(){return A(D.getLogger(this),"editingEnabled",{replacement:"dragEnabled, visibleElements.editBookmarkButton, visibleElements.addBookmarkButton",version:"4.29",warnOnce:!0}),this.dragEnabled&&this.visibleElements.editBookmarkButton&&this.visibleElements.addBookmarkButton}set editingEnabled(t){A(D.getLogger(this),"editingEnabled",{replacement:"dragEnabled, visibleElements.editBookmarkButton, visibleElements.addBookmarkButton",version:"4.29",warnOnce:!0}),this.dragEnabled=t,this.visibleElements.editBookmarkButton=t,this.visibleElements.addBookmarkButton=t}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(t){this.viewModel.goToOverride=t}get icon(){return"bookmark"}set icon(t){this._overrideIfSome("icon",t)}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}endAddBookmark(){this._userState=null}goTo(t){return this.viewModel.goTo(t)}render(){return r("div",{class:this.classes(k.base,S.widget,S.panel)},this._renderBookmarksContainer())}startAddBookmark(){this._userState=new R({state:"add"}),this._focusAddFlowItem=!0}_renderNoBookmarksContainer(t){const{messages:e,viewModel:{state:o}}=this;return t.length||o==="loading"?null:r("div",{class:S.empty,key:"no-bookmarks"},r("calcite-icon",{icon:"bookmark",scale:"l"}),r(nt,{class:this.classes(S.heading,k.noBookmarksHeader),level:this.headingLevel},e==null?void 0:e.noBookmarksHeading),r("p",{class:k.noBookmarksDescription},e.noBookmarksDescription))}_renderEditBookmarkFlowItems(){const{_userState:t}=this,e=t==null?void 0:t.editedBookmark;return e&&(t==null?void 0:t.state)==="edit"?this._renderEditingBookmark(e):[]}_renderBookmarkItems(t){return t?t.toArray().map(e=>this._renderBookmark(e)):[]}_handleCalciteListDragEnd(t){const{fromEl:e,dragEl:o,oldIndex:i}=t;e.insertBefore(o,e.children[i])}_renderBookmarksContainer(){const{viewModel:{state:t,bookmarks:e},dragEnabled:o,messages:i,disabled:a,filterPlaceholder:s,filterText:d,visible:u,headingLevel:_,visibleElements:{closeButton:B,collapseButton:h,filter:E,heading:I,flow:y},uid:J}=this,$=e.filter(Q),K=$.length?r("calcite-list",{class:k.list,dragEnabled:o,filterEnabled:E,filterPlaceholder:s,filterProps:lt,filterText:d,group:`bookmarks-${J}`,key:"bookmark-list",label:i.widgetLabel,selectionAppearance:"border",selectionMode:"none",onCalciteListDragEnd:f=>this._handleCalciteListDragEnd(f.detail),onCalciteListFilter:f=>{var M;return this.filterText=((M=f.target)==null?void 0:M.filterText)??""},onCalciteListOrderChange:f=>this._onCalciteListOrderChange(f.detail)},this._renderBookmarkItems($),E?r("div",{class:k.filterNoResults,slot:"filter-no-results"},r("calcite-notice",{kind:"info",open:!0,width:"full"},r("div",{slot:"message"},i.noBookmarksHeading),";")):null):null,F=[r("calcite-flow-item",{afterCreate:this._focusRootFlowItemNode,afterUpdate:this._focusRootFlowItemNode,bind:this,closable:B,closed:!u,collapsible:h,disabled:a,heading:I?i.widgetLabel:void 0,headingLevel:_,loading:t==="loading",onCalciteFlowItemClose:()=>this.visible=!1},this._renderNoBookmarksContainer($),K,this._renderAddBookmarkButton()),this._renderAddingBookmark(),this._renderEditBookmarkFlowItems()];return u?y?r("calcite-flow",{key:"root-flow"},F):F:null}_renderAddBookmarkButton(){const{messages:t,_userState:e,disabled:o,viewModel:{view:i,state:a},visibleElements:{addBookmarkButton:s}}=this,d=(e==null?void 0:e.loading)??!1;return i&&a!=="loading"&&s?r("calcite-fab",{appearance:"outline-fill",bind:this,class:k.addBookmarkButton,disabled:o||d,icon:"plus",key:"add-bookmark-item",kind:"neutral",loading:d,onclick:this.startAddBookmark,slot:"fab",text:t.addBookmark,textEnabled:!0,title:t.addBookmark,type:"button"}):null}_renderEditContainer(t){const{messagesCommon:e,visibleElements:{editBookmarkButton:o}}=this,i=`${e.edit} ${this._getBookmarkTitle(t)}`;return o?r("calcite-action",{appearance:"transparent",icon:"pencil",key:"edit-action",onclick:()=>this._showEditBookmarkForm(t),slot:"actions-end",text:i,title:i}):null}_renderBookmarkImage(t,e){var o;return e?r("img",{alt:"",class:k.bookmarkImage,key:"bookmark-image",src:(o=t.thumbnail)==null?void 0:o.url}):null}_renderBookmarkTimeSwitch(t){const{messages:e,viewModel:{view:o}}=this,{timeExtent:i}=t;return(o==null?void 0:o.timeExtent)??i?r("calcite-label",{layout:"inline-space-between"},e.includeTimeExtent,r("calcite-switch",{checked:!!i,onCalciteSwitchChange:a=>{this._editIncludeTimeExtent=!!a.target.checked}})):null}_renderEditBookmarkTimeExtent(t){return this._editIncludeTimeExtent?this._renderBookmarkTimeExtent(t):null}_getTimeExtentStrings(t){const{visibleElements:e}=this,{timeExtent:o}=t;if(!o)return{};const{start:i,end:a}=o,s=a!=null&&(i==null||i.getTime()!==a.getTime()),d=i?this._formatDate(i):"",u=i&&e.time?this._formatTime(i):"";return s?{startDate:d,startTime:u,endDate:this._formatDate(a),endTime:e.time?this._formatTime(a):""}:{startDate:d,startTime:u}}_renderTimeExtentDescription(t){const{startDate:e,startTime:o,endDate:i,endTime:a}=this._getTimeExtentStrings(t);if(!e)return"";const s=`${e} ${o}`;return i?`${s} - ${`${i} ${a}`}`:s}_renderBookmarkTimeExtent(t,e=!1){const{messages:o}=this,{startDate:i,startTime:a,endDate:s,endTime:d}=this._getTimeExtentStrings(t),u=e?null:r("calcite-table-row",{slot:"table-header"},r("calcite-table-header",{heading:o.startDate}),s?r("calcite-table-header",{heading:o.endDate}):null);return i?r("calcite-table",{caption:o.timeExtent,scale:"s"},u,r("calcite-table-row",null,r("calcite-table-cell",null,i," ",a?[r("br",null),a]:null),s?r("calcite-table-cell",null,s,d?[r("br",null),d]:null):null)):null}_renderBookmarkActiveScrim(t,e){return this.viewModel.activeBookmark===t&&e?r("calcite-scrim",{key:"bookmark-active-scrim",loading:!0}):null}_renderBookmarkActiveLoader(t,e){return this.viewModel.activeBookmark!==t||e?null:r("calcite-loader",{class:k.loader,inline:!0,key:"bookmark-active-loader",label:this.messagesCommon.loading})}_renderBookmarkImageIcon(t,e){return this.viewModel.activeBookmark===t||e?null:r("calcite-icon",{icon:"bookmark",key:"bookmark-icon",scale:"s"})}_renderBookmarkThumbnail(t){var o;const e=this.visibleElements.thumbnail&&!!((o=t.thumbnail)!=null&&o.url);return r("div",{class:k.bookmarkImageContainer,slot:"content-start"},this._renderBookmarkActiveScrim(t,e),this._renderBookmarkImage(t,e),this._renderBookmarkActiveLoader(t,e),this._renderBookmarkImageIcon(t,e))}_focusSelectedDragEl(t,e){this._selectedDragBookmarkUid===e.uid&&T(t)}_handleCalciteListItemDragHandleChange(t,e){t.stopPropagation();const o=t.target.dragSelected;this._selectedDragBookmarkUid=o?e.uid:null}_renderBookmark(t){return r("calcite-list-item",{afterCreate:e=>this._focusSelectedDragEl(e,t),afterUpdate:e=>this._focusSelectedDragEl(e,t),class:this.classes({[k.dragEnabled]:this.dragEnabled}),description:this._renderTimeExtentDescription(t),dragSelected:t.uid===this._selectedDragBookmarkUid,key:t.uid,label:this._getBookmarkTitle(t),value:t.uid,onCalciteListItemDragHandleChange:e=>this._handleCalciteListItemDragHandleChange(e,t),onCalciteListItemSelect:()=>this._goToBookmark(t)},this._renderBookmarkThumbnail(t),this._renderBookmarkContent(t),this._renderEditContainer(t))}_renderBookmarkContent(t){return r("div",{class:k.bookmarkContent,slot:"content"},r("span",{class:k.bookmarkContentLabel},this._getBookmarkTitle(t)),this._renderBookmarkTimeExtent(t,!0))}_renderEditingBookmarkName(t){const{messages:e,_userState:o}=this,i=(o==null?void 0:o.validationState)==="name-required";return r("calcite-label",null,e.title,r("calcite-input",{afterCreate:this._storeEditInput,bind:this,class:k.editBookmarkInput,name:"bookmark-name",placeholder:e.titlePlaceholder,required:!0,type:"text",value:t.name}),i?r("calcite-input-message",{icon:"exclamation-mark-triangle",status:"invalid"},e.invalidTitle):null)}_renderEditingBookmarkActions(){const{messagesCommon:t,_userState:e}=this,o=e==null?void 0:e.bookmark;return[r("calcite-button",{appearance:"transparent",kind:"danger",onclick:()=>this._deleteBookmark(o),slot:"footer",type:"button",width:"full"},t.delete),r("calcite-button",{appearance:"outline",bind:this,onclick:this._closeEditBookmarkForm,slot:"footer",type:"button",width:"full"},t.cancel),r("calcite-button",{slot:"footer",type:"submit",width:"full"},t.save)]}_handleUrlEditInputChange(){var a,s;const{_userState:t,_urlEditInputNode:e}=this,o=e==null?void 0:e.value;if(!(t!=null&&t.editedBookmark)||!o)return;t.validationState=void 0,(a=t.editedBookmark.thumbnail)!=null&&a.isDataURI&&(t.screenshotUrl=(s=t.editedBookmark.thumbnail)==null?void 0:s.url);const i=new x({url:o});i.isSecureUrl&&(t.customUrl=o,t.editedBookmark.thumbnail=i)}_renderEditingTimeExtent(t){const{capabilities:e,view:o}=this.viewModel,{timeExtent:i}=t;return e.time&&((o==null?void 0:o.timeExtent)??i)?r("div",{key:"edit-bookmark-time-container"},this._renderBookmarkTimeSwitch(t),this._renderEditBookmarkTimeExtent(t)):null}_renderEditingBookmarkImage(t){var a,s;const{_userState:e}=this,o=e==null?void 0:e.thumbnailState,i=(a=t.thumbnail)!=null&&a.isSecureUrl?o==="url":(s=t.thumbnail)!=null&&s.isDataURI?o==="screenshot":null;if(i)return this._renderBookmarkImage(t,i)}_renderEditingThumbnail(t){const{_userState:e,visibleElements:o}=this,i=e==null?void 0:e.thumbnailState;return o.thumbnail&&i!=="none"?r("div",{class:k.authoringImageContainer},this._renderEditingBookmarkImage(t)):null}_renderUpdateThumbnailButton(){const{visibleElements:t,messages:e,_userState:o}=this,i=o==null?void 0:o.thumbnailState;return t.thumbnail&&i==="screenshot"?r("calcite-button",{appearance:"outline",class:k.authoringRefreshThumbnailButton,iconStart:"refresh",key:"update-thumbnail",kind:"neutral",onclick:()=>{this._updateThumbnail()},width:"half"},e.updateThumbnail):null}_renderEditingBookmarkUrlInput(t){var u,_;const{messages:e,_userState:o}=this,i=(u=t.thumbnail)==null?void 0:u.url,a=(_=t.thumbnail)!=null&&_.isSecureUrl?i:void 0,s=i&&(o==null?void 0:o.validationState)==="absolute-url-required";return(o==null?void 0:o.thumbnailState)==="url"?r("calcite-label",{key:"thumbnail-url-input"},r("calcite-input",{afterCreate:this._storeUrlEditInput,bind:this,name:"bookmark-thumbnail-url",pattern:"https://.*",placeholder:e?`https://<${e.imageUrlPlaceholder}>`:void 0,required:!0,title:e.imageUrlTooltip,type:"text",value:a,onCalciteInputChange:this._handleUrlEditInputChange,onCalciteInputInput:this._handleUrlEditInputChange}),s?r("calcite-input-message",{icon:"exclamation-mark-triangle",status:"invalid"},e.invalidImageUrl):null):null}_renderThumbnailSelector(){const{visibleElements:t,messages:e,_userState:o}=this,i=o==null?void 0:o.thumbnailState;return t.thumbnail?r("calcite-label",{key:"thumbnail-chip-group"},e.thumbnail,r("calcite-chip-group",{label:e.thumbnail,selectionMode:"single-persist",onCalciteChipGroupSelect:a=>this._handleThumbnailTypeSelect(a.target.selectedItems[0].value)},r("calcite-chip",{selected:i==="screenshot",value:"screenshot"},e.screenshot),r("calcite-chip",{selected:i==="url",value:"url"},e.url),r("calcite-chip",{selected:i==="none",value:"none"},e.none))):null}_renderEditingBookmark(t){const{disabled:e,messagesCommon:o,headingLevel:i}=this;return t?r("form",{bind:this,class:k.form,disabled:this.disabled,onsubmit:this._editBookmarkSubmit},r("calcite-flow-item",{afterCreate:this._focusEditFlowItemNode,afterUpdate:this._focusEditFlowItemNode,bind:this,disabled:e,heading:o.edit,headingLevel:i,key:"edit-bookmark-form",onCalciteFlowItemBack:a=>{a.preventDefault(),this._closeEditBookmarkForm()}},r("div",{class:k.formContent},r("div",{class:k.authoring},this._renderEditingBookmarkName(t),this._renderThumbnailSelector(),this._renderEditingThumbnail(t),this._renderEditingBookmarkUrlInput(t),this._renderUpdateThumbnailButton(),this._renderEditingTimeExtent(t))),this._renderEditingBookmarkActions())):null}_renderAddingBookmarkName(){const{_userState:t,messages:e}=this,o=(t==null?void 0:t.validationState)==="name-required";return r("calcite-label",null,e.title,r("calcite-input",{afterCreate:this._storeAddInput,bind:this,class:k.addBookmarkInput,name:"bookmark-name",placeholder:e.titlePlaceholder,required:!0,type:"text",value:""}),o?r("calcite-input-message",{icon:"exclamation-mark-triangle",status:"invalid"},e.invalidTitle):null)}_renderAddingBookmarkActions(){const{messagesCommon:t}=this;return[r("calcite-button",{appearance:"outline",bind:this,onclick:this._endAddBookmark,slot:"footer",type:"button",width:"half"},t.cancel),r("calcite-button",{slot:"footer",type:"submit",width:"half"},t.add)]}_renderAddingBookmark(){const{disabled:t,messages:e,headingLevel:o,_userState:i}=this;return(i==null?void 0:i.state)==="add"?r("form",{bind:this,class:k.form,disabled:t,onsubmit:this._addBookmarkSubmitClick},r("calcite-flow-item",{afterCreate:this._focusAddFlowItemNode,afterUpdate:this._focusAddFlowItemNode,bind:this,disabled:t,heading:e.addBookmark,headingLevel:o,key:"add-bookmark-form",onCalciteFlowItemBack:a=>{a.preventDefault(),this._endAddBookmark()}},r("div",{class:k.formContent},this._renderAddingBookmarkName()),this._renderAddingBookmarkActions())):null}_getBookmarkTitle(t){return(t==null?void 0:t.name)||this.messagesCommon.untitled}_formatDate(t){var e;return t?V(t,{...P("short-date"),timeZone:((e=this.viewModel.view)==null?void 0:e.timeZone)??q}):""}_formatTime(t){var e;return t?V(t,{...P("long-time"),timeZone:((e=this.viewModel.view)==null?void 0:e.timeZone)??q}):""}_endAddBookmark(){this.endAddBookmark(),this._focusRootFlowItem=!0}_showEditBookmarkForm(t){t&&(this._editIncludeTimeExtent=!!t.timeExtent,this._userState=new R({bookmark:t,state:"edit"}),this._focusEditFlowItem=!0,this.viewModel.goTo(t))}async _createNewScreenshotUrl(){var e;return((e=(await this.viewModel.createBookmark()).thumbnail)==null?void 0:e.url)??null}_storeCurrentUrl(){var o,i,a,s,d,u;const{_userState:t}=this,e=(i=(o=t==null?void 0:t.editedBookmark)==null?void 0:o.thumbnail)==null?void 0:i.url;e&&((s=(a=t==null?void 0:t.editedBookmark)==null?void 0:a.thumbnail)!=null&&s.isSecureUrl?t.customUrl=e:(u=(d=t==null?void 0:t.editedBookmark)==null?void 0:d.thumbnail)!=null&&u.isDataURI&&(t.screenshotUrl=e))}async _handleThumbnailTypeSelect(t){const{_userState:e}=this;if(!e)return;const{screenshotUrl:o,customUrl:i,editedBookmark:a}=e,s=t==="screenshot"?o??await this._createNewScreenshotUrl():t==="url"&&i?i:null;this._storeCurrentUrl(),a&&s&&(a.thumbnail=new x({url:s})),e.validationState=void 0,e.thumbnailState=t}_closeEditBookmarkForm(){this._userState=null,this._focusRootFlowItem=!0}_addBookmarkSubmitClick(t){t.preventDefault(),this._addBookmarkSubmit()}async _addBookmarkSubmit(){const{_addInputNode:t,_userState:e,viewModel:o,viewModel:{bookmarks:i}}=this;if(!e)return;const a=t?t.value.trim():null;if(!a)return void(e.validationState="name-required");e.loading=!0;const s=await o.createBookmark();s.name=a,i.add(s),this._endAddBookmark()}async _editBookmarkAndClose(t,e){const{viewModel:o,viewModel:{defaultEditOptions:i}}=this;await o.editBookmark(t,{...i,...e}),this._closeEditBookmarkForm()}_editBookmarkSubmit(t){t.preventDefault();const{_editInputNode:e,_userState:o,_editIncludeTimeExtent:i,_urlEditInputNode:a}=this;if(!(o!=null&&o.bookmark)||!o.editedBookmark)return;o.validationState=void 0,o.customUrl=void 0,o.screenshotUrl=void 0;const s=e==null?void 0:e.value.trim();if(!s)return void(o.validationState="name-required");o.bookmark.name=s,o.bookmark.thumbnail=o.editedBookmark.thumbnail,i||(o.bookmark.timeExtent=null);const d=o.thumbnailState;if(d==="url"&&a){const u=a.value,_=new x({url:u});if(!_.isSecureUrl)return void(o.validationState="absolute-url-required");o.bookmark.thumbnail=_}else d==="none"&&(o.bookmark.thumbnail=null);this._editBookmarkAndClose(o.bookmark,{takeScreenshot:!1,captureTimeExtent:i})}_storeEditInput(t){this._editInputNode=t}_storeAddInput(t){this._addInputNode=t}_storeUrlEditInput(t){this._urlEditInputNode=t}_deleteBookmark(t){this._closeEditBookmarkForm(),t&&(this.viewModel.bookmarks.remove(t),t.destroy())}_goToBookmark(t){this.endAddBookmark(),this.viewModel.goTo(t)}async _updateThumbnail(){const{_userState:t,viewModel:e}=this;t&&(t.validationState=void 0,await e.editBookmark(t.editedBookmark,{takeScreenshot:!0,captureViewpoint:!1,captureRotation:!1,captureScale:!1,captureTimeExtent:!1}))}_focusRootFlowItemNode(t){this._focusRootFlowItem&&(this._focusRootFlowItem=!1,T(t))}_focusEditFlowItemNode(t){this._focusEditFlowItem&&(this._focusEditFlowItem=!1,T(t))}_focusAddFlowItemNode(t){this._focusAddFlowItem&&(this._focusAddFlowItem=!1,T(t))}};n([l()],m.prototype,"_editIncludeTimeExtent",void 0),n([l({type:R})],m.prototype,"_userState",void 0),n([l()],m.prototype,"_focusRootFlowItem",void 0),n([l()],m.prototype,"_focusAddFlowItem",void 0),n([l()],m.prototype,"_focusEditFlowItem",void 0),n([l()],m.prototype,"defaultCreateOptions",null),n([l()],m.prototype,"defaultEditOptions",null),n([l()],m.prototype,"bookmarks",null),n([l()],m.prototype,"disabled",void 0),n([l()],m.prototype,"dragEnabled",void 0),n([l()],m.prototype,"editingEnabled",null),n([l()],m.prototype,"filterPlaceholder",void 0),n([l()],m.prototype,"filterText",void 0),n([l()],m.prototype,"headingLevel",void 0),n([l()],m.prototype,"goToOverride",null),n([l()],m.prototype,"icon",null),n([l()],m.prototype,"label",null),n([l(),H("esri/widgets/Bookmarks/t9n/Bookmarks")],m.prototype,"messages",void 0),n([l(),H("esri/t9n/common")],m.prototype,"messagesCommon",void 0),n([l()],m.prototype,"uiStrings",void 0),n([l()],m.prototype,"view",null),n([l({type:Y}),st(["select-bookmark","bookmark-edit","bookmark-select"])],m.prototype,"viewModel",void 0),n([l({type:N,nonNullable:!0})],m.prototype,"visibleElements",void 0),n([l()],m.prototype,"endAddBookmark",null),n([l()],m.prototype,"startAddBookmark",null),m=n([O("esri.widgets.Bookmarks")],m);const Wt=m;export{Wt as default};
