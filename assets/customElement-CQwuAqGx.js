import{i as M,L as P,u as j,c as O,n as D,x as c,s as r,b as u,d as f,e as w,a as E}from"./index-tefRSezt.js";import{j as S,d as I}from"./basemapUtils-DQr5T1wn.js";import{r as s,m as n,a as A,g as N}from"./Accessor-BHnuXKD2.js";import{d as q,P as z,w as K}from"./reactiveUtils-BR0C1Kq4.js";import{a as U}from"./cast-BA_-jlhc.js";import{k as V,L as F,K as G}from"./projection-B2I9Bzj_.js";import{c as R}from"./Point-XGrwlf63.js";import{m as y,l as H}from"./basemapEnsureType-BVU7UGJp.js";import{s as J}from"./useT9n-B0I3cNlQ.js";import{u as Q}from"./useViewModel-BxErfUSG.js";import{e as k}from"./globalCss-CyPh17x2.js";import"./utils-DYurMneM.js";import"./colorUtils-Rxh2V3ai.js";import"./screenUtils-_ZIvrt5o.js";import"./mat4f32-DcsiF_Rp.js";import"./mat4-Fi6iAz29.js";import"./vec3f64-BLpZdpfb.js";import"./common-DQOJ18NT.js";import"./basemapDefinitions-BmB40s1J.js";import"./intl-Do3GEEJ7.js";import"./Promise-CmQqe-ke.js";import"./Evented-DCWccWGU.js";import"./SimpleObservable-7oieNGD8.js";import"./JSONSupport-CGdeqxpk.js";import"./Extent-CBBGeHb-.js";import"./Polyline-BmuD2-ZN.js";import"./writer-B2bQV2uU.js";import"./mathUtils-DV9iOXpW.js";import"./projectBuffer-DOU0xvVi.js";import"./geodesicConstants-yASAK_zX.js";import"./Basemap-BHdJ6wQH.js";import"./collectionUtils-CbaToa73.js";import"./Portal-CTRRujjZ.js";import"./loadAll-Do8S8AWH.js";import"./PortalItem-CXk7DqVv.js";import"./writeUtils-C3ZSK02Z.js";import"./layerUtils-dJgsXxkC.js";import"./index-BkKcLxWB.js";import"./component-utils-DWY0IMHC.js";function W(e){return S(e)}let i=class extends N{constructor(e){super(e),this._basemapCache={},this._loadingProjectionEngine=!1,this.nextBasemap=y("hybrid",this._basemapCache),this.view=null}initialize(){q(()=>this.nextBasemap,e=>{e&&!e.loaded&&e.load().catch(()=>{})},z)}destroy(){this.view=null,H(this._basemapCache),this._basemapCache=null}get _nextBasemapSpatialReferenceTask(){return I(this.view,this.nextBasemap)}get _viewSpatialReferenceLocked(){const{view:e}=this;return!e||!("spatialReferenceLocked"in e)||e.spatialReferenceLocked}get activeBasemap(){var e,a;return y(((a=(e=this.view)==null?void 0:e.map)==null?void 0:a.basemap)??"topo-vector",this._basemapCache)}castNextBasemap(e){return y(e,this._basemapCache)}get state(){const{view:e}=this;if(!(e!=null&&e.ready)||this._nextBasemapSpatialReferenceTask.updating)return"disabled";const{spatialReference:a}=this._nextBasemapSpatialReferenceTask;return this._viewSpatialReferenceLocked&&a!=null&&!e.spatialReference.equals(a)?"incompatible-next-basemap":this._loadingProjectionEngine?"loading":"ready"}async toggle(){const{activeBasemap:e,nextBasemap:a,state:l,view:t}=this;if(!t||l==="disabled"||l==="incompatible-next-basemap")return;const g=this._viewSpatialReferenceLocked;if(!g){if(await K(()=>!this._nextBasemapSpatialReferenceTask.updating),a!==this.nextBasemap||e!==this.activeBasemap)return;const{spatialReference:m}=this._nextBasemapSpatialReferenceTask;if(m==null||R(t.spatialReference,m)||V()||F(t.spatialReference,m)||(this._loadingProjectionEngine=!0,await G(),this._loadingProjectionEngine=!1),a!==this.nextBasemap||e!==this.activeBasemap)return}t.map.basemap=a,g||this._nextBasemapSpatialReferenceTask.spatialReference==null||R(t.spatialReference,this._nextBasemapSpatialReferenceTask.spatialReference)||(t.spatialReference=this._nextBasemapSpatialReferenceTask.spatialReference),this.nextBasemap=e}static getThumbnailUrl(e){return S(e)}};s([n()],i.prototype,"_loadingProjectionEngine",void 0),s([n({readOnly:!0})],i.prototype,"_nextBasemapSpatialReferenceTask",null),s([n({readOnly:!0})],i.prototype,"_viewSpatialReferenceLocked",null),s([n({readOnly:!0})],i.prototype,"activeBasemap",null),s([n()],i.prototype,"nextBasemap",void 0),s([U("nextBasemap")],i.prototype,"castNextBasemap",null),s([n({readOnly:!0})],i.prototype,"state",null),s([n()],i.prototype,"view",void 0),s([n()],i.prototype,"toggle",null),i=s([A("esri.widgets.BasemapToggle.BasemapToggleViewModel")],i);const X=i;/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.32/esri/copyright.txt for details.
v4.32.12 */const Y=M`@layer{arcgis-basemap-toggle{display:block}}`,p="esri-basemap-toggle",d="esri-basemap-thumbnail",o={base:p,secondaryBasemapImage:`${p}__image--secondary`,container:`${d} ${p}__container`,image:`${d}__image ${p}__image`,imageLoading:`${p}__image--loading`,overlay:`${d}__overlay ${p}__image-overlay`,title:`${d}__title ${p}__title`,overlayScrim:`${d}__overlay-scrim`},Z=Q(X),h=class h extends P{constructor(){super(...arguments),this.messages=J(),this.viewModel=Z(this),this.activeBasemap=this.viewModel.activeBasemap,this.autoDestroyDisabled=!1,this.icon="layer-basemap",this.nextBasemap=this.viewModel.nextBasemap,this.position="top-left",this.showTitle=!1,this.state=this.viewModel.state,this.arcgisPropertyChange=j()("nextBasemap","state"),this.arcgisReady=O()}async destroy(){await this.manager.destroy()}async toggle(){return await this.viewModel.toggle()}_getThumbnailStyles(a){const l=W(a);return l?{backgroundImage:`url(${l})`}:{backgroundImage:""}}render(){const a=this.viewModel,l=a.state==="disabled"?null:a.activeBasemap,t=a.state==="disabled"?null:a.nextBasemap,g=a.state==="loading",m=a.state==="incompatible-next-basemap",v=(t==null?void 0:t.title)??"",b=t&&t.loadStatus!=="loaded";let _;const B=this.showTitle&&v,x=m,T=B||x,L=this._getThumbnailStyles(l),C=this._getThumbnailStyles(t);return T&&(_=c`<div class=${r(o.overlay)}>${B?c`<span class=${r(o.title)} title=${v??u}>${v}</span>`:null}${x?c`<calcite-scrim class=${r(o.overlayScrim)} title=${this.messages.incompatibleSpatialReference??u}><calcite-icon icon=exclamation-mark-triangle></calcite-icon></calcite-scrim>`:null}</div>`),c`<div class=${r(f(o.base,k.widget))}><calcite-button appearance=transparent data-basemap-id=${(t?t.id:"")??u} .disabled=${m} kind=neutral .label=${this.label??void 0} @click=${()=>void this.toggle()} title=${this.label??void 0??u}><div class=${r(f(o.container,o.secondaryBasemapImage))}><div class=${r(o.image)} style=${w(L)}></div></div><div class=${r(o.container)}><div class=${r(f(o.image,b?o.imageLoading:null))} style=${w(C)}>${b||g?c`<calcite-scrim><span aria-hidden=true class=${r(k.loaderAnimation)} role=presentation></span></calcite-scrim>`:null}</div>${_}</div></calcite-button></div>`}};h.properties={activeBasemap:0,autoDestroyDisabled:5,icon:3,label:1,messageOverrides:0,nextBasemap:0,position:3,referenceElement:1,showTitle:5,state:3},h.shadowRootOptions=D,h.styles=Y;let $=h;E("arcgis-basemap-toggle",$);export{$ as ArcgisBasemapToggle};
