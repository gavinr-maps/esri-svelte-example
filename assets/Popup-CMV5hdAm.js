import{r,a as P,g as S,m as l,B as A,av as V,j as O,b1 as R,ag as z}from"./Accessor-BmwT4B0c.js";import{d as h,v as H,P as m,w as U}from"./reactiveUtils-XM7cS2OP.js";import{c as j}from"./ActionToggle-D7439N1A.js";import{B as q}from"./Features-ClJvn8h6.js";import{O as G,n as E,g as L,e as J}from"./jsxFactory-Cnml7uXM.js";import{D as B}from"./FeaturesViewModel-_JXCqV25.js";import{e as K}from"./globalCss-vQlnDsEX.js";import{e as Q}from"./vmEvent-D4Ubqkbq.js";import"./Evented-Dw4_VOGn.js";import"./SimpleObservable-CvOkykwM.js";import"./Identifiable-BHVfzH03.js";import"./index-4eY77cms.js";import"./intl-Duiy0OzY.js";import"./Promise-DfET-uns.js";import"./cast-CsZslgGN.js";import"./JSONSupport-DcrLLGjL.js";import"./throttle-jjSnxk80.js";import"./geometryUtils-D1iOC1ST.js";import"./Extent-g5W9hy0j.js";import"./Point-Cz2JYYmX.js";import"./writer-DKgfqj4X.js";import"./scaleUtils-DPfHG2g0.js";import"./mathUtils-Cfq9PL9W.js";import"./actionUtils-CtQI3q6p.js";import"./substitute-CvdjmBYq.js";import"./Feature-zYPb8B0H.js";import"./Attachments-CEjxK4Wg.js";import"./unitFormatUtils-Q7ZG7HcF.js";import"./ByteSizeUnit-BsxeN7wM.js";import"./Cyclical-Dlbl-cQK.js";import"./quantityUtils-BsDK158M.js";import"./Graphic-Dt0LgVGU.js";import"./Clonable-Z-AWS-16.js";import"./opacityUtils-Dim20wpZ.js";import"./enumeration-DpvDkLNI.js";import"./Color-VJEMvW-n.js";import"./colorUtils-Rxh2V3ai.js";import"./jsonUtils-CwFG8yN4.js";import"./Polyline-s-JzsQqo.js";import"./typeUtils-B6WBEKDM.js";import"./TextSymbol-BLIQ6RKX.js";import"./screenUtils-_ZIvrt5o.js";import"./collectionUtils-CTT-51g7.js";import"./Portal-CmmHxpLg.js";import"./vec3f64-BLpZdpfb.js";import"./aaBoundingBox-Dw3yBk2f.js";import"./AttachmentInfo-b6cNZMAJ.js";import"./AttachmentQuery-CpEmJqq-.js";import"./featureUtils-BovNToiy.js";import"./layerUtils-B__v9OBu.js";import"./utils-v4CMtYiY.js";import"./mat4f32-DcsiF_Rp.js";import"./mat4-Fi6iAz29.js";import"./common-DQOJ18NT.js";import"./timeZoneUtils-DxzjpEBb.js";import"./attachmentUtils-BG3pf-R1.js";import"./legacyIcon-Wt_jLiuK.js";import"./FeatureRelationshipViewModel-CSg-U4Be.js";import"./Heading-BcR6CGTM.js";import"./ReactiveMap-BHFEHYMj.js";import"./NetworkElement-BEwoE6j2.js";import"./Query-B_2mhyL4.js";import"./Field-BDG0QV_T.js";import"./fieldType-CBeoJWlv.js";import"./FullTextSearch-CBnxSwz4.js";import"./TimeExtent-BO6BsF_x.js";import"./timeUtils-C1c_L2Fd.js";import"./RelationshipQuery-B5a-mYy7.js";import"./featureFormUtils-Cjx4R4NB.js";import"./formUtils-l8pvwous.js";import"./dateUtils-CkANlKbA.js";import"./widget-GKEQ1p1m.js";import"./uriUtils-CBE5heUM.js";import"./a11yUtils-ClKbIIe-.js";import"./utils-B1XxMXhZ.js";import"./ColorStop-BYiAUa8d.js";import"./utils-aIx1khaq.js";import"./jsonUtils-DZz5FrgB.js";import"./utils-DYurMneM.js";import"./cimSymbolUtils-DzhKvmq_.js";import"./utils-UPZJIDfz.js";import"./defaultCIMValues-Bb-CUowV.js";import"./enums-BTM-fOHQ.js";import"./LRUCache-CXiGQWMN.js";import"./MemCache-CmojB_Z1.js";import"./HeatmapColorStop-CHbSyb1s.js";import"./executeQueryJSON-BvVQs3iA.js";import"./utils-YowqfOgk.js";import"./query-Bjn_Ozo1.js";import"./normalizeUtils-BTGdXlpz.js";import"./normalizeUtilsCommon-lGDszWRI.js";import"./utils-B-dlKIhi.js";import"./pbfQueryUtils-mqiWagfZ.js";import"./pbf-BsmI3A9L.js";import"./memoryEstimations-Bcyf-mHz.js";import"./OptimizedGeometry-BJqUA4Pi.js";import"./OptimizedFeature-P2towpqD.js";import"./OptimizedFeatureSet-Blu9Ckm7.js";import"./queryZScale-BdW_vUm_.js";import"./projection-CyCZAIaD.js";import"./projectBuffer-CQnuEMuP.js";import"./geodesicConstants-RQL9oKdk.js";import"./FeatureSet-B5-Veyin.js";import"./themeUtils-C3zvZbsE.js";import"./shared-2m9g3-y2.js";import"./TimeOnly-CveCl9ie.js";import"./FeatureLayer-U46cmps3.js";import"./MultiOriginJSONSupport-DbmrbwMa.js";import"./layerContainerType-C5CzMsLd.js";import"./FeatureLayerBase-C4QQJYE9.js";import"./HeightModelInfo-C05IFsWs.js";import"./commonProperties-B0GHoNP5.js";import"./ElevationInfo-BPOqhCue.js";import"./unitConversionUtils-rg07EgOm.js";import"./lengthUtils-_77UiyVF.js";import"./AttributeTableTemplate-cR37sM72.js";import"./featureLayerUtils-Btb8HY8h.js";import"./uuid-Cl5lrJ4c.js";import"./featureQueryAll-JpNZKIBO.js";import"./SimpleRenderer-CEw_geZx.js";import"./commonProperties-ZfGquLPI.js";import"./colorRamps-CRjjPL3r.js";import"./SizeVariable-B-ghFm6e.js";import"./visualVariableUtils-Xcorldoo.js";import"./jsonUtils-B-voMz-i.js";import"./defaults-FkBa0ybj.js";import"./defaultsJSON-GKolV7NZ.js";import"./UniqueValueRenderer-yoWHKJ_P.js";import"./diffUtils-BanfihCO.js";import"./RendererLegendOptions-CYAPr8D6.js";import"./styleUtils-ColFrJ-Z.js";import"./NormalizationBinParametersMixin-CZD0XfhN.js";import"./LayerFloorInfo-iCgtHY6f.js";import"./Relationship-CTbzI1Kb.js";import"./serviceCapabilitiesUtils-B2yGaMdk.js";import"./infoFor3D-C7tb3HsI.js";import"./Layer-DH4_Pn8a.js";import"./workers-Cds_sd9m.js";import"./Queue-BQesTh_6.js";import"./editsZScale-LI19I1vI.js";import"./APIKeyMixin-3z69J1h4.js";import"./ArcGISService-CDyDWGI0.js";import"./ScaleRangeLayer-Cnzwr9PT.js";import"./CustomParametersMixin-Be7WOSEG.js";import"./DisplayFilteredLayer-CzliK74b.js";import"./displayFilterUtils-uKPOP7_-.js";import"./EditBusLayer-KXo-LY9o.js";import"./FeatureEffectLayer-BZmannck.js";import"./FeatureEffect-DZgZP6Sj.js";import"./FeatureFilter-Ca1n-g_b.js";import"./FeatureReductionLayer-B6VhUfZv.js";import"./FeatureReductionSelection-BJWsAyix.js";import"./labelingInfo-BgG6IH9B.js";import"./labelUtils-DCpQ7n-8.js";import"./jsonUtils-BZp85R7u.js";import"./typeUtils-B3iPBwJ2.js";import"./ClassBreaksRenderer-C7fhua2J.js";import"./Version-Cd3TlGH0.js";import"./FieldsIndex-FW1AMU67.js";import"./heatmapUtils-Cyq-bAyG.js";import"./vec42-YcqnINSP.js";import"./vec4f64-o2zAXfmz.js";import"./MD5-C9MwAd2G.js";import"./OperationalLayer-B__lrMRq.js";import"./OrderedLayer-ucEg87Tu.js";import"./OrderByInfo-KsusEmpW.js";import"./PortalLayer-Cqwv_mmr.js";import"./PortalItem-CTx1kJsR.js";import"./portalItemUtils-ByOtbGao.js";import"./RefreshableLayer-C90FXoHt.js";import"./TemporalLayer-CMqBosxi.js";import"./TimeInfo-CctegBed.js";import"./TimeInterval-B7L-CEq7.js";import"./TrackableLayer-DaYHUnrc.js";import"./FeatureTemplate-Dh5_oWTV.js";import"./FeatureType-DhERcdEP.js";import"./fieldProperties-DDN0PSrH.js";import"./TitleCreator-DIyQ9Yy3.js";import"./versionUtils-BfhafDf-.js";import"./styleUtils-Bye9ft1s.js";import"./popupUtils-CmsUVJA0.js";import"./interfaces-CL2NbQte.js";import"./Spinner--kyaGywN.js";import"./AnchorElementViewModel-BV8Tp06L.js";import"./actions-fElEWZWj.js";import"./ReactiveSet-DgPcISC1.js";import"./LayerConstants-B33OP6sh.js";import"./symbolUtils-CHmFfSx2.js";import"./colorUtils-DaPfwnk3.js";import"./mat2df32-orApM5a3.js";import"./mat2d-D9DBP-jx.js";import"./webStyleSymbolUtils-C6Yokq8v.js";import"./devEnvironmentUtils-CnNDiFMM.js";import"./webStyleAcceptedFormats-CG7ZQ6BV.js";import"./layerViewUtils-Bevty3Jm.js";import"./GoTo-zPv0y7kC.js";const g="esri-popup",_=`${g}--is-docked`,c={base:g,baseHidden:`${g}--hidden`,main:`${g}__main-container`,shadow:`${g}--shadow`,isDocked:_,isDockedTopLeft:`${_}-top-left`,isDockedTopCenter:`${_}-top-center`,isDockedTopRight:`${_}-top-right`,isDockedBottomLeft:`${_}-bottom-left`,isDockedBottomCenter:`${_}-bottom-center`,isDockedBottomRight:`${_}-bottom-right`,alignTopCenter:`${g}--aligned-top-center`,alignBottomCenter:`${g}--aligned-bottom-center`,alignTopLeft:`${g}--aligned-top-left`,alignBottomLeft:`${g}--aligned-bottom-left`,alignTopRight:`${g}--aligned-top-right`,alignBottomRight:`${g}--aligned-bottom-right`,pointer:`${g}__pointer`,pointerDirection:`${g}__pointer-direction`};let D=class extends B{constructor(t){super(t)}};D=r([P("esri.widgets.Popup.PopupViewModel")],D);const $=D;let v=class extends S{constructor(){super(...arguments),this.actionBar=!0,this.closeButton=!0,this.collapseButton=!0,this.featureMenuHeading=!0,this.featureNavigation=!0,this.featureListLayerTitle=!0,this.heading=!0,this.spinner=!0}};r([l({type:Boolean,nonNullable:!0})],v.prototype,"actionBar",void 0),r([l({type:Boolean,nonNullable:!0})],v.prototype,"closeButton",void 0),r([l({type:Boolean,nonNullable:!0})],v.prototype,"collapseButton",void 0),r([l({type:Boolean,nonNullable:!0})],v.prototype,"featureMenuHeading",void 0),r([l({type:Boolean,nonNullable:!0})],v.prototype,"featureNavigation",void 0),r([l({type:Boolean,nonNullable:!0})],v.prototype,"featureListLayerTitle",void 0),r([l({type:Boolean,nonNullable:!0})],v.prototype,"heading",void 0),r([l({type:Boolean,nonNullable:!0})],v.prototype,"spinner",void 0),v=r([P("esri.widgets.Popup.PopupVisibleElements")],v);const W=v,X=200,N={buttonEnabled:!0,position:"auto",breakpoint:{width:544}};let a=class extends G{constructor(t,e){super(t,e),this._dockAction=new j({id:"popup-dock-action"}),this._featuresWidget=new q({responsiveActionsEnabled:!0}),this._containerNode=null,this._mainContainerNode=null,this._pointerOffsetInPx=16,this._focusAbortController=null,this.alignment="auto",this.dockEnabled=!1,this.headingLevel=2,this.messages=null,this.viewModel=new $,this.visibleElements=new W}initialize(){this.addHandles([h(()=>{var t,e;return[(e=(t=this.viewModel)==null?void 0:t.view)==null?void 0:e.widthBreakpoint,this.dockEnabled]},()=>this._handleDockIcon(),m),h(()=>{var t,e;return[this.dockEnabled,(t=this.messages)==null?void 0:t.undock,(e=this.messages)==null?void 0:e.dock]},()=>this._handleDockEnabled(),m),h(()=>this.dockOptions,t=>{const{_dockAction:e}=this,i=this._featuresWidget.headerActions;i.remove(e),t.buttonEnabled&&i.add(e)},m),h(()=>{var t;return(t=this.viewModel)==null?void 0:t.screenLocation},()=>this._positionContainer()),h(()=>{var t;return[(t=this.viewModel)==null?void 0:t.active,this.dockEnabled]},()=>this._toggleScreenLocationEnabled()),h(()=>{var t,e,i,s,p,o,n;return[(t=this.viewModel)==null?void 0:t.screenLocation,(i=(e=this.viewModel)==null?void 0:e.view)==null?void 0:i.padding,(p=(s=this.viewModel)==null?void 0:s.view)==null?void 0:p.size,(o=this.viewModel)==null?void 0:o.active,(n=this.viewModel)==null?void 0:n.location,this.alignment]},()=>this.reposition()),h(()=>{var t,e;return(e=(t=this.viewModel)==null?void 0:t.view)==null?void 0:e.size},(t,e)=>this._updateDockEnabledForViewSize(t,e)),h(()=>{var t;return(t=this.viewModel)==null?void 0:t.view},(t,e)=>this._viewChange(t,e)),h(()=>{var t,e;return(e=(t=this.viewModel)==null?void 0:t.view)==null?void 0:e.ready},(t,e)=>this._viewReadyChange(t??!1,e??!1)),h(()=>this.viewModel,()=>this._featuresWidget.viewModel=this.viewModel,m),h(()=>this._featureNavigationTop,t=>this._featuresWidget.featureNavigationTop=t,m),h(()=>this.headingLevel,t=>this._featuresWidget.headingLevel=t,m),h(()=>this.visibleElements.actionBar,t=>this._featuresWidget.visibleElements.actionBar=!!t,m),h(()=>this.visibleElements.closeButton,t=>this._featuresWidget.visibleElements.closeButton=!!t,m),h(()=>this.visibleElements.collapseButton,t=>this._featuresWidget.visibleElements.collapseButton=!!t,m),h(()=>this.visibleElements.heading,t=>this._featuresWidget.visibleElements.heading=!!t,m),h(()=>this.visibleElements.spinner,t=>this._featuresWidget.visibleElements.spinner=!!t,m),h(()=>this.visibleElements.featureNavigation,t=>this._featuresWidget.visibleElements.featureNavigation=!!t,m),h(()=>this.visibleElements.featureMenuHeading,t=>this._featuresWidget.visibleElements.featureMenuHeading=!!t,m),h(()=>this.visibleElements.featureListLayerTitle,t=>this._featuresWidget.visibleElements.featureListLayerTitle=!!t,m),H(()=>this._featuresWidget,"trigger-header-action",t=>{t.action===this._dockAction&&(this.dockEnabled=!this.dockEnabled)})])}destroy(){var t;this._dockAction.destroy(),this._featuresWidget&&(this._featuresWidget.viewModel=new B,this._featuresWidget.destroy()),(t=this._focusAbortController)==null||t.abort()}get _featureNavigationTop(){const{currentAlignment:t,currentDockPosition:e}=this;return t==="bottom-left"||t==="bottom-center"||t==="bottom-right"||e==="top-left"||e==="top-center"||e==="top-right"}get actions(){return this.viewModel.actions}set actions(t){this.viewModel.actions=t}get active(){return this.viewModel.active}get autoCloseEnabled(){return this.viewModel.autoCloseEnabled}set autoCloseEnabled(t){this.viewModel.autoCloseEnabled=t}get defaultPopupTemplateEnabled(){return this.viewModel.defaultPopupTemplateEnabled}set defaultPopupTemplateEnabled(t){this.viewModel.defaultPopupTemplateEnabled=t}get content(){return this.viewModel.content}set content(t){this.viewModel.content=t}get collapsed(){return this._featuresWidget.collapsed}set collapsed(t){this._featuresWidget.collapsed=t}get currentAlignment(){return this._getCurrentAlignment()}get currentDockPosition(){return this._getCurrentDockPosition()}get dockOptions(){return this._get("dockOptions")||N}set dockOptions(t){var u,d;const e={...N},i=(d=(u=this.viewModel)==null?void 0:u.view)==null?void 0:d.breakpoints,s={};i&&(s.width=i.xsmall,s.height=i.xsmall);const p={...e,...t},o={...e.breakpoint,...s},{breakpoint:n}=p;typeof n=="object"?p.breakpoint={...o,...n}:n&&(p.breakpoint=o),this._set("dockOptions",p),this._setCurrentDockPosition(),this.reposition()}get featureCount(){return this.viewModel.featureCount}get featureMenuOpen(){return this.viewModel.featureMenuOpen}set featureMenuOpen(t){this.viewModel.featureMenuOpen=t}get features(){return this.viewModel.features}set features(t){this.viewModel.features=t}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(t){this.viewModel.goToOverride=t}get highlightEnabled(){return this.viewModel.highlightEnabled}set highlightEnabled(t){this.viewModel.highlightEnabled=t}get icon(){return"popup"}set icon(t){this._overrideIfSome("icon",t)}get initialDisplayMode(){return this.viewModel.initialDisplayMode}set initialDisplayMode(t){this.viewModel.initialDisplayMode=t}get location(){return this.viewModel.location}set location(t){this.viewModel.location=t}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}get promises(){return this.viewModel.promises}set promises(t){this.viewModel.promises=t}get selectedFeature(){return this.viewModel.selectedFeature}get selectedDrillInFeature(){return this._featuresWidget.selectedDrillInFeature??null}get selectedFeatureIndex(){return this.viewModel.selectedFeatureIndex}set selectedFeatureIndex(t){this.viewModel.selectedFeatureIndex=t}get selectedFeatureWidget(){return this._featuresWidget.selectedFeatureWidget}get title(){return this.viewModel.title}set title(t){this.viewModel.title=t}get updateLocationEnabled(){return this.viewModel.updateLocationEnabled}set updateLocationEnabled(t){this.viewModel.updateLocationEnabled=t}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}get visible(){return this.viewModel.visible}set visible(t){this.viewModel.visible=t}blur(){const{active:t}=this.viewModel;t||A.getLogger(this).warn("Popup can only be blurred when currently active."),this._featuresWidget.blur()}clear(){return this.viewModel.clear()}close(){this.visible=!1}fetchFeatures(t,e){return this.viewModel.fetchFeatures(t,e)}focus(){const{active:t}=this.viewModel;t||A.getLogger(this).warn("Popup can only be focused when currently active."),this._handleFocus()}next(){return this.viewModel.next()}open(t){const e=!!t&&!!t.featureMenuOpen,i={collapsed:!!t&&!!t.collapsed,featureMenuOpen:e};this.set(i),this.viewModel.open(t),t!=null&&t.shouldFocus&&this._handleFocus(!0)}previous(){return this.viewModel.previous()}reposition(){this.renderNow(),this._positionContainer(),this._setCurrentAlignment()}triggerAction(t){return this.viewModel.triggerAction(t)}render(){var b,k,y,w;const{dockEnabled:t,currentAlignment:e,currentDockPosition:i}=this,{active:s,screenLocation:p}=this.viewModel,o=s&&t,n=s&&!t,u=(k=(b=this.selectedFeature)==null?void 0:b.layer)==null?void 0:k.title,d=(w=(y=this.selectedFeature)==null?void 0:y.layer)==null?void 0:w.id,f={[c.alignTopCenter]:e==="top-center",[c.alignBottomCenter]:e==="bottom-center",[c.alignTopLeft]:e==="top-left",[c.alignBottomLeft]:e==="bottom-left",[c.alignTopRight]:e==="top-right",[c.alignBottomRight]:e==="bottom-right",[c.isDocked]:o,[c.shadow]:n,[c.isDockedTopLeft]:i==="top-left",[c.isDockedTopCenter]:i==="top-center",[c.isDockedTopRight]:i==="top-right",[c.isDockedBottomLeft]:i==="bottom-left",[c.isDockedBottomCenter]:i==="bottom-center",[c.isDockedBottomRight]:i==="bottom-right"};return E("div",{afterCreate:this._positionContainer,afterUpdate:this._positionContainer,"aria-hidden":(!s).toString(),"aria-label":V(this.title??""),"aria-modal":"false",bind:this,class:this.classes(c.base,f,{[c.baseHidden]:!p&&!t}),"data-layer-id":d,"data-layer-title":u,role:"dialog"},s?[this._renderMainContainer(),this._renderPointer()]:null)}_renderPointer(){return this.dockEnabled?null:E("div",{class:c.pointer,key:"popup-pointer",role:"presentation"},E("div",{class:this.classes(c.pointerDirection,c.shadow)}))}_renderMainContainer(){const{dockEnabled:t}=this,e={[c.shadow]:t};return E("div",{afterCreate:this._setMainContainerNode,afterUpdate:this._setMainContainerNode,bind:this,class:this.classes(c.main,K.widget,e)},this._featuresWidget.render())}_getAnimationDurationMS(){const{_containerNode:t}=this;return t?1e3*parseFloat(window.getComputedStyle(t).animationDuration):X}async _handleFocus(t=!1){var i;(i=this._focusAbortController)==null||i.abort(),this._focusAbortController=new AbortController;const e=this._focusAbortController.signal;t&&await U(()=>{var s;return((s=this.viewModel)==null?void 0:s.active)===!0},{signal:e}),await O(R(e)),await O(z(this._getAnimationDurationMS(),e)),this._featuresWidget.focus()}_isOutsideView(t){const{popupHeight:e,popupWidth:i,screenLocation:s,side:p,view:o}=t;if(isNaN(i)||isNaN(e)||!o||!s)return!1;const n=o.padding;return p==="right"&&s.x+i/2>o.width-n.right||p==="left"&&s.x-i/2<n.left||p==="top"&&s.y-e<n.top||p==="bottom"&&s.y+e>o.height-n.bottom}_calculateAutoAlignment(t){if(t!=="auto")return t;const{_pointerOffsetInPx:e,_containerNode:i,_mainContainerNode:s,viewModel:p}=this,{screenLocation:o,view:n}=p;if(o==null||!n||!i)return"top-center";function u(I){return parseInt(I.replaceAll(/[^-\d.]/g,""),10)}const d=s?window.getComputedStyle(s,null):null,f=d?u(d.getPropertyValue("max-height")):0,b=d?u(d.getPropertyValue("height")):0,{height:k,width:y}=i.getBoundingClientRect(),w=y+e,M=Math.max(k,f,b)+e,T=this._isOutsideView({popupHeight:M,popupWidth:w,screenLocation:o,side:"right",view:n}),F=this._isOutsideView({popupHeight:M,popupWidth:w,screenLocation:o,side:"left",view:n}),C=this._isOutsideView({popupHeight:M,popupWidth:w,screenLocation:o,side:"top",view:n}),x=this._isOutsideView({popupHeight:M,popupWidth:w,screenLocation:o,side:"bottom",view:n});return F?C?"bottom-right":"top-right":T?C?"bottom-left":"top-left":C?x?"top-center":"bottom-center":"top-center"}_callCurrentAlignment(t){return typeof t=="function"?t.call(this):t}_getCurrentAlignment(){const{alignment:t,dockEnabled:e}=this;return e||!this.viewModel.active?null:this._calculatePositionResult(this._calculateAutoAlignment(this._callCurrentAlignment(t)))}_setCurrentAlignment(){this._set("currentAlignment",this._getCurrentAlignment())}_setCurrentDockPosition(){this._set("currentDockPosition",this._getCurrentDockPosition())}_calculatePositionResult(t){const e=["left","right"];return L(this.container)&&e.reverse(),t==null?void 0:t.replace(/leading/gi,e[0]).replaceAll(/trailing/gi,e[1])}_callDockPosition(t){return typeof t=="function"?t.call(this):t}_getDockPosition(){var t;return this._calculatePositionResult(this._calculateAutoDockPosition(this._callDockPosition((t=this.dockOptions)==null?void 0:t.position)))}_getCurrentDockPosition(){return this.dockEnabled&&this.viewModel.active?this._getDockPosition():null}_calculateAutoDockPosition(t){var n;if(t!=="auto")return t;const e=(n=this.viewModel)==null?void 0:n.view,i=L(this.container)?"top-left":"top-right";if(!e)return i;const s=e.padding||{left:0,right:0},p=e.width-s.left-s.right,{breakpoints:o}=e;return o&&p<=o.xsmall?"bottom-center":i}_getDockIcon(){const t=this._getDockPosition();if(this.dockEnabled)return"minimize";switch(t){case"top-left":case"bottom-left":return"dock-left";case"top-center":return"maximize";case"bottom-center":return"dock-bottom";default:return"dock-right"}}_handleDockIcon(){this._dockAction.icon=this._getDockIcon()}_handleDockEnabled(){var t,e;this._dockAction.title=this.dockEnabled?(t=this.messages)==null?void 0:t.undock:(e=this.messages)==null?void 0:e.dock}_setMainContainerNode(t){this._mainContainerNode=t}_positionContainer(t=this._containerNode){if(t&&(this._containerNode=t),!this._containerNode)return;const{screenLocation:e}=this.viewModel,{width:i}=this._containerNode.getBoundingClientRect(),s=this._calculatePositionStyle(e,i);s&&Object.assign(this._containerNode.style,s)}_calculateFullWidth(t){const{currentAlignment:e,_pointerOffsetInPx:i}=this;return e==="top-left"||e==="bottom-left"||e==="top-right"||e==="bottom-right"?t+i:t}_calculateAlignmentPosition(t,e,i,s){const{currentAlignment:p,_pointerOffsetInPx:o}=this;if(!i)return;const{padding:n}=i,u=s/2,d=i.height-e,f=i.width-t;return p==="bottom-center"?{top:e+o-n.top,left:t-u-n.left}:p==="top-left"?{bottom:d+o-n.bottom,right:f+o-n.right}:p==="bottom-left"?{top:e+o-n.top,right:f+o-n.right}:p==="top-right"?{bottom:d+o-n.bottom,left:t+o-n.left}:p==="bottom-right"?{top:e+o-n.top,left:t+o-n.left}:p==="top-center"?{bottom:d+o-n.bottom,left:t-u-n.left}:void 0}_calculatePositionStyle(t,e){const{dockEnabled:i,view:s}=this;if(!s)return;if(i)return{left:"",top:"",right:"",bottom:""};if(t==null||!e)return;const p=this._calculateFullWidth(e),o=this._calculateAlignmentPosition(t.x,t.y,s,p);return o?{top:o.top!==void 0?`${o.top}px`:"auto",left:o.left!==void 0?`${o.left}px`:"auto",bottom:o.bottom!==void 0?`${o.bottom}px`:"auto",right:o.right!==void 0?`${o.right}px`:"auto"}:void 0}_viewChange(t,e){t&&e&&(this.close(),this.clear())}_viewReadyChange(t,e){t?this._wireUpView():e&&(this.close(),this.clear())}_wireUpView(){this._setDockEnabledForViewSize(this.dockOptions)}_dockingThresholdCrossed(t,e,i){const[s,p]=t,[o,n]=e,{width:u=0,height:d=0}=i??{};return s<=u&&o>u||s>u&&o<=u||p<=d&&n>d||p>d&&n<=d}_updateDockEnabledForViewSize(t,e){var f,b;if(!t||!e)return;const i=((b=(f=this.viewModel)==null?void 0:f.view)==null?void 0:b.padding)||{left:0,right:0,top:0,bottom:0},s=i.left+i.right,p=i.top+i.bottom,o=[],n=[];o[0]=t[0]-s,o[1]=t[1]-p,n[0]=e[0]-s,n[1]=e[1]-p;const{dockOptions:u}=this,d=u.breakpoint;this._dockingThresholdCrossed(o,n,d)&&this._setDockEnabledForViewSize(u),this._setCurrentDockPosition()}_toggleScreenLocationEnabled(){const{dockEnabled:t,viewModel:e}=this;if(!e)return;const i=e.active&&!t;e.screenLocationEnabled=i}_shouldDockAtCurrentViewSize(t){var u,d;const e=t.breakpoint,i=(d=(u=this.viewModel)==null?void 0:u.view)==null?void 0:d.ui;if(!i)return!1;const{width:s,height:p}=i;if(isNaN(s)||isNaN(p)||!e)return!1;const o=e.hasOwnProperty("width")&&s<=(e.width??0),n=e.hasOwnProperty("height")&&p<=(e.height??0);return o||n}_setDockEnabledForViewSize(t){t.breakpoint&&(this.dockEnabled=this._shouldDockAtCurrentViewSize(t))}};r([l({readOnly:!0})],a.prototype,"_featureNavigationTop",null),r([l()],a.prototype,"actions",null),r([l({readOnly:!0})],a.prototype,"active",null),r([l()],a.prototype,"alignment",void 0),r([l()],a.prototype,"autoCloseEnabled",null),r([l()],a.prototype,"defaultPopupTemplateEnabled",null),r([l()],a.prototype,"content",null),r([l()],a.prototype,"collapsed",null),r([l({readOnly:!0})],a.prototype,"currentAlignment",null),r([l({readOnly:!0})],a.prototype,"currentDockPosition",null),r([l()],a.prototype,"dockOptions",null),r([l()],a.prototype,"dockEnabled",void 0),r([l({readOnly:!0})],a.prototype,"featureCount",null),r([l()],a.prototype,"featureMenuOpen",null),r([l()],a.prototype,"features",null),r([l()],a.prototype,"goToOverride",null),r([l()],a.prototype,"headingLevel",void 0),r([l()],a.prototype,"highlightEnabled",null),r([l()],a.prototype,"icon",null),r([l()],a.prototype,"initialDisplayMode",null),r([l()],a.prototype,"location",null),r([l()],a.prototype,"label",null),r([l(),J("esri/widgets/Popup/t9n/Popup")],a.prototype,"messages",void 0),r([l()],a.prototype,"promises",null),r([l({readOnly:!0})],a.prototype,"selectedFeature",null),r([l({readOnly:!0})],a.prototype,"selectedDrillInFeature",null),r([l()],a.prototype,"selectedFeatureIndex",null),r([l({readOnly:!0})],a.prototype,"selectedFeatureWidget",null),r([l()],a.prototype,"title",null),r([l()],a.prototype,"updateLocationEnabled",null),r([l()],a.prototype,"view",null),r([l({type:$}),Q(["triggerAction","trigger-action"])],a.prototype,"viewModel",void 0),r([l()],a.prototype,"visible",null),r([l({type:W,nonNullable:!0})],a.prototype,"visibleElements",void 0),a=r([P("esri.widgets.Popup")],a);const $o=a;export{$o as default};
