const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./calcite-action-Bys6x4p_.js","./action-D0Er9Ef6.js","./jsxFactory-CJa39Fro.js","./tslib.es6-B3Jf3DVX.js","./intl-CChhNOV8.js","./date-DlqISzcw.js","./jsonMap-0cxwUWs2.js","./subclass-BZA_h8Db.js","./locale-C9TlLpzi.js","./messages-OmQvZhAg.js","./Accessor-BLX9ikPh.js","./assets-C43MgM-v.js","./index-Bh2oEzTI.js","./index-2kwcjS9-.css","./Evented-BHRw9x22.js","./Promise-B2Hu02L7.js","./reactiveUtils-C5zUhJQJ.js","./asyncUtils-CWX51uTe.js","./Collection-CEdjem1-.js","./shared-B3wH2qpO.js","./SimpleObservable-KocWTzVy.js","./uuid-fwrPAdZb.js","./cast-Bjksrh93.js","./dom-D_AJDzAj.js","./interactive-y84HQRWL.js","./loadable-DM18hPdE.js","./locale-A4FuYD8q.js","./key-D63ExP77.js","./observers-D2xgmA06.js","./component-6CIDVndn.js","./t9n-D0ry3MEw.js","./icon-BQO9J86c.js","./loader-C-zIPscB.js","./calcite-action-group-Dp-CUDEe.js","./action-group-BJ76kEtf.js","./conditionalSlot-R5D9krYS.js","./action-menu-C6uYzPu-.js","./array-BMcQdnYi.js","./popover-Q5ruM4hh.js","./floating-ui-Bma_zPVt.js","./debounce-BOqmhDXu.js","./focusTrapComponent-BSUg_DLj.js","./openCloseComponent-CmOrfBN-.js","./Heading-D7P0OjYI.js","./FloatingArrow-BBdsG5MP.js","./calcite-action-pad-D3cShEGp.js","./ExpandToggle-D9_knjDY.js","./calcite-icon-Cu0W9dtm.js","./calcite-slider-GqQeL3Ah.js","./form-BZPQ5PUM.js","./label-DEe8AW1C.js","./math-CPc4dlb6.js"])))=>i.map(i=>d[i]);
import{_ as b}from"./index-Bh2oEzTI.js";import{r as n}from"./tslib.es6-B3Jf3DVX.js";import{watch as C}from"./reactiveUtils-C5zUhJQJ.js";import{m as s,a as y}from"./subclass-BZA_h8Db.js";import{e as E,B as R,v as B,r as x,w as S,n as l}from"./jsxFactory-CJa39Fro.js";import{e as $}from"./utils-DsJqvptN.js";import{o as D}from"./Evented-BHRw9x22.js";import{M as V,s as P}from"./mathUtils-C4_ghTv4.js";import{t as T}from"./GoTo-Wtu9mgoE.js";import{b as A}from"./Accessor-BLX9ikPh.js";import{e as M}from"./globalCss-CZa70j6i.js";import"./asyncUtils-CWX51uTe.js";import"./Collection-CEdjem1-.js";import"./shared-B3wH2qpO.js";import"./SimpleObservable-KocWTzVy.js";import"./intl-CChhNOV8.js";import"./date-DlqISzcw.js";import"./jsonMap-0cxwUWs2.js";import"./locale-C9TlLpzi.js";import"./messages-OmQvZhAg.js";import"./assets-C43MgM-v.js";import"./Promise-B2Hu02L7.js";import"./uuid-fwrPAdZb.js";import"./cast-Bjksrh93.js";const w=[-45,0,45,-90,90,-135,180,135],N=[...w,-180],I={0:{label:"north",iconName:"chevron-up"},45:{label:"northEast",iconName:"chevron-up-right"},90:{label:"east",iconName:"chevron-right"},135:{label:"southEast",iconName:"chevron-down-right"},180:{label:"south",iconName:"chevron-down"},"-135":{label:"southWest",iconName:"chevron-down-left"},"-90":{label:"west",iconName:"chevron-left"},"-45":{label:"northWest",iconName:"chevron-up-left"}},L=200,v="esri-directional-pad",h={base:v,buttonsContainer:`${v}__buttons-container`,button:`${v}__button`,compassButton:`${v}__compass`,rotationContainer:`${v}__rotation-container`,rotationSliderContainer:`${v}__rotation-slider-container`,rotationReset:`${v}__rotation-reset-button`,error:`${v}__error`};function O(t){const o=k(t),e=N.map(r=>({angle:r,offset:Math.abs(r-o)})).sort((r,m)=>r.offset-m.offset),i=e[0].angle;return i===-180?180:i}function k({x:t,y:o}){const e=Math.atan2(t,o);return V(e)}function g(t){const o=P(t);return{x:Math.sin(o),y:Math.cos(o)}}function H(t,o){const e=o.y-t.y,i=o.x-t.x,r=Math.sqrt(i*i+e*e);return{x:i/r,y:e/r}}function U(t){const{x:o,y:e,width:i,height:r}=t.getBoundingClientRect();return{x:o+i/2,y:e+r/2}}let a=class extends T(D.EventedAccessor){constructor(t){super(t),this._initialAngle=void 0,this._movementVector=void 0,this._widgetCenter=void 0,this._anyAngleMovementEnabled=!1,this._movementTimeout=void 0,this._disabled=!1,this._moveOnceDuration=L,this.angle=void 0,this.speed=1,this.beginFollowingPointer=(o,e)=>{if(this.disabled)return;this._widgetCenter=e;const i=this._pointerLocationToVector(o);if(i===void 0)return;const r=this._resolveClosestAngle(o,i);r!==void 0&&(this._emitMove(g(r)),this.angle=r,this._initialAngle=r,this._setMovementTimeout(()=>{this._widgetCenter===void 0&&this._stopMovement()}),document.addEventListener("pointermove",this._onPointerMove,{passive:!0}),document.addEventListener("pointerup",this._onPointerUp,{passive:!0,once:!0}))},this.moveOnce=o=>{const e=g(o);this._emitMove(e),this._setMovementTimeout(this._stopMovement)},this._pointerLocationToVector=o=>{if(this._widgetCenter===void 0)return;const{x:e,y:i}=H(this._widgetCenter,o);return{x:e,y:-i}},this._resolveClosestAngle=(o,e)=>{var p,_;const i=o.target,r=(p=i==null?void 0:i.getAttribute)==null?void 0:p.call(i,"data-angle");if((_=i==null?void 0:i.classList)==null?void 0:_.contains(h.compassButton))return;const c=Number.parseInt(r??"",10);return Number.isNaN(c)?O(e):c},this._onPointerMove=o=>{var p,_;if(o.buttons===0)return void this._stopMovement();const e=this._pointerLocationToVector(o);if(e===void 0)return;this._setMovementTimeout(void 0);const i=this._resolveClosestAngle(o,e);if(i===void 0)return void this._emitStop();const r=g(i),m=this._initialAngle!=null&&this._initialAngle!==i;this._anyAngleMovementEnabled||(this._anyAngleMovementEnabled=m);const c=this._anyAngleMovementEnabled?e:r;(c.x!==((p=this._movementVector)==null?void 0:p.x)||c.y!==((_=this._movementVector)==null?void 0:_.y))&&(this.angle=i,this._emitMove(c))},this._onPointerUp=()=>{this._movementTimeout===void 0?this._stopMovement():this._widgetCenter=void 0},this._stopMovement=()=>{this._emitStop(),this._widgetCenter=void 0,this._initialAngle=void 0,this._anyAngleMovementEnabled=!1,document.removeEventListener("pointermove",this._onPointerMove),document.removeEventListener("pointerup",this._stopMovement),this._setMovementTimeout(void 0)},this.on("move-start",()=>{var o;return(o=this.view)==null?void 0:o.mapViewNavigation.begin()}),this.on("move-direction-change",({vector:{x:o,y:e}})=>{var i;return(i=this.view)==null?void 0:i.mapViewNavigation.continuousPanVector({x:o*this.speed,y:e*this.speed})}),this.on("move-stop",()=>{var o;return(o=this.view)==null?void 0:o.mapViewNavigation.stop()})}destroy(){this._stopMovement()}get disabled(){const{view:t,_disabled:o,supported:e}=this;return(t==null?void 0:t.ready)===!1||o||!e}set disabled(t){this._disabled=t}get rotation(){var t;return((t=this.view)==null?void 0:t.rotation)??this._get("rotation")??0}set rotation(t){this.view?this.view.constraints.rotationEnabled&&this.callGoTo({target:{rotation:t},options:{animate:t===0&&void 0}}):this._set("rotation",t)}get supported(){return this.view==null||this.view.type==="2d"}get state(){const{disabled:t,angle:o}=this;return t?"disabled":o!=null?"moving":"ready"}_setMovementTimeout(t){clearTimeout(this._movementTimeout),this._movementTimeout=t===void 0?void 0:setTimeout(()=>{this._movementTimeout=void 0,t()},this._moveOnceDuration)}_emitMove(t){this._movementVector==null&&this._emitMoveStartEvent({vector:t});const o=this._movementVector;this._movementVector=t,this._emitMoveDirectionChangeEvent({vector:t,oldVector:o})}_emitStop(){this.angle=void 0,this._movementVector!==void 0&&(this._emitMoveStopEvent({oldVector:this._movementVector}),this._movementVector=void 0)}_emitMoveStartEvent(t){this.emit("move-start",{...t,type:"move-start"})}_emitMoveDirectionChangeEvent(t){this.emit("move-direction-change",{...t,type:"move-direction-change"})}_emitMoveStopEvent(t){this.emit("move-stop",{...t,type:"move-stop"})}};n([s()],a.prototype,"_initialAngle",void 0),n([s()],a.prototype,"_movementVector",void 0),n([s()],a.prototype,"_widgetCenter",void 0),n([s()],a.prototype,"_anyAngleMovementEnabled",void 0),n([s()],a.prototype,"_movementTimeout",void 0),n([s()],a.prototype,"_disabled",void 0),n([s()],a.prototype,"_moveOnceDuration",void 0),n([s()],a.prototype,"disabled",null),n([s()],a.prototype,"angle",void 0),n([s({type:Number,range:{min:0,max:100}})],a.prototype,"speed",void 0),n([s()],a.prototype,"rotation",null),n([s()],a.prototype,"supported",null),n([s({readOnly:!0})],a.prototype,"state",null),n([s()],a.prototype,"view",void 0),a=n([y("esri.widgets.DirectionalPad.DirectionalPadViewModel")],a);const q=a;let u=class extends A{constructor(t){super(t),this.directionalButtons=!0,this.rotationSlider=!1,this.rotationResetButton=!1}};n([s({type:Boolean,nonNullable:!0})],u.prototype,"directionalButtons",void 0),n([s({type:Boolean,nonNullable:!0})],u.prototype,"rotationSlider",void 0),n([s({type:Boolean,nonNullable:!0})],u.prototype,"rotationResetButton",void 0),u=n([y("esri.widgets.DirectionalPad.VisibleElements")],u);const f=u;let d=class extends R{constructor(t,o){super(t,o),this._buttonsContainer=null,this._buttons={},this.messages=null,this.visibleElements=new f,this.viewModel=new q,this.visualScale="s",this._rotateIcon=e=>({"--rotation":`rotate(${e}deg)`}),this._afterButtonContainerCreate=e=>{this._buttonsContainer=e,this._buttonsContainer.addEventListener("contextmenu",this._onContextMenu,{capture:!0})},this._afterButtonContainerRemoved=()=>{var e;(e=this._buttonsContainer)==null||e.removeEventListener("contextmenu",this._onContextMenu,{capture:!0}),this._buttonsContainer=null},this._afterButtonCreate=(e,i)=>{this._buttons[e]=i},this._afterButtonRemoved=e=>{this._buttons[e]=void 0},this._onContextMenu=e=>e.preventDefault(),this._onButtonPointerDown=e=>{var c;if(this._buttonsContainer===null)return;const i=e.target,r=(c=i==null?void 0:i.shadowRoot)==null?void 0:c.querySelector("button");r!=null&&r.hasPointerCapture(e.pointerId)&&r.releasePointerCapture(e.pointerId);const m=U(this._buttonsContainer);this.viewModel.beginFollowingPointer(e,m)},this._onKeyDown=(e,{key:i})=>{B(i)&&this.viewModel.moveOnce(e)},this._onSliderInput=({target:e})=>{typeof e.value=="number"&&(this.viewModel.rotation=e.value)},this._onRotationReset=()=>{this.viewModel.rotation=0}}loadDependencies(){return x({action:()=>b(()=>import("./calcite-action-Bys6x4p_.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32]),import.meta.url),"action-group":()=>b(()=>import("./calcite-action-group-Dp-CUDEe.js"),__vite__mapDeps([33,34,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,35,28,25,26,23,27,30,36,37,1,24,29,31,32,38,39,40,41,42,43,44]),import.meta.url),"action-pad":()=>b(()=>import("./calcite-action-pad-D3cShEGp.js"),__vite__mapDeps([45,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,35,28,23,25,26,27,30,46,34,36,37,1,24,29,31,32,38,39,40,41,42,43,44]),import.meta.url),icon:()=>b(()=>import("./calcite-icon-Cu0W9dtm.js"),__vite__mapDeps([47,31,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,28]),import.meta.url),slider:()=>b(()=>import("./calcite-slider-GqQeL3Ah.js"),__vite__mapDeps([48,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,49,24,27,50,29,25,26,28,51]),import.meta.url)})}initialize(){this.addHandles(C(()=>this.viewModel.angle,()=>{var o,e;((o=this._buttonsContainer)==null?void 0:o.contains(document.activeElement))&&(this.viewModel.angle==null?(e=this.container)==null||e.focus():S(this._buttons[this.viewModel.angle]))}))}get disabled(){return this.viewModel.disabled}set disabled(t){this.viewModel.disabled=t}get icon(){return"move"}set icon(t){this._overrideIfSome("icon",t)}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}get speed(){return this.viewModel.speed}set speed(t){this.viewModel.speed=t}get _rotationEnabled(){var t;return!((t=this.view)!=null&&t.ready)||this.view.constraints.rotationEnabled}render(){const{label:t,disabled:o,viewModel:e}=this,i=this.classes(h.base,M.widget,o?M.disabled:null);return l("div",{"aria-label":t,class:i,tabIndex:-1},e.supported?this._renderContent():this._renderUnsupportedMessage())}_renderUnsupportedMessage(){return l("section",{class:h.error,key:"unsupported"},l("p",null,this.messages.unsupported))}_renderContent(){return[this.visibleElements.directionalButtons?this._renderDirectionalButtons():void 0,this.visibleElements.rotationSlider?this._renderRotation():void 0]}_renderDirectionalButtons(){return l("calcite-action-pad",{expandDisabled:!0,key:"directional-buttons-container",layout:"grid"},l("calcite-action-group",{afterCreate:this._afterButtonContainerCreate,afterRemoved:this._afterButtonContainerRemoved,class:h.buttonsContainer,dir:"ltr"},w.slice(0,4).map(t=>this._renderButton(t)),this._renderCompass(),w.slice(4).map(t=>this._renderButton(t))))}_renderButton(t){const{label:o,iconName:e}=I[t],i=this.messages[o];return l("calcite-action",{active:this.viewModel.angle===t,afterCreate:r=>this._afterButtonCreate(t,r),afterRemoved:()=>this._afterButtonRemoved(t),alignment:"center",class:h.button,"data-angle":t.toString(),disabled:this.disabled,key:t,onkeydown:this._onKeyDown.bind(void 0,t),onpointerdown:this._onButtonPointerDown,scale:this.visualScale,text:i,title:i},l("calcite-icon",{icon:e,scale:this.visualScale}))}_renderCompass(){const t=this.disabled||$(this.view)?"compass-needle":"arrow-up",o=this.viewModel.rotation===0,e=this.messages.resetHeading;return l("calcite-action",{alignment:"center",class:h.compassButton,disabled:this.disabled||!this._rotationEnabled||o,key:"compass",onclick:this._onRotationReset,scale:this.visualScale,styles:this._rotateIcon(this.viewModel.rotation),text:e,title:e},!o&&l("calcite-icon",{icon:t,scale:this.visualScale}))}_renderRotation(){return l("calcite-action-pad",{expandDisabled:!0,key:"slider-container",layout:"horizontal"},l("calcite-action-group",{class:h.rotationContainer},this.visibleElements.rotationResetButton?this._renderRotationResetButton():null,this._renderRotationSlider()))}_renderRotationResetButton(){const t=this.messages.resetHeading;return l("calcite-action",{alignment:"center",class:h.rotationReset,disabled:this.disabled||!this._rotationEnabled,onclick:this._onRotationReset,scale:this.visualScale,text:t,title:t},l("calcite-icon",{flipRtl:!0,icon:"rotate",scale:this.visualScale}))}_renderRotationSlider(){return l("div",{class:h.rotationSliderContainer},l("calcite-slider",{"aria-label":this.messages.heading,disabled:this.disabled||!this._rotationEnabled,labelHandles:!0,max:360,min:0,required:!0,scale:this.visualScale,value:Math.round(this.viewModel.rotation),onCalciteSliderInput:this._onSliderInput}))}};n([s()],d.prototype,"_buttonsContainer",void 0),n([s()],d.prototype,"_buttons",void 0),n([s()],d.prototype,"disabled",null),n([s()],d.prototype,"icon",null),n([s()],d.prototype,"label",null),n([s(),E("esri/widgets/DirectionalPad/t9n/DirectionalPad")],d.prototype,"messages",void 0),n([s({type:f,nonNullable:!0})],d.prototype,"visibleElements",void 0),n([s()],d.prototype,"view",null),n([s()],d.prototype,"viewModel",void 0),n([s()],d.prototype,"visualScale",void 0),n([s()],d.prototype,"speed",null),n([s({readOnly:!0})],d.prototype,"_rotationEnabled",null),d=n([y("esri.widgets.DirectionalPad")],d);const mt=d;export{mt as default};
