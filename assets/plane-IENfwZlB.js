import{b as v,r as z}from"./mathUtils-C4_ghTv4.js";import{P as u,r as q,A,_ as L,g as C,c as _,u as x,s as B,H as y,o as H}from"./vec32-Dvg_eL9J.js";import{n as N}from"./vec3f64-BLpZdpfb.js";import"./vec42-YcqnINSP.js";import"./subclass-BZA_h8Db.js";import{T as G}from"./Accessor-BLX9ikPh.js";import{e as J}from"./mat3f64-BBpwCtoL.js";import{e as K}from"./mat4f64-Dk4dwAN8.js";import{e as W}from"./quatf64-CCm9z-pX.js";import{n as Y}from"./vec2f64-miziP1SN.js";import{n as Z}from"./vec4f64-o2zAXfmz.js";import{q as tt}from"./mathUtils-BG-eq9fO.js";let h=class E{constructor(r){this._create=r,this._items=new Array,this._itemsPtr=0}get(){return this._itemsPtr===0&&G(()=>this._reset()),this._itemsPtr>=this._items.length&&this._items.push(this._create()),this._items[this._itemsPtr++]}_reset(){const r=2*this._itemsPtr;this._items.length>r&&(this._items.length=r),this._itemsPtr=0}static createVec2f64(){return new E(Y)}static createVec3f64(){return new E(N)}static createVec4f64(){return new E(Z)}static createMat3f64(){return new E(J)}static createMat4f64(){return new E(K)}static createQuatf64(){return new E(W)}get test(){}};const gt=h.createVec2f64(),I=h.createVec3f64(),rt=h.createVec4f64();h.createMat3f64();const Dt=h.createMat4f64(),Ot=h.createQuatf64();function pt(t,r,e){const n=u(t,r)/u(t,t);return C(e,t,n)}function X(t,r){return u(t,r)/q(t)}function Pt(t,r){const e=u(t,r)/(q(t)*q(r));return-v(e)}function lt(t,r,e){A(p,t),A(d,r);const n=u(p,d),c=v(n),s=L(p,p,d);return u(s,e)<0?2*Math.PI-c:c}const p=N(),d=N();function Q(t=$){return[t[0],t[1],t[2],t[3]]}function At(t=$[0],r=$[1],e=$[2],n=$[3]){return j(t,r,e,n,rt.get())}function et(t,r){return j(r[0],r[1],r[2],r[3],t)}function Ct(t){return t}function j(t,r,e,n,c=Q()){return c[0]=t,c[1]=r,c[2]=e,c[3]=n,c}function Ut(t,r,e){return B(e,t),e[3]=r,e}function nt(t,r,e){const n=r[0]*r[0]+r[1]*r[1]+r[2]*r[2],c=Math.abs(n-1)>1e-5&&n>1e-12?1/Math.sqrt(n):1;return e[0]=r[0]*c,e[1]=r[1]*c,e[2]=r[2]*c,e[3]=-(e[0]*t[0]+e[1]*t[1]+e[2]*t[2]),e}function ct(t,r,e,n=Q()){const c=e[0]-r[0],s=e[1]-r[1],o=e[2]-r[2],i=t[0]-r[0],D=t[1]-r[1],O=t[2]-r[2],S=s*O-o*D,R=o*i-c*O,b=c*D-s*i,w=S*S+R*R+b*b,V=Math.abs(w-1)>1e-5&&w>1e-12?1/Math.sqrt(w):1;return n[0]=S*V,n[1]=R*V,n[2]=b*V,n[3]=-(n[0]*t[0]+n[1]*t[1]+n[2]*t[2]),n}function k(t,r,e,n=0,c=Math.floor(e*(1/3)),s=Math.floor(e*(2/3))){if(e<3)return!1;r(M,n);let o=c,i=!1;for(;o<e-1&&!i;)r(m,o),o++,i=!y(M,m);if(!i)return!1;for(o=Math.max(o,s),i=!1;o<e&&!i;)r(T,o),o++,_(P,M,m),A(P,P),_(l,m,T),A(l,l),i=!y(M,T)&&!y(m,T)&&Math.abs(u(P,l))<it;return i?(ct(M,m,T,t),!0):(n!==0||c!==1||s!==2)&&k(t,r,e,0,1,2)}function Ft(t,r,e=!0){const n=r.length/3;return k(t,(c,s)=>H(c,r[3*s+0],r[3*s+1],r[3*s+2]),e?n-1:n)}const it=.99619469809,M=N(),m=N(),T=N(),P=N(),l=N();function Rt(t,r,e){return r!==t&&et(t,r),t[3]=-u(t,e),t}function bt(t,r){return r[0]=-t[0],r[1]=-t[1],r[2]=-t[2],r[3]=-t[3],r}function wt(t,r,e,n){return L(T,r,t),nt(e,T,n)}function Vt(t,r,e,n){return U(F(t,r,_(I.get(),e,r),st,n))}function yt(t,r,e){return r!=null&&U(F(t,r.origin,r.direction,ut,e))}function Xt(t,r,e){return U(F(t,r.origin,r.vector,f.NONE,e))}function dt(t,r,e){return U(F(t,r.origin,r.vector,f.CLAMP,e))}function qt(t,r){return g(t,r)>=0}function vt(t,r){const e=u(t,r.ray.direction),n=-g(t,r.ray.origin);if(n<0&&e>=0)return!1;if(e>-1e-6&&e<1e-6)return n>0;if((n<0||e<0)&&!(n<0&&e<0))return!0;const c=n/e;return e>0?c<r.c1&&(r.c1=c):c>r.c0&&(r.c0=c),r.c0<=r.c1}function Lt(t,r){const e=u(t,r.ray.direction),n=-g(t,r.ray.origin);if(e>-1e-6&&e<1e-6)return n>0;const c=n/e;return e>0?c<r.c1&&(r.c1=c):c>r.c0&&(r.c0=c),r.c0<=r.c1}function xt(t,r,e){const n=C(I.get(),t,-t[3]),c=ot(t,_(I.get(),r,n),I.get());return x(e,c,n),e}function Ht(t,r,e,n){const c=t,s=I.get(),o=I.get();tt(c,s,o);const i=_(I.get(),e,r),D=X(s,i),O=X(o,i),S=X(c,i);return H(n,D,O,S)}function ot(t,r,e){const n=C(I.get(),t,u(t,r));return _(e,r,n),e}function Qt(t,r){return Math.abs(g(t,r))}function g(t,r){return u(t,r)+t[3]}var a;function U(t){return t===a.INTERSECTS_INSIDE_OUT||t===a.INTERSECTS_OUTSIDE_IN}function F(t,r,e,n,c){const s=u(t,e),o=g(t,r);if(s===0)return o>=0?a.INSIDE:a.OUTSIDE;let i=-o/s;return n&f.CLAMP&&(i=z(i,0,1)),!(n&f.INFINITE_MIN)&&i<0||!(n&f.INFINITE_MAX)&&i>1?o>=0?a.INSIDE:a.OUTSIDE:(x(c,r,C(c,e,i)),o>=0?a.INTERSECTS_INSIDE_OUT:a.INTERSECTS_OUTSIDE_IN)}(function(t){t[t.INTERSECTS_INSIDE_OUT=0]="INTERSECTS_INSIDE_OUT",t[t.INTERSECTS_OUTSIDE_IN=1]="INTERSECTS_OUTSIDE_IN",t[t.INSIDE=2]="INSIDE",t[t.OUTSIDE=3]="OUTSIDE"})(a||(a={}));const $=[0,0,1,0];var f;(function(t){t[t.NONE=0]="NONE",t[t.CLAMP=1]="CLAMP",t[t.INFINITE_MIN=4]="INFINITE_MIN",t[t.INFINITE_MAX=8]="INFINITE_MAX"})(f||(f={}));const st=f.INFINITE_MIN|f.INFINITE_MAX,ut=f.INFINITE_MAX;export{Ft as A,vt as B,Ut as C,At as D,Lt as G,xt as H,Ht as J,bt as L,Q as M,Ct as O,wt as P,Qt as Q,j as U,g as V,a as W,F as Z,Dt as a,Pt as b,I as c,f as d,X as f,et as h,pt as i,Vt as k,nt as l,Ot as o,ct as p,Xt as q,rt as r,gt as t,lt as u,k as v,dt as w,yt as x,Rt as y,qt as z};
