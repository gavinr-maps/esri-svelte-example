const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./OrientedImageryViewerViewModelAdapter2D-sfH-nnhl.js","./geometry-D964gYQX.js","./subclass-BZA_h8Db.js","./Extent-Bf3YTe7m.js","./tslib.es6-B3Jf3DVX.js","./Point-Cg0-ChZE.js","./Accessor-BLX9ikPh.js","./cast-Bjksrh93.js","./writer-DNAwXnhG.js","./assets-C43MgM-v.js","./index-Bh2oEzTI.js","./index-2kwcjS9-.css","./jsonMap-0cxwUWs2.js","./Polyline-D9YkgmM_.js","./mathUtils-C4_ghTv4.js","./Graphic-DsxsIjhH.js","./PopupTemplate-BHMhS05j.js","./Clonable-D3rtuBWg.js","./Collection-CEdjem1-.js","./Evented-BHRw9x22.js","./shared-B3wH2qpO.js","./SimpleObservable-KocWTzVy.js","./fieldUtils-tmQlKvWo.js","./intl-CChhNOV8.js","./date-DlqISzcw.js","./locale-C9TlLpzi.js","./messages-OmQvZhAg.js","./enumeration-Ba5njXdz.js","./Color-BCS62Hs5.js","./colorUtils-0bJDPow9.js","./ActionToggle-iT4slXc7.js","./Identifiable-B1UbsKNt.js","./symbols-CNimns--.js","./TextSymbol-D8QO_KUV.js","./screenUtils-_ZIvrt5o.js","./materialUtils-DarhapKC.js","./opacityUtils-C68Tlu6_.js","./vec3f64-BLpZdpfb.js","./aaBoundingBox-BE7cC1jD.js","./persistableUrlUtils-fa1mAujs.js","./collectionUtils-D_lHIu88.js","./Portal-C10FKnaA.js","./Loadable-BabW5Xcc.js","./Promise-B2Hu02L7.js","./reactiveUtils-C5zUhJQJ.js","./asyncUtils-CWX51uTe.js","./jsonUtils-CEfjT-BK.js","./a11yUtils-cyWndM8Q.js","./languageUtils-JGnUBrxZ.js","./TimeOnly-DOn_Hy89.js","./UnknownTimeZone-BkowvBs8.js","./ImmutableArray-BPVd6ESQ.js","./shared-OyXfj1UM.js","./Field-ybkHhtnK.js","./fieldType-BuzM0UHS.js","./number-CUaGJe2K.js","./Query-5Xpquc1r.js","./DataLayerSource-BKkswDvG.js","./FullTextSearch-Csd1Hktu.js","./TimeExtent-DocT5yPf.js","./timeUtils-8fb_2oAt.js","./mat3f64-BBpwCtoL.js","./mat4f64-Dk4dwAN8.js","./vec4f64-o2zAXfmz.js","./mat3-BRl2i9Bz.js","./common-DQOJ18NT.js","./mat4-GpOFENPA.js","./vec32-Dvg_eL9J.js","./projection-B971H0Re.js","./projectBuffer-Bs7GwaPY.js","./geodesicConstants-DWQLYX7F.js","./vec3-kbEkneOB.js","./OrientedImageryLayer-FvdgKh0J.js","./FeatureLayer-wa_7EIxE.js","./ClassBreaksRenderer-BuHwSyVK.js","./UniqueValueRenderer-BQtAHUSo.js","./diffUtils-BP7jmOAy.js","./colorRamps-pKd7I5WZ.js","./SizeVariable-936USOrb.js","./sizeVariableUtils-Cmcuvw-4.js","./visualVariableUtils-DX1kS9Se.js","./compilerUtils-Dw3R0f-Z.js","./lengthUtils-DL1-FDQQ.js","./ColorStop-Dk3U5tCk.js","./jsonUtils-Ds2Sqto-.js","./layerUtils-BrNoooE9.js","./defaults-DZ1kfMRx.js","./defaultsJSON-GKolV7NZ.js","./RendererLegendOptions-B-4se3aU.js","./styleUtils-BYTm14n3.js","./jsonUtils-DxpLMo6d.js","./LRUCache-B_PHMSGm.js","./MemCache-Dx1v3xLC.js","./Version-BSlAgupz.js","./FieldsIndex-DpwHKAMX.js","./OverrideHelper-ti072FkP.js","./colorUtils-aL8wj-8G.js","./vec42-YcqnINSP.js","./utils-D2PLyMFF.js","./enums-CmIX1y88.js","./quantizationUtils-uj_P09aO.js","./HeatmapColorStop-BJc5nbwr.js","./heatmapUtils-Dwiv9IEa.js","./SimpleRenderer-BV2L9G_n.js","./MultiOriginJSONSupport-B5nfqtQh.js","./layerContainerType-C5CzMsLd.js","./FeatureLayerBase-Ck7-w8TE.js","./formUtils-ylzKAM7E.js","./HeightModelInfo-9nOoV6LU.js","./arcgisLayerUrl-BX1FE5Hm.js","./commonProperties-CPyIG_-u.js","./ElevationInfo-CA5m_tHv.js","./unitConversionUtils-BMfW9yAe.js","./AttributeTableTemplate-BZeVyq-j.js","./featureLayerUtils-DBsQMhTm.js","./featureQueryAll-DnVoEjkM.js","./AttachmentQuery-BUlkjzkx.js","./RelationshipQuery-DPPNeuLK.js","./LayerFloorInfo-CIQjg5Vk.js","./Relationship-COPq3qM4.js","./serviceCapabilitiesUtils-DAE5z8FP.js","./Layer-CVt7Hb5J.js","./workers-D4HfeYKj.js","./Queue-yu3bZ02p.js","./editsZScale-Bs7_pSzI.js","./queryZScale-w66xFVGx.js","./FeatureSet-BHEkYP03.js","./APIKeyMixin-Di9kcRBS.js","./ArcGISService-B5qxetOY.js","./BlendLayer-CXM4n_Ge.js","./jsonUtils-CSnQD004.js","./parser-CTsgEym6.js","./utils-93yNk4Xc.js","./mat4f32-DcsiF_Rp.js","./CustomParametersMixin-B4u7wiBT.js","./EditBusLayer-DoTks2sU.js","./uuid-fwrPAdZb.js","./FeatureEffectLayer-CpM66wLd.js","./FeatureEffect-BEzQmzeC.js","./FeatureFilter-BMHRQSxq.js","./FeatureReductionLayer-Ddbk727V.js","./FeatureReductionSelection-7vaL4DYT.js","./labelingInfo-DYPSPZCH.js","./labelUtils-B8petyBk.js","./MD5-C9MwAd2G.js","./OperationalLayer-CVyVfSPu.js","./OrderedLayer-C5VLMHgA.js","./OrderByInfo-IYmS1EXF.js","./PortalLayer-CKja4bdW.js","./PortalItem-DzgXrpyc.js","./portalItemUtils-BzVoFAku.js","./RefreshableLayer-D7lXUJRS.js","./ScaleRangeLayer-Bb8Ig1Hz.js","./TemporalLayer-Dpq2hKKV.js","./TimeInfo-LUiaSFyX.js","./TimeInterval-CNlkea1s.js","./FeatureTemplate-CssMa1yk.js","./FeatureType-C0q_coeM.js","./fieldProperties-Cgxj08ZE.js","./versionUtils-CQ_WhYSP.js","./styleUtils-KMFBtb6u.js","./popupUtils-BBuPGAHd.js","./AlphaCutoff-UcccL64p.js","./interfaces-CL2NbQte.js","./ElevationLayer-C0JivL99.js","./ArcGISCachedService-gctVQNPc.js","./TileInfo-Dphjf6xH.js","./TileKey-DZd6gJy7.js","./TileInfoTilemapCache-BBp-yLg6.js","./TilemapCache-BatDkYWf.js","./ByteSizeUnit-BsxeN7wM.js","./LercDecoder-fMWPataJ.js","./WorkerHandle-T1sH-Myb.js","./ImageryLayer-k0hk8j3B.js","./RasterPresetRendererMixin-CljoEFVM.js","./multidimensionalUtils-CN2uYHlv.js","./dataUtils-CRhrrZcr.js","./pixelRangeUtils-DHjFxYEg.js","./RasterSymbolizer-zx8ns-Zp.js","./_commonjsHelpers-DCkdB7M8.js","./ClassBreaksDefinition-CS8Z_VNX.js","./utils-6jMaHUrH.js","./normalizeUtils-EVmAQ-ak.js","./normalizeUtilsCommon-dT81xWiM.js","./utils-Bema0iXE.js","./utils-Ce7L3imC.js","./cimSymbolUtils-DXvZxabN.js","./imageBitmapUtils-aMNhrXcv.js","./executeForIds-BCHBDnMa.js","./query-Dw-gv3BA.js","./pbfQueryUtils-B0fU-MiS.js","./pbf-BtDZ1BpD.js","./OptimizedGeometry-BF8iz5FO.js","./OptimizedFeature-6cJ-QFG5.js","./OptimizedFeatureSet-Blu9Ckm7.js","./executeQueryJSON-Cis2sczl.js","./ImageryTileLayer-CrZZDmaF.js","./RawBlockCache-CyrDUJq2.js","./rasterProjectionHelper-Cyb7j9c9.js","./QueueProcessor-DZiVr5XH.js","./ReactiveMap-6CfRGOlR.js","./signal-D4lghLjV.js","./GCSShiftTransform-DL7f-AoC.js","./ElevationSamplerData-DF8Bl6I9.js","./ElevationTile-F2xXmLtF.js","./requestPresets-B-6DU6iY.js","./jsxFactory-CJa39Fro.js","./UpdatingHandles-GfwcIh5z.js","./geometryEngineAsync-Bu-rYQUP.js","./GraphicsLayer-i3FeUJ_n.js","./GraphicsCollection-FfahqxsR.js","./Circle-BInHZHdw.js","./geodesicUtils-FCYOaNwu.js","./Mesh-Dq3yHM_F.js","./axisAngleDegrees-Ci2HA7Jo.js","./quat-4pa1e6ds.js","./quatf64-CCm9z-pX.js","./MeshComponent-C3VFvn4B.js","./imageUtils-CtmzXUTE.js","./meshProperties-C4iW0Ukm.js","./MeshLocalVertexSpace-LEHwMUnu.js","./MeshTransform-D2t3aEmK.js","./MeshVertexAttributes-BgxxMxrG.js","./meshVertexSpaceUtils-CXzOFlTI.js","./triangulationUtils-DWWEtF_0.js","./earcut-Lltz9D9k.js","./Indices-DflDlU4Z.js","./plane-IENfwZlB.js","./vec2f64-miziP1SN.js","./mathUtils-BG-eq9fO.js","./deduplicate-DIJK2kGw.js","./projectPointToVector-GINIbYMz.js","./vertexSpaceConversion-CPh5QK5U.js","./spatialReferenceEllipsoidUtils-DBE_OFra.js","./computeTranslationToOriginAndRotation-Q27G6TBL.js","./BufferView-_QDXRCew.js","./vec2-maR1OrZI.js","./vec4-BpYqBTK4.js","./External-B2-Xb0PD.js","./infoFor3D-C0hFfS1m.js","./lineSegment-D7sKPPYf.js","./sphere-C77djCO6.js","./deepClone-CWS5qiGp.js","./floorFilterUtils-DZ5C6FQv.js","./drawUtils-D0InE6Wy.js","./InputManager-Ba9xzDpe.js","./Viewpoint-C4FqWA2d.js","./Cyclical-oTUX3aX7.js","./ShadowCastAccumulate.glsl-BNKV7IEU.js","./LineCallout.glsl-C1R4fy2f.js","./RibbonLine.glsl-BZu1FDpE.js","./dehydratedFeatureUtils-B--Sgpdi.js","./ViewingMode-Dodu7ZZk.js","./intersectorUtils-BK9EUwUf.js","./boundedPlane-EV1sS2Ke.js","./verticalOffsetUtils-BDQLpfho.js","./orientedBoundingBox-DOAJUK5g.js","./ElevationProvider-C95wyCKc.js","./VertexAttribute-Cq4MnHjR.js","./hydratedFeatures-DBKLr8hT.js","./projectVectorToVector-G2uWGoIb.js","./Material-_xx7OZxD.js","./interfaces-DDtDqZYj.js","./Texture-Fac_8AOC.js","./BindType-BmZEZMMh.js","./Util-BIfApRF5.js","./Texture-Begq2x5n.js","./enums-D9v74xTE.js","./renderState-DQLu6AJX.js","./Matrix3DrawUniform-CiBFaSz6.js","./ShaderTechniqueConfiguration-CBbn2DCi.js","./triangle-PTGDC_xJ.js","./requestImageUtils-DgMiQwsm.js","./sdfPrimitives-CUWZbMRe.js","./vec3f32-nZdmKIgz.js","./doublePrecisionUtils-B0owpBza.js","./floatRGBA-CfH_2xsy.js","./Octree-C8d4sqjv.js","./frustum-CQrOepbv.js","./InterleavedLayout-e-di2fxs.js","./Float4DrawUniform-N58YDhuZ.js","./graphicUtils-CWEFaVJb.js","./VertexColor.glsl-_ARMpsAT.js","./vec2f32-BbH2jxlN.js","./dehydratedFeatures-BiOblf0d.js","./featureConversionUtils-D14h8iad.js","./edgeUtils-BUKTgPFR.js","./DecodeSymbolColor.glsl-BPIX0fAF.js","./RealisticTree.glsl-CAmeC2w1.js","./DefaultMaterial-DgOvtNL9.js","./Scheduler-CJu5awNf.js","./debugFlags-BF6Z0j0F.js","./RenderCoordsHelper-C50UGjbb.js","./projectVectorToPoint-DcLtSZYw.js","./scaleUtils-D_Nw3nhM.js","./DefaultUI-C0utm694.js","./Map-iWpb5DpI.js","./Basemap-DVYOaWHz.js","./loadAll-B6mYSptb.js","./writeUtils-Dz7BsE1e.js","./Ground-CAIVlzbd.js","./CollectionFlattener-CQN6i8ZK.js","./editableLayers-Cn9dHzhB.js","./catalogUtils-DyGHPM81.js","./basemapUtils-B9TjOm47.js","./TablesMixin-5umgS75f.js","./selectionUtils-DYi6daQO.js","./IViewEvents-Bci6PjlS.js","./interfaces-D6pIddIh.js","./screenUtils-WcqhHU65.js","./heightModelInfoUtils-C6gW75mB.js","./HighlightDefaults-D4ckYWWJ.js","./capabilities-A2uoe7dc.js","./themeUtils-C3zvZbsE.js","./globalCss-CZa70j6i.js","./accessibleHandler-hWbBTR_7.js","./CompassViewModel-C7G3VWNL.js","./utils-DsJqvptN.js","./GoTo-Wtu9mgoE.js","./NavigationToggle-BIWeotJk.js","./ZoomViewModel-oUfjVFgI.js","./viewpointUtils-Bq9TFP4R.js","./earthUtils-ByXwmaX5.js","./spatialReferenceSupport-yRFduOSO.js","./terrainUtils-CPZNZdjg.js","./OverlayCompositing.glsl-CiE3Tt8y.js","./MergedRenderer-Dli9s1X5.js","./VertexArrayObject-lPxPk5E-.js","./NestedMap-GuqgquCN.js","./glUtil-D0YUa0ow.js","./VertexElementDescriptor-BOD-G50G.js","./weather-eV4wTXCK.js","./BufferObject-BVi1lwBq.js","./Intersector-wXoCuQ8W.js","./Program-mfcb06fW.js","./ShadowCastVisualizeTechniqueConfiguration-Bb-Uir0o.js","./Environment-BDo9QJi6.js","./Compositing.glsl-DMM7CJmu.js","./Blit-B-VutIER.js","./unitFormatUtils-CZ2bRlFg.js","./quantityUtils-D0GB2dMc.js","./ZoomMomentumEstimator-DA-HeSfK.js","./HUDMaterial.glsl-D6WRipwF.js","./labelFormatUtils-DFKxfrJb.js","./NormalUtils.glsl-DwmdcsLR.js","./fontUtils-BKHqaMFz.js","./LodRenderer-EVrH9dsH.js","./Intersector-BQ92CPLA.js","./FeaturePipelineRenderManager-DjjUkvYY.js","./elevationInfoUtils-BC_66_Fg.js","./ElevationQueryTileCache-D4sXpJpw.js","./LayerConstants-B33OP6sh.js","./intersectorUtilsConversions-D_fcRVdX.js","./ElevationRange-BrgM1moX.js","./hitTestSelectUtils-UXJPjatw.js","./vec33-DUxPafiq.js","./Normals-DzBXR8Bg.js","./TileStrategy-DT04gaWW.js","./TileKey-Cs1awCRX.js","./RenderableTile-Dl7jrqnB.js","./config-MDUrh2eL.js","./StyleDefinition-BTt_i6C1.js","./enums-BRzLM11V.js","./GeometryUtils-Dyjqugo6.js","./DefaultVertexAttributeLayouts-PrbBmwty.js","./DisplayObject-DGZ6h7sV.js","./resources-CLJpJAXm.js","./ShaderTechniqueRepository-hTzew41Z.js","./testSVGPremultipliedAlpha-uTaDUvFS.js","./RenderingContext-C2W2PIoX.js","./ProgramCache-BcuuBWLJ.js","./layerViewUtils-DhFEu8Rd.js","./vmEvent-D4Ubqkbq.js","./MapView-C1_P4WdJ.js","./viewpointUtils-CRlgks6_.js","./mat2d-D9DBP-jx.js","./mat2df64-CBKYtunK.js","./mat2df32-orApM5a3.js","./unitBezier-BX6NeAEr.js","./Tile-Bf5TzhCn.js","./quickselect-QQC62dOK.js","./definitions-DfvbPdMm.js","./utils-BpB3MnW1.js","./ColorBackground-CfloAtNa.js","./geometryEngine-DGiYLHJy.js","./geometryEngineBase-yFIvKOkM.js","./hydrated-C9rxSL4a.js","./LayerList-Cpdm3a8u.js","./LayerListItem--SL5CZeX.js","./actionUtils-ClPpuZ4c.js","./layerListUtils-Cb_jjipP.js","./LayerListViewModel-C5g5Lp46.js","./utils-BQBvadb7.js","./ListItem-D2lt9R2a.js","./widget-DwhGPDuv.js","./listUtils-vswmtyNy.js","./OrientedImageryViewerViewModelAdapter3D-Bz4D3Ick.js","./calcite-list-C4jOVpC-.js","./dom-D_AJDzAj.js","./interactive-y84HQRWL.js","./observers-D2xgmA06.js","./resources4-DXHY1U7R.js","./utils3-BrU6GrkI.js","./loadable-DM18hPdE.js","./t9n-D0ry3MEw.js","./locale-A4FuYD8q.js","./key-D63ExP77.js","./filter-yN6-jZOU.js","./debounce-BOqmhDXu.js","./icon-BQO9J86c.js","./input2-BReyTnf4.js","./form-BZPQ5PUM.js","./label-DEe8AW1C.js","./component-6CIDVndn.js","./Validation-Bz9yoU6e.js","./input-j1u1wOBY.js","./input-message-CWvsvdFk.js","./progress-BXyickl_.js","./loader-C-zIPscB.js","./scrim-DPa2aeKh.js","./calcite-list-item-vbKS6alm.js","./action-D0Er9Ef6.js","./handle-Ct1HP3bl.js","./calcite-panel-qSfJTr42.js","./panel-BdAbXPwM.js","./action-menu-C6uYzPu-.js","./array-BMcQdnYi.js","./popover-Q5ruM4hh.js","./floating-ui-Bma_zPVt.js","./focusTrapComponent-BSUg_DLj.js","./openCloseComponent-CmOrfBN-.js","./Heading-D7P0OjYI.js","./FloatingArrow-BBdsG5MP.js","./calcite-switch-CkUGVtze.js","./switch-Drd7BD6R.js","./calcite-action-bar-pMVRYUJz.js","./conditionalSlot-R5D9krYS.js","./ExpandToggle-D9_knjDY.js","./action-group-BJ76kEtf.js","./calcite-action-group-Dp-CUDEe.js","./calcite-action-Bys6x4p_.js","./calcite-label-B1FxWqaL.js","./calcite-notice-DSp0z_Oh.js","./resources2-DjkgwdyM.js","./calcite-slider-GqQeL3Ah.js","./math-CPc4dlb6.js","./calcite-tooltip-rE_jVYtd.js"])))=>i.map(i=>d[i]);
import{_ as ee}from"./index-Bh2oEzTI.js";import{r as l}from"./tslib.es6-B3Jf3DVX.js";import{s as Xi}from"./intl-CChhNOV8.js";import{o as ea}from"./a11yUtils-cyWndM8Q.js";import{c as oe,G as Ee,U as ta,s as ce,q as re,e as we,Y as Ve,b as ia}from"./Accessor-BLX9ikPh.js";import{n as N,b as se,a as ie,m as c,J as aa,S as Vt,v as Tt,O as Lt}from"./subclass-BZA_h8Db.js";import{M as pe,s as q,r as Me}from"./mathUtils-C4_ghTv4.js";import{watch as x,syncAndInitial as k,sync as ra,when as oa,initial as Le,on as sa,whenOnce as na,once as la}from"./reactiveUtils-C5zUhJQJ.js";import"./geometry-D964gYQX.js";import{z as Et}from"./languageUtils-JGnUBrxZ.js";import{U as ri,a as mt,f as oi}from"./assets-C43MgM-v.js";import{e as Qe}from"./mat3f64-BBpwCtoL.js";import{e as ut,t as ca}from"./mat4f64-Dk4dwAN8.js";import{u as ha}from"./vec4f64-o2zAXfmz.js";import{c as P,n as wt,t as da}from"./vec3f64-BLpZdpfb.js";import{u as si,i as ma}from"./mat3-BRl2i9Bz.js";import{e as ni,J as ua}from"./mat4-GpOFENPA.js";import{R as W,u as te,p as pa}from"./vec32-Dvg_eL9J.js";import{I as de,o as ga}from"./projection-B971H0Re.js";import{j as T,g as X,O as li,t as _t,R as pt,ay as ya,z as kt}from"./Point-Cg0-ChZE.js";import{i as va}from"./vec3-kbEkneOB.js";import{a as Ht,l as bt,c as ci,D as fa,n as wa,s as zt,b as _a,P as ba,f as hi,d as Ma,S as Ia}from"./OrientedImageryLayer-FvdgKh0J.js";import{o as Fa,v as me,u as di,d as Ca,c as Oa}from"./Polyline-D9YkgmM_.js";import $a from"./ElevationLayer-C0JivL99.js";import Pa from"./ImageryLayer-k0hk8j3B.js";import{J as xa,u as Sa}from"./ImageryTileLayer-CrZZDmaF.js";import{c as Ra}from"./ElevationSamplerData-DF8Bl6I9.js";import{t as Aa}from"./ElevationTile-F2xXmLtF.js";import{a as Va}from"./LercDecoder-fMWPataJ.js";import{N as mi}from"./RasterPresetRendererMixin-CljoEFVM.js";import{z as ui}from"./TileInfo-Dphjf6xH.js";import{t as Ta}from"./TileKey-DZd6gJy7.js";import"./normalizeUtilsCommon-dT81xWiM.js";import{w as La}from"./Extent-Bf3YTe7m.js";import{t as Ea}from"./requestPresets-B-6DU6iY.js";import{B as Je,n as b,r as pi,e as Nt}from"./jsxFactory-CJa39Fro.js";import{d as B}from"./Graphic-DsxsIjhH.js";import{k as Mt,l as It,w as gi,H as ka,I as Ha,d as za}from"./symbols-CNimns--.js";import{d as Oe}from"./asyncUtils-CWX51uTe.js";import{V as D}from"./Collection-CEdjem1-.js";import{o as Ft}from"./Evented-BHRw9x22.js";import{m as Na}from"./Promise-B2Hu02L7.js";import{s as Ga}from"./ReactiveMap-6CfRGOlR.js";import{r as Gt}from"./fieldUtils-tmQlKvWo.js";import{h as Da}from"./UpdatingHandles-GfwcIh5z.js";import{union as Ba}from"./geometryEngineAsync-Bu-rYQUP.js";import Ct from"./GraphicsLayer-i3FeUJ_n.js";import{i as yi}from"./Clonable-D3rtuBWg.js";import{s as Wa}from"./cast-Bjksrh93.js";import{r as vi}from"./enumeration-Ba5njXdz.js";import{o as Y,r as Dt}from"./writer-DNAwXnhG.js";import{b as ja}from"./Query-5Xpquc1r.js";import{b as gt}from"./Circle-BInHZHdw.js";import{$ as ke}from"./Mesh-Dq3yHM_F.js";import{m as fi}from"./lineSegment-D7sKPPYf.js";import{f as qa,a as Za,w as Ua}from"./MeshComponent-C3VFvn4B.js";import{p as Ot}from"./MeshVertexAttributes-BgxxMxrG.js";import{w as wi,M as Qa,A as Bt,p as je,k as _i}from"./plane-IENfwZlB.js";import{O as Ja,S as Ya,q as Ka,F as Xa}from"./sphere-C77djCO6.js";import{f as er}from"./deepClone-CWS5qiGp.js";import{o as tr}from"./floorFilterUtils-DZ5C6FQv.js";import{c as ir}from"./AttachmentQuery-BUlkjzkx.js";import{s as ar}from"./drawUtils-D0InE6Wy.js";import{_ as rr}from"./InputManager-Ba9xzDpe.js";import{d as bi}from"./Viewpoint-C4FqWA2d.js";import{n as Ye}from"./ShadowCastAccumulate.glsl-BNKV7IEU.js";import{b as or}from"./Ground-CAIVlzbd.js";import{L as Mi}from"./Map-iWpb5DpI.js";import{n as sr}from"./jsonMap-0cxwUWs2.js";import{p as nr}from"./DefaultUI-C0utm694.js";import lr from"./ZoomViewModel-oUfjVFgI.js";import{e as Ke}from"./globalCss-CZa70j6i.js";import{e as Ii}from"./vmEvent-D4Ubqkbq.js";import{y as $t,S as Fi,d as cr}from"./TextSymbol-D8QO_KUV.js";import{p as Ci}from"./MapView-C1_P4WdJ.js";import{rotate as tt,intersect as hr,nearestCoordinate as dr}from"./geometryEngine-DGiYLHJy.js";import{g as Wt}from"./GCSShiftTransform-DL7f-AoC.js";import{c as mr}from"./viewpointUtils-CRlgks6_.js";import{s as ur}from"./Identifiable-B1UbsKNt.js";import pr from"./LayerList-Cpdm3a8u.js";import{v as gr}from"./LayerListViewModel-C5g5Lp46.js";const jt=120,V=[21,36,51,60],yr=3.5,it=["FAR_WEST","FAR_NORTH","FAR_EAST","FAR_SOUTH","WEST","NORTH","EAST","SOUTH","NEAR_WEST","NEAR_NORTH","NEAR_EAST","NEAR_SOUTH"],ne=23.937554159486076,le=96.06244584051393,at={EAST:[ne,ne,le,ne,60,ne],NORTH:[ne,le,ne,ne,ne,60],SOUTH:[le,ne,le,le,le,60],WEST:[le,le,ne,le,60,le]},qt=-999;function vr(e){return(e==null?void 0:e.type)==="3d"}function fr(e){return(e==null?void 0:e.declaredClass)==="esri.Graphic"}function Zt(e){if(!e||!URL.canParse(e))return!1;const{pathname:t}=new URL(e);return/.*\.(tiff|tif|mrf)$/i.test(t??"")}function wr(e){return Math.abs(e)>=135?"WEST":e<-45&&e>-135?"SOUTH":e<=45?"EAST":"NORTH"}function _r(e,t){const i=e/t*V[2];return i<=V[0]?"NEAR":i<=V[1]?"":"FAR"}function br(e){return e&&e.url&&e.datasetFormat?e:null}function Mr(e){return typeof e=="string"&&e.length?e:br(e)}const Ir=e=>t=>t.layer===e;function Fr(e){return(e==null?void 0:e.name)==="NoAttachmentError"}const Oi=e=>`${e}:missing-property`,$i=(e,t)=>`Property ${t} is missing in ${e}`,qe=(e="esri.widgets.OrientedImageryViewer",t)=>{throw N.getLogger(e).error(t),t},Cr=async(e,t)=>{var i;try{const a=await ri(e,{...t,method:"head"});return(i=a==null?void 0:a.getHeader)==null?void 0:i.call(a,"Content-Type")}catch(a){return N.getLogger("esri.widgets.OrientedImagery").error("failed to fetch Content-Type",a),null}};function Or(e){return e.type==="feature"}async function $r(e,t,i){if(!t.extent||!t.url)throw qe("esri.layer.orientedImagery.transformations",new se("update-elevation:missing-property","both extent and url are required to create a sampler",t));const a=await Pt(t);if(!a)throw qe("esri.layers.orientedImagery.transformations",new se("update-elevation:elevation-source","could not create a sampler using provided elevation source",t));return Pi(e,a,i)}async function Pi(e,t,i){await Ee(i);const a=Rr(t,i),r=Array.isArray(e)?e:[e];return await Promise.all(r.map(a))}var Ie;(function(e){e[e.DYNAMIC=0]="DYNAMIC",e[e.ELEVATION=1]="ELEVATION",e[e.IMAGE=2]="IMAGE"})(Ie||(Ie={}));const Pt=async(e,t)=>{let i;const{extent:a,rasterFunction:r,url:o,lod:s}=e;try{i=await Sr(o)}catch(n){if(oe(n))return;N.getLogger("esri.layers.orientedImagery.transformations").error("updateElevationUsingElevationSource",n)}switch(i){case Ie.DYNAMIC:return await xr(o,a,r,t);case Ie.ELEVATION:return await Pr(o,a,s,t);default:return}};async function Pr(e,t,i,a){var s;const r=new $a(e);let o;try{const{tileInfo:n}=await r.load(),h=(i&&((s=n.lodAt(Math.min(n.lods.length-1,i)))==null?void 0:s.resolution))??"finest-contiguous";o=await r.createElevationSampler(t,{...a,demResolution:h})}catch(n){if(oe(n))return;N.getLogger(r).error(n)}finally{r.destroy()}return o}async function xr(e,t,i,a){const r=i?new mi({functionName:i}):void 0,o=new Pa({url:e,rasterFunction:r,format:"lerc"});await o.load(a);let s,n=512,h=512;const d=t.width/t.height;d>1?(h/=d,s=t.height/h):(n*=d,s=t.width/n);const m=await o.fetchImage(t,n,h,a),u=ui.create({scales:[s],size:512,spatialReference:t.spatialReference}),g=new Ta(null,0,0,0,Fa(t)),p=new Va(m.pixelData.pixelBlock.pixels[0],n,h,0),y=new Aa(g,p);return new Ra(y,u,void 0)}async function Sr(e,t){var o;await Ee(t);const i=await Ea(e),{tileInfo:a,cacheType:r}=i;if(!i.hasOwnProperty("bandCount")||!i.hasOwnProperty("pixelSizeX"))throw new se("elevation-source:invalid-service-url",`ElevationSource URL expects an elevation 3D image service but given ${e}`);return a?((o=a==null?void 0:a.format)==null?void 0:o.toUpperCase())!=="LERC"||r&&r.toLowerCase()!=="elevation"?Ie.IMAGE:Ie.ELEVATION:Ie.DYNAMIC}function Rr(e,t){return async i=>{let a=i.clone();const r=i.spatialReference.equals(e.spatialReference)?a:await de(i,e.spatialReference,t),o=e.queryElevation(r);return o&&(a=i.spatialReference.equals(e.spatialReference)?o.clone():await de(o,i.spatialReference,t)),a.z=a.z??1,a}}async function Ar(e,t,i){return await Ee(i),e.map(a=>(a.z=t,a))}const xt=new T({x:0,y:0,z:0,spatialReference:X.WebMercator}),Ze=1e3,Vr=114,Tr=120,Lr=50;function Te(e,t,i){const[a,r,o,s]=t,[n,h,d,m]=i;Ut(a,r,o,s);const u=Ut(n,h,d,m),g=Qt(a,r,o,s),p=Qt(n,h,d,m),y=ni(ut(),g),f=ua(ut(),y,p),[v,w,_,M]=kr(e,f);return[v/M,w/M,u?0:_/M]}function Ut(e,t,i,a){return e[2]===0&&t[2]===0&&i[2]===0&&a[2]===0&&(e[2]=t[2]=i[2]=a[2]=1,!0)}function Er(e){return e===0?1:e}function kr(e,t){const[i,a,r]=e,o=[0,0,0,0];return o[0]=i*t[0]+a*t[1]+r*t[2]+t[3],o[1]=i*t[4]+a*t[5]+r*t[6]+t[7],o[2]=i*t[8]+a*t[9]+r*t[10]+t[11],o[3]=Er(i*t[12]+a*t[13]+r*t[14]+t[15]),o}function Qt(e,t,i,a){const r=Hr(ha([...a,1]),ni(new Array(16),ca(e[0],t[0],i[0],0,e[1],t[1],i[1],0,e[2],t[2],i[2],0,1,1,1,1))),o=r[0],s=r[1],n=r[2],h=ut();return h[0]=o*e[0],h[1]=s*t[0],h[2]=n*i[0],h[3]=0,h[4]=o*e[1],h[5]=s*t[1],h[6]=n*i[1],h[7]=0,h[8]=o*e[2],h[9]=s*t[2],h[10]=n*i[2],h[11]=0,h[12]=o,h[13]=s,h[14]=n,h[15]=1,h}function Se(e,t,i,a,r=P()){return r[0]=e[0]+t[0]*i,r[1]=e[1]+t[1]*i,r[2]=e[2]+t[2]*(i/a),r}function E(e,t,i){const a=P();return a[0]=e[0]*t,a[1]=e[1]*t,a[2]=e[2]*(t/i),a}function ye(e,t){const[i,a,r]=e,o=P();return o[0]=i*t[0]+a*t[3]+r*t[6],o[1]=i*t[1]+a*t[4]+r*t[7],o[2]=i*t[2]+a*t[5]+r*t[8],o}function Hr(e,t){const[i,a,r,o]=e,s=new Array(4);return s[0]=i*t[0]+a*t[1]+r*t[2]+o*t[3],s[1]=i*t[4]+a*t[5]+r*t[6]+o*t[7],s[2]=i*t[8]+a*t[9]+r*t[10]+o*t[11],s[3]=i*t[12]+a*t[13]+r*t[14]+o*t[15],s}function zr(e,t,i,a=!0){if(!Number.isFinite(e))throw new se("InvalidRotationAngle","Please specify a valid angle for rotation");const r=i*(a?q(e):e),o=Math.cos(r),s=Math.sin(r),n=Qe();switch(t){case 0:n[4]=o,n[5]=-s,n[7]=s,n[8]=o;break;case 1:n[0]=o,n[2]=s,n[6]=-s,n[8]=o;break;case 2:n[0]=o,n[1]=-s,n[3]=s,n[4]=o;break;default:throw new se("InvalidRotationAxis","Please specify either 0, 1 or 2 for X, Y or Z axis respectively")}return n}const xi={HPR:[[2,-1],[0,1],[2,-1]],OPK:[[0,1],[1,1],[2,1]]};function Si(e,t,i=!0){if((e==null?void 0:e.length)!==3||(t==null?void 0:t.length)!==3)throw new se("InvalidRotationAngles","Please specify three angles with config for rotation");const a=Qe();for(let r=0;r<3;r++){const[o,s]=t[r],n=zr(e[r],o,s,i);ma(a,n,a)}return a}function Nr(e,t=!0){return Si(e,xi.OPK,t)}function yt(e,t=!0){return Si(e,xi.HPR,t)}function Ri(e,t,i){const a=Math.sin(q(i)),r=Math.cos(q(i)),o=[[e,0],[e,t],[0,t]];o.forEach((n,h)=>{o[h]=[r*n[0]-a*n[1],a*n[0]+r*n[1]]});const s={xmin:Math.min(0,o[0][0],o[1][0],o[2][0]),xmax:Math.max(0,o[0][0],o[1][0],o[2][0]),ymin:Math.min(0,o[0][1],o[1][1],o[2][1]),ymax:Math.max(0,o[0][1],o[1][1],o[2][1])};return{hfov:Math.abs(s.xmax-s.xmin),vfov:Math.abs(s.ymax-s.ymin)}}function Gr(e,t){const i=Number(e[0]),a=Number(e[1]),r=Number(e[2]),[o,s,n,h]=t,d=q(o),m=q(s),u=n/Math.sqrt(1-h*Math.sin(d)**2),g=i/u,p=a/u,y=r/u,f=Math.cos(d)-Math.sin(d)*p+Math.cos(d)*y,v=Math.sin(d)+Math.cos(d)*p+Math.sin(d)*y,w=Math.sqrt(f**2+g**2),_=h*u*Math.sin(d),M=(A,G=5)=>{if(G===0)return A;const L=M(A,G-1);return Math.atan(v/w-(_-h*(n/Math.sqrt(1-h*Math.sin(L)**2))*Math.sin(L))/(u*w))},I=M(d),$=Math.atan(i/(u*f))+m,R=pe(I);return[pe($),R,i/(Math.cos(I)*Math.sin($-m))-n/Math.sqrt(1-h*Math.sin(I)**2)]}function Be(e,t,i){const a=360/t,r=180/i;return{heading:(e.x-t/2)*a,pitch:90-(e.y-i/2)*r}}function Dr(e,t,i,a=Ze/2){const{heading:r,pitch:o}=Br(e,a);return Ai(r,o,t,i)}function Ai(e,t,i,a){return{x:i/2+e/(360/i),y:a-t/(180/a),heading:e,pitch:t}}function Br(e,t){const i=pe(Math.acos(-e.z/t));return{heading:pe(Math.atan2(e.x,e.y)),pitch:i}}function We(e,t,i=Ze/2){return[i*(Math.sin(q(e))*Math.sin(q(t))),i*(Math.cos(q(e))*Math.sin(q(t))),i*Math.cos(q(180-t))]}async function Wr(e,t,i){const a=await de(t,e.spatialReference,i);let r=pe(Math.atan2(a.y-e.y,a.x-e.x));return r=r>=0&&r<=90?90-r:r>90&&r<=180?360-r+90:90+Math.abs(r),r}function Ge(e,t,i){const a=Math.cos(i),r=Math.sin(i),o=[1,0,0,1,0,0],s=o[0]*a+o[2]*r,n=o[1]*a+o[3]*r,h=-o[0]*r+o[2]*a,d=-o[1]*r+o[3]*a;return o[0]=s,o[1]=n,o[2]=h,o[3]=d,[e*o[0]+t*o[2]+o[4],e*o[1]+t*o[3]+o[5]]}const ue=e=>e.toArray(),Fe=(...e)=>e.some(t=>t);function jr(e,t){if(Fe(e.length===0,e.some(({x:i,y:a})=>Fe(i==null,a==null)),!t.hasZ))throw new Error("Input pixels must have x, y and camera location must have z value")}function Vi(e,t){if(e.some(i=>i.z==null)||t.z==null)throw new Error("Input points and camera location must have z value")}function Ti(e){if((e==null?void 0:e.length)!==9)throw new Error("Rotation matrix is not provided or is not a valid 3x3 matrix")}function He(e,t){return li(t)?1/Math.cos(Math.PI/2-2*Math.atan(Math.exp(-1*e/_t.radius))):1}const qr=e=>t=>new T(t,e),St=e=>e!=null&&"queryExtent"in e;function Zr(e,t,i,a){return[[-t,-t],[+t,-t],[+t,+t],[-t,+t]].map(([r,o])=>Te(va(P(),i,[r,o,0]),a,e))}function Ur({a0:e,a1:t,a2:i,b0:a,b1:r,b2:o},s,n,h){const d=[e??s/2-.5,t,i??0,a??n/2-.5,r??0,o].map(Qr);return h!=null&&Jr(d)?{affines:d,focalLength:h}:{affines:[s/2-.5,1,0,n/2-.5,0,-1]}}function Qr(e,t){if(e==null)return null;const i=parseFloat(`${e}`);return isNaN(i)?null:i}function Jr(e){return e[1]!=null&&e[5]!=null}function Yr(e,t,i){const{cameraHeight:a,cameraPitch:r,cameraRoll:o,elevation:s,farDistance:n,horizontalFieldOfView:h,location:d,verticalFieldOfView:m}=e,u=s??(d.z??0)-a;return{...Li(e,t,i),averageElevation:u,cameraPitch:r,cameraRoll:o??0,farDistance:n,horizontalFieldOfView:h,verticalFieldOfView:m}}function Kr(e,t,i,a){return ro(a)?Nr([a.omega,a.phi,a.kappa]):oo(a)?yt([a.heading,a.pitch,a.roll]):yt([e,t,i??0])}function Xr(e,t,i){const{cameraHeading:a,cameraHeight:r,elevation:o,farDistance:s,horizontalFieldOfView:n,location:h,verticalFieldOfView:d}=e;return{averageElevation:o??(h.z??0)-r,cameraLocation:h,cameraHeading:a,farDistance:s,horizontalFieldOfView:n,imageHeight:i,imageWidth:t,verticalFieldOfView:d}}function Li(e,t,i){const{a0:a,a1:r,a2:o,b0:s,b1:n,b2:h,cameraHeading:d,cameraOrientation:m,cameraPitch:u,cameraRoll:g,focalLength:p,horizontalFieldOfView:y,location:f,matrix:v,principalX:w,principalY:_,radial:M,tangential:I,verticalFieldOfView:$}=e,{affines:R,focalLength:A}=Ur({a0:a,a1:r,a2:o,b0:s,b1:n,b2:h},t,i,p),G=v??Kr(d,u,g,m),L=w!=null&&_!=null?[w,_]:void 0;return{affineTransformations:(m==null?void 0:m.affineTransformations)??R,cameraLocation:f.clone(),focalLength:(m==null?void 0:m.focalLength)??A,horizontalFieldOfView:y,imageHeight:i,imageWidth:t,principalOffsetPoint:(m==null?void 0:m.principalOffsetPoint)??L,radialDistortionCoefficients:(m==null?void 0:m.radialDistortionCoefficients)??M,rotationMatrix:G,tangentialDistortionCoefficients:(m==null?void 0:m.tangentialDistortionCoefficients)??I,verticalFieldOfView:$}}const Ei=e=>e!=null&&"elevationSample"in e&&e.elevationSample!=null,Rt=e=>bt(e==null?void 0:e.elevationSource)&&(e==null?void 0:e.extent)!=null,eo=e=>ci(e==null?void 0:e.elevationSource),rt=async(e,t)=>t!=null&&(Ei(t)||eo(t))?t:Rt(t)?{elevationSample:await Pt({...mt(t.elevationSource)?t.elevationSource.toJSON():t.elevationSource,extent:t.extent}),elevationSource:new Ht({constantElevation:e})}:{elevationSource:new Ht({constantElevation:e})},to=e=>Et(e==null?void 0:e.heading)&&Et(e==null?void 0:e.pitch),io=(e,t)=>[[-e,-t],[e,-t],[e,t],[-e,t]];function ao(e){const{cameraLocation:t,farDistance:i,horizontalFieldOfView:a,rotationMatrix:r,scalingFactor:o,verticalFieldOfView:s}=e,n=Qe();si(n,r);const h=2*Math.tan(q(s)/2)*i*o,d=2*Math.tan(q(a)/2)*i*o,m=ye([0,0,-1],n),u=Se([t.x,t.y,t.z],m,e.farDistance*o,o),g=ye([0,1,0],n),p=ye([1,0,0],n),y=E(g,h/2,o),f=E(p,d/2,o),v=W(P(),y,f),w=te(P(),y,f);return[te(P(),u,v),te(P(),u,w),W(P(),u,v),W(P(),u,w)]}const ro=e=>(e==null?void 0:e.type)===2,oo=e=>(e==null?void 0:e.type)===1;var Jt;(function(e){e[e.CLOCKWISE=-1]="CLOCKWISE",e[e.COUNTERCLOCKWISE=1]="COUNTERCLOCKWISE"})(Jt||(Jt={}));function ot(e,t,i,a){return[[[i-e/Math.SQRT2,a-e/Math.SQRT2],[i+e/Math.SQRT2,a-e/Math.SQRT2],[i+t/Math.SQRT2,a-t/Math.SQRT2],[i-t/Math.SQRT2,a-t/Math.SQRT2]],[[i+e/Math.SQRT2,a-e/Math.SQRT2],[i+e/Math.SQRT2,a+e/Math.SQRT2],[i+t/Math.SQRT2,a+t/Math.SQRT2],[i+t/Math.SQRT2,a-t/Math.SQRT2]],[[i+e/Math.SQRT2,a+e/Math.SQRT2],[i-e/Math.SQRT2,a+e/Math.SQRT2],[i-t/Math.SQRT2,a+t/Math.SQRT2],[i+t/Math.SQRT2,a+t/Math.SQRT2]],[[i-e/Math.SQRT2,a+e/Math.SQRT2],[i-e/Math.SQRT2,a-e/Math.SQRT2],[i-t/Math.SQRT2,a-t/Math.SQRT2],[i-t/Math.SQRT2,a+t/Math.SQRT2]]]}function st(e,t,i){const[a,r,o,s]=e;return`M ${a.join(" ")} A ${t} ${t} 0 0 1 ${r.join(" ")} L ${o.join(" ")} A ${i} ${i} 0 0 0 ${s.join(" ")} Z`}function so(e,t,i){const[a,r,o,s]=[...e,0];return[...ot(a,r,t,i).map(n=>st(n,a,r)),...ot(r,o,t,i).map(n=>st(n,r,o)),...ot(o,s,t,i).map(n=>st(n,o,s))]}const j="esri-oriented-imagery-viewer",De=`${j}__carousel`,nt=`${j}__image-enhancement`,K=`${j}__navigation`,no="--oi-navigation-tool-rotation-from",lo="--oi-navigation-tool-rotation-to",$e=`${j}__image-overlays`,O={alert:`${j}__alert`,addCoverage:`${j}__body-additional-coverage`,addExpPoints:`${j}__body-additional-camera-locations`,body:`${j}__body`,carousel:`${j}__carousel`,carouselContainer:`${De}-container`,carouselContent:`${De}-content`,carouselItem:`${De}-item`,carouselItemWrapper:`${De}-item-wrapper`,close:`${j}__close`,currentCoverage:`${j}__body-current-coverage`,feature:`${K}-feature`,footprint:`${j}__body-footprint`,imageEnhancementToolContainer:`${nt}-tool-container`,imageEnhancementTools:`${nt}-tools`,imageEnhancementWrapper:`${nt}-wrapper`,imageOverlays:$e,imageOverlaysContainer:`${$e}-container`,imageOverlaysNoResult:`${$e}-no-result`,imageOverlaysIncreasedHeight:`${$e}-increased-height`,imageOverlaysLayerList:`${$e}-layer-list`,messageBox:`${j}__message-box`,navigationPathOffset0:`${K}-feature-path-stop-offset-0`,navigationPathOffset1:`${K}-feature-path-stop-offset-1`,navigationWrapper:`${K}-wrapper`,navigationZoomed:`${K}-wrapper--zoomed`,north:`${K}-pointer-north`,outerSector:`${K}-sector-outer`,overlaysSwitch:`${$e}-switch`,pointer:`${K}-pointer`,rotateWithAnimation:`${K}-animate`,sector:`${K}-sector`,sectorCross:`${K}-sector-cross`,sectorDisabled:`${K}-sector-disabled`,sectorEnabled:`${K}-sector-enabled`,sectorSeparator:`${K}-sector-separator`,selectedFeaturePath:`${K}-feature-path`,submenu:`${j}__submenu`,viewer:`${j}__viewer`,viewerHidden:`${j}__viewer--hidden`,viewerContainer:`${j}__viewer-container`};let vt=class{static getCameraOrientation(e){return fa(e)}static register(e,t,i){wa.set(e,{desc:t,constructor:i})}};vt=l([ie("esri.layers.orientedImagery.core.cameraOrientationFactory")],vt);const co=vt;function ho(e){throw new se("exposure-point:missing-default-value",`a value for ${e} is missing in default properties`)}function mo(e,t){throw new se("exposure-point:missing-attribute-value",`a value for ${e} is missing in attribute table`,{exposurePoint:t})}const _e=e=>({cast:t=>{const i=parseFloat(t);return Number.isFinite(i)?i:void 0},json:{name:e,write:{writer:(t,i,a)=>{i[a]=Number.isFinite(t)?t:void 0}}}}),lt=e=>({cast:t=>typeof t=="string"?t.split(";").map(Number):t,json:{default:e,write:{writer:(t,i,a)=>{i[a]=t==null?void 0:t.join(";")}}}});let F=class extends yi(oi){constructor(t){super(t),this.cameraOrientation=null,this.elevation=null,this.elevationSource=null,this.name=null,this.sourceMap=null}read(t,i){const a={},{attributes:r,layer:o,geometry:s}=t,n={};for(const h in r)a[h.toLowerCase()]=r[h],n[h.toLowerCase()]=h;super.read({geometry:s,layer:o??{},sourceMap:n,...a},i)}write(t,i){const a=super.write(t,i),{sourceMap:r}=this;if(!r||!a)return a;const o={};for(const s in a){const n=r[s.toLowerCase()];n&&(o[n]=a[s])}return o}readCameraHeading(t,i){const{cameraheading:a,camheading:r,layer:o}=i;return a??r??o.cameraHeading}readCameraHeight(t,i){const{cameraheight:a,avghtag:r,layer:o}=i;return a??r??o.cameraHeight}readCamOffset(t,i){const{cameraoffset:a,camoffset:r}=i;return(a==null?void 0:a.split(";").map(Number))??(r==null?void 0:r.split(";").map(Number))??null}writeCameraOffset(t,i){t&&(i.cameraOffset=t.join(";"))}readCameraOrientation(t,i){const{cameraorientation:a,camori:r}=i;return a??r}readCameraPitch(t,i){const{camerapitch:a,campitch:r,layer:o}=i;return a??r??o.cameraPitch}readCameraRoll(t,i){const{cameraroll:a,camroll:r,layer:o}=i;return a??r??o.cameraRoll}readDepthImage(t,i){const{depthimage:a,depthimg:r,layer:o}=i,s=a??r??null,{depthImagePathPrefix:n,depthImagePathSuffix:h}=o??{};return zt(s,n,h)}readElevationSource(t,i){const{elevationsource:a,layer:r}=i,{demPathSuffix:o,demPathPrefix:s}=r;if(a){const n=this._parseIfJSON(a);return _a(n,s,o)}return r.effectiveElevationSource}readFarDistance(t,i){const{fardistance:a,fardist:r,layer:o}=i;return a??r??o.farDistance}readHFOV(t,i){const{horizontalfieldofview:a,hfov:r,layer:o}=i;return a??r??o.horizontalFieldOfView}readImageURL(t,i){const{imagepath:a,layer:r}=i;a||mo("imagePath",this);const{imagePathPrefix:o,imagePathSuffix:s}=r;return zt(a,o,s)}readImageRotation(t,i){const{imagerotation:a,imgrot:r,layer:o}=i;return a??r??o.imageRotation}get isHorizontal(){return this.orientedImageryType==="horizontal"}get isInspection(){return this.orientedImageryType==="inspection"}get isNadir(){return this.orientedImageryType==="nadir"}get isOblique(){return this.orientedImageryType==="oblique"}get isSpherical(){return this.orientedImageryType==="360"}get location(){const{cameraOrientation:t,cameraHeight:i,elevation:a}=this;if(t){const{type:o,x:s,y:n,z:h,horizontalWKID:d,verticalWKID:m}=t,u=typeof d=="number"?{wkid:d}:{wkt:d};if(o===ba.LTP){const{latitude:y,longitude:f,ellipsoidRadius:v,squaredEccentricity:w,properties:_}=t,{x:M,y:I,z:$}=_;return new T(Gr([M,I,$],[y,f,v,w]))}const g=new T({x:s,y:n,z:h,spatialReference:u}),p=m?ga("point",{wkid:m},u):null;return p&&p(g),g}if(typeof i!="number")throw ho("cameraHeight");const r=this.geometry.clone();return r.z=r.hasZ?r.z:(a??0)+i,r}set matrix(t){if(!t||t.length!==9)return N.getLogger(this).warn("Ignoring rotation matrix because it doesn't have 9 values",{value:t}),void this._set("matrix",null);this._set("matrix",t)}readNearDistance(t,i){const{neardistance:a,neardist:r,layer:o}=i;return a??r??o.nearDistance}readOrientationAccuracy(t,i){const{accuracy:a,orientationaccuracy:r}=i;return(r==null?void 0:r.split(";").map(Number))??(a==null?void 0:a.split(";").map(Number))??null}writeOrientationAccuracy(t,i){t&&(i.orientationAccuracy=t.join(";"))}readOIType(t,i){const{orientedimagerytype:a,oitype:r,camerapitch:o,campitch:s,layer:n}=i,h=hi.read(a??r??n.orientedImageryType),d=o??s??n.cameraPitch;return h==="oblique"?d<10?"nadir":"oblique":h}set radial(t){if(t)if(typeof t!="string")this._set("radial",t);else{const[i,a,r]=t.split(";").map(Number);this._set("radial",[i??0,a??0,r??0])}else this._set("radial",[0,0,0])}set tangential(t){if(t)if(typeof t!="string")this._set("tangential",t);else{const[i,a]=t.split(";").map(Number);this._set("tangential",[i??0,a??0])}else this._set("tangential",[0,0])}readVFOV(t,i){const{verticalfieldofview:a,vfov:r,layer:o}=i;return a??r??o.verticalFieldOfView}_parseIfJSON(t){let i=null;try{i=JSON.parse(t)}catch(a){N.getLogger(this).error("couldn't parse the given elevation source JSON",t,a)}return i}};l([c(_e())],F.prototype,"a0",void 0),l([c(_e())],F.prototype,"a1",void 0),l([c(_e())],F.prototype,"a2",void 0),l([c({type:Date,json:{write:{enabled:!0,target:"acquisitionDate"},name:"acquisitiondate"}})],F.prototype,"acquisitionDate",void 0),l([c(_e())],F.prototype,"b0",void 0),l([c(_e())],F.prototype,"b1",void 0),l([c(_e())],F.prototype,"b2",void 0),l([c({type:Number,json:{write:!0,read:{source:["cameraheading","camheading","layer.cameraHeading"]}}})],F.prototype,"cameraHeading",void 0),l([Y("cameraHeading")],F.prototype,"readCameraHeading",null),l([c({type:Number,json:{write:!0}})],F.prototype,"cameraHeight",void 0),l([Y("cameraHeight",["cameraheight","avghtag","layer.cameraHeight"])],F.prototype,"readCameraHeight",null),l([c()],F.prototype,"cameraOffset",void 0),l([Y("cameraOffset",["cameraoffset","camoffset"])],F.prototype,"readCamOffset",null),l([Dt("cameraOffset")],F.prototype,"writeCameraOffset",null),l([c({json:{write:{writer:(e,t,i)=>{t[i]=e.toString()}}},type:Ma}),Wa(e=>e?co.getCameraOrientation(e):null)],F.prototype,"cameraOrientation",void 0),l([Y("cameraOrientation",["cameraorientation","camori"])],F.prototype,"readCameraOrientation",null),l([c({type:Number,json:{write:!0}})],F.prototype,"cameraPitch",void 0),l([Y("cameraPitch",["camerapitch","campitch","layer.cameraPitch"])],F.prototype,"readCameraPitch",null),l([c({type:Number,json:{write:!0}})],F.prototype,"cameraRoll",void 0),l([Y("cameraRoll",["cameraroll","camroll","layer.cameraRoll"])],F.prototype,"readCameraRoll",null),l([c({json:{write:!0},type:String})],F.prototype,"depthImage",void 0),l([Y("depthImage",["depthimage","depthimg"])],F.prototype,"readDepthImage",null),l([c({type:Number,json:{write:!0}})],F.prototype,"elevation",void 0),l([c({json:{write:!0},clonable:"reference"})],F.prototype,"elevationSource",void 0),l([Y("elevationSource",["elevationsource","layer.effectiveElevationSource"])],F.prototype,"readElevationSource",null),l([c({json:{name:"exposurestationid",write:{target:"exposureStationId"}},type:String})],F.prototype,"exposureStationId",void 0),l([c({type:Number,json:{write:!0}})],F.prototype,"farDistance",void 0),l([Y("farDistance",["fardistance","fardist","layer.farDistance"])],F.prototype,"readFarDistance",null),l([c(_e("focallength"))],F.prototype,"focalLength",void 0),l([c({type:T,json:{name:"geometry"}})],F.prototype,"geometry",void 0),l([c({type:Number,json:{write:!0}})],F.prototype,"horizontalFieldOfView",void 0),l([Y("horizontalFieldOfView",["horizontalfieldofview","hfov","layer.horizontalFieldOfView"])],F.prototype,"readHFOV",null),l([c({json:{write:!0},type:String})],F.prototype,"imagePath",void 0),l([Y("imagePath",["imagepath"])],F.prototype,"readImageURL",null),l([c({type:Number,json:{write:!0}})],F.prototype,"imageRotation",void 0),l([Y("imageRotation",["imagerotation","imgrot","layer.imageRotation"])],F.prototype,"readImageRotation",null),l([c()],F.prototype,"isHorizontal",null),l([c()],F.prototype,"isInspection",null),l([c()],F.prototype,"isNadir",null),l([c()],F.prototype,"isOblique",null),l([c()],F.prototype,"isSpherical",null),l([c()],F.prototype,"location",null),l([c(lt())],F.prototype,"matrix",null),l([c({json:{write:!0},type:String})],F.prototype,"name",void 0),l([c({type:Number,json:{write:!0}})],F.prototype,"nearDistance",void 0),l([Y("nearDistance",["neardistance","neardist","layer.nearDistance"])],F.prototype,"readNearDistance",null),l([c({json:{write:!0,name:"objectid"},type:Number})],F.prototype,"objectId",void 0),l([c()],F.prototype,"orientationAccuracy",void 0),l([Y("orientationAccuracy",["accuracy","orientationaccuracy"])],F.prototype,"readOrientationAccuracy",null),l([Dt("orientationAccuracy")],F.prototype,"writeOrientationAccuracy",null),l([vi(hi)],F.prototype,"orientedImageryType",void 0),l([Y("orientedImageryType",["orientedimagerytype","oitype","layer.orientedImageryType"])],F.prototype,"readOIType",null),l([c({type:Number,json:{write:!0}})],F.prototype,"principalX",void 0),l([c({type:Number,json:{write:!0}})],F.prototype,"principalY",void 0),l([c(lt([0,0,0]))],F.prototype,"radial",null),l([c({type:Number,json:{name:"sortorder",write:{target:"sortOrder"}}})],F.prototype,"sortOrder",void 0),l([c({type:Object})],F.prototype,"sourceMap",void 0),l([c(lt([0,0]))],F.prototype,"tangential",null),l([c({type:Number,json:{write:!0}})],F.prototype,"verticalFieldOfView",void 0),l([Y("verticalFieldOfView",["verticalfieldofview","vfov","layer.verticalFieldOfView"])],F.prototype,"readVFOV",null),F=l([ie("esri.layers.orientedImagery.core.ExposurePoint")],F);const ki=F,Ae={},uo=1e3;async function po(e,t){var n;const{point:i,queryParams:a}=e;if(i==null)return null;const r={};let o=e.layerInstanceOrURL;const s=i.spatialReference.isGeographic?pt(i.clone()):i.clone();if(r.outSpatialReference=s.spatialReference,a&&(r.maxRecordCountFactor=a.maxRecordCountFactor??5,r.outFields=a.outFields??["*"],r.where=a.where??"1=1",r.returnGeometry=a.returnGeometry??!0,r.outSpatialReference=a.outSpatialReference),typeof o=="string"&&(Ae.layer&&Ae.layer.url===o?o=Ae.layer:((n=Ae.layer)==null||n.destroy(),o=Ae.layer=new Ia({url:o}))),o)try{await o.load();const h=o,d=yo(s,(a==null?void 0:a.maximumDistance)??h.maximumDistance??uo);r.returnZ=h.hasZ;const m=new ja({geometry:d,...r}),u=await h.queryFeatures(m,t);return go(h)(u)}catch(h){ta(h)}return null}function go(e){return t=>{const{features:i,spatialReference:a}=t;return i.forEach(r=>{r.geometry&&(r.geometry.spatialReference=a);const o=ki.fromJSON({...r.toJSON(),layer:e});o&&(r.attributes=o),r.layer=e,r.spatialReference=a}),t}}function yo(e,t){const i=e.x-t,a=e.x+t,r=e.y-t,o=e.y+t;return new La({xmin:i,xmax:a,ymin:r,ymax:o,spatialReference:e.spatialReference})}function vo(e){const{camera:t,features:i,selectedPoint:a}=e;if(!i.length)return[];e.currentImage??(e.currentImage={attributes:{cameraHeading:0,cameraPitch:0}});const r=fo(t,a,e.currentImage);return i.map(r)}function fo(e,t,i){return t.z??(t.z=0),t.elevation??(t.elevation=0),a=>{const{hfovWeight:r,vfovWeight:o,distanceWeight:s}=wo(a.attributes,e?"3d":"2d"),n=a.attributes,{cameraHeight:h,cameraHeading:d,cameraPitch:m,farDistance:u,horizontalFieldOfView:g,verticalFieldOfView:p,isOblique:y}=n,f=n.geometry,v=180*Math.atan2(f.y-t.y,f.x-t.x)/Math.PI,w=ya(t,f);let _,M,I=g,$=p,R=!1;e?(_=e.heading,M=e.tilt,I=180,$=180,R=!0):!y||m<10?(_=d,M=m,R=!1):(_=i.attributes.cameraHeading,M=m,R=!0,I=180),_>180&&(_-=360);let A=1;f.spatialReference.isWebMercator&&(A=1/Math.cos(Math.PI/2-2*Math.atan(Math.exp(-1*f.y/_t.radius))));const G=Math.sqrt((Math.sqrt((t.x-f.x)**2+(t.y-f.y)**2)/A)**2+((t.z??0)-(t.elevation??0)-h)**2),L=90-180*Math.atan2(t.y-f.y,t.x-f.x)/Math.PI;let J=(Math.abs(L-_)>180?Math.abs(360-Math.abs(L-_)):Math.abs(L-_))/I;J=4*J+1;const Ce=180*Math.acos((n.cameraHeight-(t.z??0)+(t.elevation??0))/G)/Math.PI;let ve=Math.abs(Ce-M)/$;ve=4*ve+1;let Ne=G/Math.sqrt(u**2+h**2);Ne=4*Ne+1;const At=r*J+o*ve+s*Ne;let Xe;if(R){const et=d>180?d-360:d;Xe=r*((Math.abs(L-et)>180?Math.abs(360-Math.abs(L-et)):Math.abs(L-et))/g*4+1)+o*(Math.abs(Ce-m)/p*4+1)+s*Ne}else Xe=At;return{suitability:At,trueSuitability:Xe,feature:a,angle:v,distance:w,verticalAngle:Math.abs(180*Math.atan(w/h)/Math.PI)}}}function wo(e,t){const i="isOblique"in e?e:new ki(e),{isOblique:a,isSpherical:r,isNadir:o}=i;return r?{hfovWeight:t==="2d"?0:1,vfovWeight:t==="2d"?0:.6,distanceWeight:t==="2d"?1:.5}:o?{hfovWeight:.25,vfovWeight:1,distanceWeight:1}:a?{hfovWeight:1,vfovWeight:.25,distanceWeight:1}:{hfovWeight:1,vfovWeight:1,distanceWeight:1}}const Q=Math.PI/180;function ct(e){return e.isSpherical?Fo(e):_o(e)}function _o(e){const{horizontalFieldOfView:t,verticalFieldOfView:i,geometry:a,cameraHeading:r}=e,o=He(a.y,a.spatialReference);let s=e.cameraPitch,n=e.cameraRoll??0,h=150;t>150&&(s=90,n=0,h=5);const d=Math.ceil(t/h),m=bo(d,r,t);let u=e.farDistance?e.farDistance*o:e.cameraHeight*o/Math.cos(s*Q);e.cameraPitch+i/2>=90&&(u=(e.farDistance||20)*o);const g=new me({spatialReference:a==null?void 0:a.spatialReference});g.imageID=e.objectId;let p=null;for(const y of m)p=Mo(y,s,e.cameraHeight,a,u,o,i,t,d,g,n,e.nearDistance);return p.imageID=e.objectId,{polygon:g,frustum:p}}function bo(e,t,i){const a=[];if(e%2==0)for(let r=0;r<e/2;r++)a.push(t-i/e*(r+.5),t+i/e*(r+.5));else{a.push(t);for(let r=1;r<e/2;r++)a.push(t-i/e*r,t+i/e*r)}return a.sort(),a}function Mo(e,t,i,a,r,o,s,n,h,d,m=0,u=0){const g=si(Qe(),yt([e,t,m??0])),p=Oo({cameraHeight:i,cameraPitch:t,farDistance:r,location:a,horizontalFieldOfView:n,nearDistance:u,verticalFieldOfView:s},g),y=ye([0,0,-1],g),{x:f,y:v}=a,w=Se([f,v,i],y,r,o),_=2*Math.tan(s*Q/2)*r,M=2*Math.tan(n/h*Q/2)*r,I=ye([0,1,0],g),$=ye([1,0,0],g),R=E(I,_/2,o),A=E($,M/2,o),G=W(P(),R,A),L=te(P(),R,A),J=Io([te(P(),w,G),te(P(),w,L),W(P(),w,G),W(P(),w,L)],i,a,o);return J.push(J[0]),d.addRing(J),p}function Io(e,t,i,a){return e.map(r=>$o(r,t,i,a))}function Fo(e){const{geometry:t,farDistance:i,objectId:a,nearDistance:r,cameraHeight:o}=e,s=He(t.y,t.spatialReference),n=new gt({center:t.clone(),radius:i*s});if(n.imageID=a,r){const m=new gt({center:t.clone(),radius:r*s});n.addRing(m.rings[0])}const h=t.clone();h.z=o-i*s;const d=ke.createSphere(h,{size:2*i*s});return d.imageID=a,{polygon:n,frustum:d}}function Co(e,t){return e.contains(t)}function ht(e,t){return Math.sign(e)!==Math.sign(t)}function Oo(e,t,i){const{cameraHeight:a,cameraPitch:r,farDistance:o,location:s,horizontalFieldOfView:n,nearDistance:h,verticalFieldOfView:d}=e,m=Hi(s),u=!(r+d/2>=90),g=2*Math.tan(d*Q/2)*h,p=2*Math.tan(n*Q/2)*h,y=2*Math.tan(d*Q/2)*o,f=2*Math.tan(n*Q/2)*o;let v,w;w=[0,0,-1],w=ye(w,t),v=Se([s.x,s.y,a],w,o,m),u&&(v[2]=0);const _=Se([s.x,s.y,a],w,h,m);let M=[0,1,0];M=ye(M,t);let I=[1,0,0];I=ye(I,t);let $=[],R=[];h?(R=[{faces:[4,0,3,4,7,3]},{faces:[5,1,2,5,6,2]},{faces:[4,0,1,4,5,1]},{faces:[6,2,3,6,7,3]}],$=$.concat(te(P(),_,W(P(),E(M,g/2,m),E(I,p/2,m)))),$=$.concat(te(P(),_,te(P(),E(M,g/2,m),E(I,p/2,m)))),$=$.concat(W(P(),_,W(P(),E(M,g/2,m),E(I,p/2,m)))),$=$.concat(W(P(),_,te(P(),E(M,g/2,m),E(I,p/2,m))))):($=[s.x,s.y,a],R=[{faces:[0,1,2,0,2,3,0,3,4,0,4,1]}]),$=$.concat(te(P(),v,W(P(),E(M,y/2,m),E(I,f/2,m)))),$=$.concat(te(P(),v,te(P(),E(M,y/2,m),E(I,f/2,m)))),$=$.concat(W(P(),v,W(P(),E(M,y/2,m),E(I,f/2,m)))),$=$.concat(W(P(),v,te(P(),E(M,y/2,m),E(I,f/2,m))));const A=new Ot({position:Float64Array.from($)});return new ke({vertexAttributes:A,components:R,spatialReference:s.spatialReference})}function $o(e,t,i,a){{const r=Math.sqrt((e[2]-t)**2+(Math.sqrt((e[0]-i.x)**2+(e[1]-i.y)**2)/a)**2)*a,o=E(W(P(),[e[0],e[1],e[2]],[i.x,i.y,t]),1/r,1/a),s=t/(t-e[2]),n={x:(1-s)*i.x+s*e[0],y:(1-s)*i.y+s*e[1],z:(1-s)*t+s*e[2]},h=Math.sqrt((n.z-t)**2+(Math.sqrt((n.x-i.x)**2+(n.y-i.y)**2)/a)**2)*a,d=E(W(P(),[n.x,n.y,n.z],[i.x,i.y,t]),1/h,1/a);return ht(o[0],d[0])&&ht(o[1],d[1])&&ht(o[2],d[2])||e[2]>=0?[e[0],e[1],0]:[n.x,n.y,n.z]}}function Po(e){const{spatialReference:t,x:i,y:a}=e.geometry,{cameraHeading:r,cameraPitch:o,farDistance:s,nearDistance:n}=e,h=Hi(e.geometry),d=new me({spatialReference:t}),m=Math.abs(1.44*s*h);let u=Math.abs(1.44*n*h);(o<20||r==null)&&(u=m);const g=[];return g[0]={x:i+m*Math.sin((r-45)*Q),y:a+m*Math.cos((r-45)*Q)},g[1]={x:i+m*Math.sin((r+45)*Q),y:a+m*Math.cos((r+45)*Q)},g[2]={x:i+u*Math.sin((r+135)*Q),y:a+u*Math.cos((r+135)*Q)},g[3]={x:i+u*Math.sin((r+225)*Q),y:a+u*Math.cos((r+225)*Q)},d.addRing([[g[0].x,g[0].y,0],[g[1].x,g[1].y,0],[g[2].x,g[2].y,0],[g[3].x,g[3].y,0],[g[0].x,g[0].y,0]]),d}function Hi(e){return e&&li(e==null?void 0:e.spatialReference)?1/Math.cos(Math.PI/2-2*Math.atan(Math.exp(-1*e.y/_t.radius))):1}function xo(e,t){const i=1+t/100;if(e.declaredClass==="esri.geometry.Circle"){const{radius:a,center:r}=e,o=new gt({radius:a*i,center:r});return e.rings.length>1&&o.addRing(e.rings[1]),o}if(e.declaredClass==="esri.geometry.Polygon"){const a=new me({spatialReference:e.spatialReference}),r=e.centroid;if(r){const o=[];for(let s=0;s<e.rings[0].length;s++){const n=Math.sqrt((r.x-e.rings[0][s][0])**2+(r.y-e.rings[0][s][1])**2),h=E(W(P(),[e.rings[0][s][0],e.rings[0][s][1],0],[r.x,r.y,0]),1/n,1),d=Se([r.x,r.y,0],h,n*i,1);o.push({x:d[0],y:d[1]})}a.addRing([[o[0].x,o[0].y,0],[o[1].x,o[1].y,0],[o[2].x,o[2].y,0],[o[3].x,o[3].y,0],[o[0].x,o[0].y,0]])}return a}return e}async function Un(e,t,i){const{cameraHeight:a,cameraLocation:r,cameraPitch:o,frustumVertices:s,horizontalFieldOfView:n,imageHeight:h,imageWidth:d,inSRS:m,outSRS:u,verticalFieldOfView:g,cameraRoll:p,imageRotation:y,options:f}=i,v=new X(m),w=new X(u),_=Ri(n,g,p??0),M=s.length>15;return o+_.vfov/2>=90?await To(s,e,d,h,v,w,M,y,f):await So(s,e,t,r,a,M,v,w,f)}async function So(e,t,i,a,r,o,s,n,h){const d=Ro(e,t,i,a,r);if(!d)return;const{farPlane:m,nearPlane:u}=d,g=await zi([...(u==null?void 0:u.vertexPositions)??e.slice(0,3),...m.vertexPositions],s,n,h);return new ke({vertexAttributes:new Ot({position:g}),components:Gi(Ni(o)),spatialReference:n})}function Ro(e,t,i,a,r){const o=Yt(e),s=Yt(e,"near");if(!o)return;const{coefficients:n}=o,h=t.length;for(let d=0;d<h;d++){const m=Lo([i[d][0],i[d][1]],n),u=i[d];u[2]=(u[2]>=0?m:u[2])??0;const g=[u[0]-a[0],u[1]-a[1],u[2]-(a[2]??r)];Vo(a,g,d,s),Ao(a,g,d,o,i,m)}return{farPlane:o,nearPlane:s}}function Ao(e,t,i,a,r,o){const{coefficients:s,vertexPositions:n}=a;if(o!=null&&o>=0)n.splice(3*i,3,...r[i]);else{const h=P();wi(s,fi(e,t),h)&&n.splice(3*i,3,...h)}}function Vo(e,t,i,a){if(!a)return;const r=P();wi(a.coefficients,fi(e,t),r)&&a.vertexPositions.splice(3*i,3,...r)}async function To(e,t,i,a,r,o,s,n=0,h){const d=Math.cos((n??0)*Q),m=Math.sin((n??0)*Q),u=Math.abs(i*d+a*m),g=Math.abs(i*-m+a*d);let p,y,f=s?new Array:[e[0],e[1],e[2]],v=new Array;const w=t.length;for(let M=0;M<w;M++){const I=[u/2,g/2],$=t[M];y=[($[0]-I[0])*d-($[1]-I[1])*m+I[0],($[0]-I[0])*m+($[1]-I[1])*d+I[1]],s?(p=Te([y[0],y[1],1],[[0,0,1],[i,0,1],[i,a,1],[0,a,1]],[[e[0],e[1],e[2]],[e[3],e[4],e[5]],[e[6],e[7],e[8]],[e[9],e[10],e[11]]]),f=f.concat(...p),p=Te([y[0],y[1],1],[[0,0,1],[i,0,1],[i,a,1],[0,a,1]],[[e[12],e[13],e[14]],[e[15],e[16],e[17]],[e[18],e[19],e[20]],[e[21],e[22],e[23]]]),v=v.concat(...p)):(p=Te([y[0],y[1],1],[[0,0,1],[i,0,1],[i,a,1],[0,a,1]],[[e[3],e[4],e[5]],[e[6],e[7],e[8]],[e[9],e[10],e[11]],[e[12],e[13],e[14]]]),f=f.concat(...p))}f=f.concat(v);const _=await zi(f,r,o,h);return new ke({vertexAttributes:new Ot({position:_}),components:Gi(Ni(s)),spatialReference:o})}async function zi(e,t,i,a){if(t.equals(i))return e;const r=e.reduce((s,n,h)=>{const d=Math.floor(h/3);return s[d]||(s[d]=new Array),s[d].push(n),s},new Array),{points:o}=await de(new di(r,t),i,a);return ce(a),o.flat()}function Lo(e,t){if(t)return(-t[3]-t[0]*e[0]-t[1]*e[1])/t[2]}function Yt(e,t="far"){const i=Qa();let a;switch(t){case"far":if(a=Array.from(e.length===15?e.slice(3):e.slice(12)),Bt(i,a,!1))return{coefficients:i,vertexPositions:a};break;case"near":return a=Array.from(e.slice(0,12)),e.length===15||!Bt(i,a,!1)?void 0:{coefficients:i,vertexPositions:a}}}const Ni=e=>e?[{faces:new Uint32Array([4,0,3,4,7,3])},{faces:new Uint32Array([5,1,2,5,6,2])},{faces:new Uint32Array([4,0,1,4,5,1])},{faces:new Uint32Array([6,2,3,6,7,3])}]:[{faces:new Uint32Array([0,1,2,0,2,3,0,3,4,0,4,1])}],Gi=e=>e.map(t=>new qa(t));async function Re(e,t,i){const a=Array.isArray(e)?e:[e];let r;if(Ei(t))r=await Pi(a,t.elevationSample,i);else if(Rt(t)){const{elevationSource:o,extent:s}=t,{url:n,lod:h,rasterFunction:d}=o;r=await $r(a,{url:n,lod:h,rasterFunction:d,extent:s},i)}else r=await Ar(a,t.elevationSource.constantElevation,i);return Array.isArray(e)?r:r[0]}function ze(e,t){const{cameraLocation:i,pointsToTransform:a,scalingFactor:r}=ko(e,t.cameraLocation,t.rotationMatrix),o=new Array;return Eo(a,o,{...t,cameraLocation:i,scalingFactor:r,...No(t)}),Array.isArray(e)?o:o[0]}function Eo(e,t,i){const{affineTransformations:a,cameraLocation:r,focalLengthX:o,focalLengthY:s,principalOffsetPoint:n,radialDistortionCoefficients:h,rotationMatrix:d,scalingFactor:m,tangentialDistortionCoefficients:u}=i;for(const g of e){const p=wt();W(p,g,r),p[0]=p[0]/m,p[1]=p[1]/m;const y=-o*((d[0]*p[0]+d[3]*p[1]+d[6]*p[2])/(d[2]*p[0]+d[5]*p[1]+d[8]*p[2])),f=-s*((d[1]*p[0]+d[4]*p[1]+d[7]*p[2])/(d[2]*p[0]+d[5]*p[1]+d[8]*p[2])),v=y*y+f*f;let w=0,_=0,M=0,I=0,$=0,R=0,A=0;h&&(w=h[0]??0,_=h[1]??0,M=h[2]??0),u&&(I=u[0],$=u[1]),n&&(R=n[0]??0,A=n[1]??0);const G=1+w*v+_*v*v+M*v*v*v;let L=y*G+I*(v+2*y**2)+2*$*y*f,J=f*G+$*(v+2*f**2)+2*I*y*f;L+=R,J+=A;const Ce=Number(a[0])+Number(a[1])*L+Number(a[2])*J,ve=Number(a[3])+Number(a[4])*L+Number(a[5])*J;t.push({x:Ce,y:ve})}}function Di(e,t){const{cameraHeading:i,imageHeight:a,imageWidth:r}=t,{cameraLocation:o,pointsToTransform:s}=Ho(e,t.cameraLocation),n=new Array;for(const h of s){const d=pa(o,h),m=(pe(Math.atan2(h[0]-o[0],h[1]-o[1]))-i)%360,u=pe(Math.acos((o[2]-h[2])/d));n.push(Ai(m,u,r,a))}return Array.isArray(e)?n:n[0]}function ko(e,t,i){const a=Array.isArray(e)||"items"in e?e:[e];Vi(a,t),Bi(a,t),Ti(i);const r=He(t.y,t.spatialReference);return{pointsToTransform:a.map(o=>o.toArray()),scalingFactor:r,cameraLocation:t.toArray()}}function Ho(e,t){const i=Array.isArray(e)||"items"in e?e:[e];return Vi(i,t),Bi(i,t),{pointsToTransform:i.map(a=>a.toArray()),cameraLocation:t.toArray()}}function Bi(e,t){if(e.some(i=>!i.spatialReference.equals(t.spatialReference)))throw new Error("Input points and camera location must have the same spatial reference")}function zo(e){return(e==null?void 0:e.focalLength)!=null}function No(e){if(zo(e))return{focalLengthX:e.focalLength,focalLengthY:e.focalLength};const{imageWidth:t,imageHeight:i,horizontalFieldOfView:a,verticalFieldOfView:r}=e;return{focalLengthX:t/(2*Math.tan(q(a)/2)),focalLengthY:i/(2*Math.tan(q(r)/2))}}async function Go(e,t,i,a=Wi){const{cameraLocation:r,farPlaneVertices:o}=i,s=ue(r),n=new Array;await qi(o,i,n);let h=je(n[0],n[1],n[2]),d=e.clone();for(let m=0;m<a;m++){const u=wt();if(!_i(h,s,ue(d),u))break;let g=0,p=null;if({error:g,imagePoint:p,pointWithZ:d}=await Bo(t,new T(u,r.spatialReference),i),g<=1)break;const[y,f]=ji(r.spatialReference,n);if(Fe(y<=1,f<=1))break;n.splice(0,n.length,...await Zi(y,f,new T(u,r.spatialReference),i)),h=je(n[0],n[1],n[2])}return ue(d)}async function Do(e,t,i,a=Wi){const{cameraLocation:r,farPlaneVertices:o}=i,s=ue(r),n=new Array;await qi(o,i,n);let h=je(n[0],n[1],n[2]),d=e.clone();for(let m=0;m<a;m++){const u=wt();if(!_i(h,s,ue(d),u))break;let g,p=0;if({error:p,imagePoint:g,pointWithZ:d}=await Wo(t,new T(u,r.spatialReference),i),p<=1)break;const[y,f]=ji(r.spatialReference,n);if(Fe(y<=1,f<=1))break;n.splice(0,n.length,...await Zi(y,f,new T(u,r.spatialReference),i)),h=je(n[0],n[1],n[2])}return ue(d)}const Wi=10,Kt=10;function ji(e,t){var a,r;const i=new me({spatialReference:e});return i.addRing(t),[(a=i.extent)!=null&&a.width?i.extent.width/Kt:1,(r=i.extent)!=null&&r.height?i.extent.width/Kt:1]}async function qi(e,t,i){const a=er(e),r=await Re(a,t);i.push(...r.map(ue))}async function Bo(e,t,i){const a=await Re(t,i),r=ze(a,i);return{error:jo(r,e),imagePoint:r,pointWithZ:a}}async function Wo(e,t,i){const a=await Re(t,i),r=Di(a,i);return{error:qo(r,e),imagePoint:r,pointWithZ:a}}const jo=(e,t)=>Math.abs(e.x-t.x)+Math.abs(e.y-t.y),qo=(e,t)=>Math.abs(e.heading-t.heading)+Math.abs(e.pitch-t.pitch);async function Zi(e,t,i,a){const r=[[-e,-t],[e,-t],[e,t],[-e,t]].map(([o,s])=>new T([i.x+o,i.y+s],i.spatialReference));return Re(r,a).then(o=>o.map(s=>s.toArray()))}async function Zo(e,t,i){const{verticalFieldOfView:a,imageBoundaries:r,scalingFactor:o,farPlaneVertices:s,cameraLocation:n,pixelsToTransform:h,vecToPoint:d}=es(e,t),m=new Array;return await Uo(h,s,r,d,t,m,n,o,a,i),Array.isArray(e)?m:m[0]}async function Uo(e,t,i,a,r,o,s,n,h,d){for(const m of e){let u=Jo(t,i,m,a,r);d&&Fe(St(d.elevationSample),Rt(d))&&(u=await Go(a(u),{x:m[0],y:m[1]},{...r,...d,farPlaneVertices:t.map(a)})),o.push(a(Ui(u,s,n,r.averageElevation,r.cameraPitch,h)))}}function Ui(e,t,i,a,r,o){let s=da(e);const n=Math.sqrt((e[2]-t[2])**2+(Math.sqrt((e[0]-t[0])**2+(e[1]-t[1])**2)/i)**2)*i,h=E(W(P(),e,t),1/n,1/i);if(Qo(e[2],a,r,o)){const d=Math.abs((t[2]-a)/-h[2])*i;s=Se(t,h,d,i)}else s[2]=a;return s}function Qo(e,t,i,a){return e<t||i+a/2<90}function Jo(e,t,i,a,r){let o=null;const s=9;let n,h=0,d=e,m=t;for(;h<=s;){const u=Ko(i,m,d,r);if(n=u.error,o=u.transformedPoint,Fe(n<=1,h===s))break;d=Zr(d,n,i,t),m=Yo(d,a,r),h++}return o}function Yo(e,t,i){return ze(e.map(t),i).map(({x:a,y:r})=>[a,r,1])}function Ko(e,t,i,a){const{cameraLocation:r}=a,o=Te(e,t,i),{x:s,y:n}=ze(new T(o,r.spatialReference),a);return{transformedPoint:o,error:Xo(e,[s,n,1])}}function Xo(e,t){return Math.abs(e[0]-t[0])+Math.abs(e[1]-t[1])}function es(e,t){const i=aa(e)||"items"in e?e:[e],{cameraLocation:a,rotationMatrix:r}=t;if(jr(i,a),Ti(r),(r==null?void 0:r.length)!==9)throw new Error("Rotation matrix is not provided or is not a valid 3x3 matrix");const o=He(a.y,a.spatialReference),s=ao({...t,scalingFactor:o}),n=ze(s.map(d=>new T(d,a.spatialReference)),t),{vfov:h}=Ri(t.horizontalFieldOfView,t.verticalFieldOfView,t.cameraRoll);return{cameraLocation:a.toArray(),imageBoundaries:n.map(({x:d,y:m})=>[d,m,1]),verticalFieldOfView:h,farPlaneVertices:s,scalingFactor:o,pixelsToTransform:i.map(d=>[d.x,d.y,1]),vecToPoint:qr(a.spatialReference)}}async function ts(e,t,i){const{averageElevation:a,cameraHeading:r,cameraLocation:o,farDistance:s,imageHeight:n,imageWidth:h,verticalFieldOfView:d}=t,m=He(o.y,o.spatialReference),u=new Array,[g,p,y]=o.toArray(),f=Ja([g,p,y??0],s*m),v=xt.toArray(),w=Array.isArray(e)?e:[e];for(const _ of w){let M,I;if(to(_))M=_.heading,I=_.pitch;else{const G=Be({x:_.x,y:_.y},h,n);M=G.heading,I=G.pitch}M=(M+r)%360;const $=Ya([v[0],v[1],v[2]],We(M,I)),R=Ka([g,p,y??0],$.direction);let A=P();Xa(f,R,A),i&&(bt(i)||St(i.elevationSample))&&I+d/2<90&&(A=await Do(new T(A,o.spatialReference),{heading:M,pitch:I},{...t,...i,farPlaneVertices:io(s,s).map(([G,L])=>new T([o.x+G,o.y+L],o.spatialReference))})),A=Ui(A,o.toArray(),m,a,I,d),u.push(new T(A,o.spatialReference))}return Array.isArray(e)?u:u[0]}let ge=class extends yi(oi){constructor(t){super(t),this.maxFOV=0,this.minFOV=0,this.view=null,this.zoomFactor=5}get canZoomIn(){return!!this.view&&(this.minFOV===0||this.view.camera.fov>this.minFOV)}get canZoomOut(){return!!this.view&&(this.maxFOV===0||this.view.camera.fov<this.maxFOV)}};l([c({type:Boolean,readOnly:!0})],ge.prototype,"canZoomIn",null),l([c({type:Boolean,readOnly:!0})],ge.prototype,"canZoomOut",null),l([c({type:Number})],ge.prototype,"maxFOV",void 0),l([c({type:Number})],ge.prototype,"minFOV",void 0),l([c({type:Ye})],ge.prototype,"view",void 0),l([c({type:Number})],ge.prototype,"zoomFactor",void 0),ge=l([ie("esri.widgets.PanoramicViewer.PanoramicZoomConditions")],ge);const Ue=ge;let fe=class extends lr{constructor(t){super(t),this.panoramicZoomConditions=new Ue,this.zoomTo=i=>{this.view.camera.fov=this.constrainFOV(i),this.view.camera=this.view.camera.clone()}}initialize(){this.addHandles([x(()=>{var t;return[(t=this.view)==null?void 0:t.ready,this.panoramicZoomConditions]},()=>{var t;(t=this.view)!=null&&t.ready&&(this.panoramicZoomConditions.view=this.view,this.zoomTo(this.view.camera.fov))},k),x(()=>[this.panoramicZoomConditions.maxFOV,this.panoramicZoomConditions.minFOV],([t,i])=>{t!=null&&i!=null&&this.zoomTo(this.view.camera.fov)},ra)])}get canZoomIn(){return this.panoramicZoomConditions.canZoomIn}get canZoomOut(){return this.panoramicZoomConditions.canZoomOut}get state(){var t;return(t=this.view)!=null&&t.ready?"ready":"disabled"}set view(t){this._set("view",t)}constrainFOV(t){const{maxFOV:i,minFOV:a}=this.panoramicZoomConditions;return Me(t,a,i)}zoomIn(){if(!this.canZoomIn)return;const t=this.view.camera.fov-this.panoramicZoomConditions.zoomFactor;this.zoomTo(t)}zoomOut(){if(!this.canZoomOut)return;const t=this.view.camera.fov+this.panoramicZoomConditions.zoomFactor;this.zoomTo(t)}};l([c()],fe.prototype,"canZoomIn",null),l([c()],fe.prototype,"canZoomOut",null),l([c({type:Ue})],fe.prototype,"panoramicZoomConditions",void 0),l([c()],fe.prototype,"state",null),l([c({type:Ye})],fe.prototype,"view",null),fe=l([ie("esri.widgets.PanoramicViewer.PanoramicZoomViewModel")],fe);const is=fe;function as(e,t=xt,i=Ze){const a=t.clone();a.z=-Ze/2;const r=ke.createSphere(a,{size:i,densificationFactor:2,vertexSpace:"georeferenced",material:new Za({colorTexture:new Ua({data:e})})});if(r.components[0].trustSourceNormals=!0,r.vertexAttributes.uv){const o=r.vertexAttributes.uv.length??0;for(let s=0;s<o;s++)r.vertexAttributes.uv[2*s+0]=1-r.vertexAttributes.uv[2*s+0],r.vertexAttributes.uv[2*s+1]=r.vertexAttributes.uv[2*s+1]}return r.centerAt(a),r}function rs(e){return new B({geometry:e,symbol:new Mt({symbolLayers:new D([new It])})})}function dt(e,t){return 2*pe(Math.atan(Math.tan(q(e/2))*Math.sqrt(t**2+1)))}const Pe={autoLoad:"auto-load",default:"default",navigation:"navigation",fovConstraint:"fov-constraint",clickAction:"image-click-action"};let H=class extends Ft.EventedAccessor{constructor(t){super(t),this._startPosition=null,this._targetPosition=null,this._graphics=new Ct({elevationInfo:{mode:"relative-to-ground"}}),this._imageGraphic=null,this._loadController=null,this._map=new Mi({ground:new or({opacity:0,navigationConstraint:null}),layers:new D([this._graphics])}),this._zoomViewModel=null,this.autoLoad=!1,this.clickAction="none",this.imageSize=null,this.imageSource=null,this.pitch=90,this.state="ready",this.yaw=0,this._addNavigationHandles=()=>{this.imageRenderer.basemapTerrain.suspended=!0,this.imageRenderer.constraints.tilt.max=180,this.removeHandles(Pe.navigation),this.addHandles([this.imageRenderer.on("mouse-wheel",this._handleWheel),this.imageRenderer.on("double-click",this._handleDoubleClick),this.imageRenderer.on("drag",this._handleDrag),this.imageRenderer.on("key-down",i=>{const a=["+","-","Shift","_","=","ArrowUp","ArrowDown","ArrowRight","ArrowLeft"],r=i.key;a.includes(r)&&i.stopPropagation()})],Pe.navigation)},this._addHFOVHandles=()=>{this.removeHandles(Pe.fovConstraint),this.addHandles(x(()=>[this.maxHFOV,this.minHFOV],()=>{this._zoomViewModel&&(this._zoomViewModel.panoramicZoomConditions=new Ue({view:this.imageRenderer,maxFOV:this.maxHFOV,minFOV:this.minHFOV}))},k),Pe.fovConstraint)},this._addZoomHandles=()=>{this._zoomViewModel=new is({view:this.imageRenderer,panoramicZoomConditions:new Ue({maxFOV:this.maxHFOV,minFOV:this.minHFOV})});const i=new nr({viewModel:this._zoomViewModel});this.imageRenderer.ui.add(i,"top-left"),this._addHFOVHandles()},this._cancelLoadWithController=()=>{var i;(i=this._loadController)==null||i.abort(),this._loadController=null},this._handleDoubleClick=i=>{i.stopPropagation(),i.native.ctrlKey?this._zoomOut():this._zoomIn()},this._handleDrag=i=>{i.stopPropagation();const{action:a,x:r,y:o}=i;switch(a){case"start":this._startPosition=this._targetPosition={x:r,y:o};break;case"update":this._targetPosition={x:r,y:o},this._updateCameraHeadingAndTilt()}},this._handleImageClick=i=>{if(this.state==="image-loaded"&&this.imageRenderer.ready)switch(this.clickAction){case"emit":i.stopPropagation(),this.emit("click",i);break;case"hittest":i.stopPropagation(),i.async(async()=>{const a=await this.imageRenderer.hitTest(i.screenPoint,{include:this._graphics});this.emit("hittest-response",a)});break;case"pixel-location":{if(i.stopPropagation(),!this.imageSize||!i.mapPoint)return void this.emit("pixel-location",null);const a=Dr(i.mapPoint,this.imageSize[0],this.imageSize[1]);this.emit("pixel-location",{...a,spatialReference:X.WebMercator});break}}},this._handleWheel=i=>{const a=i.deltaX??i.native.deltaX;i.stopPropagation(),a>0||i.deltaY>0?this._zoomOut():this._zoomIn()},this._loadWithController=()=>{this._cancelLoadWithController(),this._loadController=new AbortController,this.loadImage(this._loadController)},this._zoomIn=()=>{var i;return(i=this._zoomViewModel)==null?void 0:i.zoomIn()},this._zoomOut=()=>{var i;return(i=this._zoomViewModel)==null?void 0:i.zoomOut()},this.addGraphic=(i,a)=>this.state==="image-loaded"&&!this._graphics.graphics.includes(i)&&(this._graphics.graphics.add(i,a),!0),this.addManyGraphics=i=>{if(this.state!=="image-loaded")return!1;const a=i.filter(r=>!this._graphics.graphics.includes(r));return this._graphics.graphics.addMany(a),!0},this.clearGraphics=()=>{this._graphics.graphics.removeAll()},this.clearImage=()=>{this.imageSize=null,this._removeImageSphere()},this.removeGraphic=i=>!(this.state!=="image-loaded"||!this._graphics.graphics.includes(i))&&(this._graphics.remove(i),!0),this.removeManyGraphics=i=>{if(this.state!=="image-loaded")return!1;const a=i.filter(r=>this._graphics.graphics.includes(r));return this._graphics.removeMany(a),!0},this._imageRenderer=new Ye({map:this._map,viewingMode:"local",camera:{position:xt},environment:{atmosphereEnabled:!1,starsEnabled:!1,lighting:{type:"virtual"}},popupEnabled:!1,spatialReference:X.WebMercator,ui:{components:["attribution"]}})}initialize(){this.state="initialized",this.addHandles([x(()=>this.imageSource,()=>{this.imageSource&&this.autoLoad&&this._loadWithController()},k),x(()=>this.fov,()=>{this._reloadCamera()},k),x(()=>this.yaw,t=>{this.camera.heading=t,this._reloadCamera()},k),x(()=>this.pitch,t=>{this.camera.tilt=t,this._reloadCamera()},k),oa(()=>this.imageRenderer.ready,()=>{this._addNavigationHandles(),this._addZoomHandles()},k),x(()=>this.clickAction,t=>{this.removeHandles(Pe.clickAction),t!=="none"&&this.addHandles(this.imageRenderer.on("click",this._handleImageClick))},k)],Pe.default)}get camera(){return this.imageRenderer.camera}set camera(t){t&&(this.imageRenderer.camera=t.clone())}get fov(){return this.camera.fov}set fov(t){var i;Number.isFinite(t)&&((i=this._zoomViewModel)==null||i.zoomTo(t))}get hfov(){const{fov:t}=this.camera,{size:[i,a]}=this.imageRenderer,r=i/a,o=Math.atan(r);return 2*pe(Math.atan(Math.tan(q(t/2))*Math.sin(o)))}get imageRenderer(){return this._imageRenderer}get maxHFOV(){const{size:[t,i]}=this.imageRenderer;return dt(Tr,t/i)}get minHFOV(){const{size:[t,i]}=this.imageRenderer;return dt(Lr,t/i)}get vfov(){const{fov:t}=this.camera,{size:[i,a]}=this.imageRenderer,r=i/a,o=Math.atan(r);return 2*pe(Math.atan(Math.tan(q(t/2))*Math.cos(o)))}async _loadImageInternal(t,i){let a;this.state="image-loading";try{a=(await ri(t,{responseType:"image",...i})).data}catch(r){throw oe(r)?this.state="image-load-aborted":this.state="image-load-error",r}return this._updateImageSphere(a,i)}_reloadCamera(){this.camera=this.camera.clone()}_removeImageSphere(){this._imageGraphic&&(this._graphics.remove(this._imageGraphic),this._imageGraphic=re(this._imageGraphic)),this.state="ready",this.imageSize=null}_updateCameraHeadingAndTilt(){if(!this._startPosition||!this._targetPosition)return;const t=this.camera.heading+(this._startPosition.x-this._targetPosition.x)/this.imageRenderer.width*this.camera.fov;this.yaw=(t+360)%360;const i=this.camera.tilt-(this._startPosition.y-this._targetPosition.y)/this.imageRenderer.height*this.imageRenderer.camera.tilt;this.pitch=Math.min(179.5,Math.max(.5,i)),this._startPosition=this._targetPosition}async _updateImageSphere(t,i){await Ee(i);const{size:[a,r]}=this.imageRenderer;return this._imageGraphic=rs(as(t)),this._graphics.add(this._imageGraphic),this.fov=dt(Vr,a/r),this.state="image-loaded",this.imageSize=[t.width,t.height],this._imageGraphic.geometry}async loadImage(t){return this._removeImageSphere(),this.imageSource?this._loadImageInternal(this.imageSource,t):qe(this.declaredClass,new se(Oi("panoramic-viewer"),$i("PanoramicViewerViewModel","imageSource")))}};l([c()],H.prototype,"_graphics",void 0),l([c()],H.prototype,"_imageGraphic",void 0),l([c()],H.prototype,"_imageRenderer",void 0),l([c()],H.prototype,"_loadController",void 0),l([c()],H.prototype,"_map",void 0),l([c()],H.prototype,"_zoomViewModel",void 0),l([c({type:Boolean})],H.prototype,"autoLoad",void 0),l([c({type:bi})],H.prototype,"camera",null),l([vi(new sr({emit:"emit",hittest:"hittest",none:"none","pixel-location":"pixel-location"}))],H.prototype,"clickAction",void 0),l([c({type:Number})],H.prototype,"fov",null),l([c({readOnly:!0})],H.prototype,"hfov",null),l([c({readOnly:!0})],H.prototype,"imageRenderer",null),l([c()],H.prototype,"imageSize",void 0),l([c()],H.prototype,"imageSource",void 0),l([c({readOnly:!0})],H.prototype,"maxHFOV",null),l([c({readOnly:!0})],H.prototype,"minHFOV",null),l([c({type:Number})],H.prototype,"pitch",void 0),l([c()],H.prototype,"state",void 0),l([c({readOnly:!0})],H.prototype,"vfov",null),l([c({type:Number})],H.prototype,"yaw",void 0),H=l([ie("esri.widgets.PanoramicViewer.PanoramicViewerViewModel")],H);const Qi=H,os="esri-panoramic-viewer";let Z=class extends Je{constructor(t){super(t),this.viewModel=new Qi,this._afterContainerCreate=i=>{this.imageRenderer.container=i},this.addGraphic=(i,a)=>{this.viewModel.addGraphic(i,a)},this.addManyGraphics=i=>{this.viewModel.addManyGraphics(i)},this.clearGraphics=()=>{this.viewModel.clearGraphics()},this.clearImage=()=>{this.viewModel.clearImage()},this.loadImage=i=>this.viewModel.loadImage(i),this.removeGraphic=i=>{this.viewModel.removeGraphic(i)},this.removeManyGraphics=i=>{this.viewModel.removeManyGraphics(i)}}get autoLoad(){return this.viewModel.autoLoad}set autoLoad(t){this.viewModel.autoLoad=t}get camera(){return this.viewModel.camera}set camera(t){t&&(this.viewModel.camera=t)}get clickAction(){return this.viewModel.clickAction}set clickAction(t){this.viewModel.clickAction=t}get fov(){return this.camera.fov}set fov(t){this.viewModel.fov=t}get hfov(){return this.viewModel.hfov}get icon(){return"i360-view"}set icon(t){this._overrideIfSome("icon",t)}get imageRenderer(){return this.viewModel.imageRenderer}get imageSize(){return this.viewModel.imageSize}get imageSource(){return this.viewModel.imageSource}set imageSource(t){this.viewModel.imageSource=t}get pitch(){return this.viewModel.pitch}set pitch(t){this.viewModel.pitch=t}get state(){return this.viewModel.state}get vfov(){return this.viewModel.vfov}get yaw(){return this.viewModel.yaw}set yaw(t){this.viewModel.yaw=t}render(){return b("div",{afterCreate:this._afterContainerCreate,bind:this,class:this.classes(Ke.widget,os)})}};l([c({type:Boolean})],Z.prototype,"autoLoad",null),l([c({type:bi})],Z.prototype,"camera",null),l([c()],Z.prototype,"clickAction",null),l([c({type:Number})],Z.prototype,"fov",null),l([c({readOnly:!0,type:Number})],Z.prototype,"hfov",null),l([c()],Z.prototype,"icon",null),l([c({readOnly:!0,type:Ye})],Z.prototype,"imageRenderer",null),l([c({readOnly:!0})],Z.prototype,"imageSize",null),l([c()],Z.prototype,"imageSource",null),l([c({type:Number})],Z.prototype,"pitch",null),l([c({readOnly:!0})],Z.prototype,"state",null),l([c({readOnly:!0,type:Number})],Z.prototype,"vfov",null),l([Ii(["click","hittest-response","pixel-location"]),c({type:Qi})],Z.prototype,"viewModel",void 0),l([c({type:Number})],Z.prototype,"yaw",null),Z=l([ie("esri.widgets.PanoramicViewer")],Z);const ss=Z,ns=new $t({size:15,style:"circle",color:[255,102,102,.5],outline:null}),Xt=new $t({size:10,style:"circle",color:[0,128,192,.5],outline:null}),Xn=new Fi({style:"solid",color:[0,128,192,.5],outline:null}),el=new Fi({style:"solid",color:[255,102,102,.5],outline:null}),ei=new $t({size:10,style:"diamond",color:[255,102,102],outline:null}),ls=new gi({symbolLayers:new D([new ka({size:10,material:{color:"red"},resource:{primitive:"x"},outline:{color:"black",size:1}})])}),cs=new gi({symbolLayers:new D([new Ha({width:9,height:9,depth:9,material:{color:[255,102,102]},resource:{primitive:"diamond"},castShadows:!1})])}),ti=new za({data:{type:"CIMSymbolReference",symbol:{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,size:10,frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[0,1.4142135623730951],[3.585786437626905,5],[5,3.585786437626905],[1.4142135623730951,0],[5,-3.585786437626905],[3.585786437626905,-5],[0,-1.4142135623730951],[-3.585786437626905,-5],[-5,-3.585786437626905],[-1.4142135623730951,0],[-5,3.585786437626905],[-3.585786437626905,5],[0,1.4142135623730951]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidStroke",enable:!0,width:1,color:[0,0,0,100]},{type:"CIMSolidFill",enable:!0,color:[255,0,0,255]}]}}]}]}}}),tl=new Mt({symbolLayers:new D([new It({material:{color:[255,102,102,.5]},edges:null})])}),il=new Mt({symbolLayers:new D([new It({material:{color:[0,128,192,.25]},edges:null})])}),ii={click:"click-handle",enhancements:"enhancements-handle",rotation:"rotation-handle"};let z=class extends Ft.EventedAccessor{constructor(t){super(t),this._imageChanged=!1,this._panConstraint=null,this._image=null,this._loadController=null,this._overlays=new Ct({blendMode:"source-atop"}),this._map=new Mi,this.autoLoad=!1,this.clickAction="none",this.error=null,this.imageSource=null,this.imageRotation=0,this.state="ready",this._cancelLoadWithController=()=>{var i;(i=this._loadController)==null||i.abort(),this._loadController=null},this._createImageHandles=()=>{this.removeHandles(ii.enhancements),this.addHandles(x(()=>[this.brightness,this.contrast,this.sharpness],([i,a,r])=>{var o;(o=this.image)!=null&&o.loaded&&(this.image.effect=`contrast(${10*(a+10)}%) brightness(${10*(i+10)}%)`,this.sharpenImage(this.image,r))},k))},this._createPanConstraint=()=>{const{image:i,imageRenderer:a}=this,r=o=>{if(!(i&&a&&o.targetGeometry&&i.serviceRasterInfo))return o;const{extent:s}=i.serviceRasterInfo,{constraints:n,rotation:h,width:d,height:m}=a,{extent:u}=tt(me.fromExtent(s),h),{width:g,height:p}=u,y=o.targetGeometry.clone(),f=n.scaleToZoom(o.scale),v=1/2**f,w=d/m;let _=v*g,M=v*p;f&&(g/d>p/m?M=_/w:_=M*w);const I=u.clone();return I.xmin+=_/2,I.xmax-=_/2,I.ymin+=M/2,I.ymax-=M/2,o.targetGeometry=dr(I,y).coordinate,this.state="image-loaded",o};return{constrain:r,applyPanConstraint:r}},this._createResizeHandles=i=>{i.removeHandles("resize"),i.addHandles(x(()=>{if(!this.imageRenderer.ready)return;const{extent:a}=i.serviceRasterInfo,{width:r,height:o,rotation:s}=this.imageRenderer,{extent:n}=tt(me.fromExtent(a),s),{width:h,height:d}=n;return Math.max(h/r,d/o)},a=>{if(!this.imageRenderer||a==null)return;const{constraints:r,scale:o,spatialReference:s}=this.imageRenderer,n=r.minScale,h=mr(s),d=.25*h,m=h*a;let u=m;const g=[];for(;u>d;)g.push(u),u/=2;g.push(u);const{lods:p}=ui.create({scales:g});if(r.set({minScale:m,lods:p}),this._imageChanged)return this.imageRenderer.scale=m,void(this._imageChanged=!1);this.imageRenderer.scale=Math.abs(o-n)<=1e-6?m:o},k),"resize")},this._loadImageInternal=(i,a={})=>{this.clearImage(),this.error=null,this._imageChanged=!0,this.state="image-loading";const r=typeof i=="string",o=r?void 0:i.datasetFormat,s=r?i:i.url,{customParameters:n,options:h}=a;return this._image=new xa({ioConfig:{skipExtensions:["aux.xml","jgw"],skipMapInfo:!0,datasetFormat:o},url:s,customParameters:n}),this._image.when(d=>{this._updatePanConstraint(),this._createResizeHandles(d),this._map.add(d),this.state="image-loaded"},d=>{oe(d)?this.state="image-load-aborted":(this.state="image-load-error",this.error=d,N.getLogger(this).error(`error occurred while loading image ${r?i:JSON.stringify(i)}`,d),this.imageSource=null)}),this._image.load(h)},this._loadWithController=()=>{this._cancelLoadWithController(),this._loadController=new AbortController,this.loadImage(this._loadController)},this._updatePanConstraint=()=>{this._panConstraint&&this.imageRenderer.constraints.customConstraints.remove(this._panConstraint),this._panConstraint=this._createPanConstraint(),this.imageRenderer.constraints.customConstraints.add(this._panConstraint)},this.addGraphic=(i,a)=>{this._overlays.graphics.add(i,a)},this.addManyGraphics=i=>{this._overlays.addMany(i)},this.clearGraphics=()=>{this._overlays.graphics.removeAll()},this.clearImage=()=>{this.image&&(this._map.layers.remove(this.image),this._image=re(this._image))},this.loadImage=i=>{const{customParameters:a,imageSource:r}=this;return r?this._loadImageInternal(r,{customParameters:a,options:i}):qe(this.declaredClass,new se(Oi("image-viewer"),$i("ImageViewerViewModel","imageSource")))},this.removeGraphic=i=>{this._overlays.remove(i)},this.removeManyGraphics=i=>{this._overlays.removeMany(i)},this._imageRenderer=new Ci({constraints:{snapToZoom:!0,rotationEnabled:!1},map:this._map,popupEnabled:!1,spatialReference:X.WebMercator,ui:{components:["zoom"]}})}initialize(){this.state="initialized",this.addHandles([x(()=>this.imageSource,t=>{t&&this.autoLoad&&this._loadWithController()},k),x(()=>{var t;return(t=this.image)==null?void 0:t.loaded},()=>{this._createImageHandles()}),x(()=>this.imageRotation,()=>{this._rotateImage()}),x(()=>this.imageRenderer.map,(t,i)=>{i==null||i.layers.remove(this._overlays),t==null||t.layers.add(this._overlays)},Le),x(()=>this.imageRenderer.map.allLayers.length,t=>{t&&this.imageRenderer.map.layers.reorder(this._overlays,t-1)},k),x(()=>this.clickAction,t=>{this.removeHandles(ii.click),t!=="none"&&this.addHandles(this.imageRenderer.on("click",i=>{var a,r;if((a=this.image)!=null&&a.loaded&&this.imageRenderer.ready)switch(t){case"emit":i.stopPropagation(),this.emit("click",i);break;case"hittest":i.stopPropagation(),i.async(async()=>{const o=await this.imageRenderer.hitTest(i.screenPoint,{include:this._overlays});this.emit("hittest-response",o)});break;case"pixel-location":{if(i.stopPropagation(),!((r=this.image)!=null&&r.serviceRasterInfo)||!i.mapPoint)return void this.emit("pixel-location",null);const{extent:o,pixelSize:s}=this.image.serviceRasterInfo,n=(i.mapPoint.x-o.xmin)*s.x,h=(o.ymax-i.mapPoint.y)*s.y,d=new T({x:n,y:h,spatialReference:o.spatialReference});this.emit("pixel-location",d);break}}}))},k)])}get brightness(){return this._get("brightness")??0}set brightness(t){this._set("brightness",Me(t,-10,10))}get contrast(){return this._get("contrast")??0}set contrast(t){this._set("contrast",Me(t,-10,10))}get image(){return this._image}get imagePointsInView(){var u,g,p;const{extent:t,ready:i}=this.imageRenderer,a=this.imageRotation,r=(u=this.image)==null?void 0:u.fullExtent,o=(g=this.image)==null?void 0:g.serviceRasterInfo,s=((p=this._imageRenderer.allLayerViews.find(({layer:y})=>y===this.image))==null?void 0:p.attached)===!0;if(!(i&&t&&r&&o&&s))return null;const n=tt(me.fromExtent(t),a),h=me.fromExtent(r),d=hr(n,h),{rings:m}=d;return m.flat().map(([y,f])=>({x:(y-o.extent.xmin)*o.pixelSize.x,y:(o.extent.ymax-f)*o.pixelSize.y}))}get imageSize(){const{image:t}=this;if(!(t!=null&&t.raster))return null;const{width:i,height:a}=t.raster.rasterInfo;return[i,a]}get imageRenderer(){return this._imageRenderer}get imageView(){return this.imageRenderer.allLayerViews.find(t=>t.layer===this.image)}get sharpness(){return this._get("sharpness")??0}set sharpness(t){this._set("sharpness",Me(t,0,1))}_rotateImage(){this.imageRenderer.constraints.rotationEnabled=!0,this.imageRenderer.rotation=this.imageRotation,this.imageRenderer.constraints.rotationEnabled=!1}sharpenImage(t,i){if(!i)return void(t.rasterFunction=null);const a=[0,-1*i,0,-1*i,4*i+1,-1*i,0,-1*i,0],r=new mi({functionName:"Convolution",functionArguments:{type:Wt.userDefined,cols:3,rows:3,kernel:a,convolutionType:Wt.userDefined}});t.rasterFunction=r}};l([c()],z.prototype,"_image",void 0),l([c()],z.prototype,"_imageRenderer",void 0),l([c()],z.prototype,"_loadController",void 0),l([c()],z.prototype,"_overlays",void 0),l([c()],z.prototype,"_map",void 0),l([c({type:Boolean})],z.prototype,"autoLoad",void 0),l([c({type:Number})],z.prototype,"brightness",null),l([c()],z.prototype,"clickAction",void 0),l([c({type:Number})],z.prototype,"contrast",null),l([c({type:Object})],z.prototype,"customParameters",void 0),l([c({type:se})],z.prototype,"error",void 0),l([c({readOnly:!0})],z.prototype,"image",null),l([c({readOnly:!0})],z.prototype,"imagePointsInView",null),l([c({readOnly:!0})],z.prototype,"imageSize",null),l([c({cast:Mr})],z.prototype,"imageSource",void 0),l([c({readOnly:!0})],z.prototype,"imageRenderer",null),l([c({type:Number})],z.prototype,"imageRotation",void 0),l([c()],z.prototype,"imageView",null),l([c({type:Number})],z.prototype,"sharpness",null),l([c()],z.prototype,"state",void 0),z=l([ie("esri.widgets.OrientedImageryViewer.components.ImageViewerViewModel")],z);const Ji=z,hs="esri-image-viewer";let U=class extends Je{constructor(){super(...arguments),this.viewModel=new Ji,this._afterContainerCreate=e=>{this.imageRenderer.container=e},this.addGraphic=(e,t)=>{this.viewModel.addGraphic(e,t)},this.addManyGraphics=e=>{this.viewModel.addManyGraphics(e)},this.clearGraphics=()=>{this.viewModel.clearGraphics()},this.clearImage=()=>{this.viewModel.clearImage()},this.loadImage=async e=>this.viewModel.loadImage(e),this.removeGraphic=e=>{this.viewModel.removeGraphic(e)},this.removeManyGraphics=e=>{this.viewModel.removeManyGraphics(e)}}get autoLoad(){return this.viewModel.autoLoad}set autoLoad(e){this.viewModel.autoLoad=e}get brightness(){return this.viewModel.brightness}set brightness(e){this.viewModel.brightness=e}get clickAction(){return this.viewModel.clickAction}set clickAction(e){this.viewModel.clickAction=e}get contrast(){return this.viewModel.contrast}set contrast(e){this.viewModel.contrast=e}get customParameters(){return this.viewModel.customParameters}set customParameters(e){this.viewModel.customParameters=e}get error(){return this.viewModel.error}get imageSize(){var t;const e=(t=this.viewModel.image)==null?void 0:t.serviceRasterInfo;return e?[e.width,e.height]:[0,0]}get imagePointsInView(){return this.viewModel.imagePointsInView}get imageRenderer(){return this.viewModel.imageRenderer}get imageRotation(){return this.viewModel.imageRotation}set imageRotation(e){this.viewModel.imageRotation=e}get imageSource(){return this.viewModel.imageSource}set imageSource(e){this.viewModel.imageSource=e}get sharpness(){return this.viewModel.sharpness}set sharpness(e){this.viewModel.sharpness=e}get state(){return this.viewModel.state}render(){return b("div",{afterCreate:this._afterContainerCreate,bind:this,class:this.classes(Ke.widget,hs)})}};l([c({type:Boolean})],U.prototype,"autoLoad",null),l([c({type:Number}),c()],U.prototype,"brightness",null),l([c()],U.prototype,"clickAction",null),l([c({type:Number})],U.prototype,"contrast",null),l([c({type:Object})],U.prototype,"customParameters",null),l([c({readOnly:!0})],U.prototype,"error",null),l([c()],U.prototype,"imageSize",null),l([c({readOnly:!0})],U.prototype,"imagePointsInView",null),l([c({readOnly:!0,type:Ci})],U.prototype,"imageRenderer",null),l([c()],U.prototype,"imageRotation",null),l([c()],U.prototype,"imageSource",null),l([Ii(["click","hittest-response","pixel-location"]),c({type:Ji})],U.prototype,"viewModel",void 0),l([c({type:Number})],U.prototype,"sharpness",null),l([c({readOnly:!0})],U.prototype,"state",null),U=l([ie("esri.widgets.OrientedImageryViewer.components.ImageViewer")],U);const ds=U,be={click:"view-click",imageClick:"image-click",interactionHandles:"interaction-handles",footprintHandles:"footprint-handles"},ms=new Set(["JPG","JPEG"]),us=/\.(\w+)$/,ps=e=>e==="FA";let C=class extends Ft.EventedMixin(Na){constructor(e){super(e),this.additionalFeatures=new D,this.additionalCameraLocations=new D,this.additionalFootprints=new D,this.bestFeatureAngle=0,this.bestFeatureCurrentFootprint=null,this.bestFeatureFootprint=null,this.coverageFrustums=new D,this.coveragePolygons=new D,this.currentBestFeature=null,this.currentBestFeatureLocation=null,this.currentCoverageVisible=!0,this.determineWorkflowForFeature=async(t,i,a)=>{const{currentBestFeature:r,selectedPoint:o,view:s}=this;if(s==null||s.closePopup(),r&&o){this._initialCurrentCoverageUpdate=!0;try{await this._updatePointsAndPolygons(a),await this._loadImage(a)}catch(n){oe(n)||(this.loadImageError(n),N.getLogger(this).error("#loadIImage()","error occured while loading image",n))}}},this.disabled=!1,this.displayMessage={key:"onLoadMessage",type:"info"},this.features=new D,this.isAdditionalCoverageVisible=!1,this.isAdditionalPointSourcesVisible=!1,this.layer=null,this.localPort=null,this.mapImageConversionToolState=!1,this.navigatorCurrentBestFeature=null,this.overlayedCameraLocations=new D,this.overlayedMapFeatures=new Ga,this.pointSources=new D,this.previousFeatureAngle=0,this.selectedPoint=null,this.shouldShowSelectedImage=!1,this.updateFootprint=async(t,i)=>{var a;this.state==="image-loaded"&&await((a=this._adapter)==null?void 0:a.updateFootprint(t,i))},this.updateFootprintPanorama=async(t,i)=>{var a;await((a=this._adapter)==null?void 0:a.updateFootprintPanorama(t,i))},this._adapter=null,this._highlightedFeatureHandle=null,this._imageViewer=new ds,this._initialCurrentCoverageUpdate=!0,this._overlays=new Ct({listMode:"hide",internal:!0,elevationInfo:{mode:"absolute-height"}}),this._panoramicViewer=new ss,this._referencePointOnGround=null,this._referencePointOnImage=null,this._sectorData=null,this._updatingHandles=new Da,this._clickTask=null,this._crossSymbol=null,this.footprintExtent=null,this._featureChangedTask=null,this._openPopupTask=null,this._suitabilities=null,this._transformController=new AbortController,this._updateFootprintTask=null,this.highlight=t=>{var a;if(!this._overlaysView)return;this.removeHighlight();const i=this.additionalFootprints.find(({attributes:{imageID:r}})=>r===Number(t));this._highlightedFeatureHandle=i?(a=this._overlaysView)==null?void 0:a.highlight(i):null},this.loadImageFromSource=async(t,i)=>this._updatingHandles.addPromise(this._loadImageFromSourceInternal(t,i)),this.loadImageViewer=t=>{this._imageViewer.container=t},this.loadPanoramicViewer=t=>{this._panoramicViewer.container=t},this.removeHighlight=()=>{var t;return(t=this._highlightedFeatureHandle)==null?void 0:t.remove()},this.toggleImageAttributes=()=>{we(this._openPopupTask),this._openPopupTask=Oe(async t=>{const{currentBestFeature:i,popupEnabled:a,layer:r,view:o}=this;if(o==null||o.closePopup(),!(o&&i&&a&&r))return;const{attributes:s,geometry:n}=i,h=new B({geometry:n,attributes:s.toJSON(),layer:r});ce(t),await o.openPopup({features:[h],location:s.location.clone()})})},this._createViewClickHandle=()=>{if(this.removeHandles(be.click),this.state==="disabled"||this.view==null)return;const t=this.mapImageConversionToolState&&this.state==="image-loaded"?this._mapImageConversionToolViewClickHandler:this._viewClickHandler;this.addHandles(this.view.on("click",t,rr.WIDGET),be.click)},this._createImageClickHandle=()=>{this.removeHandles(be.imageClick);const{mapImageConversionToolState:t,mode:i,activeViewer:a,currentBestFeature:r,footprintExtent:o}=this,s=a==null?void 0:a.imageSize;if(!(t&&i!=="none"&&s&&o&&r))return;a.clickAction="pixel-location";let n=null;const h=sa(()=>a,"pixel-location",d=>{this.plotReferencePointOnImage(d),n==null||n.abort(),n=Oe(async m=>{if(!d)return;const u=await this.getMapPoint(d,{feature:r,imageSize:s,mode:i}).then(g=>{var y;const p=(y=this.view)==null?void 0:y.spatialReference;return Fe(!p,g.spatialReference.equals(p))?g:de(g,p)});ce(m),this.plotReferencePointOnGround(u)})});this.addHandles(h,be.imageClick)},this._getImageSourceFromAttachment=async(t,i,a)=>{var h;const r=new ir({objectIds:[i]}),o=await t.queryAttachments(r,a),s=(h=o[`${i}`])==null?void 0:h[0],n=s==null?void 0:s.url;if(!n)throw new se("NoAttachmentError","no attachments found",{[t.objectIdField]:i,layer:t});return{datasetFormat:s.contentType.split("/")[1].toUpperCase(),url:n}},this._loadAdapter=async t=>{const{view:i}=this;if(i)switch(i.type){case"2d":{const{default:a}=await ee(()=>import("./OrientedImageryViewerViewModelAdapter2D-sfH-nnhl.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395]),import.meta.url);ce(t),this._adapter=new a(this);break}case"3d":{const{default:a}=await ee(()=>import("./OrientedImageryViewerViewModelAdapter3D-Bz4D3Ick.js"),__vite__mapDeps([396,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,213,214,66,65,215,61,216,67,97,217,218,219,220,221,62,222,223,224,225,226,227,228,63,229,230,231,68,69,70,232,64,233,234,71,235,236,237,238,239,47,48,49,50,51,52,53,54,55,56,57,58,59,60,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395]),import.meta.url);ce(t),this._adapter=new a(this);break}}else this._adapter=null},this._loadImage=async t=>{const{currentBestFeature:i,layer:a,mode:r}=this;if(this.clearGraphics(),!a||!i||r==="none")return;const{attributes:o}=i,{imagePath:s,imageRotation:n,cameraHeading:h,cameraRoll:d,cameraPitch:m,objectId:u,cameraOrientation:g,location:p}=o,y=(d??0)+(n??0),f=p.spatialReference.isWGS84&&(g==null?void 0:g.type)!==4?pt(p):new T(p);let v=s;if(ps(s))try{v=await this._getImageSourceFromAttachment(a,u,t)}catch(w){return oe(w)?void 0:Fr(w)?(N.getLogger(this).error(w),void this.setMessage("noAttachment","error",`${a.objectIdField}: ${u}`)):(N.getLogger(this).error(w,{[a.objectIdField]:u,layer:a}),void this.setMessage("imageLoadError","error",`query-attachments-failed:${a.objectIdField} ${u}`))}try{await this.loadImageFromSource(v,{imageRotation:y,options:t,pitch:m,yaw:h,mode:r,cameraLocation:f}),ce(t),await this.transformAndPlotSelectedLocation(t)}catch(w){oe(w)||this.loadImageError(w)}},this._loadImageFromSourceInternal=async(t,i)=>{var g;const{mode:a,imageRotation:r,options:o}=i,s=typeof t=="string",n=s?t:t.url,{origin:h,pathname:d,searchParams:m}=new URL(n);let u=s?((g=d.match(us))==null?void 0:g[1])??"":t.datasetFormat;if(!u){const p=await Cr(n,{...i.options});p&&(u=p.split("/")[1]),u??(u="UNKNOWN FORMAT")}switch(a){case"default":this._imageViewer.imageSource={datasetFormat:u.toUpperCase(),url:`${h}${d}`},this._imageViewer.customParameters=Object.fromEntries(m),this._imageViewer.imageRotation=r??0,await this._imageViewer.loadImage(o);break;case"panoramic":if(ms.has(u.toUpperCase())){const{selectedPoint:p}=this,{pitch:y,yaw:f,cameraLocation:v,viewAngle:w}=i;this._panoramicViewer.imageSource=n;let _=f??0;typeof w=="number"?_=w-_:v&&p&&(_=await Wr(v,p)-_),this._panoramicViewer.pitch=y??0,this._panoramicViewer.yaw=_,await this._panoramicViewer.loadImage(o)}else this.setMessage("unsupportedPanoramicImageryError","error",void 0,{datasetFormat:u});break}},this._mapImageConversionToolViewClickHandler=t=>{t.stopPropagation(),t.preventDefault(),t.mapPoint&&this.plotMapPoint(t.mapPoint)},this._viewClickHandler=t=>{var i;(i=this._clickTask)==null||i.abort(),this._clickTask=Oe(async a=>{const{pointerType:r,button:o,mapPoint:s}=t;if((r!=="mouse"||o===0)&&s)return t.stopPropagation(),t.preventDefault(),this._updatingHandles.addPromise(this.loadBestImage(s,{signal:a}))})},this.plotSelectedPointOnImage=async(t,i)=>{if(await Ee(i),!t)return;const a=new T({...mt(t)?t.toJSON():t});if(this.mode==="default")a.x-=.5,a.y=.5-a.y,a.spatialReference=this._imageViewer.imageRenderer.spatialReference.clone(),this._crossSymbol=new B({geometry:a,symbol:ti}),this._imageViewer.addGraphic(this._crossSymbol,0);else if(this.mode==="panoramic"){const{imageSize:r}=this._panoramicViewer;if(!r)return;const[o,s]=r,{heading:n,pitch:h}=Be(t,o,s),d=We(n,h);this._crossSymbol=new B({geometry:new T(d,X.WebMercator),symbol:ls}),this._panoramicViewer.addGraphic(this._crossSymbol,0)}},this.handleSectorClick=this.handleSectorClick.bind(this),this.searchBestImage=this.searchBestImage.bind(this),this.transformAndPlotReferencePointOnImage=this.transformAndPlotReferencePointOnImage.bind(this),this.updateSuitabilities=this.updateSuitabilities.bind(this),this.selectBestFeature=this.selectBestFeature.bind(this)}initialize(){this.addHandles([x(()=>this.view,()=>{this.load()},k),x(()=>{var e;return(e=this.view)==null?void 0:e.map},(e,t)=>{t==null||t.layers.remove(this._overlays),e==null||e.layers.add(this._overlays)},Le),x(()=>{var e,t,i;return(i=(t=(e=this.view)==null?void 0:e.map)==null?void 0:t.allLayers)==null?void 0:i.length},e=>{var t,i;e&&((i=(t=this.view)==null?void 0:t.map)==null||i.layers.reorder(this._overlays,e-1))},Le),x(()=>[this.state,this.mapImageConversionToolState,this.view],()=>{this._createViewClickHandle(),this._createImageClickHandle()},k),x(()=>this.bestFeatureAngle,(e,t)=>{this.previousFeatureAngle=t??0},k),x(()=>this.currentBestFeature,async(e,t)=>{we(this._featureChangedTask),this._featureChangedTask=Oe(async i=>this.determineWorkflowForFeature.apply(this,[e,t,{signal:i}])),await this._featureChangedTask.promise},{sync:!0}),x(()=>this.mode,e=>{switch(this.removeHandles(be.interactionHandles),e){case"default":this.addHandles(x(()=>this._imageViewer.imagePointsInView,t=>{t&&(we(this._updateFootprintTask),this._updateFootprintTask=Oe(async i=>{await this.updateFootprint(t,{signal:i})}))},{...k,equals:(t,i)=>Vt(t,i,Tt)}),be.interactionHandles);break;case"panoramic":this.addHandles(x(()=>{const{currentBestFeature:t,state:i}=this,{imageSize:a,vfov:r,hfov:o,pitch:s,yaw:n}=this._panoramicViewer;return t&&a&&i!=="image-loading"?[r,o,n,s]:null},t=>{if(!t||this.state==="image-loading")return;const[i,a,r,o]=t;we(this._updateFootprintTask),this._updateFootprintTask=Oe(async s=>{await this.updateFootprintPanorama({verticalFieldOfView:i,horizontalFieldOfView:a,yaw:r,pitch:o},{signal:s})})},{...k,equals:(t,i)=>Vt(t,i,Tt)}),be.interactionHandles)}},k),x(()=>[this.brightness,this.contrast,this.sharpness],()=>{const{_imageViewer:e,brightness:t,contrast:i,mode:a,sharpness:r}=this;a==="default"&&(e.brightness=t,e.contrast=i,e.sharpness=r)},k)])}destroy(){var e,t;this._updateFootprintTask=we(this._updateFootprintTask),this._clickTask=we(this._clickTask),this.coverageFrustums.destroy(),this.coveragePolygons.destroy(),this.pointSources.destroy(),this.additionalFootprints.destroy(),this.additionalCameraLocations.destroy(),this.bestFeatureFootprint=re(this.bestFeatureFootprint),this.bestFeatureCurrentFootprint=re(this.bestFeatureCurrentFootprint),this._crossSymbol=re(this._crossSymbol),this._referencePointOnGround=re(this._referencePointOnGround),this._referencePointOnImage=re(this._referencePointOnImage),this._overlays&&((t=(e=this.view)==null?void 0:e.map)==null||t.remove(this._overlays)),this._overlays.destroy()}get activeLayer(){return Ve(N.getLogger(this),"activeLayer",{replacement:"layer"}),this.layer}set activeLayer(e){Ve(N.getLogger(this),"activeLayer",{replacement:"layer"}),this.layer=e}get activeViewer(){const{_imageViewer:e,_panoramicViewer:t,mode:i}=this;switch(i){case"default":return e;case"panoramic":return t;default:return null}}get brightness(){return this._get("brightness")??0}set brightness(e){this._set("brightness",Me(e,-10,10))}get contrast(){return this._get("contrast")??0}set contrast(e){this._set("contrast",Me(e,-10,10))}get featureCount(){var e;return((e=this.features)==null?void 0:e.length)??0}get imageGalleryEnabled(){var e;return Zt((e=this.currentBestFeature)==null?void 0:e.attributes.imagePath.trim())}get imageLoaded(){return Ve(N.getLogger(this),"imageLoaded",{replacement:'Use OrientedImageryViewer.state === "image-loaded"',version:"4.29",warnOnce:!0}),this.state==="image-loaded"}get invalidCameraHeading(){var e,t;return((t=(e=this.currentBestFeature)==null?void 0:e.attributes)==null?void 0:t.cameraHeading)===qt}get imagePointsInView(){const{mode:e,_imageViewer:t}=this;return e==="default"?t.imagePointsInView:null}get layerView(){const{layer:e,view:t}=this;if(e&&t)return t.allLayerViews.find(Ir(e))}get layerFloorFilterClause(){const{layerView:e}=this;return e?tr(e):null}get mode(){var a;const e=(a=this.currentBestFeature)==null?void 0:a.attributes;if(!e)return"none";const{horizontalFieldOfView:t,isSpherical:i}=e;return t===360||i?"panoramic":"default"}get popupEnabled(){var e;return((e=this.layer)==null?void 0:e.popupEnabled)===!0}get referencePoint(){var e;return(e=this._referencePointOnGround)==null?void 0:e.geometry}get sectorData(){const{_sectorData:e}=this;return e?it.map(t=>e[t]):null}get sharpness(){return this._get("sharpness")??0}set sharpness(e){this._set("sharpness",Me(e,0,1))}get state(){var i;const{mode:e,disabled:t}=this;if(t)return"disabled";if(!this.isFulfilled())return"loading";if(this.isRejected())return"error";if(this._updatingHandles.updating)return"image-loading";if(((i=this.displayMessage)==null?void 0:i.type)==="error")return"image-load-error";switch(e){case"default":return this._imageViewer.state;case"panoramic":return this._panoramicViewer.state}return"ready"}get thumbnails(){const{features:e}=this;return e?new D(e.map(({attributes:{imagePath:t,objectId:i,cameraRoll:a,imageRotation:r}})=>{const o=t.trim();return Zt(o)?{url:o,objectId:i,rotation:(a??0)+(r??0)}:null}).filter(Lt)):null}set view(e){this._set("view",e)}get _overlaysView(){var e;return(e=this.view)==null?void 0:e.layerViews.find(({layer:t})=>t===this._overlays)}filterByFootprints(e,t){const i=[],a=[],r=[];return e.forEach(o=>{const{layer:{coveragePercent:s},attributes:n}=o;let h;const d=kt(o.geometry.spatialReference);n.cameraHeight/=d,n.farDistance/=d,n.nearDistance/=d,ci(n.elevationSource)&&(n.elevationSource.constantElevation/=d);const{polygon:m,frustum:u}=ct(n);if(h=m.clone(),n.isInspection&&(h=Po(n)),s&&(h=xo(h,s)),Co(h,t)){r.push(o);const{geometry:g,objectId:p,cameraHeight:y,cameraHeading:f}=n,v=g.clone();v.z=y,v.imageID=p,this.pointSources.push(v),f!==qt&&(i.push(m),u&&a.push(u))}}),{features:r,polygons:i,frustums:a}}handleSectorClick(e){var i;if(isNaN(e))return;const t=(i=this._sectorData)==null?void 0:i[it[e]];t!=null&&t.length&&this._updateCurrentBestFeature(t.at(0))}handleFeatureClick(e){var r;const{sector:t,featureIndexInSector:i}=e;if(isNaN(i))return;const a=(r=this._sectorData)==null?void 0:r[t];a!=null&&a.length&&this._updateCurrentBestFeature(a.at(i))}async load(e){return this.addResolvingPromise(this._loadAdapter(e).catch(t=>{if(!oe(t))throw t})),this}async loadBestImage(e,t){var i,a;return(i=this.view)==null||i.closePopup(),this.displayMessage=null,this.selectedPoint=e.spatialReference.isGeographic?pt(e):e.clone(),this.features.removeAll(),this.currentBestFeature=null,this.additionalFeatures.removeAll(),this.additionalFootprints.removeAll(),this.additionalCameraLocations.removeAll(),this.bestFeatureCurrentFootprint=re(this.bestFeatureCurrentFootprint),(a=this._overlays)==null||a.removeAll(),this._fetchFeaturesWithController(e,t)}loadImageError(e){N.getLogger(this).error("oriented-imagery-viewer:load-image",e),this.setMessage("imageLoadError","error",e.message)}async overlayCameraLocations(e){const{activeViewer:t,currentBestFeature:i,overlayedCameraLocations:a,layer:r,mode:o,state:s}=this,n=t==null?void 0:t.imageSize;if(!n||!i||!r||o==="none"||s.includes("loading"))return;const{polygon:h}=ct(i.attributes);if(t.removeManyGraphics(a.toArray()),a.removeAll(),e){const{features:d}=await r.queryFeatures({where:`${r.objectIdField} <> ${i.attributes.objectId}`,geometry:h,returnGeometry:!0,outFields:[r.objectIdField]}),m=await Promise.all(d.map(async u=>{const{attributes:g,geometry:p}=u,y=await this.getPixels(p,{feature:i,imageSize:n,mode:o}),f=Xt.clone();return f.outline=new cr({color:[0,0,0],width:1}),new B({attributes:g,symbol:f,geometry:y})}));a.addMany(m),t.addManyGraphics(a.toArray())}}overlayGraphicsOnImage(e,t){var i;this.overlayedMapFeatures.set(e,t),(i=this.activeViewer)==null||i.addManyGraphics(t.toArray())}async overlayMapFeatures(e,t=!1){const{activeViewer:i,currentBestFeature:a,mode:r,state:o}=this,s=i==null?void 0:i.imageSize;if(!s||!a||r==="none"||o.includes("loading"))return;const{polygon:n}=ct(a.attributes),{features:h}=await e.queryFeatures({geometry:n,returnGeometry:!0,outFields:[e.objectIdField]}),d=new D((await Promise.all(h.map(async m=>{var y,f;const{attributes:u,geometry:g}=m,p=((y=m.symbol)==null?void 0:y.clone())??((f=e.renderer)==null?void 0:f.getSymbol(m).clone());switch(g==null?void 0:g.type){case"point":{const v=await this.getPixels(g,{feature:a,imageSize:s,mode:r});return new B({attributes:u,layer:e,symbol:p,geometry:v,visible:e.visible&&t})}case"polygon":{const{rings:v,spatialReference:w}=g,_=v.map(I=>I.map(([$,R,A])=>new T({x:$,y:R,z:A,spatialReference:w}))),M=await Promise.all(_.map(async I=>this.getPixels(I,{feature:a,imageSize:s,mode:r}).then($=>$.map(ue))));return new B({attributes:u,layer:e,symbol:p,geometry:new me({rings:M,spatialReference:X.WebMercator}),visible:e.visible&&t})}case"polyline":{const{paths:v,spatialReference:w}=g,_=v.map(I=>I.map(([$,R,A])=>new T({x:$,y:R,z:A,spatialReference:w}))),M=await Promise.all(_.map(async I=>this.getPixels(I,{feature:a,imageSize:s,mode:r}).then($=>$.map(ue))));return new B({attributes:u,layer:e,symbol:p,geometry:new Ca({paths:M,spatialReference:X.WebMercator}),visible:e.visible&&t})}case"multipoint":{const{points:v,spatialReference:w}=g,_=v.map(([I,$,R])=>new T({x:I,y:$,z:R,spatialReference:w})),M=await this.getPixels(_,{feature:a,imageSize:s,mode:r}).then(I=>I.map(ue));return new B({attributes:u,layer:e,symbol:p,geometry:new di({points:M,spatialReference:X.WebMercator}),visible:e.visible&&t})}}return null}))).filter(Lt));this.overlayGraphicsOnImage(`${e.id}`,d)}async getPixels(e,t){const{imageSize:i,mode:a}=t,r=(await this.worldToImage(Array.isArray(e)?e:[e])).map(o=>{if(a==="default")return new T({x:o.x-.5,y:.5-o.y,spatialReference:X.WebMercator});const[s,n]=i,{heading:h,pitch:d}=Be(o,s,n),m=We(h,d);return new T(m,X.WebMercator)});return Array.isArray(e)?r:r[0]}async getMapPoint(e,t){const{feature:i,mode:a,imageSize:r}=t,{elevationSample:o,attributes:s}=i,{elevationSource:n,location:h,elevation:d,cameraHeight:m}=s;let u=h.clone();u.spatialReference.isGeographic&&(u=await de(u,X.WebMercator));const g=await rt(d??(h.z??0)-m,{elevationSample:o,elevationSource:n,extent:this.footprintExtent});let p;if("elevationSample"in g&&St(g.elevationSample)&&(i.elevationSample=g.elevationSample),a==="default"){const y=Yr(s,r[0],r[1]);p=await Zo(Array.isArray(e)?e:[e],{...y,cameraLocation:u},g)}else{const y=Xr(s,r[0],r[1]);p=await ts(Array.isArray(e)?e:[e],{...y,cameraLocation:u},g)}return Array.isArray(e)?p:p[0]}async plotMapPoint(e){var t;return this.plotReferencePoint(e),this.transformAndPlotReferencePointOnImage({feature:this.currentBestFeature,selectedLocation:e,options:{signal:(t=this._transformController)==null?void 0:t.signal}})}plotReferencePointOnGround(e){var t,i,a;this._referencePointOnGround&&((t=this._overlays)==null||t.remove(this._referencePointOnGround),this._referencePointOnGround.destroy()),e!=null&&(this._referencePointOnGround=new B({geometry:new T({...e.toJSON()}),symbol:ei}),this.view?(i=this._overlays)==null||i.add(this._referencePointOnGround):this.emit("plot-ground-point",{data:{point:(a=this._referencePointOnGround)==null?void 0:a.geometry}}))}plotReferencePointOnImage(e){if(this.state==="image-loaded")switch(this.clearReferencePointOnImage(),this.mode){case"default":{const t=mt(e)?e.toJSON():e;t.x-=.5,t.y=.5-t.y,this._referencePointOnImage=new B({geometry:new T({spatialReference:this._imageViewer.imageRenderer.spatialReference.clone(),...t}),symbol:ei}),this._imageViewer.addGraphic(this._referencePointOnImage,0);break}case"panoramic":{const{imageSize:t}=this._panoramicViewer;if(!t)return;const[i,a]=t,{heading:r,pitch:o}=Be(e,i,a),s=We(r,o);this._referencePointOnImage=new B({geometry:new T(s,X.WebMercator),symbol:cs}),this._panoramicViewer.addGraphic(this._referencePointOnImage,0);break}}}removeAllOverlayMapFeatures(){this.overlayedMapFeatures.forEach(e=>{this._imageViewer.removeManyGraphics(e.toArray())}),this.overlayedMapFeatures.clear()}removeOverlayedGraphicsOnImage(e){var i;const t=this.overlayedMapFeatures.get(e);t!=null&&t.length&&((i=this.activeViewer)==null||i.removeManyGraphics(t.toArray()),this.overlayedMapFeatures.delete(e))}resetImage(){switch(this.setMessage("onLoadMessage","info"),this.mode){case"default":this._imageViewer.clearImage(),this._imageViewer.clearGraphics();break;case"panoramic":this._panoramicViewer.clearGraphics()}this._clickTask=we(this._clickTask)}async searchBestImage(e,t){try{const i=await po(e,t);i&&await this._processFeatureResponse(i,e.point,{signal:t==null?void 0:t.signal})}catch(i){oe(i)||(this.setMessage("imageLoadError","error",i.message),N.getLogger(this).error("error occurred while finding best image",i))}}selectBestFeature(e){var t;this.currentBestFeature=(t=this.features)==null?void 0:t.find(({attributes:i})=>i.objectId===Number(e))}setAdditionalCameraLocationsVisibility(e){this.additionalCameraLocations.forEach(t=>{t.visible=e})}setAdditionalCoverageVisibility(e){this.additionalFootprints.forEach(t=>{t.visible=e})}setCurrentCoverageVisibility(e){this.bestFeatureCurrentFootprint&&(this.bestFeatureCurrentFootprint.visible=e),this.currentBestFeatureLocation&&(this.currentBestFeatureLocation.visible=e)}setMapImageConversionToolState(e){this.mapImageConversionToolState=e}toggleAllOverlayMapFeatures(e){this.overlayedMapFeatures.forEach(t=>{this._toggleVisiblity(t,e)})}toggleOverlayMapFeatures(e,t){const i=this.overlayedMapFeatures.get(e);i&&this._toggleVisiblity(i,t)}async transformAndPlotReferencePointOnImage(e){var n;const{selectedLocation:t,options:i}=e;let a=!1,r=!1;const o=(n=this.bestFeatureFootprint)==null?void 0:n.geometry;switch(o==null?void 0:o.type){case"polygon":{const h=t.spatialReference.equals(o.spatialReference)?t:await de(t,o.spatialReference);a=o.contains(h);break}case"mesh":{const h=t.spatialReference.equals(o.spatialReference)?t:await de(t,o.spatialReference);r=o.extent.contains(h);break}}if(!a&&!r)return void this.clearReferencePointOnImage();const s=await this.worldToImage(t,i);if(s)return ce(i),this.plotReferencePointOnImage(s),{x:s.x,y:s.y};this.clearReferencePointOnImage()}updateSuitabilities(e){e.sort((i,a)=>i.suitability-a.suitability),this._suitabilities=e;const t=this._suitabilities.map(({feature:i})=>i);this._initialCurrentCoverageUpdate=!0,this._updateFeatures(t),this._groupFeaturesBySectors()}async _fetchFeatures(e,t){if(!this.view)return;const i=this.layer;if(i){const a={include:i},r=this.view.toScreen(e);if(!r)return;const o=await this.view.hitTest(r,a);return this._processHitTestResults(i,o,t)}}async _fetchFeaturesWithController(e,t){try{await this._fetchFeatures(e,t)}catch(i){if(oe(i))return;this.setMessage("imageLoadError","error"),N.getLogger(this).error("error occurred while fetching features",i)}}_groupFeaturesBySectors(){const{_suitabilities:e,additionalFeatures:t,currentBestFeature:i,features:a,invalidCameraHeading:r}=this;if(!e||!t||!i||!a||r)return void(this._sectorData=null);this._sectorData={};for(const h of it)this._sectorData[h]=new D;const o=e.map((h,d)=>({...h,featureIndex:d}));o.sort((h,d)=>h.trueSuitability-d.trueSuitability);const s=o.map(({distance:h})=>h),n=Math.max(...s);o.forEach(h=>{var A,G;const{distance:d,angle:m,featureIndex:u}=h,g=d/n*V[2],p=_r(d,n),y=wr(m);if(!this._sectorData)return;const f=V[3]+g*Math.sin(m*Math.PI/180),v=V[3]+g*Math.cos(m*Math.PI/180);let w;const _=a.at(u),M=_===this.currentBestFeature,I=((A=this.currentBestFeature)==null?void 0:A.attributes.cameraPitch)&&((G=this.currentBestFeature)==null?void 0:G.attributes.cameraPitch)<5;if(M&&I)w=-90;else{const L=f-V[3],J=v-V[3],Ce=J/Math.sqrt(L**2+J**2);let ve=180*Math.acos(Ce)/Math.PI;(L<0&&J<0||L<0&&J>0)&&(ve*=-1),w=ve}const $=p===""?y:`${p}_${y}`;M&&(w===this.bestFeatureAngle?this.previousFeatureAngle=w:this.bestFeatureAngle=w,this.navigatorCurrentBestFeature=I?null:{x:f,y:v,direction:y});const R=this._sectorData[$];R.add({angle:m,featureIndex:u,x:f,y:v,objectID:_.attributes.objectId,sector:$,featureIndexInSector:R.length})})}async _processFeatureResponse(e,t,i){var h;const{features:a}=e;if(!(a!=null&&a.length))return this.setMessage("noImageError","error"),void(this.currentBestFeature=null);this.coveragePolygons.removeAll(),this.coverageFrustums.removeAll(),this.pointSources.removeAll();const{features:r,polygons:o,frustums:s}=this.filterByFootprints(a,t);if(!r.length)return this.setMessage("noImageError","error"),void(this.currentBestFeature=null);let n;if(this.coveragePolygons.addMany(o),this.coverageFrustums.addMany(s),o[0]){let d=new me({spatialReference:o[0].spatialReference});for(const u of o)d=await Ba(d,u);const m=[];for(const{geometry:u}of r)d.contains(u)||m.push([u.x,u.y]);if(m.sort((u,g)=>+Oa([u,g])),d.addRing(m),this.footprintExtent=ar(d.extent,2,2),(h=this.view)==null?void 0:h.supportsGround)try{n=await this.view.map.ground.createElevationSampler(this.footprintExtent,i)}catch(u){oe(u)||N.getLogger(this).error(u)}}if((n||r[0].attributes.elevationSource)&&this.footprintExtent){const d=r[0].attributes.elevationSource;bt(d)&&!n&&(n=await Pt({extent:this.footprintExtent,lod:d.lod,url:d.url,rasterFunction:d.rasterFunction}));const m=await rt((r[0].attributes.location.z??0)-r[0].attributes.cameraHeight,{elevationSample:n,elevationSource:d,extent:this.footprintExtent}),[u,...g]=await Re([t,...r.map(p=>p.attributes.geometry.clone())],m);r[0].elevationSample=n??m.elevationSample,t.elevation=u.z,r.forEach((p,y)=>{p.attributes.elevation=g[y].z})}r[0].elevationSample&&r.forEach(d=>{d.elevationSample=r[0].elevationSample}),this._suitabilities=vo({features:r,selectedPoint:t,camera:vr(this.view)?this.view.camera:null,currentImage:this.currentBestFeature}),this.updateSuitabilities(this._suitabilities)}async _processHitTestResults(e,t,i){var u;const{screenPoint:a,results:[r]}=t,o=(r==null?void 0:r.type)==="graphic"&&this.shouldShowSelectedImage,s=(r==null?void 0:r.mapPoint)??((u=this.view)==null?void 0:u.toMap(a));if(!s)return;const{layerFloorFilterClause:n}=this,h=Gt("1=1",Gt(e.definitionExpression,n)),d=s.spatialReference.isGeographic?1:kt(s.spatialReference),m={layerInstanceOrURL:e,point:s,queryParams:{where:h,maximumDistance:e.maximumDistance?e.maximumDistance/d:void 0,objectIds:o?[r.graphic.getAttribute(e.objectIdField)]:void 0}};await this.searchBestImage(m,i)}_toggleVisiblity(e,t){e.forEach(i=>{i.visible=t})}_updateFeatures(e){if(!e.length)return this.currentBestFeature=null,void this.additionalFeatures.removeAll();this.features.removeAll(),this.features.addMany(e),e.length>1?this.additionalFeatures.addMany(e.slice(1)):this.additionalFeatures.removeAll(),this.currentBestFeature=e[0]}async _updatePointsAndPolygons(e){var o;const{pointSources:t,currentBestFeature:i,currentCoverageVisible:a,isAdditionalPointSourcesVisible:r}=this;if(i&&(this.additionalFootprints.removeAll(),this.additionalCameraLocations.removeAll(),this.bestFeatureCurrentFootprint&&(this.bestFeatureCurrentFootprint.destroy(),this.bestFeatureCurrentFootprint=null,this.bestFeatureFootprint=null),!this.invalidCameraHeading)){await((o=this._adapter)==null?void 0:o.createFootprints(e)),ce(e);for(const s of t)s.imageID===i.attributes.objectId?this.currentBestFeatureLocation=new B({attributes:{imageID:s.imageID},geometry:s,symbol:ns,visible:a}):this.additionalCameraLocations.push(new B({attributes:{imageID:s.imageID},geometry:s,symbol:Xt,visible:r}))}}_updateCurrentBestFeature(e){var a,r,o;if(!e)return;this.currentBestFeature=(a=this.features)==null?void 0:a.at(e.featureIndex);const t=((r=this.currentBestFeature)==null?void 0:r.attributes.cameraPitch)&&((o=this.currentBestFeature)==null?void 0:o.attributes.cameraPitch)<5;let i;if(t)i=-90;else{const s=e.x-V[3],n=e.y-V[3],h=n/Math.sqrt(s**2+n**2);let d=180*Math.acos(h)/Math.PI;(s<0&&n<0||s<0&&n>0)&&(d*=-1),i=d}i===this.bestFeatureAngle?this.previousFeatureAngle=i:this.bestFeatureAngle=i,this.navigatorCurrentBestFeature=t?null:{x:e.x,y:e.y,direction:e.sector.includes("_")?e.sector.split("_")[1]:e.sector}}clearGraphics(){this._imageViewer.clearGraphics(),this._panoramicViewer.clearGraphics()}clearReferencePointOnImage(){this._referencePointOnImage&&(this._imageViewer.removeGraphic(this._referencePointOnImage),this._panoramicViewer.removeGraphic(this._referencePointOnImage),this._referencePointOnImage=re(this._referencePointOnImage))}plotReferencePoint(e){"mapPoint"in e?this.plotReferencePointOnGround(e.mapPoint):this.plotReferencePointOnGround(e)}setMessage(e,t,i,a){this.displayMessage={key:e,type:t,data:i,map:a}}async transformAndPlotSelectedLocation(e){const{currentBestFeature:t,invalidCameraHeading:i,selectedPoint:a,state:r}=this;if(this._crossSymbol&&(this._panoramicViewer.removeGraphic(this._crossSymbol),this._imageViewer.removeGraphic(this._crossSymbol),this._crossSymbol=re(this._crossSymbol)),!a||!t||r!=="image-loaded"||i)return;let o;try{o=await this.worldToImage(a,e),ce(e),await this.plotSelectedPointOnImage(o,e)}catch(s){oe(s)||N.getLogger(this).error("failed to transform map point to pixel, cross symbol will not be plotted on image",{error:s,selectedPoint:a,feature:t})}}async worldToImage(e,t){const{footprintExtent:i}=this,{imageSize:a}=this.activeViewer;if(this.mode==="none"||!this.currentBestFeature||!a||!i)return;const{attributes:{location:r,elevationSource:o,cameraHeading:s,elevation:n,cameraHeight:h},elevationSample:d}=this.currentBestFeature;let m=r.clone();const u=await rt(n??(r.z??0)-h,{elevationSample:d,elevationSource:o});this.currentBestFeature.elevationSample=u.elevationSample;const g=Array.isArray(e)?e:[e];let p,y=await Promise.all(g.map(f=>new Promise(v=>{if(!f.hasZ)return v(Re(f,u));v(f)})));if(r.spatialReference.isGeographic&&(m=await de(m,X.WebMercator,t)),y=await Promise.all(y.map(async f=>m.spatialReference.equals(f.spatialReference)?f:await de(f,m.spatialReference,t))),ce(t),this.mode==="panoramic")p=Di(y,{imageHeight:a[1],imageWidth:a[0],cameraHeading:s,cameraLocation:m});else{const f=Li(this.currentBestFeature.attributes,a[0],a[1]);p=ze(y,{...f,cameraLocation:m})}return Array.isArray(e)?p:p[0]}updateCurrentCoveragePolygon(e){var u,g,p;const{additionalFootprints:t,additionalCameraLocations:i,currentBestFeature:a,currentBestFeatureLocation:r,currentCoverageVisible:o,selectedPoint:s,view:n,_adapter:h}=this,{attributes:{objectId:d},elevationSample:m}=a;if(this._initialCurrentCoverageUpdate){if((u=this._overlays)==null||u.removeAll(),this._initialCurrentCoverageUpdate=!1,this.bestFeatureCurrentFootprint=re(this.bestFeatureCurrentFootprint),e&&!this.invalidCameraHeading&&(e.visible=o,this.bestFeatureCurrentFootprint=e),n){const y=[...t,...i,this.bestFeatureCurrentFootprint,r].filter(fr);n.supportsGround&&m&&(h!=null&&h.updateGroundElevation)&&h.updateGroundElevation(y,m),s&&y.push(new B({geometry:s.clone(),symbol:ti.clone(),attributes:{imageID:d}})),this._overlays.graphics.addMany(y)}}else if(n){if(this.invalidCameraHeading)return;this.bestFeatureCurrentFootprint&&((g=this._overlays)==null||g.remove(this.bestFeatureCurrentFootprint),this.bestFeatureCurrentFootprint=re(this.bestFeatureCurrentFootprint));const y=this.bestFeatureCurrentFootprint&&this._overlays?this._overlays.graphics.indexOf(this.bestFeatureCurrentFootprint):-1;e&&(this.bestFeatureCurrentFootprint=e,n!=null&&n.supportsGround&&m&&(h!=null&&h.updateGroundElevation)&&h.updateGroundElevation([e],m),e.visible=this.currentCoverageVisible,(p=this._overlays)==null||p.graphics.add(this.bestFeatureCurrentFootprint,y>=0?y:this._overlays.graphics.length-1))}}};l([c()],C.prototype,"activeLayer",null),l([c({readOnly:!0})],C.prototype,"activeViewer",null),l([c()],C.prototype,"additionalFeatures",void 0),l([c({type:D.ofType(B)})],C.prototype,"additionalCameraLocations",void 0),l([c({type:D.ofType(B)})],C.prototype,"additionalFootprints",void 0),l([c()],C.prototype,"bestFeatureAngle",void 0),l([c()],C.prototype,"bestFeatureCurrentFootprint",void 0),l([c({type:B})],C.prototype,"bestFeatureFootprint",void 0),l([c({type:Number})],C.prototype,"brightness",null),l([c({type:Number})],C.prototype,"contrast",null),l([c()],C.prototype,"coverageFrustums",void 0),l([c()],C.prototype,"coveragePolygons",void 0),l([c()],C.prototype,"currentBestFeature",void 0),l([c()],C.prototype,"currentBestFeatureLocation",void 0),l([c()],C.prototype,"currentCoverageVisible",void 0),l([c({json:{write:!1}})],C.prototype,"determineWorkflowForFeature",void 0),l([c()],C.prototype,"disabled",void 0),l([c()],C.prototype,"displayMessage",void 0),l([c({readOnly:!0})],C.prototype,"featureCount",null),l([c()],C.prototype,"features",void 0),l([c({readOnly:!0})],C.prototype,"imageGalleryEnabled",null),l([c({readOnly:!0})],C.prototype,"imageLoaded",null),l([c({readOnly:!0})],C.prototype,"invalidCameraHeading",null),l([c()],C.prototype,"imagePointsInView",null),l([c()],C.prototype,"isAdditionalCoverageVisible",void 0),l([c()],C.prototype,"isAdditionalPointSourcesVisible",void 0),l([c()],C.prototype,"layer",void 0),l([c()],C.prototype,"layerView",null),l([c({readOnly:!0})],C.prototype,"layerFloorFilterClause",null),l([c({type:Number})],C.prototype,"localPort",void 0),l([c()],C.prototype,"mapImageConversionToolState",void 0),l([c({readOnly:!0,value:"none"})],C.prototype,"mode",null),l([c()],C.prototype,"navigatorCurrentBestFeature",void 0),l([c({type:D.ofType(B)})],C.prototype,"overlayedCameraLocations",void 0),l([c()],C.prototype,"overlayedMapFeatures",void 0),l([c()],C.prototype,"pointSources",void 0),l([c({readOnly:!0})],C.prototype,"popupEnabled",null),l([c()],C.prototype,"previousFeatureAngle",void 0),l([c()],C.prototype,"referencePoint",null),l([c({readOnly:!0})],C.prototype,"sectorData",null),l([c()],C.prototype,"selectedPoint",void 0),l([c({type:Number})],C.prototype,"sharpness",null),l([c()],C.prototype,"shouldShowSelectedImage",void 0),l([c({readOnly:!0})],C.prototype,"state",null),l([c({readOnly:!0})],C.prototype,"thumbnails",null),l([c()],C.prototype,"updateFootprint",void 0),l([c()],C.prototype,"updateFootprintPanorama",void 0),l([c({value:null})],C.prototype,"view",null),l([c()],C.prototype,"_adapter",void 0),l([c()],C.prototype,"_highlightedFeatureHandle",void 0),l([c()],C.prototype,"_imageViewer",void 0),l([c()],C.prototype,"_initialCurrentCoverageUpdate",void 0),l([c()],C.prototype,"_overlays",void 0),l([c({readOnly:!0})],C.prototype,"_overlaysView",null),l([c()],C.prototype,"_panoramicViewer",void 0),l([c()],C.prototype,"_referencePointOnGround",void 0),l([c()],C.prototype,"_referencePointOnImage",void 0),l([c()],C.prototype,"_sectorData",void 0),l([c({readOnly:!0})],C.prototype,"_updatingHandles",void 0),l([c()],C.prototype,"footprintExtent",void 0),C=l([ie("esri.widgets.OrientedImageryViewer.OrientedImageryViewerViewModel")],C);const Yi=C;let ae=class extends ia{constructor(){super(...arguments),this.closeButton=!0,this.coverageMenu=!0,this.imageEnhancement=!0,this.imageGallery=!0,this.imageOverlays=!0,this.mapImageConversionTool=!0,this.navigationTool=!0,this.title=!0,this.viewerTools=!0,this.showPopupsAction=!0}};l([c({type:Boolean,nonNullable:!0})],ae.prototype,"closeButton",void 0),l([c({type:Boolean,nonNullable:!0})],ae.prototype,"coverageMenu",void 0),l([c({type:Boolean,nonNullable:!0})],ae.prototype,"imageEnhancement",void 0),l([c({type:Boolean,nonNullable:!0})],ae.prototype,"imageGallery",void 0),l([c({type:Boolean,nonNullable:!0})],ae.prototype,"imageOverlays",void 0),l([c({type:Boolean,nonNullable:!0})],ae.prototype,"mapImageConversionTool",void 0),l([c({type:Boolean,nonNullable:!0})],ae.prototype,"navigationTool",void 0),l([c({type:Boolean,nonNullable:!0})],ae.prototype,"title",void 0),l([c({type:Boolean,nonNullable:!0})],ae.prototype,"viewerTools",void 0),l([c({type:Boolean,nonNullable:!0})],ae.prototype,"showPopupsAction",void 0),ae=l([ie("esri.widgets.OrientedImageryViewer.OrientedImageryViewerVisibleElements")],ae);const Ki=ae;let ft=class extends gr{_compileList(){var a,r;const e=(r=(a=this.view)==null?void 0:a.map)==null?void 0:r.allLayers;if(!e)return;const t=e.filter(Or);this._watchLayersListMode(t);const i=this._getViewableLayers(t);i!=null&&i.length?(this._createNewItems(i),this._removeItems(i),this._sortItems(i)):this._removeAllItems()}};ft=l([ie("esri.widgets.OrientedImageryViewer.components.OverlayLayersListViewModel")],ft);const gs=ft;let xe=class extends pr{constructor(){super(...arguments),this.viewModel=new gs,this.selectionMode="multiple",this.visibilityAppearance=void 0}};l([c()],xe.prototype,"viewModel",void 0),l([c()],xe.prototype,"selectionMode",void 0),l([c()],xe.prototype,"visibilityAppearance",void 0),xe=l([ie("esri.widgets.OrientedImageryViewer.components.OverlayLayersList")],xe);const ys=xe;let he=class extends ur(Je){constructor(){super(...arguments),this.closed=!1,this.layerList=new ys({selectionMode:"multiple"}),this.messages=null,this.showCameraLocations=!1,this.showMapFeatures=!1,this.viewModel=null}initialize(){x(()=>[this.view,this.layerList],([e,t])=>{t.view=e},k)}loadDependencies(){return pi({list:()=>ee(()=>import("./calcite-list-C4jOVpC-.js"),__vite__mapDeps([397,206,4,23,24,12,2,25,26,6,9,10,11,19,43,44,45,18,20,21,136,7,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419]),import.meta.url),"list-item":()=>ee(()=>import("./calcite-list-item-vbKS6alm.js"),__vite__mapDeps([420,206,4,23,24,12,2,25,26,6,9,10,11,19,43,44,45,18,20,21,136,7,398,399,405,406,400,404,403,402,401,421,413,409,418,422]),import.meta.url),panel:()=>ee(()=>import("./calcite-panel-qSfJTr42.js"),__vite__mapDeps([423,424,206,4,23,24,12,2,25,26,6,9,10,11,19,43,44,45,18,20,21,136,7,398,399,403,400,425,426,406,421,405,413,404,409,418,427,428,408,429,430,431,432,419]),import.meta.url),switch:()=>ee(()=>import("./calcite-switch-CkUGVtze.js"),__vite__mapDeps([433,434,206,4,23,24,12,2,25,26,6,9,10,11,19,43,44,45,18,20,21,136,7,398,411,399,406,412,413,403]),import.meta.url)})}get view(){var e;return((e=this.viewModel)==null?void 0:e.view)??null}_onCalcitePanelClose(e){e.stopPropagation(),this.closed=!0}_renderCameraLocationsSwitch(e){var t;return b("calcite-list-item",{bind:this,label:(t=this.messages)==null?void 0:t.overlayCameraLocations,onclick:this._toggleShowCameraLocations},b("calcite-switch",{bind:this,checked:e,class:O.overlaysSwitch,onchange:this._toggleShowCameraLocations,scale:"s",slot:"actions-end"}))}_renderOverlayMapFeatures(e){var t;return b("calcite-list-item",{bind:this,label:(t=this.messages)==null?void 0:t.overlayMapFeatures,onclick:this._toggleShowMapFeatures},b("calcite-switch",{bind:this,checked:e,class:O.overlaysSwitch,onchange:this._toggleShowMapFeatures,scale:"s",slot:"actions-end"}))}_renderList(e){return e?b("div",{class:O.imageOverlaysLayerList},this.layerList.render()):null}_renderPanel(){var a;const{closed:e,showCameraLocations:t,showMapFeatures:i}=this;return b("calcite-panel",{bind:this,closable:!0,closed:e,heading:(a=this.messages)==null?void 0:a.imageOverlays,onCalcitePanelClose:this._onCalcitePanelClose},b("calcite-list",null,this._renderCameraLocationsSwitch(t),this._renderOverlayMapFeatures(i)),this._renderList(i))}_toggleShowCameraLocations(e){e.stopPropagation(),this.showCameraLocations=!this.showCameraLocations}_toggleShowMapFeatures(e){e.stopPropagation(),this.showMapFeatures=!this.showMapFeatures}render(){const e=this.layerList.operationalItems.items.length,t=this.showMapFeatures&&e===0,i=this.showMapFeatures&&e>0,a={[Ke.widget]:!0,[O.imageOverlaysNoResult]:t,[O.imageOverlaysIncreasedHeight]:i,[O.imageOverlays]:!t&&!i};return b("div",{class:this.classes(a)},this._renderPanel())}};l([c()],he.prototype,"closed",void 0),l([c()],he.prototype,"layerList",void 0),l([c()],he.prototype,"messages",void 0),l([c()],he.prototype,"showCameraLocations",void 0),l([c()],he.prototype,"showMapFeatures",void 0),l([c()],he.prototype,"view",null),l([c()],he.prototype,"viewModel",void 0),he=l([ie("esri.widgets.OrientedImageryViewer.components.ImageOverlays")],he);const vs=he,ai={overlayMapFeatures:"overlay-map-features",overlayed:"overlayed"};let S=class extends Je{constructor(e,t){super(e,t),this.galleryOpened=!1,this.imageEnhancementToolActive=!1,this.imageOverlaysOpened=!1,this.navigationToolActive=!1,this.viewModel=new Yi,this.messagesCommon=null,this.visibleElements=new Ki,this._navigationToolExpanded=!1,this._navigationTool=null,this._imageOverlays=new vs,this._warningTitleElement=null,this._actionItems=new Map,this._galleryController=new AbortController,this._galleryObserver=new IntersectionObserver(this._lazyLoadImage.bind(this)),this._createAndAddOverlayLayerVisibilityHandle=i=>{this.addHandles(x(()=>i.visible,()=>{this.viewModel.toggleOverlayMapFeatures(i.id,i.visible)}),`${ai.overlayed}-${i.id}`)},this._createHandlesForOverlayMapFeatures=()=>{this.viewModel.removeAllOverlayMapFeatures();const{selectedItems:i}=this._imageOverlays.layerList;i.forEach(this._handleOverlayLayerSelect)},this._createOverlayLayersListChangeHandle=()=>{this.addHandles(this._imageOverlays.layerList.selectedItems.on("change",({added:i,removed:a})=>{i.forEach(this._handleOverlayLayerSelect),a.forEach(this._handleOverlayLayerDeselect)}))},this._handleOverlayLayerDeselect=i=>{const a=i.layer;this.viewModel.removeOverlayedGraphicsOnImage(`${a.id}`),this.removeHandles(`${ai.overlayed}-${a.id}`)},this._handleOverlayLayerSelect=i=>{const a=i.layer;this.viewModel.overlayMapFeatures(a,this._imageOverlays.showMapFeatures),this._createAndAddOverlayLayerVisibilityHandle(a)},this._highlight=i=>{var r;const a=(r=i.target)==null?void 0:r.dataset.objectid;a&&this.viewModel.highlight(a)},this._removeHighlight=()=>this.viewModel.removeHighlight(),this._scaleNavigationTool=()=>{this._navigationToolExpanded=!this._navigationToolExpanded},this._toggleImageAttributes=()=>{this.viewModel.toggleImageAttributes()},this._loadImageFromGallery=this._loadImageFromGallery.bind(this),this._registerGalleryItem=this._registerGalleryItem.bind(this),this._unregisterGalleryItem=this._unregisterGalleryItem.bind(this),this._renderViewerContainer=this._renderViewerContainer.bind(this),this.loadImageFromSource=this.loadImageFromSource.bind(this),this.updateSuitabilities=this.updateSuitabilities.bind(this)}initialize(){this._createOverlayLayersListChangeHandle(),this.addHandles([x(()=>{var e;return[(e=this.viewModel)==null?void 0:e.bestFeatureAngle,this._navigationTool]},([e,t])=>{t&&this._updateNavigationTool(t)},Le),x(()=>this.currentCoverageVisible,e=>this._onCurrentCoverageVisibilityChange(e)),x(()=>this.isAdditionalCoverageVisible,e=>this._onAdditionalCoverageVisibilityChange(e)),x(()=>this.isAdditionalPointSourcesVisible,e=>this._onAdditionalCameraLocationsVisibility(e)),x(()=>this.viewModel,()=>this._imageOverlays.viewModel=this.viewModel,k),x(()=>this.messages,()=>this._imageOverlays.messages=this.messages,k),x(()=>[this.currentBestFeature,this._imageOverlays.showCameraLocations,this.viewModel.state],([e,t,i])=>{i==="image-loaded"&&this.viewModel.overlayCameraLocations(t)},k),x(()=>[this.currentBestFeature,this._imageOverlays.showMapFeatures,this.viewModel.state],(e,t)=>{(t==null?void 0:t[1])!==e[1]&&this.viewModel.toggleAllOverlayMapFeatures(e[1]),e[0]&&e[0]!==(t==null?void 0:t[0])&&na(()=>this.viewModel.state==="image-loaded").then(this._createHandlesForOverlayMapFeatures)},Le)])}loadDependencies(){return pi({"action-bar":()=>ee(()=>import("./calcite-action-bar-pMVRYUJz.js"),__vite__mapDeps([435,206,4,23,24,12,2,25,26,6,9,10,11,19,43,44,45,18,20,21,136,7,436,400,398,403,405,406,404,437,438,425,426,421,399,413,409,418,427,428,408,429,430,431,432]),import.meta.url),"action-group":()=>ee(()=>import("./calcite-action-group-Dp-CUDEe.js"),__vite__mapDeps([439,438,206,4,23,24,12,2,25,26,6,9,10,11,19,43,44,45,18,20,21,136,7,436,400,403,405,398,406,404,425,426,421,399,413,409,418,427,428,408,429,430,431,432]),import.meta.url),action:()=>ee(()=>import("./calcite-action-Bys6x4p_.js"),__vite__mapDeps([440,421,206,4,23,24,12,2,25,26,6,9,10,11,19,43,44,45,18,20,21,136,7,398,399,403,405,406,400,413,404,409,418]),import.meta.url),label:()=>ee(()=>import("./calcite-label-B1FxWqaL.js"),__vite__mapDeps([441,206,4,23,24,12,2,25,26,6,9,10,11,19,43,44,45,18,20,21,136,7,412,398,413]),import.meta.url),notice:()=>ee(()=>import("./calcite-notice-DSp0z_Oh.js"),__vite__mapDeps([442,206,4,23,24,12,2,25,26,6,9,10,11,19,43,44,45,18,20,21,136,7,436,400,398,403,405,406,404,443,430,413,409]),import.meta.url),panel:()=>ee(()=>import("./calcite-panel-qSfJTr42.js"),__vite__mapDeps([423,424,206,4,23,24,12,2,25,26,6,9,10,11,19,43,44,45,18,20,21,136,7,398,399,403,400,425,426,406,421,405,413,404,409,418,427,428,408,429,430,431,432,419]),import.meta.url),slider:()=>ee(()=>import("./calcite-slider-GqQeL3Ah.js"),__vite__mapDeps([444,206,4,23,24,12,2,25,26,6,9,10,11,19,43,44,45,18,20,21,136,7,398,411,399,406,412,413,403,405,400,445]),import.meta.url),tooltip:()=>ee(()=>import("./calcite-tooltip-rE_jVYtd.js"),__vite__mapDeps([446,206,4,23,24,12,2,25,26,6,9,10,11,19,43,44,45,18,20,21,136,7,398,428,408,430,432]),import.meta.url)})}destroy(){this._galleryController.abort(),this._galleryObserver.disconnect()}get activeLayer(){return Ve(N.getLogger(this),"activeLayer",{replacement:"layer"}),this.layer}set activeLayer(e){Ve(N.getLogger(this),"activeLayer",{replacement:"layer"}),this.layer=e}get currentBestFeature(){return this.viewModel.currentBestFeature}set currentBestFeature(e){this.viewModel.currentBestFeature=e}get currentCoverageVisible(){return this.viewModel.currentCoverageVisible}set currentCoverageVisible(e){this.viewModel.currentCoverageVisible=e}get disabled(){return this.viewModel.disabled}set disabled(e){this.viewModel.disabled=e}get displayMessage(){return this.viewModel.displayMessage}get features(){return this.viewModel.features}get imagePointsInView(){return this.viewModel.imagePointsInView}get icon(){return"oriented-imagery-widget"}set icon(e){this._overrideIfSome("icon",e)}get imageGalleryEnabled(){return this.viewModel.imageGalleryEnabled}get invalidCameraHeading(){return this.viewModel.invalidCameraHeading}get isAdditionalCoverageVisible(){return this.viewModel.isAdditionalCoverageVisible}set isAdditionalCoverageVisible(e){this.viewModel.isAdditionalCoverageVisible=e}get isAdditionalPointSourcesVisible(){return this.viewModel.isAdditionalPointSourcesVisible}set isAdditionalPointSourcesVisible(e){this.viewModel.isAdditionalPointSourcesVisible=e}get mapImageConversionToolState(){return this.viewModel.mapImageConversionToolState}set mapImageConversionToolState(e){this.viewModel.mapImageConversionToolState=e}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}get popupEnabled(){const{popupEnabled:e,state:t}=this.viewModel;return t==="image-loaded"&&e}get referencePoint(){return this.viewModel.referencePoint??null}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}set determineWorkflowForFeature(e){this.viewModel.determineWorkflowForFeature=e}get determineWorkflowForFeature(){return this.viewModel.determineWorkflowForFeature}set updateFootprint(e){this.viewModel.updateFootprint=e}get updateFootprint(){return this.viewModel.updateFootprint}async _getThumbnailPixelBlockInternal(e,t){const{level:i,offset:a,size:r}=this._getMaxLevelRasterParameters(e);try{const{pixelBlock:o}=await e.fetchRawPixels(i,a,r,t);return o}catch(o){N.getLogger(this).warn("failed to create canvas with pixel data",o)}return null}_getMaxLevelRasterParameters(e){const{storageInfo:t,width:i,height:a}=e.rasterInfo,{maximumPyramidLevel:r,pyramidScalingFactor:o}=t,s=o??2;return{level:r,offset:{x:0,y:0},size:{width:Math.ceil(i/s**r),height:Math.ceil(a/s**r)}}}async _getThumbnailPixelBlock(e){const{signal:t}=this._galleryController;try{const{origin:i,pathname:a,searchParams:r}=new URL(e),o=await Sa.open({ioConfig:{customFetchParameters:Object.fromEntries(r),skipMapInfo:!0},url:`${i}${a}`,signal:t});return o?await this._getThumbnailPixelBlockInternal(o,{signal:t}):null}catch(i){N.getLogger(this).error("failed to create thumbnail",i)}return null}_handleBrightnessChange(e){this.viewModel.brightness=e.target.value??0}_handleContrastChange(e){this.viewModel.contrast=e.target.value??0}_handleSharpnessChange(e){this.viewModel.sharpness=e.target.value??0}_lazyLoadImage(e,t){e.forEach(async i=>{if(i.isIntersecting){const a=i.target,r=a.getAttribute("data-src"),o=a.getAttribute("data-rotation"),s=o?parseFloat(o)%360:null;if(!r)return;const n=await this._getThumbnailPixelBlock(r);if(!n)return;a.width=n.width,a.height=n.height;const h=a.getContext("2d");if(!h)return;const d=h.createImageData(a.width,a.height);if(d.data.set(n.getAsRGBA()),typeof s=="number"&&s!==0){const m=q(s),u=document.createElement("canvas"),g=u.getContext("2d");if(g){u.width=d.width,u.height=d.height,g.putImageData(d,0,0);const p=Ge(0,0,m),y=Ge(d.width,0,m),f=Ge(d.width,d.height,m),v=Ge(0,d.height,m),w=Math.max(p[0],y[0],f[0],v[0])-Math.min(p[0],y[0],f[0],v[0]),_=Math.max(p[1],y[1],f[1],v[1])-Math.min(p[1],y[1],f[1],v[1]),M=Math.min(a.width/w,a.height/_);return h.save(),h.clearRect(0,0,a.width,a.height),h.translate(a.width/2,a.height/2),h.rotate(m),h.scale(M,M),h.drawImage(u,-d.width/2,-d.height/2,d.width,d.height),h.restore(),t.unobserve(a)}N.getLogger(this).warn("oriented-imagery-viewer:image-gallery","failed to apply rotation on thumbnail")}h.putImageData(d,0,0),t.unobserve(a)}})}_loadImageFromGallery(e){var a;const{target:t}=e;if(!t)return;const i=t.getAttribute("data-objectid");i&&((a=this.viewModel.currentBestFeature)==null?void 0:a.attributes.objectId)!==Number(i)&&this.viewModel.selectBestFeature(i)}_onAdditionalCoverageVisibilityChange(e){this.viewModel.setAdditionalCoverageVisibility(e)}_onAdditionalCameraLocationsVisibility(e){this.viewModel.setAdditionalCameraLocationsVisibility(e)}_onCurrentCoverageVisibilityChange(e){this.viewModel.setCurrentCoverageVisibility(e)}_registerGalleryItem(e){this._galleryObserver.observe(e)}_renderActionTooltips(){return[...this._actionItems].map(([e,t])=>b("calcite-tooltip",{key:e,label:e,referenceElement:t},b("span",null,e)))}_renderBody(){return b("div",{class:O.body},this._renderViewerContainer(),this.invalidCameraHeading?[this._renderWarning(this.messages.invalidCameraHeadingWarningTitle),this._renderWarningTooltip(this.messages.invalidCameraHeadingWarningDescription)]:[this._renderImageGallery(),this._renderNavigation(),this._renderImageOverlays()],this._renderImageEnhancementTools())}_renderImageEnhancementAction(){const{state:e,mode:t}=this.viewModel;return b("calcite-action",{active:this.imageEnhancementToolActive,afterCreate:this._storeActionElement,bind:this,disabled:t!=="default"||e!=="image-loaded",icon:"sliders-horizontal",onclick:this._toggleImageEnhancementToolState,text:this.messages.imageEnhancement})}_renderImageEnhancementTools(){const{imageEnhancementToolActive:e,viewModel:{brightness:t,contrast:i,sharpness:a,state:r}}=this;return e&&r==="image-loaded"?b("calcite-panel",{bind:this,class:O.imageEnhancementWrapper,closable:!0,closed:!e,heading:this.messages.imageEnhancement,key:this.messages.imageEnhancement,onCalcitePanelClose:this._toggleImageEnhancementToolState},b("div",{class:O.imageEnhancementTools},b("div",{class:O.imageEnhancementToolContainer},b("calcite-label",null,this.messages.brightness,b("calcite-slider",{bind:this,labelTicks:!0,max:10,min:-10,ticks:5,value:t,onCalciteSliderInput:this._handleBrightnessChange}))),b("div",{class:O.imageEnhancementToolContainer},b("calcite-label",null,this.messages.contrast,b("calcite-slider",{bind:this,labelTicks:!0,max:10,min:-10,ticks:5,value:i,onCalciteSliderInput:this._handleContrastChange}))),b("div",{class:O.imageEnhancementToolContainer},b("calcite-label",null,this.messages.sharpness,b("calcite-slider",{bind:this,labelTicks:!0,max:1,min:0,step:.1,ticks:.5,value:a,onCalciteSliderInput:this._handleSharpnessChange})))),b("calcite-action",{bind:this,icon:"reset",onclick:this._resetImageTools,slot:"header-actions-end",text:this.messagesCommon.reset})):null}_renderImageGallery(){const{container:e,galleryOpened:t,imageGalleryEnabled:i,viewModel:{thumbnails:a},invalidCameraHeading:r}=this;return i&&t&&e&&a?b("calcite-panel",{bind:this,class:O.carousel,closable:!0,closed:!t,disabled:r,heading:this.messages.imageGallery,key:this.messages.imageGallery,onCalcitePanelClose:this._toggleImageGallery},b("div",{class:O.carouselContainer},this._renderThumbnails(a))):null}_renderImageOverlaysAction(){const{viewModel:{state:e},imageOverlaysOpened:t,invalidCameraHeading:i}=this;return b("calcite-action",{active:t,afterCreate:this._storeActionElement,bind:this,disabled:e!=="image-loaded"||i,icon:"layers",onclick:this._toggleImageOverlays,text:this.messages.imageOverlays})}_renderImageOverlays(){const{imageOverlaysOpened:e,viewModel:{state:t}}=this;if(e&&t==="image-loaded")return this._imageOverlays.closed&&(this._imageOverlays.closed=!1),la(()=>this._imageOverlays.closed).then(()=>this.imageOverlaysOpened=!1),b("div",{class:O.imageOverlaysContainer,key:this.messages.imageOverlays},this._imageOverlays.render())}_renderWarning(e){const{invalidCameraHeading:t,viewModel:{state:i}}=this;return t&&i==="image-loaded"?[b("calcite-notice",{class:O.alert,closable:!0,icon:"exclamation-mark-triangle-f",iconFlipRtl:!0,kind:"warning",open:!0,scale:"s"},b("div",{afterCreate:a=>this._storeWarningTitleElement(a),slot:"title"},e))]:null}_renderWarningTooltip(e){const{_warningTitleElement:t}=this;if(e!=null&&e.length&&t)return b("calcite-tooltip",{closeOnClick:!0,referenceElement:t},e)}_renderMapImageConversionTool(){const{mapImageConversionToolState:e,viewModel:{state:t},invalidCameraHeading:i}=this;return b("calcite-action",{active:e,afterCreate:this._storeActionElement,bind:this,disabled:t!=="image-loaded"||i,icon:"image-pin",onclick:this._toggleMapImageConversionToolState,text:this.messages.mapImageConversionTool})}_renderNavigation(){const{viewModel:{sectorData:e,navigatorCurrentBestFeature:t,currentBestFeature:i,state:a}}=this;if(!this.container||!i)return null;let r,o,s,n,h;if(t){const{x:v,y:w,direction:_}=t,[M,I,$,R]=at[_];r=`M ${v} ${w} L ${M} ${I} A ${V[2]} ${V[2]} 0 0 1 ${$} ${R} Z`,o=v,n=w,s=at[_][4],h=at[_][5]}const d=v=>{var _;const w=(_=v.target.dataset)==null?void 0:_.sector;w&&this.viewModel.handleSectorClick(+w)},m=v=>{const w=v.target.dataset;if(!w)return;const{featureIndexInSector:_,sector:M}=w;_&&M&&this.viewModel.handleFeatureClick({sector:M,featureIndexInSector:+_})},u=v=>{v.removeEventListener("click",m)},g=i.attributes.objectId,p=e==null?void 0:e.map(v=>v==null?void 0:v.items).filter(Boolean).flatMap(v=>v==null?void 0:v.map(({x:w,y:_,objectID:M,featureIndexInSector:I,sector:$})=>b("circle",{afterRemoved:u,class:this.classes(O.feature,{selected:g===M}),cx:w,cy:_,"data-feature-index-in-sector":I,"data-sector":$,key:`${O.feature}-${M}`,onclick:m,r:yr}))),y=v=>{v.removeEventListener("click",d)},f=this.classes({[O.navigationWrapper]:!0,[O.navigationZoomed]:this._navigationToolExpanded});return this.navigationToolActive&&a==="image-loaded"?b("div",{bind:this,class:f,key:this.messages.navigationTool},b("svg",{afterCreate:v=>this._storeNavigationToolReference(v),class:ea()?K:O.rotateWithAnimation,focusable:"false",height:jt,role:"img",width:jt,xmlns:"http://www.w3.org/2000/svg"},b("defs",null,b("linearGradient",{gradientUnits:"userSpaceOnUse",id:`${this.id}-coverage-fill`,x1:o,x2:s,y1:n,y2:h},b("stop",{class:O.navigationPathOffset0,offset:0}),b("stop",{class:O.navigationPathOffset1,offset:1}))),b("g",null,b("circle",{class:this.classes(O.sector,O.outerSector),cx:V[3],cy:V[3],onclick:this._scaleNavigationTool,r:V[3]}),b("circle",{class:O.sector,cx:V[3],cy:V[3],r:V[2]}),b("circle",{class:O.sector,cx:V[3],cy:V[3],r:V[1]}),b("circle",{class:O.sector,cx:V[3],cy:V[3],r:V[0]}),b("path",{class:O.pointer,d:"M 56.5 6.06217782649107 L 60 0 L 63.5 6.06217782649107 Z",key:`${O.pointer}-west`}),b("path",{class:this.classes(O.pointer,O.north),d:"M 113.93782217350893 56.5 L 120 60 L 113.93782217350893 63.5 Z",key:`${O.pointer}-north`}),b("path",{class:O.pointer,d:"M 56.5 113.93782217350893 L 60 120 L 63.5 113.93782217350893 Z",key:`${O.pointer}-east`}),b("path",{class:O.pointer,d:"M 6.06217782649107 56.5 L 0 60 L 6.06217782649107 63.5 Z",key:`${O.pointer}-south`}),b("path",{class:this.classes(O.sector,O.sectorSeparator),d:"M 23.937554159486076 23.937554159486076 L 96.06244584051393 96.06244584051393 M 23.937554159486076 96.06244584051393 L 96.06244584051393 23.937554159486076",key:O.sectorSeparator}),so([V[2],V[1],V[0]],V[3],V[3]).map((v,w)=>{var _;return b("path",{afterRemoved:y,class:this.classes(O.sector,(_=e==null?void 0:e[w])!=null&&_.length?O.sectorEnabled:O.sectorDisabled),d:v,"data-sector":`${w}`,key:`${O.sector}-${w}`,onclick:d})}),b("path",{class:this.classes(O.sector,O.sectorCross),d:"M 56.4 56.4 L 63.53 63.53 M 63.53 56.4 L 56.4 63.53",key:O.sectorCross}),p,i.attributes.cameraPitch>=5&&r?b("path",{class:O.selectedFeaturePath,d:r,fill:`url(#${this.id}-coverage-fill)`,key:O.selectedFeaturePath}):null))):null}_renderNavigationToolAction(){const{state:e}=this.viewModel;return b("calcite-action",{active:this.navigationToolActive,afterCreate:this._storeActionElement,bind:this,disabled:e!=="image-loaded"||this.invalidCameraHeading,icon:"explore",onclick:this._toggleNavigationTool,text:this.messages.navigationTool})}_renderMenuBarContainer(){const{currentCoverageVisible:e,isAdditionalCoverageVisible:t,isAdditionalPointSourcesVisible:i,imageGalleryEnabled:a,invalidCameraHeading:r}=this;return b("calcite-action-bar",{expandDisabled:!0,layout:"horizontal",slot:"action-bar"},b("calcite-action-group",{expanded:!0},b("calcite-action",{active:e,afterCreate:this._storeActionElement,bind:this,class:O.currentCoverage,disabled:r,icon:"trapezoid-area",onclick:this._toggleCurrentCoverage,text:this.messages.currentFootprint}),b("calcite-action",{active:t,afterCreate:this._storeActionElement,bind:this,class:O.addCoverage,disabled:r,icon:"trapezoid-area",onclick:this._toggleAdditionalCoverage,text:this.messages.additionalFootprints}),b("calcite-action",{active:i,afterCreate:this._storeActionElement,bind:this,class:O.addExpPoints,disabled:r,icon:"circle-area",onclick:this._toggleAdditionalCameraLocations,text:this.messages.additionalCameraLocations})),b("calcite-action-group",{layout:"horizontal"},this.visibleElements.mapImageConversionTool?this._renderMapImageConversionTool():null,this.visibleElements.navigationTool?this._renderNavigationToolAction():null,this.visibleElements.imageEnhancement?this._renderImageEnhancementAction():null),b("calcite-action-group",null,b("calcite-action",{active:this.galleryOpened,afterCreate:this._storeActionElement,bind:this,disabled:!a||r,icon:"images",onclick:this._toggleImageGallery,text:this.messages.imageGallery,textEnabled:!0}),this.visibleElements.imageOverlays?this._renderImageOverlaysAction():null,this.visibleElements.showPopupsAction?this._renderPopupAction():null),this._renderActionTooltips())}_renderMessageBox(){const{messages:e,viewModel:{displayMessage:t}}=this;if(!t)return null;const{data:i,key:a,map:r}=t,o=`${r?Xi(e[a],r):e[a]}`;return b("span",{class:O.messageBox},i?`${o} ${i}`:o)}_renderPopupAction(){return b("calcite-action",{afterCreate:this._storeActionElement,bind:this,disabled:!this.popupEnabled,icon:"popup",onclick:this._toggleImageAttributes,text:this.messages.showPopups,textEnabled:!0})}_renderThumbnails(e){const{currentBestFeature:t}=this.viewModel;return t?b("div",{class:O.carouselContent},e.items.map(({url:i,objectId:a,rotation:r},o)=>b("div",{class:`${O.carouselItemWrapper}${t.attributes.objectId===a?"--selected":""}`,key:`${O.carouselItemWrapper}-${o}`},b("canvas",{afterCreate:this._registerGalleryItem,afterRemoved:this._unregisterGalleryItem,alt:`thumbnail-${a}`,class:O.carouselItem,"data-objectid":`${a}`,"data-rotation":`${r}`,"data-src":i,onclick:this._loadImageFromGallery,onmouseenter:this._highlight,onmouseleave:this._removeHighlight})))):null}_renderViewerContainer(){return b("div",{class:O.viewerContainer},this._renderImageViewer(),this._renderPanoramicViewer(),this._renderMessageBox())}_renderImageViewer(){const{displayMessage:e,loadImageViewer:t,mode:i}=this.viewModel,a=e!=null||i!=="default",r=this.classes({[O.viewer]:!a,[O.viewerHidden]:a});return b("calcite-panel",{afterCreate:t,bind:this,class:r})}_renderPanoramicViewer(){const{displayMessage:e,loadPanoramicViewer:t,mode:i}=this.viewModel,a=e!=null||i!=="panoramic",r=this.classes({[O.viewer]:!a,[O.viewerHidden]:a});return b("calcite-panel",{afterCreate:t,bind:this,class:r})}_resetImageTools(){this.viewModel.sharpness=this.viewModel.brightness=this.viewModel.contrast=0}_storeActionElement(e){this._actionItems.set(e.text,e)}_storeNavigationToolReference(e){this._navigationTool=e}_storeWarningTitleElement(e){this._warningTitleElement=e}_toggleAdditionalCameraLocations(){this.isAdditionalPointSourcesVisible=!this.isAdditionalPointSourcesVisible}_toggleAdditionalCoverage(){this.isAdditionalCoverageVisible=!this.isAdditionalCoverageVisible}_toggleCurrentCoverage(){this.currentCoverageVisible=!this.currentCoverageVisible}_toggleImageEnhancementToolState(e){e.stopPropagation(),this.imageEnhancementToolActive=!this.imageEnhancementToolActive,this.imageEnhancementToolActive&&(this.galleryOpened&&(this.galleryOpened=!1),this.navigationToolActive&&(this.navigationToolActive=!1),this.imageOverlaysOpened&&(this.imageOverlaysOpened=!1))}_toggleImageOverlays(e){e.stopPropagation(),this.imageOverlaysOpened=!this.imageOverlaysOpened,this.imageOverlaysOpened&&(this.galleryOpened&&(this.galleryOpened=!1),this.navigationToolActive&&(this.navigationToolActive=!1),this.imageEnhancementToolActive&&(this.imageEnhancementToolActive=!1))}_toggleImageGallery(e){e.stopPropagation(),this.galleryOpened=!!this.imageGalleryEnabled&&!this.galleryOpened,this.galleryOpened&&(this.imageEnhancementToolActive&&(this.imageEnhancementToolActive=!1),this.navigationToolActive&&(this.navigationToolActive=!1),this.imageOverlaysOpened&&(this.imageOverlaysOpened=!1))}_toggleNavigationTool(){this.navigationToolActive=!this.navigationToolActive,this.navigationToolActive&&(this.galleryOpened&&(this.galleryOpened=!1),this.imageEnhancementToolActive&&(this.imageEnhancementToolActive=!1),this.imageOverlaysOpened&&(this.imageOverlaysOpened=!1))}_toggleMapImageConversionToolState(){this.mapImageConversionToolState=!this.mapImageConversionToolState}_unregisterGalleryItem(e){this._galleryObserver.unobserve(e)}_updateNavigationTool(e){const{previousFeatureAngle:t,bestFeatureAngle:i}=this.viewModel,a=(i-t+540)%360-180;e.style.setProperty(no,`${t}deg`),e.style.setProperty(lo,`${t+a}deg`)}async loadBestImage(e){return this.viewModel.loadBestImage(e)}loadImageFromSource(e,t){return this.viewModel.loadImageFromSource(e,t)}async plotMapPoint(e){return this.viewModel.plotMapPoint(e)}plotReferencePointOnGround(e){this.viewModel.plotReferencePointOnGround(e)}plotReferencePointOnImage(e){this.viewModel.plotReferencePointOnImage(e)}resetImage(){this.viewModel.resetImage()}render(){const{viewModel:{state:e}}=this;return b("div",{class:this.classes(Ke.widget,j)},b("calcite-panel",{bind:this,heading:this.visibleElements.title?this.messages.title:void 0,loading:e==="image-loading"},this.visibleElements.coverageMenu?this._renderMenuBarContainer():null,this._renderBody()))}updateSuitabilities(e){this.viewModel.updateSuitabilities(e)}};l([c()],S.prototype,"activeLayer",null),l([c()],S.prototype,"currentBestFeature",null),l([c()],S.prototype,"currentCoverageVisible",null),l([c()],S.prototype,"disabled",null),l([c()],S.prototype,"features",null),l([c()],S.prototype,"imagePointsInView",null),l([c()],S.prototype,"galleryOpened",void 0),l([c()],S.prototype,"icon",null),l([c()],S.prototype,"imageEnhancementToolActive",void 0),l([c({readOnly:!0})],S.prototype,"imageGalleryEnabled",null),l([c()],S.prototype,"imageOverlaysOpened",void 0),l([c({readOnly:!0})],S.prototype,"invalidCameraHeading",null),l([c()],S.prototype,"isAdditionalCoverageVisible",null),l([c()],S.prototype,"isAdditionalPointSourcesVisible",null),l([c()],S.prototype,"mapImageConversionToolState",null),l([c()],S.prototype,"layer",null),l([c()],S.prototype,"navigationToolActive",void 0),l([c({type:Yi})],S.prototype,"viewModel",void 0),l([c(),Nt("esri/widgets/OrientedImageryViewer/t9n/OrientedImageryViewer")],S.prototype,"messages",void 0),l([c(),Nt("esri/t9n/common")],S.prototype,"messagesCommon",void 0),l([c({readOnly:!0})],S.prototype,"popupEnabled",null),l([c()],S.prototype,"referencePoint",null),l([c()],S.prototype,"view",null),l([c({type:Ki,nonNullable:!0})],S.prototype,"visibleElements",void 0),l([c()],S.prototype,"determineWorkflowForFeature",null),l([c()],S.prototype,"updateFootprint",null),l([c()],S.prototype,"_navigationToolExpanded",void 0),l([c()],S.prototype,"_navigationTool",void 0),l([c()],S.prototype,"_imageOverlays",void 0),l([c()],S.prototype,"_warningTitleElement",void 0),S=l([ie("esri.widgets.OrientedImageryViewer")],S);const fs=S,rl=Object.freeze(Object.defineProperty({__proto__:null,default:fs},Symbol.toStringTag,{value:"Module"}));export{il as M,rl as O,zi as Q,Un as W,Ai as Z,Xn as b,el as c,tl as u,ct as z};
