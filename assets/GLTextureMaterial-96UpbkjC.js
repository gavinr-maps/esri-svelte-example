import{K as s,S as o}from"./Accessor-BmwT4B0c.js";import{O as l}from"./basicInterfaces-CZwQPxTp.js";import{e as _}from"./FloatArray-BQXWSSJh.js";import{c}from"./NoParameters-t-PuNrgq.js";class f extends _{constructor(t){super(t),this._numLoading=0,this._disposed=!1,this._textures=t.textures,this.updateTexture(t.textureId),this._acquire(t.normalTextureId,e=>this._textureNormal=e),this._acquire(t.emissiveTextureId,e=>this._textureEmissive=e),this._acquire(t.occlusionTextureId,e=>this._textureOcclusion=e),this._acquire(t.metallicRoughnessTextureId,e=>this._textureMetallicRoughness=e)}dispose(){super.dispose(),this._texture=s(this._texture),this._textureNormal=s(this._textureNormal),this._textureEmissive=s(this._textureEmissive),this._textureOcclusion=s(this._textureOcclusion),this._textureMetallicRoughness=s(this._textureMetallicRoughness),this._disposed=!0}ensureResources(t){return this._numLoading===0?l.LOADED:l.LOADING}get textureBindParameters(){return new m(this._texture!=null?this._texture.glTexture:null,this._textureNormal!=null?this._textureNormal.glTexture:null,this._textureEmissive!=null?this._textureEmissive.glTexture:null,this._textureOcclusion!=null?this._textureOcclusion.glTexture:null,this._textureMetallicRoughness!=null?this._textureMetallicRoughness.glTexture:null)}updateTexture(t){this._texture!=null&&t===this._texture.id||(this._texture=s(this._texture),this._textureId=t,this._acquire(this._textureId,e=>this._texture=e))}_acquire(t,e){if(t==null)return void e(null);const u=this._textures.acquire(t);if(o(u))return++this._numLoading,void u.then(i=>{if(this._disposed)return s(i),void e(null);e(i)}).finally(()=>--this._numLoading);e(u)}}class a extends c{constructor(t=null){super(),this.textureEmissive=t}}class m extends a{constructor(t=null,e=null,u=null,i=null,n=null,h,x){super(u),this.texture=t,this.textureNormal=e,this.textureOcclusion=i,this.textureMetallicRoughness=n,this.scale=h,this.normalTextureTransformMatrix=x}}export{m as n,f as r};
