const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-jjUP6Yam.js","./index-CMxz6F2k.js","./jsxFactory-Cnml7uXM.js","./Accessor-BmwT4B0c.js","./intl-Duiy0OzY.js","./Promise-DfET-uns.js","./cast-CsZslgGN.js","./index-4eY77cms.js","./index-Cx51aysm.css","./JSONSupport-DcrLLGjL.js","./Evented-Dw4_VOGn.js","./reactiveUtils-XM7cS2OP.js","./SimpleObservable-CvOkykwM.js","./uuid-Cl5lrJ4c.js","./guid-ejniuQmw.js","./useT9n-C1Hrfc-A.js","./index-DwIhxbHs.js","./dom-DEluURzl.js","./observers-Co4E8E8j.js","./ref-D9wHsL_T.js","./directive-helpers-DaBykg1t.js","./static-DLD4WjLv.js","./form-BzoUrXC7.js","./interactive-DTzfFku4.js","./label-CHHpnzD0.js","./loadable-XBvaWFYY.js","./component-CBVlbUuE.js","./index-DUx6F4yX.js","./index-BSn6RZnP.js","./keyed-CU1C-h1n.js","./_commonjsHelpers-DqlTr81k.js","./global-BYws3GYH.js","./index-fFnlo_g2.js","./index-DWeq-ojO.js","./customElement-BxsvsANk.js","./live-D7NQ-TrC.js","./Validation-BYp9DS84.js","./input-DI9tZAPS.js","./index-BVlRRyQC.js","./key-CZcQa38B.js","./locale-CXx8I9ox.js","./index-DLytGOKi.js","./index-B3pS2bTY.js","./core-zHisM37C.js","./index-yzfJymDm.js","./index-MCMiazMa.js","./repeat-B6KIBwLP.js","./math-BpAtBkbz.js","./throttle-DCm6gPaM.js","./debounce-DbkufipY.js","./index-DMeQur4V.js","./index-BPm91e5Z.js","./floating-ui-IixYHfbQ.js","./openCloseComponent-nqWrSaIH.js","./FloatingArrow-BZRr6Zld.js","./useFocusTrap-COeL24Kx.js","./focusTrapComponent-D1wJZ4RD.js","./index--OBudxYA.js","./index-Brz2wqWq.js","./index-Cl-EVQNh.js","./index-Dwo8yu4W.js"])))=>i.map(i=>d[i]);
import{_ as y,L as $e,u as Oe,c as ke,n as Ve,i as Ee,a as ze}from"./index-4eY77cms.js";import{g as z,r as i,m as s,a as w,i as Z,D as ge,e as Me,N as I,G as Re,ag as Ae,l as Ie}from"./Accessor-BmwT4B0c.js";import{l as xe}from"./intl-Duiy0OzY.js";import{V as we,a as ye,d as m,A as v}from"./reactiveUtils-XM7cS2OP.js";import{m as h,i as W}from"./timeUtils-C1c_L2Fd.js";import{s as fe}from"./substitute-CvdjmBYq.js";import{A as be}from"./Slider-BHSjZzBC.js";import{n as r,v as Le,O as H,c as B,e as U}from"./jsxFactory-Cnml7uXM.js";import{h as f}from"./Color-VJEMvW-n.js";import{c as oe,f as He,s as Ue}from"./screenUtils-_ZIvrt5o.js";import{n as Ne}from"./vec3f64-BLpZdpfb.js";import{a as Fe}from"./earthUtils-8WLQbUUl.js";import{D as Ge,t as X}from"./ShadowCastVisualizeTechniqueConfiguration-vN_a9xco.js";import{n as Be}from"./collectionUtils-CTT-51g7.js";import{e as We}from"./throttle-jjSnxk80.js";import{n as je}from"./traversalUtils-DmE6QkgJ.js";import{n as L}from"./uuid-Cl5lrJ4c.js";import{d as se,r as qe,s as Je,E as Ke}from"./Promise-DfET-uns.js";import{e as Qe}from"./mathUtils-Cfq9PL9W.js";import{e as Y}from"./globalCss-vQlnDsEX.js";import{e as ae}from"./Heading-BcR6CGTM.js";import{r as Xe,u as Ye,m as Ze,l as et,f as tt}from"./TimezonePicker-BccfRSln.js";import{P as it}from"./useWidget-BajufX8l.js";import"./cast-CsZslgGN.js";import"./JSONSupport-DcrLLGjL.js";import"./Evented-Dw4_VOGn.js";import"./SimpleObservable-CvOkykwM.js";import"./colorUtils-Rxh2V3ai.js";import"./Point-Cz2JYYmX.js";import"./writer-DKgfqj4X.js";import"./mat4-Fi6iAz29.js";import"./common-DQOJ18NT.js";import"./mat4f64-Dk4dwAN8.js";import"./vec2-ChnYg_BJ.js";import"./vec2f64-Dy6m9Nrb.js";import"./vec32-Dvg_eL9J.js";import"./ViewingMode-Dodu7ZZk.js";import"./SunCalc-uwgdo0BB.js";import"./mathUtils-BgCEaV43.js";import"./ShaderTechniqueConfiguration-D4dZMCXS.js";import"./NoParameters-t-PuNrgq.js";import"./index-C5b9dHRB.js";import"./component-utils-D0ciaaZ_.js";const g="esri-shadow-cast",P={base:g,timeRange:`${g}__time-range`,timeRangeIndicator:`${g}__time-range__indicator`,datePickerContainer:`${g}__date-picker-container`,datePicker:`${g}__date-picker`,visualization:`${g}__visualization`,visualizationSelect:`${g}__visualization__select`,visualizationConfigHidden:`${g}__visualization__config--hidden`},ot=`${g}__label`,re=`${g}__threshold-config`,ne={base:re,valueLabel:`${re}__value-label`},le=`${g}__duration-config`,de={base:le,radioGroup:`${le}__radio-group`},st=`${g}__discrete-config`,at={base:st},ce=`${g}__tooltip`,ue={base:ce,content:`${ce}__content`};var x;(function(e){e.Disabled="disabled",e.Ready="ready"})(x||(x={}));let M=class extends z{constructor(){super({}),this.color=new f([50,50,50,.7]),this.intervalOptions=new we([h(15,"minutes","milliseconds"),h(30,"minutes","milliseconds"),h(1,"hours","milliseconds"),h(2,"hours","milliseconds"),h(3,"hours","milliseconds")]),this.interval=this.intervalOptions.at(0)}set intervalOptions(t){this._set("intervalOptions",Be(t,this._get("intervalOptions")))}};i([s({type:f})],M.prototype,"color",void 0),i([s()],M.prototype,"interval",void 0),i([s({type:we})],M.prototype,"intervalOptions",null),M=i([w("esri.widgets.ShadowCast.DiscreteOptions")],M);const Te=M;var O;(function(e){e.Continuous="continuous",e.Hourly="hourly"})(O||(O={}));let F=class extends z{constructor(){super(...arguments),this.color=new f([0,0,255,.7]),this.mode=O.Continuous}};i([s({type:f})],F.prototype,"color",void 0),i([s()],F.prototype,"mode",void 0),F=i([w("esri.widgets.ShadowCast.DurationOptions")],F);const Ce=F;var $;(function(e){e.PointerMove="pointer-move",e.Main="main"})($||($={}));const rt=300;let T=class extends z{constructor(t){super(t),this._screenPoint=null,this._accumulatedShadowTime=null,this._shadowTimeTask=null,this._updateAccumulatedShadowTime=(o,a)=>{this._shadowTimeTask=Z(this._shadowTimeTask),this._shadowTimeTask=ye(async n=>{const{results:l,ground:c}=await o.hitTest(a);if(ge(n),l.length===0&&!c.mapPoint)return void(this._accumulatedShadowTime=null);const b=await this.getDuration(a,n);this._accumulatedShadowTime=b})},this._throttledUpdateAccumulatedShadowTime=We(this._updateAccumulatedShadowTime,rt)}initialize(){this.addHandles(m(()=>({enabled:this.enabled,view:this.view}),({enabled:t,view:o})=>{t&&o!=null?this._startTracking(o):this._stopTracking()},v))}get screenPoint(){return this.enabled?this._screenPoint:null}get accumulatedShadowTime(){return this.enabled?this._accumulatedShadowTime:null}get testData(){}_startTracking(t){if(this.hasHandles($.Main))return;const o=()=>{this.hasHandles($.PointerMove)||this.addHandles(t.on("pointer-move",n=>{const l=oe(n.x,n.y);this._screenPoint=l,this._throttledUpdateAccumulatedShadowTime(t,l)}),$.PointerMove)},a=()=>{this.removeHandles($.PointerMove),this._screenPoint=null,this._accumulatedShadowTime=null};this.addHandles([this._throttledUpdateAccumulatedShadowTime,t.on("pointer-enter",o),t.on("pointer-leave",a),t.on("pointer-down",a),t.on("pointer-drag",a),t.on("pointer-up",o),t.on("click",n=>{const l=oe(n.x,n.y);this._screenPoint=l,this._updateAccumulatedShadowTime(t,l)}),Me(()=>{this._shadowTimeTask=Z(this._shadowTimeTask)})],$.Main),o()}_stopTracking(){this.removeHandles($.Main)}};i([s()],T.prototype,"getDuration",void 0),i([s()],T.prototype,"view",void 0),i([s()],T.prototype,"enabled",void 0),i([s()],T.prototype,"screenPoint",null),i([s()],T.prototype,"accumulatedShadowTime",null),i([s()],T.prototype,"_screenPoint",void 0),i([s()],T.prototype,"_accumulatedShadowTime",void 0),i([s()],T.prototype,"_shadowTimeTask",void 0),T=i([w("esri.widgets.ShadowCast.ShadowTooltipViewModel")],T);var u;(function(e){e.Threshold="threshold",e.Duration="duration",e.Discrete="discrete"})(u||(u={}));u.Threshold,u.Duration,u.Discrete;let k=class extends z{constructor(){super(...arguments),this.color=new f([255,0,0,.7]),this.value=h(4,"hours","milliseconds"),this.minValue=0,this.maxValue=h(8,"hours","milliseconds")}};i([s({type:f})],k.prototype,"color",void 0),i([s()],k.prototype,"value",void 0),i([s()],k.prototype,"minValue",void 0),i([s()],k.prototype,"maxValue",void 0),k=i([w("esri.widgets.ShadowCast.ThresholdOptions")],k);const Pe=k,he=[],nt=Ne(),pe=[],me=255,lt=h(1,"hours","milliseconds"),dt=500;let d=class extends z{constructor(e){super(e),this.view=null,this.tooltip=new T({getDuration:(t,o)=>this.getDuration(t,o)}),this.startTimeOfDay=h(10,"hours","milliseconds"),this.endTimeOfDay=h(16,"hours","milliseconds"),this.visualizationType=u.Threshold,this.thresholdOptions=new Pe,this.durationOptions=new Ce,this.discreteOptions=new Te,this._running=!0,this._stopPreviewingTask=null,this._forcePreview=!1,this._autoRestoreForcePreviewEnabled=!0,this._utcOffset=null,this.date=new Date}initialize(){this.addHandles([m(()=>({view:this.view,tooltipEnabled:this._tooltipEnabled}),({view:e,tooltipEnabled:t})=>{this.tooltip.view=e,this.tooltip.enabled=t},v),m(()=>this._forcePreviewDependencies,()=>{Z(this._stopPreviewingTask),this._forcePreview=!0,this._autoRestoreForcePreviewEnabled&&(this._stopPreviewingTask=ye(async e=>{await Ae(dt,e),ge(e),this._forcePreview=!1}))},v),m(()=>({renderer:this.renderer,parameters:this._visualizationParameters}),e=>N(e.renderer,e.parameters),v),m(()=>({renderer:this.renderer,parameters:{lightDirections:this._lightDirections}}),e=>N(e.renderer,e.parameters),v),m(()=>({renderer:this.renderer,parameters:{enabled:this._running}}),e=>N(e.renderer,e.parameters),v),m(()=>({renderer:this.renderer,parameters:{previewing:this._previewing}}),e=>N(e.renderer,e.parameters),v)])}destroy(){this.stop(),N(this.renderer,{enabled:!1}),I(this.tooltip)}get state(){return this.view!=null&&this.view.ready&&this._referencePosition!=null?x.Ready:x.Disabled}set date(e){const t=new Date(e);t.setHours(0,0,0,0),this._set("date",t)}get utcOffset(){return this._utcOffset??this._utcOffsetAuto}set utcOffset(e){this._utcOffset=e}get testData(){}get _previewing(){const{view:e}=this;return(e==null?void 0:e.allLayerViews)==null||this._forcePreview||!e.stationary||e.allLayerViews.some(t=>ee(t)&&t.updating)}get _utcOffsetAuto(){const e=this._referencePosition;return e!=null?Fe(e[0],!1):0}get _dateUTCOffset(){let e=this.date;return e=W(e,-e.getTimezoneOffset(),"minutes"),e=W(e,-this.utcOffset,"hours"),e}get _startDateTimeUTC(){return W(this._dateUTCOffset,this.startTimeOfDay)}get _endDateTimeUTC(){return W(this._dateUTCOffset,this.endTimeOfDay)}get _referencePosition(){var e,t;return(t=(e=this.view)==null?void 0:e.environmentManager)==null?void 0:t.referencePositionGeographic}get _interval(){const e=this._duration>0?Math.floor(this._duration/me):me,t=this.discreteOptions.interval;switch(this.visualizationType){case u.Threshold:case u.Duration:return e;case u.Discrete:return t>0?t:e}}get _sampleCount(){return this._lightDirections.length}get _duration(){return this.endTimeOfDay-this.startTimeOfDay}get _lightDirections(){const{view:e}=this;if(e==null)return he;const t=e.viewingMode==="global"?nt:this._referencePosition;if(t==null)return he;const o=this._interval,a=Ge(this._startDateTimeUTC,this._endDateTimeUTC,o,t,e.state.viewingMode),n=a.length;pe.length=0;const l=je(0,n,pe),c=new Array(n);for(let b=0;b<n;++b)c[b]=a[l[b]];return c}get _tooltipEnabled(){return this.state===x.Ready&&this.visualizationType!==u.Discrete&&this._running&&!this._previewing}get _visualizationParameters(){if(!this._running)return null;switch(this.visualizationType){case u.Threshold:return this._thresholdVisualizationParameters;case u.Duration:return this._durationVisualizationParameters;case u.Discrete:return this._discreteVisualizationParameters}}get _thresholdVisualizationParameters(){const{value:e,color:t}=this.thresholdOptions,o=this._duration;return{visualization:X.Threshold,color:f.toUnitRGBA(t),threshold:o>0?e/this._duration:0}}get _durationVisualizationParameters(){const{color:e,mode:t}=this.durationOptions,o=this._duration,a=o>0&&t===O.Hourly?lt/o:0;return{color:f.toUnitRGBA(e),visualization:X.Gradient,bandsEnabled:a>0,bandSize:a}}get _discreteVisualizationParameters(){return{color:f.toUnitRGBA(this.discreteOptions.color),visualization:X.Gradient,bandsEnabled:!1,bandSize:0}}get _forcePreviewDependencies(){const{view:e}=this;if(e==null)return null;const t=e.slicePlane,o=e.allLayerViews.toArray().filter(ee),a=o.map(p=>p.layer).filter(Re),n=o.map(p=>p.visible),l=a.map(p=>p.visible),c=a.map(p=>p.opacity),b=a.filter(p=>"definitionExpression"in p).map(p=>p.definitionExpression),Q=o.filter(p=>"filter"in p).map(p=>p.filter);return{slicePlane:t,startDateUTC:this._startDateTimeUTC,endDateUTC:this._endDateTimeUTC,layerViewVisibilities:n,layerVisibilities:l,layerOpacities:c,filters:Q,definitionExpressions:b}}get renderer(){const{view:e}=this;if(e==null)return null;const t=e._stage;return t==null?null:t.renderer}start(){this.setRunning(!0)}stop(){this.setRunning(!1)}setRunning(e){this._running=e}async getDuration(e,t){const{view:o,renderer:a,_sampleCount:n}=this;if(o==null||a==null||n===0)return 0;const l=o.state.camera.screenToRender(He(e.x,e.y),Ue());return a.readAccumulatedShadow(l)*this._duration}};function N(e,t){e!=null&&t!=null&&e.setParameters({shadowCast:t})}function ee(e){if(e.suspended)return!1;switch(e.type){case"building-scene-3d":case"csv-3d":case"elevation-3d":case"feature-3d":case"geojson-3d":case"graphics-3d":case"integrated-mesh-3d":case"integrated-mesh-3dtiles":case"ogc-feature-3d":case"route-3d":case"scene-layer-3d":case"scene-layer-graphics-3d":case"stream-3d":case"wms-3d":return!0;case"base-dynamic-3d":case"catalog-3d":case"catalog-footprint-3d":case"catalog-dynamic-group-3d":case"dimension-3d":case"imagery-3d":case"imagery-tile-3d":case"line-of-sight-3d":case"map-image-3d":case"point-cloud-3d":case"tile-3d":case"vector-tile-3d":case"viewshed-3d":case"voxel-3d":case"wfs-3d":case"wmts-3d":case"media-3d":default:return!1;case"group":return e.layerViews.toArray().some(t=>ee(t))}}i([s()],d.prototype,"state",null),i([s()],d.prototype,"view",void 0),i([s()],d.prototype,"tooltip",void 0),i([s({type:Date,nonNullable:!0})],d.prototype,"date",null),i([s({nonNullable:!0})],d.prototype,"utcOffset",null),i([s({nonNullable:!0})],d.prototype,"startTimeOfDay",void 0),i([s({nonNullable:!0})],d.prototype,"endTimeOfDay",void 0),i([s({nonNullable:!0})],d.prototype,"visualizationType",void 0),i([s({type:Pe,nonNullable:!0})],d.prototype,"thresholdOptions",void 0),i([s({type:Ce,nonNullable:!0})],d.prototype,"durationOptions",void 0),i([s({type:Te,nonNullable:!0})],d.prototype,"discreteOptions",void 0),i([s()],d.prototype,"_running",void 0),i([s()],d.prototype,"_stopPreviewingTask",void 0),i([s()],d.prototype,"_forcePreview",void 0),i([s()],d.prototype,"_autoRestoreForcePreviewEnabled",void 0),i([s()],d.prototype,"_previewing",null),i([s()],d.prototype,"_utcOffset",void 0),i([s()],d.prototype,"_utcOffsetAuto",null),i([s()],d.prototype,"_dateUTCOffset",null),i([s()],d.prototype,"_startDateTimeUTC",null),i([s()],d.prototype,"_endDateTimeUTC",null),i([s()],d.prototype,"_referencePosition",null),i([s()],d.prototype,"_interval",null),i([s()],d.prototype,"_sampleCount",null),i([s()],d.prototype,"_duration",null),i([s()],d.prototype,"_lightDirections",null),i([s()],d.prototype,"_tooltipEnabled",null),i([s()],d.prototype,"_visualizationParameters",null),i([s()],d.prototype,"_thresholdVisualizationParameters",null),i([s()],d.prototype,"_durationVisualizationParameters",null),i([s()],d.prototype,"_discreteVisualizationParameters",null),i([s()],d.prototype,"_forcePreviewDependencies",null),i([s()],d.prototype,"renderer",null),d=i([w("esri.widgets.ShadowCast.ShadowCastViewModel")],d);const ct=d;let D=class extends z{constructor(){super(...arguments),this.timeRangeSlider=!0,this.timezone=!0,this.datePicker=!0,this.visualizationOptions=!0,this.colorPicker=!0,this.tooltip=!0}};i([s()],D.prototype,"timeRangeSlider",void 0),i([s()],D.prototype,"timezone",void 0),i([s()],D.prototype,"datePicker",void 0),i([s()],D.prototype,"visualizationOptions",void 0),i([s()],D.prototype,"colorPicker",void 0),i([s()],D.prototype,"tooltip",void 0),D=i([w("esri.widgets.ShadowCast.ShadowCastVisibleElements")],D);const De=D;function Se(e,t="milliseconds",o={}){const a={locale:ut(),numberingSystem:"latn"};let n;return n=e?se.fromMillis(h(e,t,"milliseconds"),a).rescale():se.fromObject({seconds:0},a),n.toHuman({listStyle:"narrow",unitDisplay:"long",...o})}function ut(){return Je()==="bs"?"hr":qe()}function K(e,t){const{for:o,label:a,tabIndex:n,...l}=e;return r("div",{class:Le(ot,l==null?void 0:l.class),key:o,...l},r("calcite-label",{for:o,scale:"s",tabIndex:n},a),t)}const j="esri-color-picker",q={base:j,backgroundPattern:`${j}__bg-pattern`,toggleButton:`${j}__toggle-button`,popover:`${j}__popover`};let C=class extends H{constructor(t,o){super(t,o),this.value=new f,this.alphaEnabled=!0,this._containerElement=null,this._button=null,this._open=!1,this._onColorInput=a=>{var c;const n=a.currentTarget.value,l=typeof n=="string"?new f(n):new f;this.value=l,(c=this.onChange)==null||c.call(this,l)}}initialize(){this.addHandles(m(()=>({container:this._containerElement,value:this.value}),({container:t,value:o})=>{t==null||t.style.setProperty("--esri-color-picker-value",o.toCss(!0))},v))}loadDependencies(){return B({button:()=>y(()=>import("./index-jjUP6Yam.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]),import.meta.url),"color-picker":()=>y(()=>import("./index-DUx6F4yX.js"),__vite__mapDeps([27,28,2,3,4,5,6,7,8,9,10,11,12,13,29,20,30,31,17,14,16,18,32,33,34,35,19,22,23,24,25,26,36,37,15,38,39,40,41,1,0,21,42,43,44,45,46,47,48,49]),import.meta.url),popover:()=>y(()=>import("./index-DMeQur4V.js").then(t=>t.i),__vite__mapDeps([50,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,51,29,20,19,23,25,26,52,49,53,21,54,55,56,39]),import.meta.url)})}render(){const t=this._messages,o=this._open?t.close:t.open;return r("div",{afterCreate:a=>this._containerElement=a,class:this.classes(q.base,this.class)},r("div",{class:q.backgroundPattern,key:"background-pattern"}),r("calcite-button",{afterCreate:a=>this._button=a,appearance:"transparent",class:q.toggleButton,key:"popover-trigger",kind:"neutral",label:o,scale:"s",tabIndex:-1,title:o}),r("calcite-popover",{autoClose:!0,class:q.popover,key:"popover",label:t.label,overlayPositioning:"fixed",referenceElement:this._button,onCalcitePopoverClose:()=>this._open=!1,onCalcitePopoverOpen:()=>this._open=!0},r("calcite-color-picker",{alphaChannel:this.alphaEnabled,channelsDisabled:!0,key:"color-picker",savedDisabled:!0,value:this.value.toCss(!0),onCalciteColorPickerInput:this._onColorInput})))}};i([s()],C.prototype,"class",void 0),i([s()],C.prototype,"value",void 0),i([s()],C.prototype,"alphaEnabled",void 0),i([s()],C.prototype,"onChange",void 0),i([s()],C.prototype,"_containerElement",void 0),i([s()],C.prototype,"_button",void 0),i([s()],C.prototype,"_open",void 0),i([s(),U("esri/widgets/support/t9n/ColorPicker")],C.prototype,"_messages",void 0),C=i([w("esri.widgets.support.ColorPicker")],C);function ie(e){return r(K,{for:e.id,label:e.label,tabIndex:-1},r(C,{id:e.id,value:e.value,onChange:e.onChange}))}let R=class extends H{constructor(t){super(t),this.colorPickerVisible=!0,this._selectId=`select-${L()}`,this._colorPickerId=`color-picker-${L()}`,this._onColorChange=o=>{this.options.color=o}}loadDependencies(){return B({label:()=>y(()=>import("./index--OBudxYA.js"),__vite__mapDeps([57,2,3,4,5,6,7,8,9,10,11,12,13,24,17,14]),import.meta.url),option:()=>y(()=>import("./index-Brz2wqWq.js"),__vite__mapDeps([58,2,3,4,5,6,7,8,9,10,11,12,13,18]),import.meta.url),select:()=>y(()=>import("./index-Cl-EVQNh.js"),__vite__mapDeps([59,16,2,3,4,5,6,7,8,9,10,11,12,13,17,14,18,32,19,20,22,23,24,25,26,36]),import.meta.url)})}render(){const t=this._messages.discrete,o=t.intervalLabel,{color:a,interval:n,intervalOptions:l}=this.options;return r("div",{class:at.base},r(K,{for:this._selectId,label:o},r("calcite-select",{bind:this,id:this._selectId,label:o,onCalciteSelectChange:this._onIntervalChange},l.toArray().map(c=>r("calcite-option",{key:c,selected:c===n,value:String(c)},Se(c))))),this.colorPickerVisible?r(ie,{id:this._colorPickerId,label:t.colorLabel,value:a,onChange:this._onColorChange}):null)}_onIntervalChange(t){var a;const o=parseInt((a=t.currentTarget.selectedOption)==null?void 0:a.value,10);Number.isFinite(o)&&(this.options.interval=o)}};i([s()],R.prototype,"options",void 0),i([s()],R.prototype,"colorPickerVisible",void 0),i([s(),U("esri/widgets/ShadowCast/t9n/ShadowCast")],R.prototype,"_messages",void 0),R=i([w("esri.widgets.ShadowCast.components.DiscreteConfigurator")],R);let A=class extends H{constructor(t){super(t),this.colorPickerVisible=!0,this._modeSelectorId=`mode-selector-${L()}`,this._colorPickerId=`color-picker-${L()}`,this._onColorChange=o=>{this.options.color=o},this._setContinuous=()=>{this.options.mode=O.Continuous},this._setHourly=()=>{this.options.mode=O.Hourly}}loadDependencies(){return B({button:()=>y(()=>import("./index-jjUP6Yam.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]),import.meta.url),label:()=>y(()=>import("./index--OBudxYA.js"),__vite__mapDeps([57,2,3,4,5,6,7,8,9,10,11,12,13,24,17,14]),import.meta.url)})}render(){const t=this._messages.duration,{color:o,mode:a}=this.options;return r("div",{class:de.base},r(K,{for:this._modeSelectorId,label:t.modeLabel},r("div",{class:de.radioGroup},r(ve,{active:a===O.Continuous,label:t.continuousLabel,onclick:this._setContinuous}),r(ve,{active:a===O.Hourly,label:t.hourlyLabel,onclick:this._setHourly}))),this.colorPickerVisible?r(ie,{id:this._colorPickerId,label:t.colorLabel,value:o,onChange:this._onColorChange}):null)}};function ve({active:e,label:t,...o}){return r("calcite-button",{alignment:"center",appearance:e?"solid":"outline",scale:"s",width:"full",...o},t)}i([s()],A.prototype,"options",void 0),i([s()],A.prototype,"colorPickerVisible",void 0),i([s(),U("esri/widgets/ShadowCast/t9n/ShadowCast")],A.prototype,"_messages",void 0),A=i([w("esri.widgets.ShadowCast.components.DurationConfigurator")],A);const ht=h(1,"minutes","milliseconds"),_e=h(15,"minutes","milliseconds");let V=class extends H{constructor(e,t){super(e,t),this.accumulatedShadowTime=null,this._messages=null}render(){const e=this._formattedContent;return r("div",{class:ue.base},e?r("div",{class:ue.content},e):null)}get _formattedContent(){const e=this._messages,t=this.accumulatedShadowTime;if(e==null||t==null)return null;const o=Qe(t,t<_e?ht:_e);return fe(e.timeInShadow,{duration:Se(o)})}};i([s()],V.prototype,"accumulatedShadowTime",void 0),i([s()],V.prototype,"view",void 0),i([s(),U("esri/widgets/ShadowCast/t9n/ShadowCast")],V.prototype,"_messages",void 0),i([s({readOnly:!0})],V.prototype,"_formattedContent",null),V=i([w("esri.widgets.ShadowCast.components.ShadowTooltipContent")],V);let E=class extends z{constructor(e){super(e),this._updateHandle=null,this._contentContainer=this._createContainer()}initialize(){this.container.appendChild(this._contentContainer),this._contentWidget=new V({},this._contentContainer),this._updateHandle=m(()=>{const e=this._contentContainer,{screenPoint:t,accumulatedShadowTime:o}=this.viewModel.tooltip;return{contentContainer:e,screenPoint:t,accumulatedShadowTime:o}},e=>this._update(e),v)}destroy(){this._updateHandle=Ie(this._updateHandle),this._contentWidget=I(this._contentWidget),this.container.contains(this._contentContainer)&&this.container.removeChild(this._contentContainer)}get testData(){}_update({contentContainer:e,screenPoint:t,accumulatedShadowTime:o}){const{style:a}=e;t!=null?(a.display="block",a.transform=`translate(${t.x}px, ${t.y}px)`,this._contentWidget.accumulatedShadowTime=o):a.display="none"}_createContainer(){const e=document.createElement("div"),{style:t}=e;return t.position="absolute",t.top="0",t.left="0",e}};i([s()],E.prototype,"viewModel",void 0),i([s()],E.prototype,"container",void 0),i([s()],E.prototype,"_contentContainer",void 0),i([s()],E.prototype,"_contentWidget",void 0),E=i([w("esri.widgets.ShadowCast.components.ShadowTooltip")],E);let S=class extends H{constructor(e){super(e),this.colorPickerVisible=!0,this._valueSliderId=`value-slider-${L()}`,this._colorPickerId=`color-picker-${L()}`,this._valueSlider=new be({visibleElements:{labels:!1,rangeLabels:!1},steps:h(30,"minutes","milliseconds"),labelFormatFunction:(t,o)=>{const a=h(t,"milliseconds","hours");return o==="tick"?xe(a,{maximumFractionDigits:0}):""}}),this._onColorChange=t=>{this.options.color=t}}initialize(){const e=({value:t})=>{this.options.value=t};this.addHandles([m(()=>{const{value:t,minValue:o,maxValue:a}=this.options;return{value:t,minValue:o,maxValue:a}},({value:t,minValue:o,maxValue:a})=>{const n=this._valueSlider;n.min=o,n.max=a,n.values=[t];const l=a-o,c=Math.floor(h(l,"milliseconds","hours"));n.tickConfigs=[{mode:"count",values:2*c+1,labelsVisible:!1},{mode:"count",values:c+1,labelsVisible:!0}]},v),this._valueSlider.on("thumb-change",e),this._valueSlider.on("thumb-drag",e)])}loadDependencies(){return B({label:()=>y(()=>import("./index--OBudxYA.js"),__vite__mapDeps([57,2,3,4,5,6,7,8,9,10,11,12,13,24,17,14]),import.meta.url)})}destroy(){this._valueSlider=I(this._valueSlider)}render(){const e=this._messages.threshold,{color:t}=this.options;return r("div",{class:ne.base},r(K,{class:ne.valueLabel,for:this._valueSliderId,label:e.valueLabel},this._valueSlider.render()),this.colorPickerVisible?r(ie,{id:this._colorPickerId,label:e.colorLabel,value:t,onChange:this._onColorChange}):null)}get testData(){}};i([s()],S.prototype,"options",void 0),i([s()],S.prototype,"colorPickerVisible",void 0),i([s()],S.prototype,"testData",null),i([s()],S.prototype,"_valueSlider",void 0),i([s(),U("esri/widgets/ShadowCast/t9n/ShadowCast")],S.prototype,"_messages",void 0),S=i([w("esri.widgets.ShadowCast.components.ThresholdConfigurator")],S);var J;(function(e){e.Slider="slider"})(J||(J={}));const pt={labelFormatFunction:Ze,min:0,max:1439,steps:15,rangeLabelInputsEnabled:!1,visibleElements:{labels:!1,rangeLabels:!1},tickConfigs:[{mode:"position",values:[0,360,720,1080,1439],labelsVisible:!0,tickCreatedFunction:(e,t,o)=>Xe({tickElement:t,labelElement:o})},{mode:"position",values:[120,240,480,600,840,960,1200,1320],tickCreatedFunction:(e,t)=>Ye({tickElement:t})}]};let _=class extends H{constructor(e,t){super(e,t),this.viewModel=null,this.headingLevel=4,this.visibleElements=new De,this._defaultViewModel=null,this._timeSlider=new be({...pt,container:document.createElement("div")}),this._tooltip=null,this._onTimezoneChange=o=>{this.viewModel.utcOffset=o},this._onDateChange=o=>{const a=o.currentTarget.valueAsDate;this.viewModel.date=Array.isArray(a)?a[0]:a},e!=null&&e.viewModel||(this._defaultViewModel=new ct({view:e==null?void 0:e.view}),this.viewModel=this._defaultViewModel)}initialize(){this.addHandles([m(()=>({viewModel:this.viewModel,slider:this._timeSlider}),e=>this._connectTimeSlider(e),v),m(()=>{var e;return{container:(e=this.view)==null?void 0:e.surface,viewModel:this.viewModel,tooltipVisible:this.visibleElements.tooltip}},({container:e,viewModel:t,tooltipVisible:o})=>{this._tooltip=I(this._tooltip),e!=null&&o&&(this._tooltip=new E({viewModel:t,container:e}))},v),m(()=>({viewModel:this.viewModel,visible:this.visible}),({viewModel:e,visible:t})=>e.setRunning(t),v)])}destroy(){this._timeSlider=I(this._timeSlider),this._tooltip=I(this._tooltip),this._defaultViewModel!=null&&this.viewModel!==this._defaultViewModel&&this._defaultViewModel.destroy()}loadDependencies(){return B({"input-date-picker":()=>y(()=>import("./index-Dwo8yu4W.js"),__vite__mapDeps([60,16,2,3,4,5,6,7,8,9,10,11,12,13,17,14,18,32,33,34,35,20,19,22,23,24,25,26,36,37,15,40,39,59,58,1,51,29,31,52,49,53,56]),import.meta.url),option:()=>y(()=>import("./index-Brz2wqWq.js"),__vite__mapDeps([58,2,3,4,5,6,7,8,9,10,11,12,13,18]),import.meta.url),select:()=>y(()=>import("./index-Cl-EVQNh.js"),__vite__mapDeps([59,16,2,3,4,5,6,7,8,9,10,11,12,13,17,14,18,32,19,20,22,23,24,25,26,36]),import.meta.url)})}render(){const{visibleElements:e,viewModel:t}=this,o=t.state===x.Disabled;return r("div",{class:this.classes(P.base,Y.widget,Y.panel,{[Y.widgetDisabled]:o}),key:this},this._renderTimeRangeSection(),e.visualizationOptions?this._renderVisualizationOptionsSection():null)}get view(){var e;return(e=this.viewModel)==null?void 0:e.view}set view(e){this.viewModel&&(this.viewModel.view=e)}get icon(){return"measure-building-height-shadow"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get testData(){}_connectTimeSlider({viewModel:e,slider:t}){if(this.removeHandles(J.Slider),t==null)return;const o=l=>h(l,"milliseconds","minutes"),a=l=>h(l,"minutes","milliseconds"),n=({index:l,value:c})=>{l===0?e.startTimeOfDay=a(c):e.endTimeOfDay=a(c)};this.addHandles([m(()=>[e.startTimeOfDay,e.endTimeOfDay],l=>{t.values=l.map(o)},v),t.on("thumb-change",n),t.on("thumb-drag",n),t.on("segment-drag",()=>{[e.startTimeOfDay,e.endTimeOfDay]=t.values.map(a)})],J.Slider)}_renderTimeRangeSection(){const{visibleElements:e}=this;return e.timeRangeSlider||e.datePicker?r("section",{class:P.timeRange,key:"time-range"},r(ae,{level:this.headingLevel},this.messages.timeLabel),e.timeRangeSlider?this._renderTimeRange():null,e.datePicker?this._renderDatePicker():null):null}_renderTimeRange(){var b;const{messages:e,viewModel:t,visibleElements:o}=this,{startTimeOfDay:a,endTimeOfDay:n}=t,[l,c]=[a,n].map(Q=>Ke(new Date(Q),tt));return[r("div",{class:P.timeRangeIndicator,key:"time-range-indicator"},fe(e.timeRange,{start:l,end:c}),o.timezone?r(et,{disabled:(b=this._timeSlider)==null?void 0:b.disabled,value:t.utcOffset,onChange:this._onTimezoneChange}):null),r("div",{afterCreate:this._timeSliderContainerAfterCreate,afterRemoved:this._timeSliderContainerAfterRemoved,bind:this,key:"time-slider-container"})]}_timeSliderContainerAfterCreate(e){var o;const t=(o=this._timeSlider)==null?void 0:o.container;t&&e.appendChild(t)}_timeSliderContainerAfterRemoved(e){var o;const t=(o=this._timeSlider)==null?void 0:o.container;t&&e.removeChild(t)}_renderDatePicker(){return r("div",{class:P.datePickerContainer,key:P.datePickerContainer},r("calcite-input-date-picker",{class:P.datePicker,"data-testid":"date-picker",key:P.datePicker,overlayPositioning:"fixed",placement:"bottom",valueAsDate:this.viewModel.date,onCalciteInputDatePickerChange:this._onDateChange}))}_renderVisualizationOptionsSection(){const{headingLevel:e,messages:t,viewModel:o,visibleElements:a}=this,n=a.colorPicker,l=c=>this.classes(o.visualizationType===c?null:P.visualizationConfigHidden);return r("section",{class:P.visualization,key:"visualization"},r(ae,{level:e},t.visualizationLabel),this._renderVisualizationSelect(),r("div",{class:l(u.Threshold),key:"threshold-configurator"},r(S,{colorPickerVisible:n,options:o.thresholdOptions})),r("div",{class:l(u.Duration),key:"duration-configurator"},r(A,{colorPickerVisible:n,options:o.durationOptions})),r("div",{class:l(u.Discrete),key:"discrete-configurator"},r(R,{colorPickerVisible:n,options:o.discreteOptions})))}_renderVisualizationSelect(){const e=this.messages,t=this.viewModel.visualizationType;return r("calcite-select",{bind:this,class:P.visualizationSelect,key:"visualization-select",label:e.visualizationLabel,onCalciteSelectChange:this._onVisualizationTypeChange},[{type:u.Threshold,label:e.threshold.label},{type:u.Duration,label:e.duration.label},{type:u.Discrete,label:e.discrete.label}].map(({type:o,label:a})=>r("calcite-option",{selected:o===t,value:o},a)))}_onVisualizationTypeChange(e){var o;const t=(o=e.currentTarget.selectedOption)==null?void 0:o.value;this.viewModel.visualizationType=t??u.Threshold}};i([s()],_.prototype,"viewModel",void 0),i([s()],_.prototype,"view",null),i([s()],_.prototype,"headingLevel",void 0),i([s()],_.prototype,"icon",null),i([s()],_.prototype,"label",null),i([s({type:De,nonNullable:!0})],_.prototype,"visibleElements",void 0),i([s(),U("esri/widgets/ShadowCast/t9n/ShadowCast")],_.prototype,"messages",void 0),i([s()],_.prototype,"_defaultViewModel",void 0),i([s()],_.prototype,"_timeSlider",void 0),i([s()],_.prototype,"_tooltip",void 0),_=i([w("esri.widgets.ShadowCast")],_);const mt=_;/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.32/esri/copyright.txt for details.
v4.32.12 */const vt=Ee`@layer{arcgis-shadow-cast{display:block}}`,_t=it(mt),G=class G extends $e{constructor(){super(...arguments),this.widget=_t(this),this.viewModel=this.widget.viewModel,this.autoDestroyDisabled=!1,this.discreteOptions=this.viewModel.discreteOptions,this.durationOptions=this.viewModel.durationOptions,this.endTimeOfDay=this.viewModel.endTimeOfDay,this.headingLevel=this.widget.headingLevel,this.hideColorPicker=this.widget.visibleElements.colorPicker,this.hideDatePicker=this.widget.visibleElements.datePicker,this.hideTimeRangeSlider=this.widget.visibleElements.timeRangeSlider,this.hideTimezone=this.widget.visibleElements.timezone,this.hideTooltip=this.widget.visibleElements.tooltip,this.hideVisualizationOptions=this.widget.visibleElements.visualizationOptions,this.icon=this.widget.icon,this.label=this.widget.label,this.position="bottom-left",this.startTimeOfDay=this.viewModel.startTimeOfDay,this.state=this.viewModel.state,this.thresholdOptions=this.viewModel.thresholdOptions,this.utcOffset=this.viewModel.utcOffset,this.visualizationType=this.viewModel.visualizationType,this.arcgisPropertyChange=Oe()("state"),this.arcgisReady=ke()}async destroy(){await this.manager.destroy()}async getDuration(t){var o;return await((o=this.widget)==null?void 0:o.viewModel.getDuration(t))}async start(){var t;(t=this.widget)==null||t.viewModel.start()}async stop(){var t;(t=this.widget)==null||t.viewModel.stop()}};G.properties={autoDestroyDisabled:5,discreteOptions:0,durationOptions:0,endTimeOfDay:9,headingLevel:9,hideColorPicker:5,hideDatePicker:5,hideTimeRangeSlider:5,hideTimezone:5,hideTooltip:5,hideVisualizationOptions:5,icon:1,label:1,position:1,referenceElement:1,startTimeOfDay:9,state:3,thresholdOptions:0,utcOffset:9,visualizationType:1},G.shadowRootOptions=Ve,G.styles=vt;let te=G;ze("arcgis-shadow-cast",te);export{te as ArcgisShadowCast};
