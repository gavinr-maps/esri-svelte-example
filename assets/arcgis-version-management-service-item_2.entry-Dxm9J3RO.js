import{r as w,c as g,h as e,g as C}from"./index-BVncS3aY.js";/*!
 * All material copyright Esri, All Rights Reserved, unless otherwise specified.
 * See https://js.arcgis.com/4.30/esri/copyright.txt for details.
 * v4.30.7
 */const x=class{constructor(s){w(this,s),this.arcgisFlowItemBack=g(this,"arcgisFlowItemBack",7),this.arcgisFlowItemClose=g(this,"arcgisFlowItemClose",7),this.arcgisGetVersions=g(this,"arcgisGetVersions",7),this.arcgisManageVersion=g(this,"arcgisManageVersion",7),this.arcgisNewVersion=g(this,"arcgisNewVersion",7),this._versionListEventListeners=new Map,this._arcgisGetVersions=i=>{this.arcgisGetVersions.emit(i.detail)},this._arcgisManageVersion=i=>{this.arcgisManageVersion.emit(i.detail)},this._arcgisNewVersion=i=>{this.arcgisNewVersion.emit(i.detail)},this.serviceItemElementProps=void 0}disconnectedCallback(){this._versionList&&this._removeVersionListEventListeners(this._versionList)}render(){const{serviceItemElementProps:{allowEditing:s,closable:i,currentUser:a,executionError:f,currentVersionIdentifier:t,flowElement:l,hasAdvEditingUte:r,heading:p,isVersioningApiAvailable:c,pageSize:n,serviceName:h,serviceUrl:o,state:d,strings:u,versionInfos:v}}=this;let{_versionList:m}=this;const k=e("calcite-combobox",{key:"e80f4924dbd00f2a29140b91ee53369dff826d39",clearDisabled:!0,label:h,maxItems:5,overlayPositioning:"fixed",selectionMode:"single-persist",onCalciteComboboxChange:b=>{const I=b.target,E=v.find(L=>L.versionIdentifier.guid===I.value);this.arcgisManageVersion.emit({actionType:"changeVersion",serviceUrl:o,versionInfo:E})}},v?v.map(b=>e("calcite-combobox-item",{selected:t.guid===b.versionIdentifier.guid&&t.name===b.versionIdentifier.name,textLabel:b.versionIdentifier.name,value:b.versionIdentifier.guid})):void 0);let V,_;return s&&(V=e("calcite-action",{key:"fc6779c583aa81cf1f12584bda094b7d0d25dd06",id:`actionManageVersions_${h}`,icon:"list",scale:"s",slot:"control",text:"",onClick:async()=>{m=document.createElement("arcgis-version-management-version-list"),m.versionListElementProps={closable:i,currentUser:a,currentVersionIdentifier:t,executionError:f,hasAdvEditingUte:r,heading:p,isVersioningApiAvailable:c,pageSize:n,serviceName:h,serviceUrl:o,state:d,strings:u,versionInfos:v},m.addEventListener("calciteFlowItemBack",b=>{b.preventDefault(),this.arcgisFlowItemBack.emit()}),m.addEventListener("calciteFlowItemClose",()=>{this.arcgisFlowItemClose.emit()}),this._addVersionListEventListeners(m),l.append(m)}}),_=e("calcite-tooltip",{key:"5d9377d1bec63e4c3d310a3941c0ad693e81f48b",overlayPositioning:"fixed",referenceElement:`actionManageVersions_${h}`},e("span",{key:"ce2e9fc08127e075738fb2cc59fa5387343eda50"},u.headers.manageVersions))),e("calcite-block",{key:"357a2c3e708f61505efa5e1a8f82a7c8ab4ac8dd",open:!0,heading:h},k,V,_)}_addVersionListEventListeners(s){s.addEventListener("arcgisGetVersions",this._arcgisGetVersions),this._versionListEventListeners.set("arcgisGetVersions",this._arcgisGetVersions),s.addEventListener("arcgisManageVersion",this._arcgisManageVersion),this._versionListEventListeners.set("arcgisManageVersion",this._arcgisManageVersion),s.addEventListener("arcgisNewVersion",this._arcgisNewVersion),this._versionListEventListeners.set("arcgisNewVersion",this._arcgisNewVersion)}_removeVersionListEventListeners(s){for(const[i,a]of this._versionListEventListeners)s.removeEventListener(i,a)}get el(){return C(this)}},y=class{constructor(s){w(this,s),this.arcgisAlterVersion=g(this,"arcgisAlterVersion",7),this.arcgisCreateVersion=g(this,"arcgisCreateVersion",7),this.arcgisFlowItemBack=g(this,"arcgisFlowItemBack",7),this.arcgisFlowItemClose=g(this,"arcgisFlowItemClose",7),this._switchToVersion=!0,this._handleCancel=()=>{this.arcgisFlowItemBack.emit()},this._handleChange=i=>{var h;const{_mode:a,_ownerName:f,_versionName:t,versionPropertiesElementProps:{currentUser:l,serviceUrl:r,versionInfo:p}}=this;let{_alterVersionParameters:c,_createVersionParameters:n}=this;switch(a==="create"&&(n||(n={access:"public",description:"",featureServerUrl:r,ownerName:l.toUpperCase(),versionName:""})),a==="edit"&&(c||(c={featureServerUrl:r,versionIdentifier:p.versionIdentifier,ownerName:f,versionName:t,access:p.access,description:p.description})),i.type){case"calciteChipGroupSelect":{const o=i.target.label,d=i.target.selectedItems[0].value;a==="create"&&(n={...n,[o]:d}),a==="edit"&&(c={...c,[o]:d});break}case"calciteInputTextInput":{const o=i.target.name,d=i.target.value;a==="create"&&(n={...n,[o]:d}),a==="edit"&&(c={...c,[o]:d});break}case"calciteTextAreaInput":{const o=i.target.name,d=i.target.value;a==="create"&&(n={...n,[o]:d}),a==="edit"&&(c={...c,[o]:d});break}}a==="create"&&(n.access!=="public"&&l.toUpperCase()!==((h=n.ownerName)==null?void 0:h.toUpperCase())?(this.switchToVersionCheckboxElement.checked=!1,this.switchToVersionCheckboxElement.disabled=!0):this.switchToVersionCheckboxElement.disabled=!1,this._createVersionParameters=n),a==="edit"&&(this._alterVersionParameters=c)},this._handleClose=()=>{this.arcgisFlowItemClose.emit()},this._handleSave=()=>{const{_alterVersionParameters:i,_createVersionParameters:a,_mode:f,_switchToVersion:t}=this;f==="create"&&this.arcgisCreateVersion.emit({createVersionParameters:a,switchToVersion:t}),f==="edit"&&this.arcgisAlterVersion.emit({alterVersionParameters:i})},this._handleSwitchToVersionChange=i=>{this._switchToVersion=i.target.checked},this.versionPropertiesElementProps=void 0}async componentWillLoad(){const{versionPropertiesElementProps:{versionInfo:s}}=this;s?(this._mode="edit",this._fullVersionName=s.versionIdentifier.name,this._ownerName=this._fullVersionName.substring(0,this._fullVersionName.lastIndexOf(".")).toUpperCase(),this._versionName=this._fullVersionName.substring(this._fullVersionName.lastIndexOf(".")+1)):this._mode="create"}componentDidRender(){var s;this._mode==="create"&&((s=this.versionNameInputElement)==null||s.setFocus())}render(){const{versionPropertiesElementProps:{closable:s,currentUser:i,hasAdvEditingUte:a,state:f,strings:t,versionInfo:l},_mode:r,_ownerName:p,_versionName:c}=this,n=e("div",{key:"135d4141e995bbf31123c16d900a1e274575aafb"},e("calcite-button",{key:"44a78143d595fe108d1d312da6ba1bf340be77b8",appearance:"outline",slot:"footer",width:"half",onClick:this._handleCancel},t.actions.cancelSave),e("calcite-button",{key:"30b32b985a16d7841a444e638309b914cac1b406",slot:"footer",width:"half",onClick:this._handleSave},t.actions.saveVersion)),h=e("calcite-label",{key:"fb496917361a78043ca219cdb438f30414dd5acd"},t.input.versionAccess,e("calcite-chip-group",{key:"f81920bbcdc1bd18187b8107d039cd2a61b8e4dc",label:"access",onCalciteChipGroupSelect:this._handleChange,selectionMode:"single-persist"},e("calcite-chip",{key:"9e55255b9114d1d239a17248ccd200fd097af5f2",selected:r==="edit"&&l.access==="public"||r==="create",value:"public"},t.accessLevels.public),e("calcite-chip",{key:"03374352be5cfff98f80bb915fe75be762078258",selected:r==="edit"&&l.access==="protected",value:"protected"},t.accessLevels.protected),e("calcite-chip",{key:"452499aeb04c69b51101b774d91c0479753cf43b",selected:r==="edit"&&l.access==="private",value:"private"},t.accessLevels.private))),o=e("calcite-label",{key:"11c04b89dfd8d85b68d322d552ece3bf5cc35567"},t.input.versionDescription,e("calcite-text-area",{key:"469568f5e6f902076338f1e7a99332d724ff54da",name:"description",onCalciteTextAreaInput:this._handleChange,resize:"vertical",value:r==="edit"?l.description:""})),d=e("calcite-label",{key:"14b2dabc65093f576b8ebca98cec745210353c0b"},t.input.versionName,e("calcite-input-text",{key:"04c0d47377ea59031fa88c38b996203b0d7c9175",ref:m=>{this.versionNameInputElement=m},name:"versionName",onCalciteInputTextInput:this._handleChange,maxLength:62,value:r==="edit"?c:""})),u=e("calcite-label",{key:"b1773ab9fd4183852b522f465a6ba5347934c358"},t.input.versionOwner,e("calcite-input-text",{key:"e62366ef2e7c143e9f63be1ae177a6b1a3639bce",name:"ownerName",onCalciteInputTextInput:this._handleChange,disabled:!a,value:r==="edit"?p:i.toUpperCase()})),v=r==="create"?e("calcite-label",{layout:"inline"},e("calcite-checkbox",{ref:m=>{this.switchToVersionCheckboxElement=m},checked:!0,name:"switchToVersion",onCalciteCheckboxChange:this._handleSwitchToVersionChange}),t.actions.switchToVersion):void 0;return e("calcite-flow-item",{key:"79059091093b6a5c977b43c2530db56f86c98133",closable:s,description:l?l.versionIdentifier.name:"",heading:l?t.actions.editVersion:t.actions.newVersion,onCalciteFlowItemClose:this._handleClose},e("calcite-panel",{key:"0eecfe1d97445089ef205e3c4dc569a23edc863c",loading:f==="executing"},e("calcite-block",{key:"ae61afab2e9d622c41d4b2e0f833057ceba024e0",heading:"",open:!0},d,o,h,u,v,n)))}get el(){return C(this)}};export{x as arcgis_version_management_service_item,y as arcgis_version_management_version_properties};
