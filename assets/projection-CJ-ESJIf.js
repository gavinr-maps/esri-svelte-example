import{B as _,S as O,z as x,n as j,C as E,G as v,h as B}from"./mathUtils-ClvKsMak.js";import{j as S,n as L}from"./mat3-DRqs2t5W.js";import{e as W}from"./mat3f64-BBpwCtoL.js";import{h as b,c as z,C as J}from"./mat4-ybYUU6jq.js";import{o as d,e as Y}from"./mat4f64-Dk4dwAN8.js";import{J as q}from"./projection-A9yUaaTs.js";import{a as M}from"./spatialReferenceEllipsoidUtils-BL8s_3ls.js";import{u as G}from"./computeTranslationToOriginAndRotation-CLzktXYu.js";import{n as C}from"./projectBuffer-vsa0P_cF.js";import{t as V,o as U}from"./DoubleArray-CF_CpVBS.js";import{i as D,k as H,l as I,m as K,s as Q}from"./Point-DB4Hp4hH.js";import{i as F,T as N}from"./BufferView-B7Z-dzh4.js";import{f as X,l as k,e as $}from"./vec3-C3Q-RF_i.js";import{n as Z}from"./vec4-L9zJLV3y.js";import"./index-CeCSsEgo.js";import"./subclass-BR3PhgZG.js";import"./Accessor-D6mNnsWy.js";import"./reactiveUtils-BFQ0BtrB.js";import"./Evented-CXIxDjmW.js";import"./shared-B3wH2qpO.js";import"./Extent-DHjqVB-p.js";import"./Polyline-D97hl-6E.js";import"./writer-3zufXUNV.js";import"./geodesicConstants-XRAvAZCD.js";import"./jsonMap-DCC6W5ex.js";import"./assets-C2mb-ea2.js";import"./vec2-B_ymkwGp.js";import"./vec42-B1mBkh1w.js";const Lr="Projection may be possible after calling projection.load().";function Gr(r,o,t,a){r.error(`Failed to project from (wkid:${o.wkid}) to (wkid:${t.wkid}).${a?" ":""}${a}`)}function Vr(r,o,t,a,e){return h(A.TO_PCPF,F.fromTypedArray(r),l.NORMAL,N.fromTypedArray(o),N.fromTypedArray(t),a,F.fromTypedArray(e))?e:null}function kr(r,o,t,a,e){return h(A.FROM_PCPF,F.fromTypedArray(r),l.NORMAL,N.fromTypedArray(o),N.fromTypedArray(t),a,F.fromTypedArray(e))?e:null}function $r(r,o,t){return C(r,o,0,t,M(o),0,r.length/3)?t:null}function wr(r,o,t){return C(r,M(t),0,o,t,0,r.length/3)?o:null}function xr(r,o,t){return S(c,t),X(o,r,c),_(c)&&k(o,o),o}function vr(r,o,t){return L(c,t),Z(o,r,c),_(c)&&k(o,o,4),o}function Br(r,o,t,a){const e=o===l.NORMAL;return w(r,o,t,(s,m)=>{const n=Math.cos(B(s));m[0]=e?n:1/n,m[1]=1},a)}function Wr(r,o,t,a){const e=o===l.NORMAL;return w(r,o,t,(s,m)=>{const n=Math.cosh(-s/Q.radius);m[0]=1,m[1]=e?n:1/n},a)}function w(r,o,t,a,e){const s=o===l.NORMAL?3:4,m=[0,0];for(let n=0,p=1;n<r.length;n+=s,p+=3){a(t[p],m);const f=r[n]*m[0],u=r[n+1]*m[1],i=r[n+2],P=1/Math.sqrt(f*f+u*u+i*i);e[n]=f*P,e[n+1]=u*P,e[n+2]=i*P,s===4&&(e[n+3]=r[n+3])}return e}function br(r,o,t,a,e){if(!h(A.TO_PCPF,F.fromTypedArray(r,4*Float32Array.BYTES_PER_ELEMENT),l.TANGENT,N.fromTypedArray(o),N.fromTypedArray(t),a,F.fromTypedArray(e,4*Float32Array.BYTES_PER_ELEMENT)))return null;for(let s=3;s<r.length;s+=4)e[s]=r[s];return e}function zr(r,o,t,a,e){if(!h(A.FROM_PCPF,F.fromTypedArray(r,16),l.TANGENT,N.fromTypedArray(o),N.fromTypedArray(t),a,F.fromTypedArray(e,16)))return null;for(let s=3;s<r.length;s+=4)e[s]=r[s];return e}var l,A;function R(r,o,t,a,e){switch(G(a,t,y,a),r===A.FROM_PCPF&&b(y,y),o){case l.NORMAL:return S(e,y);case l.TANGENT:return L(e,y)}}function h(r,o,t,a,e,s,m){if(!o)return;const n=a.count,p=M(s);if(tr(s))for(let f=0;f<n;f++)e.getVec(f,g),o.getVec(f,T),O(T,T,R(r,t,g,p,c)),m.setVec(f,T);else for(let f=0;f<n;f++){e.getVec(f,g),o.getVec(f,T);const u=D(a.get(f,1));let i=Math.cos(u);t===l.TANGENT!=(r===A.TO_PCPF)&&(i=1/i),R(r,t,g,p,c),r===A.TO_PCPF?(c[0]*=i,c[1]*=i,c[2]*=i,c[3]*=i,c[4]*=i,c[5]*=i):(c[0]*=i,c[3]*=i,c[6]*=i,c[1]*=i,c[4]*=i,c[7]*=i),O(T,T,c),x(T,T),m.setVec(f,T)}return m}function Jr(r){return r.vertexSpace.type==="local"?rr(r):or(r)}function rr({vertexSpace:r,transform:o,inSpatialReference:t,outSpatialReference:a,localMode:e,outPositions:s,positions:m}){const n=r.origin??E,p=r.origin!=null?(o==null?void 0:o.localMatrix)??d:d,f=M(t),u=a.isWebMercator&&e||!q(t,f)?t:f;G(t,n,y,u),z(y,y,p);const i=s??V(m.length);return $(i,m,y),C(i,u,0,i,a,0,i.length/3),i}function or({vertexSpace:r,transform:o,outPositions:t,positions:a,inSpatialReference:e,outSpatialReference:s}){const m=r.origin!=null?(o==null?void 0:o.localMatrix)??d:d,n=t??V(a.length);J(m,d)?U(n,a):$(n,a,m);const p=r.origin??E;if(!v(p,E)){const[f,u,i]=p;for(let P=0;P<n.length;P+=3)n[P]+=f,n[P+1]+=u,n[P+2]+=i}return C(n,e,0,n,s,0,n.length/3)?n:null}function tr(r){return r.isWGS84||H(r)||I(r)||K(r)}(function(r){r[r.NORMAL=0]="NORMAL",r[r.TANGENT=1]="TANGENT"})(l||(l={})),function(r){r[r.TO_PCPF=0]="TO_PCPF",r[r.FROM_PCPF=1]="FROM_PCPF"}(A||(A={}));const g=j(),T=j(),y=Y(),c=W();export{l as VectorType,Lr as loadProjectErrorMessage,Gr as logProjectionError,Jr as project,wr as projectFromPCPF,kr as projectNormalFromPCPF,Vr as projectNormalToPCPF,zr as projectTangentFromPCPF,br as projectTangentToPCPF,$r as projectToPCPF,xr as transformNormal,vr as transformTangent,Br as transformVectorENUPlateCarree,Wr as transformVectorWMPlateCarree};
