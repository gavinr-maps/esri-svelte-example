const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./calcite-action-eUVYjjgY.js","./action-CFB8-9mS.js","./jsxFactory-Be5PKa9i.js","./Evented-CXIxDjmW.js","./Accessor-D6mNnsWy.js","./subclass-BR3PhgZG.js","./intl-CArXn1et.js","./Promise-CZrWwByK.js","./jsonMap-DCC6W5ex.js","./assets-BNizZMOZ.js","./index-BVncS3aY.js","./index-CjOb8WjV.css","./reactiveUtils-BFQ0BtrB.js","./shared-B3wH2qpO.js","./uuid-fwrPAdZb.js","./dom-BkQ_hHOr.js","./interactive-QOqfpSSx.js","./loadable-Bgtgv1lm.js","./locale-BvYy6Wxh.js","./key-D5DPfjW0.js","./observers-DSkGD1TQ.js","./component-ByvC-PUv.js","./t9n-Atzq4sOi.js","./icon-D6t4qKDg.js","./loader-ew3V3w9x.js","./calcite-action-group-D9tipI-Z.js","./action-group-CCGYUHoR.js","./conditionalSlot-eNLH0S30.js","./action-menu-M1XR2Dkh.js","./array-DofFqflK.js","./popover-DLRbisRr.js","./floating-ui-5U9KNmUg.js","./debounce-C5YDvsuO.js","./focusTrapComponent-Bepj0OOn.js","./openCloseComponent-Bqj9CrBJ.js","./Heading-DQrTi3L3.js","./FloatingArrow-BN7WHE4B.js","./calcite-action-menu-DBpuvlGg.js","./calcite-button-BbY9lAf2.js","./button-D5KuIed_.js","./form-BOCdnUd9.js","./label-1rGx7O4B.js","./calcite-flow-BBEB5sRb.js","./calcite-flow-item-BTLah491.js","./panel-LE_lpRLv.js","./scrim-fRLdjgt6.js","./calcite-icon-DtUarwQp.js","./calcite-list-CauCCaYV.js","./resources4-CT6dxwoZ.js","./utils3-SlIPNAt8.js","./filter-BHzLPuAd.js","./input2-BjqyiC1c.js","./Validation-Dm76Kltf.js","./input-Dt5r39B0.js","./input-message-BGlL44gg.js","./progress-CMyqabfC.js","./calcite-list-item-DnfVo5id.js","./handle-DVEsJI64.js","./calcite-notice-CVdHfJFK.js","./calcite-tooltip-5IY_tl60.js","./CatalogLayerList-a-r0shD_.js","./Identifiable-BLvpQbOc.js","./ReactiveMap-Dl_3-Rm5.js","./catalogUtils--o1nDhfl.js","./actionUtils-COKY2qLB.js","./substitute-CNca968n.js","./ListItem-C9rdcSNU.js","./ActionToggle-C0Z1k2jc.js","./layerListUtils-CMiJTmu0.js","./widget-KJnvHjQr.js","./globalCss-CZa70j6i.js","./vmEvent-D4Ubqkbq.js","./TableList-DwB5mzoA.js"])))=>i.map(i=>d[i]);
import{_ as v}from"./index-BVncS3aY.js";import{e as s}from"./Evented-CXIxDjmW.js";import{V as z,d as O}from"./reactiveUtils-BFQ0BtrB.js";import{S as j,O as D}from"./Accessor-D6mNnsWy.js";import{s as J}from"./Identifiable-BLvpQbOc.js";import{y as a,b as G,n as R}from"./subclass-BR3PhgZG.js";import{s as K}from"./ReactiveMap-Dl_3-Rm5.js";import{t as B,n as Q}from"./actionUtils-COKY2qLB.js";import{B as W,r as X,n,e as V}from"./jsxFactory-Be5PKa9i.js";import{y as q}from"./LayerListViewModel-BSXCnI9-.js";import{I as Y}from"./ListItem-C9rdcSNU.js";import{e as Z,n as $,x as w,M as U,m as ee,l as te,b as ie,r as oe,d as le,y as se,t as ae}from"./layerListUtils-CMiJTmu0.js";import{e as S}from"./globalCss-CZa70j6i.js";import{e as ne}from"./vmEvent-D4Ubqkbq.js";import"./shared-B3wH2qpO.js";import"./intl-CArXn1et.js";import"./Promise-CZrWwByK.js";import"./jsonMap-DCC6W5ex.js";import"./assets-BNizZMOZ.js";import"./substitute-CNca968n.js";import"./uuid-fwrPAdZb.js";import"./ActionToggle-C0Z1k2jc.js";import"./widget-KJnvHjQr.js";const b="esri-layer-list",L=`${b}__item`,m={base:b,actionMenu:`${b}__action-menu`,actionGroup:`${b}__action-group`,filterNoResults:`${b}__filter-no-results`,item:L,itemActive:`${L}--active`,itemContent:`${L}-content`,itemContentBottom:`${L}-content-bottom`,itemMessage:`${L}-message`,itemInvisible:`${L}--invisible`,itemActionIcon:`${L}-action-icon`,itemActionImage:`${L}-action-image`,itemTemporaryIcon:`${L}-temporary-icon`,itemTableIcon:`${L}-table-icon`,itemCatalogIcon:`${L}-catalog-icon`,statusIndicator:`${b}__status-indicator`,publishing:`${b}__publishing`,updating:`${b}__updating`,connectionStatus:`${b}__connection-status`,connectionStatusConnected:`${b}__connection-status--connected`,visibleToggle:`${b}__visible-toggle`,visibleIcon:`${b}__visible-icon`};let I=class extends j{constructor(){super(...arguments),this.catalogLayerList=!0,this.closeButton=!1,this.collapseButton=!1,this.errors=!1,this.filter=!1,this.flow=!0,this.heading=!1,this.statusIndicators=!0,this.temporaryLayerIndicators=!1}};s([a({type:Boolean,nonNullable:!0})],I.prototype,"catalogLayerList",void 0),s([a({type:Boolean,nonNullable:!0})],I.prototype,"closeButton",void 0),s([a({type:Boolean,nonNullable:!0})],I.prototype,"collapseButton",void 0),s([a({type:Boolean,nonNullable:!0})],I.prototype,"errors",void 0),s([a({type:Boolean,nonNullable:!0})],I.prototype,"filter",void 0),s([a({type:Boolean,nonNullable:!0})],I.prototype,"flow",void 0),s([a({type:Boolean,nonNullable:!0})],I.prototype,"heading",void 0),s([a({type:Boolean,nonNullable:!0})],I.prototype,"statusIndicators",void 0),s([a({type:Boolean,nonNullable:!0})],I.prototype,"temporaryLayerIndicators",void 0),I=s([G("esri.widgets.LayerList.LayerListVisibleElements")],I);const H=I,re=z.ofType(Y);let r=class extends J(W){constructor(e,t){super(e,t),this._activeItem=null,this._tooltipReferenceMap=new K,this._focusRootFlowItem=!1,this._focusPanelFlowItem=!1,this._focusTableListFlowItem=!1,this._focusCatalogFlowItem=!1,this._lastDragDetail=null,this._selectedDragItemLayerUid=null,this._rootGroupUid=`operational-${this.uid}`,this.catalogLayerList=null,this.catalogOptions=null,this.collapsed=!1,this.dragEnabled=!1,this.filterPlaceholder="",this.filterText="",this.headingLevel=2,this.knowledgeGraphOptions=null,this.listItemCanGiveFunction=null,this.listItemCanReceiveFunction=null,this.messages=null,this.messagesCommon=null,this.minDragEnabledItems=Z,this.minFilterItems=$,this.openCatalogItem=null,this.openTableListItem=null,this.selectedItems=new re,this.selectionMode="none",this.tableList=null,this.viewModel=new q,this.visibilityAppearance="default",this.visibleElements=new H,this._canMove=({dragEl:i,fromEl:o,toEl:l},c)=>{var A,M,k;const u=c==="pull"?this.listItemCanGiveFunction:this.listItemCanReceiveFunction,d=w(i);if(!(d!=null&&d.sortable))return!1;const g=w(o),h=U(o),_=w(l),f=U(l),E=!!h&&!!f&&h===f,C={selected:d,from:g,to:_},y=o.group,p=l.group,T=((A=g==null?void 0:g.layer)==null?void 0:A.type)??"",x=((M=_==null?void 0:_.layer)==null?void 0:M.type)??"",P=new Set(["map-image","catalog","knowledge-graph"]);return y&&p&&typeof u=="function"?u.call(null,C):E&&!P.has(T)&&!P.has(x)&&((k=d==null?void 0:d.layer)==null?void 0:k.type)!=="sublayer"},this._clearActiveItem=()=>{this._activeItem=null},this._setActiveItem=i=>{if(this.visibilityAppearance!=="default")return;const o=Array.from(i.composedPath()).find(l=>{var c;return(c=l.classList)==null?void 0:c.contains(m.item)});this._activeItem=w(o)},this._onCalciteListOrderChange=i=>{const{_lastDragDetail:o}=this,{toEl:l,fromEl:c,dragEl:u,newIndex:d}=i;if(c&&l&&!((o==null?void 0:o.newIndex)===d&&(o==null?void 0:o.dragEl)===u&&(o==null?void 0:o.toEl)===l&&(o==null?void 0:o.fromEl)===c))if(this._lastDragDetail=i,c!==l)this._moveLayerFromChildList({toEl:l,fromEl:c,dragEl:u,newIndex:d});else{const g=Array.from(c.children).filter(h=>h==null?void 0:h.matches("calcite-list-item")).map(h=>h.value);this._sortLayers(c,g)}}}initialize(){this.addHandles([O(()=>this.openCatalogItem,e=>e?this._createCatalog():this._destroyCatalog()),O(()=>this.openTableListItem,e=>e?this._createTableList():this._destroyTableList())])}loadDependencies(){return X({action:()=>v(()=>import("./calcite-action-eUVYjjgY.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24]),import.meta.url),"action-group":()=>v(()=>import("./calcite-action-group-D9tipI-Z.js"),__vite__mapDeps([25,26,2,3,4,5,6,7,8,9,10,11,12,13,14,27,20,17,18,15,19,22,28,29,1,16,21,23,24,30,31,32,33,34,35,36]),import.meta.url),"action-menu":()=>v(()=>import("./calcite-action-menu-DBpuvlGg.js"),__vite__mapDeps([37,28,2,3,4,5,6,7,8,9,10,11,12,13,14,29,15,19,17,1,16,18,20,21,22,23,24,30,31,32,33,34,35,36]),import.meta.url),button:()=>v(()=>import("./calcite-button-BbY9lAf2.js"),__vite__mapDeps([38,39,2,3,4,5,6,7,8,9,10,11,12,13,14,40,15,16,41,21,17,18,19,20,22,23,24]),import.meta.url),flow:()=>v(()=>import("./calcite-flow-BBEB5sRb.js"),__vite__mapDeps([42,2,3,4,5,6,7,8,9,10,11,12,13,14,20,17]),import.meta.url),"flow-item":()=>v(()=>import("./calcite-flow-item-BTLah491.js"),__vite__mapDeps([43,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,22,44,28,29,1,21,23,24,30,31,32,33,34,35,36,45]),import.meta.url),icon:()=>v(()=>import("./calcite-icon-DtUarwQp.js"),__vite__mapDeps([46,23,2,3,4,5,6,7,8,9,10,11,12,13,14,15,20]),import.meta.url),list:()=>v(()=>import("./calcite-list-CauCCaYV.js"),__vite__mapDeps([47,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,20,48,49,17,22,18,19,50,32,23,51,40,41,21,52,53,54,55,24,45]),import.meta.url),"list-item":()=>v(()=>import("./calcite-list-item-DnfVo5id.js"),__vite__mapDeps([56,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,22,17,49,48,1,21,23,24,57]),import.meta.url),notice:()=>v(()=>import("./calcite-notice-CVdHfJFK.js"),__vite__mapDeps([58,2,3,4,5,6,7,8,9,10,11,12,13,14,27,20,15,17,18,19,22,34,21,23]),import.meta.url),tooltip:()=>v(()=>import("./calcite-tooltip-5IY_tl60.js"),__vite__mapDeps([59,2,3,4,5,6,7,8,9,10,11,12,13,14,15,31,32,34,36]),import.meta.url)})}destroy(){this._destroyTableList(),this._tooltipReferenceMap.clear()}get _totalItems(){return this.viewModel.operationalItems.flatten(e=>e.children.filter(t=>t.layer.type!=="catalog-dynamic-group")).length}get _dragEnabled(){return this._totalItems>=this.minDragEnabledItems&&this.dragEnabled}get _filterEnabled(){return this._totalItems>=this.minFilterItems&&this.visibleElements.filter}get icon(){return"layers"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get listItemCreatedFunction(){return this.viewModel.listItemCreatedFunction}set listItemCreatedFunction(e){this.viewModel.listItemCreatedFunction=e}get multipleSelectionEnabled(){return D(R.getLogger(this),"multipleSelectionEnabled",{replacement:"selectionMode",version:"4.29",warnOnce:!0}),this.selectionMode==="multiple"}set multipleSelectionEnabled(e){D(R.getLogger(this),"multipleSelectionEnabled",{replacement:"selectionMode",version:"4.29",warnOnce:!0}),this.selectionMode=e?"multiple":this.selectionEnabled?"single":"none"}get operationalItems(){return this.viewModel.operationalItems}set operationalItems(e){this.viewModel.operationalItems=e}get selectionEnabled(){return D(R.getLogger(this),"selectionEnabled",{replacement:"selectionMode, dragEnabled",version:"4.29",warnOnce:!0}),this.selectionMode!=="none"&&this.dragEnabled}set selectionEnabled(e){D(R.getLogger(this),"selectionEnabled",{replacement:"selectionMode, dragEnabled",version:"4.29",warnOnce:!0}),this.dragEnabled=e,this.selectionMode=e?this.multipleSelectionEnabled?"multiple":"single":"none"}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}triggerAction(e,t){return this.viewModel.triggerAction(e,t)}render(){var o,l;const e=(o=this.viewModel)==null?void 0:o.state,t={[S.hidden]:e==="loading",[S.disabled]:e==="disabled"},i=(l=this.operationalItems)==null?void 0:l.filter(c=>!c.hidden&&(this.visibleElements.errors||!c.error));return n("div",{class:this.classes(m.base,S.widget,S.panel,t)},i!=null&&i.length?[this._renderItemTooltips(i),this._renderItems(i)]:this._renderNoItems())}_renderItemTooltip(e){const{_tooltipReferenceMap:t,messages:i}=this;return e?n("calcite-tooltip",{key:`tooltip-${e.layer.uid}`,referenceElement:t.get(e.layer.uid)},i.layerIncompatibleTooltip):null}_renderItemTooltipNodes(e){var t;return e.incompatible?this._renderItemTooltip(e):(t=e.children)==null?void 0:t.filter(i=>!i.hidden).toArray().map(i=>this._renderItemTooltipNodes(i))}_renderItemTooltips(e){return e==null?void 0:e.toArray().map(t=>this._renderItemTooltipNodes(t))}_renderNoItemsMessage(){return n("div",{slot:"message"},this.messages.noItemsToDisplay)}_renderNoItems(){return n("div",{class:m.itemMessage,key:"esri-layer-list__no-items"},n("calcite-notice",{icon:"information",kind:"info",open:!0,width:"full"},this._renderNoItemsMessage()))}_destroyCatalog(){var e;(e=this.catalogLayerList)==null||e.destroy(),this._set("catalogLayerList",null)}_destroyTableList(){var e;(e=this.tableList)==null||e.destroy(),this._set("tableList",null)}async _createCatalog(){var _;this._destroyCatalog();const{default:e}=await v(()=>import("./CatalogLayerList-a-r0shD_.js"),__vite__mapDeps([60,10,11,3,4,5,12,13,61,62,63,64,6,7,8,9,65,2,14,66,67,68,69,70,71]),import.meta.url),{headingLevel:t,catalogOptions:i,view:o,filterPlaceholder:l,listItemCreatedFunction:c,minFilterItems:u,selectionMode:d,visibilityAppearance:g}=this,h=(_=this.openCatalogItem)==null?void 0:_.layer;this._set("catalogLayerList",new e({headingLevel:t,view:o,filterPlaceholder:l,listItemCreatedFunction:c,minFilterItems:u,selectionMode:d,visibilityAppearance:g,...i,catalogLayer:h}))}_getTableListParams(e){const t=e==null?void 0:e.layer;return(t==null?void 0:t.type)==="knowledge-graph"?{...this.knowledgeGraphOptions,tables:t==null?void 0:t.tables}:null}async _createTableList(){var c;this._destroyTableList();const{default:e}=await v(()=>import("./TableList-DwB5mzoA.js"),__vite__mapDeps([72,10,11,3,4,5,12,13,61,64,6,7,8,9,65,2,14,68,67,70,71,69]),import.meta.url),t=this._getTableListParams(this.openTableListItem);if(!((c=t==null?void 0:t.tables)!=null&&c.length))return;const{headingLevel:i,selectionMode:o,dragEnabled:l}=this;this._set("tableList",new e({headingLevel:i,selectionMode:o,dragEnabled:l,...t}))}_renderCatalogFlowItem(){var o;const{openCatalogItem:e,messages:t}=this;if(!e)return null;const i=this._getLayerTitle(e);return n("calcite-flow-item",{afterCreate:this._focusCatalogFlowItemNode,afterUpdate:this._focusCatalogFlowItemNode,bind:this,description:i,heading:t.catalogLayers,headingLevel:this.headingLevel,key:`flow-catalog-${e.uid}`,onCalciteFlowItemBack:l=>{l.preventDefault(),this.openCatalogItem=null,this._focusRootFlowItem=!0}},(o=this.catalogLayerList)==null?void 0:o.render())}_renderTableListFlowItem(){var o;const{openTableListItem:e,messages:t}=this;if(!e)return null;const i=this._getLayerTitle(e);return n("calcite-flow-item",{afterCreate:this._focusTableListFlowItemNode,afterUpdate:this._focusTableListFlowItemNode,bind:this,description:i,heading:t.tables,headingLevel:this.headingLevel,key:`flow-table-list-${e.uid}`,onCalciteFlowItemBack:l=>{l.preventDefault(),this.openTableListItem=null,this._focusRootFlowItem=!0}},(o=this.tableList)==null?void 0:o.render())}_renderPanelFlowItems(e){return e?e.flatten(t=>t.children).filter(({hidden:t,panel:i})=>!t&&(i==null?void 0:i.open)&&!i.disabled&&i.flowEnabled).toArray().map(({title:t,panel:i})=>{const o=()=>this._handlePanelFlowItemBack(i);return n("calcite-flow-item",{afterCreate:this._focusPanelFlowItemNode,afterUpdate:this._focusPanelFlowItemNode,bind:this,description:t,heading:i.title,headingLevel:this.headingLevel,key:`flow-panel-${i.uid}`,onCalciteFlowItemBack:l=>{l.preventDefault(),o()}},i.render(),n("calcite-button",{appearance:"transparent",onclick:o,slot:"footer-actions",width:"full"},this.messagesCommon.back))}):[]}_handlePanelFlowItemBack(e){e.open=!1,this._focusRootFlowItem=!0}_focusRootFlowItemNode(e){this._focusRootFlowItem&&(this._focusRootFlowItem=!1,requestAnimationFrame(()=>e==null?void 0:e.setFocus()))}_focusCatalogFlowItemNode(e){this._focusCatalogFlowItem&&(this._focusCatalogFlowItem=!1,requestAnimationFrame(()=>e==null?void 0:e.setFocus()))}_focusTableListFlowItemNode(e){this._focusTableListFlowItem&&(this._focusTableListFlowItem=!1,requestAnimationFrame(()=>e==null?void 0:e.setFocus()))}_focusPanelFlowItemNode(e){this._focusPanelFlowItem&&(this._focusPanelFlowItem=!1,requestAnimationFrame(()=>e==null?void 0:e.setFocus()))}_renderItems(e){const{visible:t,collapsed:i,_filterEnabled:o,_rootGroupUid:l,visibleElements:{closeButton:c,collapseButton:u,heading:d,flow:g},_dragEnabled:h,selectionMode:_,filterText:f,filterPlaceholder:E,messages:C}=this,y=[n("calcite-flow-item",{afterCreate:this._focusRootFlowItemNode,afterUpdate:this._focusRootFlowItemNode,bind:this,closable:c,closed:!t,collapsed:i,collapsible:u,heading:d?C.widgetLabel:void 0,headingLevel:this.headingLevel,key:"root-flow-item",onCalciteFlowItemClose:()=>this.visible=!1},n("calcite-list",{afterCreate:p=>{p.addEventListener("focusin",this._setActiveItem),p.addEventListener("focusout",this._clearActiveItem)},afterRemoved:p=>{p.removeEventListener("focusin",this._setActiveItem),p.removeEventListener("focusout",this._clearActiveItem)},canPull:p=>this._canMove(p,"pull"),canPut:p=>this._canMove(p,"put"),"data-layer-type":l,dragEnabled:h,filterEnabled:o,filterPlaceholder:E,filterText:o?f:"",group:l,key:"root-list",label:C.widgetLabel,onmouseleave:this._clearActiveItem,onmouseover:this._setActiveItem,selectionAppearance:"border",selectionMode:_,onCalciteListChange:p=>this._handleCalciteListChange(p),onCalciteListDragEnd:p=>this._handleCalciteListDragEnd(p.detail),onCalciteListFilter:p=>{var T;return this.filterText=((T=p.target)==null?void 0:T.filterText)??""},onCalciteListOrderChange:p=>this._onCalciteListOrderChange(p.detail)},e==null?void 0:e.toArray().map(p=>this._renderItem(p)),e!=null&&e.length&&o?n("div",{class:m.filterNoResults,slot:"filter-no-results"},n("calcite-notice",{kind:"info",open:!0,width:"full"},this._renderNoItemsMessage())):null)),this._renderPanelFlowItems(e),this._renderTableListFlowItem(),this._renderCatalogFlowItem()];return t?g?n("calcite-flow",{key:"root-flow"},y):y:null}_renderChildList(e,t=[]){var _,f,E,C;const{_dragEnabled:i,_rootGroupUid:o,viewModel:{listModeDisabled:l},messages:c,selectionMode:u}=this,{children:d}=e,g=((_=e.layer)==null?void 0:_.type)!=="catalog-dynamic-group"&&ee(e),h=!(!l&&te(e.layer))&&!g&&i&&((f=e.layer)==null?void 0:f.type)==="group";return g||h?n("calcite-list",{canPull:y=>this._canMove(y,"pull"),canPut:y=>this._canMove(y,"put"),"data-item":e,"data-layer-type":o,dragEnabled:!!i&&e.childrenSortable&&ie(e),group:`${o}-${e.layer.uid}`,key:`child-list-${e.layer.uid}`,selectionAppearance:"border",selectionMode:u},d==null?void 0:d.filter(y=>!y.hidden).toArray().map(y=>this._renderItem(y,e,[...t,e.title])),(C=(E=this._getTableListParams(e))==null?void 0:E.tables)!=null&&C.length?n("calcite-list-item",{class:m.item,"data-layer-id":e.layer.id,dragDisabled:!0,key:`list-item-table-list-tables-${e.layer.uid}`,title:c.tables,onCalciteListItemSelect:()=>{this.openTableListItem=e,this._focusTableListFlowItem=!0}},n("div",{class:m.itemContent,slot:"content"},c.tables),n("calcite-icon",{class:m.itemTableIcon,icon:"table",scale:"s",slot:"content-start"}),n("calcite-icon",{flipRtl:!0,icon:"chevron-right",scale:"s",slot:"content-end"})):null):null}_renderItemMessage(e){return e.error?n("div",{class:m.itemMessage,key:"esri-layer-list__error",slot:"content-bottom"},n("calcite-notice",{icon:"exclamation-mark-triangle",kind:"warning",open:!0,scale:"s",width:"full"},n("div",{slot:"message"},this.messages.layerError))):e.incompatible?n("div",{class:m.itemMessage,key:"esri-layer-list__incompatible",slot:"content-bottom"},n("calcite-notice",{afterCreate:t=>this._setTooltipReference(t,e),afterRemoved:()=>this._removeTooltipReference(e),bind:this,icon:"exclamation-mark-triangle",kind:"warning",open:!0,scale:"s",tabIndex:0,width:"full"},n("div",{slot:"message"},this.messages.layerIncompatible))):null}_getLayerTitle(e){return e.title||this.messages.untitledLayer}_renderItem(e,t,i){var N,A,M,k;const{_activeItem:o,_selectedDragItemLayerUid:l,selectionMode:c,selectedItems:u,messages:d,visibleElements:g}=this,h=this._getLayerTitle(e),_=e.visibleAtCurrentTimeExtent?e.visibleAtCurrentScale?h:`${h} (${d.layerInvisibleAtScale})`:`${h} (${d.layerInvisibleAtTime})`,f=this._filterActions(e.actionsSections),E=this._countActions(f),C=((A=(N=e.parent)==null?void 0:N.layer)==null?void 0:A.type)==="catalog",y=((M=e.layer)==null?void 0:M.type)==="catalog-footprint",p=((k=e.layer)==null?void 0:k.type)==="catalog-dynamic-group",T=y?n("calcite-icon",{class:m.itemCatalogIcon,icon:"footprint",key:"footprint",scale:"s",slot:"content-start"}):null,x=p?n("calcite-icon",{class:m.itemCatalogIcon,icon:"catalog-dataset",key:"catalog-dataset",scale:"s",slot:"content-start"}):null,P=g.catalogLayerList&&p?n("calcite-action",{appearance:"transparent",disabled:!e.layer.visible,icon:"chevron-right",iconFlipRtl:!0,onclick:()=>{this.openCatalogItem=t,this._focusCatalogFlowItem=!0},scale:"s",slot:"actions-end",text:h}):null;return n("calcite-list-item",{afterCreate:F=>this._focusSelectedDragEl(F,e),afterUpdate:F=>this._focusSelectedDragEl(F,e),class:this.classes(m.item,{[m.itemActive]:o===e}),"data-item":e,"data-layer-id":e.layer.id,dragDisabled:!e.sortable||C,dragSelected:e.layer.uid===l,id:e.layer.uid,key:`list-item-${e.layer.uid}`,label:h,metadata:{parentTitles:i,title:h},open:e.open,selected:c!=="none"&&u.includes(e),title:_,value:e.layer.uid,onCalciteListItemDragHandleChange:F=>this._handleCalciteListItemDragHandleChange(F,e),onCalciteListItemSelect:F=>this._handleCalciteListItemSelect(F,e,t),onCalciteListItemToggle:F=>this._handleCalciteListItemToggle(F,e)},T,x,n("div",{class:this.classes({[m.itemContent]:!0,[m.itemInvisible]:!e.visibleAtCurrentScale||!e.visibleAtCurrentTimeExtent}),slot:"content"},h),this._renderItemStatus(e,t),this._renderItemToggle(e,t),P,this._renderItemTemporaryIcon(e),this._renderChildList(e,i),this._renderItemMessage(e),this._renderPanel(e.panel),this._renderPanelAction(e.panel),E>1?this._renderActionsSections(e,f):E===1?this._renderAction({item:e,action:this._getSingleAction(f),textEnabled:!1}):null)}_renderItemStatus(e,t){const{visibleElements:i}=this;if(!i.statusIndicators)return null;const{connectionStatus:o,publishing:l,updating:c}=e,u=c&&!t,d=!!o;return n("calcite-icon",{class:this.classes({[m.statusIndicator]:!0,[m.publishing]:l,[m.updating]:u,[m.connectionStatus]:d,[m.connectionStatusConnected]:d&&o==="connected"}),icon:oe({connectionStatus:o,publishing:l}),key:"layer-item-status",scale:"s",slot:"actions-end"})}_renderItemTemporaryIcon(e){return this.visibleElements.temporaryLayerIndicators&&"persistenceEnabled"in e.layer&&!e.layer.persistenceEnabled?n("calcite-icon",{class:m.itemTemporaryIcon,icon:"temporary",key:"temporary-icon",scale:"s",slot:"actions-start",title:this.messages.temporary}):null}_renderItemToggle(e,t){const{messages:i,visibilityAppearance:o}=this,{visible:l}=e,c=t==null?void 0:t.visibilityMode;if(c==="inherited")return null;const u=ae({visible:l,exclusive:c==="exclusive",visibilityAppearance:o}),d=o==="checkbox",g=i.layerVisibility;return n("calcite-action",{appearance:"transparent",class:m.visibleToggle,icon:d?u:void 0,key:"visibility-toggle",onclick:()=>this._toggleVisibility(e,t),scale:"s",slot:d?"actions-start":"actions-end",text:g,title:g},d?null:n("calcite-icon",{class:this.classes({[m.visibleIcon]:c!=="exclusive"&&l}),icon:u,scale:"s"}))}_renderPanel(e){return!(e!=null&&e.open)||e.disabled||e.flowEnabled?null:n("div",{class:m.itemContentBottom,key:`content-panel-${e.uid}`,slot:"content-bottom"},e.render())}_renderPanelAction(e){if(!(e!=null&&e.visible))return null;const{open:t,title:i,disabled:o}=e;return n("calcite-action",{active:t,appearance:"transparent",disabled:o,icon:B(e),key:`action-${e.uid}`,onclick:()=>this._togglePanel(e),scale:"s",slot:"actions-end",text:i??"",title:i??void 0},this._renderFallbackIcon(e))}_renderActionsSections(e,t){const i=this.messagesCommon.options;return n("calcite-action-menu",{appearance:"transparent",class:m.actionMenu,key:"item-action-menu",label:this.messagesCommon.menu,open:e.actionsOpen,overlayPositioning:"fixed",placement:"bottom-end",scale:"s",slot:"actions-end",onCalciteActionMenuOpen:o=>e.actionsOpen=o.target.open},n("calcite-action",{appearance:"transparent",icon:"ellipsis",scale:"s",slot:"trigger",text:i,title:i}),t.toArray().map((o,l)=>this._renderActionSection(e,o,l)))}_renderActionSection(e,t,i){return n("calcite-action-group",{class:m.actionGroup,key:`action-section-${i}`},t.toArray().map(o=>this._renderAction({item:e,action:o,textEnabled:!0})))}_renderFallbackIcon(e){const{className:t,icon:i}=e;if(i)return null;const o="image"in e?e.image:void 0,l={[m.itemActionIcon]:!!t,[m.itemActionImage]:!!o};return t&&(l[t]=!0),o||t?n("span",{"aria-hidden":"true",class:this.classes(m.itemActionIcon,l),key:"icon",styles:Q(o)}):null}_renderAction(e){const{item:t,action:i,textEnabled:o}=e;if(!i)return null;const{active:l,disabled:c,title:u,type:d,indicator:g}=i;return n("calcite-action",{active:d==="toggle"&&i.value,appearance:"transparent",disabled:c,icon:B(i),indicator:g,key:`action-${i.uid}`,loading:l,onclick:()=>this._triggerAction(t,i),scale:"s",slot:o?void 0:"actions-end",text:u??"",textEnabled:o,title:u??void 0},this._renderFallbackIcon(i))}_setTooltipReference(e,t){this._tooltipReferenceMap.set(t.layer.uid,e)}_removeTooltipReference(e){this._tooltipReferenceMap.delete(e.layer.uid)}_moveLayerFromChildList({toEl:e,fromEl:t,dragEl:i,newIndex:o}){const l=w(i),c=w(e),u=w(t);this.viewModel.moveListItem(l,u,c,o)}_handleCalciteListDragEnd(e){const{fromEl:t,dragEl:i,oldIndex:o}=e;t.insertBefore(i,t.children[o])}_sortLayers(e,t){var i,o;if(e)if(e.group===this._rootGroupUid)le((o=(i=this.view)==null?void 0:i.map)==null?void 0:o.layers,t);else{const l=w(e);if(!l)return;se(l,t)}}_getSingleAction(e){return e.reduce(t=>t).find(t=>t&&(t.type==="button"||t.type==="toggle"))}_filterActions(e){return e.map(t=>t.filter(i=>i.visible))}_countActions(e){return e.reduce((t,i)=>t+i.length,0)}_triggerAction(e,t){t&&e&&(t.type==="toggle"&&(t.value=!t.value),this.triggerAction(t,e))}_handleCalciteListChange(e){const{selectionMode:t,selectedItems:i}=this;if(t==="none")return;const o=e.target.selectedItems.map(l=>w(l)).filter(Boolean);i.removeAll(),i.addMany(o)}_handleCalciteListItemToggle(e,t){e.stopPropagation(),t.open=e.target.open}_focusSelectedDragEl(e,t){this._selectedDragItemLayerUid===t.layer.uid&&requestAnimationFrame(()=>e==null?void 0:e.setFocus())}_handleCalciteListItemDragHandleChange(e,t){e.stopPropagation();const i=e.target.dragSelected;this._selectedDragItemLayerUid=i?t.layer.uid:null}_handleCalciteListItemSelect(e,t,i){w(e.target)===t&&this.selectionMode==="none"&&(i==null?void 0:i.visibilityMode)!=="inherited"&&this._toggleVisibility(t,i)}_togglePanel(e){e.open=!e.open,e.open&&(this._focusPanelFlowItem=!0)}_toggleVisibility(e,t){if(!e)return;(t==null?void 0:t.visibilityMode)==="exclusive"&&e.visible||(e.visible=!e.visible)}};s([a()],r.prototype,"_activeItem",void 0),s([a()],r.prototype,"_tooltipReferenceMap",void 0),s([a()],r.prototype,"_focusRootFlowItem",void 0),s([a()],r.prototype,"_focusPanelFlowItem",void 0),s([a()],r.prototype,"_focusTableListFlowItem",void 0),s([a()],r.prototype,"_focusCatalogFlowItem",void 0),s([a()],r.prototype,"_totalItems",null),s([a()],r.prototype,"_dragEnabled",null),s([a()],r.prototype,"_filterEnabled",null),s([a({readOnly:!0})],r.prototype,"catalogLayerList",void 0),s([a()],r.prototype,"catalogOptions",void 0),s([a()],r.prototype,"collapsed",void 0),s([a()],r.prototype,"dragEnabled",void 0),s([a()],r.prototype,"filterPlaceholder",void 0),s([a()],r.prototype,"filterText",void 0),s([a()],r.prototype,"headingLevel",void 0),s([a()],r.prototype,"icon",null),s([a()],r.prototype,"knowledgeGraphOptions",void 0),s([a()],r.prototype,"label",null),s([a()],r.prototype,"listItemCanGiveFunction",void 0),s([a()],r.prototype,"listItemCanReceiveFunction",void 0),s([a()],r.prototype,"listItemCreatedFunction",null),s([a(),V("esri/widgets/LayerList/t9n/LayerList")],r.prototype,"messages",void 0),s([a(),V("esri/t9n/common")],r.prototype,"messagesCommon",void 0),s([a()],r.prototype,"minDragEnabledItems",void 0),s([a()],r.prototype,"minFilterItems",void 0),s([a()],r.prototype,"multipleSelectionEnabled",null),s([a()],r.prototype,"openCatalogItem",void 0),s([a()],r.prototype,"openTableListItem",void 0),s([a()],r.prototype,"operationalItems",null),s([a()],r.prototype,"selectionEnabled",null),s([a()],r.prototype,"selectedItems",void 0),s([a()],r.prototype,"selectionMode",void 0),s([a({readOnly:!0})],r.prototype,"tableList",void 0),s([a()],r.prototype,"view",null),s([ne("trigger-action"),a({type:q})],r.prototype,"viewModel",void 0),s([a()],r.prototype,"visibilityAppearance",void 0),s([a({type:H,nonNullable:!0})],r.prototype,"visibleElements",void 0),r=s([G("esri.widgets.LayerList")],r);const De=r;export{De as default};
