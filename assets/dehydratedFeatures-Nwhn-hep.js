import{M as u,aR as Z}from"./Accessor-BHnuXKD2.js";import{s as l,i as v,u as y,e as I}from"./memoryEstimations-5gFNwkKK.js";import{g as k}from"./Point-XGrwlf63.js";import{q as F,N as m}from"./aaBoundingBox-CeBivBRq.js";import{H as M,s as h}from"./Polyline-BmuD2-ZN.js";import{H as j,D as z,B as R,C as w}from"./quantizationUtils-2Az-xHPA.js";import{y as A}from"./typeUtils-BSg8Y507.js";import{y as T}from"./Field-Cyk7Ur5d.js";import"./mathUtils-DV9iOXpW.js";function V(){return u("curve-densification-coarse-segments")}function S(){return u("curve-densification-max-segments")}function W(){return u("curve-densification-min-segments")}function X(){return u("curve-densification-pixels-per-segment")}class Y{constructor(e,n,s){this.uid=e,this.geometry=n,this.attributes=s,this.visible=!0,this.objectId=null,this.centroid=null}}function _(t){return t.geometry!=null}class ${constructor(){this.exceededTransferLimit=!1,this.features=[],this.fields=[],this.hasM=!1,this.hasZ=!1,this.geometryType=null,this.objectIdFieldName=null,this.globalIdFieldName=null,this.geometryProperties=null,this.geohashFieldName=null,this.spatialReference=null,this.transform=null}}function tt(t,e){var f;const n=A.fromJSON(t.geometryType),s=k.fromJSON(t.spatialReference),r=t.transform,a=t.objectIdFieldName,d=e==null?void 0:e.maxStringAttributeLength,b=e==null?void 0:e.maxStringAttributeFields;let c;const x=t.features.map(p=>{const o=L(p,n,s,t.objectIdFieldName),i=o.geometry;if(O(o.attributes,b,d,N=>{c??(c=[]);const g=J(o,a);g!=null&&c.push({objectId:g,attribute:N})}),i!=null&&r)switch(i.type){case"point":o.geometry=w(r,i,i);break;case"multipoint":o.geometry=R(r,i,i);break;case"polygon":o.geometry=z(r,i,i);break;case"polyline":o.geometry=j(r,i,i);break;case"extent":case"mesh":o.geometry=i}return o});return{geometryType:n,features:x,spatialReference:s,fields:((f=t.fields)==null?void 0:f.map(p=>T.fromJSON(p)))??[],objectIdFieldName:t.objectIdFieldName,globalIdFieldName:t.globalIdFieldName,geohashFieldName:t.geohashFieldName,geometryProperties:t.geometryProperties,hasZ:t.hasZ,hasM:t.hasM,exceededTransferLimit:t.exceededTransferLimit,transform:null,missingAttributes:c}}function L(t,e,n,s){return{uid:Z(),objectId:s&&t.attributes?t.attributes[s]:null,attributes:t.attributes,geometry:P(t.geometry,e,n),visible:!0}}function P(t,e,n){if(t==null)return null;switch(e){case"point":{const s=t;return{x:s.x,y:s.y,z:s.z,m:s.m,hasZ:s.z!=null,hasM:s.m!=null,type:"point",spatialReference:n}}case"polyline":{const s=t;return{paths:s.paths,hasZ:!!s.hasZ,hasM:!!s.hasM,type:"polyline",spatialReference:n}}case"polygon":{const s=t;return{rings:s.rings,hasZ:!!s.hasZ,hasM:!!s.hasM,type:"polygon",spatialReference:n}}case"multipoint":{const s=t;return{points:s.points,hasZ:!!s.hasZ,hasM:!!s.hasM,type:"multipoint",spatialReference:n}}}}function H(t){if(t==null)return 0;switch(t.type){case"point":return l+10+8+24;case"polyline":case"polygon":{let e=0;const n=2+(t.hasZ?1:0)+(t.hasM?1:0),s=t.type==="polyline"?t.paths:t.rings,r=t.type==="polyline"?t.curvePaths:t.curveRings;if(r!=null&&r.length){const a=3*S()*128;e=8*a*n+128*a+32*(s.length+1)}else e=y(s);return l+64+e+34}case"multipoint":{const e=y(t.points);return l+e+64+34+32}case"extent":return l+10+64+34;case"mesh":{const e=t.vertexAttributes;return l+v(e.position,e.normal,e.uv,e.tangent)}default:return l}}function et(t){let e=32;return e+=I(t.attributes),e+=3,e+=8+H(t.geometry),e}function nt(t){if(t==null)return 0;switch(t.type){case"point":return 1;case"polyline":{let e=0;for(const n of t.paths)e+=n.length;return e}case"polygon":{let e=0;for(const n of t.rings)e+=n.length;return e}case"multipoint":return t.points.length;case"extent":return 2;case"mesh":{const e=t.vertexAttributes&&t.vertexAttributes.position;return e?e.length/3:0}default:return}}function st(t){if(t==null)return!1;switch(t.type){case"extent":case"point":return!0;case"polyline":for(const e of t.paths)if(e.length>0)return!0;return!1;case"polygon":for(const e of t.rings)if(e.length>0)return!0;return!1;case"multipoint":return t.points.length>0;case"mesh":return!t.loaded||t.vertexAttributes.position.length>0}}function rt(t,e){switch(F(e),t.type==="mesh"&&(t=t.extent),t.type){case"point":e[0]=e[3]=t.x,e[1]=e[4]=t.y,t.hasZ&&(e[2]=e[5]=t.z);break;case"polyline":for(let n=0;n<t.paths.length;n++)m(e,t.paths[n],!!t.hasZ);break;case"polygon":for(let n=0;n<t.rings.length;n++)m(e,t.rings[n],!!t.hasZ);break;case"multipoint":m(e,t.points,!!t.hasZ);break;case"extent":e[0]=t.xmin,e[1]=t.ymin,e[3]=t.xmax,e[4]=t.ymax,t.zmin!=null&&(e[2]=t.zmin),t.zmax!=null&&(e[5]=t.zmax)}}function it(t,e){switch(M(e),t.type==="mesh"&&(t=t.extent),t.type){case"point":e[0]=e[2]=t.x,e[1]=e[3]=t.y;break;case"polyline":for(let n=0;n<t.paths.length;n++)h(e,t.paths[n]);break;case"polygon":for(let n=0;n<t.rings.length;n++)h(e,t.rings[n]);break;case"multipoint":h(e,t.points);break;case"extent":e[0]=t.xmin,e[1]=t.ymin,e[2]=t.xmax,e[3]=t.ymax}}function J(t,e){return t.objectId!=null?t.objectId:t.attributes&&e?t.attributes[e]:null}function O(t,e,n,s){if(e!=null&&e.size&&n!=null&&t)for(const r in t){if(!e.has(r))continue;const a=t[r];typeof a=="string"&&a.length>n&&(s(r),t[r]="")}}export{H as F,et as I,st as M,J as R,_ as b,Y as d,V as e,W as i,tt as j,nt as k,S as n,X as r,rt as v,O as w,$ as x,it as z};
