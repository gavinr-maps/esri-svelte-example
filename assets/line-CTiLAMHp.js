import{o as h,G as b}from"./vec2-maR1OrZI.js";import{n as T}from"./vec2f64-Dy6m9Nrb.js";import{N as E}from"./vec4f64-o2zAXfmz.js";import{C as w}from"./Point-XGrwlf63.js";import{h as I}from"./projectBuffer-DOU0xvVi.js";import{t as D}from"./aaBoundingBox-CeBivBRq.js";import{f as R,n as g}from"./FloatArray-BCfeX8wo.js";import{w as A}from"./Indices-Db9lERgy.js";import{l as F}from"./ViewingMode-Dodu7ZZk.js";import{t as f}from"./Attribute-B-NAci_J.js";import{e as O}from"./Material-Ba8x5bbY.js";import{e as c}from"./VertexAttribute-Cq4MnHjR.js";function V(t,n,o=null){const e=[],l=n.mapPositions;d(n,e);const a=e[0][1].data,i=e[0][1].indices.length,r=A(i);return y(n,e,r),C(n,e,r),v(n,e,r),S(n,e,r),U(n,e,r),z(n,e,r),L(n,e,a),new R(t,e,l,O.Line,o)}function d(t,n){const{attributeData:{position:o},removeDuplicateStartEnd:e}=t,l=N(o)&&e,a=o.length/3-(l?1:0),i=new Array(2*(a-1)),r=l?o.slice(0,-3):o;let u=0;for(let p=0;p<a-1;p++)i[u++]=p,i[u++]=p+1;n.push([c.POSITION,new f(r,i,3,l)])}function y(t,n,o){if(t.attributeData.colorFeature!=null)return;const e=t.attributeData.color;n.push([c.COLOR,new f(e??E,o,4)])}function v(t,n,o){t.attributeData.normal&&n.push([c.NORMAL,new f(t.attributeData.normal,o,3)])}function S(t,n,o){t.attributeData.colorFeature!=null&&n.push([c.COLORFEATUREATTRIBUTE,new f([t.attributeData.colorFeature],o,1,!0)])}function C(t,n,o){t.attributeData.sizeFeature==null&&n.push([c.SIZE,new f([t.attributeData.size??1],o,1,!0)])}function U(t,n,o){t.attributeData.sizeFeature!=null&&n.push([c.SIZEFEATUREATTRIBUTE,new f([t.attributeData.sizeFeature],o,1,!0)])}function z(t,n,o){t.attributeData.opacityFeature!=null&&n.push([c.OPACITYFEATUREATTRIBUTE,new f([t.attributeData.opacityFeature],o,1,!0)])}function L(t,n,o){if(t.overlayInfo==null||t.overlayInfo.renderCoordsHelper.viewingMode!==F.Global||!t.overlayInfo.spatialReference.isGeographic)return;const e=D(o.length),l=w(t.overlayInfo.spatialReference);for(let s=0;s<e.length;s+=3)I(o,s,e,s,l);const a=o.length/3,i=g(a+1);let r=B,u=G,p=0,m=0;h(r,e[m++],e[m++]),m++,i[0]=0;for(let s=1;s<a+1;++s)s===a&&(m=0),h(u,e[m++],e[m++]),m++,p+=b(r,u),i[s]=p,[r,u]=[u,r];n.push([c.DISTANCETOSTART,new f(i,n[0][1].indices,1,!0)])}function N(t){const n=t.length;return t[0]===t[n-3]&&t[1]===t[n-2]&&t[2]===t[n-1]}const B=T(),G=T();function W(t,n){if(t==null||t.length===0)return[];const o=[];return t.forEach(e=>{const l=e.length,a=D(3*l);e.forEach((r,u)=>{a[3*u]=r[0],a[3*u+1]=r[1],a[3*u+2]=r[2]});const i={attributeData:{position:a,normal:n},removeDuplicateStartEnd:!1};o.push(i)}),o}export{W as R,V as b};
