import{r as m,m as g,a as Kt,bt as Se,G as je,ad as ke}from"./Accessor-BmwT4B0c.js";import{h as ct}from"./Color-VJEMvW-n.js";import{S as te}from"./JSONSupport-DcrLLGjL.js";import{d as qe,A as ze}from"./reactiveUtils-XM7cS2OP.js";import{A as Oe}from"./opacityUtils-Dim20wpZ.js";import{g as He}from"./timeUtils-C1c_L2Fd.js";import{v as At,R as A,P as w,q as E,o as W,_ as lt,Z as bt,c as Rt,s as ee,p as ne,H as N,J as Ie,j as De,A as Fe}from"./vec32-Dvg_eL9J.js";import{a as re,e as mt}from"./projectVectorToVector-CCOy_B5J.js";import{b as Ge}from"./Query-B_2mhyL4.js";import{_ as Ve}from"./InputManager-DZ3jJnlx.js";import{c as Ct}from"./keybindings-CTmT1RTo.js";import{r as Ce}from"./utils-BjSXFjBJ.js";import{m as Ze,l as We}from"./mathUtils-Cfq9PL9W.js";import{e as Y,q as Ye,d as at,B as Ue,j as gt,p as ht,_ as Je,o as se,b as ie,E as Zt}from"./vec2-ChnYg_BJ.js";import{n as Z,t as ut,l as Be}from"./vec2f64-Dy6m9Nrb.js";import{r as pt,n as p,t as U,N as Qe}from"./vec3f64-BLpZdpfb.js";import{s as Xe,j as Ke}from"./vec42-YcqnINSP.js";import{n as tn}from"./vec4f64-o2zAXfmz.js";import{i as en}from"./geodesicConstants-RQL9oKdk.js";import{j as Tt,q as oe,b as ae}from"./geodesicUtils-Cvz9v8ds.js";import{l as yt,M as P,Q as _t,k as ue,z as nn,p as rn,V as sn,H as ce,O as le}from"./plane-CpXmOyqq.js";import{I as on,O as an,_ as un,$ as cn,U as ln}from"./sphere-Cin5efBj.js";import{q as he}from"./mathUtils-BgCEaV43.js";import{m as hn,j as St,x as pn,E as fn}from"./elevationInfoUtils-D26wVF2d.js";import{e as K}from"./common-DQOJ18NT.js";import{j as v,d as dn}from"./geometry2dUtils-D9Oax6Qb.js";var J;function pe(e,t,n){return T(e,t,n)}function T(e=0,t=0,n=0){return pt(e,t,n)}function _r(e){return e}function Pr(e){return e}function V(e,t,n){return pt(e,t,n)}function B(e){const[t,n,r]=e;return e.length>3?[t,n,r,e[3]]:[t,n,r]}function Mr(e){return e[3]=((e.length>3?e[3]:void 0)??J.NONE)|J.TARGET,e}function Rr(e){return!!(((e.length>3?e[3]:void 0)??J.NONE)&J.TARGET)}function Wt(e,t,{coordinateHelper:n,elevationInfo:r},s){return e?mn(n.vectorToDehydratedPoint(e,gn),t,r,s):null}function mn(e,t,n,r=T()){return r[0]=e.x,r[1]=e.y,r[2]=e.z??0,t==null||(t.type==="2d"?r[2]=0:r[2]=hn(t,e,n,St)??0),r}function Sr(e,t,n){return n?(re(n,e[0],e[1],e[2],t),n):mt(e[0],e[1],e[2],t)}function jr(e,t,{z:n,m:r},s,i){const{spatialReference:a,elevationInfo:o}=s;let u;n==null&&r==null?u=void 0:t==null||t.type==="2d"?u=n??void 0:u=pn(t,e,a,St,o)??0;const[c,l]=e;return i?re(i,c,l,u,a):i=mt(c,l,u,a),r!=null&&(i.m=r,i.hasM=!0),i}function kr(e,t,n,r,s=T()){const[i,a]=e;return s[0]=i,s[1]=a,e.length>3&&(s[3]=e[3]??J.NONE),(n==null?void 0:n.type)!=="3d"?(s[2]=t.value,s):(s[2]=fn(n,i,a,t.value,r,t.elevationInfo,St)??0,s)}(function(e){e[e.NONE=0]="NONE",e[e.TARGET=1]="TARGET"})(J||(J={}));const gn=mt(0,0,0,null);let S=class extends te{constructor(){super(...arguments),this.enabled=!0}};m([g({type:Boolean})],S.prototype,"enabled",void 0),S=m([Kt("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],S);let d=class extends te{constructor(e){super(e),this.lineSnapper=new S,this.parallelLineSnapper=new S,this.rightAngleSnapper=new S,this.rightAngleTriangleSnapper=new S,this.shortLineThreshold=15,this.distance=5,this.pointThreshold=1e-6,this.intersectionParallelLineThreshold=1e-6,this.parallelLineThreshold=1e-6,this.verticalLineThresholdMeters=.3,this.touchSensitivityMultiplier=1.5,this.pointOnLineThreshold=1e-6,this.orange=new ct([255,127,0]),this.orangeTransparent=new ct([255,127,0,.5]),this.lineHintWidthReference=3,this.lineHintWidthTarget=3,this.lineHintFadedExtensions=.3,this.parallelLineHintWidth=2,this.parallelLineHintLength=24,this.parallelLineHintOffset=1.5,this.rightAngleHintSize=24,this.rightAngleHintOutlineSize=1.5,this.satisfiesConstraintScreenThreshold=1}};m([g({type:S,constructOnly:!0,nonNullable:!0,json:{write:!0}})],d.prototype,"lineSnapper",void 0),m([g({type:S,constructOnly:!0,nonNullable:!0,json:{write:!0}})],d.prototype,"parallelLineSnapper",void 0),m([g({type:S,constructOnly:!0,nonNullable:!0,json:{write:!0}})],d.prototype,"rightAngleSnapper",void 0),m([g({type:S,constructOnly:!0,nonNullable:!0,json:{write:!0}})],d.prototype,"rightAngleTriangleSnapper",void 0),m([g({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],d.prototype,"shortLineThreshold",void 0),m([g({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],d.prototype,"distance",void 0),m([g({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],d.prototype,"pointThreshold",void 0),m([g({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],d.prototype,"intersectionParallelLineThreshold",void 0),m([g({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],d.prototype,"parallelLineThreshold",void 0),m([g({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],d.prototype,"verticalLineThresholdMeters",void 0),m([g({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],d.prototype,"touchSensitivityMultiplier",void 0),m([g({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],d.prototype,"pointOnLineThreshold",void 0),m([g({type:ct,nonNullable:!0})],d.prototype,"orange",void 0),m([g({type:ct,nonNullable:!0})],d.prototype,"orangeTransparent",void 0),m([g({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],d.prototype,"lineHintWidthReference",void 0),m([g({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],d.prototype,"lineHintWidthTarget",void 0),m([g({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],d.prototype,"lineHintFadedExtensions",void 0),m([g({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],d.prototype,"parallelLineHintWidth",void 0),m([g({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],d.prototype,"parallelLineHintLength",void 0),m([g({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],d.prototype,"parallelLineHintOffset",void 0),m([g({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],d.prototype,"rightAngleHintSize",void 0),m([g({type:Number,nonNullable:!0,range:{min:0,max:6},json:{write:!0}})],d.prototype,"rightAngleHintOutlineSize",void 0),m([g({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],d.prototype,"satisfiesConstraintScreenThreshold",void 0),d=m([Kt("esri.views.interactive.snapping.Settings.Defaults")],d);const zr=new d;var Q;(function(e){e[e.FEATURE=1]="FEATURE",e[e.SELF=2]="SELF",e[e.ALL=3]="ALL"})(Q||(Q={}));const Or=Symbol("grid-placement-graphic");function yn(e,t){const n=e.x-t.x,r=e.y-t.y;return n*n+r*r}function Hr(e,t){return Math.sqrt(yn(e,t))}function Ir(e,t){t.sort((n,r)=>At(n.targetPoint,e)-At(r.targetPoint,e))}var Yt;function Dr({point:e,distance:t,returnEdge:n,vertexMode:r,coordinateHelper:{spatialReference:s},filter:i},a,o){return o=o!=null?o.clone():new Ge({where:"1=1"}),i&&(o.geometry=i.geometry,o.distance=i.distance,o.spatialRelationship=i.spatialRelationship,o.where=Oe(o.where,i.where),o.timeExtent=He(o.timeExtent,i.timeExtent),o.objectIds=Ln(o.objectIds,i.objectIds)),{point:mt(e[0],e[1],e[2],s.toJSON()),mode:a,distance:t,returnEdge:n,vertexMode:r,query:o.toJSON()}}function Ln(e,t){return e||t?t?e?Array.from(Se(new Set(e),new Set(t))):t:e:null}function Fr(e,t,n){return{left:Wt(e.leftVertex.pos,t,n),right:Wt(e.rightVertex.pos,t,n)}}(function(e){e[e.TARGET=0]="TARGET",e[e.REFERENCE=1]="REFERENCE",e[e.REFERENCE_EXTENSION=2]="REFERENCE_EXTENSION"})(Yt||(Yt={}));const Ut=Symbol("snapping-toggle");function Gr(e,t=()=>{}){const n=qe(()=>({view:e.view,snappingOptions:e.snappingOptions}),({view:r,snappingOptions:s})=>{if(e.removeHandles(Ut),!r||!s)return;const i=Ve.TOOL,a=[r.on("key-down",o=>{o.key!==Ct.toggle||o.repeat||(s.enabledToggled=!0,t())},i),r.on("key-up",o=>{o.key===Ct.toggle&&(s.enabledToggled=!1,t())},i),r.on("pointer-move",o=>{const u=o.native.ctrlKey;s.enabledToggled!==u&&(s.enabledToggled=u,t())},i)];e.addHandles(a,Ut)},ze);e.addHandles(n)}function Vr(e){var t;return Ce(e)&&"utilityNetworks"in e&&!!((t=e.utilityNetworks)!=null&&t.length)}function jt({start:e,end:t,type:n},r,s){const i=[],a=Y(tt,t,e),o=Y(Lt,e,r),u=ht(a),c=2*gt(a,o),l=c*c-4*u*(ht(o)-s*s);if(l===0){const h=-c/(2*u);(n===b.PLANE||h>=0)&&i.push(at(Z(),e,a,h))}else if(l>0){const h=Math.sqrt(l),$=(-c+h)/(2*u);(n===b.PLANE||$>=0)&&i.push(at(Z(),e,a,$));const y=(-c-h)/(2*u);(n===b.PLANE||y>=0)&&i.push(at(Z(),e,a,y))}return i}function fe(e,t){const n=e.start,r=e.end,s=Y(tt,r,n),i=W($t,-s[1],s[0],0),a=t.start,o=t.end,u=A(qt,o,a),c=w(u,i),l=W(Ee,n[0],n[1],0),h=A(ve,l,a),$=w(h,i),y=K();if(Math.abs(c)<y)return[];const L=E(xe,a,u,$/c);if(t.type===v.RAY){const x=A(Pt,L,a);if(w(x,u)<-y)return[]}if(e.type===b.HALF_PLANE){const x=Ue(Lt,L,n);if(gt(x,s)<-y)return[]}return[U(L)]}function Nn(e,t){return En(ft(zt,t[2],e),t)}function de(e,t){return Ne(ft(zt,0,e),ft(An,0,t)).map(([r,s])=>ut(r,s))}function me(e,t,n){return ye(e,ft(zt,e[2],t),n)}function ge(e,t,n,r=p()){const s=Y(tt,e,t),i=Ye(s);return at(r,t,s,i===0?1:n/i),r[2]=e[2],r}function ye(e,{start:t,end:n,type:r},s=p()){const i=A(Nt,e,t),a=A($t,n,t),o=w(i,a)/w(a,a);return E(s,t,a,r===v.RAY?Math.max(o,0):o)}const $n=(()=>{const e=p(),t=p(),n=p();return({start:r,end:s},{center:i,radius:a,normal:o,slicePlane:u})=>{const c=yt(i,o,wn);if(f(_t(c,r),0)&&f(_t(c,s),0)){he(o,e,t);const h=(L,x)=>(Rt(n,x,i),se(L,w(n,e),w(n,t)),L),$=dn({start:h(tt,r),end:h(Lt,s),type:v.LINE},Be,a),y=[];for(const[L,x]of $){const _=ee(p(),i);E(_,_,e,L),E(_,_,t,x),u&&!G(u,_)||y.push(_)}return y}const l=p();return ue(c,r,s,l)?!f(ne(l,i),a)||u&&!G(u,l)?[]:[l]:[]}})();function Le({start:e,end:t,type:n},r,s){const i=[],a=Rt(Nt,t,e),o=Y(Lt,e,r),u=ht(a),c=2*gt(a,o),l=c*c-4*u*(ht(o)-s*s);if(l===0){const h=-c/(2*u);(n===v.LINE||h>=0)&&i.push(E(p(),e,a,h))}else if(l>0){const h=Math.sqrt(l),$=(-c+h)/(2*u);(n===v.LINE||$>=0)&&i.push(E(p(),e,a,$));const y=(-c-h)/(2*u);(n===v.LINE||y>=0)&&i.push(E(p(),e,a,y))}return i}function Ne(e,t){const n=e.start,r=e.end,s=t.start,i=t.end,a=A(Nt,r,n),o=A($t,i,s),u=A(qt,s,n),c=lt(Ee,a,o);if(!f(w(u,c),0))return[];const l=bt(c);if(f(l,0))return[];const h=lt(ve,u,o),$=w(h,c)/l,y=E(xe,n,a,$);if(e.type===v.RAY){const L=A(Pt,y,n);if(w(a,L)<-K())return[]}if(t.type===v.RAY){const L=A(Pt,y,s);if(w(o,L)<-K())return[]}return[U(y)]}function En({start:e,end:t,type:n},r){const s=A(Nt,r,e),i=A($t,t,e),a=lt(qt,i,s),o=bt(a)/bt(i),u=K();if(o<u)switch(n){case v.LINE:return[U(r)];case v.RAY:return w(i,s)<-u?[]:[U(r)]}return[]}function kt(e,t,n,r){const[s,i]=e,[a,o]=n,u=a-s,c=o-i,l=u*u+c*c,h=Math.sqrt(l);if(h>t+r)return[];if(h<Math.abs(t-r))return[];if(f(h,0)&&f(t,r))return[];const $=(t*t-r*r+l)/(2*h),y=Math.sqrt(t*t-$*$),L=y*c/h,x=y*u/h,[_,C]=Je(tt,e,n,$/h);return f(L,x)?[ut(_,C)]:[ut(_+L,C-x),ut(_-L,C+x)]}function ft(e,t,{start:n,end:r,type:s}){return W(e.start,n[0],n[1],t),W(e.end,r[0],r[1],t),e.type=xn[s],e}function $e(e,t){return f(e[2],t[2])}function f(e,t){return Ze(Math.abs(e-t),0,K())}function vn(e,t){return t.filter(n=>G(e,n))}function G(e,t){return nn(e,t)}var b;(function(e){e[e.PLANE=0]="PLANE",e[e.HALF_PLANE=1]="HALF_PLANE"})(b||(b={}));const xn={[b.PLANE]:v.LINE,[b.HALF_PLANE]:v.RAY},tt=Z(),Lt=Z(),Nt=p(),$t=p(),qt=p(),Ee=p(),ve=p(),xe=p(),Pt=p(),wn=P(),zt={start:p(),end:p(),type:v.LINE},An={start:p(),end:p(),type:v.LINE};class M{intersect(t){return O(this,t)}closestPoints(t){return[this.closestTo(t)]}}class et extends M{constructor(t){super(),this.point=t}equals(t){return this===t||R(t)&&N(this.point,t.point)}closestTo(){return B(this.point)}}class Ot extends M{constructor(t,n,r){super(),this.start=t,this.end=n,this.lineLike={start:t,end:n,type:r}}equals(t){return this===t||k(t)&&this.lineLike.type===t.lineLike.type&&N(this.start,t.start)&&N(this.end,t.end)}closestTo(t){const n=T();return ye(t,this.lineLike,n),n}}class we extends Ot{constructor(t,n){super(t,n,v.LINE)}}class bn extends Ot{constructor(t,n){super(t,n,v.RAY)}}class Ae extends M{constructor(t){super(),this.constraints=t}equals(t){return this===t||Mt(t)&&ke(this.constraints,t.constraints,(n,r)=>n.equals(r))}closestTo(t){let n,r=1/0;for(const s of this.constraints){const i=s.closestTo(t),a=At(t,i);a<r&&(r=a,n=i)}return B(n??t)}closestPoints(t){return this.constraints.flatMap(n=>n===this?[]:n.closestPoints(t))}}class Tn extends M{constructor(t,n){super(),this.center=t,this.radius=n}equals(t){return this===t||z(t)&&this.center[0]===t.center[0]&&this.center[1]===t.center[1]&&this.radius===t.radius}closestTo(t){const n=T();return ge(t,this.center,this.radius,n),n}}class Ht extends M{constructor(t,n){super(),this.center=t,this.radius=n}equals(t){return this===t||I(t)&&N(this.center,t.center)&&this.radius===t.radius}closestTo(t){const n=T();return ge(t,this.center,this.radius,n),n[2]=this.center[2],n}asCircle(){return new It(B(this.center),this.radius,V(0,0,1))}}class It extends M{constructor(t,n,r,s=void 0){super(),this.center=t,this.radius=n,this.normal=r,this.slicePlane=s}equals(t){return this===t||F(t)&&N(this.center,t.center)&&N(this.normal,t.normal)&&this.radius===t.radius}closestTo(t){const{center:n,radius:r}=this;ce(this.getPlane(_n),t,xt);const s=A(xt,xt,n),i=De(s);if(f(i,0))return B(t);const a=r/Math.sqrt(i),o=T();E(o,n,s,a);const{slicePlane:u}=this;if(u&&!G(u,o)){const c=Ft(u,this);return(c==null?void 0:c.closestTo(t))??B(t)}return o}getPlane(t=P()){return yt(this.center,this.normal,t)}}const xt=p(),_n=P();class Pn extends M{constructor(t){super(),this.z=t}equals(t){return this===t||H(t)&&this.z===t.z}closestTo(t){return V(t[0],t[1],this.z)}getPlane(t=P()){return W(Jt,0,0,this.z),yt(Jt,Qe,t)}}const Jt=p();class Dt extends M{constructor(t,n,r){super(),this.start=t,this.end=n,this.planeLike={start:t,end:n,type:r}}equals(t){return this===t||q(t)&&this.planeLike.type===t.planeLike.type&&N(this.start,t.start)&&N(this.end,t.end)}closestTo(t){const n=T();return me(t,this.planeLike,n),n}closestEndTo(t){const{start:n,end:r}=this.planeLike;return Math.sign(gt(Y(Mn,r,n),Y(Rn,t,n)))>0?this.end:this.start}getPlane(t=P()){const n=ee(Bt,this.end);return n[2]+=1,rn(this.start,this.end,n,t)}getSlicePlane(t=P()){const{start:n,end:r,type:s}=this.planeLike;if(s===b.PLANE)return;const i=W(Bt,n[0],n[1],0),a=W(Qt,r[0],r[1],0),o=Rt(Qt,a,i);return yt(i,o,t),t}}const Mn=Z(),Rn=Z(),Bt=p(),Qt=p();class Cr extends Dt{constructor(t,n){super(t,n,b.HALF_PLANE)}}class Zr extends Dt{constructor(t,n){super(t,n,b.PLANE)}}class Sn extends M{constructor(t,n){super(),this.sphere=an(t,n)}equals(t){return this===t||D(t)&&un(this.sphere,t.sphere)}closestTo(t){const n=T();return cn(this.sphere,t,n),n}get center(){return ln(this.sphere)}get radius(){return this.sphere[3]}}class jn extends M{constructor(t,n,r){super(),this.start=t,this.end=n,this.getZ=r,this.planeLike={start:t,end:n,type:b.PLANE}}equals(t){return this===t||dt(t)&&N(this.start,t.start)&&N(this.end,t.end)&&this.getZ===t.getZ}closestTo(t){return In(this,t)}addIfOnTheGround(t,n){for(const r of n){const s=this.getZ(r[0],r[1])??0;f(r[2],s)&&(r[2]=s,t.push(r))}}}class kn extends M{constructor(t,n,r){super(),this._x=t,this._y=n,this._z=r}equals(t){return this===t||er(t)&&this._x===t._x&&this._y===t._y&&this._z===t._z}closestTo([t,n,r]){return pe(this._x??t,this._y??n,this._z??r)}}class qn extends M{constructor(t,n,r,s,i){super(),this._origin=t,this._spatialReference=n,this._distanceMeters=r,this._z=s,this._directionDegrees=i}equals(t){return this===t||tr(t)&&Zt(this._origin,t._origin)&&this._spatialReference===t._spatialReference&&this._distanceMeters===t._distanceMeters&&this._z===t._z&&this._directionDegrees===t._directionDegrees}closestTo([t,n,r]){return se(X,t,n),Zt(X,this._origin)||this._applyDirectionAndDistance(X),pe(X[0],X[1],this._z??r)}_applyDirectionAndDistance(t){if(this._directionDegrees!=null&&this._distanceMeters!=null)Tt(t,this._origin,this._directionDegrees,this._distanceMeters,this._spatialReference);else if(this._directionDegrees!=null)On(t,this._origin,this._directionDegrees,t,this._spatialReference);else if(this._distanceMeters!=null){const{azimuth:n}=oe(zn,this._origin,t,this._spatialReference);Tt(t,this._origin,n??0,this._distanceMeters,this._spatialReference)}}}const X=[0,0],zn=new ae;function On(e,t,n,r,s){let{azimuth:i,distance:a}=oe(Hn,t,r,s);i??(i=0);let o=a*Math.cos((i-n)*en);o=Math.max(0,o),Tt(e,t,n,o,s)}const Hn=new ae;function In(e,t){const n=T();return me(t,e.planeLike,n),n[2]=e.getZ(n[0],n[1])??Te,n}function O(e,t){if(Mt(e)){const n=[];for(const r of e.constraints){const s=r.intersect(t);s&&n.push(s)}return Gt(n)}if(Mt(t))return O(t,e);if(dt(e))return Xt(e,t);if(dt(t))return Xt(t,e);if(R(e)){const{point:n}=e;if(R(t))return N(n,t.point)?e:void 0;const r=t.closestTo(n);return Ie(r,n)?e:void 0}if(k(e)){if(R(t))return O(t,e);if(k(t))return j(Ne(e.lineLike,t.lineLike));if(H(t))return Dn(e,t);if(q(t))return j(fe(t.planeLike,e.lineLike));if(z(t))return j(Le(e.lineLike,t.center,t.radius));if(F(t))return j($n(e.lineLike,t));if(I(t))return Fn(e,t);if(D(t))return Gn(e,t)}else if(H(e)){if(R(t)||k(t))return O(t,e);if(H(t))return Vn(e,t);if(q(t))return Cn(e,t);if(z(t))return Zn(e,t);if(F(t))return Yn(e,t);if(I(t))return Wn(e,t);if(D(t))return Un(e,t)}else if(q(e)){if(R(t)||k(t)||H(t))return O(t,e);if(q(t))return wt(de(e.planeLike,t.planeLike));if(z(t))return wt(jt(e.planeLike,t.center,t.radius));if(F(t))return Bn(e,t);if(I(t))return Jn(e,t);if(D(t))return Qn(e,t)}else if(z(e)){if(R(t)||k(t)||H(t)||q(t))return O(t,e);if(z(t))return wt(kt(e.center,e.radius,t.center,t.radius));if(F(t))return void 0;if(I(t))return Xn(e,t);if(D(t))return void 0}else if(F(e)){if(R(t)||k(t)||H(t)||q(t)||z(t))return O(t,e);if(F(t))return void 0;if(I(t))return t.asCircle(),void 0;if(D(t))return void 0}else if(I(e)){if(R(t)||k(t)||H(t)||q(t)||z(t)||F(t))return O(t,e);if(I(t))return Kn(t,e);if(D(t))return void 0}else if(D(e)){if(R(t)||k(t)||H(t)||q(t)||z(t)||I(t))return O(t,e);if(D(t))return void 0}}const Dn=(()=>{const e=P();return(t,n)=>{const{start:r,end:s}=t;if($e(r,s)&&f(r[2],n.z))return t;const i=T();return ue(n.getPlane(e),r,s,i)?new et(i):void 0}})();function Fn({lineLike:e},{center:t,radius:n}){const r=t[2];return j(Le(e,t,n).filter(s=>f(s[2],r)))}function Gn({lineLike:e},{sphere:t}){return j(on(t,e.start,e.end))}const Ft=(()=>{const e=tn(),t=p(),n=p();return(r,s,i)=>{const{normal:a,center:o,radius:u}=s;he(a,t,n);const c=le(r),l=u*w(c,t),h=u*w(c,n);Xe(e,o[0],o[1],o[2],1);const $=Ke(r,e),y=Math.hypot(l,h),L=f(y,0);if(f(_t(r,o),0)){if(L)return s;if(f(u,0))return!i||G(i,o)?new et(B(o)):void 0;lt(t,c,a),Fe(t,t);const vt=new Array,it=U(o);E(it,it,t,u),i&&!G(i,it)||vt.push(it);const ot=U(o);return E(ot,ot,t,-u),i&&!G(i,ot)||vt.push(ot),j(vt)}if(L)return;const x=-$/y;if(Math.abs(x)>1||f(x,1))return;const _=Math.atan(l/h),C=We(x)-_,Vt=Math.PI-C,nt=new Array,rt=p();E(rt,o,t,u*Math.cos(C)),E(rt,rt,n,u*Math.sin(C)),nt.push(rt);const st=p();return E(st,o,t,u*Math.cos(Vt)),E(st,st,n,u*Math.sin(Vt)),nt.push(st),j(i?vn(i,nt):nt)}})();function Vn(e,t){return f(e.z,t.z)?e:void 0}function Cn({z:e},{planeLike:t}){const[n,r]=t.start,[s,i]=t.end,a=V(n,r,e),o=V(s,i,e);return t.type===b.PLANE?new we(a,o):new bn(a,o)}function Zn(e,t){const[n,r]=t.center;return new Ht(V(n,r,e.z),t.radius)}function Wn(e,t){return f(t.center[2],e.z)?t:void 0}const Yn=(()=>{const e=P();return(t,n)=>Ft(t.getPlane(e),n,n.slicePlane)})();function Un(e,{center:t,radius:n}){const r=Math.abs(t[2]-e.z);if(r>n&&!f(r,n))return;const s=V(t[0],t[1],e.z),i=Math.sqrt(n**2-r**2);return f(i,0)?void 0:new Ht(s,i)}const Jn=(()=>{const e=P();return(t,{center:n,radius:r})=>{const s=jt(t.planeLike,n,r),i=n[2];t.getSlicePlane(e);const a=new Array;for(const[o,u]of s){const c=[o,u,i];G(e,c)&&a.push(c)}return j(a)}})(),Bn=(()=>{const e=P(),t=P();return(n,r)=>Ft(n.getPlane(e),r,n.getSlicePlane(t))})(),Qn=(()=>{const e=P();return(t,{center:n,radius:r})=>{const s=t.getPlane(e),i=sn(s,n),a=Math.abs(i);if(a>r&&!f(a,r))return;const o=Math.sqrt(r**2-i**2);if(f(o,0)){const l=T();return ce(s,n,l),new et(l)}const u=T(),c=U(le(s));return E(u,n,c,i),new It(u,o,c,t.getSlicePlane())}})();function Xn(e,t){const n=ie(e.center,t.center);return f(n,0)&&f(e.radius,t.radius)?t:be(kt(e.center,e.radius,t.center,t.radius),t.center[2])}function Kn(e,t){if(!$e(e.center,t.center))return;const n=ie(e.center,t.center);return f(n,0)&&f(e.radius,t.radius)?e:be(kt(e.center,e.radius,t.center,t.radius),e.center[2])}function Xt(e,t){const{planeLike:n,getZ:r}=e,s=new Array;if(R(t))e.addIfOnTheGround(s,Nn(n,t.point));else if(k(t))e.addIfOnTheGround(s,fe(n,t.lineLike));else if(z(t))for(const[i,a]of jt(n,t.center,t.radius)){const o=r(i,a);o!=null&&s.push(pt(i,a,o))}else if(q(t)||dt(t))for(const[i,a]of de(n,t.planeLike)){const o=r(i,a)??Te;s.push(pt(i,a,o))}return j(s)}function wt(e){return Gt(e.map(([t,n])=>{const r=V(t,n,0),s=V(t,n,1);return new we(r,s)}))}function j(e){return Gt(e.map(t=>t?new et(t):void 0))}function be(e,t){return j(e.map(([n,r])=>[n,r,t]))}function Gt(e){if(e.length!==0)return e.length===1?e[0]??void 0:new Ae(e.filter(je))}function Mt(e){return e instanceof Ae}function R(e){return e instanceof et}function k(e){return e instanceof Ot}function H(e){return e instanceof Pn}function q(e){return e instanceof Dt}function z(e){return e instanceof Tn}function I(e){return e instanceof Ht}function F(e){return e instanceof It}function D(e){return e instanceof Sn}function dt(e){return e instanceof jn}function tr(e){return e instanceof qn}function er(e){return e instanceof kn}const Te=0;let Et=class{constructor(t,n){this.isDraped=t,this.domain=n}},Yr=class _e extends Et{constructor(t,n,r,s,i=Q.ALL,a=!0,o=!0){super(s,i),this.type=t,this.lineStart=n,this.lineEnd=r,this.fadeLeft=a,this.fadeRight=o}equals(t){return t instanceof _e&&this.type===t.type&&N(this.lineStart,t.lineStart)&&N(this.lineEnd,t.lineEnd)&&this.fadeLeft===t.fadeLeft&&this.fadeRight===t.fadeRight}get length(){return ne(this.lineStart,this.lineEnd)}};class Pe extends Et{constructor(t,n,r=Q.ALL){super(n,r),this.intersectionPoint=t}equals(t){return t instanceof Pe&&N(this.intersectionPoint,t.intersectionPoint)}}let Ur=class Me extends Et{constructor(t,n,r,s=Q.ALL){super(r,s),this.lineStart=t,this.lineEnd=n}equals(t){return t instanceof Me&&N(this.lineStart,t.lineStart)&&N(this.lineEnd,t.lineEnd)}};class Re extends Et{constructor(t,n,r,s,i=Q.ALL){super(s,i),this.previousVertex=t,this.centerVertex=n,this.nextVertex=r}equals(t){return t instanceof Re&&N(this.previousVertex,t.previousVertex)&&N(this.centerVertex,t.centerVertex)&&N(this.nextVertex,t.nextVertex)}}export{Gt as A,Pn as B,yn as C,Fr as D,Ir as E,jn as F,we as G,ye as J,R as L,Wt as N,Zr as R,Sr as T,kn as U,qn as Z,Re as a,Et as b,T as c,Or as d,Mr as e,pe as f,V as g,et as h,kr as i,Q as j,Yt as k,Vr as l,Rr as m,Yr as n,Pe as o,zr as p,Cr as q,Ur as r,Pr as s,Hr as t,Gr as u,_r as v,mn as w,jr as x,Dr as y,Tn as z};
