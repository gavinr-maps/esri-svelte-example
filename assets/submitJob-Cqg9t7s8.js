const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./FeatureLayer-9fyQxXYm.js","./index-tefRSezt.js","./index-Cx51aysm.css","./Accessor-BHnuXKD2.js","./Graphic-CFXUQZlS.js","./Clonable-DvJsj5LF.js","./reactiveUtils-BR0C1Kq4.js","./Evented-DCWccWGU.js","./SimpleObservable-7oieNGD8.js","./JSONSupport-CGdeqxpk.js","./cast-BA_-jlhc.js","./writer-B2bQV2uU.js","./opacityUtils-CSd4XoR2.js","./Promise-CmQqe-ke.js","./Point-XGrwlf63.js","./enumeration-Cr5WIZs4.js","./Color-gncXBiLc.js","./colorUtils-Rxh2V3ai.js","./mathUtils-DV9iOXpW.js","./ActionToggle-__-l4AdQ.js","./Identifiable-BrT7zvUW.js","./jsonUtils-Cu7OBRmN.js","./Extent-CBBGeHb-.js","./Polyline-BmuD2-ZN.js","./typeUtils-BSg8Y507.js","./TextSymbol-BQ_NW9Xo.js","./screenUtils-_ZIvrt5o.js","./collectionUtils-CbaToa73.js","./Portal-CTRRujjZ.js","./vec3f64-BLpZdpfb.js","./aaBoundingBox-CeBivBRq.js","./MultiOriginJSONSupport-nGLpCFeg.js","./layerContainerType-C5CzMsLd.js","./FeatureLayerBase-DsahGowz.js","./formUtils-DXUHP5lI.js","./Field-Cyk7Ur5d.js","./fieldType-L-VlbZqy.js","./HeightModelInfo-B3GZyQFz.js","./commonProperties-C0eC30J9.js","./ElevationInfo-Di4W6v5U.js","./unitConversionUtils-C4AR5obr.js","./lengthUtils-DjJgJFRg.js","./AttributeTableTemplate-B7rH2qLr.js","./timeZoneUtils-COos5xIr.js","./featureLayerUtils-BzWCGee1.js","./uuid-Cl5lrJ4c.js","./featureQueryAll-xezK3WCp.js","./Query-DCBIeen2.js","./FullTextSearch-BWm_kPUE.js","./TimeExtent-J5qnUFx_.js","./timeUtils-D2X862bk.js","./layerUtils-dJgsXxkC.js","./SimpleRenderer-gSw1WaJS.js","./commonProperties-bGHL1a5M.js","./colorRamps-Dkx8zIVn.js","./SizeVariable-IzD1bP2e.js","./visualVariableUtils-Bp9QCb8E.js","./ColorStop-CDpeFWOz.js","./jsonUtils-Dzgxk9pw.js","./defaults-Dwxdhopq.js","./defaultsJSON-GKolV7NZ.js","./UniqueValueRenderer-Cri3tgP5.js","./diffUtils-CMkuJvD2.js","./RendererLegendOptions-mgfHoilI.js","./styleUtils-BB-zx7mT.js","./AttachmentQuery-BceVlzuF.js","./NormalizationBinParametersMixin-D6iHLB7I.js","./RelationshipQuery-W-4bfgaH.js","./LayerFloorInfo-BXAHB-yQ.js","./Relationship-BBBusoKs.js","./serviceCapabilitiesUtils-BuKg0yWx.js","./infoFor3D-CsJzgCF0.js","./Layer-C9uQlTBT.js","./workers-D8Q3pEzK.js","./Queue-BOnccek2.js","./intl-Do3GEEJ7.js","./editsZScale-BKYnJc2O.js","./queryZScale-DwN6mTru.js","./projection-B2I9Bzj_.js","./projectBuffer-DOU0xvVi.js","./geodesicConstants-yASAK_zX.js","./FeatureSet-DpCN730g.js","./APIKeyMixin-Btq102Nx.js","./ArcGISService-BHkTabnw.js","./ScaleRangeLayer-C59zG_yk.js","./jsonUtils-TjZmCq6l.js","./utils-DYurMneM.js","./mat4f32-DcsiF_Rp.js","./mat4-Fi6iAz29.js","./common-DQOJ18NT.js","./CustomParametersMixin-uo3x70vd.js","./DisplayFilteredLayer-BFGyM6i5.js","./scaleUtils-CfLu-sg1.js","./displayFilterUtils-DV_nOx_h.js","./EditBusLayer-Cx9SJosU.js","./FeatureEffectLayer-D3Dl2pXD.js","./FeatureEffect-xxsfLT-y.js","./FeatureFilter-DEE1jTWq.js","./FeatureReductionLayer-x8j38_gH.js","./FeatureReductionSelection-BpUGF9oj.js","./labelingInfo-BvMdv93l.js","./labelUtils-Dq8OkaT-.js","./jsonUtils-DD1NMzWj.js","./typeUtils-CfF4cYo5.js","./ClassBreaksRenderer-BBSNkSFx.js","./LRUCache-DS2O1kTf.js","./MemCache-CDoaVBHf.js","./Version-9k2AOv05.js","./FieldsIndex-DFdVonga.js","./utils-B91u8350.js","./defaultCIMValues-DII_GG3u.js","./enums-BJSSbDkD.js","./HeatmapColorStop-c4wClnpW.js","./heatmapUtils-DA7NmY3d.js","./vec42-YcqnINSP.js","./vec4f64-o2zAXfmz.js","./MD5-C9MwAd2G.js","./OperationalLayer-Bts9W3HA.js","./OrderedLayer-BP2hvfL_.js","./OrderByInfo-E-O9nvtm.js","./PortalLayer-jhi5QQgB.js","./PortalItem-CXk7DqVv.js","./portalItemUtils-rm7sAgcm.js","./RefreshableLayer-Cn2UpWQD.js","./TemporalLayer-CYEvmdjr.js","./TimeInfo-LjqhhubF.js","./TimeInterval-BDTTJ9Uw.js","./TrackableLayer-D6paP6wl.js","./FeatureTemplate-DqbLvkbZ.js","./FeatureType-DjGGrg1i.js","./fieldProperties-B9JP3-ue.js","./TitleCreator-Zm6TQ_ec.js","./versionUtils-DSsYFI36.js","./styleUtils-BQ_uVsZf.js","./popupUtils-pQ0CVidQ.js","./interfaces-CL2NbQte.js","./MapImageLayer-CEQrBTCd.js","./loadAll-Do8S8AWH.js","./SublayersOwner-CFe19gPw.js","./CollectionFlattener-B9CFCLSp.js","./QueryTask-BTjeI7Co.js","./utils-Cy8wFNQo.js","./executeForIds-CUQYF7Pj.js","./query-BS_L6I0Q.js","./normalizeUtils-XRAPXbWa.js","./normalizeUtilsCommon-D0zPTJCj.js","./utils-CkSELPnj.js","./pbfQueryUtils-AwPAOS5M.js","./pbf-CFI-xDDp.js","./memoryEstimations-5gFNwkKK.js","./OptimizedGeometry-7IxBWtHr.js","./OptimizedFeature-DcMLlxvB.js","./OptimizedFeatureSet-Blu9Ckm7.js","./executeQueryJSON-CLYdIUdF.js","./featureConversionUtils-DpmsPUmt.js","./sublayerUtils--wN8JjVc.js","./ExportImageParameters-D29STznD.js","./floorFilterUtils-DZ5C6FQv.js","./imageBitmapUtils-BSeMtYaY.js"])))=>i.map(i=>d[i]);
import{r as o,m as i,g as oe,h as re,a as f,a4 as E,a6 as _}from"./Accessor-BHnuXKD2.js";import{w as Z}from"./Extent-CBBGeHb-.js";import{g as x}from"./Point-XGrwlf63.js";import{_ as B}from"./index-tefRSezt.js";import{o as ae,P,i as se}from"./cast-BA_-jlhc.js";import{R as ie}from"./normalizeUtils-XRAPXbWa.js";import{y as ne}from"./Field-Cyk7Ur5d.js";import{S as j}from"./JSONSupport-CGdeqxpk.js";import{s as le,f as $}from"./utils-Cy8wFNQo.js";import{r as C}from"./enumeration-Cr5WIZs4.js";import{s as ue,t as ce}from"./networkEnums-n7t8Au-e.js";import{d as M}from"./FeatureSet-DpCN730g.js";import{a as pe}from"./GPMessage-ttuUMj6y.js";var V;let m=V=class extends oe{constructor(t){super(t),this.outSpatialReference=null,this.processExtent=null,this.processSpatialReference=null,this.returnColumnName=!1,this.returnFeatureCollection=!1,this.returnM=!1,this.returnZ=!1}static from(t){return re(V,t)}};o([i({type:x})],m.prototype,"outSpatialReference",void 0),o([i({type:Z})],m.prototype,"processExtent",void 0),o([i({type:x})],m.prototype,"processSpatialReference",void 0),o([i({nonNullable:!0})],m.prototype,"returnColumnName",void 0),o([i({nonNullable:!0})],m.prototype,"returnFeatureCollection",void 0),o([i({nonNullable:!0})],m.prototype,"returnM",void 0),o([i({nonNullable:!0})],m.prototype,"returnZ",void 0),m=V=o([f("esri.rest.geoprocessor.GPOptions")],m);const W=m;let p=class extends j{constructor(){super(...arguments),this.extent=null,this.height=null,this.href=null,this.opacity=1,this.rotation=0,this.scale=null,this.visible=!0,this.width=null}};o([i({type:Z})],p.prototype,"extent",void 0),o([i()],p.prototype,"height",void 0),o([i()],p.prototype,"href",void 0),o([i()],p.prototype,"opacity",void 0),o([i()],p.prototype,"rotation",void 0),o([i()],p.prototype,"scale",void 0),o([i()],p.prototype,"visible",void 0),o([i()],p.prototype,"width",void 0),p=o([f("esri.layers.support.MapImage")],p);const me=p;let w=class extends j{constructor(e){super(e),this.area=0,this.units=null}};o([i({json:{write:!0}})],w.prototype,"area",void 0),o([C(ue)],w.prototype,"units",void 0),w=o([f("esri.rest.support.ArealUnit")],w);const de=w;let G=class extends j{constructor(e){super(e),this.itemId=null,this.url=null}};o([i({type:String,json:{read:{source:"itemID"},write:{target:"itemID"}}})],G.prototype,"itemId",void 0),o([i({type:String,json:{write:!0}})],G.prototype,"url",void 0),G=o([f("esri.rest.support.DataFile")],G);const D=G;let T=class extends j{constructor(t){super(t),this.distance=0,this.units=null}};o([i({json:{write:!0}})],T.prototype,"distance",void 0),o([C(ce)],T.prototype,"units",void 0),T=o([f("esri.rest.support.LinearUnit")],T);const be=T,u="multi-value-",F=new ae({GPArealUnit:"areal-unit",GPBoolean:"boolean",GPComposite:"composite",GPDataFile:"data-file",GPDate:"date",GPDouble:"double",GPFeatureRecordSetLayer:"feature-record-set-layer",Field:"field",GPLinearUnit:"linear-unit",GPLong:"long",GPRasterData:"raster-data",GPRasterDataLayer:"raster-data-layer",GPRecordSet:"record-set",GPString:"string",GPValueTable:"value-table","GPMultiValue:GPArealUnit":`${u}areal-unit`,"GPMultiValue:GPBoolean":`${u}boolean`,"GPMultiValue:GPComposite":`${u}composite`,"GPMultiValue:GPDataFile":`${u}data-file`,"GPMultiValue:GPDate":`${u}date`,"GPMultiValue:GPDouble":`${u}double`,"GPMultiValue:GPFeatureRecordSetLayer":`${u}feature-record-set-layer`,"GPMultiValue:Field":`${u}field`,"GPMultiValue:GPLinearUnit":`${u}linear-unit`,"GPMultiValue:GPLong":`${u}long`,"GPMultiValue:GPRasterData":`${u}raster-data`,"GPMultiValue:GPRasterDataLayer":`${u}raster-data-layer`,"GPMultiValue:GPRecordSet":`${u}record-set`,"GPMultiValue:GPString":`${u}string`});let S=class extends j{constructor(t){super(t),this.dataType=null,this.paramName=null,this.value=null}};o([C(F,{ignoreUnknown:!1})],S.prototype,"dataType",void 0),o([i()],S.prototype,"paramName",void 0),o([i()],S.prototype,"value",void 0),S=o([f("esri.rest.support.ParameterValue")],S);const he=S;let J=class extends j{constructor(t){super(t),this.format=null,this.itemId=null,this.url=null}};o([i()],J.prototype,"format",void 0),o([i({json:{read:{source:"itemID"},write:{target:"itemID"}}})],J.prototype,"itemId",void 0),o([i()],J.prototype,"url",void 0),J=o([f("esri.rest.support.RasterData")],J);const fe=J;async function ye(t,e,s,r,a){const n={},l={},c=[];return je(r,c,n),ie(c).then(h=>{const{outSpatialReference:y,processExtent:g,processSpatialReference:d,returnColumnName:v,returnFeatureCollection:O,returnM:z,returnZ:H}=s,{path:K}=$(t);for(const q in n){const[ee,te]=n[q];l[q]=h.slice(ee,te)}const k=y?y.wkid||y:null,L=d?d.wkid||d:null,Q=e==="execute"?{returnColumnName:v||void 0,returnFeatureCollection:O||void 0,returnM:z||void 0,returnZ:H||void 0}:null,X=R({...g?{context:{extent:g,outSR:k,processSR:L}}:{"env:outSR":k,"env:processSR":L},...r,...Q,f:"json"},null,l),Y={...a,query:X};return P(`${K}/${e}`,Y)})}function je(t,e,s){for(const r in t){const a=t[r];if(a&&typeof a=="object"&&a instanceof M){const{features:n}=a;s[r]=[e.length,e.length+n.length],n.forEach(l=>{e.push(l.geometry)})}}}async function U(t,e){switch(t){case"areal-unit":return de.fromJSON(e);case"boolean":case"double":case"long":case"string":case"value-table":return e;case"date":return new Date(e);case"data-file":return D.fromJSON(e);case"linear-unit":return be.fromJSON(e);case"feature-record-set-layer":if("url"in e)return D.fromJSON(e);if("layerDefinition"in e){const s=new(await B(async()=>{const{default:n}=await import("./FeatureLayer-9fyQxXYm.js");return{default:n}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135]),import.meta.url)).default,{layerDefinition:r,featureSet:a}=e;return s.read({layerDefinition:r,featureSet:a},{origin:"portal-item"}),s.spatialReference=x.fromJSON(a.spatialReference??r.spatialReference??r.extent.spatialReference),s}return M.fromJSON(e);case"record-set":return"url"in e?D.fromJSON(e):M.fromJSON(e);case"raster-data":case"raster-data-layer":return"mapImage"in e?me.fromJSON(e.mapImage):fe.fromJSON(e);case"field":return ne.fromJSON(e)}}function ge(t){return t.startsWith(u)}function ve(t){return t.replace(u,"")}async function $e(t,e){const s=ve(t),r=s==="composite"?e.map(a=>U(F.fromJSON(a.dataType),a.value)):e.map(a=>U(s,a));return Promise.all(r)}async function A(t){const e=F.fromJSON(t.dataType),{paramName:s}=t,r=ge(e)?await $e(e,t.value):await U(e,t.value);return new he({dataType:e,paramName:s,value:r})}function R(t,e,s){for(const r in t){const a=t[r];Array.isArray(a)?t[r]=JSON.stringify(a.map(n=>R({item:n},!0).item)):a instanceof Date&&(t[r]=a.getTime())}return le(t,e,s)}var N;const Se=se()({esriJobCancelled:"job-cancelled",esriJobCancelling:"job-cancelling",esriJobDeleted:"job-deleted",esriJobDeleting:"job-deleting",esriJobTimedOut:"job-timed-out",esriJobExecuting:"job-executing",esriJobFailed:"job-failed",esriJobNew:"job-new",esriJobSubmitted:"job-submitted",esriJobSucceeded:"job-succeeded",esriJobWaiting:"job-waiting"},{ignoreUnknown:!1}),I=1e3;let b=N=class extends j{constructor(t){super(t),this.jobId=null,this.jobStatus=null,this.messages=null,this.progress=null,this.requestOptions=null,this.sourceUrl=null,this._cancelJobTimer=void 0,this._jobCompletionTimer=void 0}async cancelJob(t){const{jobId:e,sourceUrl:s}=this,{path:r}=$(s),a={...this.requestOptions,...t,query:{f:"json"}},n=`${r}/jobs/${e}/cancel`,{data:l}=await P(n,a),{messages:c,jobStatus:h,progress:y}=N.fromJSON(l);return this.set({messages:c,jobStatus:h,progress:y}),h==="job-cancelled"?this:new Promise((g,d)=>{E(a.signal,()=>{this.clearCancelJobTimer(),d(_())}),this.clearCancelJobTimer();const v=()=>{this._cancelJobTimer||d(_()),this.checkJobStatus(t).then(({jobStatus:O})=>{switch(O){case"job-cancelling":default:this._cancelJobTimer=setTimeout(v,I);break;case"job-deleted":case"job-deleting":case"job-executing":case"job-failed":case"job-new":case"job-submitted":case"job-succeeded":case"job-timed-out":case"job-waiting":d(this);break;case"job-cancelled":g(this)}})};this._cancelJobTimer=setTimeout(v,I)})}destroy(){clearInterval(this._cancelJobTimer),clearInterval(this._jobCompletionTimer)}async checkJobStatus(t){const{path:e}=$(this.sourceUrl),s={...this.requestOptions,...t,query:{f:"json"}},r=`${e}/jobs/${this.jobId}`,{data:a}=await P(r,s),{messages:n,jobStatus:l,progress:c}=N.fromJSON(a);return this.set({messages:n,jobStatus:l,progress:c}),this}async fetchResultData(t,e,s){e=W.from(e||{});const{returnColumnName:r,returnFeatureCollection:a,returnM:n,returnZ:l,outSpatialReference:c}=e,{path:h}=$(this.sourceUrl),y=R({returnColumnName:r||null,returnFeatureCollection:a||null,returnM:n||null,returnZ:l||null,outSR:c,returnType:"data",f:"json"},null),g={...this.requestOptions,...s,query:y},d=`${h}/jobs/${this.jobId}/results/${t}`,{data:v}=await P(d,g);return A(v)}async fetchResultImage(t,e,s){const{path:r}=$(this.sourceUrl),a={...e.toJSON(),f:"json"},n=R(a),l={...this.requestOptions,...s,query:n},c=`${r}/jobs/${this.jobId}/results/${t}`,{data:h}=await P(c,l);return A(h)}async fetchResultMapImageLayer(){const{path:t}=$(this.sourceUrl),e=t.indexOf("/GPServer/"),s=`${t.slice(0,Math.max(0,e))}/MapServer/jobs/${this.jobId}`;return new(await B(async()=>{const{default:r}=await import("./MapImageLayer-CEQrBTCd.js");return{default:r}},__vite__mapDeps([136,3,10,1,2,9,137,6,7,8,28,13,11,22,14,31,92,18,72,20,49,50,82,138,107,38,32,39,12,40,41,42,122,78,29,23,79,80,139,4,5,15,16,17,19,21,24,25,26,27,30,140,71,47,35,36,48,141,142,143,144,145,146,147,148,149,150,151,152,77,153,81,154,118,119,44,45,46,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,129,128,108,43,100,101,68,69,70,103,104,105,106,109,110,111,112,113,114,89,115,134,155,83,84,85,86,87,88,90,117,120,121,123,124,125,126,156,157,158,132]),import.meta.url)).default({url:s})}async waitForJobCompletion(t={}){const{interval:e=I,signal:s,statusCallback:r}=t;return new Promise((a,n)=>{E(s,()=>{this.clearJobCompletionTimer(),n(_())}),this.clearJobCompletionTimer();const l=()=>{this._jobCompletionTimer||n(_()),this.checkJobStatus().then(({jobStatus:c})=>{switch(c){case"job-succeeded":a(this);break;case"job-executing":case"job-new":case"job-submitted":case"job-waiting":r&&r(this),this._jobCompletionTimer=setTimeout(l,e);break;case"job-cancelled":case"job-cancelling":case"job-deleted":case"job-deleting":case"job-failed":case"job-timed-out":n(this);break;default:this._jobCompletionTimer=setTimeout(l,e)}}).catch(c=>{n(c)})};this._jobCompletionTimer=setTimeout(l,e)})}clearCancelJobTimer(){clearTimeout(this._cancelJobTimer),this._cancelJobTimer=void 0}clearJobCompletionTimer(){clearTimeout(this._jobCompletionTimer),this._jobCompletionTimer=void 0}};o([i()],b.prototype,"jobId",void 0),o([C(Se,{ignoreUnknown:!1})],b.prototype,"jobStatus",void 0),o([i({type:[pe]})],b.prototype,"messages",void 0),o([i()],b.prototype,"progress",void 0),o([i()],b.prototype,"requestOptions",void 0),o([i({json:{write:!0}})],b.prototype,"sourceUrl",void 0),b=N=o([f("esri.rest.support.JobInfo")],b);const Je=b;async function ke(t,e,s,r){return s=W.from(s||{}),ye(t,"submitJob",s,e??{},r).then(({data:a})=>{const n=Je.fromJSON(a);return n.sourceUrl=t,n})}export{A as O,ye as S,W as l,ke as s};
