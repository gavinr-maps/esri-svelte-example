import{R as m,U as b,K as p}from"./assets-C2mb-ea2.js";import{h as o,c as y}from"./subclass-BR3PhgZG.js";import{a as h}from"./Accessor-D6mNnsWy.js";import{C as w,c as g}from"./Portal-liet8xHC.js";const U=()=>!!o("enable-feature:force-wosr"),E=()=>!!o("enable-feature:direct-3d-object-feature-layer-display"),j=()=>o.add("enable-feature:direct-3d-object-feature-layer-display",!0,!0,!0),R=()=>o.add("enable-feature:direct-3d-object-feature-layer-display",!1,!0,!0),K=()=>!!o("enable-i3s-patching"),$=()=>o.add("enable-i3s-patching",!0,!0,!0),N=()=>o.add("enable-i3s-patching",!1,!0,!0),M=()=>!!o("enable-feature:SceneLayer-editing"),I=(e="i3s-patching")=>{switch(N(),R(),o.add("enable-feature:SceneLayer-editing",!0,!0,!0),e){case"feature-layer-view":j();break;case"i3s-patching":$()}};I("i3s-patching");let c={};async function S(e,r){try{return{data:(await A(e,r)).data,baseUrl:m(e),styleUrl:e}}catch(t){return h(t),null}}function C(e,r,t){var i;const n=r.portal!=null?r.portal:w.getDefault();let a;const l=`${n.url} - ${(i=n.user)==null?void 0:i.username} - ${e}`;return c[l]||(c[l]=q(e,n,t).then(s=>(a=s,s.fetchData())).then(s=>({data:s,baseUrl:a.itemUrl??"",styleName:e}))),c[l]}function q(e,r,t){return r.load(t).then(()=>{const n=new g({disableExtraQuery:!0,query:`owner:${u} AND type:${f} AND typekeywords:"${e}"`});return r.queryItems(n,t)}).then(({results:n})=>{var i;let a=null;const l=e.toLowerCase();if(n&&Array.isArray(n)){for(const s of n)if(((i=s.typeKeywords)==null?void 0:i.some(d=>d.toLowerCase()===l))&&s.type===f&&s.owner===u){a=s;break}}if(!a)throw new y("symbolstyleutils:style-not-found",`The style '${e}' could not be found`,{styleName:e});return a.load(t)})}function T(e,r,t){return(e==null?void 0:e.styleUrl)!=null?S(e.styleUrl,t):(e==null?void 0:e.styleName)!=null?C(e.styleName,r,t):Promise.reject(new y("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function P(e){return e===null||e.type==="CIMSymbolReference"?e:{type:"CIMSymbolReference",symbol:e}}function Q(e,r,t=["gltf"]){if(r==="cimRef")return encodeURI(e.cimRef);if(e.formatInfos&&!U())for(const n of t){const a=e.formatInfos.find(l=>l.type===n);if(a)return a.href}return encodeURI(e.webRef)}function A(e,r){const t={responseType:"json",query:{f:"json"},...r};return b(p(e),t)}const u="esri_en",f="Style",_="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json";export{E as a,A as b,Q as d,M as n,P as p,K as r,_ as w,T as y};
