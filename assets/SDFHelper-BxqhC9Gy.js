import{o as q}from"./floatRGBA-CKX-bz9l.js";import{A as G}from"./index-B1qcMJFy.js";import{t as U}from"./UpdateTracking2D-DqQVxF7b.js";import{$ as V}from"./definitions-C14Q9bsB.js";function $(n){var o;switch(n.type){case"CIMPointSymbol":{const r=n.symbolLayers;if(!r||r.length!==1)return null;const t=r[0];return t.type!=="CIMVectorMarker"?null:$(t)}case"CIMVectorMarker":{const r=n.markerGraphics;if(!r||r.length!==1)return null;const t=r[0];if(!t)return null;const i=t.geometry;if(!i)return null;const l=t.symbol;return!l||l.type!=="CIMPolygonSymbol"&&l.type!=="CIMLineSymbol"||(o=l.symbolLayers)!=null&&o.some(e=>!!e.effects)?null:{type:"sdf",geom:i,asFill:l.type==="CIMPolygonSymbol"}}}}function j(n){return n?n.rings?n.rings:n.paths?n.paths:n.xmin!==void 0&&n.ymin!==void 0&&n.xmax!==void 0&&n.ymax!==void 0?[[[n.xmin,n.ymin],[n.xmin,n.ymax],[n.xmax,n.ymax],[n.xmax,n.ymin],[n.xmin,n.ymin]]]:null:null}function z(n){let o=1/0,r=-1/0,t=1/0,i=-1/0;for(const l of n)for(const e of l)e[0]<o&&(o=e[0]),e[0]>r&&(r=e[0]),e[1]<t&&(t=e[1]),e[1]>i&&(i=e[1]);return new U(o,t,r-o,i-t)}function P(n){let o=1/0,r=-1/0,t=1/0,i=-1/0;for(const l of n)for(const e of l)e[0]<o&&(o=e[0]),e[0]>r&&(r=e[0]),e[1]<t&&(t=e[1]),e[1]>i&&(i=e[1]);return[o,t,r,i]}function O(n){return n?n.rings?P(n.rings):n.paths?P(n.paths):G(n)?[n.xmin,n.ymin,n.xmax,n.ymax]:null:null}function Q(n,o,r,t,i){const[l,e,f,u]=n;if(f<l||u<e)return[0,0,0,1];const m=f-l,s=u-e,a=128,c=V,M=Math.floor(.5*(.5*a-c)),h=(a-2*(M+c))/Math.max(m,s),g=Math.round(m*h)+2*M,d=Math.round(s*h)+2*M;let b=1;o&&(b=d/h/(o.ymax-o.ymin));let x=0,p=0,y=1;t&&(i?o&&r&&o.ymax-o.ymin>0&&(y=(o.xmax-o.xmin)/(o.ymax-o.ymin),x=t.x/(r*y),p=t.y/r):(x=t.x,p=t.y)),o&&(x=.5*(o.xmax+o.xmin)+x*(o.xmax-o.xmin),p=.5*(o.ymax+o.ymin)+p*(o.ymax-o.ymin)),x-=l,p-=e,x*=h,p*=h,x+=M,p+=M;let w=x/g-.5,v=p/d-.5;return i&&r&&(w*=r*y,v*=r),[b,w,v,y]}function R(n){const o=j(n.geom),r=z(o),t=128,i=V,l=Math.floor(.5*(.5*t-i)),e=(t-2*(l+i))/Math.max(r.width,r.height),f=Math.round(r.width*e)+2*l,u=Math.round(r.height*e)+2*l,m=[];for(const a of o)if(a&&a.length>1){const c=[];for(const M of a){let[h,g]=M;h-=r.x,g-=r.y,h*=e,g*=e,h+=l-.5,g+=l-.5,n.asFill?c.push([h,g]):c.push([Math.round(h),Math.round(g)])}if(n.asFill){const M=c.length-1;c[0][0]===c[M][0]&&c[0][1]===c[M][1]||c.push(c[0])}m.push(c)}const s=B(m,f,u,l);return n.asFill&&D(m,f,u,l,s),[E(s,l),f,u]}function B(n,o,r,t){const i=o*r,l=new Array(i),e=t*t+1;for(let f=0;f<i;++f)l[f]=e;for(const f of n){const u=f.length;for(let m=1;m<u;++m){const s=f[m-1],a=f[m];let c,M,h,g;s[0]<a[0]?(c=s[0],M=a[0]):(c=a[0],M=s[0]),s[1]<a[1]?(h=s[1],g=a[1]):(h=a[1],g=s[1]);let d=Math.floor(c)-t,b=Math.floor(M)+t,x=Math.floor(h)-t,p=Math.floor(g)+t;d<0&&(d=0),b>o&&(b=o),x<0&&(x=0),p>r&&(p=r);const y=a[0]-s[0],w=a[1]-s[1],v=y*y+w*w;for(let C=d;C<b;C++)for(let I=x;I<p;I++){let F,S,k=(C-s[0])*y+(I-s[1])*w;k<0?(F=s[0],S=s[1]):k>v?(F=a[0],S=a[1]):(k/=v,F=s[0]+k*y,S=s[1]+k*w);const A=(C-F)*(C-F)+(I-S)*(I-S),L=(r-I-1)*o+C;A<l[L]&&(l[L]=A)}}}for(let f=0;f<i;++f)l[f]=Math.sqrt(l[f]);return l}function D(n,o,r,t,i){for(const l of n){const e=l.length;for(let f=1;f<e;++f){const u=l[f-1],m=l[f];let s,a,c,M;u[0]<m[0]?(s=u[0],a=m[0]):(s=m[0],a=u[0]),u[1]<m[1]?(c=u[1],M=m[1]):(c=m[1],M=u[1]);let h=Math.floor(s),g=Math.floor(a)+1,d=Math.floor(c),b=Math.floor(M)+1;h<t&&(h=t),g>o-t&&(g=o-t),d<t&&(d=t),b>r-t&&(b=r-t);for(let x=d;x<b;++x){if(u[1]>x==m[1]>x)continue;const p=(r-x-1)*o;for(let y=h;y<g;++y)y<(m[0]-u[0])*(x-u[1])/(m[1]-u[1])+u[0]&&(i[p+y]=-i[p+y]);for(let y=t;y<h;++y)i[p+y]=-i[p+y]}}}}function E(n,o){const r=2*o,t=n.length,i=new Uint8Array(4*t);for(let l=0;l<t;++l){const e=.5-n[l]/r;q(e,i,4*l)}return i}export{R as a,$ as e,O as f,Q as m};
