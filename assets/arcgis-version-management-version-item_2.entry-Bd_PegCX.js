import{r as b,c as m,h as e,g as E}from"./index-Bh2oEzTI.js";/*!
 * All material copyright Esri, All Rights Reserved, unless otherwise specified.
 * See https://js.arcgis.com/4.31/esri/copyright.txt for details.
 * v4.31.2
 */const U=class{constructor(i){b(this,i),this.arcgisManageVersion=m(this,"arcgisManageVersion",7),this.versionItemElementProps=void 0}render(){const{versionItemElementProps:{currentUser:i,currentVersionIdentifier:n,hasAdvEditingUte:s,isVersionAdministrator:a,isVersioningApiAvailable:f,serviceUrl:c,strings:{actions:d},versionInfo:r}}=this,l=r.versionIdentifier.name,o=l.substring(l.lastIndexOf(".")+1),u=l.substring(0,l.lastIndexOf(".")),h=r.versionIdentifier.guid,p=`actionSwitchToVersion_${h}`,g=u.toUpperCase()===i.toUpperCase()&&f&&s||a,t=n.guid===r.versionIdentifier.guid,V=e("calcite-action",{key:"1c34df91dc4d3976049116d6e6bc379f62944470",disabled:t,id:p,icon:"code-branch",text:"",onClick:()=>{this.arcgisManageVersion.emit({actionType:"changeVersion",serviceUrl:c,versionInfo:r})},slot:"actions-start"}),v=t?void 0:e("calcite-tooltip",{"overlay-positioning":"fixed",referenceElement:p},e("span",null,d.switchToVersion));return e("calcite-list-item",{key:"5b1d76572a4e9e94756443f7e0c689282073f383",description:u,label:o,selected:!1,value:h},V,v,e("calcite-action-menu",{key:"cded92497ea9510cbb3bb86b2c95900660c2f52b","overlay-positioning":"fixed",slot:"actions-end",label:""},e("calcite-action",{key:"8afbed1ebdffb2530590ae4943edb1f974cf8b4b",disabled:t,icon:"code-branch",onClick:()=>{this.arcgisManageVersion.emit({actionType:"changeVersion",serviceUrl:c,versionInfo:r})},scale:"s",text:d.switchToVersion,textEnabled:!0}),e("calcite-action",{key:"47cda1ce9d70e2b24e4f85810afbed4e08c9b991",disabled:!g||t,icon:"code-branch-edit",onClick:()=>{this.arcgisManageVersion.emit({actionType:"editVersion",serviceUrl:c,versionInfo:r})},scale:"s",text:d.editVersion,textEnabled:!0}),e("calcite-action",{key:"89edd6c95ab045e367974c66cadcf66c5f59d6be",disabled:!g||g&&t,icon:"trash",onClick:()=>{this.arcgisManageVersion.emit({actionType:"deleteVersion",serviceUrl:c,versionInfo:r})},scale:"s",text:d.deleteVersion,textEnabled:!0})))}get el(){return E(this)}},M=class{constructor(i){b(this,i),this.arcgisNewVersion=m(this,"arcgisNewVersion",7),this.arcgisGetVersions=m(this,"arcgisGetVersions",7),this.arcgisManageVersion=m(this,"arcgisManageVersion",7),this._handleFilterChange=()=>{const{versionListElementProps:{versionInfos:n}}=this,s=this._filterInputElement.value.toUpperCase();this._filteredVersionInfos=s===""?n:n.filter(a=>a.versionIdentifier.name.toUpperCase().includes(s)||a.versionIdentifier.guid.toUpperCase().includes(s)),this._filteredVersionInfos.length&&(this.currentPage=1)},this._handleNoticeClosed=()=>{this.versionListElementProps={...this.versionListElementProps,executionError:void 0}},this._handlePaginationChange=n=>{this.currentPage=n.target.startItem},this.currentPage=1,this.versionListElementProps=void 0,this._filteredVersionInfos=void 0}propertiesChangeHandler(i,n){n.versionInfos!==i.versionInfos&&(this._filteredVersionInfos=this.versionListElementProps.versionInfos,this._filterInputElement&&this._handleFilterChange())}componentWillLoad(){this._filteredVersionInfos=this.versionListElementProps.versionInfos}componentDidRender(){var i;(i=this._filterInputElement)==null||i.setFocus()}render(){const{currentPage:i,versionListElementProps:{closable:n,currentUser:s,currentVersionIdentifier:a,executionError:f,hasAdvEditingUte:c,heading:d,isVersionAdministrator:r,isVersioningApiAvailable:l,pageSize:o,serviceName:u,serviceUrl:h,state:p,strings:{headers:g},strings:t,versionInfos:V}}=this,v=e("calcite-block",{heading:g.currentVersion,description:a.name,overlayPositioning:"fixed"}),_=e("calcite-action",{id:"actionRefreshVersions",icon:"refresh",text:"",onClick:()=>{this.arcgisGetVersions.emit({serviceUrl:h})},slot:"header-actions-end"},e("calcite-tooltip",{"overlay-positioning":"fixed",referenceElement:"actionRefreshVersions"},e("span",null,t.actions.refreshVersions)));this._paginatedVersionInfos=this._filteredVersionInfos.length>o?this._paginate(this._filteredVersionInfos,o,i):this._filteredVersionInfos;const C=this._filteredVersionInfos.length>o?e("calcite-pagination",{onCalcitePaginationChange:this._handlePaginationChange,pageSize:1,startItem:i,totalItems:Math.ceil(this._filteredVersionInfos.length/o)}):void 0,x=this._paginate(this._paginatedVersionInfos,o,1).map(I=>e("arcgis-version-management-version-item",{versionItemElementProps:{currentUser:s,currentVersionIdentifier:a,isCurrentVersionCard:!1,hasAdvEditingUte:c,isVersionAdministrator:r,isVersioningApiAvailable:l,serviceUrl:h,strings:t,versionInfo:I}})),P=V.length>o?e("calcite-block",{heading:"",open:!0},e("calcite-input-text",{ref:I=>{this._filterInputElement=I},clearable:!0,icon:"search",onCalciteInputTextInput:this._handleFilterChange,placeholder:t.actions.searchVersions})):void 0,k=e("calcite-list",null,x),y=l&&c?e("calcite-fab",{appearance:"outline-fill",slot:"fab",textEnabled:!0,text:t.actions.newVersion,onClick:()=>{this.arcgisNewVersion.emit({serviceUrl:h})}}):void 0,w=f?e("calcite-notice",{onCalciteNoticeClose:this._handleNoticeClosed,class:"notice",closable:!0,kind:"warning",open:!0,scale:"s",slot:"footer",width:"full"},e("div",{slot:"message"},this._getExecutionError(f))):void 0;return e("calcite-flow-item",{closable:n,description:u,heading:d},e("calcite-panel",{loading:p==="executing"},v,e("calcite-panel",{heading:this._filteredVersionInfos.length?`${t.headers.manageVersions} (${this._filteredVersionInfos.length})`:t.headers.manageVersions},_,P,k,y),C,w))}_getExecutionError(i){const{versionListElementProps:{strings:{executionErrors:n}}}=this;switch(i){case"no-advanced-editing-user-type-extension":return n.noAdvancedEditingUserTypeExtension;case"no-feature-service-found":return n.noFeatureServiceFound;case"no-valid-enterprise-version":return n.notValidEnterpriseVersion;case"no-valid-version-name":return n.invalidVersionName;default:return i}}_paginate(i,n,s){return i.slice((s-1)*n,s*n)}get el(){return E(this)}static get watchers(){return{versionListElementProps:["propertiesChangeHandler"]}}};export{U as arcgis_version_management_version_item,M as arcgis_version_management_version_list};
