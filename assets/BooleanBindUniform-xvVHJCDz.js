import{r as i,m as a,a as h,g as m,s as l}from"./Accessor-BHnuXKD2.js";import{d as f,P as p}from"./reactiveUtils-BR0C1Kq4.js";import"./mat4f64-Dk4dwAN8.js";import"./mathUtils-DV9iOXpW.js";import"./mat4-Fi6iAz29.js";import"./vec3f64-BLpZdpfb.js";import"./projectBuffer-DOU0xvVi.js";import"./Point-XGrwlf63.js";import{a as g}from"./basicInterfaces-CZwQPxTp.js";import{n as u}from"./glsl-BH37Aalp.js";import{e as v}from"./VertexAttribute-Cq4MnHjR.js";import{a as w}from"./BindType-BBwFZqyN.js";import{i as _}from"./Matrix3PassUniform-Bhi2fM3C.js";var d,c;(function(e){e.OPAQUE="opaque-color",e.TRANSPARENT="transparent-color",e.COMPOSITE="composite-color",e.FINAL="final-color"})(d||(d={})),function(e){e.SSAO="ssao",e.LASERLINES="laserline-color",e.ANTIALIASING="aa-color",e.HIGHLIGHTS="highlight-color",e.MAGNIFIER="magnifier-color",e.OCCLUDED="occluded-color",e.VIEWSHED="viewshed-color",e.OPAQUE_ENVIRONMENT="opaque-environment-color",e.TRANSPARENT_ENVIRONMENT="transparent-environment-color",e.FOCUSAREA="focus-area"}(c||(c={}));let t=class extends m{constructor(e){super(e),this.view=null,this.consumes={required:[]},this.produces=d.COMPOSITE,this.requireGeometryDepth=!1,this._dirty=!0}initialize(){this.addHandles([f(()=>this.view.ready,e=>{var r;e&&((r=this.view._stage)==null||r.renderer.addRenderNode(this))},p)])}destroy(){var e,r;(r=(e=this.view._stage)==null?void 0:e.renderer)==null||r.removeRenderNode(this)}precompile(){}render(){throw new l("RenderNode:render-function-not-implemented","render() is not implemented.")}get camera(){return this.view.state.camera.clone()}get sunLight(){return this.bindParameters.lighting.legacy}get gl(){return this.view._stage.renderView.renderingContext.gl}get techniques(){return this.view._stage.renderView.techniques}acquireOutputFramebuffer(){var n,o,s;const e=(o=(n=this._frameBuffer)==null?void 0:n.getTexture())==null?void 0:o.descriptor,r=this.view._stage.renderer.fboCache.acquire((e==null?void 0:e.width)??640,(e==null?void 0:e.height)??480,this.produces);return(s=r.fbo)==null||s.initializeAndBind(),r}bindRenderTarget(){var e,r;return(r=(e=this._frameBuffer)==null?void 0:e.fbo)==null||r.initializeAndBind(),this._frameBuffer}requestRender(e){var r;e===g.UPDATE&&((r=this.view._stage)==null||r.renderView.requestRender(e)),this._dirty=!0}resetWebGLState(){var e;this.renderingContext.resetState(),this.renderingContext.bindFramebuffer((e=this._frameBuffer)==null?void 0:e.fbo)}get fboCache(){return this.view._stage.renderer.fboCache}get bindParameters(){return this.renderContext.bind}get renderingContext(){return this.view._stage.renderView.renderingContext}get renderContext(){var e;return(e=this.view._stage)==null?void 0:e.renderer.renderContext}updateAnimation(e){return!!this._dirty&&(this._dirty=!1,!0)}doRender(e){this._frameBuffer=e.find(({name:r})=>r===this.produces);try{return this.render(e)}finally{this._frameBuffer=null}}};i([a({constructOnly:!0})],t.prototype,"view",void 0),i([a({constructOnly:!0})],t.prototype,"consumes",void 0),i([a()],t.prototype,"produces",void 0),i([a({readOnly:!0})],t.prototype,"techniques",null),t=i([h("esri.views.3d.webgl.RenderNode")],t);const q=t;function $(e,r=!0){e.attributes.add(v.POSITION,"vec2"),r&&e.varyings.add("uv","vec2"),e.vertex.main.add(u`
      gl_Position = vec4(position, 0.0, 1.0);
      ${r?u`uv = position * 0.5 + vec2(0.5);`:""}
  `)}class B extends _{constructor(r,n){super(r,"bool",w.Bind,(o,s)=>o.setUniform1b(r,n(s)))}}export{$ as a,B as e,q as h,d as n,c as t};
