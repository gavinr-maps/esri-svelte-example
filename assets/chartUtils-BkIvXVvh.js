import{o as S,l as N}from"./ResponsiveTheme-BKJHh_LN.js";import{l as q}from"./intl-Dpfm8vPB.js";import{E as D,a6 as J,k as K}from"./subclass-BR3PhgZG.js";import{s as Q}from"./Accessor-D6mNnsWy.js";import{r as P}from"./signal-DzOfzcfh.js";import{g as W,b as _}from"./unitFormatUtils-DYi2eq8E.js";import{j as G}from"./Point-DB4Hp4hH.js";import{a as ii}from"./mathUtils-ClvKsMak.js";import{r as v,e as ti,s as oi}from"./ElevationProfile-CPXnNytD.js";import{W as ei,B as ni}from"./chartUtilsAm5-DC-C8JhZ.js";import{o as R}from"./jsxFactory-CbAu6VfF.js";import{r as ri}from"./themeUtils-C3zvZbsE.js";import{n as ai,g as X,b as si,x as li,l as pi,f as mi}from"./LineSeries-B87G_1RS.js";import{a3 as b,t as u,r as di,G as ci}from"./Theme-BPDNd4lz.js";import{u as O}from"./Tooltip-BU0Xplk2.js";import{s as ui}from"./substitute-JuF-yP_g.js";import"./Promise-CZrWwByK.js";import"./jsonMap-DCC6W5ex.js";import"./Evented-CXIxDjmW.js";import"./assets-C2mb-ea2.js";import"./index-CeCSsEgo.js";import"./reactiveUtils-BFQ0BtrB.js";import"./shared-B3wH2qpO.js";import"./ByteSizeUnit-BsxeN7wM.js";import"./Cyclical-BY_I03kj.js";import"./quantityUtils-d_-fFwhF.js";import"./writer-3zufXUNV.js";import"./memoize-DsJmrG76.js";import"./Graphic-Dc7F67nR.js";import"./geometry-DpwwkAX1.js";import"./Extent-DHjqVB-p.js";import"./Polyline-D97hl-6E.js";import"./PopupTemplate-ByHks6sq.js";import"./Clonable-cKbRam6-.js";import"./fieldUtils-CNduWQU9.js";import"./enumeration--HlxOQ_N.js";import"./Color-DDUWtbqR.js";import"./colorUtils-CS9vdHXB.js";import"./ActionToggle-C0Z1k2jc.js";import"./Identifiable-BLvpQbOc.js";import"./symbols-CsUQ5BxR.js";import"./TextSymbol-gKE-H_J6.js";import"./screenUtils-PfxkaaMN.js";import"./materialUtils-CQ3JLQ1x.js";import"./opacityUtils-BT7mQkwC.js";import"./aaBoundingBox-rJEWaOSN.js";import"./persistableUrlUtils-BcifXQ1Z.js";import"./collectionUtils-Dm1icNvk.js";import"./Portal-liet8xHC.js";import"./jsonUtils-Cma_7A64.js";import"./LRUCache-ju6LnIBZ.js";import"./MemCache-C6WUx-5V.js";import"./ElevationQueryTileCache-Sgr0RZBH.js";import"./projectVectorToVector-Chzd0Pq0.js";import"./projectBuffer-vsa0P_cF.js";import"./geodesicConstants-XRAvAZCD.js";import"./projectPointToVector-D3506wm2.js";import"./projection-A9yUaaTs.js";import"./LayerConstants-B33OP6sh.js";import"./layerUtils-erzwAANv.js";import"./Material-BN_i9QRJ.js";import"./interfaces-B8ge7Jg9.js";import"./basicInterfaces-wONHx_SN.js";import"./VertexAttribute-BnAa5VW0.js";import"./ViewingMode-Dodu7ZZk.js";import"./ElevationProvider-BHZsEIDd.js";import"./mat4-ybYUU6jq.js";import"./mat4f64-Dk4dwAN8.js";import"./vec42-B1mBkh1w.js";import"./vec4f64-CBQL1T0x.js";import"./sphere-7666U3LO.js";import"./plane-Bz78OrLf.js";import"./mat3f64-BBpwCtoL.js";import"./quatf64-BrpT0VRp.js";import"./vec2f64-Diu2Kaa8.js";import"./mathUtils-kvswLROa.js";import"./boundedPlane-CZE_hxQR.js";import"./lineSegment-BvgMMk26.js";import"./verticalOffsetUtils-DaB1QvwW.js";import"./mat3-DRqs2t5W.js";import"./orientedBoundingBox-COq6pSqo.js";import"./quat-ChS85qAG.js";import"./spatialReferenceEllipsoidUtils-BL8s_3ls.js";import"./computeTranslationToOriginAndRotation-CLzktXYu.js";import"./Intersector-CYIO18dt.js";import"./Intersector-wnm5hmmT.js";import"./defaultUnit-CU1dhBSy.js";import"./getDefaultUnitForView-CWbVfq0i.js";import"./throttle-jjSnxk80.js";import"./elevationInfoUtils-Bl7QRRwv.js";import"./unitConversionUtils-Dl04YuQU.js";import"./lengthUtils-D7_DvYH0.js";import"./vec2-B_ymkwGp.js";import"./geodesicUtils-iciHABcX.js";import"./QueueProcessor-Bu6RBZRX.js";import"./Queue-DpHko4Yk.js";import"./ReactiveMap-Dl_3-Rm5.js";import"./Scheduler-CDoWuxMK.js";import"./debugFlags-B3L9P_UW.js";import"./traversalUtils-DmE6QkgJ.js";import"./uuid-fwrPAdZb.js";import"./Ground-BuxgFYJy.js";import"./compilerUtils-BA04t1lN.js";import"./loadAll-DDw-urzS.js";import"./ElevationQuery-3e2hkgx_.js";import"./ElevationSamplerData-IYvomv6Y.js";import"./ElevationTile-DFGu58iL.js";import"./TileKey-DZd6gJy7.js";import"./GraphicsLayer-D2NeCfd2.js";import"./GraphicsCollection-nEq2FD1R.js";import"./Layer-C96_yo4i.js";import"./TimeExtent-41gxTbrv.js";import"./timeUtils-DQR2jUPL.js";import"./BlendLayer-DmvCcS5c.js";import"./jsonUtils-C4Wp5KpV.js";import"./parser-BN6zmHl-.js";import"./utils-D20M4_S8.js";import"./mat4f32-DcsiF_Rp.js";import"./ScaleRangeLayer-CKYXLXxK.js";import"./ElevationInfo-BxYXLfrw.js";import"./InputManager-C4xu1R9l.js";import"./SketchViewModel-CtuH7-ky.js";import"./isSupportedObject-B5Os5oYN.js";import"./SketchLabelOptions-10TdxHmI.js";import"./SnappingManager-GEHlVC1V.js";import"./UpdatingHandles-CMtXpTiG.js";import"./geometry2dUtils-BraNT6Fs.js";import"./FeatureFilter-BzdN7b7E.js";import"./Query-Cx4awVKu.js";import"./DataLayerSource-6X35yXpo.js";import"./Field-C8SaaeoI.js";import"./fieldType-CIG5ey7e.js";import"./FullTextSearch-BNIhEccm.js";import"./floorFilterUtils-DZ5C6FQv.js";import"./keybindings-DYR2fa8r.js";import"./utils-CXgSw6Sd.js";import"./layerViewUtils-D2JqIDZ8.js";import"./geodesicLengthMeasurementUtils-B9-VlVgL.js";import"./geometryEngine-BT1Ysmbs.js";import"./geometryEngineBase-RmbNeFm7.js";import"./_commonjsHelpers-DCkdB7M8.js";import"./hydrated-DO_xxk1P.js";import"./layerUtils-BS1Di3Pm.js";import"./hitTestSelectUtils-UXJPjatw.js";import"./screenUtils-BGG3AyYa.js";import"./UnitSelect-ZVAhYz9G.js";import"./globalCss-CZa70j6i.js";import"./DefaultTheme-BOVc-zga.js";import"./ColorSet-CwDqiT0o.js";import"./Tick-D7OsWsk4.js";import"./Button-DBSVhNn0.js";function fi(i,e,o=10){const t=z(e-i,!1);if(t===0)return[i,e];const n=z(t/(o-1),!0);return[Math.floor(i/n)*n,Math.ceil(e/n)*n]}function z(i,e){const o=Math.floor(Math.log10(i)),t=i/10**o;let n;return n=e?t<1.5?1:t<3?2:t<5?2.5:t<7?5:10:t<=1?1:t<=2?2:t<=3?2.5:t<=5?5:10,n*10**o}const A="#f8f8f8",E="#a9a9a9",g="#323232",xi="line",gi="fill",h=15,x=12,Y=.001,hi=.1,Ai=.02,I={fontFamily:"Avenir Next",paddingBottom:x/2,paddingLeft:0,paddingRight:0,paddingTop:0,axisGridStroke:"#f4f4f4",axisLabelsFontSize:9,axisLabelsFontWeight:"400",axisLabelsColor:E,axisTooltipFontSize:12,axisTooltipBackgroundColor:g,axisTooltipLabelColor:A,axisTooltipPaddingTop:Math.round(x/4),axisTooltipPaddingBottom:Math.round(x/4),axisTooltipPaddingHorizontal:Math.round(h/4),xAxisMinGridDistance:50,xAxisLabelsSpacing:Math.round(x/2),xAxisMinLabelPosition:.05,xAxisMaxLabelPosition:.9,yAxisMinGridDistance:30,yAxisLabelSpacing:Math.round(h/4),yAxisMinLabelPosition:0,yAxisMaxLabelPosition:.8,seriesTooltipFontSize:12,seriesTooltipBackgroundColor:A,seriesTooltipLabelColor:g,seriesFillLighten:.9,seriesTooltipSpacing:x/2,seriesTooltipPaddingVertical:Math.round(h/4),seriesTooltipPaddingHorizontal:Math.round(h/4)},vi={...I,axisGridStroke:g,axisLabelsColor:E,axisTooltipBackgroundColor:g,axisTooltipLabelColor:A,seriesTooltipBackgroundColor:g,seriesTooltipLabelColor:A,seriesFillLighten:-.75},y={minX:void 0,maxX:void 0,minY:void 0,maxY:void 0};async function Pe(i){const e=await ei(i.container);Q(i.abortOptions);const o=ri(),t=o?vi:I;e.setThemes(o?[S.new(e),N.new(e)]:[S.new(e)]);const n=R(i.container),r=e.container.children.push(ai.new(e,{panX:!0,panY:!0,paddingTop:t.paddingTop,paddingBottom:t.paddingBottom,paddingLeft:n?t.paddingRight:t.paddingLeft,paddingRight:n?t.paddingLeft:t.paddingRight,maxTooltipDistance:0}));r.zoomOutButton.set("forceHidden",!0);const a=r.xAxes.push(X.new(e,{renderer:si.new(e,{})})),s=r.yAxes.push(X.new(e,{renderer:li.new(e,{})})),m=P(null),l=P("loading"),p={params:i,chart:r,xAxis:a,yAxis:s,seriesInfos:new Map,messages:null,theme:t,pointerIsOver:!1,get state(){return l.value},get data(){return m.value},set data(d){m.value=d}};yi(p),Ti(p),bi(p);const c=D([ki(p,i.onRangeChange),Ci(p,i.onCursorPositionChange),L(e.events.once("frameended",()=>{l.value="ready"})),L(e)]);return{destroy:()=>{c.remove(),l.value="destroyed"},update:d=>{d.data===p.data&&d.messages===p.messages||M(p)||Li(p,d)},zoomOut:()=>V(p)}}function M(i){return i.state==="destroyed"}function bi({chart:i,xAxis:e,yAxis:o}){const t=pi.new(i.root,{behavior:"none",xAxis:e,yAxis:o});t.lineY.set("visible",!1),i.set("cursor",t)}function yi(i){var a;const{chart:e,xAxis:o,theme:t}=i;o.setAll({extraMax:0,extraMin:0,maxDeviation:0,numberFormatter:U(i,"distance"),strictMinMax:!0,strictMinMaxSelection:!0}),o.axisHeader.set("forceHidden",!0);const n=o.get("renderer");n.setAll({inside:!1,minGridDistance:t.xAxisMinGridDistance}),n.labels.template.setAll({centerX:b,centerY:b,fill:u(t.axisLabelsColor),fontFamily:t.fontFamily,fontSize:t.axisLabelsFontSize,fontWeight:t.axisLabelsFontWeight,maxPosition:t.xAxisMaxLabelPosition,minPosition:t.xAxisMinLabelPosition,paddingLeft:0,paddingRight:0,paddingTop:t.xAxisLabelsSpacing});const r=o.set("tooltip",O.new(e.root,{paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0}));(a=r.get("background"))==null||a.setAll({fill:u(t.axisTooltipBackgroundColor),stroke:void 0}),r.label.setAll({fill:u(t.axisTooltipLabelColor),fontFamily:t.fontFamily,fontSize:t.axisTooltipFontSize,paddingBottom:t.axisTooltipPaddingBottom,paddingLeft:t.axisTooltipPaddingHorizontal,paddingRight:t.axisTooltipPaddingHorizontal,paddingTop:t.axisTooltipPaddingTop}),n.grid.template.setAll({strokeOpacity:1,stroke:u(t.axisGridStroke)})}function Ti(i){const{yAxis:e,theme:o}=i;e.setAll({baseValue:v().noDataValue,extraMax:0,extraMin:0,maxDeviation:0,numberFormatter:U(i,"elevation"),strictMinMax:!0,strictMinMaxSelection:!0,tooltip:void 0}),e.axisHeader.set("visible",!1);const t=R(i.params.container),n=e.get("renderer");n.setAll({minGridDistance:o.yAxisMinGridDistance,opposite:t,inside:!0}),n.labels.template.setAll({centerX:b,centerY:di,fill:u(o.axisLabelsColor),fontFamily:o.fontFamily,fontSize:o.axisLabelsFontSize,fontWeight:o.axisLabelsFontWeight,maxPosition:o.yAxisMaxLabelPosition,minPosition:o.yAxisMinLabelPosition,paddingBottom:0,paddingLeft:t?0:o.yAxisLabelSpacing,paddingRight:t?o.yAxisLabelSpacing:0,paddingTop:0,textAlign:"start"}),n.grid.template.setAll({strokeOpacity:1,stroke:u(o.axisGridStroke)})}function Li(i,e){var s;if(M(i))return;const o=i.data??void 0,t=e.data??void 0;(s=i.chart.get("cursor"))==null||s.set("forceHidden",!(t!=null&&t.refined));const n=o!==t,r=(o==null?void 0:o.effectiveUnits)!==(t==null?void 0:t.effectiveUnits),a=(o==null?void 0:o.uniformScaling)!==(t==null?void 0:t.uniformScaling);i.data=t,i.messages=e.messages,(n||r)&&(Mi(i),Pi(i)),a&&V(i),T(i)}function V(i){M(i)||(i.xAxis.zoom(0,1),i.yAxis.zoom(0,1))}function Mi(i){const{chart:e,data:o,xAxis:t,yAxis:n}=i,{minX:r,maxX:a,minY:s,maxY:m}=Fi({data:o,pixelWidth:t.width(),pixelHeight:n.height()}),l=!!(o!=null&&o.uniformScaling),p=!!(o!=null&&o.refined);e.setAll({panX:!0,panY:l,pinchZoomX:p,pinchZoomY:p&&l,wheelX:"panX",wheelY:p?l?"zoomXY":"zoomX":"none"}),t.setAll({max:a,min:r,panX:!0,panY:!1,zoomX:!0,zoomY:l}),n.setAll({max:m,min:s,panX:!1,panY:l,zoomX:l,zoomY:l})}function Fi({data:i,pixelWidth:e,pixelHeight:o}){if(i==null)return y;const t=i.statistics,n=0,r=t==null?void 0:t.maxDistance;let a=t==null?void 0:t.minElevation,s=t==null?void 0:t.maxElevation;if(r==null||a==null||s==null)return y;const m=Math.max(r-n,Y);let l=Math.max(s-a,Y);const p=i.effectiveUnits;if(i.dynamicElevationRange){const c=G(m,p.distance,p.elevation);l=Math.max(l,c/v().maxChartRatio)}return a-=Ai*l,s=a+l+hi*l,[a,s]=fi(a,s,10),l=s-a,i.uniformScaling?Si({data:i,bounds:{minX:n,maxX:r,minY:a,maxY:s},pixelWidth:e,pixelHeight:o,centered:!0}):{minX:n,maxX:n+m,minY:a,maxY:a+l}}function Si({data:i,bounds:e,pixelWidth:o,pixelHeight:t,centered:n}){if(i==null)return e;let{minX:r,maxX:a,minY:s,maxY:m}=e;if(r==null||a==null||s==null||m==null)return y;const l=a-r,p=m-s,c=i.effectiveUnits,d=G(p,c.elevation,c.distance)/t/(l/o);return d>=1?[r,a]=k([r,a],d,n):[s,m]=k([s,m],1/d,n),{minX:r,maxX:a,minY:s,maxY:m}}function k([i,e],o,t){const n=(e-i)*o;if(t){const r=(i+e)/2-n/2;return[r,r+n]}return[i,i+n]}function Pi(i){var l;const{chart:e,data:o,seriesInfos:t,xAxis:n,yAxis:r}=i;if(o==null||o.lines.length===0)return void e.series.clear();const a=new Map,s=new Set(e.series.values),m=o.lines.length;for(let p=0;p<m;p++){const c=o.lines[p];let d=t.get(c.id);d?(d.fill&&s.delete(d.fill),s.delete(d.line)):(d=zi(i,c),d.fill&&e.series.push(d.fill),e.series.push(d.line)),a.set(d.id,d);const f=m-p-1;(l=d.fill)==null||l.set("layer",f),d.line.set("layer",m+f),Xi(i,d,c)}i.seriesInfos=a;for(const p of s)e.series.removeValue(p);n.set("layer",m+1),r.set("layer",m+2)}function Xi({theme:i},e,o){const t=u(o.color.toCss()),n=o.samples??[],r=n.length>0,{line:a,fill:s}=e;a.set("visible",r),a.set("stroke",t),s==null||s.set("visible",r),s==null||s.set("fill",ci.lighten(t,i.seriesFillLighten)),a.data.setAll(n),s==null||s.data.setAll(n)}function zi(i,e){const{id:o}=e,t=C(i,`${xi}-${o}`);t.setAll({dy:e.chartStrokeOffsetY,tooltip:Yi(i)}),t.strokes.template.setAll({strokeWidth:e.chartStrokeWidth});let n=null;return e.chartFillEnabled&&(n=C(i,`${gi}-${o}`),n.fills.template.setAll({fillOpacity:1,visible:!0})),{id:o,line:t,fill:n}}function C(i,e){return mi.new(i.chart.root,{connect:!1,excludeFromTotal:!0,fill:void 0,id:e,stroke:void 0,valueXField:"distance",valueYField:"elevation",xAxis:i.xAxis,yAxis:i.yAxis})}function Yi({theme:i,chart:e}){var r;const o=O.new(e.root,{autoTextColor:!1,forceHidden:!0,getFillFromSprite:!1,getLabelFillFromSprite:!1,pointerOrientation:"vertical",visible:!1}),t=i.seriesTooltipPaddingHorizontal,n=i.seriesTooltipPaddingVertical;return o.label.setAll({fill:u(i.seriesTooltipLabelColor),fontFamily:i.fontFamily,fontSize:i.seriesTooltipFontSize,paddingBottom:n,paddingLeft:t,paddingRight:t,paddingTop:n,textAlign:"start"}),(r=o.get("background"))==null||r.setAll({stroke:void 0,fill:u(i.seriesTooltipBackgroundColor)}),o.adapters.add("dy",a=>{var l;const s=i.seriesTooltipSpacing,m=((l=o.get("pointTo"))==null?void 0:l.y)??0;return(a??0)+(o.y()>m?s:-s)}),o}function ki(i,e){const{xAxis:o,yAxis:t}=i,n=()=>{e(w(o),w(t))},r=a=>[a.on("start",n),a.on("end",n)];return Z([...r(o),...r(t)])}function w(i){const e=Math.abs((i.get("end")??0)-(i.get("start")??0)),o=e!==0?1/e:1;return Math.abs(1-o)<ii()?1:o}function Ci(i,e){const{chart:o,xAxis:t,yAxis:n}=i,r=o.get("cursor"),a=o.plotContainer.events,s=l=>{i.pointerIsOver=l,T(i)},m=()=>{s(!1),e(null,null)};return Z([r==null?void 0:r.events.on("cursormoved",()=>{if(!i.pointerIsOver)return;T(i);let l=(r==null?void 0:r.getPrivate("positionX"))??0,p=(r==null?void 0:r.getPrivate("positionY"))??0;const c=i.data;if((c==null?void 0:c.statistics)!=null){const{maxDistance:d,minElevation:f,maxElevation:F}=c.statistics;d!=null&&(l=B(l,H(t),$(t),0,d)),f!=null&&F!=null&&(p=B(p,H(n),$(n),f,F))}e(l,p)}),a.on("pointerover",()=>s(!0)),a.on("pointerout",m),a.on("blur",m)])}function B(i,e,o,t,n){return(e+i*(o-e)-t)/(n-t)}function T(i){const e=wi(i);if(!e)return void i.seriesInfos.forEach(o=>{var t;(t=o.line.get("tooltip"))==null||t.set("forceHidden",!0)});i.seriesInfos.forEach(o=>{const t=o.line.get("tooltip");t.set("forceHidden",!1),t.label.set("text",e)}),i.xAxis.getTooltip().setAll({tooltipText:$i(i)})}function wi(i){const{data:e}=i,o=e==null?void 0:e.lines.map(t=>{var n;return{line:t,y:(n=j(i,t))==null?void 0:n.elevation}}).sort(Bi);return o&&o.length!==0&&o[0].y!=null?o.map(({y:t,line:n})=>Hi(i,n,t)).join(`
`):null}function Bi({y:i},{y:e}){return i==null?1:e==null?-1:e-i}function Hi(i,e,o){const{data:t,messages:n}=i;if(t==null||n==null)return"";const r=v().formatPrecision,a=ui(n.chartTooltip,{name:ti(e,n),elevation:o!=null?W(n,o,t.effectiveUnits.elevation,r):oi});return`[${e.color.toHex()}]●[/] ${a}`}function $i(i){const{data:e,messages:o}=i;if(e==null||o==null)return"";const t=e.lines[0],n=t?j(i,t):null,r=v().formatPrecision;return n!=null?W(o,n.distance,e.effectiveUnits.distance,r):"-"}function U(i,e){const o=ni.new(i.chart.root,{});return o.format=(t,n,r)=>{const{data:a,messages:s}=i;return s==null||a==null||typeof t=="string"?"":`${q(t,{maximumFractionDigits:r})} ${_(s,a.effectiveUnits[e],"abbr")}`},o}function j({chart:i,xAxis:e},o){const t=o.samples??[];if(t.length===0)return null;const n=i.get("cursor"),r=(n==null?void 0:n.getPrivate("positionX"))??0,a=e.toAxisPosition(r),s=e.positionToValue(a);return J(t,s,m=>m.distance)}function H(i){return i.positionToValue(i.get("start")??0)}function $(i){return i.positionToValue(i.get("end")??1)}function Z(i){return D(i.map(L))}function L(i){return K(()=>{i==null||i.dispose()})}export{Pe as createChart,Fi as getAdjustedBounds};
