import{r as t}from"./tslib.es6-B3Jf3DVX.js";import{m as i,a as m,n as p,a2 as O,b as L}from"./subclass-BZA_h8Db.js";import{n as V}from"./jsonMap-0cxwUWs2.js";import{s as S}from"./cast-Bjksrh93.js";import{o as d,r as R}from"./writer-DNAwXnhG.js";import{f}from"./assets-C43MgM-v.js";import{i as T}from"./Clonable-D3rtuBWg.js";import{o as D}from"./screenUtils-_ZIvrt5o.js";import{e as u,t as F,a as N,i as b}from"./sizeVariableUtils-Cmcuvw-4.js";import{viewScaleRE as _}from"./visualVariableUtils-DX1kS9Se.js";let h=class extends T(f){constructor(){super(...arguments),this.showLegend=null,this.title=null}};t([i({type:Boolean,json:{write:!0}})],h.prototype,"showLegend",void 0),t([i({type:String,json:{write:!0}})],h.prototype,"title",void 0),h=t([m("esri.renderers.visualVariables.support.VisualVariableLegendOptions")],h);const $=h,x=new V({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"});let o=class extends f{constructor(e){super(e),this.index=null,this.type=null,this.field=null,this.valueExpression=null,this.valueExpressionTitle=null,this.legendOptions=null}castField(e){return e==null?e:typeof e=="function"?(p.getLogger(this).error(".field: field must be a string value"),null):O(e)}get arcadeRequired(){return!!this.valueExpression}clone(){}getAttributeHash(){return`${this.type}-${this.field}-${this.valueExpression}`}};t([i()],o.prototype,"index",void 0),t([i({type:x.apiValues,readOnly:!0,json:{read:x.read,write:x.write}})],o.prototype,"type",void 0),t([i({type:String,json:{write:!0}})],o.prototype,"field",void 0),t([S("field")],o.prototype,"castField",null),t([i({type:String,json:{write:!0}})],o.prototype,"valueExpression",void 0),t([i({type:String,json:{write:!0}})],o.prototype,"valueExpressionTitle",void 0),t([i({readOnly:!0})],o.prototype,"arcadeRequired",null),t([i({type:$,json:{write:!0}})],o.prototype,"legendOptions",void 0),o=t([m("esri.renderers.visualVariables.VisualVariable")],o);const U=o;function q(e){return D(e)}var w;let l=w=class extends f{constructor(e){super(e),this.label=null,this.size=null,this.value=null,this.useMinValue=null,this.useMaxValue=null}clone(){return new w({label:this.label,size:this.size,value:this.value,useMaxValue:this.useMaxValue,useMinValue:this.useMinValue})}};t([i({type:String,json:{write:!0}})],l.prototype,"label",void 0),t([i({type:Number,cast:D,json:{write:!0}})],l.prototype,"size",void 0),t([i({type:Number,json:{write:!0}})],l.prototype,"value",void 0),t([i({type:Boolean,json:{write:!1}})],l.prototype,"useMinValue",void 0),t([i({type:Boolean,json:{write:!1}})],l.prototype,"useMaxValue",void 0),l=w=t([m("esri.renderers.visualVariables.support.SizeStop")],l);const A=l;let c=class extends ${constructor(){super(...arguments),this.customValues=null}};t([i({type:[Number],json:{write:!0}})],c.prototype,"customValues",void 0),c=t([m("esri.renderers.visualVariables.support.SizeVariableLegendOptions")],c);const B=c;var z;const y=new V({width:"width",depth:"depth",height:"height",widthAndDepth:"width-and-depth",all:"all"}),g=new V({unknown:"unknown",inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers"});function j(e){if(e!=null)return typeof e=="string"||typeof e=="number"?q(e):e.type==="size"?u(e)?e:(delete(e={...e}).type,new s(e)):void 0}function E(e,n,r){if(typeof e!="object")return e;const a=new s;return a.read(e,r),a}let s=z=class extends U{constructor(e){super(e),this.axis=null,this.legendOptions=null,this.normalizationField=null,this.scaleBy=null,this.target=null,this.type="size",this.useSymbolValue=null,this.valueExpression=null,this.valueRepresentation=null,this.valueUnit=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null,isScaleDriven:this.valueExpression!=null&&_.test(this.valueExpression)}}set index(e){u(this.maxSize)&&(this.maxSize.index=`visualVariables[${e}].maxSize`),u(this.minSize)&&(this.minSize.index=`visualVariables[${e}].minSize`),this._set("index",e)}get inputValueType(){return F(this)}set maxDataValue(e){e&&this.stops&&(p.getLogger(this).warn("cannot set maxDataValue when stops is not null."),e=null),this._set("maxDataValue",e)}set maxSize(e){e&&this.stops&&(p.getLogger(this).warn("cannot set maxSize when stops is not null."),e=null),this._set("maxSize",e)}castMaxSize(e){return j(e)}readMaxSize(e,n,r){return E(e,n,r)}set minDataValue(e){e&&this.stops&&(p.getLogger(this).warn("cannot set minDataValue when stops is not null."),e=null),this._set("minDataValue",e)}set minSize(e){e&&this.stops&&(p.getLogger(this).warn("cannot set minSize when stops is not null."),e=null),this._set("minSize",e)}castMinSize(e){return j(e)}readMinSize(e,n,r){return E(e,n,r)}get arcadeRequired(){return!!this.valueExpression||this.minSize!=null&&typeof this.minSize=="object"&&this.minSize.arcadeRequired||this.maxSize!=null&&typeof this.maxSize=="object"&&this.maxSize.arcadeRequired}set stops(e){this.minDataValue==null&&this.maxDataValue==null&&this.minSize==null&&this.maxSize==null?e&&Array.isArray(e)&&(e=e.filter(n=>!!n)).sort((n,r)=>n.value-r.value):e&&(p.getLogger(this).warn("cannot set stops when one of minDataValue, maxDataValue, minSize or maxSize is not null."),e=null),this._set("stops",e)}get transformationType(){return N(this,this.inputValueType)}readValueExpression(e,n){return e||n.expression&&"$view.scale"}writeValueExpressionWebScene(e,n,r,a){if(e==="$view.scale"){if(a!=null&&a.messages){const v=this.index,M=typeof v=="string"?v:`visualVariables[${v}]`;a.messages.push(new L("property:unsupported",this.type+"VisualVariable.valueExpression = '$view.scale' is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:M+".valueExpression",context:a}))}}else n[r]=e}readValueUnit(e){return e?g.read(e):null}clone(){var e,n;return new z({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:u(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:u(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:(e=this.stops)==null?void 0:e.map(r=>r.clone()),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:(n=this.legendOptions)==null?void 0:n.clone()})}flipSizes(){if(this.transformationType===b.ClampedLinear){const{minSize:e,maxSize:n}=this;return this.minSize=n,this.maxSize=e,this}if(this.transformationType===b.Stops){const e=this.stops;if(!e)return this;const n=e.map(a=>a.size).reverse(),r=e.length;for(let a=0;a<r;a++)e[a].size=n[a];return this}return this}getAttributeHash(){return`${super.getAttributeHash()}-${this.target}-${this.normalizationField}`}_interpolateData(){var e;return(e=this.stops)==null?void 0:e.map(n=>n.value||0)}};t([i({readOnly:!0})],s.prototype,"cache",null),t([i({type:y.apiValues,json:{type:y.jsonValues,origins:{"web-map":{read:!1}},read:y.read,write:y.write}})],s.prototype,"axis",void 0),t([i()],s.prototype,"index",null),t([i({type:String,readOnly:!0})],s.prototype,"inputValueType",null),t([i({type:B,json:{write:!0}})],s.prototype,"legendOptions",void 0),t([i({type:Number,value:null,json:{write:!0}})],s.prototype,"maxDataValue",null),t([i({type:Number,value:null,json:{write:!0}})],s.prototype,"maxSize",null),t([S("maxSize")],s.prototype,"castMaxSize",null),t([d("maxSize")],s.prototype,"readMaxSize",null),t([i({type:Number,value:null,json:{write:!0}})],s.prototype,"minDataValue",null),t([i({type:Number,value:null,json:{write:!0}})],s.prototype,"minSize",null),t([S("minSize")],s.prototype,"castMinSize",null),t([d("minSize")],s.prototype,"readMinSize",null),t([i({type:String,json:{write:!0}})],s.prototype,"normalizationField",void 0),t([i({readOnly:!0})],s.prototype,"arcadeRequired",null),t([i({type:String})],s.prototype,"scaleBy",void 0),t([i({type:[A],value:null,json:{write:!0}})],s.prototype,"stops",null),t([i({type:["outline"],json:{write:!0}})],s.prototype,"target",void 0),t([i({type:String,readOnly:!0})],s.prototype,"transformationType",null),t([i({type:["size"],json:{type:["sizeInfo"]}})],s.prototype,"type",void 0),t([i({type:Boolean,json:{write:!0,origins:{"web-map":{read:!1}}}})],s.prototype,"useSymbolValue",void 0),t([i({type:String,json:{write:!0}})],s.prototype,"valueExpression",void 0),t([d("valueExpression",["valueExpression","expression"])],s.prototype,"readValueExpression",null),t([R("web-scene","valueExpression")],s.prototype,"writeValueExpressionWebScene",null),t([i({type:["radius","diameter","area","width","distance"],json:{write:!0}})],s.prototype,"valueRepresentation",void 0),t([i({type:g.apiValues,json:{write:g.write,origins:{"web-map":{read:!1},"web-scene":{write:!0},"portal-item":{write:!0}}}})],s.prototype,"valueUnit",void 0),t([d("valueUnit")],s.prototype,"readValueUnit",null),s=z=t([m("esri.renderers.visualVariables.SizeVariable")],s);const Y=s;export{A as a,Y as b,U as c,B as p};
