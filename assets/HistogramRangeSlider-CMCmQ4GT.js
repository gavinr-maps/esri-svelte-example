import{r}from"./tslib.es6-B3Jf3DVX.js";import{l as u}from"./Color-BCS62Hs5.js";import{watch as p}from"./reactiveUtils-C5zUhJQJ.js";import{m as a,a as y,x as _}from"./subclass-BZA_h8Db.js";import w from"./Histogram-CuC1HIkv.js";import{l as C,A as B}from"./Slider-Lf1VhhQX.js";import{e as D,B as $,n as v}from"./jsxFactory-CJa39Fro.js";import{r as x,s as M,a as T}from"./utils-CfVnGNTZ.js";import{e as F}from"./globalCss-CZa70j6i.js";import"./colorUtils-0bJDPow9.js";import"./mathUtils-C4_ghTv4.js";import"./asyncUtils-CWX51uTe.js";import"./Accessor-BLX9ikPh.js";import"./Collection-CEdjem1-.js";import"./Evented-BHRw9x22.js";import"./shared-B3wH2qpO.js";import"./SimpleObservable-KocWTzVy.js";import"./intl-CChhNOV8.js";import"./date-DlqISzcw.js";import"./jsonMap-0cxwUWs2.js";import"./locale-C9TlLpzi.js";import"./messages-OmQvZhAg.js";import"./assets-C43MgM-v.js";import"./index-Bh2oEzTI.js";import"./Promise-B2Hu02L7.js";import"./uuid-fwrPAdZb.js";import"./cast-Bjksrh93.js";import"./utils-D3iwntXt.js";import"./fieldUtils-tmQlKvWo.js";import"./geometry-D964gYQX.js";import"./Extent-Bf3YTe7m.js";import"./Point-Cg0-ChZE.js";import"./writer-DNAwXnhG.js";import"./Polyline-D9YkgmM_.js";import"./ColorStop-Dk3U5tCk.js";import"./Basemap-DVYOaWHz.js";import"./collectionUtils-D_lHIu88.js";import"./Loadable-BabW5Xcc.js";import"./loadAll-B6mYSptb.js";import"./Portal-C10FKnaA.js";import"./PortalItem-DzgXrpyc.js";import"./persistableUrlUtils-fa1mAujs.js";import"./writeUtils-Dz7BsE1e.js";import"./layerUtils-BrNoooE9.js";import"./mat4f32-DcsiF_Rp.js";import"./mat4-GpOFENPA.js";import"./vec3f64-BLpZdpfb.js";import"./common-DQOJ18NT.js";import"./utils-Ce7L3imC.js";import"./symbols-CNimns--.js";import"./enumeration-Ba5njXdz.js";import"./TextSymbol-D8QO_KUV.js";import"./screenUtils-_ZIvrt5o.js";import"./materialUtils-DarhapKC.js";import"./opacityUtils-C68Tlu6_.js";import"./aaBoundingBox-BE7cC1jD.js";import"./Clonable-D3rtuBWg.js";import"./jsonUtils-CSnQD004.js";import"./parser-CTsgEym6.js";import"./utils-93yNk4Xc.js";import"./cimSymbolUtils-DXvZxabN.js";import"./utils-D2PLyMFF.js";import"./enums-CmIX1y88.js";import"./LRUCache-B_PHMSGm.js";import"./MemCache-Dx1v3xLC.js";import"./timeUtils-8fb_2oAt.js";import"./utils-BwQ00KBJ.js";import"./HeatmapColorStop-BJc5nbwr.js";import"./SizeVariable-936USOrb.js";import"./sizeVariableUtils-Cmcuvw-4.js";import"./visualVariableUtils-DX1kS9Se.js";import"./Graphic-DsxsIjhH.js";import"./PopupTemplate-BHMhS05j.js";import"./ActionToggle-iT4slXc7.js";import"./Identifiable-B1UbsKNt.js";import"./jsonUtils-CEfjT-BK.js";import"./compilerUtils-Dw3R0f-Z.js";import"./lengthUtils-DL1-FDQQ.js";let m=class extends C{constructor(t){super(t),this.average=null,this.bins=null,this.hasTimeData=!1,this.labelFormatFunction=s=>{if(this.hasTimeData)return x(s);const{max:d,min:e,precision:h}=this,l=d-e>10?2:h;return M(parseFloat(s.toFixed(l)))},this.rangeType="equal",this.standardDeviation=null}generateWhereClause(t){const{rangeType:s,state:d,values:e}=this;if(d!=="ready"||!(e!=null&&e.length)||t==null)return null;const h=e[0],l=e.length>1?e[e.length-1]:null;switch(s){case"equal":return`${t} = ${h}`;case"not-equal":return`${t} <> ${h}`;case"less-than":return`${t} < ${h}`;case"greater-than":return`${t} > ${h}`;case"at-least":return`${t} >= ${h}`;case"at-most":return`${t} <= ${h}`;case"between":return`${t} BETWEEN ${h} AND ${l}`;case"not-between":return`${t} NOT BETWEEN ${h} AND ${l}`;default:return null}}};r([a()],m.prototype,"average",void 0),r([a()],m.prototype,"bins",void 0),r([a()],m.prototype,"hasTimeData",void 0),r([a()],m.prototype,"labelFormatFunction",void 0),r([a()],m.prototype,"rangeType",void 0),r([a()],m.prototype,"standardDeviation",void 0),m=r([y("esri.widgets.HistogramRangeSlider.HistogramRangeSliderViewModel")],m);const f=m,g="esri-histogram-range-slider",c={base:g,sliderContainer:`${g}__slider-container`,histogramContainer:`${g}__histogram-container`,rangeTypePrefix:`${g}__range-type--`};let o=class extends ${constructor(t,s){super(t,s),this._barElements=[],this._histogram=null,this._slider=null,this.barCreatedFunction=null,this.dataLines=null,this.dataLineCreatedFunction=null,this.excludedBarColor=new u("#d7e5f0"),this.includedBarColor=new u("#599dd4"),this.messages=null,this.standardDeviationCount=1,this.viewModel=new f}initialize(){const{average:t,bins:s,hasTimeData:d,max:e,min:h,viewModel:l}=this;this._updateBarFill=this._updateBarFill.bind(this),this._histogram=new w({average:t,bins:s,barCreatedFunction:(i,n)=>{i===0&&(this._barElements=[]),this._barElements.push(n),this._updateBarFill(i,n),this.barCreatedFunction&&this.barCreatedFunction(i,n)},dataLines:this._getDataLines(),dataLineCreatedFunction:(i,n)=>{this.dataLineCreatedFunction&&this.dataLineCreatedFunction(i,n)},labelFormatFunction:this.labelFormatFunction,layout:"horizontal",max:e,min:h}),this._slider=new B({labelFormatFunction:this.labelFormatFunction,layout:"horizontal",visibleElements:{labels:!0,rangeLabels:!0},rangeLabelInputsEnabled:!d,viewModel:l}),this.addHandles([this._slider.on("max-change",i=>this.emit("max-change",i)),this._slider.on("min-change",i=>this.emit("min-change",i)),this._slider.on("segment-drag",i=>{this._updateBarFills(),this.emit("segment-drag",i)}),this._slider.on("thumb-change",i=>{this._updateBarFills(),this.emit("thumb-change",i)}),this._slider.on("thumb-drag",i=>{this._updateBarFills(),this.emit("thumb-drag",i)}),p(()=>this.bins,i=>{if(i&&this._histogram.bins){const n=this._histogram.bins.length-i.length;this._barElements.splice(-n,n)}else this._barElements=[];this._histogram.set({bins:i}),this._updateBarFills(),this.scheduleRender()}),p(()=>[this.max,this.min,this.rangeType,this.values],([i,n])=>{this._histogram.set({max:i,min:n}),this._updateBarFills(),this.scheduleRender()}),p(()=>[this.average,this.dataLines,this.standardDeviation,this.standardDeviationCount],([i])=>{this._histogram.set({average:i,dataLines:this._getDataLines()})}),p(()=>this.labelFormatFunction,i=>{this._histogram.set({labelFormatFunction:i})}),p(()=>this.hasTimeData,i=>{this._slider.set({rangeLabelInputsEnabled:!i})})])}get average(){return this.viewModel.average}set average(t){this.viewModel.average=t}get bins(){return this.viewModel.bins}set bins(t){this.viewModel.bins=t}get hasTimeData(){return this.viewModel.hasTimeData}set hasTimeData(t){this.viewModel.hasTimeData=t}get icon(){return"arrow-double-horizontal"}set icon(t){this._overrideIfSome("icon",t)}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}get labelFormatFunction(){return this.viewModel.labelFormatFunction}set labelFormatFunction(t){this.viewModel.labelFormatFunction=t}get max(){return this.viewModel.max}set max(t){this.viewModel.max=t}get min(){return this.viewModel.min}set min(t){this.viewModel.min=t}get precision(){return this.viewModel.precision}set precision(t){this.viewModel.precision=t}get rangeType(){return this.viewModel.rangeType}set rangeType(t){this.viewModel.rangeType=t}get standardDeviation(){return this.viewModel.standardDeviation}set standardDeviation(t){this.viewModel.standardDeviation=t}get values(){return this.viewModel.values}set values(t){this.viewModel.values=t}generateWhereClause(t){return this.viewModel.generateWhereClause(t)}render(){const{rangeType:t,viewModel:s,label:d}=this,e=this.classes(c.base,F.widget,`${c.rangeTypePrefix}${t}`,s.state==="disabled"?F.disabled:null);return v("div",{"aria-label":d,class:e},s.state==="disabled"?null:this._renderContent())}_renderContent(){return[this._renderHistogram(),this._renderSlider()]}_renderSlider(){return v("div",{class:c.sliderContainer,key:`${this.id}-slider-container`},this._slider.render())}_renderHistogram(){return v("div",{class:c.histogramContainer},this._histogram.render())}_getDataLines(){return[...this._getStandardDeviationDataLines(),...this.dataLines||[]]}_getStandardDeviationDataLines(){const{average:t,standardDeviation:s,standardDeviationCount:d}=this;return T(s,t,d).map(e=>({value:e}))}_updateBarFills(){this._barElements.forEach((t,s)=>this._updateBarFill(s,t))}_updateBarFill(t,s){var d;s.setAttribute("fill",((d=this._getFillForBar(t))==null?void 0:d.toHex())??"")}_getFillForBar(t){const{bins:s,rangeType:d,values:e}=this;if(t===-1||!(s!=null&&s.length)||!d||!(e!=null&&e.length))return null;const h=s[t];if(!h)return null;const{maxValue:l,minValue:i}=h,n=l-i,b=e[0]>i&&e[0]<l;switch(d){case"equal":case"not-equal":return this.includedBarColor;case"less-than":case"at-most":return b?this._getBlendedColor((e[0]-i)/n):l<=e[0]?this.includedBarColor:this.excludedBarColor;case"greater-than":case"at-least":return b?this._getBlendedColor(1-(e[0]-i)/n):i>=e[0]?this.includedBarColor:this.excludedBarColor;case"between":if(e.length===2)return e[0]>i&&e[0]<l?this._getBlendedColor(1-(e[0]-i)/n):e[1]>i&&e[1]<l?this._getBlendedColor((e[1]-i)/n):i>=e[0]&&l<=e[1]?this.includedBarColor:this.excludedBarColor;break;case"not-between":if(e.length===2)return e[0]>i&&e[0]<l?this._getBlendedColor((e[0]-i)/n):e[1]>i&&e[1]<l?this._getBlendedColor(1-(e[1]-i)/n):i>e[0]&&l<e[1]?this.excludedBarColor:this.includedBarColor}return this.includedBarColor}_getBlendedColor(t){return u.blendColors(this.excludedBarColor,this.includedBarColor,t)}};r([a()],o.prototype,"average",null),r([a()],o.prototype,"barCreatedFunction",void 0),r([a()],o.prototype,"bins",null),r([a()],o.prototype,"dataLines",void 0),r([a()],o.prototype,"dataLineCreatedFunction",void 0),r([a({type:u,json:{type:[_],write:!0}})],o.prototype,"excludedBarColor",void 0),r([a()],o.prototype,"hasTimeData",null),r([a({type:u,json:{type:[_],write:!0}})],o.prototype,"includedBarColor",void 0),r([a()],o.prototype,"icon",null),r([a()],o.prototype,"label",null),r([a()],o.prototype,"labelFormatFunction",null),r([a()],o.prototype,"max",null),r([a(),D("esri/widgets/HistogramRangeSlider/t9n/HistogramRangeSlider")],o.prototype,"messages",void 0),r([a()],o.prototype,"min",null),r([a()],o.prototype,"precision",null),r([a()],o.prototype,"rangeType",null),r([a()],o.prototype,"standardDeviation",null),r([a()],o.prototype,"standardDeviationCount",void 0),r([a()],o.prototype,"values",null),r([a()],o.prototype,"viewModel",void 0),o=r([y("esri.widgets.HistogramRangeSlider")],o);const te=o;export{te as default};
