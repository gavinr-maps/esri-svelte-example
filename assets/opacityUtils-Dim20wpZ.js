const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./WhereClauseCache-CJbuf62r.js","./LRUCache-CXiGQWMN.js","./MemCache-CmojB_Z1.js","./Accessor-BmwT4B0c.js","./WhereClause-xGR0ztic.js","./TimeOnly-CveCl9ie.js","./Promise-DfET-uns.js","./cast-CsZslgGN.js","./index-4eY77cms.js","./index-Cx51aysm.css","./JSONSupport-DcrLLGjL.js","./Extent-g5W9hy0j.js","./Point-Cz2JYYmX.js","./writer-DKgfqj4X.js","./mathUtils-Cfq9PL9W.js","./arcadeUtils-BqmSxPR5.js","./arcade-BXELiP5l.js","./executionError-DNkSe-Q-.js","./deepClone-DD9qKKD3.js","./ImmutableArray-BPVd6ESQ.js","./shared-2m9g3-y2.js","./Field-BDG0QV_T.js","./enumeration-DpvDkLNI.js","./fieldType-CBeoJWlv.js","./number-QOqKffTG.js","./Polyline-s-JzsQqo.js","./jsonUtils-CwFG8yN4.js","./featureConversionUtils-CvnFcmH_.js","./aaBoundingBox-Dw3yBk2f.js","./OptimizedFeature-P2towpqD.js","./memoryEstimations-Bcyf-mHz.js","./OptimizedGeometry-BJqUA4Pi.js","./OptimizedFeatureSet-Blu9Ckm7.js","./FieldsIndex-FW1AMU67.js","./timeZoneUtils-DxzjpEBb.js","./unitConversion-DvIVg62C.js","./hash-CcEbRgUF.js","./uuid-Cl5lrJ4c.js","./Portal-CmmHxpLg.js"])))=>i.map(i=>d[i]);
import{P as xe,bp as K,d as De,B as Ne,s as ee,R as Oe,_ as Ee,n as Me}from"./Accessor-BmwT4B0c.js";import{_ as te}from"./index-4eY77cms.js";import{D as c,Z as ne,I as re,b as Le}from"./Promise-DfET-uns.js";import{g as X}from"./Point-Cz2JYYmX.js";let L;async function Ve(){return L==null&&(L=te(()=>import("./WhereClauseCache-CJbuf62r.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]),import.meta.url).then(e=>new e.WhereClauseCache(500,500))),L}async function Ue(e,t){const n=await Ve(),r=n.get(e,t);if(r==null)throw n.getError(e,t);return r}function Lt(e,t){return e||(e=null),t||(t=null),e==="1=1"?t??e:t==="1=1"?e??t:e&&t?`(${e}) AND (${t})`:e??t}function Vt(e,t){return e||(e=null),t||(t=null),e==="1=1"||t==="1=1"||e===t?e==="1=1"?e:t:e&&t?`(${e}) OR (${t})`:e??t}function Ut(e,t){return t.length===0?null:`${e} IN (${ke(t)})`}function ke(e){return e.map(t=>typeof t=="string"?Ze(t):t).join(",")}function Ze(e){return`'${e.replaceAll("'","''")}'`}function kt(e){return typeof e=="number"}function Zt(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e}function Rt(e){return typeof e=="boolean"}function _(e){return typeof e=="string"||e instanceof String}function Re(e){return e==null||_(e)}function Ct(e){return Array.isArray(e)}function zt(e){return(e==null?void 0:e.declaredClass)==="esri.Graphic"}function Pt(e){return(e==null?void 0:e.declaredClass)==="esri.rest.support.Query"}function Gt(e){return e instanceof Date}const Ce="HH:mm",ie="HH:mm:ss",se="HH:mm:ss.SSS",Jt={HMS_MS:se},ze=[se,ie,Ce,"TT"],Pe="yyyy-MM-dd",jt=ie;function Q(e){if(!e||!_(e))return null;const t=c.fromFormat(e,Pe);return t.isValid?t:null}function W(e){return e&&_(e)?xe(ze,t=>{const n=c.fromFormat(e,t);return n.isValid?n:null})??null:null}function B(e){if(!e||!_(e))return null;const t=c.fromISO(e);return t.isValid?t:null}var T;(function(e){e.VALUE_OUT_OF_RANGE="domain-validation-error::value-out-of-range",e.INVALID_CODED_VALUE="domain-validation-error::invalid-coded-value"})(T||(T={}));const ae=new Set(["integer","small-integer","big-integer","esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeBigInteger"]);function Ge(e){return e!=null&&ae.has(e.type)}function oe(e){return e!=null&&(e.type==="date-only"||e.type==="esriFieldTypeDateOnly")}function le(e){return e!=null&&(e.type==="timestamp-offset"||e.type==="esriFieldTypeTimestampOffset")}function ue(e){return e!=null&&(e.type==="time-only"||e.type==="esriFieldTypeTimeOnly")}const Je=new Set(["single","double","esriFieldTypeSingle","esriFieldTypeDouble"]);K(ae,Je);function qt(e,t,n){const r=n??(e==null?void 0:e.domain);if(!r)return null;switch(r.type){case"range":{const{min:i,max:s}=ce(e,r);if(i!=null&&+t<i||s!=null&&+t>s)return T.VALUE_OUT_OF_RANGE;break}case"coded-value":case"codedValue":if(r.codedValues==null||r.codedValues.every(i=>i==null||i.code!==t))return T.INVALID_CODED_VALUE}return null}function ce(e,t){const n=t??(e==null?void 0:e.domain);if(!n||n.type!=="range")return;const r="range"in n?n.range[0]:n.minValue,i="range"in n?n.range[1]:n.maxValue,s=Ge(e);return oe(e)||ue(e)||le(e)?{...je(e,i,r),isInteger:s}:{min:r!=null&&typeof r=="number"?r:null,max:i!=null&&typeof i=="number"?i:null,rawMin:r,rawMax:i,isInteger:s}}function je(e,t,n){var r,i,s,o,a,d;return oe(e)?{min:(r=Q(n))==null?void 0:r.toMillis(),max:(i=Q(t))==null?void 0:i.toMillis(),rawMin:n,rawMax:t}:ue(e)?{min:(s=W(n))==null?void 0:s.toMillis(),max:(o=W(t))==null?void 0:o.toMillis(),rawMin:n,rawMax:t}:le(e)?{min:(a=B(n))==null?void 0:a.toMillis(),max:(d=B(t))==null?void 0:d.toMillis(),rawMin:n,rawMax:t}:{max:null,min:null}}function qe(e){if(!e)return;const t=e.match(He);return t!=null&&t.groups?t.groups.doubleQuoted??t.groups.singleQuoted??t.groups.dotNotation:void 0}const He=/^(\$feature\[(?:"(?<doubleQuoted>[^"]+)"|'(?<singleQuoted>[^']+)')\]|\$feature\.(?<dotNotation>[a-zA-Z_][a-zA-Z0-9_]*))$/i;function Ht(e){var t,n;return((n=(t=e.match(Xe))==null?void 0:t[1])==null?void 0:n.replace(/\\'/g,"'"))??null}const Xe=/^hash\(\$feature\['((\\'|[^'])+)'\]\) \* 8\.381e-8$/;let f=class{};function Qe(e){return e instanceof ne?e===f.instance:(e==null?void 0:e.toString().toLowerCase())==="unknown"}function Qt(e){return Qe(e)?f.instance:e}f.instance=new re("Etc/UTC");var A;(function(e){e.TimeZoneNotRecognized="TimeZoneNotRecognized"})(A||(A={}));const We={[A.TimeZoneNotRecognized]:"Timezone identifier has not been recognized."};let Be=class de extends Error{constructor(t,n){super(De(We[t],n)),this.declaredRootClass="esri.arcade.arcadedate.dateerror",Error.captureStackTrace&&Error.captureStackTrace(this,de)}};function g(e,t,n){return e<t?e-t:e>n?e-n:0}function w(e,t,n){return e<t?t:e>n?n:e}let S=class l{constructor(t){this._date=t,this.declaredRootClass="esri.arcade.arcadedate"}static fromParts(t=0,n=1,r=1,i=0,s=0,o=0,a=0,d){if(isNaN(t)||isNaN(n)||isNaN(r)||isNaN(i)||isNaN(s)||isNaN(o)||isNaN(a))return null;const m=c.local(t,n).daysInMonth;let p=c.fromObject({day:w(r,1,m),year:t,month:w(n,1,12),hour:w(i,0,23),minute:w(s,0,59),second:w(o,0,59),millisecond:w(a,0,999)},{zone:h(d)});return p=p.plus({months:g(n,1,12),days:g(r,1,m),hours:g(i,0,23),minutes:g(s,0,59),seconds:g(o,0,59),milliseconds:g(a,0,999)}),new l(p)}static get systemTimeZoneCanonicalName(){return Intl.DateTimeFormat().resolvedOptions().timeZone??"system"}static arcadeDateAndZoneToArcadeDate(t,n){const r=h(n);return t.isUnknownTimeZone||r===f.instance?l.fromParts(t.year,t.monthJS+1,t.day,t.hour,t.minute,t.second,t.millisecond,r):new l(t._date.setZone(r))}static dateJSToArcadeDate(t){return new l(c.fromJSDate(t,{zone:"system"}))}static dateJSAndZoneToArcadeDate(t,n="system"){const r=h(n);return new l(c.fromJSDate(t,{zone:r}))}static unknownEpochToArcadeDate(t){return new l(c.fromMillis(t,{zone:f.instance}))}static unknownDateJSToArcadeDate(t){return new l(c.fromMillis(t.getTime(),{zone:f.instance}))}static epochToArcadeDate(t,n="system"){const r=h(n);return new l(c.fromMillis(t,{zone:r}))}static dateTimeToArcadeDate(t){return new l(t)}clone(){return new l(this._date)}changeTimeZone(t){const n=h(t);return l.dateTimeToArcadeDate(this._date.setZone(n))}static dateTimeAndZoneToArcadeDate(t,n){const r=h(n);return t.zone===f.instance||r===f.instance?l.fromParts(t.year,t.month,t.day,t.hour,t.minute,t.second,t.millisecond,r):new l(t.setZone(r))}static nowToArcadeDate(t){const n=h(t);return new l(c.fromJSDate(new Date,{zone:n}))}static nowUTCToArcadeDate(){return new l(c.utc())}get isSystem(){return this.timeZone==="system"||this.timeZone===l.systemTimeZoneCanonicalName}equals(t){return this.isSystem&&t.isSystem?this.toNumber()===t.toNumber():this.isUnknownTimeZone===t.isUnknownTimeZone&&this._date.equals(t._date)}get isUnknownTimeZone(){return this._date.zone===f.instance}get isValid(){return this._date.isValid}get hour(){return this._date.hour}get second(){return this._date.second}get day(){return this._date.day}get dayOfWeekISO(){return this._date.weekday}get dayOfWeekJS(){let t=this._date.weekday;return t>6&&(t=0),t}get millisecond(){return this._date.millisecond}get monthISO(){return this._date.month}get weekISO(){return this._date.weekNumber}get yearISO(){return this._date.weekYear}get monthJS(){return this._date.month-1}get year(){return this._date.year}get minute(){return this._date.minute}get zone(){return this._date.zone}get timeZoneOffset(){return this.isUnknownTimeZone?0:this._date.offset}get timeZone(){if(this.isUnknownTimeZone)return"unknown";if(this._date.zone.type==="system")return"system";const t=this.zone;return t.type==="fixed"?t.fixed===0?"UTC":t.formatOffset(0,"short"):t.name}stringify(){return JSON.stringify(this.toJSDate())}plus(t){return new l(this._date.plus(t))}diff(t,n="milliseconds"){return this._date.diff(t._date,n)[n]}toISODate(){return this._date.toISODate()}toISOString(t){return t?this._date.toISO({suppressMilliseconds:!0,includeOffset:!this.isUnknownTimeZone}):this._date.toISO({includeOffset:!this.isUnknownTimeZone})}toISOTime(t,n){return this._date.toISOTime({suppressMilliseconds:t,includeOffset:n&&!this.isUnknownTimeZone})}toFormat(t,n){return this.isUnknownTimeZone&&(t=t.replaceAll("Z","")),this._date.toFormat(t,n)}toJSDate(){return this._date.toJSDate()}toSQLValue(){return this._date.toFormat("yyyy-LL-dd HH:mm:ss")}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}toDateTime(){return this._date}toNumber(){return this._date.toMillis()}getTime(){return this._date.toMillis()}toUTC(){return new l(this._date.toUTC())}toLocal(){return new l(this._date.toLocal())}toString(){return this.toISOString(!0)}static fromReaderAsTimeStampOffset(t){if(!t)return null;const n=c.fromISO(t,{setZone:!0});return new l(n)}};function h(e,t=!0){if(e instanceof ne)return e;if(e.toLowerCase()==="system")return"system";if(e.toLowerCase()==="utc")return"UTC";if(e.toLowerCase()==="unknown")return f.instance;if(/^[+-]?[0-9]{1,2}([:][0-9]{2})?$/.test(e)){const r=Le.parseSpecifier("UTC"+(e.startsWith("+")||e.startsWith("-")?"":"+")+e);if(r)return r}const n=re.create(e);if(!n.isValid){if(t)throw new Be(A.TimeZoneNotRecognized);return null}return n}const Ye=()=>Ne.getLogger("esri.support.arcadeOnDemand"),Ke=["geometry","scale","timeProperties"];function Wt(e,t){if(t!=null)for(const n of Ke)t.hasArcadeDependency(n)&&e.add(n);return e}let V;function fe(){return V||(V=(async()=>{const e=await te(()=>import("./arcadeUtils-BqmSxPR5.js"),__vite__mapDeps([15,16,8,9,17,3,18,7,10,19,12,13,20,5,6,11,21,22,23,24,25,14,26,27,28,29,30,31,32,33,34,4,35,36,37,38]),import.meta.url);return{arcade:e.arcade,arcadeUtils:e,Dictionary:e.Dictionary,Feature:e.arcadeFeature,Voxel:e.Voxel}})()),V}const Bt=(e,t,n)=>Z.create(e,t,n,null,["$feature","$view"],[]),Yt=(e,t,n)=>Z.create(e,t,n,null,["$feature","$view"],[]),Kt=(e,t,n,r)=>Z.create(e,t,n,r,["$feature","$view"],[]);let Z=class me{constructor(t,n,r,i,s,o,a){this._dependencies=new Map,this.services=null,this.script=t,this.evaluate=i;const d=Array.isArray(o)?o:o==null?void 0:o.fields;this.fields=d??[],this._syntaxTree=r,this._arcade=n,this._arcadeFeature=s,this._spatialReference=a,this._dependencies.set("geometry",n.scriptTouchesGeometry(this._syntaxTree)),this._dependencies.set("scale",this._arcade.referencesMember(this._syntaxTree,"scale")),this._dependencies.set("timeProperties",this._arcade.scriptUsesViewProperties(this._syntaxTree,["timeProperties"]))}static async create(t,n,r,i,s,o){const{arcade:a,Feature:d,Dictionary:m}=await fe(),p=n instanceof X?n:X.fromJSON(n);let y;try{y=a.parseScript(t,o)}catch(u){return Ye().error(new ee("arcade-bad-expression","Failed to parse arcade script",{script:t,error:u})),null}const P=s.reduce((u,O)=>({...u,[O]:null}),{});let b=null;i!=null&&(b=new m(i),b.immutable=!0,P.$config=null);const G=a.scriptUsesGeometryEngine(y),Ie=G&&a.enableGeometrySupport(),_e=a.scriptUsesFeatureSet(y)&&a.enableFeatureSetSupport(),J=a.scriptIsAsync(y),j=J&&a.enableAsyncSupport(),be={vars:P,spatialReference:p,useAsync:!!j};await Promise.all([Ie,_e,j]);const Se=new Set;await a.loadDependentModules(Se,y,null,J,G);const $=new m;$.immutable=!1,$.setField("scale",0);const Ae=a.compileScript(y,be),ve=(u,O)=>{var q;const F=(q=u.$view)==null?void 0:q.timeZone;if("$view"in u&&u.$view){let H;if($.setField("scale",typeof u.$view=="object"&&"scale"in u.$view?u.$view.scale:void 0),typeof u.$view=="object"&&"timeProperties"in u.$view&&u.$view.timeProperties!=null){const{currentStart:E,currentEnd:M}=u.$view.timeProperties;H=new m({currentStart:E!=null?F!=null?S.epochToArcadeDate(E,F):S.unknownEpochToArcadeDate(E):void 0,currentEnd:M!=null?F!=null?S.epochToArcadeDate(M,F):S.unknownEpochToArcadeDate(M):void 0,startIncluded:!0,endIncluded:!0})}$.setField("timeProperties",H),u.$view=$}return b&&(u.$config=b),Ae({vars:u,spatialReference:p,services:O,timeZone:F})};return new me(t,a,y,ve,new d,r,p)}repurposeFeature(t){return t.geometry&&!t.geometry.spatialReference&&(t.geometry.spatialReference=this._spatialReference),this._arcadeFeature.repurposeFromGraphicLikeObject(t.geometry,t.attributes,{fields:this.fields}),this._arcadeFeature}references(t){return this._dependencies.get(t)??!1}};const et=/^([0-9_])/,tt=/[^a-z0-9_\u0080-\uffff]+/gi;function en(e){return e==null?null:e.trim().replaceAll(tt,"_").replace(et,"F$1")||null}const nt=["field","field2","field3","normalizationField","rotationInfo.field","proportionalSymbolInfo.field","proportionalSymbolInfo.normalizationField","colorInfo.field","colorInfo.normalizationField"],rt=["field","normalizationField"];function tn(e,t){if(e!=null&&t!=null){for(const n of Array.isArray(e)?e:[e])if(Y(nt,n,t),"visualVariables"in n&&n.visualVariables)for(const r of n.visualVariables)Y(rt,r,t)}}function Y(e,t,n){if(e)for(const r of e){const i=Oe(r,t),s=i&&typeof i!="function"&&n.get(i);s&&Ee(r,s.name,t)}}function nn(e,t){var n;if(e!=null&&((n=t==null?void 0:t.fields)!=null&&n.length))if("startField"in e){const r=t.get(e.startField),i=t.get(e.endField);e.startField=(r==null?void 0:r.name)??null,e.endField=(i==null?void 0:i.name)??null}else{const r=t.get(e.startTimeField),i=t.get(e.endTimeField);e.startTimeField=(r==null?void 0:r.name)??null,e.endTimeField=(i==null?void 0:i.name)??null}}const U=new Set;function R(e,t){return e&&t?(U.clear(),v(U,e,t),Array.from(U).sort()):[]}function v(e,t,n){var r;if(n)if((r=t==null?void 0:t.fields)!=null&&r.length)if(n.includes("*"))for(const{name:i}of t.fields)e.add(i);else for(const i of n)N(e,t,i);else{if(n.includes("*"))return e.clear(),void e.add("*");for(const i of n)i!=null&&e.add(i)}}function N(e,t,n){if(typeof n=="string")if(t){const r=t.get(n);r&&e.add(r.name)}else e.add(n)}function rn(e,t){return t==null||e==null?[]:t.includes("*")?(e.fields??[]).map(n=>n.name):t}function sn(e,t,n=1){if(!t||!e)return[];if(t.includes("*"))return["*"];const r=R(e,t);return r.length/e.fields.length>=n?["*"]:r}async function I(e,t,n){var s;if(!n)return;let r;const i=qe(n);if(i)r=[i];else{const{arcadeUtils:o}=await fe();r=o.extractFieldNames(n,(s=t==null?void 0:t.fields)==null?void 0:s.map(a=>a.name))}for(const o of r)N(e,t,o)}async function C(e,t,n){if(n&&n!=="1=1"){const r=await Ue(n,t);if(!r.isStandardized)throw new ee("fieldUtils:collectFilterFields","Where clause is not standardized",{where:n});v(e,t,r.fieldNames)}}function an({displayField:e,fields:t}){return e||(t!=null&&t.length?k(t,"name-or-title")||k(t,"unique-identifier")||k(t,"type-or-category")||it(t):null)}function it(e){for(const t of e){if(!(t!=null&&t.name))continue;const n=t.name.toLowerCase();if(n.includes("name")||n.includes("title"))return t.name}return null}function k(e,t){for(const n of e)if(n!=null&&n.valueType&&n.valueType===t)return n.name;return null}async function on(e,t){var r;if(!t)return;const n=(r=t.elevationInfo)==null?void 0:r.featureExpressionInfo;return n?n.collectRequiredFields(e,t.fieldsIndex):void 0}function st(e,t,n){n.onStatisticExpression?I(e,t,n.onStatisticExpression.expression):e.add(n.onStatisticField)}async function ln(e,t,n){if(!t||!n||!("fields"in n))return;const r=[],i=n.popupTemplate;r.push(pe(e,t,i)),n.fields&&r.push(...n.fields.map(async s=>st(e,t.fieldsIndex,s))),await Promise.all(r)}async function un(e,t){var s,o,a;const{fieldsIndex:n,trackInfo:r}=t;if(!t||!r||!n)return;const i=[(s=r.latestObservations.renderer)==null?void 0:s.collectRequiredFields(e,n),(o=r.previousObservations.renderer)==null?void 0:o.collectRequiredFields(e,n),(a=r.trackLines.renderer)==null?void 0:a.collectRequiredFields(e,n)];r.popupTemplate&&i.push(pe(e,t,r.popupTemplate));for(const d of[r.latestObservations.labelingInfo,r.previousObservations.labelingInfo,r.trackLines.labelingInfo])if(d)for(const m of d)i.push(ge(e,n,m));await Promise.all(i)}async function pe(e,t,n){const r=[];n!=null&&n.expressionInfos&&r.push(...n.expressionInfos.map(s=>I(e,t.fieldsIndex,s.expression)));const i=n==null?void 0:n.content;if(Array.isArray(i))for(const s of i)s.type==="expression"&&s.expressionInfo&&r.push(I(e,t.fieldsIndex,s.expressionInfo.expression));await Promise.all(r)}async function cn(e,t,n){t&&(t.timeInfo&&(n!=null&&n.timeExtent)&&v(e,t.fieldsIndex,[t.timeInfo.startField,t.timeInfo.endField]),t.floorInfo&&v(e,t.fieldsIndex,[t.floorInfo.floorField]),(n==null?void 0:n.where)!=null&&await C(e,t.fieldsIndex,n.where))}async function dn(e,t,n){t&&n&&await Promise.all(n.map(r=>at(e,t,r)))}async function at(e,t,n){t&&n&&(n.valueExpression?await I(e,t.fieldsIndex,n.valueExpression):n.field&&N(e,t.fieldsIndex,n.field))}function fn(e){return e?R(e.fieldsIndex,ye(e)):[]}function ot(e){if(!e)return[];const t=e.geometryFieldsInfo;return t?R(e.fieldsIndex,[t.shapeAreaField,t.shapeLengthField]):[]}async function mn(e,t,n){if(!t||!n)return;const r=t.fieldsIndex;await Promise.all(n.filters.map(i=>C(e,r,i.where)))}const lt=new Set(["oid","global-id","guid"]),ut=new Set(["oid","global-id"]),ct=[/^fnode_$/i,/^tnode_$/i,/^lpoly_$/i,/^rpoly_$/i,/^poly_$/i,/^shape$/i,/^shape_$/i,/^subclass$/i,/^subclass_$/i,/^rings_ok$/i,/^rings_nok$/i,/perimeter/i,/objectid/i,/_i$/i];function dt(e){const t=new Set;he(e).forEach(r=>t.add(r)),ot(e).forEach(r=>t.add(r.toLowerCase()));const n=e&&"infoFor3D"in e?e.infoFor3D:void 0;return n&&(Object.values(n.assetMapFieldRoles).forEach(r=>t.add(r.toLowerCase())),Object.values(n.transformFieldRoles).forEach(r=>t.add(r.toLowerCase()))),Array.from(t)}function ye(e){if(!e)return[];const t="editFieldsInfo"in e&&e.editFieldsInfo;if(!t)return[];const{creationDateField:n,creatorField:r,editDateField:i,editorField:s}=t;return[n,r,i,s].filter(Boolean)}function he(e){return ye(e).map(t=>t.toLowerCase())}function pn(e,t){var n;return e.editable&&!lt.has(e.type)&&!he(t).includes(((n=e.name)==null?void 0:n.toLowerCase())??"")}function yn(e,t){var r;const n=((r=e.name)==null?void 0:r.toLowerCase())??"";return!((t==null?void 0:t.objectIdField)!=null&&n===t.objectIdField.toLowerCase()||(t==null?void 0:t.globalIdField)!=null&&n===t.globalIdField.toLowerCase()||dt(t).includes(n)||ut.has(e.type)||ct.some(i=>i.test(n)))}async function hn(e,t){const{labelingInfo:n,fieldsIndex:r}=t;n!=null&&n.length&&await Promise.all(n.map(i=>ge(e,r,i)))}async function ge(e,t,n){if(!n)return;const r=n.getLabelExpression(),i=n.where;if(r.type==="arcade")await I(e,t,r.expression);else{const s=r.expression.match(/{[^}]*}/g);s&&s.forEach(o=>{N(e,t,o.slice(1,-1))})}await C(e,t,i)}function gn(e){const t=e.defaultValue;return t!==void 0&&Te(e,t)?t:e.nullable?null:void 0}function wn(e){const t=typeof e=="string"?{type:e}:e;return Ft(t)?255:t.type==="esriFieldTypeDate"||t.type==="date"?8:void 0}function we(e){return typeof e=="number"&&!isNaN(e)&&isFinite(e)}function ft(e){return e===null||we(e)}function mt(e){return e===null||Number.isInteger(e)}function pt(){return!0}function Te(e,t){let n;switch(e.type){case"date":case"integer":case"long":case"small-integer":case"big-integer":case"esriFieldTypeDate":case"esriFieldTypeInteger":case"esriFieldTypeLong":case"esriFieldTypeSmallInteger":case"esriFieldTypeBigInteger":n=e.nullable?mt:Number.isInteger;break;case"double":case"single":case"esriFieldTypeSingle":case"esriFieldTypeDouble":n=e.nullable?ft:we;break;case"string":case"esriFieldTypeString":n=e.nullable?Re:_;break;default:n=pt}return arguments.length===1?n:n(t)}const yt=["integer","small-integer","big-integer"],ht=["single","double"],gt=["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeBigInteger"],wt=["esriFieldTypeSingle","esriFieldTypeDouble"],$e=new Set([...yt,...gt]),Tt=new Set([...ht,...wt]),$t=K($e,Tt);function Tn(e){return e!=null&&$e.has(e.type)}function Fe(e){return e!=null&&$t.has(e.type)}function Ft(e){return e!=null&&(e.type==="string"||e.type==="esriFieldTypeString")}function $n(e){return e!=null&&(e.type==="date"||e.type==="esriFieldTypeDate")}function Fn(e){return e!=null&&(e.type==="date-only"||e.type==="esriFieldTypeDateOnly")}function In(e){return e!=null&&(e.type==="timestamp-offset"||e.type==="esriFieldTypeTimestampOffset")}function _n(e){return e!=null&&(e.type==="time-only"||e.type==="esriFieldTypeTimeOnly")}function bn(e){return e!=null&&(e.type==="oid"||e.type==="esriFieldTypeOID")}function Sn(e){return e!=null&&(e.type==="global-id"||e.type==="esriFieldTypeGlobalID")}function An(e,t){return It(e,t)===null}var x,D;function vn(e){return e==null||typeof e=="number"&&isNaN(e)?null:e}function It(e,t){return e==null||e.nullable&&t===null?null:Te(e,t)?Fe(e)&&!_t(e.type,Number(t))?x.OUT_OF_RANGE:null:D.INVALID_TYPE}function _t(e,t){const n=typeof e=="string"?z(e):e;if(!n)return!1;const r=n.min,i=n.max;return n.isInteger?Number.isInteger(t)&&t>=r&&t<=i:t>=r&&t<=i}function xn(e,t){return ce(e,t)||(Fe(e)?z(e.type):void 0)}function z(e){switch(e){case"esriFieldTypeSmallInteger":case"small-integer":return bt;case"esriFieldTypeInteger":case"integer":return St;case"esriFieldTypeBigInteger":case"big-integer":return At;case"esriFieldTypeSingle":case"single":return vt;case"esriFieldTypeDouble":case"double":return xt}}(function(e){e.OUT_OF_RANGE="numeric-range-validation-error::out-of-range"})(x||(x={})),function(e){e.INVALID_TYPE="type-validation-error::invalid-type"}(D||(D={}));const bt={min:-32768,max:32767,isInteger:!0,rawMin:-32768,rawMax:32767},St={min:-2147483648,max:2147483647,isInteger:!0,rawMin:-2147483648,rawMax:2147483647},At={min:-Number.MAX_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER,isInteger:!0,rawMin:-Number.MAX_SAFE_INTEGER,rawMax:Number.MAX_SAFE_INTEGER},vt={min:-34e37,max:12e37,isInteger:!1,rawMin:-34e37,rawMax:12e37},xt={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1,rawMin:-Number.MAX_VALUE,rawMax:Number.MAX_VALUE};function Dn(e,t,n){switch(e){case T.INVALID_CODED_VALUE:return`Value ${n} is not in the coded domain - field: ${t.name}, domain: ${JSON.stringify(t.domain)}`;case T.VALUE_OUT_OF_RANGE:return`Value ${n} is out of the range of valid values - field: ${t.name}, domain: ${JSON.stringify(t.domain)}`;case D.INVALID_TYPE:return`Value ${n} is not a valid value for the field type - field: ${t.name}, type: ${t.type}, nullable: ${t.nullable}`;case x.OUT_OF_RANGE:{const{min:r,max:i}=z(t.type);return`Value ${n} is out of range for the number type - field: ${t.name}, type: ${t.type}, value range is ${r} to ${i}`}}}function Nn(e,t){return!Dt(e,t,null)}function Dt(e,t,n){if(!(t!=null&&t.attributes)||!e){if(n!=null)for(const s of e??[])n.add(s);return!0}const r=new Set(Object.keys(t.attributes));let i=!1;for(const s of e)if(!r.has(s)){if(i=!0,n==null)break;n.add(s)}return i}function On(e){return!!e&&["raster.itempixelvalue","raster.servicepixelvalue"].some(t=>e.toLowerCase().startsWith(t))}async function En(e,t){const n=new Set;return e!=null&&e.collectRequiredFields&&await e.collectRequiredFields(n,t),Array.from(n).sort()}function Mn(e){const t=e==null?void 0:e.match(/{[^}]+}/g);return t?t.map(n=>n.slice(1,-1).split(":")[0].trim()):[]}function Ln(e){const t=Me(100*(1-e));return Math.max(0,Math.min(t,100))}function Vn(e){const t=1-e/100;return Math.max(0,Math.min(t,1))}export{tn as $,Lt as A,ce as B,fn as C,qe as D,An as E,Ft as F,Bt as G,yn as H,$n as I,vn as J,wn as K,Yt as L,zt as M,rn as N,Dt as O,On as P,Rt as Q,Ct as R,It as S,bn as T,Dn as U,Zt as V,pn as W,Mn as X,Gt as Y,N as Z,I as _,R as a,hn as a0,on as a1,cn as a2,ln as a3,dn as a4,v as a5,un as a6,mn as a7,qt as a8,x as a9,T as aa,D as ab,h as ac,Ln as ad,je as ae,he as af,xn as ag,Ht as ah,Pt as ai,Wt as aj,Kt as ak,Qt as al,Qe as am,En as an,Ut as ao,sn as ap,Re as aq,dt as ar,Fn as b,gn as c,f as d,Ue as e,nn as f,Fe as g,Sn as h,_ as i,Jt as j,Nn as k,jt as l,W as m,kt as n,fe as o,en as p,B as q,Vn as r,Pe as s,Q as t,Vt as u,an as v,In as w,_n as x,Tn as y,S as z};
