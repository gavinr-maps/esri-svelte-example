import{o as F,l as Z}from"./ResponsiveTheme-BcqB0y5F.js";import{l as N}from"./intl-Do3GEEJ7.js";import{D as q,t as D,e as J}from"./Accessor-BHnuXKD2.js";import{r as P}from"./signal-DSa0yokC.js";import{g as G,b as K}from"./unitFormatUtils-Dbksq3U5.js";import{x as R}from"./Point-XGrwlf63.js";import{e as Q}from"./common-DQOJ18NT.js";import{n as v,e as _,s as tt,T as it}from"./customElement-0urxnKUi.js";import{G as ot,D as et}from"./chartUtilsAm5-CRBRpjAt.js";import{g as nt}from"./jsxFactory-CLjKarlq.js";import{r as rt}from"./themeUtils-C3zvZbsE.js";import{n as st,g as Y,b as at,x as lt,l as pt,f as mt}from"./LineSeries-mg8Ni5g7.js";import{a3 as b,z as f,r as dt,Y as ct}from"./Theme-j0p7GXwZ.js";import{u as O}from"./Tooltip-D_Bvu-bx.js";import{s as ut}from"./substitute-D1XJWgT5.js";import"./Promise-CmQqe-ke.js";import"./cast-BA_-jlhc.js";import"./index-tefRSezt.js";import"./JSONSupport-CGdeqxpk.js";import"./SimpleObservable-7oieNGD8.js";import"./ByteSizeUnit-BsxeN7wM.js";import"./Cyclical-CPiNl4ru.js";import"./mathUtils-DV9iOXpW.js";import"./quantityUtils-1LswOhxZ.js";import"./writer-B2bQV2uU.js";import"./reactiveUtils-BR0C1Kq4.js";import"./Evented-DCWccWGU.js";import"./memoize-DsJmrG76.js";import"./Graphic-CFXUQZlS.js";import"./Clonable-DvJsj5LF.js";import"./opacityUtils-CSd4XoR2.js";import"./enumeration-Cr5WIZs4.js";import"./Color-gncXBiLc.js";import"./colorUtils-Rxh2V3ai.js";import"./ActionToggle-__-l4AdQ.js";import"./Identifiable-BrT7zvUW.js";import"./jsonUtils-Cu7OBRmN.js";import"./Extent-CBBGeHb-.js";import"./Polyline-BmuD2-ZN.js";import"./typeUtils-BSg8Y507.js";import"./TextSymbol-BQ_NW9Xo.js";import"./screenUtils-_ZIvrt5o.js";import"./collectionUtils-CbaToa73.js";import"./Portal-CTRRujjZ.js";import"./vec3f64-BLpZdpfb.js";import"./aaBoundingBox-CeBivBRq.js";import"./LRUCache-DS2O1kTf.js";import"./MemCache-CDoaVBHf.js";import"./hitTest-CblPROa1.js";import"./projectVectorToVector-dS8io47t.js";import"./projectBuffer-DOU0xvVi.js";import"./geodesicConstants-yASAK_zX.js";import"./projectPointToVector-BS0u8fq6.js";import"./projection-B2I9Bzj_.js";import"./LayerConstants-B33OP6sh.js";import"./layerUtils-dJgsXxkC.js";import"./Material-Ba8x5bbY.js";import"./VertexAttribute-Cq4MnHjR.js";import"./boundedPlane-Dyz2ub5d.js";import"./sphere-DQxj5tsv.js";import"./mat4-Fi6iAz29.js";import"./vec32-Dvg_eL9J.js";import"./vec42-YcqnINSP.js";import"./vec4f64-o2zAXfmz.js";import"./mat3-CR8GKnhD.js";import"./mat3f64-BBpwCtoL.js";import"./plane-4dpuo6-e.js";import"./mat4f64-Dk4dwAN8.js";import"./quatf64-CCm9z-pX.js";import"./vec2f64-Dy6m9Nrb.js";import"./mathUtils-B9R7G-2c.js";import"./lineSegment-C-CDF7QX.js";import"./ViewingMode-Dodu7ZZk.js";import"./NoParameters-t-PuNrgq.js";import"./ElevationProvider-aS5xrHHy.js";import"./dehydratedFeatureUtils-1rrRm6hF.js";import"./Intersector-DqUGp7Vs.js";import"./intersectorUtils-l6zkk4nF.js";import"./verticalOffsetUtils-CUH6QZ7-.js";import"./orientedBoundingBox-9z4w3ZAL.js";import"./quat-4pa1e6ds.js";import"./spatialReferenceEllipsoidUtils-DM073JUd.js";import"./computeTranslationToOriginAndRotation-BT43Xu5d.js";import"./Attribute-B-NAci_J.js";import"./intersectorUtilsConversions-CZnn6t-z.js";import"./Intersector-DPK4WnQE.js";import"./defaultUnit-CO7iAvsB.js";import"./getDefaultUnitForView-CuRQcAm0.js";import"./throttle-jjSnxk80.js";import"./elevationInfoUtils-RSZ4Logn.js";import"./unitConversionUtils-C4AR5obr.js";import"./lengthUtils-DjJgJFRg.js";import"./vec2-maR1OrZI.js";import"./geodesicUtils-Bh_GX0Qj.js";import"./ScheduledQueueProcessor-DfrR8pp0.js";import"./Queue-BOnccek2.js";import"./ReactiveMap-Dwhwbx9R.js";import"./Scheduler-B_GuBefw.js";import"./debugFlags-ZrDyTcDc.js";import"./traversalUtils-DmE6QkgJ.js";import"./uuid-Cl5lrJ4c.js";import"./groundInstanceUtils-Ben03ZCf.js";import"./ElevationQuery-ClnmdMRA.js";import"./ElevationSamplerData-ejt2NMnl.js";import"./ElevationTile-BVRMxCrp.js";import"./TileKey-DZd6gJy7.js";import"./GraphicsLayer-Acqd2VFm.js";import"./GraphicsCollection-CkliHSk1.js";import"./Layer-C9uQlTBT.js";import"./TimeExtent-J5qnUFx_.js";import"./timeUtils-D2X862bk.js";import"./ScaleRangeLayer-C59zG_yk.js";import"./layerContainerType-C5CzMsLd.js";import"./jsonUtils-TjZmCq6l.js";import"./utils-DYurMneM.js";import"./mat4f32-DcsiF_Rp.js";import"./ElevationInfo-Di4W6v5U.js";import"./InputManager-Bs9UE-jw.js";import"./SketchViewModel-BHWV3FYM.js";import"./UpdatingHandles-ptqz1ck8.js";import"./layerUtils-BS1Di3Pm.js";import"./keybindings-DrKrBFID.js";import"./SketchLabelOptions-CwtwEofC.js";import"./SketchOptions-92Ul6Fzp.js";import"./angularMeasurementUtils-lDJJxFDs.js";import"./SnappingManager-CF4NflXd.js";import"./RightAngleSnappingHint-CCcBBYgG.js";import"./Query-DCBIeen2.js";import"./Field-Cyk7Ur5d.js";import"./fieldType-L-VlbZqy.js";import"./FullTextSearch-BWm_kPUE.js";import"./utils-D02V2_jH.js";import"./Version-9k2AOv05.js";import"./geometry2dUtils-vtViF5g_.js";import"./viewUtils-Ce2x26K8.js";import"./hitTestSelectUtils-UXJPjatw.js";import"./screenUtils-DyhV4TAA.js";import"./UnitSelect-JGyYeoZR.js";import"./globalCss-CZa70j6i.js";import"./useWidget-Dlf3SkC7.js";import"./index-BkKcLxWB.js";import"./component-utils-DWY0IMHC.js";import"./DefaultTheme-CDLLrEdR.js";import"./ColorSet-BTHKRo6w.js";import"./Tick-8IC22wWy.js";import"./Button-CiizicDX.js";function ft(t,e,o=10){const i=z(e-t,!1);if(i===0)return[t,e];const n=z(i/(o-1),!0);return[Math.floor(t/n)*n,Math.ceil(e/n)*n]}function z(t,e){const o=Math.floor(Math.log10(t)),i=t/10**o;let n;return n=e?i<1.5?1:i<3?2:i<5?2.5:i<7?5:10:i<=1?1:i<=2?2:i<=3?2.5:i<=5?5:10,n*10**o}const A="#f8f8f8",W="#a9a9a9",g="#323232",xt="line",gt="fill",h=15,x=12,X=.001,ht=.1,At=.02,E={fontFamily:"Avenir Next",paddingBottom:x/2,paddingLeft:0,paddingRight:0,paddingTop:0,axisGridStroke:"#f4f4f4",axisLabelsFontSize:9,axisLabelsFontWeight:"400",axisLabelsColor:W,axisTooltipFontSize:12,axisTooltipBackgroundColor:g,axisTooltipLabelColor:A,axisTooltipPaddingTop:Math.round(x/4),axisTooltipPaddingBottom:Math.round(x/4),axisTooltipPaddingHorizontal:Math.round(h/4),xAxisMinGridDistance:50,xAxisLabelsSpacing:Math.round(x/2),xAxisMinLabelPosition:.05,xAxisMaxLabelPosition:.9,yAxisMinGridDistance:30,yAxisLabelSpacing:Math.round(h/4),yAxisMinLabelPosition:0,yAxisMaxLabelPosition:.8,seriesTooltipFontSize:12,seriesTooltipBackgroundColor:A,seriesTooltipLabelColor:g,seriesFillLighten:.9,seriesTooltipSpacing:x/2,seriesTooltipPaddingVertical:Math.round(h/4),seriesTooltipPaddingHorizontal:Math.round(h/4)},vt={...E,axisGridStroke:g,axisLabelsColor:W,axisTooltipBackgroundColor:g,axisTooltipLabelColor:A,seriesTooltipBackgroundColor:g,seriesTooltipLabelColor:A,seriesFillLighten:-.75},y={minX:void 0,maxX:void 0,minY:void 0,maxY:void 0};async function Te(t){const e=await ot(t.container);q(t.abortOptions);const o=rt(),i=o?vt:E;e.setThemes(o?[F.new(e),Z.new(e)]:[F.new(e)]);const n=nt(t.container),r=e.container.children.push(st.new(e,{panX:!0,panY:!0,paddingTop:i.paddingTop,paddingBottom:i.paddingBottom,paddingLeft:n?i.paddingRight:i.paddingLeft,paddingRight:n?i.paddingLeft:i.paddingRight,maxTooltipDistance:-1}));r.zoomOutButton.set("forceHidden",!0);const s=r.xAxes.push(Y.new(e,{renderer:at.new(e,{})})),a=r.yAxes.push(Y.new(e,{renderer:lt.new(e,{})})),m=P(null),p=P("loading"),l={params:t,chart:r,xAxis:s,yAxis:a,seriesInfos:new Map,messages:null,theme:i,pointerIsOver:!1,rtl:n,get state(){return p.value},get data(){return m.value},set data(u){m.value=u}};yt(l),Tt(l),bt(l);const c=D([Ct(l,t.onRangeChange),kt(l,t.onCursorPositionChange),M(e.events.once("frameended",()=>{p.value="ready"})),M(e)]);return{destroy:()=>{c.remove(),p.value="destroyed"},update:u=>{u.data===l.data&&u.messages===l.messages||L(l)||Mt(l,u)},zoomOut:()=>I(l),test:void 0}}function L(t){return t.state==="destroyed"}function bt({chart:t,xAxis:e,yAxis:o}){const i=pt.new(t.root,{behavior:"none",xAxis:e,yAxis:o,snapToSeriesBy:"y"});i.lineY.set("visible",!1),t.set("cursor",i)}function yt(t){var s;const{chart:e,xAxis:o,theme:i}=t;o.setAll({extraMax:0,extraMin:0,maxDeviation:0,numberFormatter:V(t,"distance"),strictMinMax:!0,strictMinMaxSelection:!0}),o.axisHeader.set("forceHidden",!0);const n=o.get("renderer");n.setAll({inside:!1,minGridDistance:i.xAxisMinGridDistance}),n.labels.template.setAll({centerX:b,centerY:b,fill:f(i.axisLabelsColor),fontFamily:i.fontFamily,fontSize:i.axisLabelsFontSize,fontWeight:i.axisLabelsFontWeight,maxPosition:i.xAxisMaxLabelPosition,minPosition:i.xAxisMinLabelPosition,paddingLeft:0,paddingRight:0,paddingTop:i.xAxisLabelsSpacing});const r=o.set("tooltip",O.new(e.root,{paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0}));(s=r.get("background"))==null||s.setAll({fill:f(i.axisTooltipBackgroundColor),stroke:void 0}),r.label.setAll({fill:f(i.axisTooltipLabelColor),fontFamily:i.fontFamily,fontSize:i.axisTooltipFontSize,paddingBottom:i.axisTooltipPaddingBottom,paddingLeft:i.axisTooltipPaddingHorizontal,paddingRight:i.axisTooltipPaddingHorizontal,paddingTop:i.axisTooltipPaddingTop,direction:t.rtl?"rtl":"ltr"}),n.grid.template.setAll({strokeOpacity:1,stroke:f(i.axisGridStroke)})}function Tt(t){const{yAxis:e,theme:o,rtl:i}=t;e.setAll({baseValue:v().noDataValue,extraMax:0,extraMin:0,maxDeviation:0,numberFormatter:V(t,"elevation"),strictMinMax:!0,strictMinMaxSelection:!0,tooltip:void 0}),e.axisHeader.set("visible",!1);const n=e.get("renderer");n.setAll({minGridDistance:o.yAxisMinGridDistance,opposite:i,inside:!0}),n.labels.template.setAll({centerX:b,centerY:dt,fill:f(o.axisLabelsColor),fontFamily:o.fontFamily,fontSize:o.axisLabelsFontSize,fontWeight:o.axisLabelsFontWeight,maxPosition:o.yAxisMaxLabelPosition,minPosition:o.yAxisMinLabelPosition,paddingBottom:0,paddingLeft:i?0:o.yAxisLabelSpacing,paddingRight:i?o.yAxisLabelSpacing:0,paddingTop:0,textAlign:"start"}),n.grid.template.setAll({strokeOpacity:1,stroke:f(o.axisGridStroke)})}function Mt(t,e){var a;if(L(t))return;const o=t.data??void 0,i=e.data??void 0;(a=t.chart.get("cursor"))==null||a.set("forceHidden",!(i!=null&&i.refined));const n=o!==i,r=(o==null?void 0:o.effectiveUnits)!==(i==null?void 0:i.effectiveUnits),s=(o==null?void 0:o.uniformScaling)!==(i==null?void 0:i.uniformScaling);t.data=i,t.messages=e.messages,(n||r)&&(Lt(t),Pt(t)),s&&I(t),T(t)}function I(t){L(t)||(t.xAxis.zoom(0,1),t.yAxis.zoom(0,1))}function Lt(t){const{chart:e,data:o,xAxis:i,yAxis:n}=t,{minX:r,maxX:s,minY:a,maxY:m}=St({data:o,pixelWidth:i.width(),pixelHeight:n.height()}),p=!!(o!=null&&o.uniformScaling),l=!!(o!=null&&o.refined);e.setAll({panX:!0,panY:p,pinchZoomX:l,pinchZoomY:l&&p,wheelX:"panX",wheelY:l?p?"zoomXY":"zoomX":"none"}),i.setAll({max:s,min:r,panX:!0,panY:!1,zoomX:!0,zoomY:p}),n.setAll({max:m,min:a,panX:!1,panY:p,zoomX:p,zoomY:p})}function St({data:t,pixelWidth:e,pixelHeight:o}){if(t==null)return y;const i=t.statistics,n=0,r=i==null?void 0:i.maxDistance;let s=i==null?void 0:i.minElevation,a=i==null?void 0:i.maxElevation;if(r==null||s==null||a==null)return y;const m=Math.max(r-n,X);let p=Math.max(a-s,X);const l=t.effectiveUnits;if(t.dynamicElevationRange){const c=R(m,l.distance,l.elevation);p=Math.max(p,c/v().maxChartRatio)}return s-=At*p,a=s+p+ht*p,[s,a]=ft(s,a,10),p=a-s,t.uniformScaling?Ft({data:t,bounds:{minX:n,maxX:r,minY:s,maxY:a},pixelWidth:e,pixelHeight:o,centered:!0}):{minX:n,maxX:n+m,minY:s,maxY:s+p}}function Ft({data:t,bounds:e,pixelWidth:o,pixelHeight:i,centered:n}){if(t==null)return e;let{minX:r,maxX:s,minY:a,maxY:m}=e;if(r==null||s==null||a==null||m==null)return y;const p=s-r,l=m-a,c=t.effectiveUnits,d=R(l,c.elevation,c.distance)/i/(p/o);return d>=1?[r,s]=C([r,s],d,n):[a,m]=C([a,m],1/d,n),{minX:r,maxX:s,minY:a,maxY:m}}function C([t,e],o,i){const n=(e-t)*o;if(i){const r=(t+e)/2-n/2;return[r,r+n]}return[t,t+n]}function Pt(t){var p;const{chart:e,data:o,seriesInfos:i,xAxis:n,yAxis:r}=t;if(o==null||o.lines.length===0)return void e.series.clear();const s=new Map,a=new Set(e.series.values),m=o.lines.length;for(let l=0;l<m;l++){const c=o.lines[l];let d=i.get(c.id);d?(d.fill&&a.delete(d.fill),a.delete(d.line)):(d=zt(t,c),d.fill&&e.series.push(d.fill),e.series.push(d.line)),s.set(d.id,d);const u=m-l-1;(p=d.fill)==null||p.set("layer",u),d.line.set("layer",m+u),Yt(t,d,c)}t.seriesInfos=s;for(const l of a)e.series.removeValue(l);n.set("layer",m+1),r.set("layer",m+2)}function Yt({theme:t},e,o){const i=f(o.color.toCss()),n=o.samples??[],r=n.length>0,{line:s,fill:a}=e;s.set("visible",r),s.set("stroke",i),a==null||a.set("visible",r),a==null||a.set("fill",ct.lighten(i,t.seriesFillLighten)),s.data.setAll(n),a==null||a.data.setAll(n)}function zt(t,e){const{id:o}=e,i=k(t,`${xt}-${o}`),n=Xt(t);i.setAll({dy:e.chartStrokeOffsetY,tooltip:n}),i.strokes.template.setAll({strokeWidth:e.chartStrokeWidth});let r=null;return e.chartFillEnabled&&(r=k(t,`${gt}-${o}`),r.fills.template.setAll({fillOpacity:1,visible:!0})),{id:o,line:i,fill:r}}function k(t,e){return mt.new(t.chart.root,{connect:!1,excludeFromTotal:!0,fill:void 0,id:e,stroke:void 0,valueXField:"distance",valueYField:"elevation",xAxis:t.xAxis,yAxis:t.yAxis})}function Xt({theme:t,chart:e,rtl:o}){var s;const i=O.new(e.root,{autoTextColor:!1,forceHidden:!0,getFillFromSprite:!1,getLabelFillFromSprite:!1,pointerOrientation:"vertical",visible:!1}),n=t.seriesTooltipPaddingHorizontal,r=t.seriesTooltipPaddingVertical;return i.label.setAll({fill:f(t.seriesTooltipLabelColor),fontFamily:t.fontFamily,fontSize:t.seriesTooltipFontSize,paddingBottom:r,paddingLeft:n,paddingRight:n,paddingTop:r,textAlign:o?"end":"start",direction:"ltr"}),(s=i.get("background"))==null||s.setAll({stroke:void 0,fill:f(t.seriesTooltipBackgroundColor)}),i.adapters.add("dy",a=>{var l;const m=t.seriesTooltipSpacing,p=((l=i.get("pointTo"))==null?void 0:l.y)??0;return(a??0)+(i.y()>p?m:-m)}),i}function Ct(t,e){const{xAxis:o,yAxis:i}=t,n=()=>{e(w(o),w(i))},r=s=>[s.on("start",n),s.on("end",n)];return j([...r(o),...r(i)])}function w(t){const e=Math.abs((t.get("end")??0)-(t.get("start")??0)),o=e!==0?1/e:1;return Math.abs(1-o)<Q()?1:o}function kt(t,e){const{chart:o,xAxis:i,yAxis:n}=t,r=o.get("cursor"),s=o.plotContainer.events,a=p=>{t.pointerIsOver=p,T(t)},m=()=>{a(!1),e(null,null)};return j([r==null?void 0:r.events.on("cursormoved",()=>{if(!t.pointerIsOver)return;T(t);let p=(r==null?void 0:r.getPrivate("positionX"))??0,l=(r==null?void 0:r.getPrivate("positionY"))??0;const c=t.data;if((c==null?void 0:c.statistics)!=null){const{maxDistance:d,minElevation:u,maxElevation:S}=c.statistics;d!=null&&(p=$(p,B(i),H(i),0,d)),u!=null&&S!=null&&(l=$(l,B(n),H(n),u,S))}e(p,l)}),s.on("pointerover",()=>a(!0)),s.on("pointerout",m),s.on("blur",m)])}function $(t,e,o,i,n){return(e+t*(o-e)-i)/(n-i)}function T(t){const e=wt(t);if(!e)return void t.seriesInfos.forEach(o=>{var i;(i=o.line.get("tooltip"))==null||i.set("forceHidden",!0)});t.seriesInfos.forEach(o=>{const i=o.line.get("tooltip");i.set("forceHidden",!1),i.label.set("text",e)}),t.xAxis.getTooltip().setAll({tooltipText:Ht(t)})}function wt(t){const{data:e}=t,o=e==null?void 0:e.lines.map(i=>{var n;return{line:i,y:(n=U(t,i))==null?void 0:n.elevation}}).sort($t);return o&&o.length!==0&&o[0].y!=null?o.map(({y:i,line:n})=>Bt(t,n,i)).join(`
`):null}function $t({y:t},{y:e}){return t==null?1:e==null?-1:e-t}function Bt(t,e,o){const{data:i,messages:n}=t;if(i==null||n==null)return"";const r=`[${e.color.toHex()}]●[/]`,s="  ",a=v().formatPrecision,m=ut(n.chartTooltip,{name:_(e,n),elevation:o!=null?G(n,o,i.effectiveUnits.elevation,a):tt});return t.rtl?m+s+r:r+s+m}function Ht(t){const{data:e,messages:o}=t;if(e==null||o==null)return"";const i=e.lines[0],n=i?U(t,i):null,r=v().formatPrecision;return n!=null?G(o,n.distance,e.effectiveUnits.distance,r):"-"}function V(t,e){const o=et.new(t.chart.root,{});return o.format=(i,n,r)=>{const{data:s,messages:a}=t;return a==null||s==null||typeof i=="string"?"":`${N(i,{maximumFractionDigits:r})} ${K(a,s.effectiveUnits[e],"abbr")}`},o}function U({chart:t,xAxis:e},o){const i=o.samples??[];if(i.length===0)return null;const n=t.get("cursor"),r=(n==null?void 0:n.getPrivate("positionX"))??0,s=e.toAxisPosition(r),a=e.positionToValue(s);return it(i,a,m=>m.distance)}function B(t){return t.positionToValue(t.get("start")??0)}function H(t){return t.positionToValue(t.get("end")??1)}function j(t){return D(t.map(M))}function M(t){return J(()=>{t==null||t.dispose()})}export{Te as createChart,St as getAdjustedBounds};
