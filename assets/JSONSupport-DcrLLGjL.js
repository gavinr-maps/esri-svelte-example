import{c as E,u as f,p as g,be as h,bf as _,bg as J,bh as p,bi as y,bj as O,ax as w,bk as D,s as T,B as j,ab as P,ad as x,r as m,a as v,g as z}from"./Accessor-BmwT4B0c.js";let A=class S{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(r){const e=new S;return this._values.forEach((t,s)=>{r&&r.has(s)||e.set(s,E(t.value),t.origin)}),e}get(r,e){e=this._normalizeOrigin(e);const t=this._values.get(r);return e==null||(t==null?void 0:t.origin)===e?t==null?void 0:t.value:void 0}originOf(r){var e;return((e=this._values.get(r))==null?void 0:e.origin)??f.USER}keys(r){r=this._normalizeOrigin(r);const e=[...this._values.keys()];return r==null?e:e.filter(t=>{var s;return((s=this._values.get(t))==null?void 0:s.origin)===r})}set(r,e,t){if((t=this._normalizeOrigin(t))===f.DEFAULTS){const s=this._values.get(r);if((s==null?void 0:s.origin)!=null&&s.origin>t)return}this._values.set(r,new U(e,t))}delete(r,e){var t;(e=this._normalizeOrigin(e))!=null&&((t=this._values.get(r))==null?void 0:t.origin)!==e||this._values.delete(r)}has(r,e){var t;return(e=this._normalizeOrigin(e))!=null?((t=this._values.get(r))==null?void 0:t.origin)===e:this._values.has(r)}forEach(r){this._values.forEach(({value:e},t)=>r(e,t))}_normalizeOrigin(r){if(r!=null)return r===f.DEFAULTS?r:f.USER}};class U{constructor(r,e){this.value=r,this.origin=e}}function k(i,r,e){r.keys().forEach(s=>{e.set(s,r.get(s),f.DEFAULTS)});const t=i.metadata;Object.keys(t).forEach(s=>{i.internalGet(s)&&e.set(s,i.internalGet(s),f.DEFAULTS)})}function C(i,r,e){if(!(i!=null&&i.read)||i.read.enabled===!1||!i.read.source)return!1;const t=i.read.source;if(typeof t=="string"){if(t===r||t.includes(".")&&t.indexOf(r)===0&&p(t,e))return!0}else for(const s of t)if(s===r||s.includes(".")&&s.indexOf(r)===0&&p(s,e))return!0;return!1}function L(i){return i&&(!i.read||i.read.enabled!==!1&&!i.read.source)}function q(i,r,e,t,s){let n=h(r[e],s);L(n)&&(i[e]=!0);for(const o of Object.getOwnPropertyNames(r))n=h(r[o],s),C(n,e,t)&&(i[o]=!0)}function F(i,r,e,t){const s=e.metadata,n=J(s[r],t),o=n==null?void 0:n.default;if(o===void 0)return;const a=typeof o=="function"?o.call(i,r,t):o;a!==void 0&&e.set(r,a)}const N={origin:"service"};function M(i,r,e=N){if(!r||typeof r!="object")return;const t=g(i),s=t.metadata,n={};for(const o of Object.getOwnPropertyNames(r))q(n,s,o,r,e);t.setDefaultOrigin(e.origin);for(const o of Object.getOwnPropertyNames(n)){const a=h(s[o],e).read,u=a==null?void 0:a.source;let l;l=u&&typeof u=="string"?_(r,u):r[o],a!=null&&a.reader&&(l=a.reader.call(i,l,r,e)),l!==void 0&&t.set(o,l)}if(!e||!e.ignoreDefaults){t.setDefaultOrigin("defaults");for(const o of Object.getOwnPropertyNames(s))n[o]||F(i,o,t,e)}t.setDefaultOrigin("user")}function I(i,r,e,t=N){var n;const s={...t,messages:[]};e(s),(n=s.messages)==null||n.forEach(o=>{o.type!=="warning"||i.loaded?t!=null&&t.messages&&t.messages.push(o):i.loadWarnings.push(o)})}function R(i,r,e,t,s){var o,a;const n={};return(a=(o=r.write)==null?void 0:o.writer)==null||a.call(i,t,n,e,s),n}function $(i,r,e,t,s,n){if(!(t!=null&&t.write))return!1;const o=w(i,e);if(!s&&t.write.overridePolicy){const a=t.write.overridePolicy.call(i,o,e,n??void 0);a!==void 0&&(s=a)}if(s||(s=t.write),!s||s.enabled===!1||s.layerContainerTypes&&(n!=null&&n.layerContainerType)&&!s.layerContainerTypes.includes(n.layerContainerType))return!1;if((o===null&&!s.allowNull&&!s.writerEnsuresNonNull||o===void 0)&&s.isRequired){const a=new T("web-document-write:property-required",`Missing value for required property '${e}' on '${i.declaredClass}'`,{propertyName:e,target:i});return a&&(n!=null&&n.messages)?n.messages.push(a):a&&!n&&j.getLogger("esri.core.accessorSupport.write").error(a.name,a.message),!1}return!(o===void 0||o===null&&!s.allowNull&&!s.writerEnsuresNonNull||!s.alwaysWriteDefaults&&(!r.store.multipleOriginsSupported||r.store.originOf(e)===f.DEFAULTS)&&G(i,e,n,t,o)||!s.ignoreOrigin&&(n!=null&&n.origin)&&r.store.multipleOriginsSupported&&r.store.originOf(e)<P(n.origin))}function G(i,r,e,t,s){const n=t.default;if(n===void 0)return!1;if(t.defaultEquals!=null)return t.defaultEquals(s);if(typeof n=="function"){if(Array.isArray(s)){const o=n.call(i,r,e??void 0);return x(o,s)}return!1}return n===s}function K(i,r,e,t){const s=g(i),n=s.metadata,o=y(n[r],t);return!!o&&$(i,s,r,o,e,t)}function W(i,r,e){var n,o;if(i&&typeof i.toJSON=="function"&&(!i.toJSON.isDefaultToJSON||!i.write))return O(r,i.toJSON(e));const t=g(i),s=t.metadata;for(const a in s){const u=y(s[a],e);if(!$(i,t,a,u,void 0,e))continue;const l=w(i,a),d=R(i,u,u.write&&typeof u.write.target=="string"?u.write.target:a,l,e);Object.keys(d).length>0&&(r=O(r,d),(o=(n=e==null?void 0:e.resources)==null?void 0:n.pendingOperations)!=null&&o.length&&e.resources.pendingOperations.push(Promise.all(e.resources.pendingOperations).then(()=>O(r,d,()=>"replace-arrays"))),e!=null&&e.writtenProperties&&e.writtenProperties.push({target:i,propName:a,oldOrigin:D(t.store.originOf(a)),newOrigin:e.origin}))}return r}const b=i=>{let r=class extends i{constructor(...e){super(...e);const t=g(this),s=t.store,n=new A;t.store=n,k(t,s,n)}read(e,t){M(this,e,t)}write(e,t){return W(this,e??{},t)}toJSON(e){return this.write({},e)}static fromJSON(e,t){return B.call(this,e,t)}};return r=m([v("esri.core.JSONSupport")],r),r.prototype.toJSON.isDefaultToJSON=!0,r};function B(i,r){if(!i)return null;if(i.declaredClass)throw new Error("JSON object is already hydrated");const e=new this;return e.read(i,r),e}let c=class extends b(z){};c=m([v("esri.core.JSONSupport")],c),function(i){function r(e){return e&&typeof e=="object"&&"toJSON"in e&&typeof e.toJSON=="function"}i.JSONSupportMixin=b,i.isSerializable=r}(c||(c={}));const Q=c;export{Q as S,W as a,I as d,k as e,K as g,M as u};
