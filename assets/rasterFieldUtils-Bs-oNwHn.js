import{y as x}from"./Field-BDG0QV_T.js";const V="Raster.",u="Raster.Dim.",$=".Max",m={servicePixelValue:"Raster.ServicePixelValue",rawServicePixelValue:"Raster.ServicePixelValue.Raw",itemPixelValue:"Raster.ItemPixelValue",magnitude:"Raster.Magnitude",direction:"Raster.Direction",variable:"Raster.Variable"},w=new Map([["quarters","Quarter"],["months","Month"],["weeks","Week of the year"],["days","Day of the year"]]);function f(a,e){return new x({name:a,alias:e,domain:null,editable:!1,length:50,type:"string"})}function d(a,e){return new x({name:a,alias:e,domain:null,editable:!1,type:"double"})}function b(a,e){return new x({name:a,alias:e,domain:null,editable:!1,type:"date"})}function P(a){return f(m.servicePixelValue,a??"Service Pixel Value")}function S(a){return f(m.rawServicePixelValue,a??"Raw Service Pixel Value")}function R(){return f(m.itemPixelValue,"Item Pixel Value")}function M(a){return f(`${m.servicePixelValue}.${a}`,a)}function I(a){return d(`${m.magnitude}`,"Magnitude"+(a?` (${a})`:""))}function D(){return d(`${m.direction}`,"Direction (Â°)")}function E(a){return a.fields.filter(e=>e.type!=="oid"&&e.name.toLowerCase()!=="value").map(e=>{const i=e.clone();return i.name=`${V}${e.name}`,i})}function N(a){const e=new Set,i=new Set,n=new Map;return a.variables.forEach(({dimensions:t})=>{t.forEach(r=>{var o;if(r.recurring)n.set(r.name,r.unit);else{const c=((o=r.unit)==null?void 0:o.trim())==="ISO8601"?e:i;c.add(r.name),r.hasRanges&&c.add(`${r.name}${$}`)}})}),[f(m.variable,"Variable"),...[...e].map(t=>b(`${u}${t}`,h(t))),...[...i].map(t=>d(`${u}${t}`,h(t))),...[...n].map(([t,r])=>d(`${u}${t}`,y(t,r)))]}function y(a,e){return e=e==null?void 0:e.toLowerCase(),e&&w.has(e)?w.get(e):h(a)}function h(a){const e=a.endsWith($),i=e?a.slice(0,-4):a,n=i==="StdTime"?"Standard Time":i==="StdZ"?"Standard Z":i;return e?`${n} Max`:n}function p(a,e){return e?new Date(a):a}function W(a,e,i){i!=null&&i.length&&(e[m.variable]=i[0].variableName,i.forEach(({dimensionName:n,values:t})=>{if(n&&(t!=null&&t.length)){const r=`${u}${n}`,o=a.find(({name:s})=>s===r);if(!o)return;const c=o.type==="date",l=t[0];if(Array.isArray(l)){if(e[`${u}${n}`]=p(l[0],c),l[1]!=null){const s=`${u}${n}${$}`;if(a.some(({name:v})=>v===s)){const v=p(l[1],c);e[s]=v}}}else e[`${u}${n}`]=p(l,c)}}))}function T(a,e){if(e.pixelType.startsWith("f")&&a.forEach(({format:i,fieldName:n})=>{i&&n&&/^raster\.(item|service)pixelvalue/i.test(n)&&(i.places=2)}),e.multidimensionalInfo){const i=e.multidimensionalInfo.variables.flatMap(({dimensions:n})=>n);a.forEach(({format:n,fieldName:t})=>{var r;if(n&&(t!=null&&t.startsWith(u))){const o=t.slice(u.length),c=`${o}${$}`,l=i.find(({name:s})=>s===o||s===c);(r=l==null?void 0:l.values)!=null&&r.every(s=>Number.isInteger(s))&&(n.places=0)}})}}export{D as $,W as V,u as a,T as b,S as c,I as d,M as f,R as m,V as n,P as o,N as p,m as t,E as v};
