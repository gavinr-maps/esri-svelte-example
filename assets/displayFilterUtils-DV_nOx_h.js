import{m,g as x,N as s,F as l}from"./mathUtils-DV9iOXpW.js";import{u as T}from"./opacityUtils-CSd4XoR2.js";function E(n,r){return{...r,filterMode:n.mode}}function M(n,r){return I(n,r).next().value??null}function g(n,r,e){const t=h(n);if(t&&(s(r,t[0])||l(e,t[1])))return"";const u=Array.from(I(n,r,e)),i=p(u,r,e)?"1=1":u.map(o=>o.where||"1=1").reduce((o,c)=>T(o,c),"");return i&&i!=="1=1"?i:""}function h(n){if(d(n)==="manual")return null;const r=[Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY];for(const{minScale:e,maxScale:t}of n.filters)r[0]=Math.max(r[0],f(e)),r[1]=Math.min(r[1],a(t));return r}function*I(n,r,e){if(d(n)==="manual"){const t=n.filters.find(u=>u.id===n.activeFilterId);t&&(yield t)}else{typeof r=="object"&&(r=r.scale);for(const t of n.filters)F(t.minScale,t.maxScale,r,e)&&(yield t)}}function p(n,r,e){var i,o;if(n.length===0)return!0;const t=f((i=n.at(0))==null?void 0:i.minScale),u=a((o=n.at(-1))==null?void 0:o.maxScale);if(l(t,r)||s(u,e))return!0;for(let c=0;c<n.length-1;c++){const N=n[c],S=n[c+1];if(l(f(S.minScale),a(N.maxScale)))return!0}return!1}function F(n,r,e,t){return n=f(n),e=f(e),r=a(r),!(!m(e,n)&&(t??e)>n)&&!x(r,e)&&(t===void 0||!m(t,n))}function d(n){return"mode"in n?n.mode:n.filterMode}function f(n){return n||Number.POSITIVE_INFINITY}function a(n){return n||0}export{g as c,E as i,M as u};
