const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./queryNamedTraceConfigurations-Bt_8F1rf.js","./assets-C43MgM-v.js","./subclass-BZA_h8Db.js","./index-Bh2oEzTI.js","./index-2kwcjS9-.css","./tslib.es6-B3Jf3DVX.js","./Accessor-BLX9ikPh.js","./utils-6jMaHUrH.js","./Graphic-DsxsIjhH.js","./geometry-D964gYQX.js","./Extent-Bf3YTe7m.js","./Point-Cg0-ChZE.js","./cast-Bjksrh93.js","./writer-DNAwXnhG.js","./jsonMap-0cxwUWs2.js","./Polyline-D9YkgmM_.js","./mathUtils-C4_ghTv4.js","./PopupTemplate-BHMhS05j.js","./Clonable-D3rtuBWg.js","./Collection-CEdjem1-.js","./Evented-BHRw9x22.js","./shared-B3wH2qpO.js","./SimpleObservable-KocWTzVy.js","./fieldUtils-tmQlKvWo.js","./intl-CChhNOV8.js","./date-DlqISzcw.js","./locale-C9TlLpzi.js","./messages-OmQvZhAg.js","./enumeration-Ba5njXdz.js","./Color-BCS62Hs5.js","./colorUtils-0bJDPow9.js","./ActionToggle-iT4slXc7.js","./Identifiable-B1UbsKNt.js","./symbols-CNimns--.js","./TextSymbol-D8QO_KUV.js","./screenUtils-_ZIvrt5o.js","./materialUtils-DarhapKC.js","./opacityUtils-C68Tlu6_.js","./vec3f64-BLpZdpfb.js","./aaBoundingBox-BE7cC1jD.js","./persistableUrlUtils-fa1mAujs.js","./collectionUtils-D_lHIu88.js","./Portal-C10FKnaA.js","./Loadable-BabW5Xcc.js","./Promise-B2Hu02L7.js","./reactiveUtils-C5zUhJQJ.js","./asyncUtils-CWX51uTe.js","./jsonUtils-CEfjT-BK.js","./FeatureLayer-wa_7EIxE.js","./ClassBreaksRenderer-BuHwSyVK.js","./UniqueValueRenderer-BQtAHUSo.js","./diffUtils-BP7jmOAy.js","./colorRamps-pKd7I5WZ.js","./SizeVariable-936USOrb.js","./sizeVariableUtils-Cmcuvw-4.js","./visualVariableUtils-DX1kS9Se.js","./compilerUtils-Dw3R0f-Z.js","./lengthUtils-DL1-FDQQ.js","./ColorStop-Dk3U5tCk.js","./jsonUtils-Ds2Sqto-.js","./layerUtils-BrNoooE9.js","./defaults-DZ1kfMRx.js","./defaultsJSON-GKolV7NZ.js","./RendererLegendOptions-B-4se3aU.js","./styleUtils-BYTm14n3.js","./jsonUtils-DxpLMo6d.js","./LRUCache-B_PHMSGm.js","./MemCache-Dx1v3xLC.js","./Version-BSlAgupz.js","./FieldsIndex-DpwHKAMX.js","./UnknownTimeZone-BkowvBs8.js","./OverrideHelper-ti072FkP.js","./colorUtils-aL8wj-8G.js","./vec42-YcqnINSP.js","./common-DQOJ18NT.js","./vec4f64-o2zAXfmz.js","./utils-D2PLyMFF.js","./enums-CmIX1y88.js","./quantizationUtils-uj_P09aO.js","./HeatmapColorStop-BJc5nbwr.js","./heatmapUtils-Dwiv9IEa.js","./SimpleRenderer-BV2L9G_n.js","./MultiOriginJSONSupport-B5nfqtQh.js","./layerContainerType-C5CzMsLd.js","./FeatureLayerBase-Ck7-w8TE.js","./formUtils-ylzKAM7E.js","./Field-ybkHhtnK.js","./fieldType-BuzM0UHS.js","./HeightModelInfo-9nOoV6LU.js","./arcgisLayerUrl-BX1FE5Hm.js","./commonProperties-CPyIG_-u.js","./ElevationInfo-CA5m_tHv.js","./unitConversionUtils-BMfW9yAe.js","./AttributeTableTemplate-BZeVyq-j.js","./featureLayerUtils-DBsQMhTm.js","./featureQueryAll-DnVoEjkM.js","./Query-5Xpquc1r.js","./DataLayerSource-BKkswDvG.js","./FullTextSearch-Csd1Hktu.js","./TimeExtent-DocT5yPf.js","./timeUtils-8fb_2oAt.js","./AttachmentQuery-BUlkjzkx.js","./RelationshipQuery-DPPNeuLK.js","./LayerFloorInfo-CIQjg5Vk.js","./Relationship-COPq3qM4.js","./serviceCapabilitiesUtils-DAE5z8FP.js","./Layer-CVt7Hb5J.js","./workers-D4HfeYKj.js","./Queue-yu3bZ02p.js","./editsZScale-Bs7_pSzI.js","./queryZScale-w66xFVGx.js","./projection-B971H0Re.js","./projectBuffer-Bs7GwaPY.js","./geodesicConstants-DWQLYX7F.js","./FeatureSet-BHEkYP03.js","./APIKeyMixin-Di9kcRBS.js","./ArcGISService-B5qxetOY.js","./BlendLayer-CXM4n_Ge.js","./jsonUtils-CSnQD004.js","./parser-CTsgEym6.js","./utils-93yNk4Xc.js","./mat4f32-DcsiF_Rp.js","./mat4-GpOFENPA.js","./CustomParametersMixin-B4u7wiBT.js","./EditBusLayer-DoTks2sU.js","./uuid-fwrPAdZb.js","./FeatureEffectLayer-CpM66wLd.js","./FeatureEffect-BEzQmzeC.js","./FeatureFilter-BMHRQSxq.js","./FeatureReductionLayer-Ddbk727V.js","./FeatureReductionSelection-7vaL4DYT.js","./labelingInfo-DYPSPZCH.js","./labelUtils-B8petyBk.js","./MD5-C9MwAd2G.js","./OperationalLayer-CVyVfSPu.js","./OrderedLayer-C5VLMHgA.js","./OrderByInfo-IYmS1EXF.js","./PortalLayer-CKja4bdW.js","./PortalItem-DzgXrpyc.js","./portalItemUtils-BzVoFAku.js","./RefreshableLayer-D7lXUJRS.js","./ScaleRangeLayer-Bb8Ig1Hz.js","./TemporalLayer-Dpq2hKKV.js","./TimeInfo-LUiaSFyX.js","./TimeInterval-CNlkea1s.js","./FeatureTemplate-CssMa1yk.js","./FeatureType-C0q_coeM.js","./fieldProperties-Cgxj08ZE.js","./versionUtils-CQ_WhYSP.js","./styleUtils-KMFBtb6u.js","./popupUtils-BBuPGAHd.js","./AlphaCutoff-UcccL64p.js","./interfaces-CL2NbQte.js","./NetworkElement-CyYx535m.js","./QueryNamedTraceConfigurationsParameters-hyJy0qJ8.js","./validateNetworkTopology-D-1JpShy.js","./ValidateNetworkTopologyParameters-BlsFp63O.js","./queryAssociations-CGd4ymfT.js","./Association-CIWSDxb_.js","./QueryAssociationsParameters-BdSYj6V-.js","./synthesizeAssociationGeometries-C6sgUado.js","./SynthesizeAssociationGeometriesParameters-3TczdVZx.js","./trace-zvfzcOP9.js","./TraceParameters-B2mPCC1o.js"])))=>i.map(i=>d[i]);
import{_ as j}from"./index-Bh2oEzTI.js";import{r as o}from"./tslib.es6-B3Jf3DVX.js";import{d as fe}from"./Graphic-DsxsIjhH.js";import{m as i,a as E,b as ae,n as ke}from"./subclass-BZA_h8Db.js";import je from"./FeatureLayer-wa_7EIxE.js";import{r as ve}from"./featureQueryAll-DnVoEjkM.js";import"./geometry-D964gYQX.js";import{f as Y,U as K,I as Ee,u as _e}from"./assets-C43MgM-v.js";import{m as be}from"./Loadable-BabW5Xcc.js";import{S as Ce,m as Oe}from"./MultiOriginJSONSupport-B5nfqtQh.js";import{u as Te,c as Ae,b as Ue}from"./Accessor-BLX9ikPh.js";import{w as $e}from"./Extent-Bf3YTe7m.js";import{f as Re}from"./jsonUtils-CEfjT-BK.js";import{g as ue,a as ne,l as Ve,h as Le,t as pe,i as ce,c as me}from"./EditBusLayer-DoTks2sU.js";import{d as ye}from"./arcgisLayerUrl-BX1FE5Hm.js";import{i as Ie,n as Pe}from"./jsonMap-0cxwUWs2.js";import{r as Se}from"./enumeration-Ba5njXdz.js";import he from"./PortalItem-DzgXrpyc.js";import{d as Fe}from"./FeatureSet-BHEkYP03.js";import{g as Ne}from"./Point-Cg0-ChZE.js";import{t as z,o as te,p as Ge,c as xe}from"./NetworkElement-CyYx535m.js";import{o as Be}from"./writer-DNAwXnhG.js";import{d as De,u as Je,v as Me}from"./Polyline-D9YkgmM_.js";import{b as qe}from"./Query-5Xpquc1r.js";let P=class extends Y{constructor(t){super(t),this.moment=null,this.fullUpdate=!1,this.validateErrorsCreated=!1,this.dirtyAreaCount=null,this.exceededTransferLimit=null,this.serviceEdits=null,this.discoveredSubnetworks=null}};o([i({type:Date,json:{type:Number,write:{writer:(e,t)=>{t.moment=e?e.getTime():null}}}})],P.prototype,"moment",void 0),o([i({type:Boolean,json:{write:!0}})],P.prototype,"fullUpdate",void 0),o([i({type:Boolean,json:{write:!0}})],P.prototype,"validateErrorsCreated",void 0),o([i({type:Number,json:{write:!0}})],P.prototype,"dirtyAreaCount",void 0),o([i({type:Boolean,json:{write:!0}})],P.prototype,"exceededTransferLimit",void 0),o([i({type:[Object],json:{write:!0}})],P.prototype,"serviceEdits",void 0),o([i({type:[Object],json:{write:!0}})],P.prototype,"discoveredSubnetworks",void 0),P=o([E("esri.rest.networks.support.ValidateNetworkTopologyResult")],P);const ze=P,He=Ie()({Pending:"job-waiting",InProgress:"job-executing",Completed:"job-succeeded"});let J=class extends ze{constructor(t){super(t),this.statusUrl=null,this.status=null,this.submissionTime=null,this.lastUpdatedTime=null,this._timer=void 0}destroy(){clearInterval(this._timer)}async checkJobStatus(t){const r={...t,query:{f:"json"}},{data:s}=await K(this.statusUrl,r);return this.read(s),this.editsResolver&&this.editsResolver.resolve({edits:null,addedFeatures:[],updatedFeatures:[],deletedFeatures:[],addedAttachments:[],updatedAttachments:[],deletedAttachments:[],exceededTransferLimit:!0,historicMoment:null}),this}async waitForJobCompletion(t={}){const{interval:r=1e3,statusCallback:s}=t;return new Promise((n,a)=>{this._clearTimer();const l=setInterval(()=>{this._timer||a(Te()),this.checkJobStatus().then(d=>{const{status:p}=d;switch(this.status=p,p){case"job-succeeded":this._clearTimer(),n(this);break;case"job-waiting":case"job-executing":s&&s(this)}},d=>{this._clearTimer(),a(d)})},r);this._timer=l})}_clearTimer(){clearInterval(this._timer),this._timer=void 0}};o([i()],J.prototype,"editsResolver",void 0),o([i({type:String,json:{write:!0}})],J.prototype,"statusUrl",void 0),o([Se(He)],J.prototype,"status",void 0),o([i({type:Date,json:{type:Number,write:{writer:(e,t)=>{t.submissionTime=e?e.getTime():null}}}})],J.prototype,"submissionTime",void 0),o([i({type:Date,json:{type:Number,write:{writer:(e,t)=>{t.lastUpdatedTime=e?e.getTime():null}}}})],J.prototype,"lastUpdatedTime",void 0),J=o([E("esri.networks.support.TopologyValidationJobInfo")],J);const Ke=J;async function Lt(e,t){const r=e.layers,s=e.layerInfos,n=e.returnGeometry||!1,a=e.outSpatialReference;return await Promise.all(r.map(async l=>{await l.load()})),(await Promise.all(r.map(async l=>{var w;const d=s.find(g=>{var m;return g.layerUrl===((m=l.parsedUrl)==null?void 0:m.path)});if(!((w=d==null?void 0:d.objectIds)!=null&&w.length))return{layer:l,featureSet:void 0};const p=l.createQuery();p.returnGeometry=n,p.outFields=d.outFields||["*"],p.outSpatialReference=a,p.gdbVersion=l.gdbVersion,p.objectIds=d.objectIds;const h=Fe.fromJSON(await ve(l,p));return{layer:l,featureSet:h}}))).filter(l=>l.featureSet!==void 0)}async function we(e,t){if(e==="Utility Network Layer"){const{default:r}=await j(()=>Promise.resolve().then(()=>dt),void 0,import.meta.url);return new r({layerUrl:t})}return null}async function Ye(e){var l;let t="portalItem"in e?e:{portalItem:e};!t.portalItem||t.portalItem instanceof he||(t={...t,portalItem:new he(t.portalItem)});const r=t.portalItem;if(await r.load(),r.type!=="Feature Service")throw new ae("portal:unknown-item-type","Unknown item type '${type}'",{type:r.type});const s=r.url,n=await K(s,{responseType:"json",query:{f:"json"}}),a="Network Layer";if((l=n.data.type)!=null&&l.includes(a))return we(n.data.type,s);if(n.data.layers){const d=n.data.layers.find(p=>p.type.includes(a));if(d){const p=`${s}/${d.id}`;return we(d.type,p)}}return null}let f=class extends Ce(be){static fromPortalItem(e){return Ye(e)}constructor(e){super(e),this.id=null,this.title=null,this.layerUrl=null,this.dataElement=null,this.fullExtent=null,this.spatialReference=null,this.type=null,this.sourceJSON=null,this.gdbVersion=null,this.historicMoment=null,this._sourceIdByLayerId=new Map,this._layerIdBySourceId=new Map,this._applyEditsHandler=t=>{const{serviceUrl:r,gdbVersion:s,result:n}=t,a=r===this.featureServiceUrl,l=ue(r,s,this.gdbVersion);a&&l&&n.then(d=>{ne(r,s)&&(this.historicMoment=d.historicMoment)})},this._updateMomentHandler=t=>{const{serviceUrl:r,gdbVersion:s,moment:n}=t,a=r===this.featureServiceUrl,l=ue(r,s,this.gdbVersion);a&&l&&(this.historicMoment=n)},this.when().then(()=>{this.addHandles([Ve(this._applyEditsHandler),Le(this._updateMomentHandler)])},()=>{})}initialize(){this.when().catch(e=>{Ae(e)||ke.getLogger(this).error("#load()",`Failed to load layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}')`,{error:e})})}get datasetName(){var e;return((e=this.dataElement)==null?void 0:e.name)??null}get owner(){var e;return((e=this.dataElement)==null?void 0:e.userIdentity)??null}get schemaGeneration(){var e;return((e=this.dataElement)==null?void 0:e.schemaGeneration)??null}get parsedUrl(){return Ee(this.layerUrl)}get featureServiceUrl(){return ye(this.parsedUrl.path).url.path}get networkServiceUrl(){return this.featureServiceUrl.replace(/\/FeatureServer/i,"/UtilityNetworkServer")}get layerId(){return ye(this.parsedUrl.path).sublayer}get networkSystemLayers(){return null}async load(e){return this.addResolvingPromise(this._fetchDataElement(this.featureServiceUrl,this.layerId.toString(),e)),this.addResolvingPromise(this._fetchLayerMetaData(this.layerUrl,e)),this}getLayerIdBySourceId(e){if(!this.dataElement)return null;const t=this._layerIdBySourceId.get(e);if(t!=null)return t;const r=this.dataElement.domainNetworks,s=this._traverseNetworkSources(r,this._layerIdBySourceId,"sourceId","layerId",e);return s>=0?s:null}getSourceIdByLayerId(e){if(!this.dataElement)return null;const t=this._sourceIdByLayerId.get(e);if(t!=null)return t;const r=this.dataElement.domainNetworks,s=this._traverseNetworkSources(r,this._sourceIdByLayerId,"layerId","sourceId",e);return s>=0?s:null}getObjectIdsFromElements(e){const t=[],r=new Map;for(const n of e){const a=this.getLayerIdBySourceId(n.networkSourceId);if(a==null)continue;let l=r.get(a);l===void 0&&(l=[]),l.push(n.objectId),r.set(a,l)}const s=this.featureServiceUrl;return r.forEach((n,a)=>t.push({layerUrl:`${s}/${a}`,objectIds:n})),t}async queryNamedTraceConfigurations(e,t){var l;const[{queryNamedTraceConfigurations:r},{default:s}]=await Promise.all([j(()=>import("./queryNamedTraceConfigurations-Bt_8F1rf.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153]),import.meta.url),j(()=>import("./QueryNamedTraceConfigurationsParameters-hyJy0qJ8.js"),__vite__mapDeps([154,5,1,2,3,4,6]),import.meta.url)]),n=this.networkServiceUrl,a=s.from(e);return(l=await r(n,a,{...t}))==null?void 0:l.namedTraceConfigurations}async validateTopology(e,t){var h,w,g;if(!e.validateArea)throw new ae("network:undefined-validateArea","the network must have validateArea defined in the validate network topology parameters.");const[{validateNetworkTopology:r},{default:s}]=await Promise.all([j(()=>import("./validateNetworkTopology-D-1JpShy.js"),__vite__mapDeps([155,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153]),import.meta.url),j(()=>import("./ValidateNetworkTopologyParameters-BlsFp63O.js"),__vite__mapDeps([156,5,9,2,10,11,6,12,13,1,3,4,14,15,16,153]),import.meta.url)]),n=s.from(e);ne(this.featureServiceUrl,this.gdbVersion||null)?(n.sessionID=pe,await ce(this.featureServiceUrl,this.gdbVersion,!0)):n.sessionID=null,n.gdbVersion=this.gdbVersion;const a=this.networkServiceUrl,l=this.featureServiceUrl,d=me(l,null,this.gdbVersion,!0),p=await r(a,n,{...t});if(p!=null&&p.serviceEdits){const m=[];for(const v of p.serviceEdits){const{editedFeatures:c}=v,u=c!=null&&c.spatialReference?new Ne(c.spatialReference):null;m.push({layerId:v.layerId,editedFeatures:{adds:((h=c==null?void 0:c.adds)==null?void 0:h.map(b=>re(b,u)))||[],updates:((w=c==null?void 0:c.updates)==null?void 0:w.map(b=>({original:re(b[0],u),current:re(b[1],u)})))||[],deletes:((g=c==null?void 0:c.deletes)==null?void 0:g.map(b=>re(b,u)))||[],spatialReference:u}})}d.resolve({edits:null,addedFeatures:[],updatedFeatures:[],deletedFeatures:[],addedAttachments:[],updatedAttachments:[],deletedAttachments:[],editedFeatures:m,exceededTransferLimit:!1,historicMoment:p.moment})}return p}async submitTopologyValidationJob(e,t){let r=null;if(!e.validateArea)throw new ae("network:undefined-validateArea","the network must have validateArea defined in the validate network topology parameters.");if(!this.gdbVersion){const h=this.layerUrl.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,"");r=(await K(h,{responseType:"json",query:{f:"json"}})).data.defaultVersionName}const[{submitValidateNetworkTopologyJob:s},{default:n}]=await Promise.all([j(()=>import("./validateNetworkTopology-D-1JpShy.js"),__vite__mapDeps([155,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153]),import.meta.url),j(()=>import("./ValidateNetworkTopologyParameters-BlsFp63O.js"),__vite__mapDeps([156,5,9,2,10,11,6,12,13,1,3,4,14,15,16,153]),import.meta.url)]),a=n.from(e);ne(this.featureServiceUrl,this.gdbVersion||null)?(a.sessionID=pe,await ce(this.featureServiceUrl,this.gdbVersion,!0)):a.sessionID=null,a.gdbVersion=this.gdbVersion||r;const l=this.networkServiceUrl,d=this.featureServiceUrl?me(this.featureServiceUrl,null,this.gdbVersion,!0):void 0,p=await s(l,a,{...t});return new Ke({statusUrl:p,editsResolver:d})}_traverseNetworkSources(e,t,r,s,n){for(const a of e)for(const l of[a.edgeSources??[],a.junctionSources??[]])for(const d of l)if(d[r]===n)return t.set(n,d[s]),d[s];return-1}async _fetchLayerMetaData(e,t){const r=await K(e,{responseType:"json",query:{f:"json"},...t});this.sourceJSON=r.data,this.read(r.data,{origin:"service"})}async _fetchDataElement(e,t,r){if(this.dataElement)return;const s=await K(`${e}/queryDataElements`,{responseType:"json",query:{layers:JSON.stringify([t]),f:"json"},...r}).then(n=>{var a;return(a=n.data.layerDataElements)==null?void 0:a[0]});s&&this.read(s,{origin:"service"})}};function re(e,t){return new fe({attributes:e.attributes,geometry:Re({...e.geometry,spatialReference:t})})}o([i({type:String,nonNullable:!0,json:{origins:{"web-map":{read:!0,write:{isRequired:!0}},service:{read:!0}},read:!1}})],f.prototype,"id",void 0),o([i({type:String,nonNullable:!0,json:{origins:{"web-map":{read:!0,write:{isRequired:!0}},service:{read:{source:"name"}}},read:!1}})],f.prototype,"title",void 0),o([i({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"url"},write:{target:"url",isRequired:!0}}},read:!1}})],f.prototype,"layerUrl",void 0),o([i({type:Object,json:{origins:{service:{read:!0}},read:!1}})],f.prototype,"dataElement",void 0),o([i({type:$e,json:{origins:{service:{read:{source:"extent"}}},read:!1}})],f.prototype,"fullExtent",void 0),o([i({type:Ne,json:{origins:{service:{read:{source:"extent.spatialReference"}}},read:!1}})],f.prototype,"spatialReference",void 0),o([i({type:["utility","trace"],readOnly:!0,json:{read:!1,write:!1}})],f.prototype,"type",void 0),o([i({readOnly:!0})],f.prototype,"datasetName",null),o([i({readOnly:!0})],f.prototype,"owner",null),o([i({readOnly:!0})],f.prototype,"schemaGeneration",null),o([i({readOnly:!0})],f.prototype,"parsedUrl",null),o([i({readOnly:!0})],f.prototype,"featureServiceUrl",null),o([i({readOnly:!0})],f.prototype,"networkServiceUrl",null),o([i({readOnly:!0})],f.prototype,"layerId",null),o([i()],f.prototype,"sourceJSON",void 0),o([i({readOnly:!0})],f.prototype,"networkSystemLayers",null),o([i()],f.prototype,"gdbVersion",void 0),o([i({type:Date})],f.prototype,"historicMoment",void 0),f=o([E("esri.networks.Network")],f);const We=f;let M=class extends _e(be){constructor(t){super(t),this.rulesCategorized={attachment:[],containment:[],connectivity:[]},this.request=K}initialize(){}async load(t){const r=this.layer.load(t).then(()=>this._initializeRulesTable());return this.addResolvingPromise(r),this}getFeatureSQL(t,r){var h,w;const s=t.layerId.toString(),n=(h=t.fieldsIndex)==null?void 0:h.normalizeFieldName("assetGroup"),a=(w=t.fieldsIndex)==null?void 0:w.normalizeFieldName("assetType"),l=n?r.attributes[n]:null,d=a?r.attributes[a]:null,p=this.rulesHash[s];if(p){const g=p.assetGroupHash[l];if(g)return g.assetTypeHash[d]||null}return null}async _initializeRulesTable(){var n,a,l,d,p,h,w,g,m,v,c;const t={};let r;(function(u){u[u.from=0]="from",u[u.to=1]="to",u[u.via=2]="via"})(r||(r={}));const s=[{networkSourceId:"fromNetworkSource",assetGroupId:"fromAssetGroup",assetTypeId:"fromAssetType"},{networkSourceId:"toNetworkSource",assetGroupId:"toAssetGroup",assetTypeId:"toAssetType"},{networkSourceId:"viaNetworkSource",assetGroupId:"viaAssetGroup",assetTypeId:"viaAssetType"}];this.rulesCategorized={attachment:[],containment:[],connectivity:[]};for(const u of this.rules){if(u.ruleType===z.RTAttachment){this.rulesCategorized.attachment.push(u);continue}if(u.ruleType===z.RTContainment){this.rulesCategorized.containment.push(u);continue}if(u.ruleType===z.RTJunctionJunctionConnectivity){this.rulesCategorized.connectivity.push(u);continue}this.rulesCategorized.connectivity.push(u);let b=[[r.from,r.to],[r.to,r.from]];u.ruleType===z.RTEdgeJunctionEdgeConnectivity&&(b=[[r.from,r.via],[r.via,r.from],[r.to,r.via],[r.via,r.to]]);for(const V of b){const L=V.shift(),W=V.shift();let B=!1;switch(u.ruleType){case z.RTEdgeJunctionEdgeConnectivity:B=L===r.from||L===r.to;break;case z.RTJunctionEdgeConnectivity:B=L===r.to}const k=s[L],T=((n=u[k.networkSourceId])==null?void 0:n.layerId.toString())??"",I=(l=(a=u[k.assetGroupId])==null?void 0:a.assetGroupCode)==null?void 0:l.toString(),U=u[k.assetTypeId],O=(d=U==null?void 0:U.assetTypeCode)==null?void 0:d.toString(),$=s[W],_=((p=u[$.networkSourceId])==null?void 0:p.layerId.toString())??"",F=(w=(h=u[$.assetGroupId])==null?void 0:h.assetGroupCode)==null?void 0:w.toString(),S=u[$.assetTypeId],D=(g=S==null?void 0:S.assetTypeCode)==null?void 0:g.toString(),se=t[T]??{assetGroupHash:{}};if(!(I&&O&&F&&D))continue;const ie=se.assetGroupHash[I]??{assetTypeHash:{}},N=ie.assetTypeHash[O]??{};if(N[_]=N[_]??{},B){N[T]=N[T]??{};const de=`(assetgroup = ${I} AND assettype = ${O})`;(S==null?void 0:S.connectivityPolicy)==="esriNECPEndVertex"?N[T].endVertex=(m=N[T])!=null&&m.endVertex?`${N[T].endVertex}`:`${de}`:N[T].anyVertex=N[T].anyVertex?`${N[T].anyVertex}`:`${de}`}const ee=`(assetgroup = ${F} AND assettype = ${D})`;(S==null?void 0:S.connectivityPolicy)==="esriNECPEndVertex"?N[_].endVertex=(v=N[_])!=null&&v.endVertex?`${N[_].endVertex} OR ${ee}`:`${ee}`:N[_].anyVertex=(c=N[_])!=null&&c.anyVertex?`${N[_].anyVertex} OR ${ee}`:`${ee}`,ie.assetTypeHash[O]=N,se.assetGroupHash[I]=ie,t[T]=se}}this.rulesHash=t}};o([i({constructOnly:!0})],M.prototype,"layer",void 0),o([i({constructOnly:!0})],M.prototype,"rules",void 0),o([i()],M.prototype,"rulesHash",void 0),o([i()],M.prototype,"rulesCategorized",void 0),o([i({constructOnly:!0})],M.prototype,"request",void 0),M=o([E("esri.networks.RulesTable")],M);const Qe=M;let A=class extends Y{constructor(t){super(t),this.conditionBarriers=[],this.outputConditions=[],this.functions=[],this.functionBarriers=[],this.traversabilityScope=null,this.shortestPathNetworkAttributeName=null,this.includeBarriers=null,this.validateConsistency=null,this.ignoreBarriersAtStartingPoints=null}};o([i({type:[Object],json:{write:!0}})],A.prototype,"conditionBarriers",void 0),o([i({type:[Object],json:{write:!0}})],A.prototype,"outputConditions",void 0),o([i({type:[Object],json:{write:!0}})],A.prototype,"functions",void 0),o([i({type:[Object],json:{write:!0}})],A.prototype,"functionBarriers",void 0),o([i({type:["junctions","edges","junctionsAndEdges"],json:{write:!0}})],A.prototype,"traversabilityScope",void 0),o([i({type:String,json:{write:!0}})],A.prototype,"shortestPathNetworkAttributeName",void 0),o([i({type:Boolean,json:{write:!0}})],A.prototype,"includeBarriers",void 0),o([i({type:Boolean,json:{write:!0}})],A.prototype,"validateConsistency",void 0),o([i({type:Boolean,json:{write:!0}})],A.prototype,"ignoreBarriersAtStartingPoints",void 0),A=o([E("esri.networks.support.TraceConfiguration")],A);const le=A;let y=class extends le{constructor(e){super(e),this.filterBarriers=[],this.arcadeExpressionBarrier=null,this.domainNetworkName=null,this.filterBitsetNetworkAttributeName=null,this.filterFunctionBarriers=[],this.filterScope=null,this.includeContainers=null,this.includeContent=null,this.includeIsolated=null,this.includeStructures=null,this.allowIndeterminateFlow=null,this.includeUpToFirstSpatialContainer=null,this.nearestNeighbor=null,this.outputFilterCategories=[],this.outputFilters=[],this.propagators=[],this.subnetworkName=null,this.targetTierName=null,this.diagramTemplateName=null,this.tierName=null,this.validateLocatability=null}};o([i({type:[Object],json:{write:!0}})],y.prototype,"filterBarriers",void 0),o([i({type:String,json:{write:!0}})],y.prototype,"arcadeExpressionBarrier",void 0),o([i({type:String,json:{write:!0}})],y.prototype,"domainNetworkName",void 0),o([i({type:String,json:{write:!0}})],y.prototype,"filterBitsetNetworkAttributeName",void 0),o([i({type:[Object],json:{write:!0}})],y.prototype,"filterFunctionBarriers",void 0),o([i({type:["junctions","edges","junctionsAndEdges"],json:{write:!0}})],y.prototype,"filterScope",void 0),o([i({type:Boolean,json:{write:!0}})],y.prototype,"includeContainers",void 0),o([i({type:Boolean,json:{write:!0}})],y.prototype,"includeContent",void 0),o([i({type:Boolean,json:{write:!0}})],y.prototype,"includeIsolated",void 0),o([i({type:Boolean,json:{write:!0}})],y.prototype,"includeStructures",void 0),o([i({type:Boolean,json:{write:!0}})],y.prototype,"allowIndeterminateFlow",void 0),o([i({type:Boolean,json:{write:!0}})],y.prototype,"includeUpToFirstSpatialContainer",void 0),o([i({type:Object,json:{write:!0}})],y.prototype,"nearestNeighbor",void 0),o([i({type:[Object],json:{write:!0}})],y.prototype,"outputFilterCategories",void 0),o([i({type:[Object],json:{write:!0}})],y.prototype,"outputFilters",void 0),o([i({type:[Object],json:{write:!0}})],y.prototype,"propagators",void 0),o([i({type:String,json:{write:!0}})],y.prototype,"subnetworkName",void 0),o([i({type:String,json:{write:!0}})],y.prototype,"targetTierName",void 0),o([i({type:String,json:{write:!0}})],y.prototype,"diagramTemplateName",void 0),o([i({type:String,json:{write:!0}})],y.prototype,"tierName",void 0),o([i({type:Boolean,json:{write:!0}})],y.prototype,"validateLocatability",void 0),y=o([E("esri.networks.support.UNTraceConfiguration")],y);const Xe=y;let C=class extends Oe{constructor(t){super(t),this.globalId=null,this.title=null,this.traceConfiguration=null,this.creationDate=null,this.creator=null,this.description=null,this.minStartingPoints=null,this.resultTypes=[],this.tags=[],this.traceType=null}readTraceConfiguration(t,r){return t.tierName!==void 0?Xe.fromJSON(t):le.fromJSON(t)}};o([i({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"id"},write:{target:"id",isRequired:!0}},service:{read:{source:"globalId"},write:{target:"globalId",isRequired:!0}}},read:!1}})],C.prototype,"globalId",void 0),o([i({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"title"},write:{target:"title",isRequired:!0}},service:{read:{source:"name"},write:{target:"name",isRequired:!0}}},read:!1}})],C.prototype,"title",void 0),o([i({type:le,json:{origins:{service:{read:!0,write:!0}},read:!1}})],C.prototype,"traceConfiguration",void 0),o([Be("service","traceConfiguration")],C.prototype,"readTraceConfiguration",null),o([i({type:Date,json:{origins:{service:{read:!0,write:!0}},read:!1}})],C.prototype,"creationDate",void 0),o([i({type:String,json:{origins:{service:{read:!0,write:!0}},read:!1}})],C.prototype,"creator",void 0),o([i({type:String,json:{origins:{service:{read:!0,write:!0}},read:!1}})],C.prototype,"description",void 0),o([i({type:["none","one","many"],json:{origins:{service:{read:{source:"minNumStartingPoints"},write:{target:"minNumStartingPoints"}}},read:!1}})],C.prototype,"minStartingPoints",void 0),o([i({json:{origins:{service:{read:!0,write:!0}},read:!1}})],C.prototype,"resultTypes",void 0),o([i({type:[String],json:{origins:{service:{read:!0,write:!0}},read:!1}})],C.prototype,"tags",void 0),o([i({type:te.apiValues,json:{type:te.jsonValues,origins:{service:{read:te.read,write:te.write}},read:!1}})],C.prototype,"traceType",void 0),C=o([E("esri.networks.support.NamedTraceConfiguration")],C);const Ze=C;let R=class extends Ue{constructor(e){super(e),this.rulesTableId=null,this.rulesTableUrl=null,this.subnetworksTableId=null,this.subnetworksTableUrl=null,this.dirtyAreasLayerId=null,this.dirtyAreasLayerUrl=null,this.associationsTableId=null,this.associationsTableUrl=null}};o([i({constructOnly:!0})],R.prototype,"rulesTableId",void 0),o([i({constructOnly:!0})],R.prototype,"rulesTableUrl",void 0),o([i({constructOnly:!0})],R.prototype,"subnetworksTableId",void 0),o([i({constructOnly:!0})],R.prototype,"subnetworksTableUrl",void 0),o([i({constructOnly:!0})],R.prototype,"dirtyAreasLayerId",void 0),o([i({constructOnly:!0})],R.prototype,"dirtyAreasLayerUrl",void 0),o([i({constructOnly:!0})],R.prototype,"associationsTableId",void 0),o([i({constructOnly:!0})],R.prototype,"associationsTableUrl",void 0),R=o([E("esri.networks.support.NetworkSystemLayers")],R);const et=R;let Q=class extends Y{constructor(t){super(t),this.id=null,this.name=null}};o([i({type:Number,json:{read:{source:"terminalId"},write:{target:"terminalId"}}})],Q.prototype,"id",void 0),o([i({type:String,json:{read:{source:"terminalName"},write:{target:"terminalName"}}})],Q.prototype,"name",void 0),o([i({type:Boolean,json:{write:!0}})],Q.prototype,"isUpstreamTerminal",void 0),Q=o([E("esri.networks.support.Terminal")],Q);const tt=Q,oe=new Pe({esriUNTMBidirectional:"bidirectional",esriUNTMDirectional:"directional"});let q=class extends Y{constructor(t){super(t),this.defaultConfiguration=null,this.id=null,this.name=null,this.terminals=[],this.traversabilityModel=null}};o([i({type:String,json:{write:!0}})],q.prototype,"defaultConfiguration",void 0),o([i({type:Number,json:{read:{source:"terminalConfigurationId"},write:{target:"terminalConfigurationId"}}})],q.prototype,"id",void 0),o([i({type:String,json:{read:{source:"terminalConfigurationName"},write:{target:"terminalConfigurationName"}}})],q.prototype,"name",void 0),o([i({type:[tt],json:{write:!0}})],q.prototype,"terminals",void 0),o([i({type:oe.apiValues,json:{type:oe.jsonValues,read:oe.read,write:oe.write}})],q.prototype,"traversabilityModel",void 0),q=o([E("esri.networks.support.TerminalConfiguration")],q);const ge=q;let X=class extends Y{constructor(t){super(t),this.line=null,this.multipoint=null,this.polygon=null}};o([i({type:De,json:{write:!0},readOnly:!0})],X.prototype,"line",void 0),o([i({type:Je,json:{read:{source:"point"},write:{target:"point"}},readOnly:!0})],X.prototype,"multipoint",void 0),o([i({type:Me,json:{write:!0},readOnly:!0})],X.prototype,"polygon",void 0),X=o([E("esri.rest.networks.support.AggregatedGeometry")],X);const rt=X;let Z=class extends Y{constructor(e){super(e),this.functionType=null,this.networkAttributeName=null,this.result=null}};o([i({type:["add","subtract","average","count","min","max"],json:{write:!0},readOnly:!0})],Z.prototype,"functionType",void 0),o([i({type:String,json:{write:!0},readOnly:!0})],Z.prototype,"networkAttributeName",void 0),o([i({type:Number,json:{write:!0},readOnly:!0})],Z.prototype,"result",void 0),Z=o([E("esri.rest.networks.support.FunctionResult")],Z);const ot=Z;let G=class extends Y{constructor(t){super(t),this.aggregatedGeometry=null,this.elements=null,this.globalFunctionResults=null,this.kFeaturesForKNNFound=!1,this.startingPointsIgnored=!1,this.warnings=null}};o([i({type:rt,json:{write:!0},readOnly:!0})],G.prototype,"aggregatedGeometry",void 0),o([i({type:[Ge],json:{write:!0},readOnly:!0})],G.prototype,"elements",void 0),o([i({type:[ot],json:{write:!0},readOnly:!0})],G.prototype,"globalFunctionResults",void 0),o([i({type:Boolean,json:{write:!0},readOnly:!0})],G.prototype,"kFeaturesForKNNFound",void 0),o([i({type:Boolean,json:{write:!0},readOnly:!0})],G.prototype,"startingPointsIgnored",void 0),o([i({type:[String],json:{write:!0},readOnly:!0})],G.prototype,"warnings",void 0),G=o([E("esri.rest.networks.support.TraceResult")],G);const st=G,it=Ie()({Pending:"job-waiting",InProgress:"job-executing",Completed:"job-succeeded"});let H=class extends st{constructor(e){super(e),this.statusUrl=null,this.status=null,this.submissionTime=null,this.lastUpdatedTime=null,this._timer=void 0}destroy(){clearInterval(this._timer)}async checkJobStatus(e){const t={...e,query:{f:"json"}},{data:r}=await K(this.statusUrl,t),s=r.traceResults?{...r.traceResults,...r}:r;return this.read(s),this}async waitForJobCompletion(e={}){const{interval:t=1e3,statusCallback:r}=e;return new Promise((s,n)=>{this._clearTimer();const a=setInterval(()=>{this._timer||n(Te()),this.checkJobStatus().then(l=>{const{status:d}=l;switch(this.status=d,d){case"job-succeeded":this._clearTimer(),s(this);break;case"job-waiting":case"job-executing":r&&r(this)}},l=>{this._clearTimer(),n(l)})},t);this._timer=a})}_clearTimer(){clearInterval(this._timer),this._timer=void 0}};o([i({type:String,json:{write:!0}})],H.prototype,"statusUrl",void 0),o([Se(it)],H.prototype,"status",void 0),o([i({type:Date,json:{type:Number,write:{writer:(e,t)=>{t.submissionTime=e?e.getTime():null}}}})],H.prototype,"submissionTime",void 0),o([i({type:Date,json:{type:Number,write:{writer:(e,t)=>{t.lastUpdatedTime=e?e.getTime():null}}}})],H.prototype,"lastUpdatedTime",void 0),H=o([E("esri.networks.support.TraceJobInfo")],H);const nt=H;let x=class extends We{constructor(e){super(e),this.sharedNamedTraceConfigurations=[],this.type="utility",this._terminalById=new Map}get serviceTerritoryFeatureLayerId(){var e;return((e=this.dataElement)==null?void 0:e.serviceTerritoryFeatureLayerId)??null}get networkSystemLayers(){var e,t,r,s,n,a,l,d;return new et({rulesTableId:(e=this.sourceJSON)==null?void 0:e.systemLayers.rulesTableId,rulesTableUrl:this.sourceJSON?`${this.featureServiceUrl}/${(t=this.sourceJSON)==null?void 0:t.systemLayers.rulesTableId}`:null,subnetworksTableId:(r=this.sourceJSON)==null?void 0:r.systemLayers.subnetworksTableId,subnetworksTableUrl:this.sourceJSON?`${this.featureServiceUrl}/${(s=this.sourceJSON)==null?void 0:s.systemLayers.subnetworksTableId}`:null,dirtyAreasLayerId:(n=this.sourceJSON)==null?void 0:n.systemLayers.dirtyAreasLayerId,dirtyAreasLayerUrl:this.sourceJSON?`${this.featureServiceUrl}/${(a=this.sourceJSON)==null?void 0:a.systemLayers.dirtyAreasLayerId}`:null,associationsTableId:(l=this.sourceJSON)==null?void 0:l.systemLayers.associationsTableId,associationsTableUrl:this.sourceJSON?`${this.featureServiceUrl}/${(d=this.sourceJSON)==null?void 0:d.systemLayers.associationsTableId}`:null})}get terminalConfigurations(){var e;return((e=this.dataElement)==null?void 0:e.terminalConfigurations.map(t=>ge.fromJSON(t)))||[]}get domainNetworkNames(){var e;return((e=this.dataElement)==null?void 0:e.domainNetworks.map(t=>t.domainNetworkName))||[]}get _utilityLayerList(){var t,r;const e=new Set;return(r=(t=this.dataElement)==null?void 0:t.domainNetworks)==null||r.map(s=>{s.edgeSources.map(n=>{e.add(n.layerId)}),s.junctionSources.map(n=>{e.add(n.layerId)})}),e}async load(e){return this.addResolvingPromise(super.load(e)),this.addResolvingPromise(this._loadNamedTraceConfigurationsFromNetwork(e)),this}getTerminalConfiguration(e){var p,h,w,g;let t=null,r=null;const s=e.layer;let n=null;if((s==null?void 0:s.type)==="feature"){if(n=s.layerId,n===null)return null}else if((s==null?void 0:s.type)!=="subtype-sublayer"||(n=((p=s==null?void 0:s.parent)==null?void 0:p.layerId)??null,n===null))return null;const a=e.attributes;if(a==null)return null;for(const m of Object.keys(a))m.toUpperCase()==="ASSETGROUP"&&(t=e.getAttribute(m)),m.toUpperCase()==="ASSETTYPE"&&(r=e.getAttribute(m));if(!this.dataElement)return null;let l=null;const d=this.dataElement.domainNetworks;for(const m of d){const v=(h=m.junctionSources)==null?void 0:h.find(c=>c.layerId===n);if(v){const c=(w=v.assetGroups)==null?void 0:w.find(u=>u.assetGroupCode===t);if(c){const u=(g=c.assetTypes)==null?void 0:g.find(b=>b.assetTypeCode===r);if(u){l=u.terminalConfigurationId;break}}}}if(l!=null){const m=this.dataElement.terminalConfigurations,v=m==null?void 0:m.find(c=>c.terminalConfigurationId===l);return v?ge.fromJSON(v):null}return null}getTierNames(e){var r;const t=(r=this.dataElement)==null?void 0:r.domainNetworks.find(s=>s.domainNetworkName===e);return(t==null?void 0:t.tiers.map(s=>s.name))||[]}async getRulesTable(){return this._sharedRulesTable||(this._sharedRulesTable=this._createRulesTable()),await this._sharedRulesTable}getTerminalById(e){if(!this.dataElement||e==null)return null;const t=this._terminalById.get(e);return t??(this.terminalConfigurations.forEach(r=>{r.terminals.forEach(s=>{this._terminalById.set(s.id,s)})}),this._terminalById.get(e))}isUtilityLayer(e){var t;return"layerId"in e&&this._utilityLayerList.has(e.layerId)&&(((t=e.url)==null?void 0:t.startsWith(this.featureServiceUrl))??!1)}async queryAssociations(e){const[{queryAssociations:t},{default:r}]=await Promise.all([j(()=>import("./queryAssociations-CGd4ymfT.js"),__vite__mapDeps([157,1,2,3,4,5,6,153,14,7,158,9,10,11,12,13,15,16]),import.meta.url),j(()=>import("./QueryAssociationsParameters-BdSYj6V-.js"),__vite__mapDeps([159,5,1,2,3,4,6,153,14]),import.meta.url)]),s=r.from(e);return s.gdbVersion=this.gdbVersion,s.moment=this.historicMoment,(await t(this.networkServiceUrl,s)).associations}async synthesizeAssociationGeometries(e){const[{synthesizeAssociationGeometries:t},{default:r}]=await Promise.all([j(()=>import("./synthesizeAssociationGeometries-C6sgUado.js"),__vite__mapDeps([160,1,2,3,4,5,6,7,158,9,10,11,12,13,14,15,16,153]),import.meta.url),j(()=>import("./SynthesizeAssociationGeometriesParameters-3TczdVZx.js"),__vite__mapDeps([161,5,1,2,3,4,6,13,10,11,12,14]),import.meta.url)]),s=r.from(e);return s.gdbVersion=this.gdbVersion,s.moment=this.historicMoment,t(this.networkServiceUrl,s)}async trace(e){const[{trace:t},{default:r}]=await Promise.all([j(()=>import("./trace-zvfzcOP9.js"),__vite__mapDeps([162,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153]),import.meta.url),j(()=>import("./TraceParameters-B2mPCC1o.js").then(n=>n.T),__vite__mapDeps([163,5,1,2,3,4,6,13,11,12,14,153]),import.meta.url)]),s=r.from(e);return s.gdbVersion=this.gdbVersion,s.moment=this.historicMoment,t(this.networkServiceUrl,s)}async submitTraceJob(e){const[{submitTraceJob:t},{default:r}]=await Promise.all([j(()=>import("./trace-zvfzcOP9.js"),__vite__mapDeps([162,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153]),import.meta.url),j(()=>import("./TraceParameters-B2mPCC1o.js").then(a=>a.T),__vite__mapDeps([163,5,1,2,3,4,6,13,11,12,14,153]),import.meta.url)]),s=r.from(e);s.gdbVersion=this.gdbVersion,s.moment=this.historicMoment;const n=await t(this.networkServiceUrl,s);return new nt({statusUrl:n})}async canAddAssociation(e){const t=await this.getRulesTable();if(!t)return!1;await t.load();const r=(n,a)=>n?n.terminalId===1?!(a!=null&&a.terminalId)||(a==null?void 0:a.terminalId)===n.terminalId:n.terminalId===(a==null?void 0:a.terminalId):!(a!=null&&a.terminalId),s=(n,a)=>{var l,d,p,h,w,g,m,v,c,u,b,V;return((l=n.fromNetworkSource)==null?void 0:l.sourceId)===((d=a.fromNetworkElement)==null?void 0:d.networkSourceId)&&((p=n.toNetworkSource)==null?void 0:p.sourceId)===((h=a.toNetworkElement)==null?void 0:h.networkSourceId)&&((w=n.fromAssetGroup)==null?void 0:w.assetGroupCode)===((g=a.fromNetworkElement)==null?void 0:g.assetGroupCode)&&((m=n.fromAssetType)==null?void 0:m.assetTypeCode)===((v=a.fromNetworkElement)==null?void 0:v.assetTypeCode)&&((c=n.toAssetGroup)==null?void 0:c.assetGroupCode)===((u=a.toNetworkElement)==null?void 0:u.assetGroupCode)&&((b=n.toAssetType)==null?void 0:b.assetTypeCode)===((V=a.toNetworkElement)==null?void 0:V.assetTypeCode)&&r(n.fromTerminal,a.fromNetworkElement)&&r(n.toTerminal,a.toNetworkElement)};return e.associationType==="containment"?t.rulesCategorized.containment.some(n=>s(n,e)):e.associationType==="attachment"?t.rulesCategorized.attachment.some(n=>s(n,e)):t.rulesCategorized.connectivity.some(n=>{var a,l,d,p,h,w,g,m,v,c,u,b,V,L,W,B,k,T,I,U,O,$,_,F;return n.viaNetworkSource?((a=n.fromNetworkSource)==null?void 0:a.sourceId)===((l=e.fromNetworkElement)==null?void 0:l.networkSourceId)&&((d=n.viaNetworkSource)==null?void 0:d.sourceId)===((p=e.toNetworkElement)==null?void 0:p.networkSourceId)&&((h=n.fromAssetGroup)==null?void 0:h.assetGroupCode)===((w=e.fromNetworkElement)==null?void 0:w.assetGroupCode)&&((g=n.fromAssetType)==null?void 0:g.assetTypeCode)===((m=e.fromNetworkElement)==null?void 0:m.assetTypeCode)&&((v=n.viaAssetGroup)==null?void 0:v.assetGroupCode)===((c=e.toNetworkElement)==null?void 0:c.assetGroupCode)&&((u=n.viaAssetType)==null?void 0:u.assetTypeCode)===((b=e.toNetworkElement)==null?void 0:b.assetTypeCode)&&r(n.fromTerminal,e.fromNetworkElement)&&r(n.viaTerminal,e.toNetworkElement)||((V=n.viaNetworkSource)==null?void 0:V.sourceId)===((L=e.fromNetworkElement)==null?void 0:L.networkSourceId)&&((W=n.toNetworkSource)==null?void 0:W.sourceId)===((B=e.toNetworkElement)==null?void 0:B.networkSourceId)&&((k=n.viaAssetGroup)==null?void 0:k.assetGroupCode)===((T=e.fromNetworkElement)==null?void 0:T.assetGroupCode)&&((I=n.viaAssetType)==null?void 0:I.assetTypeCode)===((U=e.fromNetworkElement)==null?void 0:U.assetTypeCode)&&((O=n.toAssetGroup)==null?void 0:O.assetGroupCode)===(($=e.toNetworkElement)==null?void 0:$.assetGroupCode)&&((_=n.toAssetType)==null?void 0:_.assetTypeCode)===((F=e.toNetworkElement)==null?void 0:F.assetTypeCode)&&r(n.viaTerminal,e.fromNetworkElement)&&r(n.toTerminal,e.toNetworkElement):s(n,e)})}generateAddAssociations(e){return{addFeatures:e.map(t=>{var r,s,n,a,l,d;return new fe({attributes:{fromnetworksourceid:(r=t.fromNetworkElement)==null?void 0:r.networkSourceId,fromglobalid:(s=t.fromNetworkElement)==null?void 0:s.globalId,fromterminalid:(n=t.fromNetworkElement)==null?void 0:n.terminalId,tonetworksourceid:(a=t.toNetworkElement)==null?void 0:a.networkSourceId,toglobalid:(l=t.toNetworkElement)==null?void 0:l.globalId,toterminalid:(d=t.toNetworkElement)==null?void 0:d.terminalId,associationtype:xe[t.associationType],iscontentvisible:t.isContentVisible?1:0,percentalong:t.percentAlong,globalid:t.globalId}})}),id:this.networkSystemLayers.associationsTableId,identifierFields:{globalIdField:"globalid",objectIdField:"objectid"}}}generateDeleteAssociations(e){return{deleteFeatures:e.map(t=>({globalId:t.globalId})),id:this.networkSystemLayers.associationsTableId,identifierFields:{globalIdField:"globalid",objectIdField:"objectid"}}}async _loadNamedTraceConfigurationsFromNetwork(e){var s;if(((s=this.sharedNamedTraceConfigurations)==null?void 0:s.length)===0)return;const t=this.sharedNamedTraceConfigurations.map(n=>n.globalId),r=await this.queryNamedTraceConfigurations({globalIds:t},e);for(const n of this.sharedNamedTraceConfigurations){const a=r==null?void 0:r.find(l=>l.globalId===n.globalId);if(a){const l=a.write({},{origin:"service"});n.read(l,{origin:"service"})}}}async _createRulesTable(){var a;const e=this.networkSystemLayers.rulesTableUrl,t=new je({url:e});await t.load();const r=(a=this.dataElement)==null?void 0:a.domainNetworks;if(!r)return null;const s=r.flatMap(l=>[...l.edgeSources||[],...l.junctionSources||[]]),n=(await at(t)).map(l=>this._hydrateRuleInfo(t,s,l));return new Qe({layer:t,rules:n})}_hydrateRuleInfo(e,t,r){const s=e.fieldsIndex,n=s.get("RULETYPE"),a=s.get("CREATIONDATE"),l=s.get("FROMNETWORKSOURCEID"),d=s.get("FROMASSETGROUP"),p=s.get("FROMASSETTYPE"),h=s.get("FROMTERMINALID"),w=s.get("TONETWORKSOURCEID"),g=s.get("TOASSETGROUP"),m=s.get("TOASSETTYPE"),v=s.get("TOTERMINALID"),c=s.get("VIANETWORKSOURCEID"),u=s.get("VIAASSETGROUP"),b=s.get("VIAASSETTYPE"),V=s.get("VIATERMINALID"),L=r.attributes[n.name],W=new Date(r.attributes[a.name]),B=[{networkSourceId:r.attributes[l.name],assetGroupId:r.attributes[d.name],assetTypeId:r.attributes[p.name],terminalId:r.attributes[h.name]},{networkSourceId:r.attributes[w.name],assetGroupId:r.attributes[g.name],assetTypeId:r.attributes[m.name],terminalId:r.attributes[v.name]},{networkSourceId:r.attributes[c.name],assetGroupId:r.attributes[u.name],assetTypeId:r.attributes[b.name],terminalId:r.attributes[V.name]}];let k;(function(I){I[I.from=0]="from",I[I.to=1]="to",I[I.via=2]="via"})(k||(k={}));const T={ruleType:L,creationDate:W};for(const I of[k.from,k.to,k.via]){if(L!==z.RTEdgeJunctionEdgeConnectivity&&I===k.via)continue;const U=B[I],O=t.find(D=>D.sourceId===U.networkSourceId),$=O==null?void 0:O.assetGroups.find(D=>D.assetGroupCode===U.assetGroupId),_=$==null?void 0:$.assetTypes.find(D=>D.assetTypeCode===U.assetTypeId),F=this._getTerminal(_,U);let S="";switch(I){case k.from:S="from";break;case k.to:S="to";break;case k.via:S="via"}T[`${S}NetworkSource`]=O,T[`${S}AssetGroup`]=$,T[`${S}AssetType`]=_,T[`${S}Terminal`]=F==null?void 0:F.toJSON()}return T}_getTerminal(e,t){var n,a;const r=e==null?void 0:e.terminalConfigurationId,s=(n=this.terminalConfigurations)==null?void 0:n.find(l=>l.id===r);return((a=s==null?void 0:s.terminals)==null?void 0:a.find(l=>l.id===t.terminalId))??null}};async function at(e){const t=new qe({where:"1=1",outFields:["*"]});return(await ve(e,t)).features}o([i({type:[Ze],json:{origins:{"web-map":{read:{source:"traceConfigurations"},write:{target:"traceConfigurations"}},service:{read:{source:"traceConfigurations"}}},read:!1}})],x.prototype,"sharedNamedTraceConfigurations",void 0),o([i({type:["utility"],readOnly:!0,json:{read:!1,write:!1}})],x.prototype,"type",void 0),o([i({readOnly:!0})],x.prototype,"serviceTerritoryFeatureLayerId",null),o([i({readOnly:!0})],x.prototype,"networkSystemLayers",null),o([i({readOnly:!0})],x.prototype,"terminalConfigurations",null),o([i({readOnly:!0})],x.prototype,"domainNetworkNames",null),x=o([E("esri.networks.UtilityNetwork")],x);const lt=x,dt=Object.freeze(Object.defineProperty({__proto__:null,default:lt},Symbol.toStringTag,{value:"Module"}));export{lt as T,st as a,Ze as d,ze as i,Lt as n,Xe as s};
