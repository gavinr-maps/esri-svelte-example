const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./calcite-button-D_QRw8fR.js","./button-CT5wDIjk.js","./jsxFactory-CbAu6VfF.js","./Evented-CXIxDjmW.js","./Accessor-D6mNnsWy.js","./subclass-BR3PhgZG.js","./intl-Dpfm8vPB.js","./Promise-CZrWwByK.js","./jsonMap-DCC6W5ex.js","./assets-C2mb-ea2.js","./index-CeCSsEgo.js","./index-CjOb8WjV.css","./reactiveUtils-BFQ0BtrB.js","./shared-B3wH2qpO.js","./uuid-fwrPAdZb.js","./form-DcBTx4ZC.js","./dom-Cv0oa6So.js","./interactive-Dtpmn6Ls.js","./label-rdYpV4K5.js","./component-ByvC-PUv.js","./loadable-CTFTnu2T.js","./locale-BUTTOPma.js","./key-D5DPfjW0.js","./observers-EizV_Lvc.js","./t9n-DfK3dFGw.js","./icon-DIKjN-ev.js","./loader-wfvKSvDR.js","./calcite-loader-DxqUpD6Z.js","./calcite-tooltip-HeRO_zdX.js","./floating-ui-BiOoil4s.js","./debounce-C5YDvsuO.js","./openCloseComponent-v_dlVp47.js","./FloatingArrow-HmzV7w9c.js"])))=>i.map(i=>d[i]);
import{_ as c}from"./index-CeCSsEgo.js";import{e as i}from"./Evented-CXIxDjmW.js";import{b as E,O as u}from"./Accessor-D6mNnsWy.js";import{y as r,b,c as h,n as g}from"./subclass-BR3PhgZG.js";import{e as v,B as y,r as L,n as p}from"./jsxFactory-CbAu6VfF.js";import"./intl-Dpfm8vPB.js";import{k as M}from"./PopupTemplate-ByHks6sq.js";import{r as T}from"./actions-BenYGl-c.js";import{b as O}from"./GeolocationPositioning-sWQZxudM.js";import{p as C}from"./geolocationUtils-DwBBSJZa.js";import{e as P,h as S}from"./Promise-CZrWwByK.js";import{e as w}from"./globalCss-CZa70j6i.js";import{e as I}from"./vmEvent-D4Ubqkbq.js";import"./reactiveUtils-BFQ0BtrB.js";import"./shared-B3wH2qpO.js";import"./uuid-fwrPAdZb.js";import"./jsonMap-DCC6W5ex.js";import"./assets-C2mb-ea2.js";import"./Clonable-cKbRam6-.js";import"./writer-3zufXUNV.js";import"./fieldUtils-CNduWQU9.js";import"./mathUtils-ClvKsMak.js";import"./geometry-DpwwkAX1.js";import"./Extent-DHjqVB-p.js";import"./Point-DB4Hp4hH.js";import"./Polyline-D97hl-6E.js";import"./enumeration--HlxOQ_N.js";import"./Color-DDUWtbqR.js";import"./colorUtils-CS9vdHXB.js";import"./ActionToggle-C0Z1k2jc.js";import"./Identifiable-BLvpQbOc.js";import"./legacyIcon-CtsJ0OTG.js";import"./Graphic-Dc7F67nR.js";import"./symbols-CsUQ5BxR.js";import"./TextSymbol-gKE-H_J6.js";import"./screenUtils-PfxkaaMN.js";import"./materialUtils-CQ3JLQ1x.js";import"./opacityUtils-BT7mQkwC.js";import"./aaBoundingBox-rJEWaOSN.js";import"./persistableUrlUtils-BcifXQ1Z.js";import"./collectionUtils-Dm1icNvk.js";import"./Portal-liet8xHC.js";import"./jsonUtils-Cma_7A64.js";import"./GoTo-CyjNnle5.js";import"./project-C_6NxEch.js";import"./utils-D61i9O7E.js";import"./utils-Dx8bgRIB.js";async function N(){const t=await S("esri/widgets/Locate/t9n/Locate");return new M({title:t.currentLocation,fieldInfos:[{fieldName:"timestamp",label:t.timestamp,format:{dateFormat:"short-date-short-time"}},{fieldName:"latitude",label:t.latitude,format:{places:4,digitSeparator:!0}},{fieldName:"longitude",label:t.longitude,format:{places:4,digitSeparator:!0}},{fieldName:"accuracy",label:t.accuracy,format:{places:0,digitSeparator:!0}},{fieldName:"altitude",label:t.altitude,format:{places:0,digitSeparator:!0}},{fieldName:"altitudeAccuracy",label:t.altitudeAccuracy,format:{places:0,digitSeparator:!0}},{fieldName:"heading",label:t.heading,format:{places:0,digitSeparator:!0}},{fieldName:"speed",label:t.speed,format:{places:0,digitSeparator:!0}}],actions:[T.clone()],content:[{type:"fields"}]})}let s=class extends O{constructor(o){super(o),this._locateController=null,this.error=void 0,this.popupEnabled=!0,this.locate=this.locate.bind(this)}initialize(){this.addHandles([P(()=>{var n;const{graphic:o,view:e}=this;if(!o)return;((n=e==null?void 0:e.graphics)==null?void 0:n.includes(o))&&this._updatePopupTemplate(o)})])}destroy(){this.cancelLocate()}get state(){var o;return this._geolocationUsable?(o=this.view)!=null&&o.ready?this._locateController?"locating":this.error!=null?"error":"ready":"disabled":"feature-unsupported"}async locate(){if(this.cancelLocate(),this.state==="disabled")throw new h("locate:disabled-state","Cannot locate when disabled.");if(this.state==="feature-unsupported")throw new h("locate:feature-unsupported-state","Cannot locate in unsecure domain.");const o=new AbortController;this._locateController=o,this.error=void 0;try{const e=await C(this.geolocationOptions);if(await this.updatePosition(e,o),this._locateController!==o)return null;const{graphic:l}=this;return l&&await this._updatePopupTemplate(l),this._addGraphic(),this.emit("locate",{position:e}),this._locateController=null,e}catch(e){if(E(e))return null;throw o===this._locateController&&(this._locateController=null),this.error=e,this.emit("locate-error",{error:e}),e}}cancelLocate(){this._clearGraphic(),this._locateController&&this._locateController.abort(),this._locateController=null}async _updatePopupTemplate(o){if(!this.popupEnabled)return;const e=await N(),l=o!==this.graphic;this.destroyed||l||(o.popupTemplate=e)}};i([r()],s.prototype,"_locateController",void 0),i([r()],s.prototype,"error",void 0),i([r()],s.prototype,"popupEnabled",void 0),i([r({readOnly:!0})],s.prototype,"state",null),i([r()],s.prototype,"locate",null),i([r()],s.prototype,"cancelLocate",null),s=i([b("esri.widgets.Locate.LocateViewModel")],s);const f=s,$={base:"esri-locate"};let a=class extends y{constructor(t,o){super(t,o),this.messages=null,this.messagesCommon=null,this.viewModel=new f,this._locate=()=>{const{viewModel:e}=this;e.state==="locating"?e.cancelLocate():e.locate().catch(()=>{})}}loadDependencies(){return L({button:()=>c(()=>import("./calcite-button-D_QRw8fR.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]),import.meta.url),loader:()=>c(()=>import("./calcite-loader-DxqUpD6Z.js"),__vite__mapDeps([27,26,2,3,4,5,6,7,8,9,10,11,12,13,14,16,21,22,23]),import.meta.url),tooltip:()=>c(()=>import("./calcite-tooltip-HeRO_zdX.js"),__vite__mapDeps([28,2,3,4,5,6,7,8,9,10,11,12,13,14,16,29,30,31,32]),import.meta.url)})}get geolocationOptions(){return this.viewModel.geolocationOptions}set geolocationOptions(t){this.viewModel.geolocationOptions=t}get goToLocationEnabled(){return this.viewModel.goToLocationEnabled}set goToLocationEnabled(t){this.viewModel.goToLocationEnabled=t}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(t){this.viewModel.goToOverride=t}get graphic(){return this.viewModel.graphic}set graphic(t){this.viewModel.graphic=t}get icon(){return"gps-off"}set icon(t){this._overrideIfSome("icon",t)}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}get popupEnabled(){return this.viewModel.popupEnabled}set popupEnabled(t){this.viewModel.popupEnabled=t}get rotationEnabled(){return u(g.getLogger(this),"rotationEnabled",{replacement:"use Track widget",version:"4.29",warnOnce:!0}),this.viewModel.rotationEnabled}set rotationEnabled(t){u(g.getLogger(this),"rotationEnabled",{replacement:"use Track widget",version:"4.29",warnOnce:!0}),this.viewModel.rotationEnabled=t}get scale(){return this.viewModel.scale}set scale(t){this.viewModel.scale=t}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}cancelLocate(){this.viewModel.cancelLocate()}locate(){return this.viewModel.locate()}render(){var m;const{viewModel:t,icon:o}=this,{state:e}=t,l=e==="locating",n=l?this.messagesCommon.cancel:this.messages.title,_=e==="feature-unsupported",d=this._localizeError((m=this.viewModel)==null?void 0:m.error);return p("div",{class:this.classes($.base,w.widget)},!_&&p("calcite-button",{class:w.widgetButton,disabled:e==="disabled",iconStart:l?void 0:o,kind:"neutral",label:n,onclick:this._locate,title:n},l?p("calcite-loader",{inline:!0,label:""}):null),d?p("calcite-tooltip",{open:!0,overlayPositioning:"fixed",referenceElement:this.container},d):null)}_localizeError(t){var o,e,l;return t instanceof GeolocationPositionError?t.code===GeolocationPositionError.PERMISSION_DENIED?(o=this.messages)==null?void 0:o.permissionError:t.code===GeolocationPositionError.TIMEOUT?(e=this.messages)==null?void 0:e.timeoutError:(l=this.messages)==null?void 0:l.positionUnavailable:t instanceof Error?t.message:void 0}};i([r()],a.prototype,"geolocationOptions",null),i([r()],a.prototype,"goToLocationEnabled",null),i([r()],a.prototype,"goToOverride",null),i([r()],a.prototype,"graphic",null),i([r()],a.prototype,"icon",null),i([r()],a.prototype,"label",null),i([r(),v("esri/widgets/Locate/t9n/Locate")],a.prototype,"messages",void 0),i([r(),v("esri/t9n/common")],a.prototype,"messagesCommon",void 0),i([r()],a.prototype,"popupEnabled",null),i([r()],a.prototype,"rotationEnabled",null),i([r()],a.prototype,"scale",null),i([r()],a.prototype,"view",null),i([r({type:f}),I(["locate","locate-error"])],a.prototype,"viewModel",void 0),a=i([b("esri.widgets.Locate")],a);const Ct=a;export{Ct as default};
