import{n as m,P as u,s as O,m as q,z as T,_ as x,g as w,f as M,c as z,e as D,r as H,G as L,d as G}from"./mathUtils-ClvKsMak.js";import"./vec42-B1mBkh1w.js";import"./subclass-BR3PhgZG.js";import{N as J}from"./Accessor-D6mNnsWy.js";import{e as K}from"./mat3f64-BBpwCtoL.js";import{e as R}from"./mat4f64-Dk4dwAN8.js";import{e as S}from"./quatf64-BrpT0VRp.js";import{n as U}from"./vec2f64-Diu2Kaa8.js";import{n as W}from"./vec4f64-CBQL1T0x.js";import{j as Y}from"./mathUtils-kvswLROa.js";let $=class I{constructor(t){this._create=t,this._items=new Array,this._itemsPtr=0}get(){return this._itemsPtr===0&&J(()=>this._reset()),this._itemsPtr>=this._items.length&&this._items.push(this._create()),this._items[this._itemsPtr++]}_reset(){const t=2*this._itemsPtr;this._items.length>t&&(this._items.length=t),this._itemsPtr=0}static createVec2f64(){return new I(U)}static createVec3f64(){return new I(m)}static createVec4f64(){return new I(W)}static createMat3f64(){return new I(K)}static createMat4f64(){return new I(R)}static createQuatf64(){return new I(S)}get test(){}};const gt=$.createVec2f64(),f=$.createVec3f64(),Z=$.createVec4f64();$.createMat3f64();const _t=$.createMat4f64(),Pt=$.createQuatf64();function Et(e,t,r){const n=u(e,t)/u(e,e);return w(r,e,n)}function j(e,t){return u(e,t)/O(e)}function lt(e,t){const r=u(e,t)/(O(e)*O(t));return-q(r)}function pt(e,t,r){T(p,e),T(v,t);const n=u(p,v),c=q(n),s=x(p,p,v);return u(s,r)<0?2*Math.PI-c:c}const p=m(),v=m();function Q(e=P){return[e[0],e[1],e[2],e[3]]}function At(e=P[0],t=P[1],r=P[2],n=P[3]){return k(e,t,r,n,Z.get())}function tt(e,t){return k(t[0],t[1],t[2],t[3],e)}function Ft(e){return e}function k(e,t,r,n,c=Q()){return c[0]=e,c[1]=t,c[2]=r,c[3]=n,c}function Tt(e,t,r){return H(r,e),r[3]=t,r}function et(e,t,r){const n=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],c=Math.abs(n-1)>1e-5&&n>1e-12?1/Math.sqrt(n):1;return r[0]=t[0]*c,r[1]=t[1]*c,r[2]=t[2]*c,r[3]=-(r[0]*e[0]+r[1]*e[1]+r[2]*e[2]),r}function rt(e,t,r,n=Q()){const c=r[0]-t[0],s=r[1]-t[1],i=r[2]-t[2],o=e[0]-t[0],E=e[1]-t[1],l=e[2]-t[2],g=s*l-i*E,y=i*o-c*l,X=c*E-s*o,b=g*g+y*y+X*X,C=Math.abs(b-1)>1e-5&&b>1e-12?1/Math.sqrt(b):1;return n[0]=g*C,n[1]=y*C,n[2]=X*C,n[3]=-(n[0]*e[0]+n[1]*e[1]+n[2]*e[2]),n}function B(e,t,r,n=0,c=Math.floor(r*(1/3)),s=Math.floor(r*(2/3))){if(r<3)return!1;t(_,n);let i=c,o=!1;for(;i<r-1&&!o;)t(h,i),i++,o=!L(_,h);if(!o)return!1;for(i=Math.max(i,s),o=!1;i<r&&!o;)t(N,i),i++,M(A,_,h),T(A,A),M(F,h,N),T(F,F),o=!L(_,N)&&!L(h,N)&&Math.abs(u(A,F))<nt;return o?(rt(_,h,N,e),!0):(n!==0||c!==1||s!==2)&&B(e,t,r,0,1,2)}function wt(e,t,r=!0){const n=t.length/3;return B(e,(c,s)=>G(c,t[3*s+0],t[3*s+1],t[3*s+2]),r?n-1:n)}const nt=.99619469809,_=m(),h=m(),N=m(),A=m(),F=m();function Vt(e,t,r){return t!==e&&tt(e,t),e[3]=-u(e,r),e}function dt(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function yt(e,t,r,n){return x(N,t,e),et(r,N,n)}function Xt(e,t,r,n){return d(e,t,M(f.get(),r,t),it,n)}function bt(e,t,r){return t!=null&&d(e,t.origin,t.direction,st,r)}function Ct(e,t,r){return d(e,t.origin,t.vector,a.NONE,r)}function Lt(e,t,r){return d(e,t.origin,t.vector,a.CLAMP,r)}function jt(e,t){return V(e,t)>=0}function vt(e,t){const r=u(e,t.ray.direction),n=-V(e,t.ray.origin);if(n<0&&r>=0)return!1;if(r>-1e-6&&r<1e-6)return n>0;if((n<0||r<0)&&!(n<0&&r<0))return!0;const c=n/r;return r>0?c<t.c1&&(t.c1=c):c>t.c0&&(t.c0=c),t.c0<=t.c1}function Ot(e,t){const r=u(e,t.ray.direction),n=-V(e,t.ray.origin);if(r>-1e-6&&r<1e-6)return n>0;const c=n/r;return r>0?c<t.c1&&(t.c1=c):c>t.c0&&(t.c0=c),t.c0<=t.c1}function qt(e,t,r){const n=w(f.get(),e,-e[3]),c=ct(e,M(f.get(),t,n),f.get());return z(r,c,n),r}function xt(e,t,r,n){const c=e,s=f.get(),i=f.get();Y(c,s,i);const o=M(f.get(),r,t),E=j(s,o),l=j(i,o),g=j(c,o);return G(n,E,l,g)}function ct(e,t,r){const n=w(f.get(),e,u(e,t));return M(r,t,n),r}function zt(e,t){return Math.abs(V(e,t))}function V(e,t){return u(e,t)+e[3]}function d(e,t,r,n,c){const s=u(e,r);if(s===0)return!1;let i=-(u(e,t)+e[3])/s;return n&a.CLAMP&&(i=D(i,0,1)),!(!(n&a.INFINITE_MIN)&&i<0||!(n&a.INFINITE_MAX)&&i>1)&&(z(c,t,w(c,r,i)),!0)}const P=[0,0,1,0];var a;(function(e){e[e.NONE=0]="NONE",e[e.CLAMP=1]="CLAMP",e[e.INFINITE_MIN=4]="INFINITE_MIN",e[e.INFINITE_MAX=8]="INFINITE_MAX"})(a||(a={}));const it=a.INFINITE_MIN|a.INFINITE_MAX,st=a.INFINITE_MAX;export{tt as A,Lt as B,jt as D,Q as E,Ft as F,vt as G,Ot as H,qt as J,xt as K,Vt as O,ct as Q,zt as R,bt as S,k as T,yt as U,V,B as X,Tt as _,j as a,rt as b,f as c,lt as d,Et as e,_t as f,wt as g,et as j,pt as m,Pt as o,dt as q,Z as r,gt as t,At as v,Xt as w,Ct as z};
