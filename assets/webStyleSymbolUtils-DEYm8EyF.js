import{c as R,a as S}from"./devEnvironmentUtils-CnNDiFMM.js";import{s as y}from"./Accessor-BHnuXKD2.js";import{I as u,p as w,R as U}from"./cast-BA_-jlhc.js";import{C as D}from"./Portal-CTRRujjZ.js";import{m as v}from"./jsonUtils-Dzgxk9pw.js";import{S as x,e as N,i as $}from"./Graphic-CFXUQZlS.js";import{i as A,p as F,m as O,h as M,y as W}from"./styleUtils-BB-zx7mT.js";import{e as k}from"./webStyleAcceptedFormats-CG7ZQ6BV.js";import"./index-tefRSezt.js";import"./JSONSupport-CGdeqxpk.js";import"./Promise-CmQqe-ke.js";import"./writer-B2bQV2uU.js";import"./Extent-CBBGeHb-.js";import"./Point-XGrwlf63.js";import"./layerUtils-dJgsXxkC.js";import"./TextSymbol-BQ_NW9Xo.js";import"./Color-gncXBiLc.js";import"./colorUtils-Rxh2V3ai.js";import"./mathUtils-DV9iOXpW.js";import"./enumeration-Cr5WIZs4.js";import"./screenUtils-_ZIvrt5o.js";import"./reactiveUtils-BR0C1Kq4.js";import"./Evented-DCWccWGU.js";import"./SimpleObservable-7oieNGD8.js";import"./defaults-Dwxdhopq.js";import"./defaultsJSON-GKolV7NZ.js";import"./Clonable-DvJsj5LF.js";import"./opacityUtils-CSd4XoR2.js";import"./ActionToggle-__-l4AdQ.js";import"./Identifiable-BrT7zvUW.js";import"./jsonUtils-Cu7OBRmN.js";import"./Polyline-BmuD2-ZN.js";import"./typeUtils-BSg8Y507.js";import"./collectionUtils-CbaToa73.js";import"./vec3f64-BLpZdpfb.js";import"./aaBoundingBox-CeBivBRq.js";function Dt(o,t,r){const e=o.name;return e==null?Promise.reject(new y("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):o.styleName==="Esri2DPointSymbolsStyle"?B(e,t,r):A(o,t,r).then(m=>z(m,e,t,W,r))}function q(o,t){return t.items.find(r=>r.name===o)}async function z(o,t,r,e,m){var h,g;const a=(r==null?void 0:r.portal)!=null?r.portal:D.getDefault(),i={portal:a,url:u(o.baseUrl),origin:"portal-item"},n=q(t,o.data);if(!n)throw new y("symbolstyleutils:symbol-name-not-found",`The symbol name '${t}' could not be found`,{symbolName:t});const c=(m==null?void 0:m.acceptedFormats)??k,b=e(n,c);if(!b)throw new y("symbolstyleutils:symbol-reference-no-accepted-format",`The symbol name '${t}' does not have an accepted format (one of ${c})`,{symbolName:t});const{url:P,format:T}=b;let s=w(P,i),p=((h=n.thumbnail)==null?void 0:h.href)??null;const f=(g=n.thumbnail)==null?void 0:g.imageData;R()&&(s=S(s)??"",p=S(p));const C={portal:a,url:u(U(s)),origin:"portal-item"};return F(s,m).then(d=>{const E=T==="cim"?O(d.data):d.data,l=v(E,C);if(l&&x(l)){if(p){const I=w(p,i);l.thumbnail=new N({url:I})}else f&&(l.thumbnail=new N({url:`data:image/png;base64,${f}`}));o.styleUrl?l.styleOrigin=new $({portal:r.portal,styleUrl:o.styleUrl,name:t}):o.styleName&&(l.styleOrigin=new $({portal:r.portal,styleName:o.styleName,name:t}))}return l})}function B(o,t,r){const e=M.replaceAll(/\{SymbolName\}/gi,o),m=t.portal!=null?t.portal:D.getDefault();return F(e,r).then(a=>{const i=O(a.data);return v(i,{portal:m,url:u(U(e)),origin:"portal-item"})})}export{z as fetchSymbolFromStyle,q as getStyleItemFromStyle,Dt as resolveWebStyleSymbol};
