import{I as c}from"./projection-CyCZAIaD.js";import{a as g}from"./ElevationProvider-aS5xrHHy.js";import{q as f}from"./mat4-Fi6iAz29.js";import{e as y}from"./mat4f64-Dk4dwAN8.js";import{o as h,E as _}from"./vec32-Dvg_eL9J.js";import{n,_ as C}from"./vec3f64-BLpZdpfb.js";import{r as P}from"./vec4f64-o2zAXfmz.js";import{a as w}from"./Object3DVisualElement-D0-_EXFp.js";import{R as O,b as R}from"./line-BiDIlUeT.js";import{p as G}from"./Material-C_-mgXN8.js";import{W as v}from"./RibbonLine.glsl-DwJpAQ1c.js";function k(d,e,r,t=!1){const s=c(d,e);return s==null?null:(s.hasZ&&!t||r==null||(s.z=g(r,s)??0),s)}function T(d,e,r){r.warnOnce(`Failed to project analysis geometry (id: '${d.id}'), projection from spatial reference (wkid: '${e.wkid}') to view spatial reference is not supported. Projection may be possible after calling projection.load().`)}class q extends w{constructor(e,r){super(e),this._hasExternalMaterial=!1,this._hasExternalMaterial=r!=null,this._material=r??new v({width:1,color:P(1,0,1,1),stipplePreferContinuous:!0,isClosed:!1,falloff:0,innerWidth:1,hasPolygonOffset:!1,renderOccluded:G.OccludeAndTransparent,isDecoration:!!e.isDecoration,writeDepth:!0}),this.applyProperties(e)}setGeometryFromPoint(e,r=1e3){const t=n();this.view.renderCoordsHelper.toRenderCoords(e,t)&&this.setGeometryFromRenderSpacePoint(t,r)}setGeometryFromRenderSpacePoint(e,r=1e3){this.geometry=[[[e[0]-r,e[1],e[2]],[e[0]+r,e[1],e[2]]],[[e[0],e[1]-r,e[2]],[e[0],e[1]+r,e[2]]],[[e[0],e[1],e[2]-r],[e[0],e[1],e[2]+r]]]}setGeometryFromExtent(e){const r=this.view.spatialReference,t=n(),s=n(),i=100,o=[];h(t,e[0],e[1],i),this.view.renderCoordsHelper.toRenderCoords(t,r,s),o.push([s[0],s[1],s[2]]),h(t,e[2],e[1],i),this.view.renderCoordsHelper.toRenderCoords(t,r,s),o.push([s[0],s[1],s[2]]),h(t,e[2],e[3],i),this.view.renderCoordsHelper.toRenderCoords(t,r,s),o.push([s[0],s[1],s[2]]),h(t,e[0],e[3],i),this.view.renderCoordsHelper.toRenderCoords(t,r,s),o.push([s[0],s[1],s[2]]),h(t,e[0],e[1],i),this.view.renderCoordsHelper.toRenderCoords(t,r,s),o.push([s[0],s[1],s[2]]),h(t,e[0],e[1],i),this.view.renderCoordsHelper.toRenderCoords(t,r,s),o.push([s[0],s[1],s[2]]),this.geometry=[o]}setGeometryFromFrustum(e){const r=[];e.lines.forEach(t=>{r.push([t.origin[0],t.origin[1],t.origin[2]]),r.push([t.endpoint[0],t.endpoint[1],t.endpoint[2]])}),this.geometry=[r]}setGeometryFromBoundedPlane(e){const r=[],t=e.origin,s=e.basis1,i=e.basis2,o=.5,a=n(),l=n(),m=n(),p=n();a[0]=t[0]-s[0]*o-i[0]*o,a[1]=t[1]-s[1]*o-i[1]*o,a[2]=t[2]-s[2]*o-i[2]*o,l[0]=t[0]-s[0]*o+i[0]*o,l[1]=t[1]-s[1]*o+i[1]*o,l[2]=t[2]-s[2]*o+i[2]*o,m[0]=t[0]+s[0]*o+i[0]*o,m[1]=t[1]+s[1]*o+i[1]*o,m[2]=t[2]+s[2]*o+i[2]*o,p[0]=t[0]+s[0]*o-i[0]*o,p[1]=t[1]+s[1]*o-i[1]*o,p[2]=t[2]+s[2]*o-i[2]*o,r.push([a[0],a[1],a[2]]),r.push([l[0],l[1],l[2]]),r.push([m[0],m[1],m[2]]),r.push([p[0],p[1],p[2]]),r.push([a[0],a[1],a[2]]),this.geometry=[r]}setGeometryFromSegment(e){const r=e.endRenderSpace;this.transform=f(u,r);const{points:t}=e.createRenderGeometry(r,this.view.renderCoordsHelper);this.geometry=[t]}setGeometryFromSegments(e,r=C){this.transform=f(u,r),this.geometry=e.map(t=>t.createRenderGeometry(r,this.view.renderCoordsHelper).points)}getTransformedGeometry(){return this._geometry==null?null:this._geometry.map(e=>e.map(r=>_(n(),r,this.transform)))}get renderOccluded(){return this._material.parameters.renderOccluded}set renderOccluded(e){this._material.setParameters({renderOccluded:e})}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.recreateGeometry()}get width(){return this._material.parameters.width}set width(e){this._material.setParameters({width:e})}get color(){return this._material.parameters.color}set color(e){const r=e[3]===1;this._material.setParameters({color:e,writeDepth:r})}get innerWidth(){return this._material.parameters.innerWidth}set innerWidth(e){this._material.setParameters({innerWidth:e})}get innerColor(){return this._material.parameters.innerColor}set innerColor(e){this._material.setParameters({innerColor:e})}get stipplePattern(){return this._material.parameters.stipplePattern}set stipplePattern(e){this._material!=null&&this._material.setParameters({stipplePattern:e})}get stippleOffColor(){return this._material.parameters.stippleOffColor}set stippleOffColor(e){this._material.setParameters({stippleOffColor:e})}get stipplePreferContinuous(){return this._material.parameters.stipplePreferContinuous}set stipplePreferContinuous(e){this._material.setParameters({stipplePreferContinuous:e})}get falloff(){return this._material.parameters.falloff}set falloff(e){this._material.setParameters({falloff:e})}get polygonOffset(){return this._material.parameters.hasPolygonOffset}set polygonOffset(e){this._material.setParameters({hasPolygonOffset:e})}createExternalResources(){}destroyExternalResources(){}createGeometries(e){for(const r of O(this.geometry)){const t=R(this._material,r);e.addGeometry(t)}}forEachExternalMaterial(e){this._hasExternalMaterial||e(this._material)}}const u=y();export{q as d,k as r,T as t};
