const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./time-zones-Ddu0PvRY.js","./index-p4VH55K1-e5RoWDws.js","./index-DFrluMIY.js","./index-mL0evDQ4.js","./region-BWroGId0.js","./index-g4YtFzIU.js"])))=>i.map(i=>d[i]);
import"./index-DwIhxbHs.js";import"./index-fFnlo_g2.js";import"./index-BtUFGore.js";import"./index-BYx-hdGk.js";import"./index-CP8r2QEY.js";import"./index-Cl5r3sNd.js";import{L as M,c as g,q as V,E as x,x as y,s as k,i as U,_ as f}from"./index-4eY77cms.js";import{S as A}from"./jsxFactory-Cnml7uXM.js";import{n as N}from"./ref-D9wHsL_T.js";import{c as L}from"./repeat-B6KIBwLP.js";import{i as G}from"./keyed-CU1C-h1n.js";import{v as q,T as W}from"./label-CHHpnzD0.js";import{m as j,p as Q}from"./interactive-DTzfFku4.js";import{r as H}from"./loadable-XBvaWFYY.js";import{D as J,O as K,W as X,B as Y}from"./form-BzoUrXC7.js";import{s as ee}from"./useT9n-C1Hrfc-A.js";import{Q as te}from"./locale-CXx8I9ox.js";import"./dom-DEluURzl.js";import"./guid-ejniuQmw.js";import"./observers-Co4E8E8j.js";import"./key-CZcQa38B.js";import"./component-CBVlbUuE.js";import"./live-D7NQ-TrC.js";import"./directive-helpers-DaBykg1t.js";import"./core-zHisM37C.js";import"./filter-D4A4y0z5.js";import"./escapeRegExp-CdLjXKbf.js";import"./debounce-DbkufipY.js";import"./floating-ui-IixYHfbQ.js";import"./openCloseComponent-nqWrSaIH.js";import"./Validation-BYp9DS84.js";import"./utils3-Iojtwv7b.js";import"./text-C54aRk62.js";import"./Accessor-BmwT4B0c.js";import"./intl-Duiy0OzY.js";import"./Promise-DfET-uns.js";import"./cast-CsZslgGN.js";import"./JSONSupport-DcrLLGjL.js";import"./Evented-Dw4_VOGn.js";import"./reactiveUtils-XM7cS2OP.js";import"./SimpleObservable-CvOkykwM.js";import"./uuid-Cl5lrJ4c.js";/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.0.3 */const oe={offset:"offset"},ie=60;function $(o){return o.replace(":15",".25").replace(":30",".5").replace(":45",".75").replace("âˆ’","-")}function ae(o,e){const t=w(o,"en-US",e).replace("GMT","");return t===""?0:Number($(t))*ie}function se(){return new Date().getTimezoneOffset()*-1}function ne(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}async function le(o){if(o==="offset")return t=>t;const{normalize:e}=await f(async()=>{const{normalize:t}=await import("./time-zones-Ddu0PvRY.js");return{normalize:t}},__vite__mapDeps([0,1]),import.meta.url);return e}async function re(o,e,t,i,l){if(t==="name"){const{groupByName:n}=await f(async()=>{const{groupByName:a}=await import("./index-DFrluMIY.js");return{groupByName:a}},__vite__mapDeps([2,0,1]),import.meta.url);return(await n()).map(({label:a})=>({label:a,value:a,metadata:{filterValue:a}})).filter(a=>!!a).sort()}const d=l==="user"?o:l==="utc"?"fr":"en-GB",p=i.getTime();if(t==="region"){const[{groupByRegion:n},{getCountry:a,global:m}]=await Promise.all([f(()=>import("./index-mL0evDQ4.js"),__vite__mapDeps([3,0,1,4]),import.meta.url),f(()=>import("./region-BWroGId0.js"),__vite__mapDeps([4,1]),import.meta.url)]);return(await n()).map(({label:s,tzs:c})=>(c.sort((r,h)=>{const T=I(r,e),C=I(h,e),u="Etc/GMT";if(r.startsWith(u)&&h.startsWith(u)){const b=r.substring(u.length),P=h.substring(u.length),F=b===""?0:parseInt(b);return(P===""?0:parseInt(P))-F}return T.localeCompare(C)}),{label:_(e,s),items:c.map(r=>{const h=$(w(r,d,p)),T=I(r,e),C=s===m?`${I(m,e)} Etc`:B(r),u=a(r),b=_(e,u);return{label:T,value:r,metadata:{country:b===T?void 0:b,filterValue:C,offset:h}}})})).sort((s,c)=>s.label===m?-1:c.label===m?1:s.label.localeCompare(c.label))}const[{groupByOffset:Z},{DateEngine:R}]=await Promise.all([f(()=>import("./index-g4YtFzIU.js"),__vite__mapDeps([5,0,1,4]),import.meta.url),f(()=>import("./index-Bx95W_6e.js"),[],import.meta.url)]),E=await Z({dateEngine:new R,groupDateRange:1,startDate:new Date(p).toISOString()}),S=new Intl.ListFormat(o,{style:"long",type:"conjunction"}),D=["Factory","Etc/UTC"];return E.forEach(n=>{const a=[];let m=0;n.tzs.forEach((s,c)=>{D.includes(s)&&m++,a[c]=m}),n.tzs=n.tzs.filter(s=>!D.includes(s)),n.labelTzIdx=n.labelTzIdx.map(s=>s-a[s]).filter(s=>s>=0&&s<n.tzs.length)}),E.map(({labelTzIdx:n,tzs:a})=>{const m=a[0],s=$(w(m,d,p)),c=ae(m,p),r=n.map(h=>I(a[h],e));return{label:he(e,s,S.format(r)),value:c,metadata:{filterValue:a.map(h=>B(h))}}}).filter(n=>!!n).sort((n,a)=>n.value-a.value)}function I(o,e){return e[o]||ce(o)}function me(o,e,t){return t.timeZoneRegionLabel.replace("{city}",o).replace("{country}",_(t,e))}function _(o,e){return o[e]||e}function ce(o){return o.split("/").pop()}function B(o){return o.replace(/_/g," ")}function he(o,e,t){return o.timeZoneLabel.replace("{offset}",e).replace("{cities}",t)}function w(o,e,t=Date.now()){return o==="Factory"&&(o="Etc/GMT"),te(e,{timeZone:o,timeZoneName:"shortOffset"}).formatToParts(t).find(({type:i})=>i==="timeZoneName").value}function pe(o){return o.items!==void 0}function de(o){return pe(o[0])?o.flatMap(e=>e.items):o}function z(o,e,t){return t==null?null:de(o).find(i=>i[e]==t)}const ue=U`:host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{display:block}.offset{white-space:nowrap}:host([hidden]){display:none}[hidden]{display:none}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}::slotted(input[slot=hidden-form-input]){margin:0!important;opacity:0!important;outline:none!important;padding:0!important;position:absolute!important;inset:0!important;transform:none!important;-webkit-appearance:none!important;z-index:-1!important}`,v=class v extends M{constructor(){super(...arguments),this.clearable=!1,this.disabled=!1,this.maxItems=0,this.messages=ee({blocking:!0}),this.mode="offset",this.offsetStyle="user",this.open=!1,this.overlayPositioning="absolute",this.readOnly=!1,this.required=!1,this.scale="m",this.status="idle",this.validity={valid:!1,badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1},this.calciteInputTimeZoneBeforeClose=g({cancelable:!1}),this.calciteInputTimeZoneBeforeOpen=g({cancelable:!1}),this.calciteInputTimeZoneChange=g({cancelable:!1}),this.calciteInputTimeZoneClose=g({cancelable:!1}),this.calciteInputTimeZoneOpen=g({cancelable:!1})}get value(){return this._value}set value(e){this._value=e}async setFocus(){await H(this),await this.comboboxEl.setFocus()}connectedCallback(){super.connectedCallback(),J(this),q(this)}async load(){this.normalizer=await le(this.mode),await this.updateTimeZoneItems();const e=this.value,t=this.normalizeValue(e);this.value=t||(e===""?t:void 0),this.updateTimeZoneSelection();const i=this.selectedTimeZoneItem?`${this.selectedTimeZoneItem.value}`:"";K(this,i),this.value=i}willUpdate(e){e.has("value")&&this.hasUpdated&&this.handleValueChange(this.value,e.get("value")),(e.has("messages")||e.has("mode")&&(this.hasUpdated||this.mode!=="offset")||e.has("referenceDate"))&&this.handleTimeZoneItemPropsChange(),e.has("open")&&(this.hasUpdated||this.open!==!1)&&this.openChanged()}updated(){j(this)}loaded(){this.overrideSelectedLabelForRegion(this.open),this.openChanged()}disconnectedCallback(){super.disconnectedCallback(),X(this),W(this)}async handleTimeZoneItemPropsChange(){!this.timeZoneItems||!this.hasUpdated||(await this.updateTimeZoneItems(),this.updateTimeZoneSelection())}openChanged(){this.comboboxEl&&(this.comboboxEl.open=this.open)}async handleValueChange(e,t){const i=this.normalizeValue(e);if(!i){if(this.clearable){this._value=i,this.selectedTimeZoneItem=null;return}this._value=t,this.selectedTimeZoneItem=this.findTimeZoneItem(t);return}const l=this.findTimeZoneItem(i);if(!l){this._value=t;return}this._value=i,this.selectedTimeZoneItem=l,i!==e&&(await this.updateComplete,this.overrideSelectedLabelForRegion(this.open))}onLabelClick(){this.setFocus()}setComboboxRef(e){this.comboboxEl=e}overrideSelectedLabelForRegion(e){if(this.mode!=="region"||!this.selectedTimeZoneItem)return;const{label:t,metadata:i}=this.selectedTimeZoneItem;this.comboboxEl.selectedItems[0].textLabel=!i.country||e?t:me(t,i.country,this.messages)}onComboboxBeforeClose(e){e.stopPropagation(),this.overrideSelectedLabelForRegion(!1),this.calciteInputTimeZoneBeforeClose.emit()}onComboboxBeforeOpen(e){e.stopPropagation(),this.overrideSelectedLabelForRegion(!0),this.calciteInputTimeZoneBeforeOpen.emit()}onComboboxChange(e){e.stopPropagation();const t=e.target.selectedItems[0];if(!t){this._value="",this.selectedTimeZoneItem=null,this.calciteInputTimeZoneChange.emit();return}const i=this.findTimeZoneItemByLabel(t.getAttribute("data-label")),l=`${i.value}`;this.value===l&&i.label===this.selectedTimeZoneItem.label||(this._value=l,this.selectedTimeZoneItem=i,this.calciteInputTimeZoneChange.emit())}onComboboxClose(e){e.stopPropagation(),this.open=!1,this.calciteInputTimeZoneClose.emit()}onComboboxOpen(e){this.open=!0,e.stopPropagation(),this.calciteInputTimeZoneOpen.emit()}findTimeZoneItem(e){return z(this.timeZoneItems,"value",e)}findTimeZoneItemByLabel(e){return z(this.timeZoneItems,"label",e)}async updateTimeZoneItems(){this.timeZoneItems=await this.createTimeZoneItems()}updateTimeZoneSelection(){if(this.value===""&&this.clearable){this.selectedTimeZoneItem=null;return}const e=this.mode==="offset"?se():ne(),t=this.value===""||!this.value?e:this.value;this.selectedTimeZoneItem=this.findTimeZoneItem(t)||this.findTimeZoneItem(e)}async createTimeZoneItems(){return!this.messages._lang||!this.messages?[]:re(this.messages._lang,this.messages,this.mode,this.referenceDate instanceof Date?this.referenceDate:new Date(this.referenceDate??Date.now()),this.offsetStyle)}normalizeValue(e){return e=e===void 0?"":e,e&&this.normalizer(e)}render(){return Q({disabled:this.disabled,children:y`<calcite-combobox .clearDisabled=${!this.clearable} .disabled=${this.disabled} .label=${this.messages.chooseTimeZone} lang=${this.messages._lang??x} .maxItems=${this.maxItems} @calciteComboboxBeforeClose=${this.onComboboxBeforeClose} @calciteComboboxBeforeOpen=${this.onComboboxBeforeOpen} @calciteComboboxChange=${this.onComboboxChange} @calciteComboboxClose=${this.onComboboxClose} @calciteComboboxOpen=${this.onComboboxOpen} .overlayPositioning=${this.overlayPositioning} .placeholder=${this.mode==="name"?this.messages.namePlaceholder:this.mode==="offset"?this.messages.offsetPlaceholder:this.messages.regionPlaceholder} placeholder-icon=search .readOnly=${this.readOnly} .scale=${this.scale} .selectionMode=${this.clearable?"single":"single-persist"} .status=${this.status} .validationIcon=${this.validationIcon} .validationMessage=${this.validationMessage} ${N(this.setComboboxRef)}>${this.renderItems()}</calcite-combobox>${Y({component:this})}`})}renderItems(){return this.mode==="region"?this.renderRegionItems():L(this.timeZoneItems,({label:e})=>e,e=>{const t=this.selectedTimeZoneItem===e,{label:i,metadata:l,value:d}=e;return y`<calcite-combobox-item data-label=${i??x} .metadata=${l} .selected=${t} .textLabel=${i} .value=${d}></calcite-combobox-item>`})}renderRegionItems(){return this.timeZoneItems.flatMap(({label:e,items:t})=>G(e,y`<calcite-combobox-item-group .label=${e}>${L(t,({label:i})=>i,i=>{const l=this.selectedTimeZoneItem===i,{label:d,metadata:p,value:Z}=i;return y`<calcite-combobox-item data-label=${d??x} .description=${p.country} .metadata=${p} .selected=${l} .textLabel=${d} .value=${Z}><span class=${k(oe.offset)} slot=content-end>${p.offset}</span></calcite-combobox-item>`})}</calcite-combobox-item-group>`))}};v.properties={clearable:7,disabled:7,form:3,maxItems:11,messageOverrides:0,mode:3,name:3,offsetStyle:3,open:7,overlayPositioning:3,readOnly:7,referenceDate:1,required:7,scale:3,status:3,validationIcon:[3,{converter:V}],validationMessage:1,validity:0,value:1},v.shadowRootOptions={mode:"open",delegatesFocus:!0},v.styles=ue;let O=v;A("calcite-input-time-zone",O);export{O as InputTimeZone};
