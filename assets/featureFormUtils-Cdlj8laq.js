import{s as b}from"./intl-CChhNOV8.js";import{Q as f,O as V,l as x,n as E,v as _}from"./subclass-BZA_h8Db.js";import{n as L}from"./compilerUtils-Dw3R0f-Z.js";import{t as j}from"./formUtils-ylzKAM7E.js";import{b as I,k as R,l as F,n as g,o as A,E as U}from"./fieldUtils-tmQlKvWo.js";import{P as Z}from"./layerUtils-BrNoooE9.js";import{$ as w}from"./utils-BwQ00KBJ.js";const C=e=>(e==null?void 0:e.type)==="field",h=e=>(e==null?void 0:e.type)==="group",D=e=>(e==null?void 0:e.type)==="relationship",K=e=>e.type==="text",Q=e=>!h(e)&&e.group!=null,v=e=>e.reduce((t,n)=>h(n)?[...t,...n.inputs]:[...t,n],[]),X=e=>v(e).filter(C),ee=e=>v(e).filter(D),te=e=>e!=null&&(p(e,"combo-box")||p(e,"radio-buttons")),p=(e,t)=>{var n;return e!=null&&((n=e.input)==null?void 0:n.type)===t},ne=e=>e!=null&&(p(e,"text-box")||p(e,"text-area")),re=({domain:e,inputType:t="text-box",dataType:n})=>n==="number"&&t==="text-box"&&(!e||e.type!=="coded-value");function ie(e){const{attributes:t,fieldsIndex:n,label:r,timeZone:i}=e;if(!t||typeof t!="object")return r;const o=Object.keys(t).filter(a=>f(r,a)),l=o.map(a=>t[a]),u=o.map(a=>n.get(a)).filter(V);return k(r,P({values:l,fields:u,timeZone:i}))}const d="expression/",G="expr/",S="field/";function oe(e){const[t,n]=e.split(d);return t===""&&n?n:(E.getLogger("esri.widgets.FeatureForm/featureFormUtils").error("extractExpressionNameFromString:invalid-input",`The string ${e} is not a valid expression reference of the form '${d}/expressionName'`),"")}function ae(e){return`${d}${e}`}function le(e){return`${S}${e}`}function ue(e){return e.startsWith(d)}function se(e){return e.startsWith(G)}function P(e){const{fields:t,values:n}=e,r=e.timeZone??void 0,i=t.map((o,l)=>{let u=n[l];if(o.domain&&o.domain.type==="coded-value"){const a=o.domain.codedValues.find(m=>m.code===u);a!=null&&a.name&&(u=a.name)}return(w(o)||I(o))&&(u=R(o,u,{timeZone:r,...F(o)})),[o.name,u]});return Object.fromEntries(i)}function k(e,t){return x(x(e,n=>`{${n.toLowerCase()}}`),Object.fromEntries(Object.entries(t).map(([n,r])=>[n.toLowerCase(),r])))}const me=e=>{var n,r,i,o;const t={typeFieldName:null,types:[]};return e&&(e.type==="subtype-sublayer"?(t.typeFieldName=(n=e.parent)==null?void 0:n.subtypeField,t.types=((r=e.parent)==null?void 0:r.subtypes)??[]):e.type==="subtype-group"||e.type==="feature"&&((i=e.subtypes)!=null&&i.length)?(t.typeFieldName=e.subtypeField,t.types=e.subtypes??[]):"types"in e&&e.types&&(t.typeFieldName=e.typeIdField,t.types=e.types.map(({id:l,name:u,domains:a})=>({code:l,name:u,domains:a}))),t.typeFieldName!=null&&(t.typeFieldName=((o=e.getField(t.typeFieldName))==null?void 0:o.name)??t.typeFieldName)),t};var c;(function(e){e.TOO_SHORT="length-validation-error::too-short",e.TOO_LONG="length-validation-error::too-long"})(c||(c={}));const O={type:"number"},T={type:"number",intlOptions:{notation:"scientific"}};function $(e){return e>=1e7||e<=-1e7}function H(e,{validationErrors:t}){return e.max!=null&&e.min!=null?t.outsideRange:e.max!=null?t.outsideRangeMax:t.outsideRangeMin}const pe=(e,t,n)=>{const{dataType:r,error:i,minLength:o,value:l,required:u}=e,a=t==null?void 0:t.validationErrors;if(!a||!i)return null;if(u&&l===null)return a.cannotBeNull;if(i===g.VALUE_OUT_OF_RANGE||i===A.OUT_OF_RANGE){const{field:m,range:s}=e,y={type:"date",intlOptions:{timeZone:m.type==="date"&&n?n:void 0,...F(m)}},N=H(s,t);return b(N,s,{format:{max:r==="date"?y:s.max!=null&&$(s.max)?T:O,min:r==="date"?y:s.min!=null&&$(s.min)?T:O}})}return i===g.INVALID_CODED_VALUE?a.invalidCodedValue:i===U.INVALID_TYPE?a.invalidType:i===c.TOO_SHORT?b(a.tooShort,{min:o}):(c.TOO_LONG,null)},de=e=>{var i;if(!e)return;const t=e.layer,n=t&&"geometryType"in t?t.geometryType:void 0,r=(i=e.geometry)==null?void 0:i.type;return r==="polyline"||n==="polyline"?"line":r==="mesh"||n==="mesh"||n==="multipatch"?"cube":r==="multipoint"||n==="multipoint"?"point":r||n||"table"},ce=e=>{var n;const t=[];if(e.formTemplate){const{description:r,title:i}=e.formTemplate;(n=e.fields)==null||n.forEach(o=>{const l=i&&f(i,o.name),u=r&&f(r,o.name);(l||u)&&t.push(o.name)})}return t};function fe(e,t){var r;const n=t??("formTemplate"in e&&e.formTemplate);return n?(((r=n.elements)==null?void 0:r.filter(j))??[]).some(({fieldName:i})=>!e.fieldsIndex.get(i)):!1}function ye(e,t){return e==null||t.onValue!==e&&t.offValue!==e}function be(e,t){var n;switch(t.objectType){case"any":return!0;case"null":return e==null;case"code":return e===((n=t.codedValue)==null?void 0:n.code);case"range":return e!=null&&t.minValue!=null&&t.maxValue!=null&&+e>=t.minValue&&+e<=t.maxValue;default:return L(t.objectType),!1}}function xe(e,t,n){const r=Z(e),i=r==null?void 0:r.find(l=>l.code===n);if(!i)return!1;const o=r==null?void 0:r.find(l=>l.code===t);return!_(i.defaultValues,o==null?void 0:o.defaultValues)&&Object.values(i.defaultValues).some(l=>l!=null)}export{ae as $,le as A,de as B,P as C,re as E,ee as F,me as G,be as J,xe as K,te as N,K as O,ce as P,oe as R,c as S,Q as T,ie as U,ne as V,fe as Y,ue as Z,C as b,h as g,p as h,v as j,pe as q,X as v,se as w,D as x,ye as z};
