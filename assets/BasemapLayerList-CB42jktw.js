const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./calcite-action-Bys6x4p_.js","./action-D0Er9Ef6.js","./jsxFactory-CJa39Fro.js","./tslib.es6-B3Jf3DVX.js","./intl-CChhNOV8.js","./date-DlqISzcw.js","./jsonMap-0cxwUWs2.js","./subclass-BZA_h8Db.js","./locale-C9TlLpzi.js","./messages-OmQvZhAg.js","./Accessor-BLX9ikPh.js","./assets-C43MgM-v.js","./index-Bh2oEzTI.js","./index-2kwcjS9-.css","./Evented-BHRw9x22.js","./Promise-B2Hu02L7.js","./reactiveUtils-C5zUhJQJ.js","./asyncUtils-CWX51uTe.js","./Collection-CEdjem1-.js","./shared-B3wH2qpO.js","./SimpleObservable-KocWTzVy.js","./uuid-fwrPAdZb.js","./cast-Bjksrh93.js","./dom-D_AJDzAj.js","./interactive-y84HQRWL.js","./loadable-DM18hPdE.js","./locale-A4FuYD8q.js","./key-D63ExP77.js","./observers-D2xgmA06.js","./component-6CIDVndn.js","./t9n-D0ry3MEw.js","./icon-BQO9J86c.js","./loader-C-zIPscB.js","./calcite-block-M0XyV5ob.js","./conditionalSlot-R5D9krYS.js","./Heading-D7P0OjYI.js","./openCloseComponent-CmOrfBN-.js","./floating-ui-Bma_zPVt.js","./debounce-BOqmhDXu.js","./action-menu-C6uYzPu-.js","./array-BMcQdnYi.js","./popover-Q5ruM4hh.js","./focusTrapComponent-BSUg_DLj.js","./FloatingArrow-BBdsG5MP.js","./handle-Ct1HP3bl.js","./scrim-DPa2aeKh.js","./calcite-label-B1FxWqaL.js","./label-DEe8AW1C.js","./calcite-input-DAafN6Cc.js","./input2-BReyTnf4.js","./form-BZPQ5PUM.js","./Validation-Bz9yoU6e.js","./input-j1u1wOBY.js","./input-message-CWvsvdFk.js","./progress-BXyickl_.js","./calcite-button-D_Agetwz.js","./button-9P4PM9SO.js","./calcite-flow-BrE9BG4l.js","./calcite-flow-item-B0xZ0mWX.js","./panel-BdAbXPwM.js","./calcite-list-C4jOVpC-.js","./resources4-DXHY1U7R.js","./utils3-BrU6GrkI.js","./filter-yN6-jZOU.js","./calcite-notice-DSp0z_Oh.js","./resources2-DjkgwdyM.js","./calcite-tooltip-rE_jVYtd.js","./CatalogLayerList-Dxbb5XPt.js","./Identifiable-B1UbsKNt.js","./ReactiveMap-6CfRGOlR.js","./ListItem-D2lt9R2a.js","./ActionToggle-iT4slXc7.js","./layerListUtils-Cb_jjipP.js","./widget-DwhGPDuv.js","./LayerListItem--SL5CZeX.js","./catalogUtils-DyGHPM81.js","./actionUtils-ClPpuZ4c.js","./globalCss-CZa70j6i.js","./listUtils-vswmtyNy.js","./vmEvent-D4Ubqkbq.js","./TableList-DZ1f1-tP.js"])))=>i.map(i=>d[i]);
import{_ as v}from"./index-Bh2oEzTI.js";import{r as o}from"./tslib.es6-B3Jf3DVX.js";import{V as R}from"./Collection-CEdjem1-.js";import{b as X,Y as P}from"./Accessor-BLX9ikPh.js";import{s as Z}from"./Identifiable-B1UbsKNt.js";import{m as a,a as j,n as $}from"./subclass-BZA_h8Db.js";import{s as ee}from"./ReactiveMap-6CfRGOlR.js";import{watch as C,initial as B,on as te}from"./reactiveUtils-C5zUhJQJ.js";import{B as ie,r as se,n as u,w as D,e as J}from"./jsxFactory-CJa39Fro.js";import{o as oe}from"./Evented-BHRw9x22.js";import{j as z}from"./ListItem-D2lt9R2a.js";import{h as K,u as ae,i as re,M as E,g as Q,p as le,c as ne}from"./layerListUtils-Cb_jjipP.js";import{_ as de}from"./LayerListItem--SL5CZeX.js";import{e as N}from"./globalCss-CZa70j6i.js";import{n as ce}from"./Heading-C-odFCu-.js";import{t as me}from"./listUtils-vswmtyNy.js";import{e as pe}from"./vmEvent-D4Ubqkbq.js";import"./shared-B3wH2qpO.js";import"./SimpleObservable-KocWTzVy.js";import"./asyncUtils-CWX51uTe.js";import"./intl-CChhNOV8.js";import"./date-DlqISzcw.js";import"./jsonMap-0cxwUWs2.js";import"./locale-C9TlLpzi.js";import"./messages-OmQvZhAg.js";import"./assets-C43MgM-v.js";import"./Promise-B2Hu02L7.js";import"./uuid-fwrPAdZb.js";import"./cast-Bjksrh93.js";import"./ActionToggle-iT4slXc7.js";import"./widget-DwhGPDuv.js";import"./catalogUtils-DyGHPM81.js";import"./actionUtils-ClPpuZ4c.js";import"./mathUtils-C4_ghTv4.js";const b={view:"view",basemap:"basemap",baseLayers:"base-layers",referenceLayers:"reference-layers",baseLayersListMode:"reference-layers-list-mode",referenceLayersListMode:"base-layers-list-mode",baseLayerViews:"base-layer-views",referenceLayerViews:"reference-layer-views",children:"children"},he="hide",S=R.ofType(z);let f=class extends oe.EventedAccessor{constructor(e){super(e),this.baseItems=new S,this.baseListItemCreatedFunction=null,this.checkPublishStatusEnabled=!1,this.listModeDisabled=!1,this.referenceListItemCreatedFunction=null,this.referenceItems=new S,this.view=null,this._compileBaseList=this._compileBaseList.bind(this),this._compileReferenceList=this._compileReferenceList.bind(this)}initialize(){this.addHandles([C(()=>{var e,t,i,s;return[(t=(e=this.view)==null?void 0:e.map)==null?void 0:t.basemap,((i=this.view)==null?void 0:i.ready)===!0,(s=this.view)==null?void 0:s.basemapView]},()=>this._watchBasemapLayers(),B),C(()=>[this.baseListItemCreatedFunction,this.checkPublishStatusEnabled,this.listModeDisabled],()=>this._baseListItemCreatedFunctionChanged()),C(()=>[this.referenceListItemCreatedFunction,this.checkPublishStatusEnabled,this.listModeDisabled],()=>this._referenceListItemCreatedFunctionChanged())],b.view)}destroy(){this.view=null,this._removeAllBaseItems(),this._removeAllReferenceItems()}get basemapTitle(){var e,t,i;return((i=(t=(e=this.view)==null?void 0:e.map)==null?void 0:t.basemap)==null?void 0:i.title)??null}set basemapTitle(e){this._override("basemapTitle",e)}get state(){var e;return(e=this.view)!=null&&e.ready?"ready":this.view?"loading":"disabled"}get totalBaseItems(){return this.baseItems.flatten(e=>e.children).length}get totalReferenceItems(){return this.referenceItems.flatten(e=>e.children).length}triggerAction(e,t){e&&!e.disabled&&this.emit("trigger-action",{action:e,item:t})}moveListItem({targetItem:e,fromParentItem:t,toParentItem:i,from:s,to:r,newIndex:n}){var x,O;const d=e==null?void 0:e.layer;if(!d||d.type==="subtype-sublayer"||d.type==="sublayer")return;const c=(O=(x=this.view)==null?void 0:x.map)==null?void 0:O.basemap,m=c==null?void 0:c.baseLayers,y=c==null?void 0:c.referenceLayers,_=t?K(t):s==="base"?m:y,p=i?K(i):r==="base"?m:y;if(!_||!p)return;const{baseItems:w,referenceItems:F}=this,h=s==="base"?w:F,M=r==="base"?w:F,V=(t==null?void 0:t.children)||h,k=(i==null?void 0:i.children)||M,A=p.length-n;e.parent=i||null,V.remove(e),_.remove(d),k.includes(e)||k.add(e,A),p.includes(d)||p.add(d,A),this._compileLists()}_createItemChangeHandles({items:e,key:t,callback:i}){this.removeHandles(t),i(),e&&this.addHandles(e.on("change",()=>i()),t)}_createListItem({layer:e,type:t}){const{view:i,baseListItemCreatedFunction:s,referenceListItemCreatedFunction:r,checkPublishStatusEnabled:n,listModeDisabled:d}=this;return new z({layer:e,checkPublishStatusEnabled:n,listItemCreatedFunction:t==="base"?s:r,listModeDisabled:d,view:i})}_watchLayersListMode({layers:e,key:t,callback:i}){this.removeHandles(t),e&&!this.listModeDisabled&&this.addHandles(C(()=>e.filter(s=>"listMode"in s).map(s=>s.listMode).toArray(),()=>i()),t)}_getViewableLayers(e){return e?this.listModeDisabled?e:e.filter(t=>ae(t)!==he):void 0}_compileListItems({layers:e,items:t,key:i,type:s,callback:r}){this._watchLayersListMode({layers:e,key:i,callback:r});const n=this._getViewableLayers(e);n!=null&&n.length?(this._createNewItems({type:s,items:t,layers:n}),this._removeItems({items:t,layers:n}),this._sortItems(t,n)):s==="base"?this._removeAllBaseItems():this._removeAllReferenceItems()}_compileReferenceList(){var i,s,r;const{referenceItems:e}=this,t=(r=(s=(i=this.view)==null?void 0:i.map)==null?void 0:s.basemap)==null?void 0:r.referenceLayers;this._compileListItems({type:"reference",layers:t,items:e,key:b.referenceLayersListMode,callback:this._compileReferenceList})}_compileBaseList(){var i,s,r;const{baseItems:e}=this,t=(r=(s=(i=this.view)==null?void 0:i.map)==null?void 0:s.basemap)==null?void 0:r.baseLayers;this._compileListItems({type:"base",layers:t,items:e,key:b.baseLayersListMode,callback:this._compileBaseList})}_compileLists(){this._compileReferenceList(),this._compileBaseList()}_createNewItems({items:e,layers:t,type:i}){t==null||t.forEach(s=>{e.some(r=>r.layer===s)||e.add(this._createListItem({type:i,layer:s}))})}_removeItems({items:e,layers:t}){e&&e.forEach(i=>{if(!i)return;(t==null?void 0:t.some(r=>i.layer===r))||(this.removeHandles(`${b.children}-${i.uid}`),e.remove(i),i.destroy())})}_sortItems(e,t){e&&t&&e.sort((i,s)=>{const r=t.indexOf(i.layer),n=t.indexOf(s.layer);return r>n?-1:r<n?1:0})}_removeAllBaseItems(){this.baseItems.drain(e=>{this.removeHandles(`${b.children}-${e.uid}`),e.destroy()})}_removeAllReferenceItems(){this.referenceItems.drain(e=>{this.removeHandles(`${b.children}-${e.uid}`),e.destroy()})}_baseListItemCreatedFunctionChanged(){this._removeAllBaseItems(),this._compileLists()}_referenceListItemCreatedFunctionChanged(){this._removeAllReferenceItems(),this._compileLists()}_watchBasemapLayers(){const{view:e}=this;if(this.removeHandles([b.baseLayers,b.referenceLayers,b.basemap,b.baseLayerViews,b.referenceLayerViews]),!(e!=null&&e.ready))return this._removeAllBaseItems(),void this._removeAllReferenceItems();this._compileLists(),this.addHandles([C(()=>{var t,i,s;return(s=(i=(t=this.view)==null?void 0:t.map)==null?void 0:i.basemap)==null?void 0:s.baseLayers},t=>this._createItemChangeHandles({items:t,key:b.baseLayers,callback:this._compileBaseList}),B),C(()=>{var t,i,s;return(s=(i=(t=this.view)==null?void 0:t.map)==null?void 0:i.basemap)==null?void 0:s.referenceLayers},t=>this._createItemChangeHandles({items:t,key:b.referenceLayers,callback:this._compileReferenceList}),B),C(()=>{var t,i;return(i=(t=this.view)==null?void 0:t.basemapView)==null?void 0:i.baseLayerViews},t=>this._createItemChangeHandles({items:t,key:b.baseLayerViews,callback:this._compileBaseList}),B),C(()=>{var t,i;return(i=(t=this.view)==null?void 0:t.basemapView)==null?void 0:i.referenceLayerViews},t=>this._createItemChangeHandles({items:t,key:b.referenceLayerViews,callback:this._compileReferenceList}),B)],b.basemap)}};o([a({type:S,readOnly:!0})],f.prototype,"baseItems",void 0),o([a()],f.prototype,"basemapTitle",null),o([a()],f.prototype,"baseListItemCreatedFunction",void 0),o([a()],f.prototype,"checkPublishStatusEnabled",void 0),o([a({nonNullable:!0})],f.prototype,"listModeDisabled",void 0),o([a()],f.prototype,"referenceListItemCreatedFunction",void 0),o([a({type:S,readOnly:!0})],f.prototype,"referenceItems",void 0),o([a({readOnly:!0})],f.prototype,"state",null),o([a()],f.prototype,"totalBaseItems",null),o([a()],f.prototype,"totalReferenceItems",null),o([a()],f.prototype,"view",void 0),f=o([j("esri.widgets.BasemapLayerList.BasemapLayerListViewModel")],f);const W=f;let g=class extends X{constructor(){super(...arguments),this.baseLayers=!0,this.catalogLayerList=!0,this.closeButton=!1,this.collapseButton=!1,this.editTitleButton=!1,this.errors=!1,this.filter=!1,this.flow=!0,this.heading=!0,this.referenceLayers=!0,this.statusIndicators=!0,this.temporaryLayerIndicators=!1}};o([a({type:Boolean,nonNullable:!0})],g.prototype,"baseLayers",void 0),o([a({type:Boolean,nonNullable:!0})],g.prototype,"catalogLayerList",void 0),o([a({type:Boolean,nonNullable:!0})],g.prototype,"closeButton",void 0),o([a({type:Boolean,nonNullable:!0})],g.prototype,"collapseButton",void 0),o([a({type:Boolean,nonNullable:!0})],g.prototype,"editTitleButton",void 0),o([a({type:Boolean,nonNullable:!0})],g.prototype,"errors",void 0),o([a({type:Boolean,nonNullable:!0})],g.prototype,"filter",void 0),o([a({type:Boolean,nonNullable:!0})],g.prototype,"flow",void 0),o([a({type:Boolean,nonNullable:!0})],g.prototype,"heading",void 0),o([a({type:Boolean,nonNullable:!0})],g.prototype,"referenceLayers",void 0),o([a({type:Boolean,nonNullable:!0})],g.prototype,"statusIndicators",void 0),o([a({type:Boolean,nonNullable:!0})],g.prototype,"temporaryLayerIndicators",void 0),g=o([j("esri.widgets.BasemapLayerList.BasemapLayerListVisibleElements")],g);const U=g,L="esri-basemap-layer-list",I=`${L}__item`,T={base:L,actionMenu:`${L}__action-menu`,actionGroup:`${L}__action-group`,filterNoResults:`${L}__filter-no-results`,item:I,itemActive:`${I}--active`,itemContent:`${I}-content`,itemContentBottom:`${I}-content-bottom`,itemMessage:`${I}-message`,itemInvisible:`${I}--invisible`,itemActionIcon:`${I}-action-icon`,itemActionImage:`${I}-action-image`,itemTableIcon:`${I}-table-icon`,itemTemporaryIcon:`${I}-temporary-icon`,itemCatalogIcon:`${I}-catalog-icon`,statusIndicator:`${L}__status-indicator`,publishing:`${L}__publishing`,updating:`${L}__updating`,editing:`${L}__editing`,connectionStatus:`${L}__connection-status`,connectionStatusConnected:`${L}__connection-status--connected`,visibleToggle:`${L}__visible-toggle`,visibleIcon:`${L}__visible-icon`,section:`${L}__section`},ue=R.ofType(z),ye=".*\\S+.*",G="data-basemap-layer-type";let l=class extends Z(ie){constructor(e,t){super(e,t),this._activeItem=null,this._tooltipReferenceMap=new Map,this._editTitleInput=null,this._focusRootFlowItem=!1,this._focusPanelFlowItem=!1,this._focusLayerFlowItem=null,this._focusEditingFlowItem=!1,this._layerListMap=new ee,this._lastDragDetail=null,this._selectedDragItemLayerUid=null,this._rootGroupUid=`basemap-${this.uid}`,this._openedLayersController=null,this.catalogLayerList=null,this.catalogOptions=null,this.collapsed=!1,this.dragEnabled=!1,this.editingTitle=!1,this.filterPlaceholder="",this.baseFilterText="",this.referenceFilterText="",this.listItemCanGiveFunction=null,this.listItemCanReceiveFunction=null,this.headingLevel=2,this.knowledgeGraphOptions=null,this.layerTablesEnabled=new R(["knowledge-graph"]),this.mapImageOptions=null,this.messages=null,this.messagesCommon=null,this.minFilterItems=re,this.openedLayers=new R,this.openedLayerLists=new R,this.tableList=null,this.selectedItems=new ue,this.selectionMode="none",this.tileOptions=null,this.viewModel=new W,this.visibilityAppearance="default",this.visibleElements=new U,this._canMove=({dragEl:i,fromEl:s,toEl:r},n)=>{var O,q,Y;const d=n==="pull"?this.listItemCanGiveFunction:this.listItemCanReceiveFunction,c=E(i);if(!(c!=null&&c.sortable))return!1;const m=E(s),y=Q(s),_=E(r),p=Q(r),w=!!y&&!!p&&y===p,F={selected:c,from:m,to:_},h=s.group,M=r.group,V=((O=m==null?void 0:m.layer)==null?void 0:O.type)??"",k=((q=_==null?void 0:_.layer)==null?void 0:q.type)??"",A=new Set(["map-image","catalog","knowledge-graph"]);return h&&M&&typeof d=="function"?d.call(null,F):w&&!A.has(V)&&!A.has(k)&&((Y=c==null?void 0:c.layer)==null?void 0:Y.type)!=="sublayer"},this._onTriggerAction=(i,s)=>{this.triggerAction(i,s)},this._onTooltipReferenceChange=(i,s)=>{s?this._tooltipReferenceMap.set(i,s):this._tooltipReferenceMap.delete(i)},this._onSelectedDragItemLayerUidChange=i=>{this._selectedDragItemLayerUid=i},this._onTablesOpen=i=>{this.openedLayers.push(i.layer),this._focusLayerFlowItem=i.layer.uid},this._onPanelOpen=()=>{this._focusPanelFlowItem=!0},this._onCatalogOpen=i=>{this.openedLayers.push(i.layer.parent),this._focusLayerFlowItem=i.layer.uid},this._clearActiveItem=()=>{this._activeItem=null},this._setActiveItem=i=>{if(this.visibilityAppearance!=="default")return;const s=Array.from(i.composedPath()).find(r=>{var n;return(n=r.classList)==null?void 0:n.contains(T.item)});this._activeItem=E(s)},this._onCalciteListOrderChange=i=>{const{_lastDragDetail:s}=this,{toEl:r,fromEl:n,dragEl:d,newIndex:c}=i;if(!n||!r||(s==null?void 0:s.newIndex)===c&&(s==null?void 0:s.dragEl)===d&&(s==null?void 0:s.toEl)===r&&(s==null?void 0:s.fromEl)===n)return;this._lastDragDetail=i;const m=n,y=r;if(m!==y)this._moveLayerFromChildList({toEl:y,fromEl:m,dragEl:d,newIndex:c});else{const _=Array.from(n.children).filter(p=>p==null?void 0:p.matches("calcite-list-item")).map(p=>p.value);this._sortLayers(m,_)}}}initialize(){this.addHandles(te(()=>this.openedLayers,"change",()=>this._handleOpenedLayersChange(),B))}normalizeCtorArgs(e){return(e==null?void 0:e.editingEnabled)!=null&&e.visibleElements!=null?{...e,visibleElements:new U({...e.visibleElements,editTitleButton:e.editingEnabled})}:e}loadDependencies(){return se({action:()=>v(()=>import("./calcite-action-Bys6x4p_.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32]),import.meta.url),block:()=>v(()=>import("./calcite-block-M0XyV5ob.js"),__vite__mapDeps([33,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,34,28,23,24,26,27,30,35,25,36,37,38,1,29,31,32,39,40,41,42,43,44,45]),import.meta.url),label:()=>v(()=>import("./calcite-label-B1FxWqaL.js"),__vite__mapDeps([46,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,47,23,29]),import.meta.url),input:()=>v(()=>import("./calcite-input-DAafN6Cc.js"),__vite__mapDeps([48,49,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,50,24,27,47,29,25,26,28,30,51,52,31,53,54]),import.meta.url),button:()=>v(()=>import("./calcite-button-D_Agetwz.js"),__vite__mapDeps([55,56,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,50,23,24,47,29,25,26,27,28,30,31,32]),import.meta.url),flow:()=>v(()=>import("./calcite-flow-BrE9BG4l.js"),__vite__mapDeps([57,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,28,25]),import.meta.url),"flow-item":()=>v(()=>import("./calcite-flow-item-B0xZ0mWX.js"),__vite__mapDeps([58,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,30,59,39,40,1,29,31,32,41,37,38,42,36,35,43,45]),import.meta.url),list:()=>v(()=>import("./calcite-list-C4jOVpC-.js"),__vite__mapDeps([60,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,28,61,62,25,30,26,27,63,38,31,49,50,47,29,51,52,53,54,32,45]),import.meta.url),notice:()=>v(()=>import("./calcite-notice-DSp0z_Oh.js"),__vite__mapDeps([64,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,34,28,23,25,26,27,30,65,36,29,31]),import.meta.url),tooltip:()=>v(()=>import("./calcite-tooltip-rE_jVYtd.js"),__vite__mapDeps([66,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,37,38,36,43]),import.meta.url)})}destroy(){this._tooltipReferenceMap.clear(),this._destroyOpenedLayerLists()}get _totalBaseItems(){return this.viewModel.baseItems.flatten(e=>e.children.filter(t=>t.layer.type!=="catalog-dynamic-group")).length}get _totalReferenceItems(){return this.viewModel.referenceItems.flatten(e=>e.children.filter(t=>t.layer.type!=="catalog-dynamic-group")).length}get _baseFilterEnabled(){return this._totalBaseItems>=this.minFilterItems&&this.visibleElements.filter}get _referenceFilterEnabled(){return this._totalReferenceItems>=this.minFilterItems&&this.visibleElements.filter}get _renderedOpenLayerFlowItems(){return this.openedLayers.toArray().map(e=>this._renderLayerFlowItem(e))}get basemapTitle(){return this.viewModel.basemapTitle}set basemapTitle(e){this.viewModel.basemapTitle=e}get baseListItemCreatedFunction(){return this.viewModel.baseListItemCreatedFunction}set baseListItemCreatedFunction(e){this.viewModel.baseListItemCreatedFunction=e}get editingEnabled(){return P($.getLogger(this),"editingEnabled",{replacement:"selectionMode, dragEnabled, visibleElements.editTitleButton",version:"4.29",warnOnce:!0}),this.selectionMode!=="none"&&this.dragEnabled&&this.visibleElements.editTitleButton}set editingEnabled(e){P($.getLogger(this),"editingEnabled",{replacement:"selectionMode, dragEnabled, visibleElements.editTitleButton",version:"4.29",warnOnce:!0}),this.dragEnabled=e,this.visibleElements.editTitleButton=e,this.selectionMode=e?this.multipleSelectionEnabled?"multiple":"single":"none"}get icon(){return"layers"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get multipleSelectionEnabled(){return P($.getLogger(this),"multipleSelectionEnabled",{replacement:"selectionMode",version:"4.29",warnOnce:!0}),this.selectionMode==="multiple"}set multipleSelectionEnabled(e){P($.getLogger(this),"multipleSelectionEnabled",{replacement:"selectionMode",version:"4.29",warnOnce:!0}),this.selectionMode=e?"multiple":this.editingEnabled?"single":"none"}get referenceListItemCreatedFunction(){return this.viewModel.referenceListItemCreatedFunction}set referenceListItemCreatedFunction(e){this.viewModel.referenceListItemCreatedFunction=e}get baseItems(){return this.viewModel.baseItems}get referenceItems(){return this.viewModel.referenceItems}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}triggerAction(e,t){return this.viewModel.triggerAction(e,t)}render(){const{state:e}=this.viewModel,t={[N.hidden]:e==="loading",[N.disabled]:e==="disabled"};return u("div",{class:this.classes(T.base,N.widget,N.panel,t)},this._renderItems())}async _createCatalogLayerList(e){const{default:t}=await v(()=>import("./CatalogLayerList-Dxbb5XPt.js"),__vite__mapDeps([67,12,13,3,18,10,7,14,19,20,68,69,16,17,2,4,5,6,8,9,11,15,21,22,70,71,72,73,74,75,76,77,78,79]),import.meta.url),{headingLevel:i,catalogOptions:s,view:r,filterPlaceholder:n,minFilterItems:d,selectionMode:c,visibilityAppearance:m,_onCatalogOpen:y,_onTablesOpen:_,layerTablesEnabled:p}=this;return new t({headingLevel:i,view:r,filterPlaceholder:n,minFilterItems:d,selectionMode:c,visibilityAppearance:m,...s,catalogLayer:e,layerTablesEnabled:p,onCatalogOpen:y,onTablesOpen:_})}_getTableListParams(e){switch(e.type){case"knowledge-graph":return{...this.knowledgeGraphOptions,tables:e.tables};case"map-image":return{...this.mapImageOptions,tables:e.subtables};case"tile":return{...this.tileOptions,tables:e.subtables};default:return null}}async _createTableList(e){const{default:t}=await v(()=>import("./TableList-DZ1f1-tP.js"),__vite__mapDeps([80,12,13,3,18,10,7,14,19,20,68,2,4,5,6,8,9,11,15,16,17,21,22,74,75,76,72,71,77,78,79,73]),import.meta.url),{headingLevel:i,selectionMode:s,dragEnabled:r}=this;return new t({headingLevel:i,selectionMode:s,dragEnabled:r,...this._getTableListParams(e)})}async _createFlowList(e,t){const{_layerListMap:i}=this,s=i.get(e);if(s)return s;const r=e.type==="catalog"?await this._createCatalogLayerList(e):await this._createTableList(e);return t.aborted||i.set(e,r),r}async _handleOpenedLayersChange(){var c;const{_layerListMap:e,openedLayers:t,openedLayerLists:i}=this;(c=this._openedLayersController)==null||c.abort();const s=new AbortController,{signal:r}=s;this._openedLayersController=s,e.forEach((m,y)=>{t.includes(y)||(m.destroy(),e.delete(y))});const n=await Promise.all(t.map(m=>this._createFlowList(m,r)));if(r.aborted)return;i.removeAll(),i.addMany(n);const d=i.at(-1);d?"catalogLayer"in d?(this._set("catalogLayerList",d),this._set("tableList",null)):(this._set("catalogLayerList",null),this._set("tableList",d)):(this._set("catalogLayerList",null),this._set("tableList",null))}_destroyOpenedLayerLists(){this.openedLayerLists.destroyAll(),this.openedLayers.removeAll(),this._layerListMap.clear()}_renderItemTooltip(e){return e?u("calcite-tooltip",{key:`tooltip-${e.layer.uid}`,referenceElement:this._tooltipReferenceMap.get(e.layer.uid)},this.messages.layerIncompatibleTooltip):null}_renderItemTooltipNodes(e){var t;return e.incompatible?this._renderItemTooltip(e):(t=e.children)==null?void 0:t.filter(i=>!i.hidden).toArray().map(i=>this._renderItemTooltipNodes(i))}_renderItemTooltips(e){return e==null?void 0:e.toArray().map(t=>this._renderItemTooltipNodes(t))}_focusLayerFlowItemNode(e){this._focusLayerFlowItem===e.dataset.layerUid&&(this._focusLayerFlowItem=null,D(e))}_renderPanelFlowItems(e){return e?e.flatten(t=>t.children).filter(({hidden:t,panel:i})=>!t&&(i==null?void 0:i.open)&&!i.disabled&&i.flowEnabled).toArray().map(({title:t,panel:i})=>{const s=()=>this._handlePanelFlowItemBack(i);return u("calcite-flow-item",{afterCreate:this._focusPanelFlowItemNode,afterUpdate:this._focusPanelFlowItemNode,bind:this,description:t,heading:i.title,headingLevel:this.headingLevel,key:`flow-panel-${i.uid}`,onCalciteFlowItemBack:r=>{r.preventDefault(),s()}},i.render(),u("calcite-button",{appearance:"transparent",onclick:s,slot:"footer-actions",width:"full"},this.messagesCommon.back))}):[]}_handlePanelFlowItemBack(e){e.open=!1,this._focusRootFlowItem=!0}_focusEditingFlowItemNode(e){this._focusEditingFlowItem&&(this._focusEditingFlowItem=!1,D(e))}_focusRootFlowItemNode(e){this._focusRootFlowItem&&(this._focusRootFlowItem=!1,D(e))}_focusPanelFlowItemNode(e){this._focusPanelFlowItem&&(this._focusPanelFlowItem=!1,D(e))}_renderItem(e,t,i,s){return u(de,{activeItem:this._activeItem,canMove:this._canMove,css:T,dragEnabled:!t&&this.dragEnabled,item:e,key:`layerListItem-${e.layer.uid}`,layerTablesEnabled:this.layerTablesEnabled,listModeDisabled:this.viewModel.listModeDisabled,messages:this.messages,messagesCommon:this.messagesCommon,parent:i,parentTitles:s,rootGroupUid:this._rootGroupUid,selectedDragItemLayerUid:this._selectedDragItemLayerUid,selectedItems:this.selectedItems,selectionMode:this.selectionMode,visibilityAppearance:this.visibilityAppearance,visibleElements:this.visibleElements,onAction:this._onTriggerAction,onCatalogOpen:this._onCatalogOpen,onPanelOpen:this._onPanelOpen,onSelectedDragItemLayerUidChange:this._onSelectedDragItemLayerUidChange,onTablesOpen:this._onTablesOpen,onTooltipReferenceChange:this._onTooltipReferenceChange})}_moveLayerFromChildList({toEl:e,fromEl:t,dragEl:i,newIndex:s}){const r=E(i),n=E(e),d=E(t),c=H(t),m=H(e);c&&m&&this.viewModel.moveListItem({targetItem:r,fromParentItem:d,toParentItem:n,newIndex:s,from:c,to:m})}_handleCalciteListDragEnd(e){const{fromEl:t,dragEl:i,oldIndex:s}=e;t.insertBefore(i,t.children[s])}_sortLayers(e,t){var i,s,r,n,d,c;if(e)if(e.group===this._rootGroupUid){const m=H(e),y=m==="base"?(r=(s=(i=this.view)==null?void 0:i.map)==null?void 0:s.basemap)==null?void 0:r.baseLayers:m==="reference"?(c=(d=(n=this.view)==null?void 0:n.map)==null?void 0:d.basemap)==null?void 0:c.referenceLayers:null;le(y,t)}else{const m=E(e);if(!m)return;ne(m,t)}}_handleCalciteListChange(e){const{selectionMode:t,selectedItems:i}=this;if(t==="none")return;const s=e.target.selectedItems.map(r=>E(r)).filter(Boolean);i.removeAll(),i.addMany(s)}_renderEditingInput(){const{messages:e}=this,{basemapTitle:t}=this.viewModel;return u("div",{class:T.editing},u("calcite-label",null,e.basemapTitle,u("calcite-input",{afterCreate:i=>this._editTitleInput=i,label:e.basemapTitle,name:"basemaptitle",pattern:ye,placeholder:e.basemapTitle,required:!0,title:e.basemapTitle,type:"text",value:t??void 0})))}_renderCancelButton(){const{messagesCommon:{cancel:e}}=this;return u("calcite-button",{appearance:"outline",bind:this,label:e,onclick:this._toggleEditingTitle,slot:"footer",title:e,width:"half"},e)}_renderSubmitButton(){const{messagesCommon:e}=this;return u("calcite-button",{label:e.form.submit,slot:"footer",title:e.form.submit,type:"submit",width:"half"},e.form.ok)}_renderEditingForm(){return this.editingTitle?u("form",{bind:this,onsubmit:this._formSubmit},u("calcite-flow-item",{afterCreate:this._focusEditingFlowItemNode,afterUpdate:this._focusEditingFlowItemNode,bind:this,heading:this.visibleElements.heading?this.messages.basemapTitle:void 0,headingLevel:this.headingLevel,onCalciteFlowItemBack:e=>{e.preventDefault(),this._toggleEditingTitle()}},this._renderEditingInput(),this._renderCancelButton(),this._renderSubmitButton())):null}_renderEditTitleButton(){const{editingTitle:e,visibleElements:t,messagesCommon:i}=this,s=i.edit;return t.editTitleButton&&!e?u("calcite-action",{bind:this,icon:"pencil",onclick:this._toggleEditingTitle,slot:"header-actions-end",text:s,title:s}):null}_renderNoLayersInfoMessage(e){return u("div",{slot:"message"},e)}_renderNoLayersInfo(e,t){return u("div",{class:T.itemMessage},u("calcite-notice",{icon:"information",key:t,kind:"info",open:!0,width:"full"},this._renderNoLayersInfoMessage(e)))}_getFilteredItems(e){return e==null?void 0:e.filter(t=>!t.hidden&&(this.visibleElements.errors||!t.error))}_renderItems(){const{collapsed:e,visible:t,visibleElements:{closeButton:i,collapseButton:s,heading:r,flow:n},messages:d,viewModel:c,referenceItems:m,baseItems:y}=this,_=this.visibleElements.referenceLayers?this._getFilteredItems(m):null,p=this.visibleElements.baseLayers?this._getFilteredItems(y):null,w=[u("calcite-flow-item",{afterCreate:this._focusRootFlowItemNode,afterUpdate:this._focusRootFlowItemNode,bind:this,closable:i,closed:!t,collapsed:e,collapsible:s,heading:r?c.basemapTitle??d.widgetLabel:void 0,headingLevel:this.headingLevel,key:"root-flow-item",onCalciteFlowItemClose:()=>this.visible=!1},this._renderEditTitleButton(),this._renderReferenceSection(_),this._renderBaseSection(p,(p==null?void 0:p.length)===1)),this._renderEditingForm(),this._renderPanelFlowItems(p),this._renderPanelFlowItems(_),this._renderedOpenLayerFlowItems];return t?[n?u("calcite-flow",{key:"root-flow"},w):w,this._renderItemTooltips(_),this._renderItemTooltips(p)]:null}_renderLayerFlowItem(e){var r;const{messages:t,openedLayers:i}=this,s=e.title||this.messages.untitledLayer;return u("calcite-flow-item",{afterCreate:this._focusLayerFlowItemNode,afterUpdate:this._focusLayerFlowItemNode,bind:this,"data-layer-uid":e.uid,description:s,heading:t[e.type==="catalog"?"catalogLayers":"tables"],headingLevel:this.headingLevel,key:`flow-layer-list-${e.uid}`,onCalciteFlowItemBack:n=>{n.preventDefault(),i.pop();const d=i.at(-1);d?this._focusLayerFlowItem=d.uid:this._focusRootFlowItem=!0}},(r=this._layerListMap.get(e))==null?void 0:r.render())}_renderList(e,t,i){const{messages:s,dragEnabled:r,selectionMode:n,filterPlaceholder:d,baseFilterText:c,referenceFilterText:m,_baseFilterEnabled:y,_referenceFilterEnabled:_,_rootGroupUid:p}=this,w=t==="reference"?s.noReferenceLayers:s.noBaseLayers,F=t==="reference"?_:y;return u("calcite-block",{class:T.section,collapsible:!0,heading:t==="reference"?s.referenceHeading:s.baseHeading,headingLevel:ce(this.headingLevel),key:`block-${t}`,open:!0},(e==null?void 0:e.length)===0?this._renderNoLayersInfo(w,t):null,u("calcite-list",{afterCreate:h=>{h.addEventListener("focusin",this._setActiveItem),h.addEventListener("focusout",this._clearActiveItem)},afterRemoved:h=>{h.removeEventListener("focusin",this._setActiveItem),h.removeEventListener("focusout",this._clearActiveItem)},canPull:h=>this._canMove(h,"pull"),canPut:h=>this._canMove(h,"put"),filterProps:me,[G]:t,"data-layer-type":p,dragEnabled:r,filterEnabled:F,filterPlaceholder:d,filterText:F?t==="reference"?m:c:"",group:p,key:`list-${t}`,label:s.widgetLabel,onmouseleave:this._clearActiveItem,onmouseover:this._setActiveItem,selectionAppearance:"border",selectionMode:n,onCalciteListChange:h=>this._handleCalciteListChange(h),onCalciteListDragEnd:h=>this._handleCalciteListDragEnd(h.detail),onCalciteListFilter:h=>{var M;return this[t==="reference"?"referenceFilterText":"baseFilterText"]=((M=h.target)==null?void 0:M.filterText)??""},onCalciteListOrderChange:h=>this._onCalciteListOrderChange(h.detail)},e==null?void 0:e.toArray().map(h=>this._renderItem(h,i)),e!=null&&e.length&&F?u("div",{class:T.filterNoResults,slot:"filter-no-results"},u("calcite-notice",{kind:"info",open:!0,width:"full"},this._renderNoLayersInfoMessage(w))):null))}_renderBaseSection(e,t){return this.visibleElements.baseLayers?this._renderList(e,"base",t):null}_renderReferenceSection(e){return this.visibleElements.referenceLayers?this._renderList(e,"reference",!1):null}_toggleEditingTitle(){const{editingTitle:e}=this,t=!e;this.editingTitle=t,t?this._focusEditingFlowItem=!0:this._focusRootFlowItem=!0}_formSubmit(e){var i;e.preventDefault();const t=(i=this._editTitleInput)==null?void 0:i.value;t!=null&&t.trim()&&(this.basemapTitle=t),this._toggleEditingTitle()}};function H(e){var t;return(t=e==null?void 0:e.closest(`[${G}]`))==null?void 0:t.getAttribute(G)}o([a()],l.prototype,"_activeItem",void 0),o([a()],l.prototype,"_tooltipReferenceMap",void 0),o([a()],l.prototype,"_focusRootFlowItem",void 0),o([a()],l.prototype,"_focusPanelFlowItem",void 0),o([a()],l.prototype,"_focusLayerFlowItem",void 0),o([a()],l.prototype,"_focusEditingFlowItem",void 0),o([a()],l.prototype,"_layerListMap",void 0),o([a()],l.prototype,"_totalBaseItems",null),o([a()],l.prototype,"_totalReferenceItems",null),o([a()],l.prototype,"_baseFilterEnabled",null),o([a()],l.prototype,"_referenceFilterEnabled",null),o([a()],l.prototype,"_renderedOpenLayerFlowItems",null),o([a()],l.prototype,"basemapTitle",null),o([a({readOnly:!0})],l.prototype,"catalogLayerList",void 0),o([a()],l.prototype,"catalogOptions",void 0),o([a()],l.prototype,"collapsed",void 0),o([a()],l.prototype,"dragEnabled",void 0),o([a()],l.prototype,"editingTitle",void 0),o([a()],l.prototype,"filterPlaceholder",void 0),o([a()],l.prototype,"baseFilterText",void 0),o([a()],l.prototype,"referenceFilterText",void 0),o([a()],l.prototype,"listItemCanGiveFunction",void 0),o([a()],l.prototype,"listItemCanReceiveFunction",void 0),o([a()],l.prototype,"baseListItemCreatedFunction",null),o([a()],l.prototype,"editingEnabled",null),o([a()],l.prototype,"headingLevel",void 0),o([a()],l.prototype,"icon",null),o([a()],l.prototype,"knowledgeGraphOptions",void 0),o([a()],l.prototype,"label",null),o([a()],l.prototype,"layerTablesEnabled",void 0),o([a()],l.prototype,"mapImageOptions",void 0),o([a(),J("esri/widgets/BasemapLayerList/t9n/BasemapLayerList")],l.prototype,"messages",void 0),o([a(),J("esri/t9n/common")],l.prototype,"messagesCommon",void 0),o([a()],l.prototype,"minFilterItems",void 0),o([a()],l.prototype,"multipleSelectionEnabled",null),o([a({readOnly:!0})],l.prototype,"openedLayers",void 0),o([a({readOnly:!0})],l.prototype,"openedLayerLists",void 0),o([a()],l.prototype,"referenceListItemCreatedFunction",null),o([a({readOnly:!0})],l.prototype,"tableList",void 0),o([a({readOnly:!0})],l.prototype,"baseItems",null),o([a({readOnly:!0})],l.prototype,"referenceItems",null),o([a()],l.prototype,"selectedItems",void 0),o([a()],l.prototype,"selectionMode",void 0),o([a()],l.prototype,"tileOptions",void 0),o([a()],l.prototype,"view",null),o([pe("trigger-action"),a({type:W})],l.prototype,"viewModel",void 0),o([a()],l.prototype,"visibilityAppearance",void 0),o([a({type:U,nonNullable:!0})],l.prototype,"visibleElements",void 0),l=o([j("esri.widgets.BasemapLayerList")],l);const Qe=l;export{Qe as default};
