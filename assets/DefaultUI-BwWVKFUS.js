const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./ElevationQuery-HSxD60s-.js","./reactiveUtils-XM7cS2OP.js","./Accessor-BmwT4B0c.js","./Evented-Dw4_VOGn.js","./SimpleObservable-CvOkykwM.js","./Point-Cz2JYYmX.js","./cast-CsZslgGN.js","./index-4eY77cms.js","./index-Cx51aysm.css","./JSONSupport-DcrLLGjL.js","./writer-DKgfqj4X.js","./Polyline-s-JzsQqo.js","./Extent-g5W9hy0j.js","./mathUtils-Cfq9PL9W.js","./projection-CyCZAIaD.js","./vec3f64-BLpZdpfb.js","./projectBuffer-CQnuEMuP.js","./geodesicConstants-RQL9oKdk.js","./ElevationSamplerData-UywXoG8C.js","./ElevationTile-BBBbm-Nl.js","./TileKey-DZd6gJy7.js","./layersCreator-BJyy3KAG.js","./loadUtils-DPEbqruB.js","./requestPresets-D39VZbLJ.js","./associatedFeatureServiceUtils-BqJqfohX.js","./Portal-CmmHxpLg.js","./Promise-DfET-uns.js","./PortalItem-CTx1kJsR.js","./fetchService-DZsSekGm.js","./lazyLayerLoader-C_wVyUAo.js","./portalLayers-BFMslhQ9.js","./layerUtils-B__v9OBu.js","./portalItemUtils-ByOtbGao.js","./styleUtils-Bye9ft1s.js","./Popup-CMV5hdAm.js","./ActionToggle-D7439N1A.js","./Identifiable-BHVfzH03.js","./Features-ClJvn8h6.js","./intl-Duiy0OzY.js","./throttle-jjSnxk80.js","./geometryUtils-D1iOC1ST.js","./scaleUtils-DPfHG2g0.js","./actionUtils-CtQI3q6p.js","./substitute-CvdjmBYq.js","./Feature-zYPb8B0H.js","./jsxFactory-Cnml7uXM.js","./uuid-Cl5lrJ4c.js","./Attachments-CEjxK4Wg.js","./unitFormatUtils-Q7ZG7HcF.js","./ByteSizeUnit-BsxeN7wM.js","./Cyclical-Dlbl-cQK.js","./quantityUtils-BsDK158M.js","./Graphic-Dt0LgVGU.js","./Clonable-Z-AWS-16.js","./opacityUtils-Dim20wpZ.js","./enumeration-DpvDkLNI.js","./Color-VJEMvW-n.js","./colorUtils-Rxh2V3ai.js","./jsonUtils-CwFG8yN4.js","./typeUtils-B6WBEKDM.js","./TextSymbol-BLIQ6RKX.js","./screenUtils-_ZIvrt5o.js","./collectionUtils-CTT-51g7.js","./aaBoundingBox-Dw3yBk2f.js","./AttachmentInfo-b6cNZMAJ.js","./AttachmentQuery-CpEmJqq-.js","./featureUtils-BovNToiy.js","./utils-v4CMtYiY.js","./mat4f32-DcsiF_Rp.js","./mat4-Fi6iAz29.js","./common-DQOJ18NT.js","./timeZoneUtils-DxzjpEBb.js","./attachmentUtils-BG3pf-R1.js","./globalCss-vQlnDsEX.js","./legacyIcon-Wt_jLiuK.js","./FeatureRelationshipViewModel-CSg-U4Be.js","./Heading-BcR6CGTM.js","./ReactiveMap-BHFEHYMj.js","./NetworkElement-BEwoE6j2.js","./Query-B_2mhyL4.js","./Field-BDG0QV_T.js","./fieldType-CBeoJWlv.js","./FullTextSearch-CBnxSwz4.js","./TimeExtent-BO6BsF_x.js","./timeUtils-C1c_L2Fd.js","./RelationshipQuery-B5a-mYy7.js","./featureFormUtils-Cjx4R4NB.js","./formUtils-l8pvwous.js","./dateUtils-CkANlKbA.js","./widget-GKEQ1p1m.js","./uriUtils-CBE5heUM.js","./a11yUtils-ClKbIIe-.js","./utils-B1XxMXhZ.js","./ColorStop-BYiAUa8d.js","./utils-aIx1khaq.js","./jsonUtils-DZz5FrgB.js","./utils-DYurMneM.js","./cimSymbolUtils-DzhKvmq_.js","./utils-UPZJIDfz.js","./defaultCIMValues-Bb-CUowV.js","./enums-BTM-fOHQ.js","./LRUCache-CXiGQWMN.js","./MemCache-CmojB_Z1.js","./HeatmapColorStop-CHbSyb1s.js","./executeQueryJSON-BvVQs3iA.js","./utils-YowqfOgk.js","./query-Bjn_Ozo1.js","./normalizeUtils-BTGdXlpz.js","./normalizeUtilsCommon-lGDszWRI.js","./utils-B-dlKIhi.js","./pbfQueryUtils-mqiWagfZ.js","./pbf-BsmI3A9L.js","./memoryEstimations-Bcyf-mHz.js","./OptimizedGeometry-BJqUA4Pi.js","./OptimizedFeature-P2towpqD.js","./OptimizedFeatureSet-Blu9Ckm7.js","./queryZScale-BdW_vUm_.js","./FeatureSet-B5-Veyin.js","./themeUtils-C3zvZbsE.js","./shared-2m9g3-y2.js","./TimeOnly-CveCl9ie.js","./FeatureLayer-U46cmps3.js","./MultiOriginJSONSupport-DbmrbwMa.js","./layerContainerType-C5CzMsLd.js","./FeatureLayerBase-C4QQJYE9.js","./HeightModelInfo-C05IFsWs.js","./commonProperties-B0GHoNP5.js","./ElevationInfo-BPOqhCue.js","./unitConversionUtils-rg07EgOm.js","./lengthUtils-_77UiyVF.js","./AttributeTableTemplate-cR37sM72.js","./featureLayerUtils-Btb8HY8h.js","./featureQueryAll-JpNZKIBO.js","./SimpleRenderer-CEw_geZx.js","./commonProperties-ZfGquLPI.js","./colorRamps-CRjjPL3r.js","./SizeVariable-B-ghFm6e.js","./visualVariableUtils-Xcorldoo.js","./jsonUtils-B-voMz-i.js","./defaults-FkBa0ybj.js","./defaultsJSON-GKolV7NZ.js","./UniqueValueRenderer-yoWHKJ_P.js","./diffUtils-BanfihCO.js","./RendererLegendOptions-CYAPr8D6.js","./styleUtils-ColFrJ-Z.js","./NormalizationBinParametersMixin-CZD0XfhN.js","./LayerFloorInfo-iCgtHY6f.js","./Relationship-CTbzI1Kb.js","./serviceCapabilitiesUtils-B2yGaMdk.js","./infoFor3D-C7tb3HsI.js","./Layer-DH4_Pn8a.js","./workers-Cds_sd9m.js","./Queue-BQesTh_6.js","./editsZScale-LI19I1vI.js","./APIKeyMixin-3z69J1h4.js","./ArcGISService-CDyDWGI0.js","./ScaleRangeLayer-Cnzwr9PT.js","./CustomParametersMixin-Be7WOSEG.js","./DisplayFilteredLayer-CzliK74b.js","./displayFilterUtils-uKPOP7_-.js","./EditBusLayer-KXo-LY9o.js","./FeatureEffectLayer-BZmannck.js","./FeatureEffect-DZgZP6Sj.js","./FeatureFilter-Ca1n-g_b.js","./FeatureReductionLayer-B6VhUfZv.js","./FeatureReductionSelection-BJWsAyix.js","./labelingInfo-BgG6IH9B.js","./labelUtils-DCpQ7n-8.js","./jsonUtils-BZp85R7u.js","./typeUtils-B3iPBwJ2.js","./ClassBreaksRenderer-C7fhua2J.js","./Version-Cd3TlGH0.js","./FieldsIndex-FW1AMU67.js","./heatmapUtils-Cyq-bAyG.js","./vec42-YcqnINSP.js","./vec4f64-o2zAXfmz.js","./MD5-C9MwAd2G.js","./OperationalLayer-B__lrMRq.js","./OrderedLayer-ucEg87Tu.js","./OrderByInfo-KsusEmpW.js","./PortalLayer-Cqwv_mmr.js","./RefreshableLayer-C90FXoHt.js","./TemporalLayer-CMqBosxi.js","./TimeInfo-CctegBed.js","./TimeInterval-B7L-CEq7.js","./TrackableLayer-DaYHUnrc.js","./FeatureTemplate-Dh5_oWTV.js","./FeatureType-DhERcdEP.js","./fieldProperties-DDN0PSrH.js","./TitleCreator-DIyQ9Yy3.js","./versionUtils-BfhafDf-.js","./popupUtils-CmsUVJA0.js","./interfaces-CL2NbQte.js","./Spinner--kyaGywN.js","./AnchorElementViewModel-BV8Tp06L.js","./FeaturesViewModel-_JXCqV25.js","./ReactiveSet-DgPcISC1.js","./LayerConstants-B33OP6sh.js","./symbolUtils-CHmFfSx2.js","./colorUtils-DaPfwnk3.js","./mat2df32-orApM5a3.js","./mat2d-D9DBP-jx.js","./webStyleSymbolUtils-C6Yokq8v.js","./devEnvironmentUtils-CnNDiFMM.js","./webStyleAcceptedFormats-CG7ZQ6BV.js","./layerViewUtils-Bevty3Jm.js","./actions-fElEWZWj.js","./GoTo-zPv0y7kC.js","./vmEvent-D4Ubqkbq.js","./geometryServiceUtils-CW7bdn7_.js","./project-CvBujuEW.js","./Lyr3DWasmPerSceneView-DShQOYMo.js","./ILyr3DWasmPerSceneView-QwgNPJGT.js","./WorkerHandle-CKOgUZ7i.js","./Lyr3DModule-BcAwzNDV.js","./elevationInfoUtils-D26wVF2d.js","./makeScheduleFunction-CggzEh3c.js","./index-jjUP6Yam.js","./index-CMxz6F2k.js","./guid-ejniuQmw.js","./useT9n-C1Hrfc-A.js","./index-DwIhxbHs.js","./dom-DEluURzl.js","./observers-Co4E8E8j.js","./ref-D9wHsL_T.js","./directive-helpers-DaBykg1t.js","./static-DLD4WjLv.js","./form-BzoUrXC7.js","./interactive-DTzfFku4.js","./label-CHHpnzD0.js","./loadable-XBvaWFYY.js","./component-CBVlbUuE.js"])))=>i.map(i=>d[i]);
import{r,m as h,a as y,E as Jt,B as P,N as R,bZ as An,s as S,D as se,c as gi,$ as fi,L as On,g as M,b3 as qe,aW as At,at as Fn,e as Yt,l as ge,b_ as Rn,M as we,az as zn,a3 as dt,f as Nn,ax as _t,a6 as Ji,b5 as Hn,a4 as vt,o as Wn,ap as yi,b$ as Zn,G as Yi,al as qn,bo as ut,aS as jn,i as Ot,H as Bn,aV as Un,ag as Gn,S as Kn,aw as ae,aU as A,aT as Jn}from"./Accessor-BmwT4B0c.js";import{V as x,d as b,P as K,w as Qi,a as Qt,v as ct,A as Ft,C as _i,p as ot,_ as Yn}from"./reactiveUtils-XM7cS2OP.js";import{b as vi,d as Xi,t as wi,g as Qn,O as pt,n as E,e as mt,c as Xt,T as Xn}from"./jsxFactory-Cnml7uXM.js";import{h as gt}from"./UpdatingHandles-CzJ4c3KT.js";import{_ as Z}from"./index-4eY77cms.js";import{_ as en,a as He}from"./InputManager-DZ3jJnlx.js";import eo from"./Basemap-BZmrlnvW.js";import{h as me}from"./Color-VJEMvW-n.js";import{n as ei}from"./collectionUtils-CTT-51g7.js";import{S as tn}from"./JSONSupport-DcrLLGjL.js";import{m as Rt}from"./Portal-CmmHxpLg.js";import{t as to}from"./loadAll-D1eTJ7uv.js";import{r as io}from"./writer-DKgfqj4X.js";import{r as no}from"./enumeration-DpvDkLNI.js";import{n as oo}from"./groundInstanceUtils-Ben03ZCf.js";import{r as so,ad as ao}from"./opacityUtils-Dim20wpZ.js";import{n as zt}from"./CollectionFlattener-U8hHQmGf.js";import{i as ft}from"./Evented-Dw4_VOGn.js";import{a as st}from"./cast-CsZslgGN.js";import{e as ro}from"./editableLayers-CWgCazH-.js";import{p as lo,l as ho,m as uo}from"./basemapEnsureType-CmRtohu0.js";import{l as co,a as po,t as mo,n as wt}from"./TablesMixin-Bqfi1Ha_.js";import{p as nn,e as go,r as fo,h as yo}from"./Promise-DfET-uns.js";import{n as _o,c as on,l as bi}from"./GraphicsCollection-BJ5Nr2H8.js";import{w as sn,t as vo}from"./Extent-g5W9hy0j.js";import{v as wo}from"./HeightModelInfo-C05IFsWs.js";import{c as bo,g as Nt,E as Mo,a3 as xo}from"./Point-Cz2JYYmX.js";import{p as To}from"./TimeExtent-BO6BsF_x.js";import{p as $o}from"./timeZoneUtils-DxzjpEBb.js";import{f as ko}from"./Layer-DH4_Pn8a.js";import{c as Ne}from"./screenUtils-_ZIvrt5o.js";import{s as Po}from"./ReactiveMap-BHFEHYMj.js";import{c as Co,l as ye}from"./layerUtils-B__v9OBu.js";import{b as Mi}from"./Query-B_2mhyL4.js";import{e as je}from"./selectionUtils-DYi6daQO.js";import{a as So}from"./Clonable-Z-AWS-16.js";import{r as Eo,c as Io}from"./ViewEvents-c9mvQ_r3.js";import{o as Ht}from"./interfaces-D6pIddIh.js";import{r as at,s as Lo}from"./mathUtils-Cfq9PL9W.js";import{n as Q,i as Do}from"./screenUtils-BWEEmpSb.js";import{c as an,e as Vo,r as Ao,l as Oo,n as Fo,t as Ro,a as zo,p as No,m as Ho}from"./HighlightDefaults-CumzVg9-.js";import{o as Wo}from"./a11yUtils-ClKbIIe-.js";import{l as Zo,g as qo}from"./heightModelInfoUtils-D_x68P3s.js";import{l as xi}from"./ViewingMode-Dodu7ZZk.js";import{O as jo,k as Bo,L as Uo,K as Go}from"./projection-CyCZAIaD.js";import{g as Ko}from"./vec32-Dvg_eL9J.js";import{t as Be}from"./unitBezier-B1N-tmtC.js";import{e as bt}from"./common-DQOJ18NT.js";import{s as Jo}from"./imageUtils-DsXKmbqJ.js";import{t as Yo}from"./capabilities-DwlKKScG.js";import"./intl-Duiy0OzY.js";import{n as Qo}from"./themeUtils-C3zvZbsE.js";import{e as J}from"./globalCss-vQlnDsEX.js";import{t as Xo}from"./accessibleHandler-BaA3O97p.js";import{p as rn}from"./CompassViewModel-DBhnIkQP.js";import{p as ln}from"./ZoomViewModel-Bua4WqEj.js";var Wt;let Je=Wt=class extends tn{constructor(t){super(t),this.type="none"}clone(){return new Wt({type:this.type})}};r([no({none:"none",stayAbove:"stay-above"}),h({json:{write:{isRequired:!0}}})],Je.prototype,"type",void 0),Je=Wt=r([y("esri.ground.NavigationConstraint")],Je);var hn,Zt;let te=Zt=class extends tn.JSONSupportMixin(Rt){constructor(t){super(t),this[hn]=!0,this.opacity=1,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new x;const e=n=>{n.parent&&n.parent!==this&&"remove"in n.parent&&n.parent.remove(n),n.parent=this,n.type!=="elevation"&&n.type!=="base-elevation"&&P.getLogger(this).error(`Layer '${n.title}, id:${n.id}' of type '${n.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`)},i=n=>{n.parent=null};this.addHandles([this.layers.on("after-add",n=>e(n.item)),this.layers.on("after-remove",n=>i(n.item))])}initialize(){this.when().catch(t=>{Jt(t)||P.getLogger(this).error("#load()","Failed to load ground",t)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const t=this.layers.removeAll();for(const e of t)R(e);this.layers.destroy()}normalizeCtorArgs(t){return t&&"resourceInfo"in t&&(this._set("resourceInfo",t.resourceInfo),delete(t={...t}).resourceInfo),t}get layers(){return this._get("layers")}set layers(t){this._set("layers",ei(t,this._get("layers")))}writeLayers(t,e,i,n){const o=[];t&&(n={...n,layerContainerType:"ground"},t.forEach(s=>{if("write"in s){const a={};An(s)().write(a,n)&&o.push(a)}else n!=null&&n.messages&&n.messages.push(new S("layer:unsupported",`Layers (${s.title}, ${s.id}) of type '${s.declaredClass}' cannot be persisted in the ground`,{layer:s}))})),e.layers=o}load(t){return this.addResolvingPromise(this._loadFromSource(t)),Promise.resolve(this)}loadAll(){return to(this,t=>{t(this.layers)})}async queryElevation(t,e){await this.load({signal:e==null?void 0:e.signal});const{ElevationQuery:i}=await Z(()=>import("./ElevationQuery-HSxD60s-.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]),import.meta.url);se(e);const n=new i,o=this.layers.filter(Ti).toArray();return n.queryAll(o,t,e)}async createElevationSampler(t,e){await this.load({signal:e==null?void 0:e.signal});const{ElevationQuery:i}=await Z(()=>import("./ElevationQuery-HSxD60s-.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]),import.meta.url);se(e);const n=new i,o=this.layers.filter(Ti).toArray();return n.createSamplerAll(o,t,e)}clone(){const t={opacity:this.opacity,surfaceColor:gi(this.surfaceColor),navigationConstraint:gi(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(t.loadStatus="loaded"),new Zt({resourceInfo:this.resourceInfo}).set(t)}read(t,e){this.resourceInfo||this._set("resourceInfo",{data:t,context:e}),super.read(t,e)}_loadFromSource(t){const e=this.resourceInfo;return e?this._loadLayersFromJSON(e.data,e.context,t):Promise.resolve()}async _loadLayersFromJSON(t,e,i){const n=(e==null?void 0:e.origin)||"web-scene",o=(e==null?void 0:e.portal)||null,s=(e==null?void 0:e.url)||null,{populateOperationalLayers:a}=await Z(async()=>{const{populateOperationalLayers:d}=await import("./layersCreator-BJyy3KAG.js");return{populateOperationalLayers:d}},__vite__mapDeps([21,1,2,3,4,22,23,6,7,8,9,24,25,26,10,12,5,27,28,29,30,31,32,14,15,11,13,16,17,33]),import.meta.url);se(i);const l=[];if(t.layers&&Array.isArray(t.layers)){const d={context:{origin:n,url:s,portal:o,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};l.push(a(this.layers,t.layers,d))}await Promise.allSettled(l)}};function es(t){return t&&"createElevationSampler"in t}function Ti(t){return t.type==="elevation"||es(t)}hn=oo,r([h({json:{read:!1,write:{isRequired:!0}}})],te.prototype,"layers",null),r([io("layers")],te.prototype,"writeLayers",null),r([h({readOnly:!0})],te.prototype,"resourceInfo",void 0),r([h({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:fi,read:{reader:so,source:"transparency"},write:{writer:(t,e)=>{e.transparency=ao(t)},target:"transparency"}}})],te.prototype,"opacity",void 0),r([h({type:me,json:{type:[fi],write:(t,e)=>{e.surfaceColor=t.toJSON().slice(0,3)}}})],te.prototype,"surfaceColor",void 0),r([h({type:Je,json:{write:!0}})],te.prototype,"navigationConstraint",void 0),te=Zt=r([y("esri.Ground")],te);const rt=te,$i={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};function ts(t){let e=null;if(typeof t=="string")if(t in $i){const i=$i[t];e=new rt({resourceInfo:{data:{layers:[i]}}})}else P.getLogger("esri.support.groundUtils").warn(`Unable to find ground definition for: ${t}. Try "world-elevation"`);else e=On(rt,t);return e}let W=class extends co(po(ft.EventedMixin(M))){constructor(e){super(e),this.allLayers=new zt({getCollections:()=>{var i,n,o;return[(i=this.basemap)==null?void 0:i.baseLayers,(n=this.ground)==null?void 0:n.layers,this.layers,(o=this.basemap)==null?void 0:o.referenceLayers]},getChildrenFunction:i=>"layers"in i?i.layers:null}),this.allTables=mo(this),this.basemap=null,this.editableLayers=new zt({getCollections:()=>[this.allLayers],itemFilterFunction:ro}),this.ground=new rt,this._basemapCache=lo()}destroy(){ho(this._basemapCache),this._basemapCache=null,this.allLayers.destroy(),this.allTables.destroy(),this.editableLayers.destroy(),this.basemap=R(this.basemap),R(this.ground),this._set("ground",null)}castBasemap(e){return uo(e,this._basemapCache)}castGround(e){return ts(e)??this._get("ground")}findLayerById(e){return this.allLayers.find(i=>i.id===e)}findTableById(e){return this.allTables.find(i=>i.id===e)}};r([h({readOnly:!0,dependsOn:[]})],W.prototype,"allLayers",void 0),r([h({readOnly:!0})],W.prototype,"allTables",void 0),r([h({type:eo,json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],W.prototype,"basemap",void 0),r([st("basemap")],W.prototype,"castBasemap",null),r([h({readOnly:!0})],W.prototype,"editableLayers",void 0),r([h({type:rt,nonNullable:!0})],W.prototype,"ground",void 0),r([st("ground")],W.prototype,"castGround",null),r([h()],W.prototype,"undoRedo",void 0),W=r([y("esri.Map")],W);const is=W,Ye={widthBreakpoint:{getValue(t){const e=t.viewSize[0],i=t.breakpoints,n=this.values;return e<=i.xsmall?n.xsmall:e<=i.small?n.small:e<=i.medium?n.medium:e<=i.large?n.large:n.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(t){const e=t.viewSize[1],i=t.breakpoints,n=this.values;return e<=i.xsmall?n.xsmall:e<=i.small?n.small:e<=i.medium?n.medium:e<=i.large?n.large:n.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(t){const e=t.viewSize,i=e[0],n=e[1],o=this.values;return n>=i?o.portrait:o.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},Mt={xsmall:544,small:768,medium:992,large:1200};function ns(t){const e=t;return e&&e.xsmall<e.small&&e.small<e.medium&&e.medium<e.large}function xt(t,e){return e?Ye[t].valueToClassName[e].split(" "):[]}const Ml=t=>{let e=class extends t{constructor(...i){super(...i),this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=Mt}initialize(){this.addHandles(b(()=>[this.breakpoints,this.size],()=>this._updateClassNames(),K))}destroy(){this.destroyed||this._removeActiveClassNames()}set breakpoints(i){if(i!==this._get("breakpoints")){if(!ns(i)){const n=JSON.stringify(Mt,null,2);console.warn("provided breakpoints are not valid, using defaults:"+n),i=Mt}this._set("breakpoints",{...i})}}_updateClassNames(){if(!this.container)return;const i=qe.acquire(),n=qe.acquire();let o,s=!1;for(o in Ye){const a=this[o],l=Ye[o].getValue({viewSize:this.size,breakpoints:this.breakpoints});a!==l&&(s=!0,this[o]=l,xt(o,a).forEach(d=>n.push(d)),xt(o,l).forEach(d=>i.push(d)))}s&&(this._applyClassNameChanges(i,n),qe.release(i),qe.release(n))}_applyClassNameChanges(i,n){const o=this.container;o&&(n.forEach(s=>o.classList.remove(s)),i.forEach(s=>o.classList.add(s)))}_removeActiveClassNames(){const i=this.container;if(!i)return;let n;for(n in Ye)xt(n,this[n]).forEach(o=>i.classList.remove(o))}};return r([h()],e.prototype,"breakpoints",null),r([h()],e.prototype,"orientation",void 0),r([h()],e.prototype,"widthBreakpoint",void 0),r([h()],e.prototype,"heightBreakpoint",void 0),e=r([y("esri.views.BreakpointsOwner")],e),e};let he=class extends M{constructor(){super(...arguments),this.items=new x,this._watchUpdatingTracking=new gt,this._callbacks=new Map,this._projector=vi(),this._hiddenProjector=vi()}get needsRender(){return this.items.length>0}get updating(){var e;return((e=this._watchUpdatingTracking)==null?void 0:e.updating)??!1}initialize(){const e=document.createElement("div");e.className="esri-overlay-surface",this._set("surface",e),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),e.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange(()=>this.items,i=>{for(const n of i.added){const o=()=>n.render();this._callbacks.set(n,o),this._projector.append(this.surface,o)}for(const n of i.removed){const o=this._projector.detach(this._callbacks.get(n));this.surface.removeChild(o.domNode),this._callbacks.delete(n)}})}addItem(e){this.items.add(e)}removeItem(e){this.items.remove(e)}destroy(){this.items.removeAll(),this._callbacks.forEach(e=>this._projector.detach(e)),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(e){const i=this._hiddenSurface,n=this._hiddenProjector;let o;const s=()=>(o=e.render(),o);n.append(i,s),n.renderNow();const a={left:0,top:0,right:0,bottom:0};if(o!=null&&o.domNode){const l=o.domNode.getBoundingClientRect();a.left=l.left,a.top=l.top,a.right=l.right,a.bottom=l.bottom}for(n.detach(s);i.firstChild;)i.removeChild(i.firstChild);return a}overlaps(e,i){const n=this.computeBoundingRect(e),o=this.computeBoundingRect(i);return Math.max(n.left,o.left)<=Math.min(n.right,o.right)&&Math.max(n.top,o.top)<=Math.min(n.bottom,o.bottom)}get hasVisibleItems(){return this.items.some(e=>e.visible)}async prepare(){await document.fonts.load(this._fontString()).catch(()=>{})}renderCanvas(e,i){const n=!!(i!=null&&i.disableDecorations);if(!this.items.some(s=>s.visible&&!(n&&s.isDecoration)))return;const o=e.getContext("2d");o.save(),o.font=this._fontString(),this.items.forEach(s=>{n&&s.isDecoration||(o.save(),s.renderCanvas(o),o.restore())}),o.restore()}_fontString(){return`10px ${getComputedStyle(this.surface).fontFamily}`}};r([h({readOnly:!0})],he.prototype,"surface",void 0),r([h({readOnly:!0})],he.prototype,"items",void 0),r([h({readOnly:!0})],he.prototype,"needsRender",null),r([h({readOnly:!0})],he.prototype,"_watchUpdatingTracking",void 0),r([h({readOnly:!0})],he.prototype,"updating",null),he=r([y("esri.views.overlay.ViewOverlay")],he);const ki=he,Tt=[0,0];function os(t){const e=(t.ownerDocument||window.document).defaultView,i=t.getBoundingClientRect();return Tt[0]=i.left+((e==null?void 0:e.pageXOffset)??0),Tt[1]=i.top+((e==null?void 0:e.pageYOffset)??0),Tt}function Pi(t){t&&(t.textContent="",t.parentNode&&t.parentNode.removeChild(t))}function ss(t){const e=document.createElement("div");return t.appendChild(e),e}const xe=16,De=750,as=512,rs=2,Tl=t=>{let e=class extends t{constructor(...i){super(...i),this._freqInfo={freq:xe,time:De},this._overlayRenderTaskHandle=null,this.height=0,this.messagesCommon=null,this.overlay=null,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.ui=null,this.userContent=null,this.width=0,this.widthBreakpoint=null,this.addHandles([b(()=>this.cursor,n=>{const{surface:o}=this;o&&o.setAttribute("data-cursor",n)}),b(()=>this.navigating,n=>{const{surface:o}=this;o&&o.setAttribute("data-navigating",n.toString())})])}initialize(){this.addHandles([b(()=>this.ui,(i,n)=>this._handleUIChange(i,n),K),this.on("focus",()=>this.notifyChange("focused")),this.on("blur",()=>this.notifyChange("focused"))])}destroy(){var i;this.destroyed||((i=this.ui)==null||i.destroy(),this.container=null)}get container(){return this._get("container")??null}set container(i){const n=this._get("container"),o=Xi(i);if(o||typeof i!="string"||P.getLogger(this).error("#container",`element with id '${i}' not found`),n===o)return;if(this._stopMeasuring(),n&&(n.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay&&(this.overlay.destroy(),this._set("overlay",null)),this.root&&(Pi(this.root),this._set("root",null)),this.userContent&&(wi(this.userContent,n),Pi(this.userContent),this._set("userContent",null))),!o)return this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),void this._set("container",null);o.classList.add("esri-view");const s=document.createElement("div");s.className="esri-view-user-storage",wi(o,s),o.appendChild(s),this._set("userContent",s);const a=document.createElement("div");a.className="esri-view-root",o.insertBefore(a,o.firstChild),this._set("root",a);const l=document.createElement("div");l.className="esri-view-surface",l.setAttribute("role","application"),l.tabIndex=0,a.appendChild(l),this._set("surface",l);const d=new ki;a.appendChild(d.surface),this._set("overlay",d),this.addHandles(b(()=>d.needsRender,u=>{u&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=At({render:()=>{var c;return(c=this.overlay)==null?void 0:c.render()}}):this._overlayRenderTaskHandle=ge(this._overlayRenderTaskHandle)})),this.forceDOMReadyCycle(),this._set("container",o),this._startMeasuring()}get focused(){const i=document.activeElement===this.surface;return document.hasFocus()&&i}get size(){return[this.width,this.height]}blur(){var i;(i=this.surface)==null||i.blur()}focus(){var i;(i=this.surface)==null||i.focus()}pageToContainer(i,n,o){const s=this.position;return i-=s?s[0]:0,n-=s?s[1]:0,o?(o[0]=i,o[1]=n):o=[i,n],o}containerToPage(i,n,o){const s=this.position;return i+=s?s[0]:0,n+=s?s[1]:0,o?(o[0]=i,o[1]=n):o=[i,n],o}_handleUIChange(i,n){this.removeHandles("ui"),n&&n!==i&&n.destroy(),i&&(i.view=this,this.addHandles(b(()=>this.root,o=>{i.container=o?ss(o):null},K),"ui")),this._set("ui",i)}_stopMeasuring(){this.removeHandles("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){const i=this._freqInfo;i.freq=xe,i.time=De;const n=At({prepare:a=>{const l=this._measure(),d=this._freqInfo;if(d.time+=a.deltaTime,l&&(d.freq=xe,this._get("resizing")||this._set("resizing",!0)),d.time<d.freq)return;d.time=0;const u=this._position();d.freq=u||l?xe:Math.min(De,d.freq*rs),!l&&d.freq>=as&&(n.pause(),this._get("resizing")&&this._set("resizing",!1))}}),o=new ResizeObserver(a=>{i.freq=xe,i.time=De,n.resume()});this.container!=null&&o.observe(this.container);const s=Yt(()=>o.disconnect());this.addHandles([Fn(window,"resize",()=>{i.freq=xe,i.time=De,n.resume()}),s,n],"measuring"),this._measure(),this._position()}_measure(){const i=this.container,n=i?i.clientWidth:0,o=i?i.clientHeight:0;if(n===0||o===0)return this.suspended||this._set("suspended",!0),!1;const s=this.width,a=this.height;return n===s&&o===a?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",n),this._set("height",o),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:s,oldHeight:a,width:n,height:o}),!0)}_position(){const i=this.container,n=this.position,o=i&&os(i);return!!o&&(!n||o[0]!==n[0]||o[1]!==n[1])&&(this._set("position",[o[0],o[1]]),!0)}forceDOMReadyCycle(){}};return r([h()],e.prototype,"container",null),r([h({readOnly:!0})],e.prototype,"focused",null),r([h({readOnly:!0})],e.prototype,"height",void 0),r([h()],e.prototype,"messagesCommon",void 0),r([h({type:ki})],e.prototype,"overlay",void 0),r([h({readOnly:!0})],e.prototype,"position",void 0),r([h({readOnly:!0})],e.prototype,"resizing",void 0),r([h({readOnly:!0})],e.prototype,"root",void 0),r([h({value:null,readOnly:!0})],e.prototype,"size",null),r([h({readOnly:!0})],e.prototype,"surface",void 0),r([h({readOnly:!0})],e.prototype,"suspended",void 0),r([h({nonNullable:!0})],e.prototype,"ui",void 0),r([h({readOnly:!0})],e.prototype,"userContent",void 0),r([h({readOnly:!0})],e.prototype,"width",void 0),r([h()],e.prototype,"widthBreakpoint",void 0),e=r([y("esri.views.DOMContainer")],e),e};function le(t){return t!=null&&"open"in t&&"declaredClass"in t}function Ci(t){return t!=null&&"declaredClass"in t&&"dockOptions"in t}const $l=t=>{let e=class extends t{constructor(){super(...arguments),this._popupSetupTask=null,this.popup={},this.popupEnabled=!0}initialize(){this.addHandles([b(()=>[this.ui,this.popup],([i,n],o)=>{const s="popup",a="manual";if(o){const[l,d]=o;l&&le(d)&&(d.view=null,Ci(d)&&l.remove(d,s))}i&&le(n)&&(n.view=this,Ci(n)&&i.add(n,{key:s,position:a,internal:!0}))},K),this.on("click",i=>{this.popup&&this.popupEnabled&&(i.pointerType!=="mouse"||i.button===0)&&(le(this.popup)?this.popup.viewModel.handleViewClick(i):i.async(async()=>{await this.setupPopup(),le(this.popup)&&!this.destroyed&&this.ready&&this.popupEnabled&&this.popup.viewModel.handleViewClick(i)}))},en.WIDGET)]),Qi(()=>this.ready&&this.popupEnabled&&!this.updating).then(()=>{Z(()=>import("./Popup-CMV5hdAm.js"),__vite__mapDeps([34,2,1,3,4,35,36,37,7,8,38,26,6,9,39,40,12,5,10,41,13,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,11,59,60,61,62,25,15,63,64,65,66,31,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,14,16,17,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,27,32,181,182,183,184,185,186,187,188,189,190,33,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208]),import.meta.url)})}destroy(){this.destroyed||this.closePopup()}async openPopup(i){if(le(this.popup))return this.popup.open(i);try{if(await this.setupPopup(),!this.popup)return void P.getLogger(this).error(new S("view:null-popup","Popup is null and can't be opened"));this.popup.open(i)}catch{}}closePopup(){var i;(i=this._popupSetupTask)==null||i.abort(),le(this.popup)&&this.popup.close()}async fetchPopupFeatures(i,n){return await this.when(),this._popupHitsToFeatures(await this._getPopupHits(i,n),n)}async setupPopup(){var i;if((i=this._popupSetupTask)==null||i.abort(),this.popup&&!le(this.popup))return this._popupSetupTask=Qt(async n=>{const{default:o}=await Z(()=>import("./Popup-CMV5hdAm.js"),__vite__mapDeps([34,2,1,3,4,35,36,37,7,8,38,26,6,9,39,40,12,5,10,41,13,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,11,59,60,61,62,25,15,63,64,65,66,31,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,14,16,17,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,27,32,181,182,183,184,185,186,187,188,189,190,33,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208]),import.meta.url);if(se(n),!this.popup||le(this.popup))return;const s=this.popup;delete s.open,delete s.close,this.popup=new o(s)}),this._popupSetupTask.promise}async _popupHitsToFeatures({location:i,hits:n},o){const s=[],a=[];let l=!1;const d=Rn(o,we("popup-view-fetch-timeout")??hs),u=p=>{const f=new ls(p);return a.push(f),s.push(f.promise),f},c=p=>{const f=a.at(-1);return f&&f.layerView===p&&!l?f:u(p)};for(const p of n)"graphic"in p?(c(p.layerView).graphics.push(p.graphic),l=!1):(s.push(p.layerView.fetchPopupFeaturesAtLocation(p.mapPoint,d)),l=!0);a.map(p=>p.resolve(d));const g=zn(s).then(p=>p.filter(f=>!!f).flat());return{pendingFeatures:s,allGraphicsPromise:g,location:i}}async _getPopupHits(i,n){const{hits:o,location:s}=await this.popupHitTest(i);se(n);const a=[];for(const l of o)if("graphic"in l){if(this._isValidPopupGraphic(l.graphic,n)){const d=this._isValidPopupGraphicsLayerView(l.layerView)?l.layerView:void 0;a.push({graphic:l.graphic,layerView:d})}}else this._isValidPopupLocationLayerView(l.layerView)&&a.push({mapPoint:l.mapPoint,layerView:l.layerView});return{hits:a,location:s}}_isValidPopupGraphic(i,n){return i&&!!i.getEffectivePopupTemplate(n==null?void 0:n.defaultPopupTemplateEnabled)}_isValidPopupGraphicsLayerView(i){return!i||(!("layer"in i)||!i.suspended)&&"fetchPopupFeaturesFromGraphics"in i}_isValidPopupLocationLayerView(i){return(!("layer"in i)||!i.suspended)&&"fetchPopupFeaturesAtLocation"in i}};return r([h()],e.prototype,"popup",void 0),r([h()],e.prototype,"popupEnabled",void 0),e=r([y("esri.views.PopupView")],e),e};let ls=class{constructor(e){this.layerView=e,this._resolver=dt(),this.graphics=[]}get promise(){return this._resolver.promise}resolve(e){const{layerView:i,graphics:n,_resolver:o}=this;if(!i)return o.resolve(n),o.promise;let s;return i.fetchPopupFeaturesFromGraphics(n,e).catch(a=>(s=a,null)).then(a=>{a?o.resolve(a):o.reject(s)}),o.promise}};const hs=5e3;let lt=class extends _o{constructor(e){super(e),this.addHandles(this.on("before-add",i=>{i.item!=null&&i.item.parent===this.owner&&(P.getLogger(this).warn("Analysis inside the collection must be unique. Not adding this element again."),i.preventDefault())}))}_own(e){e.parent=this.owner}_release(e){e.parent=null}};lt=r([y("esri.support.AnalysesCollection")],lt);let de=class extends M{constructor(e){super(e),this.view=null,this.baseLayerViews=new x,this.referenceLayerViews=new x,this._loadingHandle=b(()=>{var i,n;return(n=(i=this.view)==null?void 0:i.map)==null?void 0:n.basemap},i=>{i&&i.load().catch(()=>{})},K)}destroy(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null);for(const e of this.baseLayerViews)e.destroy();this.baseLayerViews.length=0;for(const e of this.referenceLayerViews)e.destroy();this.referenceLayerViews.length=0}get suspended(){var e;return((e=this.view)==null?void 0:e.suspended)??!0}get updating(){var i,n,o;if((i=this.view)!=null&&i.suspended)return!1;const e=(o=(n=this.view)==null?void 0:n.map)==null?void 0:o.basemap;return!!(e!=null&&e.loaded)&&(this.baseLayerViews.some(s=>s.updating)||this.referenceLayerViews.some(s=>s.updating))}};r([h({constructOnly:!0})],de.prototype,"view",void 0),r([h({readOnly:!0})],de.prototype,"baseLayerViews",void 0),r([h({readOnly:!0})],de.prototype,"referenceLayerViews",void 0),r([h({readOnly:!0})],de.prototype,"suspended",null),r([h({type:Boolean,readOnly:!0})],de.prototype,"updating",null),de=r([y("esri.views.BasemapView")],de);const ds=de;function us(t){return"tryRecycleWith"in t}function cs(t){return t!=null&&typeof t=="object"&&"layerViews"in t}let ps=class{constructor(e,i,n){this.layer=e,this.view=i,this.layerViewImporter=n,this._controller=new AbortController,this._deferred=dt(),this._started=!1,this.done=!1,this.promise=this._deferred.promise,vt(this._controller.signal,()=>{const o=new S("cancelled:layerview-create","layerview creation cancelled",{layer:e});this._deferred.reject(o)})}tryRecycle(e){if(!this.done||!this.layerView||!us(this.layerView))return null;const i=this.layer.type,n=this._controller.signal;for(let o=0;o<e.length;o++){const s=e[o];if(s.type!==i)continue;const a=this.layerView.tryRecycleWith(s,{signal:n});if(a){e.splice(o,1),this.layer=s;const l=this.layerView,d=l.view;return this.promise=Promise.race([a.then(()=>(se(this._controller.signal),s.emit("layerview-destroy",{view:d,layerView:l}),d.emit("layerview-destroy",{view:d,layerView:l}),s.emit("layerview-create",{view:d,layerView:l}),d.emit("layerview-create",{view:d,layerView:l}),l)),new Promise((u,c)=>vt(this._controller.signal,()=>c(Ji())))]),this.promise}}return null}destroy(){this._controller.abort();const{layerView:e}=this;if(e){const{layer:i,view:n}=this;i.emit("layerview-destroy",{view:n,layerView:e}),n.emit("layerview-destroy",{layer:i,layerView:e})}this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null,this._map=null}async start(){var o,s;if(this._started)return;this._started=!0;const{_controller:{signal:e},layer:i,view:n}=this;this._map=n.map;try{let a,l;if(await i.load({signal:e}),i.prefetchResources&&await i.prefetchResources({signal:e}),gs(i))a=await i.createLayerView(n,{signal:e});else{if(!this.layerViewImporter.hasLayerViewModule(i))throw new S("layer:view-not-supported","No layerview implementation was found");const c=await this.layerViewImporter.importLayerView(i);se(e),a="default"in c?new c.default({layer:i,view:n}):new c({layer:i,view:n})}const d=()=>{l=ge(l),a.destroyed||a.destroy(),a.layer=null,a.parent=null,a.view=null,this.done=!0};l=vt(e,d),se(e);try{await a.when()}catch(c){throw d(),c}if(!((s=(o=this._map)==null?void 0:o.allLayers)==null?void 0:s.includes(i)))return d(),void this._deferred.reject(new S("view:no-layerview-for-layer","The layer has been removed from the map",{layer:i}));this.layerView=a,i.emit("layerview-create",{view:n,layerView:a}),n.emit("layerview-create",{layer:i,layerView:a}),this.done=!0,this._deferred.resolve(a)}catch(a){i.emit("layerview-create-error",{view:n,error:a}),n.emit("layerview-create-error",{layer:i,error:a}),this.done=!0,this._deferred.reject(new S("layerview:create-error","layerview creation failed",{layer:i,error:a}))}}},F=class extends M{constructor(e){super(e),this._layerLayerViewInfoMap=new Map,this._recyclingInfoMap=new Map,this._watchUpdatingTracking=new gt,this.supportsGround=!0,this._preloadLayerViewModules=()=>{var n;const i=(n=this.view.map)==null?void 0:n.allLayers;if(i)for(const o of i)this.layerViewImporter.hasLayerViewModule(o)&&this.layerViewImporter.importLayerView(o)},this._reschedule=()=>this.destroyed?Promise.reject():(this._workPromise==null&&(this._workPromise=dt(),this._workPromise.promise.catch(()=>{})),this.removeHandles("reschedule"),this.addHandles(Nn(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{var d,u,c;if(this.destroyed)return;const i=this.view.map;if(this._map!==i&&(this.clear(),this._map=i),this._workPromise==null)return void this.notifyChange("updating");this.removeHandles("reschedule"),this.removeHandles("collection-change");const n=new Set,o=[],s=this.view.ready,a=g=>{if(g!=null){for(const p of g)if(p){n.add(p);const f=this._layerLayerViewInfoMap.get(p);f&&s?f.start():f||this._recyclingInfoMap.has(p)||o.push(p),"layers"in p&&p.layers&&a(p.layers)}}};for(const g of this._rootCollectionNames)a(_t(this,g));for(const[g,p]of this._layerLayerViewInfoMap)if(!n.has(g)){this._layerLayerViewInfoMap.delete(p.layer);const f=p.tryRecycle(o);f?(this.notifyChange("updating"),this._recyclingInfoMap.set(p.layer,p),f.then(()=>{this.notifyChange("updating"),this._recyclingInfoMap.delete(p.layer),this._layerLayerViewInfoMap.set(p.layer,p),this._reschedule()}).catch(()=>{this.notifyChange("updating"),this._recyclingInfoMap.delete(p.layer),p.destroy(),this._reschedule()})):p.destroy()}for(const[g,p]of this._recyclingInfoMap)n.has(g)||(this.notifyChange("updating"),this._recyclingInfoMap.delete(p.layer),p.destroy());for(const g of o)this._createLayerView(g);this._refreshCollections();const l=[(d=i==null?void 0:i.ground)==null?void 0:d.layers,(u=i==null?void 0:i.basemap)==null?void 0:u.baseLayers,(c=i==null?void 0:i.basemap)==null?void 0:c.referenceLayers,i==null?void 0:i.layers].filter(g=>!!g);n.forEach(g=>"layers"in g&&l.push(g.layers)),this.addHandles(l.map(g=>this._watchUpdatingTracking.addOnCollectionChange(()=>g,this._reschedule)),"collection-change"),this._workPromise.resolve(),this._workPromise=null}}initialize(){this.addHandles([ct(()=>{var e,i;return(i=(e=this.view)==null?void 0:e.map)==null?void 0:i.allLayers},"change",this._preloadLayerViewModules,{onListenerAdd:this._preloadLayerViewModules}),b(()=>{const e=this.view,i=e==null?void 0:e.map;return[i==null?void 0:i.basemap,i==null?void 0:i.ground,i==null?void 0:i.layers,e==null?void 0:e.ready]},()=>this._reschedule(),Ft)]),this._preloadLayerViewModules(),this._reschedule()}destroy(){this.clear(),wt(this._recyclingInfoMap),wt(this._layerLayerViewInfoMap),this._watchUpdatingTracking.destroy(),this._map=null,this._workPromise!=null&&(this._workPromise.reject(Ji()),this._workPromise=null)}get _layersToLayerViews(){const e=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&e.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(e)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return this._workPromise!=null||this._watchUpdatingTracking.updating||Hn(this._layerLayerViewInfoMap,e=>!e.done)||this._recyclingInfoMap.size>0}get updatingRemaining(){let e=0;for(const i of this._layerLayerViewInfoMap.values())i.done||++e;return e}clear(){this.destroyed||(wt(this._layerLayerViewInfoMap),this._refreshCollections())}async whenLayerView(e){if(await this._reschedule(),!this._layerLayerViewInfoMap.has(e)){if(this._recyclingInfoMap.has(e))return this._recyclingInfoMap.get(e).promise;throw new S("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:e})}return this._layerLayerViewInfoMap.get(e).promise}isCreatingLayerViewsForLayer(e,i){var s;this.commitProperty("updatingRemaining");const n=this._layerLayerViewInfoMap.get(e);if(!(n!=null&&n.done))return!0;const o=n.layerView;return!(!o||!i||o.parent===i)||!!(n.done&&o&&"layers"in e&&((s=e.layers)!=null&&s.length))&&e.layers.some(a=>this.isCreatingLayerViewsForLayer(a,o))}_refreshCollections(){for(const[e,i]of this._layersToLayerViews)this._populateLayerViewsOwners(_t(this,e),_t(this,i),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining")}_populateLayerViewsOwners(e,i,n){if(!e||!i)return void(i&&i.removeAll());let o=0;for(const s of e){const a=this._layerLayerViewInfoMap.get(s);if(!(a!=null&&a.layerView))continue;const l=a.layerView;l.layer=s,l.parent=n,i.at(o)!==l&&i.splice(o,0,l),"layers"in s&&cs(l)&&this._populateLayerViewsOwners(s.layers,l.layerViews,l),o+=1}o<i.length&&i.splice(o,i.length)}_createLayerView(e){e.load().catch(()=>{}),this.layerViewImporter.hasLayerViewModule(e)&&this.layerViewImporter.importLayerView(e);const i=new ps(e,this.view,this.layerViewImporter);i.promise.then(()=>this._refreshCollections(),n=>{n&&(Jt(n)||n.name==="cancelled:layerview-create")||P.getLogger(this).error(`Failed to create layerview for layer title:'${e.title??"no title"}', id:'${e.id??"no id"}' of type '${e.type}'.`,{layer:e,error:n}),this._refreshCollections()}),this._layerLayerViewInfoMap.set(e,i),this.view.ready&&i.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}};r([h()],F.prototype,"_workPromise",void 0),r([h({readOnly:!0})],F.prototype,"_watchUpdatingTracking",void 0),r([h({readOnly:!0})],F.prototype,"_layersToLayerViews",null),r([h({readOnly:!0})],F.prototype,"_rootCollectionNames",null),r([h()],F.prototype,"layerViewImporter",void 0),r([h()],F.prototype,"supportsGround",void 0),r([h({readOnly:!0})],F.prototype,"updating",null),r([h({readOnly:!0})],F.prototype,"updatingRemaining",null),r([h({constructOnly:!0})],F.prototype,"view",void 0),F=r([y("esri.views.LayerViewManager")],F);const ms=F;function gs(t){return t.createLayerView!==ko.prototype.createLayerView}let D=class extends M{constructor(e){super(e),this.factor=1.5,this.offset=Ne(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};r([h({type:Number})],D.prototype,"factor",void 0),r([h({nonNullable:!0})],D.prototype,"offset",void 0),r([h()],D.prototype,"position",void 0),r([h({type:Number,range:{min:0}})],D.prototype,"size",void 0),r([h()],D.prototype,"maskUrl",void 0),r([h()],D.prototype,"maskEnabled",void 0),r([h()],D.prototype,"overlayUrl",void 0),r([h()],D.prototype,"overlayEnabled",void 0),r([h({readOnly:!0})],D.prototype,"version",null),r([h({type:Boolean})],D.prototype,"visible",void 0),D=r([y("esri.views.Magnifier")],D);const dn=D;let B=class extends ft.EventedAccessor{constructor(e){super(e),this._selectionMap=new Po,this._sources=new x,this._trashCan=[],this._layerEditHandles=new x,this._vizTaskId=0,this.showHighlight=!0,this.highlightName="default"}initialize(){this.addHandles([b(()=>[this.view,this.showHighlight],()=>this._refreshVisualization()),ct(()=>this.sources,"change",i=>{const n=this._selectionMap;for(const o of i.removed)n.delete(o);this._refreshListeners(),this._refreshVisualization()},{onListenerAdd:()=>this._refreshListeners()})]);const e=new x;this.view.when().then(()=>{this.view.map&&(this.view.map.allLayers.flatten(i=>"sublayers"in i&&i.sublayers?i.sublayers:null).forEach(i=>{(je(i)&&!Co(i)||ye(i))&&e.add(i)}),this.sources=e)})}destroy(){this._layerEditHandles.drain(ge)}get selections(){return Array.from(this._selectionMap.entries()).map(e=>{const[i,n]=e;return{layer:i,selection:[...n.selection]}})}get count(){let e=0;for(const i of this._selectionMap.values())e+=i.selection.length;return e}get hasSelection(){return this.count>0}get sources(){return this._sources}set sources(e){ei(e,this._sources)}async getSelectedFeatures(e,i={},n="layerView"){const{view:o,selections:s}=this,a=(e!==void 0?s.filter(l=>e.includes(l.layer)):s).filter(l=>l.selection.length>0).map(async l=>{const{layer:d,selection:u}=l,c=ye(d)?d.parent:d;if(c==null||!Ei(c))return null;if(n==="layer")return Ii(c,u,i);if(Si(c))return null;const g=await o.whenLayerView(c).catch(()=>null);return g?Ii(g,u,i):null});return(await Promise.all(a)).filter(l=>l!=null)}updateSelection(e){const i=new Map;for(const[s,a]of this._selectionMap)i.set(s,[...a.selection]);let n=!1;const o=e.current.concat(e.added);for(const s of o){const a=s.sourceLayer,l=s.getObjectId();if(this.sources.includes(a)&&(je(a)||ye(a))&&l!==null){const d=Wn(i,a,()=>[]);d.includes(l)||(d.push(l),n=!0)}}for(const s of e.removed){const a=s.sourceLayer,l=s.getObjectId();if(this.sources.includes(a)&&(je(a)||ye(a))&&l!==null){const d=i.get(a),u=d==null?void 0:d.indexOf(l);u!==void 0&&u>=0&&(d==null||d.splice(u,1),n=!0)}}if(n){const{_selectionMap:s,_trashCan:a}=this,l=[];for(const[d,u]of i){const c=s.get(d);c!==void 0&&a.push(c),s.set(d,{selection:u}),l.push({layer:d,selection:u,...yi(c!==void 0?c.selection:[],u)})}this._onSelectionChange(l)}}setSelection(e,i){this._setSelection(e,i)}getSelection(e){const i=this._selectionMap.get(e);return i==null?void 0:i.selection}appendToSelection(e,i){const n=this._selectionMap.get(e),o=n!==void 0?[...n.selection]:[];for(const s of i)o.includes(s)||o.push(s);this._setSelection(e,o)}removeFromSelection(e,i){const n=this._selectionMap.get(e);if(!n)return;const o=[];for(const s of n.selection)i.includes(s)||o.push(s);this._setSelection(e,o)}toggleInSelection(e,i){const n=this._selectionMap.get(e);if(!n||n.selection.length===0)return void this._setSelection(e,i);const o=new Set(n.selection),s=new Set(i),a=Zn(o,s);this._setSelection(e,Array.from(a))}clear(){const e=this._selectionMap.values();this._trashCan.push(...e);const i=[];for(const[n,o]of this._selectionMap.entries())i.push({layer:n,added:[],removed:[...o.selection],selection:[]});this._selectionMap.clear(),this._onSelectionChange(i)}_onSelectionChange(e){this._refreshVisualization(),this.emit("selection-change",{view:this.view,changes:e})}_refreshVisualization(){var a;if(this.view==null||this.sources==null)return;for(this._vizTaskId++;this._trashCan.length>0;){const l=this._trashCan.pop();(a=l==null?void 0:l.highlightHandle)==null||a.remove()}const{sources:e,view:i,_selectionMap:n,showHighlight:o}=this,s=this._vizTaskId;for(const l of e){const d=n.get(l),u=ye(l)?l.parent:l;if(u!=null&&Ei(u)){if(Si(u))continue;i.whenLayerView(u).then(c=>{var g;(g=d==null?void 0:d.highlightHandle)==null||g.remove(),d!=null&&o&&s===this._vizTaskId&&"highlight"in c&&typeof c.highlight=="function"&&d.selection.length>0&&(d.highlightHandle=c.highlight(d.selection,this.highlightName))}).catch(()=>{var c;(c=d==null?void 0:d.highlightHandle)==null||c.remove()})}}}_refreshListeners(){this._layerEditHandles.drain(ge);for(const e of this.sources){const i=ye(e)?e.parent:e;if(i!=null&&je(i)){const n=i.on("edits",o=>{this._handleEditChanges(o,e)});this._layerEditHandles.push(n)}}}_handleEditChanges(e,i){if(e.deletedFeatures!==void 0&&e.deletedFeatures.length>0&&this._selectionMap.has(i)){const n=e.deletedFeatures.filter(o=>o.error==null).map(o=>o.objectId).filter(Yi);this.removeFromSelection(i,n)}}_setSelection(e,i){if(!this.sources.includes(e))throw new Error(`Cannot set selection on layer ${e.title} because it is not in 'sources'`);const n=this._selectionMap.get(e);if(n===void 0||!ys(n,{selection:i})){n!==void 0&&this._trashCan.push(n),this._selectionMap.set(e,{selection:[...i]});const o={layer:e,selection:[...i],...yi(n!==void 0?n.selection:[],i)};this._onSelectionChange([o])}}};r([h({readOnly:!0,nonNullable:!0})],B.prototype,"selections",null),r([h({readOnly:!0,nonNullable:!0})],B.prototype,"count",null),r([h({constructOnly:!0,nonNullable:!0})],B.prototype,"view",void 0),r([h({readOnly:!0,nonNullable:!0})],B.prototype,"hasSelection",null),r([h()],B.prototype,"showHighlight",void 0),r([h()],B.prototype,"sources",null),r([h()],B.prototype,"highlightName",void 0),B=r([y("esri.views.SelectionManager")],B);const Si=t=>{var e;return ye(t)?((e=t.parent)==null?void 0:e.isTable)===!0:t.isTable},fs=t=>t.layer!==void 0,Ei=t=>(t==null?void 0:t.when)!==void 0,ys=(t,e)=>{if(t==null&&e==null)return!0;if(t!=null&&e==null||t==null&&e!=null)return!1;if(t!=null&&e!=null&&t.selection!=null&&e.selection!=null){const i=[...t.selection],n=[...e.selection];if(i.length!==n.length)return!1;i.sort(),n.sort();for(let o=0;o<i.length;o++)if(i[o]!==n[o])return!1}return!0},Ii=async(t,e,i={})=>{let n;if(fs(t)){const o=t;n=o===void 0?null:await o.queryFeatures(new Mi({...i,objectIds:e})).then(s=>({data:s,layer:t.layer}))}else{const o=t;n=o===void 0?null:await o.queryFeatures(new Mi({...i,objectIds:e})).then(s=>({data:s,layer:o}))}return n},_s=B;let Ae=class extends So.ClonableMixin(M){constructor(e){super(e),this.accentColor=new me([255,127,0]),this.textColor=new me([255,255,255])}};r([h({type:me,nonNullable:!0})],Ae.prototype,"accentColor",void 0),r([h({type:me,nonNullable:!0})],Ae.prototype,"textColor",void 0),Ae=r([y("esri.views.Theme")],Ae);const qt=Ae;function vs(t){return[t.on("before-add",e=>{const i=e.item;if(i==null||t.includes(i))return P.getLogger("esri.views.interactive.interactiveToolUtils").warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void e.preventDefault();i.onAdd()}),t.on("after-remove",e=>{const i=e.item;i.active&&(i.view.activeTool=null),i.destroy()})]}function jt(t){return t.visible&&t.getEditableFlag!=null&&t.getEditableFlag(Ht.USER)&&t.getEditableFlag(Ht.MANAGER)}let ws=class{constructor(){this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._externallyDragging=!1,this._revertToNullActiveTool=!1,this._cursor=null}get cursor(){return this._cursor}hasFocusedManipulators(){return this._grabbedManipulators.size>0||this._draggedManipulators.size>0}handleInputEvent(e,i){const n=()=>e.stopPropagation();switch(e.type){case"pointer-move":Di(e.pointerType)&&this._pointerLocations.set(e.pointerId,{x:e.x,y:e.y,pointerType:e.pointerType});break;case"drag":this._grabbedManipulators.size>0?this._stopDrag=!0:e.action==="start"?this._externallyDragging=!0:e.action==="end"&&(this._externallyDragging=!1),this._stopDrag&&(n(),e.action==="end"&&(this._stopDrag=!1));break;case"pointer-down":{if(!Vi(e))break;const o=Q(e),s=Te(o,e.pointerType,i.forEachTool);if(s==null)break;const a=s.manipulator,l=s.tool;a==null||l==null||!a.interactive||a.grabbable&&a.grabbableForEvent(e)||!a.grabbing||a.dragging||this._releaseManipulatorBeforeDragging(a,e,i),a!=null&&l!=null&&a.interactive&&a.grabbable&&a.grabbableForEvent(e)&&!a.grabbing&&(this._grabbedManipulators.set(e.pointerId,{manipulator:a,tool:l,start:o,pointerType:e.pointerType}),this._grabbedManipulators.size===1&&i.activeTool==null&&(this._revertToNullActiveTool=!0,i.setActiveTool(s.tool)),a.grabbing=!0,a.events.emit("grab-changed",{action:"start",pointerType:e.pointerType,screenPoint:o}),n());break}case"pointer-up":this._draggedManipulators.has(e.pointerId)||this._handlePointerEnd(e,i);break;case"pointer-drag":{if(!Vi(e))break;const o=this._grabbedManipulators.get(e.pointerId),s=o==null?void 0:o.manipulator,a=o==null?void 0:o.tool;if(s==null||a==null)break;const l=Q(e);l.x=at(l.x,0,i.view.width),l.y=at(l.y,0,i.view.height);const d=o.start,u=this._draggedManipulators.get(e.pointerId);switch(e.action){case"start":case"update":e.action!=="update"&&this._grabbedManipulators.size!==1||(s.dragging=!0,u?s.events.emit("drag",{action:"update",start:d,screenPoint:l}):s.events.emit("drag",{action:"start",start:d,screenPoint:l,pointerType:e.pointerType}),this._draggedManipulators.set(e.pointerId,{tool:a,manipulator:s,start:d}));break;case"end":s.dragging=!1,u&&s.events.emit("drag",{action:"end",start:d,screenPoint:l}),this._draggedManipulators.delete(e.pointerId),this._handlePointerEnd(e,i)}n();break}case"immediate-click":{const o=Q(e),s=Te(o,e.pointerType,i.forEachTool);if(bs(e)||i.forEachTool(u=>{if((s==null||s.tool!==u||u.automaticManipulatorSelection)&&u.manipulators){let c=!1;u.manipulators.forEach(({manipulator:g})=>{g.selected&&(g.selected=!1,c=!0)}),c&&u.onManipulatorSelectionChanged&&u.onManipulatorSelectionChanged()}}),s==null)break;const{manipulator:a,tool:l}=s;if(!a.interactive)break;a.selectable&&l.automaticManipulatorSelection&&(a.selected=!a.selected,l.onManipulatorSelectionChanged&&l.onManipulatorSelectionChanged());const d=e.native.shiftKey;a.events.emit("immediate-click",{screenPoint:o,button:e.button,pointerType:e.pointerType,shiftKey:d,stopPropagation:n}),$t(a,n);break}case"click":{const o=Q(e),s=Te(o,e.pointerType,i.forEachTool),a=s==null?void 0:s.manipulator;if(a==null||!a.interactive)break;const l=e.native.shiftKey;a.events.emit(e.type,{screenPoint:o,button:e.button,pointerType:e.pointerType,shiftKey:l}),n();break}case"double-click":{const o=Q(e),s=Te(o,e.pointerType,i.forEachTool),a=s!=null?s.manipulator:null;if(a==null||!a.interactive)break;const l=e.native.shiftKey;a.events.emit("double-click",{screenPoint:o,button:e.button,pointerType:e.pointerType,shiftKey:l,stopPropagation:n}),$t(a,n);break}case"immediate-double-click":{const o=Q(e),s=Te(o,e.pointerType,i.forEachTool),a=s!=null?s.manipulator:null;if(a==null||!a.interactive)break;const l=e.native.shiftKey;a.events.emit("immediate-double-click",{screenPoint:o,button:e.button,pointerType:e.pointerType,shiftKey:l,stopPropagation:n}),e.pointerType==="mouse"&&$t(a,n);break}}this._onFocusChange(i.forEachTool)}_releaseManipulatorBeforeDragging(e,i,n){e.grabbing=!1,e.events.emit("grab-changed",{action:"end",pointerType:i.pointerType,screenPoint:Q(i)}),this._grabbedManipulators.forEach(({manipulator:o},s)=>{o===e&&this._grabbedManipulators.delete(s)}),this._afterManipulatorRelease(n.setActiveTool)}_handlePointerEnd(e,i){var o;const n=(o=this._grabbedManipulators.get(e.pointerId))==null?void 0:o.manipulator;n!=null&&n.grabbing&&(n.grabbing=!1,n.events.emit("grab-changed",{action:"end",pointerType:e.pointerType,screenPoint:Q(e)}),this._grabbedManipulators.delete(e.pointerId),this._afterManipulatorRelease(i.setActiveTool))}_onFocusChange(e){this._updateCursor(),this._updateFocusedManipulatorTools(e)}_updateCursor(){this._grabbedManipulators.size>0?this._cursor=Li(this._grabbedManipulators)||"grabbing":this._hoveredManipulators.size>0?this._cursor=Li(this._hoveredManipulators)||"pointer":this._cursor=null}_updateFocusedManipulatorTools(e){const i=new Set,n=new Set;this._grabbedManipulators.forEach(({tool:o})=>{i.add(o)}),this._hoveredManipulators.forEach(({tool:o})=>{n.add(o)}),e(o=>{o.hasGrabbedManipulators=i.has(o),o.hasHoveredManipulators=n.has(o);const s=this._grabbedManipulators.values(),a=qn(s,({tool:l})=>l===o);o.firstGrabbedManipulator=a!=null?a.manipulator:null})}clearPointers(e,{forEachTool:i,setActiveTool:n},o=!0,s){const a=(l,d)=>l===e&&(s==null||s===d);this._grabbedManipulators.forEach(({tool:l,manipulator:d,pointerType:u},c)=>{a(l,d)&&(this._grabbedManipulators.delete(c),d.grabbing=!1,d.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:u}))}),this._draggedManipulators.forEach(({tool:l,manipulator:d},u)=>{a(l,d)&&(this._draggedManipulators.delete(u),d.dragging=!1,d.events.emit("drag",{action:"cancel"}))}),o&&this._hoveredManipulators.forEach(({tool:l,manipulator:d},u)=>{a(l,d)&&(this._hoveredManipulators.delete(u),d.hovering=!1)}),this._afterManipulatorRelease(n),this._onFocusChange(i)}updateHoveredStateFromKnownPointers(e){this._pointerLocations.forEach((i,n)=>{this._updateHoveredStateForPointerAtScreenPosition(Ne(i.x,i.y),n,i.pointerType,e)})}handleHoverEvent(e,i){const n=e.type;n!=="pointer-up"&&n!=="immediate-click"&&n!=="pointer-move"||!Di(e.pointerType)||(n!=="pointer-up"&&this._externallyDragging?this._clearHoveredManipulatorStates(e.pointerId):this._updateHoveredStateForPointerAtScreenPosition(Q(e),e.pointerId,e.pointerType,i))}_updateHoveredStateForPointerAtScreenPosition(e,i,n,o){var l;let s=Te(e,n,o);const a=(l=this._hoveredManipulators.get(i))==null?void 0:l.manipulator;s==null||s.manipulator.interactive||(s=null),s!=null&&a===s.manipulator||(a!=null&&(a.hovering=!1),s!=null?(s.manipulator.hovering=!0,this._hoveredManipulators.set(i,s)):this._hoveredManipulators.delete(i),this._onFocusChange(o))}_afterManipulatorRelease(e){this._grabbedManipulators.size===0&&this._revertToNullActiveTool&&(e(null),this._revertToNullActiveTool=!1)}_clearHoveredManipulatorStates(e){this._hoveredManipulators.forEach(({manipulator:i},n)=>{e===n&&(this._hoveredManipulators.delete(e),i.hovering=!1)})}};function Li(t){for(const{manipulator:e}of t.values())if(e!=null&&e.interactive){if(e.grabbing&&e.grabCursor)return e.grabCursor;if(e.cursor)return e.cursor}return null}function Te(t,e,i){let n=null;return i(o=>{if(o.manipulators==null||!jt(o))return!1;const s=o.manipulators.intersect(t,e);return s!=null&&(n={tool:o,manipulator:s},!0)}),n}function Di(t){return t==="mouse"}function Vi(t){return t.pointerType!=="mouse"||t.button===0}function bs(t){return!!t.native.shiftKey}function $t(t,e){t!=null&&t.consumesClicks&&e()}const Ai="attached",kt="tools",Ms=1e3;let U=class extends M{constructor(e){super(e),this._updatingHandles=new gt,this._clock=ut,this._manipulatorState=new ws,this.tools=new x,this.cursor=null,this._interacting=!1,this._interactingTimeout=Ms,this._interactingTimeoutHandle=null,this._forEachTool=i=>{for(const n of this.tools.items)if(i(n))return}}initialize(){this.addHandles([this.view.on(Eo,e=>{this._handleInputEvent(e)},en.TOOL),...vs(this.tools),this.tools.on("before-add",({item:e})=>{this._updateToolEditableFlag(e)}),this.tools.on("before-remove",({item:e})=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()}),this.tools.on("change",()=>{this._refreshToolWatchers()})])}destroy(){this.activeTool=null,this.tools.drain(e=>e.destroy()),this._clearInteractingTimeout(),this._interacting=!1,this._updatingHandles.destroy()}get _manipulatorStateEventArgs(){return{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:e=>{this.activeTool=e},view:this.view}}set activeTool(e){if(e!=null&&!this.view.ready)return void P.getLogger(this).error("Cannot set active tool while view is not ready.");if(e===this.activeTool)return;const i=this.activeTool;this._set("activeTool",e),i!=null&&i.deactivate(),e!=null&&e.activate(),this._removeIncompleteTools(e);for(const n of this.tools){this._updateToolEditableFlag(n);const o=jt(n);this.activeTool!=null&&o||this._manipulatorState.clearPointers(n,this._manipulatorStateEventArgs,!o)}this._updateCursor()}get updating(){return this._updatingHandles.updating||this.tools.some(e=>e.updating)}get interacting(){return this._interacting}_clearInteractingTimeout(){this._interactingTimeoutHandle=ge(this._interactingTimeoutHandle)}_startInteractingTimeout(){this._clearInteractingTimeout(),this._interactingTimeoutHandle=this._clock.setTimeout(()=>this._interacting=!1,this._interactingTimeout)}attach(){var e;this.view.type==="3d"?this.addHandles([b(()=>{const{state:i}=this.view;return"camera"in i&&i.camera},()=>this._forEachManipulator(i=>i.onViewChange())),(e=this.view.elevationProvider)==null?void 0:e.on("elevation-change",i=>this._forEachManipulator(n=>n.onElevationChange(i)))],Ai):this.addHandles(b(()=>this.view.extent,()=>this._forEachManipulator(i=>i.onViewChange())))}detach(){this.activeTool=null,this.tools.removeAll(),this.removeHandles(Ai),this._clearInteractingTimeout(),this._interacting=!1}_forEachManipulator(e){this._forEachTool(i=>{i.manipulators&&i.manipulators.forEach(({manipulator:n})=>e(n,i))})}_handleInputEvent(e){let i=!1;const n={...e,stopPropagation:()=>{i=!0,e.stopPropagation()}};this.activeTool!=null?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(n):this._forEachTool(o=>{!i&&o.visible&&o.handleInputEvent(n)}),!i&&e.type==="key-down"&&e.key==="Escape"&&this.activeTool&&(e.stopPropagation(),this.activeTool=null),this._manipulatorState.handleInputEvent(n,this._manipulatorStateEventArgs),i||this.activeTool==null||this.activeTool.handleInputEventAfter(n),this._manipulatorState.handleHoverEvent(n,this._forEachTool),this._updateCursor(),e.type==="pointer-move"&&(this._manipulatorState.hasFocusedManipulators()||this.activeTool)&&(this._interacting=!0,this._startInteractingTimeout())}_refreshToolWatchers(){this.removeHandles(kt),this._forEachTool(e=>{if(e instanceof M){const i=b(()=>[e.cursor,e.visible,e.editable],()=>{jt(e)||this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()});this.addHandles(i,kt)}e.manipulators&&this.addHandles([e.manipulators.on("after-remove",i=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs,!0,i.item.manipulator)}),e.manipulators.on("change",()=>{this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()})],kt)}),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}_updateToolEditableFlag(e){var i;(i=e.setEditableFlag)==null||i.call(e,Ht.MANAGER,this.activeTool==null||e===this.activeTool)}_updateCursor(){let e=this._manipulatorState.cursor;e==null&&this._forEachTool(i=>!(i.cursor==null||!i.visible)&&(e=i.cursor,!0)),this._get("cursor")!==e&&this._set("cursor",e)}_removeIncompleteTools(e){this.tools.filter(i=>(e==null||i!==e)&&!i.created&&i.removeIncompleteOnCancel).forEach(i=>{this.tools.remove(i)})}get test(){}};r([h({constructOnly:!0,nonNullable:!0})],U.prototype,"view",void 0),r([h({value:null})],U.prototype,"activeTool",null),r([h({readOnly:!0,type:x})],U.prototype,"tools",void 0),r([h({readOnly:!0})],U.prototype,"cursor",void 0),r([h({readOnly:!0})],U.prototype,"updating",null),r([h()],U.prototype,"_interacting",void 0),r([h({readOnly:!0})],U.prototype,"interacting",null),U=r([y("esri.views.ToolViewManager")],U);var Bt;let V=Bt=class extends M{constructor(t){super(t),this.name=an,this.color=Vo.clone(),this.haloColor=null,this.haloOpacity=Ao,this.fillOpacity=Oo,this.shadowColor=Fo.clone(),this.shadowOpacity=Ro,this.shadowDifference=zo,this.haloWidth=2.1,this.haloBlur=.8/this.haloWidth}equals(t){return this.color.equals(t.color)&&(this.haloColor||this.color).equals(t.haloColor||t.color)&&this.haloOpacity===t.haloOpacity&&this.fillOpacity===t.fillOpacity&&this.haloWidth===t.haloWidth&&this.haloBlur===t.haloBlur&&this.shadowColor.equals(t.shadowColor)&&this.shadowOpacity===t.shadowOpacity&&this.shadowDifference===t.shadowDifference}clone(){var t,e;return new Bt({...this,color:this.color.clone(),haloColor:(t=this.haloColor)==null?void 0:t.clone(),shadowColor:(e=this.shadowColor)==null?void 0:e.clone()})}assignFrom(t){var e;this.color=t.color.clone(),this.haloColor=(e=t.haloColor)==null?void 0:e.clone(),this.haloOpacity=t.haloOpacity,this.fillOpacity=t.fillOpacity,this.shadowColor=t.shadowColor.clone(),this.shadowDifference=t.shadowDifference,this.shadowOpacity=t.shadowOpacity,this.haloBlur=t.haloBlur,this.haloWidth=t.haloWidth}};r([h({type:String,constructOnly:!0,nonNullable:!0})],V.prototype,"name",void 0),r([h({type:me,nonNullable:!0})],V.prototype,"color",void 0),r([h({type:me})],V.prototype,"haloColor",void 0),r([h({nonNullable:!0})],V.prototype,"haloOpacity",void 0),r([h({nonNullable:!0})],V.prototype,"fillOpacity",void 0),r([h({type:me,nonNullable:!0})],V.prototype,"shadowColor",void 0),r([h({nonNullable:!0})],V.prototype,"shadowOpacity",void 0),r([h({nonNullable:!0})],V.prototype,"shadowDifference",void 0),r([h({nonNullable:!0})],V.prototype,"haloWidth",void 0),r([h({nonNullable:!0})],V.prototype,"haloBlur",void 0),V=Bt=r([y("esri.views.support.HighlightOptions")],V);const Re=V;function xs(){return new(x.ofType(Re))([new Re({name:an}),new Re({name:Ho,color:No})])}let Ce=class extends M{constructor(e){super(),this.nativeIndex=null,this._detectedDeviceType="unknown",e.mapping==="standard"?this._detectedDeviceType="standard":Ts.test(e.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=e.index}get native(){const e=navigator.getGamepads?navigator.getGamepads():[];return this.nativeIndex!=null&&this.nativeIndex<e.length?e[this.nativeIndex]:null}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return $s[this.deviceType]}};r([h({nonNullable:!0,readOnly:!0})],Ce.prototype,"nativeIndex",void 0),r([h({type:String,readOnly:!0})],Ce.prototype,"deviceType",null),r([h({type:Number,readOnly:!0})],Ce.prototype,"axisThreshold",null),Ce=r([y("esri.views.input.gamepad.GamepadInputDevice")],Ce);const ti=Ce,Ts=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),$s={standard:.15,spacemouse:.025,unknown:0};let Oe=class extends M{constructor(...e){super(...e),this.devices=new x,this.enabledFocusMode="document"}};r([h({type:x.ofType(ti),readOnly:!0})],Oe.prototype,"devices",void 0),r([h({type:["document","view","none"]})],Oe.prototype,"enabledFocusMode",void 0),Oe=r([y("esri.views.input.gamepad.GamepadSettings")],Oe);const ks=Oe;let Qe=class extends M{constructor(){super(...arguments),this.gamepad=new ks}};r([h({readOnly:!0})],Qe.prototype,"gamepad",void 0),Qe=r([y("esri.views.input.Input")],Qe);const Ps=Qe,Pt=()=>h({type:["pan","rotate","zoom","none"],nonNullable:!0});let _e=class extends M{constructor(e){super(e),this.dragPrimary="pan",this.dragSecondary="rotate",this.dragTertiary="zoom",this.mouseWheel="zoom"}};r([Pt()],_e.prototype,"dragPrimary",void 0),r([Pt()],_e.prototype,"dragSecondary",void 0),r([Pt()],_e.prototype,"dragTertiary",void 0),r([h({type:["zoom","none"],nonNullable:!0})],_e.prototype,"mouseWheel",void 0),_e=r([y("esri.views.navigation.NavigationActionMap")],_e);const un=_e;let ue=class extends M{constructor(e){super(e),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1}};r([h({type:Boolean,nonNullable:!0})],ue.prototype,"enabled",void 0),r([h({type:ti})],ue.prototype,"device",void 0),r([h({type:["pan","zoom"],nonNullable:!0})],ue.prototype,"mode",void 0),r([h({type:["forward-down","forward-up"],nonNullable:!0})],ue.prototype,"tiltDirection",void 0),r([h({type:Number,nonNullable:!0})],ue.prototype,"velocityFactor",void 0),ue=r([y("esri.views.navigation.gamepad.GamepadSettings")],ue);const cn=ue;let ce=class extends M{constructor(e){super(e),this.actionMap=new un,this.browserTouchPanEnabled=!0,this.gamepad=new cn,this.momentumEnabled=!0}get effectiveMomentumEnabled(){return this.momentumEnabled&&!Wo()}get mouseWheelZoomEnabled(){return this.actionMap.mouseWheel==="zoom"}set mouseWheelZoomEnabled(e){jn(P.getLogger(this),"mouseWheelZoomEnabled",{replacement:"actionMap.mouseWheel",version:"4.32",warnOnce:!0}),this.actionMap.mouseWheel=e?"zoom":"none"}};r([h({type:un,nonNullable:!0})],ce.prototype,"actionMap",void 0),r([h({type:Boolean})],ce.prototype,"browserTouchPanEnabled",void 0),r([h({type:cn,nonNullable:!0})],ce.prototype,"gamepad",void 0),r([h({type:Boolean})],ce.prototype,"momentumEnabled",void 0),r([h({type:Boolean})],ce.prototype,"mouseWheelZoomEnabled",null),ce=r([y("esri.views.navigation.Navigation")],ce);const pn=ce;let Ut,Ct=null;async function Cs(t){Ct||(Ct=Z(()=>import("./geometryServiceUtils-CW7bdn7_.js"),__vite__mapDeps([209,2,25,7,8,6,9,26,10,12,5,210,58,11,13,105,109]),import.meta.url).then(e=>Ut=e)),await Ct,se(t)}async function mn(t,e,i,n){if(!t)return null;const o=t.spatialReference;return Bo()||Uo(o,e)?jo(t,e):Ut?Ut.projectGeometry(t,e,i,n):(await Promise.race([Cs(n),Go(n)]),mn(t,e,i,n))}let v=class extends M{constructor(e){super(e),this.required={extent:!1,heightModelInfo:!1,tileInfo:!1},this.defaultSpatialReference=null,this.userSpatialReference=null,this.sourcePreloadCount=10,this.priorityCollection=null,this.requiresExtentInSpatialReference=!0,this.suspended=!1,this._projectExtentTask={task:null,input:null,output:null,spatialReference:null}}destroy(){this._projectExtentTask.task&&(this._projectExtentTask.task=Ot(this._projectExtentTask.task)),this._set("map",null)}get ready(){return!this._spatialReferenceTask.updating&&!this._tileInfoTask.updating&&!this._extentTask.updating}get heightModelInfoReady(){return!this._heightModelInfoTask.updating}get spatialReference(){return this.userSpatialReference??this._spatialReferenceTask.spatialReference}get extent(){return this._extentTask.extent}get heightModelInfo(){return this._heightModelInfoTask.heightModelInfo}get vcsWkid(){return this._heightModelInfoTask.vcsWkid}get latestVcsWkid(){return this._heightModelInfoTask.latestVcsWkid}get viewingMode(){return this.userSpatialReference==null||this.userSpatialReference.equals(this._spatialReferenceTask.spatialReference)?this._spatialReferenceTask.viewingMode:null}get tileInfo(){return this._tileInfoTask.tileInfo}get mapCollections(){var n,o,s,a;const e=(n=this.map)==null?void 0:n.call(this),i=[];return this.priorityCollection!=null&&i.push(this.priorityCollection),i.push({parent:e==null?void 0:e.basemap,layers:(o=e==null?void 0:e.basemap)==null?void 0:o.baseLayers},{layers:e==null?void 0:e.layers},{parent:e==null?void 0:e.ground,layers:(s=e==null?void 0:e.ground)==null?void 0:s.layers},{parent:e==null?void 0:e.basemap,layers:(a=e==null?void 0:e.basemap)==null?void 0:a.referenceLayers}),i}get _spatialReferenceTask(){if(this.suspended)return this._get("_spatialReferenceTask")??{updating:!1};let e;if(this._collectLayers(this.mapCollections,n=>{const o=this._getSupportedSpatialReferences(n);if(o.length>0){const s=this._narrowDownSpatialReferenceCandidates(e,o);s!=null&&(e=s)}return(e==null?void 0:e.length)===1})&&(e==null?void 0:e.length)!==1)return{updating:!0};const i=this._pickSpatialReferenceCandidate(e);return{spatialReference:(i==null?void 0:i.spatialReference)??null,viewingMode:(i==null?void 0:i.viewingMode)??null,updating:!1}}get _tileInfoTask(){var s,a;if(!this.required.tileInfo)return this._get("_tileInfoTask")??{updating:!1};const e=(s=this.map)==null?void 0:s.call(this),i=this.spatialReference;if(!i)return{updating:this._spatialReferenceTask.updating};let n;const o=this._collectLayers([{parent:e==null?void 0:e.basemap,layers:(a=e==null?void 0:e.basemap)==null?void 0:a.baseLayers},{layers:e==null?void 0:e.layers}],l=>{var d;return!(!("tileInfo"in l)||!((d=l.tileInfo)!=null&&d.spatialReference.equals(i)))&&(n=l,!0)},l=>"tileInfo"in l);return n?{tileInfo:n.tileInfo,updating:!1}:{updating:o}}get _heightModelInfoTask(){var n;if(!this.required.heightModelInfo||this.suspended&&((n=this._get("_heightModelInfoTask"))!=null&&n.heightModelInfo))return this._get("_heightModelInfoTask")??{updating:!1};let e={};const i=this._collectLayers(this.mapCollections,o=>{var a,l;const s=Zo(o);return!!s&&(e={heightModelInfo:s,vcsWkid:(a=o.spatialReference)==null?void 0:a.vcsWkid,latestVcsWkid:(l=o.spatialReference)==null?void 0:l.latestVcsWkid},!0)},o=>qo(o));return{...e,updating:i}}get _extentCandidatesTask(){if(this.suspended||!this.required.extent)return this._get("_extentCandidatesTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const e=[],i=this._collectLayers(this.mapCollections,n=>{const o="fullExtents"in n&&n.fullExtents||(n.fullExtent!=null?[n.fullExtent]:[]),s=this.requiresExtentInSpatialReference?null:o[0],a=o.find(l=>l.spatialReference.equals(this.spatialReference))??s;if(a)return e.push({extent:a,layer:n}),!0;if(this._getSupportedSpatialReferences(n).length>0)for(const l of o)e.push({extent:l,layer:n});return!1});return{candidates:e,updating:i}}get _extentTask(){const{candidates:e,updating:i}=this._extentCandidatesTask;if(i)return{updating:i};if(e==null||e.length===0)return{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const n=this._pickExtentCandidate(e),o=this.spatialReference;return n.extent.equals(this._projectExtentTask.input)&&o.equals(this._projectExtentTask.spatialReference)?{extent:this._projectExtentTask.output,updating:this._projectExtentTask.task!=null&&!this._projectExtentTask.task.finished}:(this._projectExtentTask.task!=null&&(this._projectExtentTask.task=Ot(this._projectExtentTask.task)),this._projectExtentTask={input:n.extent.clone(),output:null,spatialReference:o.clone(),task:Qt(async s=>{try{const a=await mn(n.extent,o,"portalItem"in n.layer?n.layer.portalItem:void 0,s);this._projectExtentTask={...this._projectExtentTask,task:null,output:a}}catch{if(Bn(s))return;this._projectExtentTask={...this._projectExtentTask,task:null}}})},{updating:!0})}_narrowDownSpatialReferenceCandidates(e,i){if(e==null)return i;const n=new Array;for(const o of e)for(const s of i){if(!o.spatialReference.equals(s.spatialReference))continue;const a=Es(o.viewingMode,s.viewingMode);if(a!==!1){n.push({spatialReference:o.spatialReference,viewingMode:a});break}}return n.length>0?n:null}_pickSpatialReferenceCandidate(e){const i=this.defaultSpatialReference;return e==null||e.length<1?i?{spatialReference:i,viewingMode:null}:null:(i!=null&&e.length>1&&e.some(({spatialReference:n})=>n.equals(i))&&(e=e.filter(({spatialReference:n})=>n.equals(i))),e.length>1&&e.some(({viewingMode:n})=>n!==xi.Local)&&(e=e.filter(({viewingMode:n})=>n!==xi.Local)),e[0])}_getSupportedSpatialReferences(e){const i="supportedSpatialReferences"in e&&e.supportedSpatialReferences||(e.spatialReference?[e.spatialReference]:[]);if(i.length===0)return[];const n=[];for(const o of i){const s=this.getSpatialReferenceSupport(o,e);if(s!=null){const a=s.constraints??[{spatialReference:o,viewingMode:null}];for(const{spatialReference:l,viewingMode:d}of a)this.requiresExtentInSpatialReference&&this.userSpatialReference!=null&&!l.equals(this.userSpatialReference)||n.push({spatialReference:l,viewingMode:d})}}return n}_pickExtentCandidate(e){const i=this.spatialReference;return e.find(({extent:n})=>i.equals(n.spatialReference))||e[0]}_collectLayers(e,i,n=()=>!0){var s;switch(this._loadMaybe((s=this.map)==null?void 0:s.call(this))){case"loading":return!0;case"failed":return!1}const o=new Ss(n,i);for(const a of e)if(this._collectCollection(a,o),o.done||o.preloading===this.sourcePreloadCount)break;return o.updating}_collectCollection(e,i){if(e.layers){switch(this._loadMaybe(e.parent)){case"loading":return i.updating=!0,void++i.preloading;case"failed":return}for(const n of e.layers)if(i.layerFilter(n)){switch(this._loadMaybe(n)){case"failed":continue;case"loading":i.updating=!0,++i.preloading;break;case"loaded":if(i.updating||(i.done=i.pushLayer(n)),i.done||i.preloading===this.sourcePreloadCount)break;"layers"in n&&this._collectCollection({layers:n.layers},i)}if(i.done||i.preloading===this.sourcePreloadCount)break}}}_loadMaybe(e){return e&&"loadStatus"in e&&e.loadStatus!=null?e.loadStatus==="not-loaded"?(e.load().catch(i=>{Jt(i)}),"loading"):e.loadStatus:"loaded"}};r([h()],v.prototype,"required",void 0),r([h({constructOnly:!0})],v.prototype,"map",void 0),r([h({constructOnly:!0})],v.prototype,"getSpatialReferenceSupport",void 0),r([h()],v.prototype,"defaultSpatialReference",void 0),r([h()],v.prototype,"userSpatialReference",void 0),r([h()],v.prototype,"sourcePreloadCount",void 0),r([h()],v.prototype,"priorityCollection",void 0),r([h()],v.prototype,"requiresExtentInSpatialReference",void 0),r([h()],v.prototype,"suspended",void 0),r([h({readOnly:!0})],v.prototype,"ready",null),r([h({readOnly:!0})],v.prototype,"heightModelInfoReady",null),r([h({readOnly:!0})],v.prototype,"spatialReference",null),r([h({readOnly:!0})],v.prototype,"extent",null),r([h({readOnly:!0})],v.prototype,"heightModelInfo",null),r([h({readOnly:!0})],v.prototype,"vcsWkid",null),r([h({readOnly:!0})],v.prototype,"latestVcsWkid",null),r([h({readOnly:!0})],v.prototype,"viewingMode",null),r([h({readOnly:!0})],v.prototype,"tileInfo",null),r([h({readOnly:!0})],v.prototype,"mapCollections",null),r([h({readOnly:!0})],v.prototype,"_spatialReferenceTask",null),r([h({readOnly:!0})],v.prototype,"_tileInfoTask",null),r([h({readOnly:!0})],v.prototype,"_heightModelInfoTask",null),r([h({readOnly:!0})],v.prototype,"_extentCandidatesTask",null),r([h()],v.prototype,"_extentTask",null),r([h()],v.prototype,"_projectExtentTask",void 0),v=r([y("esri.views.support.DefaultsFromMap")],v);let Ss=class{constructor(e,i){this.layerFilter=e,this.pushLayer=i,this.preloading=-1,this.updating=!1,this.done=!1}};function Es(t,e){return t!=null?e!=null?t===e&&t:t:e}let Se=class extends M{constructor(e){super(e),this.featureTitleFields=!1,this.utilityNetworkFields=!1,this.globalIdField=!1}};r([h()],Se.prototype,"featureTitleFields",void 0),r([h()],Se.prototype,"utilityNetworkFields",void 0),r([h()],Se.prototype,"globalIdField",void 0),Se=r([y("esri.views.support.RequiredFieldsOptions")],Se);const Is=Se;var Fe;let m=Fe=class extends ft.EventedMixin(nn.EsriPromiseMixin(M)){constructor(t){super(t),this._userSpatialReference=null,this._cursor=null,this.handles=new Un,this.updatingHandles=new gt,this.allLayerViews=new zt({getCollections:()=>{var e,i,n;return[(e=this.basemapView)==null?void 0:e.baseLayerViews,(i=this.groundView)==null?void 0:i.layerViews,this.layerViews,(n=this.basemapView)==null?void 0:n.referenceLayerViews]},getChildrenFunction:Ls}),this.groundView=null,this.basemapView=null,this.displayFilterEnabled=!0,this.fatalError=null,this.graphics=new on,this.analyses=new lt,this.typeSpecificPreconditionsReady=!0,this.layerViews=new x,this.magnifier=new dn,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this._readyStateWaitingTask=null,this.supportsGround=!0,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this.input=new Ps,this.navigation=new pn,this.layerViewManager=null,this.analysisViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new Io(this),this.persistableViewModels=new x,this.requiredFieldsOptions=new Is,this._isValid=!1,this._readyCycleForced=!1,this._lockedSpatialReference=null,this._userTimeZone=null,this._lockedTimeZone=null,this._userTimeExtent=null,this._lockedTimeExtent=null,this.theme=null,this.handles.add(b(()=>this.preconditionsReady,e=>{var n,o;const i=this.ready;if(e?(this._lockedSpatialReference=this.spatialReference,this._lockedTimeZone=this.timeZone,this._lockedTimeExtent=this.timeExtent,Fe.views.add(this)):(this._lockedSpatialReference=null,Fe.views.remove(this)),this.notifyChange("spatialReference"),!e&&i)(n=this.toolViewManager)==null||n.detach(),this.analysisViewManager!=null&&this.analysisViewManager.detach(),(o=this.layerViewManager)==null||o.clear(),this._teardown();else if(e&&!i){try{this._startup()}catch(s){return void queueMicrotask(()=>{this.fatalError=new S("startup-error",null,s)})}this.analysisViewManager!=null&&this.analysisViewManager.attach(),this.toolViewManager.attach()}},_i))}initialize(){this.addResolvingPromise(Promise.all([this.loadAsyncDependencies(),this.validate()]).then(()=>(this._isValid=!0,Qi(()=>this.ready)))),this.basemapView=new ds({view:this}),this.layerViewManager=new ms({view:this,layerViewImporter:{importLayerView:t=>this.importLayerView(t),hasLayerViewModule:t=>this.hasLayerViewModule(t)},supportsGround:this.supportsGround}),this.toolViewManager=new U({view:this}),this.selectionManager=new _s({view:this}),this.addHandles([ot(()=>this.readyState==="map-content-error"&&!this.spatialReference,()=>{P.getLogger(this).warn("#spatialReference","no spatial reference could be derived from the currently added map layers")}),b(()=>this.initialExtentRequired,t=>this.defaultsFromMap.required={...this.defaultsFromMap.required,extent:t},Ft),b(()=>this.ready,t=>{this.defaultsFromMap&&(this.defaultsFromMap.suspended=t,this.defaultsFromMap.userSpatialReference=t?this.spatialReference:this._userSpatialReference)},_i),b(()=>this._userSpatialReference,t=>{this.defaultsFromMap&&(this.defaultsFromMap.userSpatialReference=t)},Ft)])}destroy(){var t,e;this.destroyed||(Fe.views.remove(this),this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=R(this.graphics),this.analyses=R(this.analyses),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),R(this.analysisViewManager),this.toolViewManager=R(this.toolViewManager),this.layerViewManager=R(this.layerViewManager),this.selectionManager=R(this.selectionManager),this.basemapView=R(this.basemapView),(t=this.groundView)==null||t.destroy(),(e=this.layerViews)==null||e.forEach(i=>i.destroy()),this.layerViews.length=0,this.invalidate(),this._emitter.clear(),this.handles.destroy(),this.map=R(this.map),this.updatingHandles.destroy())}_startup(){this._set("ready",!0)}_teardown(){this._set("ready",!1)}whenReady(){return Promise.resolve(this)}toMap(){return P.getLogger(this).error("#toMap()","Not implemented on this instance of View"),null}get activeTool(){var t;return(t=this.toolViewManager)==null?void 0:t.activeTool}set activeTool(t){this.toolViewManager&&(this.toolViewManager.activeTool=t)}get animation(){return this._get("animation")}set animation(t){this._set("animation",t)}get center(){return null}get defaultsFromMapSettings(){return{}}get defaultsFromMap(){return new v({required:{tileInfo:!1,heightModelInfo:!1,extent:!1},map:()=>this.map,getSpatialReferenceSupport:(t,e)=>this.getSpatialReferenceSupport(t,e),...this.defaultsFromMapSettings})}get extent(){return this._get("extent")}set extent(t){this._set("extent",t)}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get highlights(){return this._get("highlights")??xs()}set highlights(t){this._set("highlights",ei(t,this._get("highlights"),x.ofType(Re)))}get interacting(){return this.navigating}get navigating(){return!1}get preconditionsReady(){var t;return!(this.fatalError||!this._isValid||this._readyCycleForced||!this.map||Rt.isLoadable(this.map)&&!this.map.loaded||this.width===0||this.height===0||!this.spatialReference||!this._validateSpatialReference(this.spatialReference)||!this._lockedSpatialReference&&!((t=this.defaultsFromMap)!=null&&t.ready)||!this.typeSpecificPreconditionsReady)}get resolution(){return 0}set map(t){t!==this._get("map")&&(t!=null&&t.destroyed&&(P.getLogger(this).warn("#map","The provided map is already destroyed",{map:t}),t=null),Rt.isLoadable(t)&&t.load().catch(()=>{}),this.constructed&&!this.destroyed&&(this.forceReadyCycle(),this._lockedSpatialReference=null),this._set("map",t))}get readyState(){var t,e,i,n;if(this.destroyed)return this._get("readyState");if(!this.map)return"missing-map";if("container"in this&&!this.container)return"missing-container";if(this.fatalError)return"rendering-error";if((((t=this.defaultsFromMap)==null?void 0:t.ready)??!1)&&!this.spatialReference){const o=!("loaded"in this.map)||this.map.loaded,s=this.map.ground.loaded,a=((e=this.map.basemap)==null?void 0:e.loaded)??!0;return o&&a&&s&&!((i=this.map)!=null&&i.allLayers.length)?"empty-map":(this._readyStateWaitingTask||(this._readyStateWaitingTask=Qt(l=>Gn(we("view-readyState-waiting-delay"),null,l)),this.addHandles(this._readyStateWaitingTask),this.addHandles(this._readyStateWaitingTask,"ready-state-task")),(n=this._readyStateWaitingTask)!=null&&n.finished?"map-content-error":"loading")}return this._readyStateWaitingTask=Ot(this._readyStateWaitingTask),this.removeHandles("ready-state-task"),this.ready?"ready":"loading"}get spatialReference(){var e,i;const t=this._userSpatialReference||this._lockedSpatialReference||this.getDefaultSpatialReference()||null;if(t&&((i=(e=this.defaultsFromMap)==null?void 0:e.required)!=null&&i.heightModelInfo)){const n=t.clone();return n.vcsWkid=this.defaultsFromMap.vcsWkid,n.latestVcsWkid=this.defaultsFromMap.latestVcsWkid,n}return t}set spatialReference(t){const e=!bo(t,this._get("spatialReference"));this._set("_userSpatialReference",t),e&&(this._set("spatialReference",t),this._spatialReferenceChanged(t))}_spatialReferenceChanged(t){}get stationary(){return!this.animation&&!this.navigating&&!this.resizing}get timeExtent(){return this._userTimeExtent??this._lockedTimeExtent??this.getDefaultTimeExtent()??null}set timeExtent(t){this._userTimeExtent=t}get timeZone(){return this._userTimeZone??this._lockedTimeZone??this.getDefaultTimeZone()??go}set timeZone(t){this._userTimeZone=t,$o(t)||P.getLogger(this).warn("#timeZone",`the parsed value '${t}' may not be a valid IANA time zone`)}get tools(){var t;return(t=this.toolViewManager)==null?void 0:t.tools}get initialExtent(){var t;return(t=this.defaultsFromMap)==null?void 0:t.extent}get cursor(){var t;return((t=this.toolViewManager)==null?void 0:t.cursor)??this._cursor??"default"}set cursor(t){this._cursor=t,this.notifyChange("cursor")}get size(){return[this.width,this.height]}get effectiveTheme(){return this.theme??new qt}whenLayerView(t){var e;return((e=this.layerViewManager)==null?void 0:e.whenLayerView(t))??Promise.reject()}getDefaultSpatialReference(){var t;return(t=this.defaultsFromMap)==null?void 0:t.spatialReference}getDefaultHeightModelInfo(){var t;return(this.map&&"heightModelInfo"in this.map?this.map.heightModelInfo:void 0)??((t=this.defaultsFromMap)==null?void 0:t.heightModelInfo)??null}getDefaultTimeZone(){return null}getDefaultTimeExtent(){return null}importLayerView(t){throw new S("importLayerView() not implemented")}hasLayerViewModule(t){return!1}async validate(){}async loadAsyncDependencies(){}invalidate(){this._isValid=!1}getSpatialReferenceSupport(){return{constraints:null}}_validateSpatialReference(t){return this.getSpatialReferenceSupport(t)!=null}when(t,e){return this.isResolved()&&!this.ready&&P.getLogger(this).warn("#when()","Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."),super.when(t,e)}forceReadyCycle(){this.ready&&(ot(()=>this.destroyed||this.preconditionsReady===!1,()=>this._readyCycleForced=!1,{once:!0}),this._readyCycleForced=!0)}addAndActivateTool(t){this.toolViewManager.tools.add(t),this.activeTool=t}tryFatalErrorRecovery(){this.fatalError=null}};m.views=new x,r([h()],m.prototype,"_userSpatialReference",void 0),r([h()],m.prototype,"activeTool",null),r([h({readOnly:!0})],m.prototype,"allLayerViews",void 0),r([h()],m.prototype,"groundView",void 0),r([h()],m.prototype,"animation",null),r([h()],m.prototype,"basemapView",void 0),r([h()],m.prototype,"center",null),r([h()],m.prototype,"defaultsFromMapSettings",null),r([h()],m.prototype,"defaultsFromMap",null),r([h()],m.prototype,"displayFilterEnabled",void 0),r([h()],m.prototype,"fatalError",void 0),r([h({type:sn})],m.prototype,"extent",null),r([h(bi(on,"graphics"))],m.prototype,"graphics",void 0),r([h(bi(lt,"analyses"))],m.prototype,"analyses",void 0),r([h({readOnly:!0,type:wo})],m.prototype,"heightModelInfo",null),r([h({type:x.ofType(Re)})],m.prototype,"highlights",null),r([h({readOnly:!0})],m.prototype,"interacting",null),r([h({readOnly:!0})],m.prototype,"navigating",null),r([h({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_lockedSpatialReference","defaultsFromMap.ready","typeSpecificPreconditionsReady"]})],m.prototype,"preconditionsReady",null),r([h({readOnly:!0})],m.prototype,"typeSpecificPreconditionsReady",void 0),r([h({type:x,readOnly:!0})],m.prototype,"layerViews",void 0),r([h()],m.prototype,"resolution",null),r([h({type:dn})],m.prototype,"magnifier",void 0),r([h({value:null,type:is})],m.prototype,"map",null),r([h()],m.prototype,"padding",void 0),r([h({readOnly:!0})],m.prototype,"ready",void 0),r([h()],m.prototype,"_readyStateWaitingTask",void 0),r([h({readOnly:!0})],m.prototype,"readyState",null),r([h({type:Nt})],m.prototype,"spatialReference",null),r([h()],m.prototype,"stationary",null),r([h({readOnly:!0})],m.prototype,"supportsGround",void 0),r([h({type:To})],m.prototype,"timeExtent",null),r([h({type:String,nonNullable:!0})],m.prototype,"timeZone",null),r([h()],m.prototype,"tools",null),r([h()],m.prototype,"toolViewManager",void 0),r([h({readOnly:!0})],m.prototype,"type",void 0),r([h({type:Number})],m.prototype,"scale",void 0),r([h({readOnly:!0})],m.prototype,"updating",void 0),r([h({readOnly:!0})],m.prototype,"initialExtentRequired",void 0),r([h({readOnly:!0})],m.prototype,"initialExtent",null),r([h()],m.prototype,"cursor",null),r([h({readOnly:!0})],m.prototype,"input",void 0),r([h({type:pn,nonNullable:!0})],m.prototype,"navigation",void 0),r([h()],m.prototype,"layerViewManager",void 0),r([h()],m.prototype,"analysisViewManager",void 0),r([h()],m.prototype,"selectionManager",void 0),r([h()],m.prototype,"width",void 0),r([h()],m.prototype,"height",void 0),r([h({readOnly:!0})],m.prototype,"resizing",void 0),r([h({value:null,readOnly:!0})],m.prototype,"size",null),r([h({readOnly:!0})],m.prototype,"suspended",void 0),r([h({readOnly:!0})],m.prototype,"viewEvents",void 0),r([h({readOnly:!0})],m.prototype,"persistableViewModels",void 0),r([h()],m.prototype,"_isValid",void 0),r([h()],m.prototype,"_readyCycleForced",void 0),r([h()],m.prototype,"_lockedSpatialReference",void 0),r([h()],m.prototype,"_userTimeZone",void 0),r([h()],m.prototype,"_lockedTimeZone",void 0),r([h()],m.prototype,"_userTimeExtent",void 0),r([h()],m.prototype,"_lockedTimeExtent",void 0),r([h({type:qt})],m.prototype,"theme",void 0),r([h({readOnly:!0,type:qt})],m.prototype,"effectiveTheme",null),m=Fe=r([y("esri.views.View")],m);const St=globalThis.$arcgis;St&&!St.views&&Object.defineProperty(St,"views",{configurable:!1,enumerable:!0,writable:!1,value:m.views});const jl=m;function Ls(t){return t.layerViews}function Ds(){const t=new Float32Array(9);return t[0]=1,t[4]=1,t[8]=1,t}function Vs(t){const e=new Float32Array(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function As(t,e,i,n,o,s,a,l,d){const u=new Float32Array(9);return u[0]=t,u[1]=e,u[2]=i,u[3]=n,u[4]=o,u[5]=s,u[6]=a,u[7]=l,u[8]=d,u}function Os(t,e){return new Float32Array(t,e,9)}Object.freeze(Object.defineProperty({__proto__:null,clone:Vs,create:Ds,createView:Os,fromValues:As},Symbol.toStringTag,{value:"Module"}));let pe=class extends nn{constructor(e){super(e),this.state="running",this.target=null,this._resolver=null}initialize(){this._resolver=dt(),this.addResolvingPromise(this._resolver.promise)}get done(){return this.state==="finished"||this.state==="stopped"}stop(){var e;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","stopped"),(e=this._resolver)==null||e.reject(new S("ViewAnimation stopped")))}finish(){var e;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","finished"),(e=this._resolver)==null||e.resolve())}update(e,i){i||(i=Kn(e)?"waiting-for-target":"running"),this._set("target",e),this._set("state",i)}};r([h({readOnly:!0})],pe.prototype,"done",null),r([h({readOnly:!0,type:String})],pe.prototype,"state",void 0),r([h()],pe.prototype,"target",void 0),pe=r([y("esri.views.ViewAnimation")],pe),function(t){t.State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"}}(pe||(pe={}));const Ul=pe;function Fs(t,e){switch(e){case"primary":return t.pointerType==="touch"||t.button===0;case"secondary":return t.pointerType!=="touch"&&t.button===2;case"tertiary":return t.pointerType!=="touch"&&t.button===1}}function Gl(t,e){return e.some(i=>Fs(t,i))}function Kl(t,e){const{button:i,pointerType:n}=t;return n!=="touch"&&e.some(o=>o==="primary"&&i===0||o==="secondary"&&i===2||o==="tertiary"&&i===1)}function Jl(t,{dragPrimary:e,dragSecondary:i,dragTertiary:n}){return[{key:"primary",value:e},{key:"secondary",value:i},{key:"tertiary",value:n}].filter(o=>o.value===t).map(o=>o.key)}let Yl=class{constructor(e){this._callbacks=e,this._currentCount=0,this._callbacks.condition||(this._callbacks.condition=()=>!0)}handle(e){const i=e.data,n=i.pointers.size;switch(i.action){case"start":this._currentCount=n,this._emitStart(e);break;case"added":this._emitEnd(this._previousEvent),this._currentCount=n,this._emitStart(e);break;case"update":this._emitUpdate(e);break;case"removed":this._startEvent&&this._emitEnd(this._previousEvent),this._currentCount=n,this._emitStart(e);break;case"end":this._emitEnd(e),this._currentCount=0}this._previousEvent=e}_emitStart(e){var i,n;this._startEvent=e,(n=(i=this._callbacks).condition)!=null&&n.call(i,this._currentCount,e)&&this._callbacks.start(this._currentCount,e,this._startEvent)}_emitUpdate(e){var i,n;(n=(i=this._callbacks).condition)!=null&&n.call(i,this._currentCount,e)&&this._callbacks.update(this._currentCount,e,this._startEvent)}_emitEnd(e){var i,n;(n=(i=this._callbacks).condition)!=null&&n.call(i,this._currentCount,e)&&this._callbacks.end(this._currentCount,e,this._startEvent),this._startEvent=null}};function H(t){let e=t*t;return t<0&&(e*=-1),e}function Xl(t){return t.translation[0]=0,t.translation[1]=0,t.translation[2]=0,t.heading=0,t.tilt=0,t}function eh(t,e,i){const n=i,o=t.state,s=t.device,a=e.tiltDirection==="forward-down"?1:-1,l=1;return s.deviceType==="standard"?(n.translation[0]=H(o.axes[0]),n.translation[1]=H(o.axes[1]),n.translation[2]=H(o.buttons[7])-H(o.buttons[6]),n.heading=H(o.axes[2]),n.tilt=H(o.axes[3])):s.deviceType==="spacemouse"&&(n.translation[0]=1.2*H(o.axes[0]),n.translation[1]=1.2*H(o.axes[1]),n.translation[2]=2*-H(o.axes[2]),n.heading=1.2*H(o.axes[5]),n.tilt=1.2*H(o.axes[3])),n.tilt*=a,Ko(n.translation,n.translation,l),n}function th(t,e){const i=e;return i.translation[0]=t[1]-t[0],i.translation[1]=t[3]-t[2],i.translation[2]=t[4]-t[5],i.heading=t[7]-t[6],i.tilt=t[8]-t[9],i.zoom=t[10]-t[11],i}function ih(t){return t.translation[0]===0&&t.translation[1]===0&&t.translation[2]===0&&t.heading===0&&t.tilt===0&&t.zoom===0}function nh(t){const e=()=>t(document.visibilityState==="visible");return document.addEventListener("visibilitychange",e),Yt(()=>document.removeEventListener("visibilitychange",e))}function Oi(t){const e=t.native;return e?{buttons:e.buttons.map(i=>i.pressed?i.value||1:0),axes:e.axes.map(i=>Ns(i,t.axisThreshold))}:{buttons:[],axes:[]}}function Rs(t,e){if(t.axes.length!==e.axes.length||t.buttons.length!==e.buttons.length)return!1;for(let i=0;i<t.axes.length;i++)if(t.axes[i]!==e.axes[i])return!1;for(let i=0;i<t.buttons.length;i++)if(t.buttons[i]!==e.buttons[i])return!1;return!0}function zs(t){for(let e=0;e<t.axes.length;e++)if(t.axes[e]!==0)return!1;for(let e=0;e<t.buttons.length;e++)if(t.buttons[e]!==0)return!1;return!0}function Ns(t,e){const i=Math.abs(t);return i<e?0:Math.sign(t)*(i-e)/(1-e)}let Hs=class{constructor(e,i){this._element=e,this._input=i,this._hasEventListeners=!1,this._onConnectGamepad=s=>{this._connectGamepad(s.gamepad)},this._onDisconnectGamepad=s=>{const a=s.gamepad,l=a.index,d=this._inputDevices[l];d&&(this._emitGamepadEvent(a,Oi(d),!1),this._inputDevices.splice(l,1),this._latestUpdate.splice(l,1),this._input.gamepad.devices.remove(d),this.ensurePollingState())},this._frameTask=null,this._latestUpdate=new Array,this._inputDevices=new Array,this._callback=null;const n="getGamepads"in window.navigator,o=window.isSecureContext;this.supported=n&&o,this.supported&&(Fi(s=>this._connectGamepad(s)),window.addEventListener("gamepadconnected",this._onConnectGamepad),window.addEventListener("gamepaddisconnected",this._onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this._onConnectGamepad),window.removeEventListener("gamepaddisconnected",this._onDisconnectGamepad))}set hasEventListeners(e){this._hasEventListeners!==e&&(this._hasEventListeners=e,this.ensurePollingState())}get _eventsEnabled(){return this.supported&&this._inputDevices.length>0&&this._hasEventListeners}set onEvent(e){this._callback=e}_connectGamepad(e){const i=new ti(e);i.deviceType!=="unknown"&&(this._inputDevices[e.index]=i,this._input.gamepad.devices.add(i)),this.ensurePollingState()}ensurePollingState(){this._eventsEnabled?this._startPolling():this._stopPolling()}_startPolling(){this._frameTask==null&&(this._frameTask=At({update:()=>this._readGamepadState()}))}_stopPolling(){this._frameTask!=null&&(this._frameTask.remove(),this._frameTask=null,this._latestUpdate=new Array)}_readGamepadState(){const e=document.hasFocus(),i=this._element.contains(document.activeElement),n=this._input.gamepad.enabledFocusMode==="document"&&!e||this._input.gamepad.enabledFocusMode==="view"&&!i;Fi(o=>{const s=this._inputDevices[o.index];if(!s)return;const a=this._latestUpdate[o.index],l=Oi(s),d=n||zs(l);a&&(a.timestamp===o.timestamp||!a.active&&d||Rs(a.state,l))||this._emitGamepadEvent(o,l,!d)})}_emitGamepadEvent(e,i,n){const o=this._latestUpdate[e.index],s=o&&o.active;if(!s&&!n)return;const a=!s&&n?"start":s&&n?"update":"end";this._latestUpdate[e.index]={timestamp:e.timestamp,state:i,active:n},this._callback&&this._callback({device:this._inputDevices[e.index],state:i,action:a})}};function Ws(t){if(!t||!t.connected)return!1;for(let e=0;e<t.axes.length;e++)if(isNaN(t.axes[e]))return!1;return!0}function Fi(t){for(const e of navigator.getGamepads())Ws(e)&&t(e)}const Ri=we("edge"),Zs=we("chrome"),qs=we("ff"),js=we("safari"),zi="esri-view-surface",$e={touchNone:`${zi}--touch-none`,touchPan:`${zi}--touch-pan`};let Bs=class gn{constructor(e,i){this._active={},this._callback=()=>{},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=e,e.getAttribute("tabindex")||e.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new Hs(e,i),this._gamepadSource.onEvent=n=>this._callback("gamepad",n)}destroy(){this._callback=()=>{},this.activeEvents=null,this._activePointerCaptures.forEach(e=>this._releasePointerCaptureSafe(e)),this._activePointerCaptures.clear(),this._gamepadSource=R(this._gamepadSource),this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(e){this._browserTouchPanningEnabled=e,this._updateTouchAction(),this._updateTouchEventHandling()}set onEventReceived(e){this._callback=e}set activeEvents(e){for(const i in this._active)if(!e||!e.has(i)){const n=this._active[i];this._element.removeEventListener(Et[i],n),delete this._active[i]}e&&e.forEach(i=>{if(!this._active[i]&&Et[i]){const n=(this._eventHandlers[i]||this._handleDefault).bind(this,i);this._element.addEventListener(Et[i],n),this._active[i]=n}}),this._gamepadSource&&(this._gamepadSource.hasEventListeners=(e==null?void 0:e.has("gamepad"))??!1)}setPointerCapture(e,i){i?this._setPointerCaptureSafe(e.pointerId):(this._releasePointerCaptureSafe(e.pointerId),this._activePointerCaptures.delete(e.pointerId))}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?$e.touchNone:$e.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?$e.touchPan:$e.touchNone)}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_removeTouchAction(){this._element.classList.remove($e.touchNone),this._element.classList.remove($e.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_setPointerCaptureSafe(e){try{this._element.setPointerCapture(e),this._activePointerCaptures.add(e)}catch{}}_releasePointerCaptureSafe(e){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(e))return;this._element.releasePointerCapture(e)}catch{}}_updateNormalizedPointerLikeEvent(e,i){const n=Do(this._element,e);return gn.test.disableSubpixelCoordinates&&(n.x=Math.round(n.x),n.y=Math.round(n.y)),i.x=n.x,i.y=n.y,i}_handleKey(e,i){const{key:n}=i;n&&e==="key-up"&&this._keyDownState.delete(n);const o={native:i,key:n,repeat:!!n&&this._keyDownState.has(n)};n&&e==="key-down"&&this._keyDownState.add(o.key),this._callback(e,o)}_handlePointer(e,i){const n=this._updateNormalizedPointerLikeEvent(i,{native:i,x:0,y:0,pointerType:i.pointerType,button:i.button,buttons:i.buttons,eventId:this._eventId++});this._callback(e,n)}_handlePointerPreventDefault(e,i){const n=this._updateNormalizedPointerLikeEvent(i,{native:i,x:0,y:0,pointerType:i.pointerType,button:i.button,buttons:i.buttons,eventId:this._eventId++});i.preventDefault(),this._callback(e,n)}_getDeltaFromTrackpadOrMouseWheel(e){return e.shiftKey&&we("mac")&&e.deltaY===0?e.deltaX:e.deltaY}_handleMouseWheel(e,i){let n=this._getDeltaFromTrackpadOrMouseWheel(i);switch(i.deltaMode){case 0:Ri&&(n=n/document.documentElement.clientHeight*600);break;case 1:n*=30;break;case 2:n*=900}Ri?n*=.7:Zs||js?n*=.6:qs&&(n*=1.375);const o=100,s=Math.abs(n);s>o&&(n=n/s*200/(1+Math.exp(-.02*(s-o))));const a=this._updateNormalizedPointerLikeEvent(i,{native:i,x:0,y:0,deltaY:n});this._callback(e,a)}_handlePointerCaptureLost(e,i){this._activePointerCaptures.delete(i.pointerId),this._handleDefault(e,i)}_handleDefault(e,i){const n={native:i};i.preventDefault(),this._callback(e,n)}_preventAltKeyDefault(e){e.key==="Alt"&&e.preventDefault()}_preventMultiTouchPanning(e){e.touches.length>1&&e.preventDefault()}};Bs.test={disableSubpixelCoordinates:!1};const Et={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};let sh=class extends He{constructor(){super(!0),this.registerIncoming("context-menu",e=>e.data.native.preventDefault())}};const O={maximumClickDelay:300,movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500,maximumDoubleClickDelay:250,maximumDoubleClickDistance:10,maximumDoubleTouchDelay:350,maximumDoubleTouchDistance:35};function Gt(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}function Us(t,e){const i=e.x-t.x,n=e.y-t.y;return Math.sqrt(i*i+n*n)}function Gs(t,e){if(e?(e.radius=0,e.center.x=0,e.center.y=0):e={radius:0,center:Ne()},t.length===0)return e;if(t.length===1)return e.center.x=t[0].x,e.center.y=t[0].y,e;if(t.length===2){const[w,_]=t,[$,L]=[_.x-w.x,_.y-w.y];return e.radius=Math.sqrt($*$+L*L)/2,e.center.x=(w.x+_.x)/2,e.center.y=(w.y+_.y)/2,e}let i=0,n=0;for(let w=0;w<t.length;w++)i+=t[w].x,n+=t[w].y;i/=t.length,n/=t.length;const o=t.map(w=>w.x-i),s=t.map(w=>w.y-n);let a=0,l=0,d=0,u=0,c=0,g=0,p=0;for(let w=0;w<o.length;w++){const _=o[w],$=s[w],L=_*_,Y=$*$;a+=L,l+=Y,d+=_*$,u+=L*_,c+=Y*$,g+=_*Y,p+=$*L}const f=.5*(u+g),q=.5*(c+p),I=a*l-d*d,fe=(f*l-q*d)/I,T=(a*q-d*f)/I,j=Ne(fe+i,T+n);return{radius:Math.sqrt(fe*fe+T*T+(a+l)/t.length),center:j}}function ze(t){const{native:e}=t,{pointerId:i,button:n,pointerType:o}=e;return o==="mouse"?`${i}:${n}`:`${o}`}let rh=class extends He{constructor(e){super(!1),this._navigationTouch=e,this._startStateModifiers=new Set,this._activePointerMap=new Map,this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this._handlePointerUpAndPointerLost.bind(this))}_createPayload(e,i,n,o){return{action:e,pointerType:this._pointerType,button:this._mouseButton,buttons:i.buttons,timestamp:o,pointers:Ks(this._activePointerMap),pointer:i,angle:n.angle,radius:n.radius,center:n.center}}_addPointer(e){const i=e.native.pointerId,n=Ue(this._activePointerMap).angle,o={event:e,initialAngle:0,lastAngle:0};this._activePointerMap.set(i,o);const s=Xe(o,fn(this._activePointerMap));o.initialAngle=s,o.lastAngle=s,this._updatePointerAngles(n)}_updatePointer(e){if(e&&e.x==null&&e.y==null)return;const i=e.native.pointerId,n=this._activePointerMap.get(i);n?n.event=e:this._addPointer(e)}_removePointer(e){const i=Ue(this._activePointerMap).angle;this._activePointerMap.delete(e),this._updatePointerAngles(i)}_updatePointerAngles(e){const i=Ue(this._activePointerMap);this._activePointerMap.forEach(n=>{n.initialAngle=Xe(n,i)-e,n.lastAngle=Xe(n,i)-e})}_emitEvent(e,i,n){const o=Ue(this._activePointerMap);this._drag.emit(this._createPayload(e,i,o,n),void 0,this._startStateModifiers)}_handlePointerUpAndPointerLost(e){const i=e.data.native.pointerId,n=ae(e.timestamp);this._activePointerMap.get(i)&&(this._activePointerMap.size===1?(this._updatePointer(e.data),!this._isCurrentDragSuppressed&&this._emitEvent("end",e.data,n),this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._removePointer(i)):(this._removePointer(i),this._emitEvent("removed",e.data,ae(e.timestamp))))}_handlePointerDrag(e){const i=e.data,n=i.currentEvent,o=ae(e.timestamp);switch(i.action){case"start":case"update":this._isDragging?this._activePointerMap.has(n.native.pointerId)?(this._updatePointer(n),!this._isCurrentDragSuppressed&&this._emitEvent("update",n,o)):(this._addPointer(n),this._emitEvent("added",n,o),this._isCurrentDragSuppressed=this._isSuppressed):(this._updatePointer(n),this._pointerType=e.data.startEvent.pointerType,this._mouseButton=e.data.startEvent.button,this._startStateModifiers=e.modifiers,this._isDragging=!0,this._isCurrentDragSuppressed=this._isSuppressed,!this._isCurrentDragSuppressed&&this._emitEvent("start",n,o))}}get _isSuppressed(){return!!this._navigationTouch&&!this._navigationTouch.browserTouchPanEnabled&&this._pointerType==="touch"&&this._activePointerMap.size===1}};function fn(t){const e=[];return t.forEach(i=>{e.push(Ne(i.event.x,i.event.y))}),Gs(e)}function Ue(t){const e=fn(t);let i=0;return t.forEach(n=>{let o=Xe(n,e),s=o-n.lastAngle;for(;s>Math.PI;)s-=2*Math.PI;for(;s<-Math.PI;)s+=2*Math.PI;o=n.lastAngle+s,n.lastAngle=o;const a=o-n.initialAngle;i+=a}),i/=t.size||1,{angle:i,radius:e.radius,center:e.center}}function Ks(t){const e=new Map;return t.forEach((i,n)=>e.set(n,i.event)),e}function Xe(t,e){const i=t.event,n=i.x-e.center.x,o=i.y-e.center.y;return Math.atan2(o,n)}var Ni;(function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right",t[t.Back=3]="Back",t[t.Forward=4]="Forward",t[t.Undefined=-1]="Undefined"})(Ni||(Ni={}));let hh=class extends He{constructor(e=O.maximumDoubleClickDelay,i=O.maximumDoubleClickDistance,n=O.maximumDoubleTouchDelay,o=O.maximumDoubleTouchDistance,s=ut){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=i,this._maximumDoubleTouchDelay=n,this._maximumDoubleTouchDistance=o,this._clock=s,this._pointerState=new Map,this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUp.bind(this))}onUninstall(){this._pointerState.forEach(e=>{e.immediateDoubleClick&&e.immediateDoubleClick.timeoutHandle.remove()}),super.onUninstall()}_handlePointerDown(e){const i=e.data,n=ze(i);if(!this._pointerState.has(n)){const o={downButton:i.native.button,x:i.x,y:i.y,immediateDoubleClick:null};this._pointerState.set(n,o),this.startCapturingPointer(i.native)}}_handlePointerUp(e){const i=e.data,n=ze(i),o=this._pointerState.get(n);if(o&&o.downButton===i.native.button){const s=o.immediateDoubleClick,a=e.data.native.pointerType==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;s?(s.timeoutHandle.remove(),Gt(s,e.data)>a?this._startImmediateDoubleClick(e,o):(this._immediateDoubleClick.emit(e.data,void 0,s.modifiers),this._removeState(i))):Gt(o,e.data)>a?this._removeState(i):this._startImmediateDoubleClick(e,o)}}_startImmediateDoubleClick(e,i){const n=e.data.native.pointerType==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay;i.immediateDoubleClick={x:e.data.x,y:e.data.y,modifiers:e.modifiers,timeoutHandle:this._clock.setTimeout(()=>this._removeState(e.data),n)}}_removeState(e){const i=ze(e);this._pointerState.delete(i),this.stopCapturingPointer(e.native),this.refreshHasPendingInputs()}},uh=class extends He{constructor(e=O.maximumClickDelay,i=O.movementUntilMouseDrag,n=O.movementUntilPenDrag,o=O.movementUntilTouchDrag,s=O.holdDelay,a=ut){super(!1),this._maximumClickDelay=e,this._movementUntilMouseDrag=i,this._movementUntilPenDrag=n,this._movementUntilTouchDrag=o,this._holdDelay=s,this._clock=a,this._pointerState=new Map,this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",l=>this._handlePointerDown(l)),this.registerIncoming("pointer-up",l=>this._handlePointerLoss(l,"pointer-up")),this.registerIncoming("pointer-capture-lost",l=>this._handlePointerLoss(l,"pointer-capture-lost")),this.registerIncoming("pointer-cancel",l=>this._handlePointerLoss(l,"pointer-cancel")),this._moveHandle=this.registerIncoming("pointer-move",l=>this._handlePointerMove(l)),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach(e=>{e.holdTimeout=ge(e.holdTimeout)}),super.onUninstall()}_handlePointerDown(e){const i=e.data,n=i.native.pointerId;let o=null;this._pointerState.size===0&&(o=this._clock.setTimeout(()=>{const a=this._pointerState.get(n);if(a){if(!a.isDragging){const l=a.previousEvent;this._pointerHold.emit(l,void 0,e.modifiers),a.holdEmitted=!0}a.holdTimeout=null}},this._holdDelay));const s={startEvent:i,previousEvent:i,startTimestamp:e.timestamp,isDragging:!1,downButton:i.native.button,holdTimeout:o,modifiers:new Set};this._pointerState.set(n,s),this.startCapturingPointer(i.native),this._moveHandle.resume(),this._pointerState.size>1&&this._startDragging(e)}_handlePointerMove(e){const i=e.data,n=i.native.pointerId,o=this._pointerState.get(n);o&&(o.isDragging?this._pointerDrag.emit(Ge("update",o,i),void 0,o.modifiers):Us(i,o.startEvent)>this._getDragThreshold(i.native.pointerType)&&this._startDragging(e),o.previousEvent=i)}_getDragThreshold(e){switch(e){case"touch":return this._movementUntilTouchDrag;case"pen":return this._movementUntilPenDrag;default:return this._movementUntilMouseDrag}}_startDragging(e){const i=e.data,n=i.native.pointerId;this._pointerState.forEach(o=>{o.holdTimeout!=null&&(o.holdTimeout.remove(),o.holdTimeout=null),o.isDragging||(o.modifiers=e.modifiers,o.isDragging=!0,n===o.startEvent.native.pointerId?this._pointerDrag.emit(Ge("start",o,i)):this._pointerDrag.emit(Ge("start",o,o.previousEvent),e.timestamp))})}_handlePointerLoss(e,i){const n=e.data,o=n.native.pointerId,s=this._pointerState.get(o);s&&(s.holdTimeout!=null&&(s.holdTimeout.remove(),s.holdTimeout=null),s.isDragging?this._pointerDrag.emit(Ge("end",s,i==="pointer-up"?n:s.previousEvent),void 0,s.modifiers):i==="pointer-up"&&s.downButton===n.native.button&&e.timestamp-s.startTimestamp<=this._maximumClickDelay&&!s.holdEmitted&&this._immediateClick.emit(n),this._pointerState.delete(o),this.stopCapturingPointer(n.native),this._pointerState.size===0&&this._moveHandle.pause())}};function Ge(t,e,i){return{action:t,startEvent:e.startEvent,previousEvent:e.previousEvent,currentEvent:i}}let ph=class extends He{constructor(e=O.maximumDoubleClickDelay,i=O.maximumDoubleClickDistance,n=O.maximumDoubleTouchDelay,o=O.maximumDoubleTouchDistance,s=ut){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=i,this._maximumDoubleTouchDelay=n,this._maximumDoubleTouchDistance=o,this._clock=s,this._pointerState=new Map,this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",a=>this._handleImmediateClick(a)),this.registerIncoming("pointer-down",a=>this._handlePointerDown(a))}onUninstall(){this._pointerState.forEach(e=>e.doubleClickTimer=ge(e.doubleClickTimer))}get hasPendingInputs(){for(const e of this._pointerState.values())if(e.doubleClickTimer!=null)return!0;return!1}_clearDoubleClickTimer(e,i){const n=this._pointerState.get(e);n&&(n.doubleClickTimer=ge(n.doubleClickTimer),i&&this._click.emit(n.event.data,void 0,n.event.modifiers),this._pointerState.delete(e),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(e){const i=this._pointerState.get(e);i.pointerDownCount===1&&this._click.emit(i.event.data,void 0,i.event.modifiers),i.doubleClickTimer=null,this._pointerState.delete(e),this.refreshHasPendingInputs()}_handleImmediateClick(e){const i=e.data,{pointerType:n}=i.native,o=Js(i);if(!this._pointerState.has(o))return void this._startClick(e);const s=this._pointerState.get(o),{data:a,modifiers:l}=s.event,d=n==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;Gt(a,i)>d?(this._clearDoubleClickTimer(o,!0),this._startClick(e)):(this._clearDoubleClickTimer(o,!1),s.pointerDownCount===2&&this._doubleClick.emit(a,void 0,l))}_handlePointerDown(e){const i=ze(e.data),n=this._pointerState.get(i);n&&(n.pointerDownCount+=1)}_startClick(e){const{data:i}=e,{native:{pointerType:n}}=i,o=ze(i),s=n==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,a=this._clock.setTimeout(()=>this._doubleClickTimeoutExceeded(o),s);this._pointerState.set(o,{event:e,doubleClickTimer:a,pointerDownCount:1}),this.refreshHasPendingInputs()}};function Js(t){const{pointerId:e,pointerType:i,button:n}=t.native;return i==="mouse"?`${e}:${n}`:`${i}`}const Ys=t=>t,yt=t=>t*t,ii=t=>1-yt(1-t),Qs=t=>t<.5?yt(2*t)/2:(ii(2*(t-.5))+1)/2,ni=t=>t*t*t,yn=t=>1-ni(1-t),Xs=t=>t<.5?ni(2*t)/2:(yn(2*(t-.5))+1)/2,oi=t=>t*t*t*t,_n=t=>1-oi(1-t),ea=t=>t<.5?oi(2*t)/2:(_n(2*(t-.5))+1)/2,si=t=>t*t*t*t*t,vn=t=>1-si(1-t),ta=t=>t<.5?si(2*t)/2:(vn(2*(t-.5))+1)/2,ai=t=>1-Math.cos(t*Math.PI/2),wn=t=>1-ai(1-t),ia=t=>t<.5?ai(2*t)/2:(wn(2*(t-.5))+1)/2,ri=t=>2**(10*(t-1)),li=t=>1-ri(1-t),na=t=>t<.5?ri(2*t)/2:(li(2*(t-.5))+1)/2,hi=t=>-(Math.sqrt(1-t*t)-1),bn=t=>1-hi(1-t),oa=t=>t<.5?hi(2*t)/2:(bn(2*(t-.5))+1)/2;function z(t){const e=2*(t-Math.sqrt((t-1)*t)),i=e/2/t;return n=>n<i?t*n*n:e*n-e+1}function N(t,e){return(i,n)=>i<e?e*t(i/e,n):1-t((1-i)/(1-e),n)*(1-e)}const sa=N(z(1),1),aa=N(z(1),0),Kt=N(z(1),.5),ra=N(z(2),1),la=N(z(2),0),ha=N(z(2),.5),da=N(z(3),1),ua=N(z(3),0),ca=N(z(3),.5),pa=N(z(4),1),ma=N(z(4),0),ga=N(z(4),.5),gh={linear:Ys,"in-quad":yt,"out-quad":ii,"in-out-quad":Qs,"in-coast-quad":sa,"out-coast-quad":aa,"in-out-coast-quad":Kt,"in-cubic":ni,"out-cubic":yn,"in-out-cubic":Xs,"in-coast-cubic":ra,"out-coast-cubic":la,"in-out-coast-cubic":ha,"in-quart":oi,"out-quart":_n,"in-out-quart":ea,"in-coast-quart":da,"out-coast-quart":ua,"in-out-coast-quart":ca,"in-quint":si,"out-quint":vn,"in-out-quint":ta,"in-coast-quint":pa,"out-coast-quint":ma,"in-out-coast-quint":ga,"in-sine":ai,"out-sine":wn,"in-out-sine":ia,"in-expo":ri,"out-expo":li,"in-out-expo":na,"in-circ":hi,"out-circ":bn,"in-out-circ":oa,ease:t=>Be.ease(t),"ease-in":t=>Be.easeIn(t),"ease-out":t=>Be.easeOut(t),"ease-in-out":t=>Be.easeInOut(t)};let fa=class{constructor(){this.pan=0,this.rotate=0,this.fov=0,this.sourceZoom=0,this.targetZoom=0}};const ht={desiredScreenFlow:2,minDuration:ae(500),maxDuration:ae(8e3)},yh={maxDuration:ae(4e3)};let ya=class Mn{constructor(e){this._createCamera=e,this.compared=new fa,this.segmentStart=0,this.segmentEnd=1,this.settings={desiredScreenFlow:ht.desiredScreenFlow},this.source=e(),this.target=e()}clone(){const e=new Mn(this._createCamera);return e.copyFrom(this),e}copyFrom(e){this.update(e.source,e.target,e.settings)}update(e,i,n){this.source!==e&&this.source.copyFrom(e),this.target!==i&&this.target.copyFrom(i),this.source.compareTo(this.target,this.compared),this.settings.desiredScreenFlow=n.desiredScreenFlow??ht.desiredScreenFlow,this.desiredPixelFlow=this.settings.desiredScreenFlow*this.target.size,this.halfWindowSize=this.target.size/2}halfWindowPanAtZoom(e){const i=this.target.pixelsPerPanAtZoom(e);return this.halfWindowSize/i}get hasZoom(){return Math.abs(this.compared.sourceZoom-this.compared.targetZoom)>1e-5}get hasPan(){return this.compared.pan>bt()}get hasFov(){return Math.abs(this.compared.fov)>bt()}get hasRotate(){return this.compared.rotate>bt()}},_a=class{constructor(){this.pan=0,this.rotate=0,this.zoom=0,this.fov=0,this.zoomOffset=0}},va=class{constructor(){this.segments=new Array}get time(){return this.segments.reduce((e,i)=>A(e+i.time),A(0))}interpolateComponentsAt(e,i){e=Math.min(Math.max(e,0),1),e*=this.time;let n=0,o=0;const s=this.definition,a=this.segments.reduce((l,d)=>l||d.definition.hasZoom,!1);for(let l=0;l<this.segments.length;l++){const d=this.segments[l],u=d.definition;if(e<=d.time||l===this.segments.length-1){if(this.segmentInterpolateComponentsAt(d,d.time===0?0:e/d.time,i),s.hasPan&&!isNaN(i.pan)&&isFinite(s.compared.pan)?i.pan=(n+u.compared.pan*i.pan)/s.compared.pan:i.pan=1,s.hasRotate&&!isNaN(i.rotate)&&isFinite(s.compared.rotate)?i.rotate=(o+u.compared.rotate*i.rotate)/s.compared.rotate:i.rotate=1,a&&!isNaN(i.zoom)&&isFinite(u.compared.targetZoom)){const{sourceZoom:c,targetZoom:g}=u.compared,p=i.zoom*(g-c)+c,f=this.segments[0].definition.compared.sourceZoom,q=this.segments[this.segments.length-1].definition.compared.targetZoom,I=Math.abs(g-f)>Math.abs(c-f)?g:c;i.zoomOffset=I-q,i.zoom=(p-f)/(I-f)}else i.zoom=1;return i}e-=d.time,n+=u.compared.pan,o+=u.compared.rotate}}segmentInterpolateComponentsAt(e,i,n){e.interpolateComponentsAt(i,n)}},It=class{get time(){return this._time}constructor(e){e&&this.update(e)}update(e){e&&(this.definition?this.definition.copyFrom(e):this.definition=e.clone()),this._updatePrecomputedVariables(),this._updatePixelFlow()}_updatePrecomputedVariables(){const e=this.definition,i=e.compared,n=i.sourceZoom,o=i.targetZoom;this._zoomSign=n>o?1:-1,this._panPixelsAtSource=i.pan*e.source.pixelsPerPanAtZoom(n);const s=(e.source.pixelsPerRotate()+e.target.pixelsPerRotate())/2;this._rotatePixels=i.rotate*s}_updatePixelFlow(){const e=this.definition.compared.sourceZoom,i=this.definition.compared.targetZoom,{hasZoom:n,hasPan:o,hasRotate:s}=this.definition;let a=0,l=0;n&&(o&&(a=(i/e-1)/(-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2*this._panPixelsAtSource)),s&&(l=this._zoomSign*(Math.log(e/i)/Math.LN2)*this.definition.halfWindowSize/this._rotatePixels)),this._zoomPixelFlow=0,this._panPixelFlow=0,this._rotatePixelFlow=0;const d=this.definition.desiredPixelFlow;if(n&&o&&s){const u=a+l+a*l;this._zoomPixelFlow=a*l/u*d,this._panPixelFlow=l/u*d,this._rotatePixelFlow=a/u*d}else if(n&&o){const u=1+a;this._zoomPixelFlow=a/u*d,this._panPixelFlow=1/u*d}else if(n&&s){const u=1+l;this._zoomPixelFlow=l/u*d,this._rotatePixelFlow=1/u*d}else if(o&&s){const u=this._panPixelsAtSource/this._rotatePixels,c=1+u;this._panPixelFlow=u/c*d,this._rotatePixelFlow=1/c*d}else o?this._panPixelFlow=d:n?this._zoomPixelFlow=d:s&&(this._rotatePixelFlow=d);if(this._time=A(Math.max(this.rotateTime,this.zoomTime,this.panTime)),this.fovTime>this._time){const u=this.fovTime/this._time;this._time=this.fovTime,this._zoomPixelFlow/=u,this._panPixelFlow/=u,this._rotatePixelFlow/=u}}get rotateTime(){return this.definition.hasRotate?A(this._rotatePixels/this._rotatePixelFlow):A(0)}get zoomTime(){return this.definition.hasZoom?A(this._zoomSign*(Math.log(this.definition.compared.sourceZoom/this.definition.compared.targetZoom)/Math.LN2)*this.definition.halfWindowSize/this._zoomPixelFlow):A(0)}get fovTime(){return this.definition.hasFov?A(Math.abs(this.definition.compared.fov)/wa):A(0)}get panTime(){if(!this.definition.hasPan)return A(0);if(this.definition.hasZoom){const e=-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2,i=e*this._panPixelsAtSource;return A(Math.log(i*(this._zoomPixelFlow/this._panPixelFlow)+1)/(e*this._zoomPixelFlow))}return A(this._panPixelsAtSource/this._panPixelFlow)}_interpolateComponentsZoom(e){if(e===0||e===1)return e;if(this.definition.hasZoom){const i=this.definition.compared.sourceZoom,n=this.definition.compared.targetZoom;return(i*(i/n)**-e-i)/(n-i)}return e}_interpolateComponentsFov(e){if(e===0)return this.definition.segmentStart;if(e===1)return this.definition.segmentEnd;if(this.definition.hasFov){const{segmentStart:i,segmentEnd:n}=this.definition;return i+e*(n-i)}return this.definition.segmentStart}_interpolateComponentsPan(e){if(e===0||e===1)return e;if(this.definition.hasPan&&this.definition.hasZoom){const i=-1/(this._zoomSign*this.definition.halfWindowSize)*this._zoomPixelFlow;return 1/this._panPixelsAtSource*(this._panPixelFlow*(2**(i*e*this._time)-1))/(i*Math.LN2)}return e}_interpolateComponentsRotate(e){return e}interpolateComponentsAt(e,i){e=Math.min(Math.max(e,0),1),i.zoom=this._interpolateComponentsZoom(e),i.pan=this._interpolateComponentsPan(e),i.rotate=this._interpolateComponentsRotate(e),i.zoomOffset=0,i.fov=this._interpolateComponentsFov(e)}};const wa=Lo(45);function ba(t,e,i){const n=e-t.compared.sourceZoom,o=t.halfWindowPanAtZoom(n);return-t.halfWindowSize*(i.ascensionFactor*Math.LN2*t.compared.pan+o)*Math.log(t.compared.sourceZoom/e)/(t.desiredPixelFlow*Math.LN2*o)}function Ma(t,e,i){const n=1/e,o=Math.log(t.compared.sourceZoom*n),s=1/t.desiredPixelFlow,a=1/Math.LN2,l=e-t.compared.sourceZoom,d=1/l,u=(i.ascensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(l))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*n*s*a*d*u-t.halfWindowSize*o*s*a*d+t.halfWindowSize*o*s*a*u/(l*l)}function xa(t,e,i){const n=e-t.compared.sourceZoom,o=1/n,s=1/e,a=Math.log(t.compared.sourceZoom*s),l=(i.ascensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(n))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*o*(-2*o*s*l+2*o*a+2*s-2*a*l/(n*n)-l/(e*e))/(t.desiredPixelFlow*Math.LN2)}function Ta(t,e){return-t.halfWindowSize*Math.log(t.compared.sourceZoom/e)/(t.desiredPixelFlow*Math.LN2)}function $a(t,e){return t.halfWindowSize/(e*t.desiredPixelFlow*Math.LN2)}function ka(t,e){return-t.halfWindowSize/(e*e*t.desiredPixelFlow*Math.LN2)}function Pa(t,e,i){return-t.compared.pan*t.halfWindowSize*(i.ascensionFactor+i.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e))}function Ca(t,e,i){return t.compared.pan*t.halfWindowSize*(i.ascensionFactor+i.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e*e))}function Sa(t,e,i){return-2*t.compared.pan*t.halfWindowSize*(i.ascensionFactor+i.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e*e*e))}function Ea(t,e,i){return t.halfWindowSize*(-t.halfWindowPanAtZoom(e)-i.descensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(t.compared.targetZoom))*Math.log(e/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2*t.halfWindowPanAtZoom(-e+t.compared.targetZoom))}function Ia(t,e,i){const n=Math.log(e/t.compared.targetZoom),o=1/t.desiredPixelFlow,s=1/Math.LN2,a=-e+t.compared.targetZoom,l=1/a,d=(-t.halfWindowPanAtZoom(e)-i.descensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(t.compared.targetZoom))/t.halfWindowPanAtZoom(1);return-t.halfWindowSize*n*o*s*l+t.halfWindowSize*n*o*s*d/(a*a)+t.halfWindowSize*o*s*l*d/e}function La(t,e,i){const n=e-t.compared.targetZoom,o=1/n,s=1/e,a=Math.log(e/t.compared.targetZoom),l=(t.halfWindowPanAtZoom(e)+i.descensionFactor*Math.LN2*t.compared.pan-t.halfWindowPanAtZoom(t.compared.targetZoom))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*o*(-2*o*s*l-2*o*a+2*s+2*a*l/(n*n)-l/(e*e))/(t.desiredPixelFlow*Math.LN2)}function Da(t,e){return t.halfWindowSize*Math.log(e/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2)}function Va(t,e){return t.halfWindowSize/(e*t.desiredPixelFlow*Math.LN2)}function Aa(t,e){return-t.halfWindowSize/(e*e*t.desiredPixelFlow*Math.LN2)}function Oa(t){const e=t.compared.sourceZoom-t.compared.targetZoom;if(e===0)return t.compared.pan*t.halfWindowSize/(t.desiredPixelFlow*t.halfWindowPanAtZoom(t.compared.sourceZoom));const i=Math.LN2*t.compared.pan,n=e,o=t.halfWindowPanAtZoom(n),s=t.halfWindowSize*Math.log(t.compared.sourceZoom/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2*o);return t.compared.sourceZoom<=t.compared.targetZoom?s*(i-o):s*(i+o)}function Fa(t,e){let i=Ra(t,e);const n={ascensionFactor:e.ascensionFactor!=null?e.ascensionFactor:.5,descensionFactor:e.descensionFactor!=null?e.descensionFactor:.5},o=n.ascensionFactor===0,s=n.descensionFactor===0,a=o?Ta:ba,l=o?$a:Ma,d=o?ka:xa,u=s?Da:Ea,c=s?Va:Ia,g=s?Aa:La,p=_=>a(t,_,n)+Pa(t,_,n)+u(t,_,n),f=_=>l(t,_,n)+Ca(t,_,n)+c(t,_,n),q=_=>d(t,_,n)+Sa(t,_,n)+g(t,_,n);let I=p(i);const fe=Oa(t);let T;const j=e.maximumIterations||20,w=e.maximumDistance!=null?e.maximumDistance:1/0;for(T=0;T<j;T++){const _=e.desiredSlope??1e-6;let $=f(i);Math.abs($)>_&&($+=_);const L=$/q(i);if(isNaN(L)||i>=w&&L<0){if(!isFinite(w))return null;i=w,I=p(i);break}if(i-=L,i<t.compared.sourceZoom||i<t.compared.targetZoom)return null;const Y=p(i);if(Math.abs(Y-I)/I<=.005)break;I=Y}return I>fe*(1-.3)||i<t.compared.sourceZoom||i<t.compared.targetZoom?null:i}function Ra(t,e){const i=Math.max(t.compared.sourceZoom,t.compared.targetZoom),n=t.source.zoomAtPixelsPerPan(t.desiredPixelFlow/t.compared.pan)/2;return n<i?e.maximumDistance!=null?i+(e.maximumDistance-i)/2:1.5*i:e.maximumDistance?Math.min(e.maximumDistance,n):n}let za=class extends va{constructor(e,i){super(),this._preallocSegments=[new It,new It,new It],this._ascensionSegment=null,this._descensionSegment=null,this.update(e,i)}update(e,i){if(!e)return;this.definition?this.definition.copyFrom(e):this.definition=e.clone();const n=i!=null&&i.apex?Fa(e,i.apex):null;this.segments.length=0,this._ascensionSegment=null,this._descensionSegment=null,n?this._updateWithApex(n,i==null?void 0:i.apex):this._updateWithoutApex()}segmentInterpolateComponentsAt(e,i,n){e.interpolateComponentsAt(i,n),e===this._ascensionSegment?n.zoom=ii(n.zoom):e===this._descensionSegment&&(n.zoom=yt(n.zoom))}_updateWithApex(e,i){const[n,o,s]=this._preallocSegments,a=(i==null?void 0:i.ascensionFactor)??.5,l=Math.min(1-a,(i==null?void 0:i.ascensionFactor)!=null&&i.descensionFactor!=null?i.descensionFactor:.5),d=1-a-l;n.definition?n.definition.copyFrom(this.definition):n.definition=this.definition.clone(),n.definition.compared.targetZoom=e,n.definition.compared.pan=this.definition.compared.pan*a,n.definition.compared.rotate=this.definition.compared.rotate*a,n.definition.segmentEnd=a,n.update(),this._ascensionSegment=n,this.segments.push(n),d>0&&(o.definition?o.definition.copyFrom(this.definition):o.definition=this.definition.clone(),o.definition.copyFrom(this.definition),o.definition.compared.sourceZoom=e,o.definition.compared.targetZoom=e,o.definition.compared.pan=this.definition.compared.pan*d,o.definition.compared.rotate=this.definition.compared.rotate*d,o.definition.segmentStart=n.definition.segmentEnd,o.definition.segmentEnd=n.definition.segmentEnd+d,o.update(),this.segments.push(o)),s.definition?s.definition.copyFrom(this.definition):s.definition=this.definition.clone(),s.definition.compared.sourceZoom=e,s.definition.compared.pan=this.definition.compared.pan*l,s.definition.compared.rotate=this.definition.compared.rotate*l,s.definition.segmentStart=a+d,s.update(),this._descensionSegment=s,this.segments.push(s)}_updateWithoutApex(){const[e]=this._preallocSegments;e.update(this.definition),this.segments.push(e)}};const Na=new _a;let Mh=class{get time(){return this._time}get isLinear(){return this.path.segments.length===1}constructor(e){this._time=ae(0),this._easing=Kt,this.definition=new ya(e),this.path=new za}update(e,i,n){this.definition.update(e,i,n),this.path.update(this.definition,n),this._time=this._applyTimeSettings(Jn(isFinite(this.path.time)?this.path.time:A(0)),n),this._easing=n.easing??(this._time>=1e3?Kt:li)}cameraAt(e,i){e=Math.min(Math.max(0,e),1),e=this._normalizedEasing(e);const n=this.path.interpolateComponentsAt(e,Na);i.interpolate(this.definition.source,this.definition.target,n)}_normalizedEasing(e){const i=this._easing(0,this._time),n=this._easing(1,this._time);return(this._easing(e,this._time)-i)/(n-i)}_applyTimeSettings(e,i){const n=i.speedFactor!=null?i.speedFactor:1,o=i.minDuration??ht.minDuration/n,s=i.maxDuration??ht.maxDuration/n;return e=i.duration!=null?ae(i.duration):ae(Math.min(Math.max(e/n,o),s))}};const Hi=2048,Ha=1.5,Wa=8;function xn(t,e){const{format:i,quality:n,rotation:o,disableDecorations:s}=t||{},a=di(t,e.padding),l=Qa(t,{width:e.width-a.left-a.right,height:e.height-a.top-a.bottom}),{width:d,height:u}=Ya(t,l),c=Pn(i),g=Cn[c];return{format:c,quality:at(n??g,0,100),area:l,width:d,height:u,rotation:o,disableDecorations:!!s,ignoreBackground:!!(t!=null&&t.ignoreBackground),ignorePadding:!!(t!=null&&t.ignorePadding)}}function Za(t,e){const i=xn(t,e),n=i.area,o=i.width/n.width,s=di(i,e.padding),a=s.left+s.right,l=s.top+s.bottom,d=e.width-a,u=e.height-l,c=Math.floor(d*o+a),g=Math.floor(u*o+l),p=(t==null?void 0:t.layers)??[],f=i.ignoreBackground,q=i.ignorePadding;return{framebufferWidth:c,framebufferHeight:g,region:{x:Math.floor(n.x*o)+s.left,y:Math.floor(n.y*o)+s.top,width:i.width,height:i.height},format:i.format,quality:i.quality,rotation:i.rotation,pixelRatio:o,layers:p,disableDecorations:i.disableDecorations,ignoreBackground:f,ignorePadding:q,objectAndLayerIdColor:!1}}function qa(t,e,i){const{ctx:n,canvas:o}=Tn(t,i),s=n.getImageData(0,0,t.width,t.height),a=kn(o,e);return $n(o),{dataUrl:a,data:s}}function ja(t,e){const{ctx:i,canvas:n}=Tn(t,e),o=i.getImageData(0,0,t.width,t.height);return $n(n),o}function Tn(t,e){const i=Ba();e.premultipliedAlpha&&ir(t),i.width=t.width,i.height=t.height;const n=i.getContext("2d",{willReadFrequently:!0});return n.putImageData(t,0,0),e.flipY&&tr(n),{ctx:n,canvas:i}}function $n(t){t.width=0,t.height=0}function Ba(){return Lt==null&&(Lt=document.createElement("canvas")),Lt}let Lt=null;function kn(t,e){const i=nr[e.format],n=e.quality/100;return t.toDataURL(i,n)}function Ua(t,e){const i=Pn(t),n=Cn[i];return{format:i,quality:at(e??n,0,100)}}function Ga(t,e){return e/Math.max(t[0],t[1])}function Ka(t,e,i,n=0,o=0,s=t.width-n,a=t.height-o,l=!1){const{data:d}=t,{width:u,height:c,data:g}=e,p=s/u,f=a/c,q=Math.ceil(p/2),I=Math.ceil(f/2),fe=t.width;for(let T=0;T<c;T++)for(let j=0;j<u;j++){const w=4*(j+(l?c-T-1:T)*u);let _=0,$=0,L=0,Y=0,ui=0,ci=0;const Ln=(T+.5)*f;for(let We=Math.floor(T*f);We<(T+1)*f;We++){const pi=Math.abs(Ln-(We+.5))/I,Dn=(j+.5)*p,Vn=pi*pi;for(let Ze=Math.floor(j*p);Ze<(j+1)*p;Ze++){const mi=Math.abs(Dn-(Ze+.5))/q,be=Math.sqrt(Vn+mi*mi);if(be>=1)continue;let re=2*be*be*be-3*be*be+1;const Me=4*(n+Ze+(o+We)*fe);ci+=re*d[Me+3],$+=re,!i&&d[Me+3]<255&&(re=re*d[Me+3]/255),L+=re*d[Me],Y+=re*d[Me+1],ui+=re*d[Me+2],_+=re}}g[w]=L/_,g[w+1]=Y/_,g[w+2]=ui/_,g[w+3]=ci/$}return e}function Ja(t,e,i){if(!e)return t;const{framebufferWidth:n,framebufferHeight:o,pixelRatio:s,region:a}=t,l=di(t,i),d=l.left+l.right,u=l.top+l.bottom,c=n-d,g=o-u,p=Math.min(Wa,Math.min((Hi-d)/c,(Hi-u)/g));return p<Ha?t:{...t,framebufferWidth:Math.round(c*p)+d,framebufferHeight:Math.round(g*p)+u,pixelRatio:s*p,resample:{region:{x:Math.round((a.x-l.left)*p)+l.left,y:Math.round((a.y-l.top)*p)+l.top,width:Math.round(a.width*p),height:Math.round(a.height*p)},width:n,height:o}}}function Ya(t,e){if(!t)return e;const i=t.width,n=t.height;if(i!=null&&n!=null)return{width:Math.floor(i),height:Math.floor(n)};if(i==null&&n==null)return e;const o=e.width/e.height;return n==null?{width:Math.floor(i),height:Math.floor(i/o)}:{width:Math.floor(n*o),height:Math.floor(n)}}function Qa(t,e){const i={x:0,y:0,width:e.width,height:e.height};if(t!=null&&t.area){t.area.x!=null&&(i.x=Math.floor(t.area.x)),t.area.y!=null&&(i.y=Math.floor(t.area.y));const n=t.area.width!=null?Math.floor(t.area.width):null,o=t.area.height!=null?Math.floor(t.area.height):null;if(i.width=e.width-i.x,i.height=e.height-i.y,n!=null&&o!=null)i.width=Math.min(i.width,n),i.height=Math.min(i.height,o);else if(n==null&&o!=null){const s=Math.min(i.width,n);i.height=s/i.width*i.height,i.width=s}else if(n!=null&&o==null){const s=Math.min(i.height,o);i.width=s/i.height*i.width,i.height=s}}return Xa(er(i,t),e)}function Xa(t,e){const i=Math.floor(Math.max(t.x,0)),n=Math.floor(Math.max(t.y,0)),o={x:i,y:n,width:Math.floor(Math.min(t.width,e.width-i)),height:Math.floor(Math.min(t.height,e.height-n))},s=o.width/o.height,a=t.width/t.height;if(a===s)return o;if(a>s){const u=Math.floor(o.width/a),c=o.height-u;return{x:o.x,y:Math.floor(o.y+c/2),width:o.width,height:u}}const l=Math.floor(o.height*a),d=o.width-l;return{x:Math.floor(o.x+d/2),y:o.y,width:l,height:o.height}}function er(t,e){if((e==null?void 0:e.width)==null||e.height==null)return t;const i=e.width/e.height,n=t.width/t.height;if(n===i)return t;if(n<i){const s=Math.floor(t.height*i);return t.x-=(s-t.width)/2,t.width=s,t}const o=Math.floor(t.width/i);return t.y-=(o-t.height)/2,t.height=o,t}function di(t,e){return!e||t!=null&&t.ignorePadding?sr:e}function Pn(t){switch(t){case"png":case"jpg":case"jpeg":return t;default:return or}}function tr(t){t.save(),t.globalCompositeOperation="copy",t.scale(1,-1),t.translate(0,-t.canvas.height),t.drawImage(t.canvas,0,0),t.restore()}function ir(t){const e=t.data,i=e.length;for(let n=0;n<i;n+=4){const o=e[n+3];if(o!==255&&o>0){const s=255/o;e[n]=e[n]*s,e[n+1]=e[n+1]*s,e[n+2]=e[n+2]*s}}}const nr={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},Wi=98,or="png",Cn={png:100,jpg:Wi,jpeg:Wi},sr={top:0,right:0,bottom:0,left:0},Th=Object.freeze(Object.defineProperty({__proto__:null,completeUserSettings:xn,createEmptyImageData:Jo,encode:qa,encodeData:ja,getFormatAndQuality:Ua,getMaximumResolutionScale:Ga,resampleHermite:Ka,screenshotSuperSampleSettings:Ja,toDataUrl:kn,toRenderSettings:Za},Symbol.toStringTag,{value:"Module"}));function $h(t){const e=Yo();return e.available?t==="3d"&&e.majorPerformanceCaveat?new S("webgl:major-performance-caveat-detected",`Your WebGL implementation (${e.unmaskedRenderer}) doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist.`):e.supportsHighPrecisionFragment?e.supportsVertexShaderSamplers?null:new S("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported."):new S("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported."):new S("webgl:required","WebGL2 is required but not supported.",new Error().stack)}function ar(t){return t&&"nodeType"in t}function rr(t){return t&&typeof t.render=="function"}const Zi={component:"esri-component"};let ve=class extends M{constructor(){super(...arguments),this.widget=null}destroy(){var e;this.node=null,(e=this.widget)==null||e.destroy()}get id(){var e,i;return this._get("id")??((e=this.widget)==null?void 0:e.id)??((i=this.node)==null?void 0:i.id)}set id(e){this._set("id",e)}set node(e){const i=this._get("node");e!==i&&(e&&e.classList.add(Zi.component),i&&i.classList.remove(Zi.component),this._set("node",e))}castNode(e){var i;return(i=this.widget)==null||i.destroy(),e?typeof e=="string"||ar(e)?(this._set("widget",null),Xi(e)):(rr(e)&&!e.domNode&&(e.domNode=document.createElement("div")),this._set("widget",e),e.domNode):(this._set("widget",null),null)}};r([h()],ve.prototype,"id",null),r([h()],ve.prototype,"node",null),r([st("node")],ve.prototype,"castNode",null),r([h({readOnly:!0})],ve.prototype,"widget",void 0),ve=r([y("esri.views.ui.Component")],ve);const et=ve,lr={left:0,top:0,bottom:0,right:0},Sn={bottom:30,top:15,right:15,left:15},X="esri-ui",C={ui:X,corner:`${X}-corner`,innerContainer:`${X}-inner-container`,manualContainer:`${X}-manual-container`,cornerContainer:`${X}-corner-container`,topLeft:`${X}-top-left`,topRight:`${X}-top-right`,bottomLeft:`${X}-bottom-left`,bottomRight:`${X}-bottom-right`};function hr(t){return t&&!t._started&&typeof t.postMixInProperties=="function"&&typeof t.buildRendering=="function"&&typeof t.postCreate=="function"&&typeof t.startup=="function"}function Ke(t){return t===0?"0":`${t}px`}function Dt(t){const e=typeof t=="object"&&t!==null&&Object.getPrototypeOf(t);return(e===null||e===Object.prototype)&&("component"in t||"index"in t||"position"in t)?t:null}function Vt(t,{top:e,bottom:i,left:n,right:o}){t.style.top=e,t.style.bottom=i,t.style.left=n,t.style.right=o}let G=class extends ft.EventedAccessor{constructor(t){super(t),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentMap=new Map,this._removeWidgetHandleKey=Symbol("componentOnRemoveSymbol"),this._locale=fo(),this.view=null,this._applyViewPadding=()=>{const e=this.container;e&&Vt(e,this._toPixelPosition(this._getViewPadding()))},this._applyUIPadding=()=>{const e=this._innerContainer;e&&Vt(e,this._toPixelPosition(this.padding))},this._initContainers()}initialize(){this.addHandles([b(()=>{var t;return[(t=this.view)==null?void 0:t.padding,this.container]},this._applyViewPadding,K),b(()=>this.padding,this._applyUIPadding,K),b(()=>[this.container,this._locale],([t,e])=>{t&&t.setAttribute("lang",e)},K),yo(t=>{this._locale=t})])}destroy(){this.container=null;for(const t of this._components)t.destroy();this._components.length=0,this._componentMap.clear()}set container(t){const e=this._get("container");t!==e&&(t&&(t.classList.add(C.ui),Qo(t),this._attachContainers(t)),e&&(e.classList.remove(C.ui),Vt(e,{top:"",bottom:"",left:"",right:""}),e.textContent=""),this._set("container",t))}get height(){var o;const t=((o=this.view)==null?void 0:o.height)??0;if(t===0)return t;const e=this._getViewPadding(),{top:i,bottom:n}=e;return Math.max(t-i-n,0)}get padding(){return this._get("padding")}set padding(t){this._overrideIfSome("padding",t)}castPadding(t){return typeof t=="number"?{bottom:t,top:t,right:t,left:t}:{...Sn,...t}}get width(){var o;const t=((o=this.view)==null?void 0:o.width)??0;if(t===0)return t;const e=this._getViewPadding(),{left:i,right:n}=e;return Math.max(t-i-n,0)}add(t,e){let i,n,o;if(Array.isArray(t))return void t.forEach(a=>this.add(a,e));const s=Dt(t);s&&({index:i,position:e,component:t,key:n}=s),e&&typeof e=="object"&&({index:i,key:n,position:e,internal:o}=e),!t||e&&!this._isValidPosition(e)||this._add(t,e,i,n,o)}remove(t,e){var n,o;if(!t)return;if(Array.isArray(t))return t.map(s=>this.remove(s,e));const i=this._find(t);if(i){if(this._componentMap.has(i)&&((n=this._componentMap.get(i))==null?void 0:n.key)!==e)return;const s=this._components.indexOf(i),a=i.node.parentNode;return a==null||a.removeChild(i.node),this._componentMap.delete(i),(o=i.widget)==null||o.removeHandlesReference(this._removeWidgetHandleKey),this._components.splice(s,1)[0]}}empty(t,e={removeInternal:!1}){if(Array.isArray(t)){for(const o of t)this.empty(o,e);return}const i=this._positionNameToContainerLookup[t??"manual"],n=Array.prototype.slice.call(i.children).map(o=>this._findByNode(o)).filter(o=>{var s;return o==null?!1:!(((s=this._componentMap.get(o))==null?void 0:s.internal)??!1)||e.removeInternal});for(const o of n)this.remove(o)}move(t,e){if(Array.isArray(t)&&t.forEach(s=>this.move(s,e)),!t)return;let i;const n=Dt(t)||Dt(e);if(n&&(i=n.index,e=n.position,t=n.component||t),e&&!this._isValidPosition(e))return;const o=this.remove(t);o&&this.add(o,{position:e,index:i})}find(t){if(!t)return null;const e=this._findById(t);return e&&(e.widget||e.node)}getComponents(t,e={includeInternal:!1}){return t?Array.isArray(t)?t.flatMap(i=>this._getComponentsAtPosition(i,e)):this._getComponentsAtPosition(t,e):this._components.filter(i=>{var n;return e.includeInternal||!((n=this._componentMap.get(i))!=null&&n.internal)}).map(({widget:i,node:n})=>i??n)}getPosition(t){for(const e in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[e].contains(t))return e;return null}_add(t,e,i,n,o){t instanceof et||(t=new et({node:t}));const{widget:s}=t;s!=null&&s instanceof M&&s.addHandles(Yt(()=>{queueMicrotask(()=>this.remove(t))}),this._removeWidgetHandleKey),this._place({component:t,position:e,index:i}),this._components.push(t),this._componentMap.set(t,{key:n,internal:o})}_find(t){return t?t instanceof et?this._findByComponent(t):typeof t=="string"?this._findById(t):this._findByNode(t.domNode||t):null}_getViewPadding(){var t;return((t=this.view)==null?void 0:t.padding)??lr}_attachContainers(t){t.appendChild(this._innerContainer),t.appendChild(this._manualContainer)}_initContainers(){const t=document.createElement("div");t.classList.add(C.innerContainer,C.cornerContainer);const e=document.createElement("div");e.classList.add(C.innerContainer,C.manualContainer);const i=document.createElement("div");i.classList.add(C.topLeft,C.corner),t.appendChild(i);const n=document.createElement("div");n.classList.add(C.topRight,C.corner),t.appendChild(n);const o=document.createElement("div");o.classList.add(C.bottomLeft,C.corner),t.appendChild(o);const s=document.createElement("div");s.classList.add(C.bottomRight,C.corner),t.appendChild(s),this._innerContainer=t,this._manualContainer=e;const a=Qn();this._cornerNameToContainerLookup={"top-left":i,"top-right":n,"bottom-left":o,"bottom-right":s,"top-leading":a?n:i,"top-trailing":a?i:n,"bottom-leading":a?s:o,"bottom-trailing":a?o:s},this._positionNameToContainerLookup={manual:e,...this._cornerNameToContainerLookup}}_isValidPosition(t){return!!this._positionNameToContainerLookup[t]}_place(t){var d,u;const e=t.position??"manual",{component:i,index:n}=t,o=this._positionNameToContainerLookup[e],s=n!=null&&n>-1;if(hr(i.widget)&&i.widget.startup(),!s)return void o.appendChild(i.node);const a=Array.from(o.children);if(n===0){const{firstChild:c}=o;return void(c?(d=c.parentNode)==null?void 0:d.insertBefore(i.node,c):o.appendChild(i.node))}if(n>=a.length)return void o.appendChild(i.node);const l=a[n];(u=l.parentNode)==null||u.insertBefore(i.node,l)}_toPixelPosition(t){return{top:Ke(t.top),left:Ke(t.left),right:Ke(t.right),bottom:Ke(t.bottom)}}_findByComponent(t){return this._components.find(e=>e===t)??null}_findById(t){return this._components.find(({id:e})=>e===t)??null}_findByNode(t){return this._components.find(({node:e})=>e===t)??null}_getComponentsAtPosition(t,e){const i=this._positionNameToContainerLookup[t];return Array.prototype.slice.call(i.children).map(n=>this._findByNode(n)).filter(Yi).filter(n=>{var o;return e.includeInternal||!((o=this._componentMap.get(n))!=null&&o.internal)}).map(({widget:n,node:o})=>n??o)}};r([h()],G.prototype,"_locale",void 0),r([h()],G.prototype,"container",null),r([h()],G.prototype,"height",null),r([h({value:Sn})],G.prototype,"padding",null),r([st("padding")],G.prototype,"castPadding",null),r([h()],G.prototype,"view",void 0),r([h()],G.prototype,"width",null),G=r([y("esri.views.ui.UI")],G);const dr=G;let tt,it=null;const Le=new Map;async function Ph(t){it==null&&(tt==null&&(tt=Z(()=>import("./Lyr3DWasmPerSceneView-DShQOYMo.js"),__vite__mapDeps([211,2,6,7,8,9,1,3,4,212,213,151,152,38,26,214,215,5,10,128,129,216]),import.meta.url)),it=await tt);const e=t.view;let i=Le.get(e);i||(i=new it.default({view:e}),Le.set(e,i));const n=!!e._stage.renderView.renderingContext.capabilities.compressedTextureS3TC,o=!!e._stage.renderView.renderingContext.capabilities.compressedTextureETC;return await i.initializeWasm(n,o),i.add3DTilesLayerView(t)}function ur(t){return Le.get(t)}function Ch(t){const e=t.view,i=Le.get(e);i&&i.remove3DTilesLayerView(t)<1&&(Le.delete(e),Le.size===0&&(tt=null,it=null))}function qi(t,e){return t&&"copyright"in t&&(!e||typeof t.originOf=="function"&&t.originOf("copyright")==="user")}function cr(t,e){return t.length!==e.length||t.some((i,n)=>i.text!==e[n].text)}function Ve(t,e,i){!i||!e||t.find(n=>n.layerView===e&&n.text===i)||t.push({text:i,layerView:e})}function pr(t){return t.type==="bing-maps"}const ee=[];let Ee=class extends M{constructor(t){super(t),this._clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.removeHandles("suspension"),this.notifyChange("state")},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new x,this.view=null,this._allLayerViewsChange=e=>{var n;this.removeHandles("suspension"),this.removeHandles("visible-geometry-changed");const i=(n=this.view)==null?void 0:n.allLayerViews;i&&(this.addHandles(i.map(o=>b(()=>{var s;return[o.suspended,(s=o.layer)==null?void 0:s.attributionVisible]},()=>this._updateAttributionItems())).toArray(),"suspension"),i.forEach(o=>{o.declaredClass==="esri.views.3d.layers.Tiles3DLayerView3D"&&this.addHandles(o.on("visible-geometry-changed",()=>this._updateAttributionItems()),"visible-geometry-changed")})),e!=null&&e.removed&&e.removed.forEach(o=>{this._pendingAttributions.delete(o),this._fetchedAttributionData.delete(o)}),this._updateAttributionItems()},this.addHandles([ct(()=>{var e;return(e=this.view)==null?void 0:e.allLayerViews},"change",e=>this._allLayerViewsChange(e),{onListenerAdd:()=>this._allLayerViewsChange(),onListenerRemove:this._clear}),ot(()=>{var e;return((e=this.view)==null?void 0:e.stationary)===!0},()=>this._updateAttributionItems())])}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}get state(){var t;return(t=this.view)!=null&&t.ready?this._pendingAttributions.size>0?"loading":"ready":"disabled"}_updateAttributionItems(){const t=this.view,e=t==null?void 0:t.allLayerViews;if(ee.length=0,!t||!e)return void this._clear();e.forEach(n=>{var a,l;if(n.suspended||!((a=n.layer)!=null&&a.attributionVisible))return;const o=n.layer;if(qi(o,"user"))return void Ve(ee,n,o.copyright);if(o.hasAttributionData){if(this._fetchedAttributionData.has(n)){const d=this._fetchedAttributionData.get(n);return void(d?Ve(ee,n,this._getDynamicAttribution(d,t,o)):qi(o)&&Ve(ee,n,o.copyright))}return void this._fetchAttributionData(n)}const s="portalItem"in o?(l=o.portalItem)==null?void 0:l.accessInformation:void 0;Ve(ee,n,s||o.copyright)});const i=e.find(n=>{var o;return((o=n.layer)==null?void 0:o.type)==="integrated-mesh-3dtiles"});if(this.view&&i){const n=ur(this.view);if(n){const o=n.getAttributionText();for(let s=0;s<o.length;++s)Ve(ee,i,o[s])}}cr(this.items,ee)&&(this.items.removeAll(),this.items.addMany(ee)),ee.length=0,this.notifyChange("state")}async _fetchAttributionData(t){if(this._pendingAttributions.has(t))return;this._pendingAttributions.add(t);const e=await Yn(t.layer.fetchAttributionData());if(this._pendingAttributions.has(t)){const i=e.ok?this._createContributionIndex(e.value,pr(t.layer)):null;this._pendingAttributions.delete(t),this._fetchedAttributionData.set(t,i)}this._updateAttributionItems()}_createContributionIndex(t,e){const i=t.contributors,n={};if(!i)return n;for(let o=0;o<i.length;o++){const s=i[o],a=s.coverageAreas;if(!a)return;for(const l of a){const d=l.bbox,u=l.zoomMin-(e&&l.zoomMin?1:0),c=l.zoomMax-(e&&l.zoomMax?1:0),g=new sn({xmin:d[1],ymin:d[0],xmax:d[3],ymax:d[2],spatialReference:Nt.WGS84}),p={extent:Mo(g),attribution:s.attribution||"",score:l.score!=null?l.score:100,id:o};for(let f=u;f<=c;f++)n[f]??(n[f]=[]),n[f].push(p)}}return n.maxKey=Math.max.apply(null,Object.keys(n)),n}_getDynamicAttribution(t,e,i){var u;const{extent:n,scale:o}=e;let s=((u=i.tileInfo)==null?void 0:u.scaleToZoom(o))??0;if(s=Math.min(t.maxKey??0,Math.round(s)),!n||s==null||s<=-1)return"";const a=t[s],l=xo(n.center.clone().normalize(),Nt.WebMercator),d=new Set;return a?a.filter(c=>{const g=c.id,p=!d.has(g)&&l&&c.extent&&vo(c.extent,l);return p&&d.add(g),p}).sort((c,g)=>g.score-c.score||c.objectId-g.objectId).map(c=>c.attribution).join(", "):""}};r([h({readOnly:!0,type:x})],Ee.prototype,"items",void 0),r([h({readOnly:!0})],Ee.prototype,"state",null),r([h()],Ee.prototype,"view",void 0),Ee=r([y("esri.widgets.Attribution.AttributionViewModel")],Ee);const En=Ee,ke="esri-attribution",Pe={base:ke,poweredBy:`${ke}__powered-by`,sources:`${ke}__sources`,open:`${ke}--open`,sourcesOpen:`${ke}__sources--open`,link:`${ke}__link`};let k=class extends pt{constructor(e,i){super(e,i),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this._resizeObserver=new ResizeObserver(n=>n.forEach(({target:o})=>this._checkSourceTextOverflow(o))),this.itemDelimiter=" | ",this.messages=null,this.viewModel=new En}initialize(){this.addHandles(ct(()=>{var e;return(e=this.viewModel)==null?void 0:e.items},"change",()=>this.scheduleRender()))}destroy(){var e;(e=this._resizeObserver)==null||e.disconnect()}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}get attributionText(){return this.viewModel.items.reduce((e,i)=>(e.includes(i.text)||e.push(i.text),e),[]).join(this.itemDelimiter)}get icon(){return"description"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e={[Pe.open]:this._isOpen};return E("div",{bind:this,class:this.classes(Pe.base,J.widget,e),dir:"ltr",onclick:this._toggleState,onkeydown:this._toggleState},this._renderSourcesNode(),this._renderPoweredBy())}_renderPoweredBy(){return E("div",{class:Pe.poweredBy},"Powered by"," ",E("a",{class:Pe.link,href:"https://www.esri.com/",rel:"noreferrer",target:"_blank"},"Esri"))}_renderSourcesNode(){const e=this._isOpen,i=this._isInteractive,n=i?0:void 0,{attributionText:o}=this,s={[Pe.sourcesOpen]:e,[J.interactive]:i};return E("div",{afterCreate:this._afterSourcesNodeCreate,bind:this,class:this.classes(Pe.sources,s),innerHTML:o,tabIndex:n})}_afterSourcesNodeCreate(e){this._prevSourceNodeHeight=e.clientWidth,this._resizeObserver.observe(e)}_checkSourceTextOverflow(e){let i=!1;const{clientHeight:n,clientWidth:o,scrollWidth:s}=e,a=s>o,l=this._attributionTextOverflowed!==a;if(this._attributionTextOverflowed=a,l&&(i=!0),this._isOpen){const d=n<this._prevSourceNodeHeight;this._prevSourceNodeHeight=n,d&&(this._isOpen=!1,i=!0)}i&&this.scheduleRender()}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen)}};r([h()],k.prototype,"_isOpen",void 0),r([h()],k.prototype,"_isInteractive",null),r([h()],k.prototype,"_attributionTextOverflowed",void 0),r([h()],k.prototype,"_prevSourceNodeHeight",void 0),r([h({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],k.prototype,"attributionText",null),r([h()],k.prototype,"icon",null),r([h()],k.prototype,"itemDelimiter",void 0),r([h()],k.prototype,"label",null),r([h(),mt("esri/widgets/Attribution/t9n/Attribution")],k.prototype,"messages",void 0),r([h()],k.prototype,"view",null),r([h({type:En})],k.prototype,"viewModel",void 0),r([Xo()],k.prototype,"_toggleState",null),k=r([y("esri.widgets.Attribution")],k);const mr=k,ji="esri-compass",Bi={base:ji,iconContainer:`${ji}__icon-container`};let ie=class extends pt{constructor(e,i){super(e,i),this.messages=null,this.viewModel=new rn,this._reset=()=>{this.viewModel.reset()},this._toRotationTransform=n=>({transform:`rotateZ(${n.z}deg)`})}loadDependencies(){return Xt({button:()=>Z(()=>import("./index-jjUP6Yam.js"),__vite__mapDeps([217,218,45,2,38,26,6,7,8,9,3,1,4,46,219,220,221,222,223,224,225,226,227,228,229,230,231]),import.meta.url),icon:()=>Z(()=>import("./index-DwIhxbHs.js").then(e=>e.i),__vite__mapDeps([221,45,2,38,26,6,7,8,9,3,1,4,46,222,219,223]),import.meta.url)})}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get icon(){return this.viewModel.state==="rotation"?"arrow-up":"compass-needle"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}reset(){return this.viewModel.reset()}render(){const{orientation:e,state:i}=this.viewModel,{messages:n}=this;return E("div",{class:this.classes(Bi.base,J.widget)},E("calcite-button",{class:J.widgetButton,disabled:i==="disabled",kind:"neutral",label:n.reset,onclick:this._reset,round:!0,scale:"s",title:n.reset},E("div",{"aria-hidden":"true",class:Bi.iconContainer,title:n.reset},E("calcite-icon",{icon:this.icon,styles:this._toRotationTransform(e)}))))}};r([h()],ie.prototype,"goToOverride",null),r([h()],ie.prototype,"icon",null),r([h()],ie.prototype,"label",null),r([h(),mt("esri/widgets/Compass/t9n/Compass")],ie.prototype,"messages",void 0),r([h()],ie.prototype,"view",null),r([h({type:rn})],ie.prototype,"viewModel",void 0),ie=r([y("esri.widgets.Compass")],ie);const gr=ie,Ui="esri-navigation-toggle",Gi={base:Ui,isLayoutHorizontal:`${Ui}--horizontal`};let Ie=class extends M{constructor(t){super(t),this._navigationMode="pan",this.view=null}initialize(){this.addHandles(ot(()=>{var t,e;return(e=(t=this.view)==null?void 0:t.navigation)==null?void 0:e.actionMap},()=>this._updateNavigationActionMap()))}destroy(){this.view=null}get state(){var t,e;return(t=this.view)!=null&&t.ready&&((e=this.view)==null?void 0:e.type)==="3d"?"ready":"disabled"}get navigationMode(){return this._navigationMode}set navigationMode(t){this._navigationMode=t,this._updateNavigationActionMap()}toggle(){this.state!=="disabled"&&(this.navigationMode=this.navigationMode!=="pan"?"pan":"rotate")}_updateNavigationActionMap(){var i,n;const t=(n=(i=this.view)==null?void 0:i.navigation)==null?void 0:n.actionMap;if(!t)return;const e=this._navigationMode==="pan";t.dragPrimary=e?"pan":"rotate",t.dragSecondary=e?"rotate":"pan"}};r([h({readOnly:!0})],Ie.prototype,"state",null),r([h()],Ie.prototype,"_navigationMode",void 0),r([h()],Ie.prototype,"view",void 0),Ie=r([y("esri.widgets.NavigationToggle.NavigationToggleViewModel")],Ie);const In=Ie;let ne=class extends pt{constructor(e,i){super(e,i),this.messages=null,this.viewModel=new In,this.toggle=()=>this.viewModel.toggle(),this._panButton=null,this._rotateButton=null,this._toggle=()=>{var o;const n=((o=this.viewModel)==null?void 0:o.navigationMode)==="pan"?this._rotateButton:this._panButton;Xn(n),this.toggle()}}loadDependencies(){return Xt({button:()=>Z(()=>import("./index-jjUP6Yam.js"),__vite__mapDeps([217,218,45,2,38,26,6,7,8,9,3,1,4,46,219,220,221,222,223,224,225,226,227,228,229,230,231]),import.meta.url)})}get icon(){return"move"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){var o,s;const e=((o=this.viewModel)==null?void 0:o.state)==="disabled",i=((s=this.viewModel)==null?void 0:s.navigationMode)==="pan",n=this.messages.toggle;return E("div",{class:this.classes(Gi.base,J.widget,{[Gi.isLayoutHorizontal]:this.layout==="horizontal"})},E("calcite-button",{afterCreate:a=>{this._panButton=a},appearance:i?"outline-fill":"solid",class:J.widgetButton,disabled:e,iconStart:"move",kind:"neutral",label:n,onclick:this._toggle,tabIndex:i?void 0:-1,title:n}),E("calcite-button",{afterCreate:a=>{this._rotateButton=a},appearance:i?"solid":"outline-fill",class:J.widgetButton,disabled:e,iconStart:"rotate",kind:"neutral",label:n,onclick:this._toggle,tabIndex:i?-1:void 0,title:n}))}};r([h()],ne.prototype,"icon",null),r([h()],ne.prototype,"label",null),r([h({value:"vertical"})],ne.prototype,"layout",null),r([h(),mt("esri/widgets/NavigationToggle/t9n/NavigationToggle")],ne.prototype,"messages",void 0),r([h()],ne.prototype,"view",null),r([h({type:In})],ne.prototype,"viewModel",void 0),ne=r([y("esri.widgets.NavigationToggle")],ne);const fr=ne,Ki={base:"esri-zoom",horizontalLayout:"esri-zoom--horizontal"};let oe=class extends pt{constructor(t,e){super(t,e),this.messages=null,this.viewModel=new ln,this.zoomIn=()=>this.viewModel.zoomIn(),this.zoomOut=()=>this.viewModel.zoomOut()}loadDependencies(){return Xt({button:()=>Z(()=>import("./index-jjUP6Yam.js"),__vite__mapDeps([217,218,45,2,38,26,6,7,8,9,3,1,4,46,219,220,221,222,223,224,225,226,227,228,229,230,231]),import.meta.url)})}get icon(){return"magnifying-glass-plus"}set icon(t){this._overrideIfSome("icon",t)}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}set layout(t){t!=="horizontal"&&(t="vertical"),this._set("layout",t)}set view(t){this.viewModel.view=t}get view(){return this.viewModel.view}render(){const t={[Ki.horizontalLayout]:this.layout==="horizontal"},{canZoomIn:e,canZoomOut:i}=this.viewModel,{zoomIn:n,zoomOut:o}=this.messages;return E("div",{class:this.classes(Ki.base,J.widget,t)},E("calcite-button",{class:J.widgetButton,disabled:!e,iconStart:"plus",kind:"neutral",label:n,onclick:this.zoomIn,title:n}),E("calcite-button",{class:J.widgetButton,disabled:!i,iconStart:"minus",kind:"neutral",label:o,onclick:this.zoomOut,title:o}))}};r([h()],oe.prototype,"icon",null),r([h()],oe.prototype,"label",null),r([h({value:"vertical"})],oe.prototype,"layout",null),r([h(),mt("esri/widgets/Zoom/t9n/Zoom")],oe.prototype,"messages",void 0),r([h()],oe.prototype,"view",null),r([h({type:ln})],oe.prototype,"viewModel",void 0),oe=r([y("esri.widgets.Zoom")],oe);const yr=oe;function _r(t){return(t==null?void 0:t.view)!==void 0}let nt=class extends dr{constructor(t){super(t),this._defaultPositionLookup={attribution:"manual",compass:"top-left","navigation-toggle":"top-left",zoom:"top-left"},this.components=[],this._updateViewAwareWidgets=e=>{this.components.forEach(i=>{const n=this._find(i),o=n==null?void 0:n.widget;_r(o)&&(o.view=e)})},this._componentsWatcher=(e,i)=>{this._removeComponents(i),this._addComponents(e),this._adjustPadding(e)}}initialize(){this.addHandles([b(()=>this.components,this._componentsWatcher,K),b(()=>this.view,this._updateViewAwareWidgets,K)])}_add(t,e,i,n,o){let s=t;if(typeof t=="string"&&this._defaultPositionLookup[t]){if(this._find(t))return;s=this._createComponent(t)}super._add(s,e,i,n,o)}_removeComponents(t){t.forEach(e=>{const i=this._find(e);i&&(this.remove(i),i.destroy())})}_adjustPadding(t){if(!t.includes("attribution")&&!this._isOverridden("padding")){const{top:e}=this.padding;this.padding=e}}_addComponents(t){this.constructed&&t.forEach(e=>this.add(this._createComponent(e),this._defaultPositionLookup[e]))}_createComponent(t){const e=this._createWidget(t);return new et({id:t,node:e})}_createWidget(t){const e=this.view;switch(t){case"attribution":return new mr({view:e});case"compass":return new gr({view:e});case"navigation-toggle":return new fr({view:e});case"zoom":return new yr({view:e})}}};r([h()],nt.prototype,"components",void 0),nt=r([y("esri.views.ui.DefaultUI")],nt);const Lh=nt;export{Mh as A,ja as B,Ua as C,qa as D,rt as E,Ga as F,Lh as G,gh as H,Ml as I,$l as J,Tl as K,is as L,jl as M,pn as N,un as O,$h as P,Xs as Q,li as R,Kl as S,et as T,th as U,Ka as V,lt as W,Th as X,Vs as a,Ul as b,Fs as c,Yl as d,Ds as e,Gl as f,Xl as g,ih as h,eh as i,nh as j,O as k,ze as l,Gt as m,Ph as n,Bs as o,hh as p,uh as q,ur as r,Ch as s,As as t,Re as u,ph as v,rh as w,sh as x,Jl as y,yh as z};
