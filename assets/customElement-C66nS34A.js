import{L as D,u as $,c as x,n as M,i as f,a as T}from"./index-4eY77cms.js";import{r as a,m as r,a as _,$ as F}from"./Accessor-BmwT4B0c.js";import{h as p}from"./Color-VJEMvW-n.js";import{d as m}from"./reactiveUtils-XM7cS2OP.js";import{g as L}from"./Histogram-D-YmhBZ0.js";import{l as E,A as S}from"./Slider-BHSjZzBC.js";import{O as R,n as b,e as H}from"./jsxFactory-Cnml7uXM.js";import{r as W,s as q,a as A}from"./utils-iv7wZgpv.js";import{e as y}from"./globalCss-vQlnDsEX.js";import{P as N}from"./useWidget-BajufX8l.js";import"./colorUtils-Rxh2V3ai.js";import"./mathUtils-Cfq9PL9W.js";import"./Evented-Dw4_VOGn.js";import"./SimpleObservable-CvOkykwM.js";import"./intl-Duiy0OzY.js";import"./Promise-DfET-uns.js";import"./cast-CsZslgGN.js";import"./JSONSupport-DcrLLGjL.js";import"./substitute-CvdjmBYq.js";import"./uuid-Cl5lrJ4c.js";import"./utils-B1XxMXhZ.js";import"./opacityUtils-Dim20wpZ.js";import"./Point-Cz2JYYmX.js";import"./writer-DKgfqj4X.js";import"./ColorStop-BYiAUa8d.js";import"./mat4f32-DcsiF_Rp.js";import"./mat4-Fi6iAz29.js";import"./vec3f64-BLpZdpfb.js";import"./common-DQOJ18NT.js";import"./utils-aIx1khaq.js";import"./screenUtils-_ZIvrt5o.js";import"./jsonUtils-DZz5FrgB.js";import"./utils-DYurMneM.js";import"./cimSymbolUtils-DzhKvmq_.js";import"./utils-UPZJIDfz.js";import"./defaultCIMValues-Bb-CUowV.js";import"./enums-BTM-fOHQ.js";import"./LRUCache-CXiGQWMN.js";import"./MemCache-CmojB_Z1.js";import"./Graphic-Dt0LgVGU.js";import"./Clonable-Z-AWS-16.js";import"./enumeration-DpvDkLNI.js";import"./ActionToggle-D7439N1A.js";import"./Identifiable-BHVfzH03.js";import"./jsonUtils-CwFG8yN4.js";import"./Extent-g5W9hy0j.js";import"./Polyline-s-JzsQqo.js";import"./typeUtils-B6WBEKDM.js";import"./TextSymbol-BLIQ6RKX.js";import"./collectionUtils-CTT-51g7.js";import"./Portal-CmmHxpLg.js";import"./aaBoundingBox-Dw3yBk2f.js";import"./timeUtils-C1c_L2Fd.js";import"./utils-v4CMtYiY.js";import"./timeZoneUtils-DxzjpEBb.js";import"./HeatmapColorStop-CHbSyb1s.js";import"./SizeVariable-B-ghFm6e.js";import"./visualVariableUtils-Xcorldoo.js";import"./lengthUtils-_77UiyVF.js";import"./index-C5b9dHRB.js";import"./component-utils-D0ciaaZ_.js";let u=class extends E{constructor(t){super(t),this.average=null,this.bins=null,this.hasTimeData=!1,this.labelFormatFunction=s=>{if(this.hasTimeData)return W(s);const{max:d,min:e,precision:h}=this,l=d-e>10?2:h;return q(parseFloat(s.toFixed(l)))},this.rangeType="equal",this.standardDeviation=null}generateWhereClause(t){const{rangeType:s,state:d,values:e}=this;if(d!=="ready"||!(e!=null&&e.length)||t==null)return null;const h=e[0],l=e.length>1?e[e.length-1]:null;switch(s){case"equal":return`${t} = ${h}`;case"not-equal":return`${t} <> ${h}`;case"less-than":return`${t} < ${h}`;case"greater-than":return`${t} > ${h}`;case"at-least":return`${t} >= ${h}`;case"at-most":return`${t} <= ${h}`;case"between":return`${t} BETWEEN ${h} AND ${l}`;case"not-between":return`${t} NOT BETWEEN ${h} AND ${l}`;default:return null}}};a([r()],u.prototype,"average",void 0),a([r()],u.prototype,"bins",void 0),a([r()],u.prototype,"hasTimeData",void 0),a([r()],u.prototype,"labelFormatFunction",void 0),a([r()],u.prototype,"rangeType",void 0),a([r()],u.prototype,"standardDeviation",void 0),u=a([_("esri.widgets.HistogramRangeSlider.HistogramRangeSliderViewModel")],u);const B=u,c="esri-histogram-range-slider",v={base:c,sliderContainer:`${c}__slider-container`,histogramContainer:`${c}__histogram-container`,rangeTypePrefix:`${c}__range-type--`};let n=class extends R{constructor(t,s){super(t,s),this._barElements=[],this._histogram=null,this._slider=null,this.barCreatedFunction=null,this.dataLines=null,this.dataLineCreatedFunction=null,this.excludedBarColor=new p("#d7e5f0"),this.includedBarColor=new p("#599dd4"),this.messages=null,this.standardDeviationCount=1,this.viewModel=new B}initialize(){const{average:t,bins:s,hasTimeData:d,max:e,min:h,viewModel:l}=this;this._updateBarFill=this._updateBarFill.bind(this),this._histogram=new L({average:t,bins:s,barCreatedFunction:(i,o)=>{i===0&&(this._barElements=[]),this._barElements.push(o),this._updateBarFill(i,o),this.barCreatedFunction&&this.barCreatedFunction(i,o)},dataLines:this._getDataLines(),dataLineCreatedFunction:(i,o)=>{this.dataLineCreatedFunction&&this.dataLineCreatedFunction(i,o)},labelFormatFunction:this.labelFormatFunction,layout:"horizontal",max:e,min:h}),this._slider=new S({labelFormatFunction:this.labelFormatFunction,layout:"horizontal",visibleElements:{labels:!0,rangeLabels:!0},rangeLabelInputsEnabled:!d,viewModel:l}),this.addHandles([this._slider.on("max-change",i=>this.emit("max-change",i)),this._slider.on("min-change",i=>this.emit("min-change",i)),this._slider.on("segment-drag",i=>{this._updateBarFills(),this.emit("segment-drag",i)}),this._slider.on("thumb-change",i=>{this._updateBarFills(),this.emit("thumb-change",i)}),this._slider.on("thumb-drag",i=>{this._updateBarFills(),this.emit("thumb-drag",i)}),m(()=>this.bins,i=>{if(i&&this._histogram.bins){const o=this._histogram.bins.length-i.length;this._barElements.splice(-o,o)}else this._barElements=[];this._histogram.set({bins:i}),this._updateBarFills(),this.scheduleRender()}),m(()=>[this.max,this.min,this.rangeType,this.values],([i,o])=>{this._histogram.set({max:i,min:o}),this._updateBarFills(),this.scheduleRender()}),m(()=>[this.average,this.dataLines,this.standardDeviation,this.standardDeviationCount],([i])=>{this._histogram.set({average:i,dataLines:this._getDataLines()})}),m(()=>this.labelFormatFunction,i=>{this._histogram.set({labelFormatFunction:i})}),m(()=>this.hasTimeData,i=>{this._slider.set({rangeLabelInputsEnabled:!i})})])}get average(){return this.viewModel.average}set average(t){this.viewModel.average=t}get bins(){return this.viewModel.bins}set bins(t){this.viewModel.bins=t}get hasTimeData(){return this.viewModel.hasTimeData}set hasTimeData(t){this.viewModel.hasTimeData=t}get icon(){return"arrow-double-horizontal"}set icon(t){this._overrideIfSome("icon",t)}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}get labelFormatFunction(){return this.viewModel.labelFormatFunction}set labelFormatFunction(t){this.viewModel.labelFormatFunction=t}get max(){return this.viewModel.max}set max(t){this.viewModel.max=t}get min(){return this.viewModel.min}set min(t){this.viewModel.min=t}get precision(){return this.viewModel.precision}set precision(t){this.viewModel.precision=t}get rangeType(){return this.viewModel.rangeType}set rangeType(t){this.viewModel.rangeType=t}get standardDeviation(){return this.viewModel.standardDeviation}set standardDeviation(t){this.viewModel.standardDeviation=t}get values(){return this.viewModel.values}set values(t){this.viewModel.values=t}generateWhereClause(t){return this.viewModel.generateWhereClause(t)}render(){const{rangeType:t,viewModel:s,label:d}=this,e=this.classes(v.base,y.widget,`${v.rangeTypePrefix}${t}`,s.state==="disabled"?y.disabled:null);return b("div",{"aria-label":d,class:e},s.state==="disabled"?null:this._renderContent())}_renderContent(){return[this._renderHistogram(),this._renderSlider()]}_renderSlider(){return b("div",{class:v.sliderContainer,key:`${this.id}-slider-container`},this._slider.render())}_renderHistogram(){return b("div",{class:v.histogramContainer},this._histogram.render())}_getDataLines(){return[...this._getStandardDeviationDataLines(),...this.dataLines||[]]}_getStandardDeviationDataLines(){const{average:t,standardDeviation:s,standardDeviationCount:d}=this;return A(s,t,d).map(e=>({value:e}))}_updateBarFills(){this._barElements.forEach((t,s)=>this._updateBarFill(s,t))}_updateBarFill(t,s){var d;s.setAttribute("fill",((d=this._getFillForBar(t))==null?void 0:d.toHex())??"")}_getFillForBar(t){const{bins:s,rangeType:d,values:e}=this;if(t===-1||!(s!=null&&s.length)||!d||!(e!=null&&e.length))return null;const h=s[t];if(!h)return null;const{maxValue:l,minValue:i}=h,o=l-i,C=e[0]>i&&e[0]<l;switch(d){case"equal":case"not-equal":return this.includedBarColor;case"less-than":case"at-most":return C?this._getBlendedColor((e[0]-i)/o):l<=e[0]?this.includedBarColor:this.excludedBarColor;case"greater-than":case"at-least":return C?this._getBlendedColor(1-(e[0]-i)/o):i>=e[0]?this.includedBarColor:this.excludedBarColor;case"between":if(e.length===2)return e[0]>i&&e[0]<l?this._getBlendedColor(1-(e[0]-i)/o):e[1]>i&&e[1]<l?this._getBlendedColor((e[1]-i)/o):i>=e[0]&&l<=e[1]?this.includedBarColor:this.excludedBarColor;break;case"not-between":if(e.length===2)return e[0]>i&&e[0]<l?this._getBlendedColor((e[0]-i)/o):e[1]>i&&e[1]<l?this._getBlendedColor(1-(e[1]-i)/o):i>e[0]&&l<e[1]?this.excludedBarColor:this.includedBarColor}return this.includedBarColor}_getBlendedColor(t){return p.blendColors(this.excludedBarColor,this.includedBarColor,t)}};a([r()],n.prototype,"average",null),a([r()],n.prototype,"barCreatedFunction",void 0),a([r()],n.prototype,"bins",null),a([r()],n.prototype,"dataLines",void 0),a([r()],n.prototype,"dataLineCreatedFunction",void 0),a([r({type:p,json:{type:[F],write:!0}})],n.prototype,"excludedBarColor",void 0),a([r()],n.prototype,"hasTimeData",null),a([r({type:p,json:{type:[F],write:!0}})],n.prototype,"includedBarColor",void 0),a([r()],n.prototype,"icon",null),a([r()],n.prototype,"label",null),a([r()],n.prototype,"labelFormatFunction",null),a([r()],n.prototype,"max",null),a([r(),H("esri/widgets/HistogramRangeSlider/t9n/HistogramRangeSlider")],n.prototype,"messages",void 0),a([r()],n.prototype,"min",null),a([r()],n.prototype,"precision",null),a([r()],n.prototype,"rangeType",null),a([r()],n.prototype,"standardDeviation",null),a([r()],n.prototype,"standardDeviationCount",void 0),a([r()],n.prototype,"values",null),a([r({type:B})],n.prototype,"viewModel",void 0),n=a([_("esri.widgets.HistogramRangeSlider")],n);const P=n;/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.32/esri/copyright.txt for details.
v4.32.12 */const z=f`@layer{arcgis-histogram-range-slider{display:block}}`,I=N(P),g=class g extends D{constructor(){super(...arguments),this.widget=I(this),this.viewModel=this.widget.viewModel,this.autoDestroyDisabled=!1,this.average=this.widget.average,this.barCreatedFunction=this.widget.barCreatedFunction,this.bins=this.widget.bins,this.dataLineCreatedFunction=this.widget.dataLineCreatedFunction,this.dataLines=this.widget.dataLines,this.excludedBarColor=this.widget.excludedBarColor,this.icon=this.widget.icon,this.includedBarColor=this.widget.includedBarColor,this.label=this.widget.label,this.labelFormatFunction=this.widget.labelFormatFunction,this.max=this.widget.max,this.min=this.widget.min,this.position="bottom-left",this.precision=this.widget.precision,this.rangeType=this.widget.rangeType,this.standardDeviation=this.widget.standardDeviation,this.standardDeviationCount=this.widget.standardDeviationCount,this.state=this.viewModel.state,this.values=this.widget.values,this.arcgisPropertyChange=$()("state"),this.arcgisReady=x()}async destroy(){await this.manager.destroy()}async generateWhereClause(s){return this.widget.generateWhereClause(s)}};g.properties={autoDestroyDisabled:5,average:9,barCreatedFunction:0,bins:0,dataLineCreatedFunction:0,dataLines:0,excludedBarColor:0,icon:1,includedBarColor:0,label:1,labelFormatFunction:0,max:9,min:9,position:1,precision:9,rangeType:1,referenceElement:1,standardDeviation:9,standardDeviationCount:9,state:3,values:0},g.shadowRootOptions=M,g.styles=z;let w=g;T("arcgis-histogram-range-slider",w);export{w as ArcgisHistogramRangeSlider};
