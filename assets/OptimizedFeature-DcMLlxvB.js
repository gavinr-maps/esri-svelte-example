import{e as S}from"./memoryEstimations-5gFNwkKK.js";import{e as Y}from"./OptimizedGeometry-7IxBWtHr.js";function p(e,t){return e?t?4:3:t?3:2}function _(e,t,o,s){if(!(t!=null&&t.lengths.length))return null;e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0);const r=e.coords,n=[],c=o?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:l,coords:I}=t,g=p(o,s);let f=0;for(const i of l){const u=w(c,I,f,i,o,s);u&&n.push(u),f+=i*g}if(n.sort((i,u)=>{let m=i[2]-u[2];return m===0&&o&&(m=i[4]-u[4]),m}),n.length){let i=6*n[0][2];r[0]=n[0][0]/i,r[1]=n[0][1]/i,o&&(i=6*n[0][4],r[2]=i!==0?n[0][3]/i:0),(r[0]<c[0]||r[0]>c[1]||r[1]<c[2]||r[1]>c[3]||o&&(r[2]<c[4]||r[2]>c[5]))&&(r.length=0)}if(!r.length){const i=t.lengths[0]?A(I,0,l[0],o,s):null;if(!i)return null;r[0]=i[0],r[1]=i[1],o&&i.length>2&&(r[2]=i[2])}return e}function w(e,t,o,s,r,n){const c=p(r,n);let l=o,I=o+c,g=0,f=0,i=0,u=0,m=0;for(let E=0,F=s-1;E<F;E++,l+=c,I+=c){const h=t[l],N=t[l+1],T=t[l+2],d=t[I],b=t[I+1],O=t[I+2];let y=h*b-d*N;u+=y,g+=(h+d)*y,f+=(N+b)*y,r&&(y=h*O-d*T,i+=(T+O)*y,m+=y),h<e[0]&&(e[0]=h),h>e[1]&&(e[1]=h),N<e[2]&&(e[2]=N),N>e[3]&&(e[3]=N),r&&(T<e[4]&&(e[4]=T),T>e[5]&&(e[5]=T))}if(u>0&&(u*=-1),m>0&&(m*=-1),!u)return null;const a=[g,f,.5*u];return r&&(a[3]=i,a[4]=.5*m),a}function A(e,t,o,s,r){const n=p(s,r);let c=t,l=t+n,I=0,g=0,f=0,i=0;for(let u=0,m=o-1;u<m;u++,c+=n,l+=n){const a=e[c],E=e[c+1],F=e[c+2],h=e[l],N=e[l+1],T=e[l+2],d=s?M(a,E,F,h,N,T):G(a,E,h,N);if(d)if(I+=d,s){const b=j(a,E,F,h,N,T);g+=d*b[0],f+=d*b[1],i+=d*b[2]}else{const b=P(a,E,h,N);g+=d*b[0],f+=d*b[1]}}return I>0?s?[g/I,f/I,i/I]:[g/I,f/I]:o>0?s?[e[t],e[t+1],e[t+2]]:[e[t],e[t+1]]:null}function G(e,t,o,s){const r=o-e,n=s-t;return Math.sqrt(r*r+n*n)}function M(e,t,o,s,r,n){const c=s-e,l=r-t,I=n-o;return Math.sqrt(c*c+l*l+I*I)}function P(e,t,o,s){return[e+.5*(o-e),t+.5*(s-t)]}function j(e,t,o,s,r,n){return[e+.5*(s-e),t+.5*(r-t),o+.5*(n-o)]}class V{constructor(t=null,o={},s,r,n=0){this.geometry=t,this.attributes=o,this.centroid=s,this.objectId=r,this.displayId=n}static fromJSON(t){const o=t.geometry?Y.fromJSON(t.geometry):null,s=t.centroid?Y.fromJSON(t.centroid):null,r=t.objectId;return new V(o,t.attributes,s,r)}weakClone(){const t=new V(this.geometry,this.attributes,this.centroid,this.objectId);return t.displayId=this.displayId,t}clone(){var s,r;const t=(s=this.geometry)==null?void 0:s.clone(),o=new V(t,{...this.attributes},(r=this.centroid)==null?void 0:r.clone(),this.objectId);return o.displayId=this.displayId,o}ensureCentroid(t){return this.centroid??(this.centroid=_(new Y,this.geometry,t.hasZ,t.hasM)),this.centroid}get usedMemory(){var t;return 128+S(this.attributes)+(((t=this.geometry)==null?void 0:t.usedMemory)??0)}}function q(e){var t,o;return!!((o=(t=e.geometry)==null?void 0:t.coords)!=null&&o.length)}export{_ as n,q as o,V as s};
