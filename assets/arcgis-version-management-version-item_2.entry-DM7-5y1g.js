import{r as I,c as p,h as e,g as b}from"./index-BVncS3aY.js";/*!
 * All material copyright Esri, All Rights Reserved, unless otherwise specified.
 * See https://js.arcgis.com/4.30/esri/copyright.txt for details.
 * v4.30.7
 */const L=class{constructor(i){I(this,i),this.arcgisManageVersion=p(this,"arcgisManageVersion",7),this.versionItemElementProps=void 0}render(){const{versionItemElementProps:{currentUser:i,currentVersionIdentifier:n,hasAdvEditingUte:s,isVersioningApiAvailable:a,serviceUrl:c,strings:{actions:l},versionInfo:r}}=this,d=r.versionIdentifier.name,o=d.substring(d.lastIndexOf(".")+1),f=d.substring(0,d.lastIndexOf(".")).toUpperCase(),h=r.versionIdentifier.guid,u=`actionSwitchToVersion_${h}`,g=f.toUpperCase()===i.toUpperCase()&&a&&s,t=n.guid===r.versionIdentifier.guid,m=e("calcite-action",{key:"2f6e3eeea7fc7736a1199a29668894dd80dac94a",disabled:t,id:u,icon:"code-branch",text:"",onClick:()=>{this.arcgisManageVersion.emit({actionType:"changeVersion",serviceUrl:c,versionInfo:r})},slot:"actions-start"}),V=t?void 0:e("calcite-tooltip",{"overlay-positioning":"fixed",referenceElement:u},e("span",null,l.switchToVersion));return e("calcite-list-item",{key:"74b8319a683737aaaf8cfc5f06147eaa401195a6",description:f,label:o,selected:!1,value:h},m,V,e("calcite-action-menu",{key:"535784b416984e07bbfc44a275dfc5c81fb55daf","overlay-positioning":"fixed",slot:"actions-end",label:""},e("calcite-action",{key:"5e89410767d43ab3ce8a6e3ac6ef5d2db5542ea7",disabled:t,icon:"code-branch",onClick:()=>{this.arcgisManageVersion.emit({actionType:"changeVersion",serviceUrl:c,versionInfo:r})},scale:"s",text:l.switchToVersion,textEnabled:!0}),e("calcite-action",{key:"cf3ab694540fb02bcfa7c5ef9557fcb6a93746c1",disabled:!g||t,icon:"code-branch-edit",onClick:()=>{this.arcgisManageVersion.emit({actionType:"editVersion",serviceUrl:c,versionInfo:r})},scale:"s",text:l.editVersion,textEnabled:!0}),e("calcite-action",{key:"bb646b907dbbc62283a15295a265912ba45d73a4",disabled:!g||g&&t,icon:"trash",onClick:()=>{this.arcgisManageVersion.emit({actionType:"deleteVersion",serviceUrl:c,versionInfo:r})},scale:"s",text:l.deleteVersion,textEnabled:!0})))}get el(){return b(this)}},A=class{constructor(i){I(this,i),this.arcgisNewVersion=p(this,"arcgisNewVersion",7),this.arcgisGetVersions=p(this,"arcgisGetVersions",7),this.arcgisManageVersion=p(this,"arcgisManageVersion",7),this._handleFilterChange=()=>{const{versionListElementProps:{versionInfos:n}}=this,s=this._filterInputElement.value.toUpperCase();this._filteredVersionInfos=s===""?n:n.filter(a=>a.versionIdentifier.name.toUpperCase().includes(s)||a.versionIdentifier.guid.toUpperCase().includes(s)),this._filteredVersionInfos.length&&(this.currentPage=1)},this._handleNoticeClosed=()=>{this.versionListElementProps={...this.versionListElementProps,executionError:void 0}},this._handlePaginationChange=n=>{this.currentPage=n.target.startItem},this.currentPage=1,this.versionListElementProps=void 0,this._filteredVersionInfos=void 0}propertiesChangeHandler(i,n){n.versionInfos!==i.versionInfos&&(this._filteredVersionInfos=this.versionListElementProps.versionInfos,this._filterInputElement&&this._handleFilterChange())}componentWillLoad(){this._filteredVersionInfos=this.versionListElementProps.versionInfos}componentDidRender(){var i;(i=this._filterInputElement)==null||i.setFocus()}render(){const{currentPage:i,versionListElementProps:{closable:n,currentUser:s,currentVersionIdentifier:a,executionError:c,hasAdvEditingUte:l,heading:r,isVersioningApiAvailable:d,pageSize:o,serviceName:f,serviceUrl:h,state:u,strings:{headers:g},strings:t,versionInfos:m}}=this,V=e("calcite-block",{heading:g.currentVersion,description:a.name,overlayPositioning:"fixed"}),E=e("calcite-action",{id:"actionRefreshVersions",icon:"refresh",text:"",onClick:()=>{this.arcgisGetVersions.emit({serviceUrl:h})},slot:"header-actions-end"},e("calcite-tooltip",{"overlay-positioning":"fixed",referenceElement:"actionRefreshVersions"},e("span",null,t.actions.refreshVersions)));this._paginatedVersionInfos=this._filteredVersionInfos.length>o?this._paginate(this._filteredVersionInfos,o,i):this._filteredVersionInfos;const _=this._filteredVersionInfos.length>o?e("calcite-pagination",{onCalcitePaginationChange:this._handlePaginationChange,pageSize:1,startItem:i,totalItems:Math.ceil(this._filteredVersionInfos.length/o)}):void 0,C=this._paginate(this._paginatedVersionInfos,o,1).map(v=>e("arcgis-version-management-version-item",{versionItemElementProps:{currentUser:s,currentVersionIdentifier:a,isCurrentVersionCard:!1,hasAdvEditingUte:l,isVersioningApiAvailable:d,serviceUrl:h,strings:t,versionInfo:v}})),x=m.length>o?e("calcite-block",{heading:"",open:!0},e("calcite-input-text",{ref:v=>{this._filterInputElement=v},clearable:!0,icon:"search",onCalciteInputTextInput:this._handleFilterChange,placeholder:t.actions.searchVersions})):void 0,P=e("calcite-list",null,C),k=d&&l?e("calcite-fab",{appearance:"outline-fill",slot:"fab",textEnabled:!0,text:t.actions.newVersion,onClick:()=>{this.arcgisNewVersion.emit({serviceUrl:h})}}):void 0,y=c?e("calcite-notice",{onCalciteNoticeClose:this._handleNoticeClosed,class:"notice",closable:!0,kind:"warning",open:!0,scale:"s",slot:"footer",width:"full"},e("div",{slot:"message"},this._getExecutionError(c))):void 0;return e("calcite-flow-item",{closable:n,description:f,heading:r},e("calcite-panel",{loading:u==="executing"},V,e("calcite-panel",{heading:this._filteredVersionInfos.length?`${t.headers.manageVersions} (${this._filteredVersionInfos.length})`:t.headers.manageVersions},E,x,P,k),_,y))}_getExecutionError(i){const{versionListElementProps:{strings:{executionErrors:n}}}=this;switch(i){case"no-advanced-editing-user-type-extension":return n.noAdvancedEditingUserTypeExtension;case"no-feature-service-found":return n.noFeatureServiceFound;case"no-valid-enterprise-version":return n.notValidEnterpriseVersion;case"no-valid-version-name":return n.invalidVersionName;default:return i}}_paginate(i,n,s){return i.slice((s-1)*n,s*n)}get el(){return b(this)}static get watchers(){return{versionListElementProps:["propertiesChangeHandler"]}}};export{L as arcgis_version_management_version_item,A as arcgis_version_management_version_list};
