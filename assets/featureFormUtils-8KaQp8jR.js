import"./intl-CArXn1et.js";import{G as f,O as $,i as b,n as V,l as _}from"./subclass-BR3PhgZG.js";import{n as L}from"./compilerUtils-BA04t1lN.js";import{t as j}from"./formUtils-Dni92j4V.js";import{b as A,T as I,k as E,l as T,n as R,E as U}from"./fieldUtils-C5R42-PY.js";import{Z}from"./utils-HfpQY-3e.js";import{s as x}from"./substitute-CNca968n.js";const D=t=>(t==null?void 0:t.type)==="field",F=t=>(t==null?void 0:t.type)==="group",w=t=>(t==null?void 0:t.type)==="relationship",J=t=>t.type==="text",K=t=>!F(t)&&t.group!=null,N=t=>t.reduce((e,n)=>F(n)?[...e,...n.inputs]:[...e,n],[]),Q=t=>N(t).filter(D),X=t=>N(t).filter(w),tt=t=>t!=null&&(m(t,"combo-box")||m(t,"radio-buttons")),m=(t,e)=>{var n;return t!=null&&((n=t.input)==null?void 0:n.type)===e},et=t=>t!=null&&(m(t,"text-box")||m(t,"text-area")),nt=({domain:t,inputType:e="text-box",dataType:n})=>n==="number"&&e==="text-box"&&(!t||t.type!=="coded-value"),rt=t=>"items"in t;function it(t){const{attributes:e,fieldsIndex:n,label:r,timeZone:i}=t;if(!e||typeof e!="object")return r;const o=Object.keys(e).filter(s=>f(r,s)),u=o.map(s=>e[s]),a=o.map(s=>n.get(s)).filter($);return k(r,C({values:u,fields:a,timeZone:i}))}const d="expression/",G="expr/",S="field/";function ot(t){const[e,n]=t.split(d);return e===""&&n?n:(V.getLogger("esri.widgets.FeatureForm/featureFormUtils").error("extractExpressionNameFromString:invalid-input",`The string ${t} is not a valid expression reference of the form '${d}/expressionName'`),"")}function at(t){return`${d}${t}`}function st(t){return`${S}${t}`}function ut(t){return t.startsWith(d)}function lt(t){return t.startsWith(G)}function C(t){const{fields:e,values:n}=t,r=t.timeZone??void 0,i=e.map((o,u)=>{let a=n[u];if(o.domain&&o.domain.type==="coded-value"){const s=o.domain.codedValues.find(p=>p.code===a);s!=null&&s.name&&(a=s.name)}return(Z(o)||A(o))&&(a=I(o,a,{timeZone:r,...E(o)})),[o.name,a]});return Object.fromEntries(i)}function k(t,e){return b(b(t,n=>`{${n.toLowerCase()}}`),Object.fromEntries(Object.entries(e).map(([n,r])=>[n.toLowerCase(),r])))}const pt=t=>{var n,r,i,o;const e={typeFieldName:null,types:[]};return t&&(t.type==="subtype-sublayer"?(e.typeFieldName=(n=t.parent)==null?void 0:n.subtypeField,e.types=((r=t.parent)==null?void 0:r.subtypes)??[]):t.type==="subtype-group"||t.type==="feature"&&((i=t.subtypes)!=null&&i.length)?(e.typeFieldName=t.subtypeField,e.types=t.subtypes??[]):"types"in t&&t.types&&(e.typeFieldName=t.typeIdField,e.types=t.types.map(({id:u,name:a,domains:s})=>({code:u,name:a,domains:s}))),e.typeFieldName!=null&&(e.typeFieldName=((o=t.getField(e.typeFieldName))==null?void 0:o.name)??e.typeFieldName)),e},mt=(t,e)=>{if(!t)return!0;const{operations:n}=t;switch(e){case"INSERT":return n.supportsAdd;case"UPDATE":case"DELETE":return n.supportsUpdate;default:return!0}};var c;(function(t){t.TOO_SHORT="length-validation-error::too-short",t.TOO_LONG="length-validation-error::too-long"})(c||(c={}));const O={type:"number"},g={type:"number",intlOptions:{notation:"scientific"}};function h(t){return t>=1e7||t<=-1e7}function H(t,{validationErrors:e}){return t.max!=null&&t.min!=null?e.outsideRange:t.max!=null?e.outsideRangeMax:e.outsideRangeMin}const dt=(t,e,n)=>{const{dataType:r,error:i,minLength:o,value:u,required:a}=t,s=e==null?void 0:e.validationErrors;if(!s||!i)return null;if(a&&u===null)return s.cannotBeNull;if(i===T.VALUE_OUT_OF_RANGE||i===R.OUT_OF_RANGE){const{field:p,range:l}=t,y={type:"date",intlOptions:{timeZone:p.type==="date"&&n?n:void 0,...E(p)}},v=H(l,e);return x(v,l,{format:{max:r==="date"?y:l.max!=null&&h(l.max)?g:O,min:r==="date"?y:l.min!=null&&h(l.min)?g:O}})}return i===T.INVALID_CODED_VALUE?s.invalidCodedValue:i===U.INVALID_TYPE?s.invalidType:i===c.TOO_SHORT?x(s.tooShort,{min:o}):(c.TOO_LONG,null)},ct=t=>{var i;if(!t)return;const e=t.layer,n=e&&"geometryType"in e?e.geometryType:void 0,r=(i=t.geometry)==null?void 0:i.type;return r==="polyline"||n==="polyline"?"line":r==="mesh"||n==="mesh"||n==="multipatch"?"cube":r==="multipoint"||n==="multipoint"?"point":r||n||"table"},ft=t=>{var n;const e=[];if(t.formTemplate){const{description:r,title:i}=t.formTemplate;(n=t.fields)==null||n.forEach(o=>{const u=i&&f(i,o.name),a=r&&f(r,o.name);(u||a)&&e.push(o.name)})}return e};function yt(t,e){var r;const n=e??("formTemplate"in t&&t.formTemplate);return n?(((r=n.elements)==null?void 0:r.filter(j))??[]).some(({fieldName:i})=>!t.fieldsIndex.get(i)):!1}function bt(t,e){return t==null||e.onValue!==t&&e.offValue!==t}function Tt(t,e){var n;switch(e.objectType){case"any":return!0;case"null":return t==null;case"code":return t===((n=e.codedValue)==null?void 0:n.code);case"range":return t!=null&&e.minValue!=null&&e.maxValue!=null&&+t>=e.minValue&&+t<=e.maxValue;default:return L(e.objectType),!1}}function xt(t,e,n){var o,u;if(!t||!("subtypes"in t))return!1;const r=(o=t.subtypes)==null?void 0:o.find(a=>a.code===n);if(!r)return!1;const i=(u=t.subtypes)==null?void 0:u.find(a=>a.code===e);return!_(r.defaultValues,i==null?void 0:i.defaultValues)&&Object.values(r.defaultValues).some(a=>a!=null)}export{st as $,ct as B,pt as C,ut as D,nt as E,et as F,mt as G,ot as I,bt as J,Tt as K,c as M,X as N,N as O,xt as Q,at as R,C as S,K as T,it as U,rt as V,ft as Y,F as b,w as g,tt as h,Q as j,dt as q,m as v,lt as w,J as x,D as y,yt as z};
