const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./queryNamedTraceConfigurations-BpPph30S.js","./assets-BNizZMOZ.js","./subclass-BR3PhgZG.js","./index-BVncS3aY.js","./index-CjOb8WjV.css","./Evented-CXIxDjmW.js","./Accessor-D6mNnsWy.js","./utils-Blh5cXWv.js","./Graphic-Bi5hWHps.js","./geometry-CnaxvJsv.js","./Extent-B4rrMrqp.js","./Point-TlcsOcXV.js","./jsonMap-DCC6W5ex.js","./writer-3zufXUNV.js","./Polyline-BQFeqYXi.js","./mathUtils-ClvKsMak.js","./PopupTemplate-D8mXPxzU.js","./Clonable-cKbRam6-.js","./reactiveUtils-BFQ0BtrB.js","./shared-B3wH2qpO.js","./fieldUtils-C5R42-PY.js","./intl-CArXn1et.js","./Promise-CZrWwByK.js","./enumeration--HlxOQ_N.js","./Color-DDUWtbqR.js","./colorUtils-CS9vdHXB.js","./ActionToggle-C0Z1k2jc.js","./Identifiable-BLvpQbOc.js","./symbols-CfvYGR4J.js","./TextSymbol-zZq0BA1M.js","./screenUtils-PfxkaaMN.js","./materialUtils-CQ3JLQ1x.js","./opacityUtils-BT7mQkwC.js","./aaBoundingBox-BGxkJAW0.js","./persistableUrlUtils-Dx61-x4K.js","./collectionUtils-Dm1icNvk.js","./Portal-DCqdz-K4.js","./jsonUtils-DtWlwXHP.js","./FeatureLayer-UOSH_sw8.js","./ClassBreaksRenderer-B2uJHW90.js","./UniqueValueRenderer-Q9ooDuxf.js","./diffUtils--7ofoPN-.js","./colorRamps-BBM5Timv.js","./SizeVariable-Bq7jlw1r.js","./ColorStop-DEfc5Idt.js","./sizeVariableUtils-Cmcuvw-4.js","./visualVariableUtils-CrTsYJ9f.js","./compilerUtils-BA04t1lN.js","./lengthUtils-vgIBtB6M.js","./jsonUtils-aUmUTP_F.js","./layerUtils-BzjQnEdj.js","./defaults-CIM29kXM.js","./defaultsJSON-GKolV7NZ.js","./styleUtils-C7rrjuqd.js","./jsonUtils-DsFdmTaK.js","./LRUCache-ju6LnIBZ.js","./MemCache-C6WUx-5V.js","./Version-_Vxue7Ui.js","./FieldsIndex-DHql50vu.js","./UnknownTimeZone-D0GlcniK.js","./OverrideHelper-0-cH6aQ2.js","./colorUtils-D5nOabzP.js","./vec42-B1mBkh1w.js","./vec4f64-CBQL1T0x.js","./utils-D8D39sLt.js","./quantizationUtils-DFd0XKEL.js","./HeatmapColorStop-7F2_sZ2U.js","./heatmapUtils-C-uT6ZIV.js","./SimpleRenderer-FL1Ywtqd.js","./MultiOriginJSONSupport-CvjUw5hc.js","./layerContainerType-C5CzMsLd.js","./FeatureLayerBase-BE0EfCO4.js","./inputs-BiRi4vRH.js","./Field-poIiHWUc.js","./fieldType-CIG5ey7e.js","./formUtils-Dni92j4V.js","./HeightModelInfo-CzO-kRMK.js","./arcgisLayerUrl-ETqee4Bd.js","./commonProperties-BTyJ6vjt.js","./ElevationInfo-jptbPjRY.js","./unitConversionUtils-BUA_O87q.js","./featureLayerUtils-t2Um2-kg.js","./featureQueryAll-ClGLkoIX.js","./Query-BpMwiNVl.js","./TimeExtent-Dl-qaORu.js","./timeUtils-DQR2jUPL.js","./DataLayerSource-BX7Ap_tY.js","./FullTextSearch-BhJOgh_r.js","./AttachmentQuery-Ccywtvr9.js","./RelationshipQuery-DuLVs9A4.js","./LayerFloorInfo-Bx-Ddgjy.js","./Relationship-Cktwo5cM.js","./serviceCapabilitiesUtils-C8Sa1o3S.js","./Layer-CfUiPX3n.js","./workers-D8NOwm_V.js","./Queue-DpHko4Yk.js","./editsZScale-Bh8FjDvn.js","./queryZScale-DGW6qDy9.js","./projection-tSh-0UvX.js","./projectBuffer-iyGwL2dv.js","./geodesicConstants-kj1AtlGg.js","./FeatureSet-4rZsDUx9.js","./APIKeyMixin-DpJrW91V.js","./ArcGISService-aI6tC6k0.js","./BlendLayer-DmvCcS5c.js","./jsonUtils-C4Wp5KpV.js","./parser-BN6zmHl-.js","./utils-D20M4_S8.js","./mat4f32-DcsiF_Rp.js","./mat4-ybYUU6jq.js","./CustomParametersMixin-BStBpako.js","./EditBusLayer-BXrQoGfQ.js","./uuid-fwrPAdZb.js","./FeatureEffectLayer-DB6VToGX.js","./FeatureEffect-By-hP1x9.js","./FeatureFilter-DqmBE6ye.js","./FeatureReductionLayer-DLpK6ddX.js","./FeatureReductionSelection-BoaPXZg2.js","./labelingInfo-DAjvnaKu.js","./labelUtils-Cczy0uDR.js","./MD5-C9MwAd2G.js","./OperationalLayer-Bq6MAeyc.js","./OrderedLayer-DxmkHdYI.js","./OrderByInfo-D0jsxwzL.js","./PortalLayer-CX96aZTI.js","./PortalItem-CaeKabGc.js","./portalItemUtils-C4O2jNL5.js","./RefreshableLayer-B26jSd3d.js","./ScaleRangeLayer-CKYXLXxK.js","./TemporalLayer-DwHwsJsP.js","./TimeInterval-DtVUy51q.js","./TimeInfo-C84oEL3g.js","./FeatureTemplate-DbIjVC84.js","./FeatureType-o-GvSMTI.js","./fieldProperties-Lf6CXfwL.js","./versionUtils-BzPsp3a1.js","./styleUtils-BATHgMyw.js","./TopFeaturesQuery-CoSK-G18.js","./popupUtils-D3OP9u3f.js","./interfaces-CL2NbQte.js","./QueryNamedTraceConfigurationsParameters-CNGt-iBK.js","./validateNetworkTopology-DSJ_H22S.js","./ValidateNetworkTopologyParameters-CqcPjzz1.js","./queryAssociations-DRmQREcE.js","./Association-Bo1Zj7sz.js","./QueryAssociationsParameters-K08DqprU.js","./synthesizeAssociationGeometries-PxczlRK7.js","./SynthesizeAssociationGeometriesParameters-C3KjVZIq.js","./trace-DC1OA9Cf.js","./TraceParameters-DBTJ4Bod.js"])))=>i.map(i=>d[i]);
import{_ as E}from"./index-BVncS3aY.js";import{e as r}from"./Evented-CXIxDjmW.js";import{d as be}from"./Graphic-Bi5hWHps.js";import{y as i,b as j,c as ue,n as Ee}from"./subclass-BR3PhgZG.js";import Ce from"./FeatureLayer-UOSH_sw8.js";import{r as Te}from"./featureQueryAll-ClGLkoIX.js";import"./geometry-CnaxvJsv.js";import{f as K,U as W,I as _e,u as Oe}from"./assets-BNizZMOZ.js";import{m as Ie}from"./Portal-DCqdz-K4.js";import{S as Ae,m as Re}from"./MultiOriginJSONSupport-CvjUw5hc.js";import{g as Se,b as Ue,S as $e}from"./Accessor-D6mNnsWy.js";import{w as Ve}from"./Extent-B4rrMrqp.js";import{y as Le}from"./jsonUtils-DtWlwXHP.js";import{g as ce,a as le,l as Pe,h as Fe,t as me,i as ye,c as he}from"./EditBusLayer-BXrQoGfQ.js";import{d as we}from"./arcgisLayerUrl-ETqee4Bd.js";import{i as Ne,n as se}from"./jsonMap-DCC6W5ex.js";import{o as ke}from"./enumeration--HlxOQ_N.js";import ge from"./PortalItem-CaeKabGc.js";import{d as Ge}from"./FeatureSet-4rZsDUx9.js";import{f as je}from"./Point-TlcsOcXV.js";import{o as xe}from"./writer-3zufXUNV.js";import{m as Je,u as De,j as Be}from"./Polyline-BQFeqYXi.js";import{b as Me}from"./Query-BpMwiNVl.js";let F=class extends K{constructor(t){super(t),this.moment=null,this.fullUpdate=!1,this.validateErrorsCreated=!1,this.dirtyAreaCount=null,this.exceededTransferLimit=null,this.serviceEdits=null,this.discoveredSubnetworks=null}};r([i({type:Date,json:{type:Number,write:{writer:(e,t)=>{t.moment=e?e.getTime():null}}}})],F.prototype,"moment",void 0),r([i({type:Boolean,json:{write:!0}})],F.prototype,"fullUpdate",void 0),r([i({type:Boolean,json:{write:!0}})],F.prototype,"validateErrorsCreated",void 0),r([i({type:Number,json:{write:!0}})],F.prototype,"dirtyAreaCount",void 0),r([i({type:Boolean,json:{write:!0}})],F.prototype,"exceededTransferLimit",void 0),r([i({type:[Object],json:{write:!0}})],F.prototype,"serviceEdits",void 0),r([i({type:[Object],json:{write:!0}})],F.prototype,"discoveredSubnetworks",void 0),F=r([j("esri.rest.networks.support.ValidateNetworkTopologyResult")],F);const qe=F,ze=Ne()({Pending:"job-waiting",InProgress:"job-executing",Completed:"job-succeeded"});let q=class extends qe{constructor(t){super(t),this.statusUrl=null,this.status=null,this.submissionTime=null,this.lastUpdatedTime=null,this._timer=void 0}destroy(){clearInterval(this._timer)}async checkJobStatus(t){const o={...t,query:{f:"json"}},{data:s}=await W(this.statusUrl,o);return this.read(s),this.editsResolver&&this.editsResolver.resolve({edits:null,addedFeatures:[],updatedFeatures:[],deletedFeatures:[],addedAttachments:[],updatedAttachments:[],deletedAttachments:[],exceededTransferLimit:!0,historicMoment:null}),this}async waitForJobCompletion(t={}){const{interval:o=1e3,statusCallback:s}=t;return new Promise((n,a)=>{this._clearTimer();const l=setInterval(()=>{this._timer||a(Se()),this.checkJobStatus().then(u=>{const{status:p}=u;switch(this.status=p,p){case"job-succeeded":this._clearTimer(),n(this);break;case"job-waiting":case"job-executing":s&&s(this)}},u=>{this._clearTimer(),a(u)})},o);this._timer=l})}_clearTimer(){clearInterval(this._timer),this._timer=void 0}};r([i()],q.prototype,"editsResolver",void 0),r([i({type:String,json:{write:!0}})],q.prototype,"statusUrl",void 0),r([ke(ze)],q.prototype,"status",void 0),r([i({type:Date,json:{type:Number,write:{writer:(e,t)=>{t.submissionTime=e?e.getTime():null}}}})],q.prototype,"submissionTime",void 0),r([i({type:Date,json:{type:Number,write:{writer:(e,t)=>{t.lastUpdatedTime=e?e.getTime():null}}}})],q.prototype,"lastUpdatedTime",void 0),q=r([j("esri.networks.support.TopologyValidationJobInfo")],q);const He=q;function Lt(e,t){const o=[],s=new Map;for(const a of t){const l=e.getLayerIdBySourceId(a.networkSourceId);if(l==null)continue;let u=s.get(l);u===void 0&&(u=[]),u.push(a.objectId),s.set(l,u)}const n=e.featureServiceUrl;return s.forEach((a,l)=>o.push({layerUrl:`${n}/${l}`,objectIds:a})),o}async function Pt(e,t){const o=e.layers,s=e.layerInfos,n=e.returnGeometry||!1,a=e.outSpatialReference;return await Promise.all(o.map(async l=>{await l.load()})),(await Promise.all(o.map(async l=>{var w;const u=s.find(g=>{var m;return g.layerUrl===((m=l.parsedUrl)==null?void 0:m.path)});if(!((w=u==null?void 0:u.objectIds)!=null&&w.length))return{layer:l,featureSet:void 0};const p=l.createQuery();p.returnGeometry=n,p.outFields=u.outFields||["*"],p.outSpatialReference=a,p.gdbVersion=l.gdbVersion,p.objectIds=u.objectIds;const h=Ge.fromJSON(await Te(l,p));return{layer:l,featureSet:h}}))).filter(l=>l.featureSet!==void 0)}async function fe(e,t){if(e==="Utility Network Layer"){const{default:o}=await E(()=>Promise.resolve().then(()=>dt),void 0,import.meta.url);return new o({layerUrl:t})}return null}async function Ke(e){var l;let t="portalItem"in e?e:{portalItem:e};!t.portalItem||t.portalItem instanceof ge||(t={...t,portalItem:new ge(t.portalItem)});const o=t.portalItem;if(await o.load(),o.type!=="Feature Service")throw new ue("portal:unknown-item-type","Unknown item type '${type}'",{type:o.type});const s=o.url,n=await W(s,{responseType:"json",query:{f:"json"}}),a="Network Layer";if((l=n.data.type)!=null&&l.includes(a))return fe(n.data.type,s);if(n.data.layers){const u=n.data.layers.find(p=>p.type.includes(a));if(u){const p=`${s}/${u.id}`;return fe(u.type,p)}}return null}let f=class extends Ae(Ie){static fromPortalItem(e){return Ke(e)}constructor(e){super(e),this.id=null,this.title=null,this.layerUrl=null,this.dataElement=null,this.fullExtent=null,this.spatialReference=null,this.type=null,this.sourceJSON=null,this.gdbVersion=null,this.historicMoment=null,this._applyEditsHandler=t=>{const{serviceUrl:o,gdbVersion:s,result:n}=t,a=o===this.featureServiceUrl,l=ce(o,s,this.gdbVersion);a&&l&&n.then(u=>{le(o,s)&&(this.historicMoment=u.historicMoment)})},this._updateMomentHandler=t=>{const{serviceUrl:o,gdbVersion:s,moment:n}=t,a=o===this.featureServiceUrl,l=ce(o,s,this.gdbVersion);a&&l&&(this.historicMoment=n)},this.when().then(()=>{this.addHandles([Pe(this._applyEditsHandler),Fe(this._updateMomentHandler)])},()=>{})}initialize(){this.when().catch(e=>{Ue(e)||Ee.getLogger(this).error("#load()",`Failed to load layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}')`,{error:e})})}get datasetName(){var e;return((e=this.dataElement)==null?void 0:e.name)??null}get owner(){var e;return((e=this.dataElement)==null?void 0:e.userIdentity)??null}get schemaGeneration(){var e;return((e=this.dataElement)==null?void 0:e.schemaGeneration)??null}get parsedUrl(){return _e(this.layerUrl)}get featureServiceUrl(){return we(this.parsedUrl.path).url.path}get networkServiceUrl(){return this.featureServiceUrl.replace(/\/FeatureServer/i,"/UtilityNetworkServer")}get layerId(){return we(this.parsedUrl.path).sublayer}get networkSystemLayers(){return null}async load(e){return this.addResolvingPromise(this._fetchDataElement(this.featureServiceUrl,this.layerId.toString(),e)),this.addResolvingPromise(this._fetchLayerMetaData(this.layerUrl,e)),this}getLayerIdBySourceId(e){if(this.dataElement){const t=this.dataElement.domainNetworks;for(const o of t){for(const s of o.edgeSources??[])if(s.sourceId===e)return s.layerId;for(const s of o.junctionSources??[])if(s.sourceId===e)return s.layerId}return null}return null}async queryNamedTraceConfigurations(e,t){var l;const[{queryNamedTraceConfigurations:o},{default:s}]=await Promise.all([E(()=>import("./queryNamedTraceConfigurations-BpPph30S.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139]),import.meta.url),E(()=>import("./QueryNamedTraceConfigurationsParameters-CNGt-iBK.js"),__vite__mapDeps([140,5,6,2,1,3,4]),import.meta.url)]),n=this.networkServiceUrl,a=s.from(e);return(l=await o(n,a,{...t}))==null?void 0:l.namedTraceConfigurations}async validateTopology(e,t){var h,w,g;if(!e.validateArea)throw new ue("network:undefined-validateArea","the network must have validateArea defined in the validate network topology parameters.");const[{validateNetworkTopology:o},{default:s}]=await Promise.all([E(()=>import("./validateNetworkTopology-DSJ_H22S.js"),__vite__mapDeps([141,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139]),import.meta.url),E(()=>import("./ValidateNetworkTopologyParameters-CqcPjzz1.js"),__vite__mapDeps([142,5,6,2,9,10,11,12,13,1,3,4,14,15,8,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139]),import.meta.url)]),n=s.from(e);le(this.featureServiceUrl,this.gdbVersion||null)?(n.sessionID=me,await ye(this.featureServiceUrl,this.gdbVersion,!0)):n.sessionID=null,n.gdbVersion=this.gdbVersion;const a=this.networkServiceUrl,l=this.featureServiceUrl,u=he(l,null,this.gdbVersion,!0),p=await o(a,n,{...t});if(p!=null&&p.serviceEdits){const m=[];for(const v of p.serviceEdits){const{editedFeatures:c}=v,d=c!=null&&c.spatialReference?new je(c.spatialReference):null;m.push({layerId:v.layerId,editedFeatures:{adds:((h=c==null?void 0:c.adds)==null?void 0:h.map(b=>re(b,d)))||[],updates:((w=c==null?void 0:c.updates)==null?void 0:w.map(b=>({original:re(b[0],d),current:re(b[1],d)})))||[],deletes:((g=c==null?void 0:c.deletes)==null?void 0:g.map(b=>re(b,d)))||[],spatialReference:d}})}u.resolve({edits:null,addedFeatures:[],updatedFeatures:[],deletedFeatures:[],addedAttachments:[],updatedAttachments:[],deletedAttachments:[],editedFeatures:m,exceededTransferLimit:!1,historicMoment:p.moment})}return p}async submitTopologyValidationJob(e,t){let o=null;if(!e.validateArea)throw new ue("network:undefined-validateArea","the network must have validateArea defined in the validate network topology parameters.");if(!this.gdbVersion){const h=this.layerUrl.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,"");o=(await W(h,{responseType:"json",query:{f:"json"}})).data.defaultVersionName}const[{submitValidateNetworkTopologyJob:s},{default:n}]=await Promise.all([E(()=>import("./validateNetworkTopology-DSJ_H22S.js"),__vite__mapDeps([141,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139]),import.meta.url),E(()=>import("./ValidateNetworkTopologyParameters-CqcPjzz1.js"),__vite__mapDeps([142,5,6,2,9,10,11,12,13,1,3,4,14,15,8,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139]),import.meta.url)]),a=n.from(e);le(this.featureServiceUrl,this.gdbVersion||null)?(a.sessionID=me,await ye(this.featureServiceUrl,this.gdbVersion,!0)):a.sessionID=null,a.gdbVersion=this.gdbVersion||o;const l=this.networkServiceUrl,u=this.featureServiceUrl?he(this.featureServiceUrl,null,this.gdbVersion,!0):void 0,p=await s(l,a,{...t});return new He({statusUrl:p,editsResolver:u})}async _fetchLayerMetaData(e,t){const o=await W(e,{responseType:"json",query:{f:"json"},...t});this.sourceJSON=o.data,this.read(o.data,{origin:"service"})}async _fetchDataElement(e,t,o){if(this.dataElement)return;const s=await W(`${e}/queryDataElements`,{responseType:"json",query:{layers:JSON.stringify([t]),f:"json"},...o}).then(n=>{var a;return(a=n.data.layerDataElements)==null?void 0:a[0]});s&&this.read(s,{origin:"service"})}};function re(e,t){return new be({attributes:e.attributes,geometry:Le({...e.geometry,spatialReference:t})})}r([i({type:String,nonNullable:!0,json:{origins:{"web-map":{read:!0,write:{isRequired:!0}},service:{read:!0}},read:!1}})],f.prototype,"id",void 0),r([i({type:String,nonNullable:!0,json:{origins:{"web-map":{read:!0,write:{isRequired:!0}},service:{read:{source:"name"}}},read:!1}})],f.prototype,"title",void 0),r([i({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"url"},write:{target:"url",isRequired:!0}}},read:!1}})],f.prototype,"layerUrl",void 0),r([i({type:Object,json:{origins:{service:{read:!0}},read:!1}})],f.prototype,"dataElement",void 0),r([i({type:Ve,json:{origins:{service:{read:{source:"extent"}}},read:!1}})],f.prototype,"fullExtent",void 0),r([i({type:je,json:{origins:{service:{read:{source:"extent.spatialReference"}}},read:!1}})],f.prototype,"spatialReference",void 0),r([i({type:["utility","trace"],readOnly:!0,json:{read:!1,write:!1}})],f.prototype,"type",void 0),r([i({readOnly:!0})],f.prototype,"datasetName",null),r([i({readOnly:!0})],f.prototype,"owner",null),r([i({readOnly:!0})],f.prototype,"schemaGeneration",null),r([i({readOnly:!0})],f.prototype,"parsedUrl",null),r([i({readOnly:!0})],f.prototype,"featureServiceUrl",null),r([i({readOnly:!0})],f.prototype,"networkServiceUrl",null),r([i({readOnly:!0})],f.prototype,"layerId",null),r([i()],f.prototype,"sourceJSON",void 0),r([i({readOnly:!0})],f.prototype,"networkSystemLayers",null),r([i()],f.prototype,"gdbVersion",void 0),r([i({type:Date})],f.prototype,"historicMoment",void 0),f=r([j("esri.networks.Network")],f);const Ye=f;var D;(function(e){e[e.RTJunctionJunctionConnectivity=1]="RTJunctionJunctionConnectivity",e[e.RTAttachment=2]="RTAttachment",e[e.RTContainment=3]="RTContainment",e[e.RTJunctionEdgeConnectivity=4]="RTJunctionEdgeConnectivity",e[e.RTEdgeJunctionEdgeConnectivity=5]="RTEdgeJunctionEdgeConnectivity"})(D||(D={}));const oe=new se({connected:"connected",upstream:"upstream",downstream:"downstream",shortestPath:"shortest-path",subnetwork:"subnetwork",subnetworkController:"subnetwork-controller",loops:"loops",isolation:"isolation"}),Ft=new se({junctionJunctionConnectivity:"junction-junction-connectivity",connectivity:"connectivity",attachment:"attachment",containment:"containment",junctionEdgeFromConnectivity:"junction-edge-from-connectivity",junctionMidspanConnectivity:"junction-midspan-connectivity",junctionEdgeToConnectivity:"junction-edge-to-connectivity"}),We={connectivity:1,"junction-junction-connectivity":1,attachment:2,containment:3,"junction-edge-from-connectivity":4,"junction-midspan-connectivity":5,"junction-edge-to-connectivity":6},Gt=new se({normal:"normal",rebuild:"rebuild",forceRebuild:"force-rebuild"});let z=class extends Oe(Ie){constructor(t){super(t),this.rulesCategorized={attachment:[],containment:[],connectivity:[]},this.request=W}initialize(){}async load(t){const o=this.layer.load(t).then(()=>this._initializeRulesTable());return this.addResolvingPromise(o),this}getFeatureSQL(t,o){var h,w;const s=t.layerId.toString(),n=(h=t.fieldsIndex)==null?void 0:h.normalizeFieldName("assetGroup"),a=(w=t.fieldsIndex)==null?void 0:w.normalizeFieldName("assetType"),l=n?o.attributes[n]:null,u=a?o.attributes[a]:null,p=this.rulesHash[s];if(p){const g=p.assetGroupHash[l];if(g)return g.assetTypeHash[u]||null}return null}async _initializeRulesTable(){var n,a,l,u,p,h,w,g,m,v,c;const t={};let o;(function(d){d[d.from=0]="from",d[d.to=1]="to",d[d.via=2]="via"})(o||(o={}));const s=[{networkSourceId:"fromNetworkSource",assetGroupId:"fromAssetGroup",assetTypeId:"fromAssetType"},{networkSourceId:"toNetworkSource",assetGroupId:"toAssetGroup",assetTypeId:"toAssetType"},{networkSourceId:"viaNetworkSource",assetGroupId:"viaAssetGroup",assetTypeId:"viaAssetType"}];this.rulesCategorized={attachment:[],containment:[],connectivity:[]};for(const d of this.rules){if(d.ruleType===D.RTAttachment){this.rulesCategorized.attachment.push(d);continue}if(d.ruleType===D.RTContainment){this.rulesCategorized.containment.push(d);continue}if(d.ruleType===D.RTJunctionJunctionConnectivity){this.rulesCategorized.connectivity.push(d);continue}this.rulesCategorized.connectivity.push(d);let b=[[o.from,o.to],[o.to,o.from]];d.ruleType===D.RTEdgeJunctionEdgeConnectivity&&(b=[[o.from,o.via],[o.via,o.from],[o.to,o.via],[o.via,o.to]]);for(const L of b){const P=L.shift(),Q=L.shift();let B=!1;switch(d.ruleType){case D.RTEdgeJunctionEdgeConnectivity:B=P===o.from||P===o.to;break;case D.RTJunctionEdgeConnectivity:B=P===o.to}const k=s[P],T=((n=d[k.networkSourceId])==null?void 0:n.layerId.toString())??"",I=(l=(a=d[k.assetGroupId])==null?void 0:a.assetGroupCode)==null?void 0:l.toString(),R=d[k.assetTypeId],O=(u=R==null?void 0:R.assetTypeCode)==null?void 0:u.toString(),U=s[Q],C=((p=d[U.networkSourceId])==null?void 0:p.layerId.toString())??"",G=(w=(h=d[U.assetGroupId])==null?void 0:h.assetGroupCode)==null?void 0:w.toString(),S=d[U.assetTypeId],M=(g=S==null?void 0:S.assetTypeCode)==null?void 0:g.toString(),ne=t[T]??{assetGroupHash:{}};if(!(I&&O&&G&&M))continue;const ae=ne.assetGroupHash[I]??{assetTypeHash:{}},N=ae.assetTypeHash[O]??{};if(N[C]=N[C]??{},B){N[T]=N[T]??{};const pe=`(assetgroup = ${I} AND assettype = ${O})`;N[T].anyVertex=N[T].anyVertex?`${N[T].anyVertex}`:`${pe}`,(S==null?void 0:S.connectivityPolicy)==="esriNECPEndVertex"&&(N[T].endVertex=(m=N[T])!=null&&m.endVertex?`${N[T].endVertex}`:`${pe}`)}const te=`(assetgroup = ${G} AND assettype = ${M})`;N[C].anyVertex=(v=N[C])!=null&&v.anyVertex?`${N[C].anyVertex} OR ${te}`:`${te}`,(S==null?void 0:S.connectivityPolicy)==="esriNECPEndVertex"&&(N[C].endVertex=(c=N[C])!=null&&c.endVertex?`${N[C].endVertex} OR ${te}`:`${te}`),ae.assetTypeHash[O]=N,ne.assetGroupHash[I]=ae,t[T]=ne}}this.rulesHash=t}};r([i({constructOnly:!0})],z.prototype,"layer",void 0),r([i({constructOnly:!0})],z.prototype,"rules",void 0),r([i()],z.prototype,"rulesHash",void 0),r([i()],z.prototype,"rulesCategorized",void 0),r([i({constructOnly:!0})],z.prototype,"request",void 0),z=r([j("esri.networks.RulesTable")],z);const Qe=z;let A=class extends K{constructor(t){super(t),this.conditionBarriers=[],this.outputConditions=[],this.functions=[],this.functionBarriers=[],this.traversabilityScope=null,this.shortestPathNetworkAttributeName=null,this.includeBarriers=null,this.validateConsistency=null,this.ignoreBarriersAtStartingPoints=null}};r([i({type:[Object],json:{write:!0}})],A.prototype,"conditionBarriers",void 0),r([i({type:[Object],json:{write:!0}})],A.prototype,"outputConditions",void 0),r([i({type:[Object],json:{write:!0}})],A.prototype,"functions",void 0),r([i({type:[Object],json:{write:!0}})],A.prototype,"functionBarriers",void 0),r([i({type:["junctions","edges","junctionsAndEdges"],json:{write:!0}})],A.prototype,"traversabilityScope",void 0),r([i({type:String,json:{write:!0}})],A.prototype,"shortestPathNetworkAttributeName",void 0),r([i({type:Boolean,json:{write:!0}})],A.prototype,"includeBarriers",void 0),r([i({type:Boolean,json:{write:!0}})],A.prototype,"validateConsistency",void 0),r([i({type:Boolean,json:{write:!0}})],A.prototype,"ignoreBarriersAtStartingPoints",void 0),A=r([j("esri.networks.support.TraceConfiguration")],A);const de=A;let y=class extends de{constructor(e){super(e),this.filterBarriers=[],this.arcadeExpressionBarrier=null,this.domainNetworkName=null,this.filterBitsetNetworkAttributeName=null,this.filterFunctionBarriers=[],this.filterScope=null,this.includeContainers=null,this.includeContent=null,this.includeIsolated=null,this.includeStructures=null,this.allowIndeterminateFlow=null,this.includeUpToFirstSpatialContainer=null,this.nearestNeighbor=null,this.outputFilterCategories=[],this.outputFilters=[],this.propagators=[],this.subnetworkName=null,this.targetTierName=null,this.diagramTemplateName=null,this.tierName=null,this.validateLocatability=null}};r([i({type:[Object],json:{write:!0}})],y.prototype,"filterBarriers",void 0),r([i({type:String,json:{write:!0}})],y.prototype,"arcadeExpressionBarrier",void 0),r([i({type:String,json:{write:!0}})],y.prototype,"domainNetworkName",void 0),r([i({type:String,json:{write:!0}})],y.prototype,"filterBitsetNetworkAttributeName",void 0),r([i({type:[Object],json:{write:!0}})],y.prototype,"filterFunctionBarriers",void 0),r([i({type:["junctions","edges","junctionsAndEdges"],json:{write:!0}})],y.prototype,"filterScope",void 0),r([i({type:Boolean,json:{write:!0}})],y.prototype,"includeContainers",void 0),r([i({type:Boolean,json:{write:!0}})],y.prototype,"includeContent",void 0),r([i({type:Boolean,json:{write:!0}})],y.prototype,"includeIsolated",void 0),r([i({type:Boolean,json:{write:!0}})],y.prototype,"includeStructures",void 0),r([i({type:Boolean,json:{write:!0}})],y.prototype,"allowIndeterminateFlow",void 0),r([i({type:Boolean,json:{write:!0}})],y.prototype,"includeUpToFirstSpatialContainer",void 0),r([i({type:Object,json:{write:!0}})],y.prototype,"nearestNeighbor",void 0),r([i({type:[Object],json:{write:!0}})],y.prototype,"outputFilterCategories",void 0),r([i({type:[Object],json:{write:!0}})],y.prototype,"outputFilters",void 0),r([i({type:[Object],json:{write:!0}})],y.prototype,"propagators",void 0),r([i({type:String,json:{write:!0}})],y.prototype,"subnetworkName",void 0),r([i({type:String,json:{write:!0}})],y.prototype,"targetTierName",void 0),r([i({type:String,json:{write:!0}})],y.prototype,"diagramTemplateName",void 0),r([i({type:String,json:{write:!0}})],y.prototype,"tierName",void 0),r([i({type:Boolean,json:{write:!0}})],y.prototype,"validateLocatability",void 0),y=r([j("esri.networks.support.UNTraceConfiguration")],y);const Ze=y;let _=class extends Re{constructor(t){super(t),this.globalId=null,this.title=null,this.traceConfiguration=null,this.creationDate=null,this.creator=null,this.description=null,this.minStartingPoints=null,this.resultTypes=[],this.tags=[],this.traceType=null}readTraceConfiguration(t,o){return t.tierName!==void 0?Ze.fromJSON(t):de.fromJSON(t)}};r([i({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"id"},write:{target:"id",isRequired:!0}},service:{read:{source:"globalId"},write:{target:"globalId",isRequired:!0}}},read:!1}})],_.prototype,"globalId",void 0),r([i({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"title"},write:{target:"title",isRequired:!0}},service:{read:{source:"name"},write:{target:"name",isRequired:!0}}},read:!1}})],_.prototype,"title",void 0),r([i({type:de,json:{origins:{service:{read:!0,write:!0}},read:!1}})],_.prototype,"traceConfiguration",void 0),r([xe("service","traceConfiguration")],_.prototype,"readTraceConfiguration",null),r([i({type:Date,json:{origins:{service:{read:!0,write:!0}},read:!1}})],_.prototype,"creationDate",void 0),r([i({type:String,json:{origins:{service:{read:!0,write:!0}},read:!1}})],_.prototype,"creator",void 0),r([i({type:String,json:{origins:{service:{read:!0,write:!0}},read:!1}})],_.prototype,"description",void 0),r([i({type:["none","one","many"],json:{origins:{service:{read:{source:"minNumStartingPoints"},write:{target:"minNumStartingPoints"}}},read:!1}})],_.prototype,"minStartingPoints",void 0),r([i({json:{origins:{service:{read:!0,write:!0}},read:!1}})],_.prototype,"resultTypes",void 0),r([i({type:[String],json:{origins:{service:{read:!0,write:!0}},read:!1}})],_.prototype,"tags",void 0),r([i({type:oe.apiValues,json:{type:oe.jsonValues,origins:{service:{read:oe.read,write:oe.write}},read:!1}})],_.prototype,"traceType",void 0),_=r([j("esri.networks.support.NamedTraceConfiguration")],_);const Xe=_;let $=class extends $e{constructor(e){super(e),this.rulesTableId=null,this.rulesTableUrl=null,this.subnetworksTableId=null,this.subnetworksTableUrl=null,this.dirtyAreasLayerId=null,this.dirtyAreasLayerUrl=null,this.associationsTableId=null,this.associationsTableUrl=null}};r([i({constructOnly:!0})],$.prototype,"rulesTableId",void 0),r([i({constructOnly:!0})],$.prototype,"rulesTableUrl",void 0),r([i({constructOnly:!0})],$.prototype,"subnetworksTableId",void 0),r([i({constructOnly:!0})],$.prototype,"subnetworksTableUrl",void 0),r([i({constructOnly:!0})],$.prototype,"dirtyAreasLayerId",void 0),r([i({constructOnly:!0})],$.prototype,"dirtyAreasLayerUrl",void 0),r([i({constructOnly:!0})],$.prototype,"associationsTableId",void 0),r([i({constructOnly:!0})],$.prototype,"associationsTableUrl",void 0),$=r([j("esri.networks.support.NetworkSystemLayers")],$);const et=$;let Z=class extends K{constructor(t){super(t),this.id=null,this.name=null}};r([i({type:Number,json:{read:{source:"terminalId"},write:{target:"terminalId"}}})],Z.prototype,"id",void 0),r([i({type:String,json:{read:{source:"terminalName"},write:{target:"terminalName"}}})],Z.prototype,"name",void 0),r([i({type:Boolean,json:{write:!0}})],Z.prototype,"isUpstreamTerminal",void 0),Z=r([j("esri.networks.support.Terminal")],Z);const tt=Z,ie=new se({esriUNTMBidirectional:"bidirectional",esriUNTMDirectional:"directional"});let H=class extends K{constructor(t){super(t),this.defaultConfiguration=null,this.id=null,this.name=null,this.terminals=[],this.traversabilityModel=null}};r([i({type:String,json:{write:!0}})],H.prototype,"defaultConfiguration",void 0),r([i({type:Number,json:{read:{source:"terminalConfigurationId"},write:{target:"terminalConfigurationId"}}})],H.prototype,"id",void 0),r([i({type:String,json:{read:{source:"terminalConfigurationName"},write:{target:"terminalConfigurationName"}}})],H.prototype,"name",void 0),r([i({type:[tt],json:{write:!0}})],H.prototype,"terminals",void 0),r([i({type:ie.apiValues,json:{type:ie.jsonValues,read:ie.read,write:ie.write}})],H.prototype,"traversabilityModel",void 0),H=r([j("esri.networks.support.TerminalConfiguration")],H);const ve=H;let X=class extends K{constructor(t){super(t),this.line=null,this.multipoint=null,this.polygon=null}};r([i({type:Je,json:{write:!0},readOnly:!0})],X.prototype,"line",void 0),r([i({type:De,json:{read:{source:"point"},write:{target:"point"}},readOnly:!0})],X.prototype,"multipoint",void 0),r([i({type:Be,json:{write:!0},readOnly:!0})],X.prototype,"polygon",void 0),X=r([j("esri.rest.networks.support.AggregatedGeometry")],X);const rt=X;let ee=class extends K{constructor(t){super(t),this.functionType=null,this.networkAttributeName=null,this.result=null}};r([i({type:["add","subtract","average","count","min","max"],json:{write:!0},readOnly:!0})],ee.prototype,"functionType",void 0),r([i({type:String,json:{write:!0},readOnly:!0})],ee.prototype,"networkAttributeName",void 0),r([i({type:Number,json:{write:!0},readOnly:!0})],ee.prototype,"result",void 0),ee=r([j("esri.rest.networks.support.FunctionResult")],ee);const ot=ee;let V=class extends K{constructor(e){super(e),this.assetGroupCode=null,this.assetTypeCode=null,this.globalId=null,this.networkSourceId=null,this.objectId=null,this.positionFrom=null,this.positionTo=null,this.terminalId=null}};r([i({type:Number,json:{write:!0}})],V.prototype,"assetGroupCode",void 0),r([i({type:Number,json:{write:!0}})],V.prototype,"assetTypeCode",void 0),r([i({type:String,json:{write:!0}})],V.prototype,"globalId",void 0),r([i({type:Number,json:{write:!0}})],V.prototype,"networkSourceId",void 0),r([i({type:Number,json:{write:!0}})],V.prototype,"objectId",void 0),r([i({type:Number,json:{write:!0}})],V.prototype,"positionFrom",void 0),r([i({type:Number,json:{write:!0}})],V.prototype,"positionTo",void 0),r([i({type:Number,json:{write:!0}})],V.prototype,"terminalId",void 0),V=r([j("esri.rest.networks.support.NetworkElement")],V);const it=V;let x=class extends K{constructor(t){super(t),this.aggregatedGeometry=null,this.elements=null,this.globalFunctionResults=null,this.kFeaturesForKNNFound=!1,this.startingPointsIgnored=!1,this.warnings=null}};r([i({type:rt,json:{write:!0},readOnly:!0})],x.prototype,"aggregatedGeometry",void 0),r([i({type:[it],json:{write:!0},readOnly:!0})],x.prototype,"elements",void 0),r([i({type:[ot],json:{write:!0},readOnly:!0})],x.prototype,"globalFunctionResults",void 0),r([i({type:Boolean,json:{write:!0},readOnly:!0})],x.prototype,"kFeaturesForKNNFound",void 0),r([i({type:Boolean,json:{write:!0},readOnly:!0})],x.prototype,"startingPointsIgnored",void 0),r([i({type:[String],json:{write:!0},readOnly:!0})],x.prototype,"warnings",void 0),x=r([j("esri.rest.networks.support.TraceResult")],x);const st=x,nt=Ne()({Pending:"job-waiting",InProgress:"job-executing",Completed:"job-succeeded"});let Y=class extends st{constructor(e){super(e),this.statusUrl=null,this.status=null,this.submissionTime=null,this.lastUpdatedTime=null,this._timer=void 0}destroy(){clearInterval(this._timer)}async checkJobStatus(e){const t={...e,query:{f:"json"}},{data:o}=await W(this.statusUrl,t),s=o.traceResults?{...o.traceResults,...o}:o;return this.read(s),this}async waitForJobCompletion(e={}){const{interval:t=1e3,statusCallback:o}=e;return new Promise((s,n)=>{this._clearTimer();const a=setInterval(()=>{this._timer||n(Se()),this.checkJobStatus().then(l=>{const{status:u}=l;switch(this.status=u,u){case"job-succeeded":this._clearTimer(),s(this);break;case"job-waiting":case"job-executing":o&&o(this)}},l=>{this._clearTimer(),n(l)})},t);this._timer=a})}_clearTimer(){clearInterval(this._timer),this._timer=void 0}};r([i({type:String,json:{write:!0}})],Y.prototype,"statusUrl",void 0),r([ke(nt)],Y.prototype,"status",void 0),r([i({type:Date,json:{type:Number,write:{writer:(e,t)=>{t.submissionTime=e?e.getTime():null}}}})],Y.prototype,"submissionTime",void 0),r([i({type:Date,json:{type:Number,write:{writer:(e,t)=>{t.lastUpdatedTime=e?e.getTime():null}}}})],Y.prototype,"lastUpdatedTime",void 0),Y=r([j("esri.networks.support.TraceJobInfo")],Y);const at=Y;let J=class extends Ye{constructor(e){super(e),this.sharedNamedTraceConfigurations=[],this.type="utility"}get serviceTerritoryFeatureLayerId(){var e;return((e=this.dataElement)==null?void 0:e.serviceTerritoryFeatureLayerId)??null}get networkSystemLayers(){var e,t,o,s,n,a,l,u;return new et({rulesTableId:(e=this.sourceJSON)==null?void 0:e.systemLayers.rulesTableId,rulesTableUrl:this.sourceJSON?`${this.featureServiceUrl}/${(t=this.sourceJSON)==null?void 0:t.systemLayers.rulesTableId}`:null,subnetworksTableId:(o=this.sourceJSON)==null?void 0:o.systemLayers.subnetworksTableId,subnetworksTableUrl:this.sourceJSON?`${this.featureServiceUrl}/${(s=this.sourceJSON)==null?void 0:s.systemLayers.subnetworksTableId}`:null,dirtyAreasLayerId:(n=this.sourceJSON)==null?void 0:n.systemLayers.dirtyAreasLayerId,dirtyAreasLayerUrl:this.sourceJSON?`${this.featureServiceUrl}/${(a=this.sourceJSON)==null?void 0:a.systemLayers.dirtyAreasLayerId}`:null,associationsTableId:(l=this.sourceJSON)==null?void 0:l.systemLayers.associationsTableId,associationsTableUrl:this.sourceJSON?`${this.featureServiceUrl}/${(u=this.sourceJSON)==null?void 0:u.systemLayers.associationsTableId}`:null})}get terminalConfigurations(){var e;return((e=this.dataElement)==null?void 0:e.terminalConfigurations.map(t=>ve.fromJSON(t)))||[]}get domainNetworkNames(){var e;return((e=this.dataElement)==null?void 0:e.domainNetworks.map(t=>t.domainNetworkName))||[]}get _utilityLayerList(){var t,o;const e=new Set;return(o=(t=this.dataElement)==null?void 0:t.domainNetworks)==null||o.map(s=>{s.edgeSources.map(n=>{e.add(n.layerId)}),s.junctionSources.map(n=>{e.add(n.layerId)})}),e}async load(e){return this.addResolvingPromise(super.load(e)),this.addResolvingPromise(this._loadNamedTraceConfigurationsFromNetwork(e)),this}getTerminalConfiguration(e){var p,h,w,g;let t=null,o=null;const s=e.layer;let n=null;if((s==null?void 0:s.type)==="feature"){if(n=s.layerId,n===null)return null}else if((s==null?void 0:s.type)!=="subtype-sublayer"||(n=((p=s==null?void 0:s.parent)==null?void 0:p.layerId)??null,n===null))return null;const a=e.attributes;if(a==null)return null;for(const m of Object.keys(a))m.toUpperCase()==="ASSETGROUP"&&(t=e.getAttribute(m)),m.toUpperCase()==="ASSETTYPE"&&(o=e.getAttribute(m));if(!this.dataElement)return null;let l=null;const u=this.dataElement.domainNetworks;for(const m of u){const v=(h=m.junctionSources)==null?void 0:h.find(c=>c.layerId===n);if(v){const c=(w=v.assetGroups)==null?void 0:w.find(d=>d.assetGroupCode===t);if(c){const d=(g=c.assetTypes)==null?void 0:g.find(b=>b.assetTypeCode===o);if(d){l=d.terminalConfigurationId;break}}}}if(l!=null){const m=this.dataElement.terminalConfigurations,v=m==null?void 0:m.find(c=>c.terminalConfigurationId===l);return v?ve.fromJSON(v):null}return null}getTierNames(e){var o;const t=(o=this.dataElement)==null?void 0:o.domainNetworks.find(s=>s.domainNetworkName===e);return(t==null?void 0:t.tiers.map(s=>s.name))||[]}async getRulesTable(){return this._sharedRulesTable||(this._sharedRulesTable=this._createRulesTable()),await this._sharedRulesTable}isUtilityLayer(e){var t;return this._utilityLayerList.has(e.layerId)&&(((t=e.url)==null?void 0:t.startsWith(this.featureServiceUrl))??!1)}async queryAssociations(e){const[{queryAssociations:t},{default:o}]=await Promise.all([E(()=>import("./queryAssociations-DRmQREcE.js"),__vite__mapDeps([143,1,2,3,4,5,6,7,144,9,10,11,12,13,14,15,8,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139]),import.meta.url),E(()=>import("./QueryAssociationsParameters-K08DqprU.js"),__vite__mapDeps([145,5,6,2,1,3,4,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139]),import.meta.url)]),s=o.from(e);return s.gdbVersion=this.gdbVersion,s.moment=this.historicMoment,(await t(this.networkServiceUrl,s)).associations}async synthesizeAssociationGeometries(e){const[{synthesizeAssociationGeometries:t},{default:o}]=await Promise.all([E(()=>import("./synthesizeAssociationGeometries-PxczlRK7.js"),__vite__mapDeps([146,1,2,3,4,5,6,7,144,9,10,11,12,13,14,15,8,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139]),import.meta.url),E(()=>import("./SynthesizeAssociationGeometriesParameters-C3KjVZIq.js"),__vite__mapDeps([147,5,6,2,1,3,4,13,10,11,12]),import.meta.url)]),s=o.from(e);return s.gdbVersion=this.gdbVersion,s.moment=this.historicMoment,t(this.networkServiceUrl,s)}async trace(e){const[{trace:t},{default:o}]=await Promise.all([E(()=>import("./trace-DC1OA9Cf.js"),__vite__mapDeps([148,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139]),import.meta.url),E(()=>import("./TraceParameters-DBTJ4Bod.js").then(n=>n.T),__vite__mapDeps([149,5,6,2,1,3,4,13,11,12]),import.meta.url)]),s=o.from(e);return s.gdbVersion=this.gdbVersion,s.moment=this.historicMoment,t(this.networkServiceUrl,s)}async submitTraceJob(e){const[{submitTraceJob:t},{default:o}]=await Promise.all([E(()=>import("./trace-DC1OA9Cf.js"),__vite__mapDeps([148,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139]),import.meta.url),E(()=>import("./TraceParameters-DBTJ4Bod.js").then(a=>a.T),__vite__mapDeps([149,5,6,2,1,3,4,13,11,12]),import.meta.url)]),s=o.from(e);s.gdbVersion=this.gdbVersion,s.moment=this.historicMoment;const n=await t(this.networkServiceUrl,s);return new at({statusUrl:n})}async canAddAssociation(e){const t=await this.getRulesTable();if(!t)return!1;await t.load();const o=(n,a)=>n?n.terminalId===1?!(a!=null&&a.terminalId)||(a==null?void 0:a.terminalId)===n.terminalId:n.terminalId===(a==null?void 0:a.terminalId):!(a!=null&&a.terminalId),s=(n,a)=>{var l,u,p,h,w,g,m,v,c,d,b,L;return((l=n.fromNetworkSource)==null?void 0:l.sourceId)===((u=a.fromNetworkElement)==null?void 0:u.networkSourceId)&&((p=n.toNetworkSource)==null?void 0:p.sourceId)===((h=a.toNetworkElement)==null?void 0:h.networkSourceId)&&((w=n.fromAssetGroup)==null?void 0:w.assetGroupCode)===((g=a.fromNetworkElement)==null?void 0:g.assetGroupCode)&&((m=n.fromAssetType)==null?void 0:m.assetTypeCode)===((v=a.fromNetworkElement)==null?void 0:v.assetTypeCode)&&((c=n.toAssetGroup)==null?void 0:c.assetGroupCode)===((d=a.toNetworkElement)==null?void 0:d.assetGroupCode)&&((b=n.toAssetType)==null?void 0:b.assetTypeCode)===((L=a.toNetworkElement)==null?void 0:L.assetTypeCode)&&o(n.fromTerminal,a.fromNetworkElement)&&o(n.toTerminal,a.toNetworkElement)};return e.associationType==="containment"?t.rulesCategorized.containment.some(n=>s(n,e)):e.associationType==="attachment"?t.rulesCategorized.attachment.some(n=>s(n,e)):t.rulesCategorized.connectivity.some(n=>{var a,l,u,p,h,w,g,m,v,c,d,b,L,P,Q,B,k,T,I,R,O,U,C,G;return n.viaNetworkSource?((a=n.fromNetworkSource)==null?void 0:a.sourceId)===((l=e.fromNetworkElement)==null?void 0:l.networkSourceId)&&((u=n.viaNetworkSource)==null?void 0:u.sourceId)===((p=e.toNetworkElement)==null?void 0:p.networkSourceId)&&((h=n.fromAssetGroup)==null?void 0:h.assetGroupCode)===((w=e.fromNetworkElement)==null?void 0:w.assetGroupCode)&&((g=n.fromAssetType)==null?void 0:g.assetTypeCode)===((m=e.fromNetworkElement)==null?void 0:m.assetTypeCode)&&((v=n.viaAssetGroup)==null?void 0:v.assetGroupCode)===((c=e.toNetworkElement)==null?void 0:c.assetGroupCode)&&((d=n.viaAssetType)==null?void 0:d.assetTypeCode)===((b=e.toNetworkElement)==null?void 0:b.assetTypeCode)&&o(n.fromTerminal,e.fromNetworkElement)&&o(n.viaTerminal,e.toNetworkElement)||((L=n.viaNetworkSource)==null?void 0:L.sourceId)===((P=e.fromNetworkElement)==null?void 0:P.networkSourceId)&&((Q=n.toNetworkSource)==null?void 0:Q.sourceId)===((B=e.toNetworkElement)==null?void 0:B.networkSourceId)&&((k=n.viaAssetGroup)==null?void 0:k.assetGroupCode)===((T=e.fromNetworkElement)==null?void 0:T.assetGroupCode)&&((I=n.viaAssetType)==null?void 0:I.assetTypeCode)===((R=e.fromNetworkElement)==null?void 0:R.assetTypeCode)&&((O=n.toAssetGroup)==null?void 0:O.assetGroupCode)===((U=e.toNetworkElement)==null?void 0:U.assetGroupCode)&&((C=n.toAssetType)==null?void 0:C.assetTypeCode)===((G=e.toNetworkElement)==null?void 0:G.assetTypeCode)&&o(n.viaTerminal,e.fromNetworkElement)&&o(n.toTerminal,e.toNetworkElement):s(n,e)})}generateAddAssociations(e){return{addFeatures:e.map(t=>{var o,s,n,a,l,u;return new be({attributes:{fromnetworksourceid:(o=t.fromNetworkElement)==null?void 0:o.networkSourceId,fromglobalid:(s=t.fromNetworkElement)==null?void 0:s.globalId,fromterminalid:(n=t.fromNetworkElement)==null?void 0:n.terminalId,tonetworksourceid:(a=t.toNetworkElement)==null?void 0:a.networkSourceId,toglobalid:(l=t.toNetworkElement)==null?void 0:l.globalId,toterminalid:(u=t.toNetworkElement)==null?void 0:u.terminalId,associationtype:We[t.associationType],iscontentvisible:t.isContentVisible?1:0,percentalong:t.percentAlong,globalid:t.globalId}})}),id:this.networkSystemLayers.associationsTableId,identifierFields:{globalIdField:"globalid",objectIdField:"objectid"}}}generateDeleteAssociations(e){return{deleteFeatures:e.map(t=>({globalId:t.globalId})),id:this.networkSystemLayers.associationsTableId,identifierFields:{globalIdField:"globalid",objectIdField:"objectid"}}}async _loadNamedTraceConfigurationsFromNetwork(e){var s;if(((s=this.sharedNamedTraceConfigurations)==null?void 0:s.length)===0)return;const t=this.sharedNamedTraceConfigurations.map(n=>n.globalId),o=await this.queryNamedTraceConfigurations({globalIds:t},e);for(const n of this.sharedNamedTraceConfigurations){const a=o==null?void 0:o.find(l=>l.globalId===n.globalId);if(a){const l=a.write({},{origin:"service"});n.read(l,{origin:"service"})}}}async _createRulesTable(){var a;const e=this.networkSystemLayers.rulesTableUrl,t=new Ce({url:e});await t.load();const o=(a=this.dataElement)==null?void 0:a.domainNetworks;if(!o)return null;const s=o.flatMap(l=>[...l.edgeSources||[],...l.junctionSources||[]]),n=(await lt(t)).map(l=>this._hydrateRuleInfo(t,s,l));return new Qe({layer:t,rules:n})}_hydrateRuleInfo(e,t,o){const s=e.fieldsIndex,n=s.get("RULETYPE"),a=s.get("CREATIONDATE"),l=s.get("FROMNETWORKSOURCEID"),u=s.get("FROMASSETGROUP"),p=s.get("FROMASSETTYPE"),h=s.get("FROMTERMINALID"),w=s.get("TONETWORKSOURCEID"),g=s.get("TOASSETGROUP"),m=s.get("TOASSETTYPE"),v=s.get("TOTERMINALID"),c=s.get("VIANETWORKSOURCEID"),d=s.get("VIAASSETGROUP"),b=s.get("VIAASSETTYPE"),L=s.get("VIATERMINALID"),P=o.attributes[n.name],Q=new Date(o.attributes[a.name]),B=[{networkSourceId:o.attributes[l.name],assetGroupId:o.attributes[u.name],assetTypeId:o.attributes[p.name],terminalId:o.attributes[h.name]},{networkSourceId:o.attributes[w.name],assetGroupId:o.attributes[g.name],assetTypeId:o.attributes[m.name],terminalId:o.attributes[v.name]},{networkSourceId:o.attributes[c.name],assetGroupId:o.attributes[d.name],assetTypeId:o.attributes[b.name],terminalId:o.attributes[L.name]}];let k;(function(I){I[I.from=0]="from",I[I.to=1]="to",I[I.via=2]="via"})(k||(k={}));const T={ruleType:P,creationDate:Q};for(const I of[k.from,k.to,k.via]){if(P!==D.RTEdgeJunctionEdgeConnectivity&&I===k.via)continue;const R=B[I],O=t.find(M=>M.sourceId===R.networkSourceId),U=O==null?void 0:O.assetGroups.find(M=>M.assetGroupCode===R.assetGroupId),C=U==null?void 0:U.assetTypes.find(M=>M.assetTypeCode===R.assetTypeId),G=this._getTerminal(C,R);let S="";switch(I){case k.from:S="from";break;case k.to:S="to";break;case k.via:S="via"}T[`${S}NetworkSource`]=O,T[`${S}AssetGroup`]=U,T[`${S}AssetType`]=C,T[`${S}Terminal`]=G==null?void 0:G.toJSON()}return T}_getTerminal(e,t){var n,a;const o=e==null?void 0:e.terminalConfigurationId,s=(n=this.terminalConfigurations)==null?void 0:n.find(l=>l.id===o);return((a=s==null?void 0:s.terminals)==null?void 0:a.find(l=>l.id===t.terminalId))??null}};async function lt(e){const t=new Me({where:"1=1",outFields:["*"]});return(await Te(e,t)).features}r([i({type:[Xe],json:{origins:{"web-map":{read:{source:"traceConfigurations"},write:{target:"traceConfigurations"}},service:{read:{source:"traceConfigurations"}}},read:!1}})],J.prototype,"sharedNamedTraceConfigurations",void 0),r([i({type:["utility"],readOnly:!0,json:{read:!1,write:!1}})],J.prototype,"type",void 0),r([i({readOnly:!0})],J.prototype,"serviceTerritoryFeatureLayerId",null),r([i({readOnly:!0})],J.prototype,"networkSystemLayers",null),r([i({readOnly:!0})],J.prototype,"terminalConfigurations",null),r([i({readOnly:!0})],J.prototype,"domainNetworkNames",null),J=r([j("esri.networks.UtilityNetwork")],J);const ut=J,dt=Object.freeze(Object.defineProperty({__proto__:null,default:ut},Symbol.toStringTag,{value:"Module"}));export{ut as T,st as a,qe as b,Gt as c,Xe as d,Pt as e,Ft as i,Lt as n,oe as o,it as p,Ze as s};
