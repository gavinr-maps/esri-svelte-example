import{e as l}from"./Evented-CXIxDjmW.js";import{y as r,b as g,a3 as Me,n as We}from"./subclass-BR3PhgZG.js";import{s as Re}from"./jsonMap-DCC6W5ex.js";import{B as F,n as a,o as ee,s as ce,e as he,f as O}from"./jsxFactory-CbAu6VfF.js";import{S as G,s as ve,b as le,K as H}from"./Accessor-D6mNnsWy.js";import{V as S,d as $,P as L,w as X,v as Ie}from"./reactiveUtils-BFQ0BtrB.js";import{n as oe}from"./collectionUtils-Dm1icNvk.js";import{c as ge,a as Ae,i as Oe,H as He,f as De}from"./BuildingSceneLayer-BLpUQMNB.js";import{n as Te}from"./uuid-fwrPAdZb.js";import{i as z}from"./legacyIcon-CtsJ0OTG.js";import{e as de}from"./mathUtils-ClvKsMak.js";import{e as I}from"./globalCss-CZa70j6i.js";import{e as Y}from"./Heading-ynVMbJ8d.js";import"./intl-Dpfm8vPB.js";import"./Promise-CZrWwByK.js";import"./assets-C2mb-ea2.js";import"./index-CeCSsEgo.js";import"./shared-B3wH2qpO.js";import"./CollectionFlattener-CkyePFnC.js";import"./loadAll-DDw-urzS.js";import"./Portal-liet8xHC.js";import"./writer-3zufXUNV.js";import"./Extent-DHjqVB-p.js";import"./Point-DB4Hp4hH.js";import"./MultiOriginJSONSupport-DjAXzJun.js";import"./Layer-C96_yo4i.js";import"./geometry-DpwwkAX1.js";import"./Polyline-D97hl-6E.js";import"./TimeExtent-41gxTbrv.js";import"./timeUtils-DQR2jUPL.js";import"./Identifiable-BLvpQbOc.js";import"./BuildingComponentSublayer-C9oehFgo.js";import"./Graphic-Dc7F67nR.js";import"./PopupTemplate-ByHks6sq.js";import"./Clonable-cKbRam6-.js";import"./fieldUtils-CNduWQU9.js";import"./enumeration--HlxOQ_N.js";import"./Color-DDUWtbqR.js";import"./colorUtils-CS9vdHXB.js";import"./ActionToggle-C0Z1k2jc.js";import"./symbols-CsUQ5BxR.js";import"./TextSymbol-gKE-H_J6.js";import"./screenUtils-PfxkaaMN.js";import"./materialUtils-CQ3JLQ1x.js";import"./opacityUtils-BT7mQkwC.js";import"./aaBoundingBox-rJEWaOSN.js";import"./persistableUrlUtils-BcifXQ1Z.js";import"./jsonUtils-Cma_7A64.js";import"./ClassBreaksRenderer-DMO3d0Rn.js";import"./UniqueValueRenderer-dci9bLM8.js";import"./diffUtils--7ofoPN-.js";import"./colorRamps-CFlTi-ob.js";import"./SizeVariable-aYYWlweG.js";import"./ColorStop-CXfPDZon.js";import"./sizeVariableUtils-Cmcuvw-4.js";import"./visualVariableUtils-DzaXbn8H.js";import"./compilerUtils-BA04t1lN.js";import"./lengthUtils-D7_DvYH0.js";import"./jsonUtils-C6dvhNjw.js";import"./layerUtils-erzwAANv.js";import"./defaults-DCm7iNI6.js";import"./defaultsJSON-GKolV7NZ.js";import"./styleUtils-DQEZjdpw.js";import"./jsonUtils-CuoSmH2q.js";import"./LRUCache-ju6LnIBZ.js";import"./MemCache-C6WUx-5V.js";import"./Version-_Vxue7Ui.js";import"./FieldsIndex-IOXc-mnc.js";import"./UnknownTimeZone-D0GlcniK.js";import"./OverrideHelper-C4oumxVn.js";import"./colorUtils-D5nOabzP.js";import"./vec42-B1mBkh1w.js";import"./vec4f64-CBQL1T0x.js";import"./utils-CO7DMJWl.js";import"./quantizationUtils-CIQDbQFJ.js";import"./HeatmapColorStop-CgvKf0-E.js";import"./heatmapUtils-C-uT6ZIV.js";import"./SimpleRenderer-DvJZ7cyq.js";import"./FeatureLayer-BCmfw45U.js";import"./layerContainerType-C5CzMsLd.js";import"./FeatureLayerBase-CD91dIfN.js";import"./inputs-CnJRqwLx.js";import"./Field-C8SaaeoI.js";import"./fieldType-CIG5ey7e.js";import"./formUtils-Dni92j4V.js";import"./HeightModelInfo-CSXZysDz.js";import"./arcgisLayerUrl-Cgl5IQFD.js";import"./commonProperties-C-F8Nu9F.js";import"./ElevationInfo-BxYXLfrw.js";import"./unitConversionUtils-Dl04YuQU.js";import"./featureLayerUtils-CeNLEyq1.js";import"./featureQueryAll-CRo1-WqJ.js";import"./Query-Cx4awVKu.js";import"./DataLayerSource-6X35yXpo.js";import"./FullTextSearch-BNIhEccm.js";import"./AttachmentQuery-Dn4NbT1Z.js";import"./RelationshipQuery-kHvI2dm7.js";import"./LayerFloorInfo-BN2blBAm.js";import"./Relationship-WMN17mIX.js";import"./serviceCapabilitiesUtils-GL2GsHu0.js";import"./workers-8Q6jrI18.js";import"./Queue-DpHko4Yk.js";import"./editsZScale-BMHD7K6h.js";import"./queryZScale-B_YkkRy9.js";import"./projection-A9yUaaTs.js";import"./projectBuffer-vsa0P_cF.js";import"./geodesicConstants-XRAvAZCD.js";import"./FeatureSet-DyOnd9Rj.js";import"./APIKeyMixin-DpJrW91V.js";import"./ArcGISService-Dr1J04Ka.js";import"./BlendLayer-DmvCcS5c.js";import"./jsonUtils-C4Wp5KpV.js";import"./parser-BN6zmHl-.js";import"./utils-D20M4_S8.js";import"./mat4f32-DcsiF_Rp.js";import"./mat4-ybYUU6jq.js";import"./CustomParametersMixin-BStBpako.js";import"./EditBusLayer-C6pLlK14.js";import"./FeatureEffectLayer-B3ucpbgh.js";import"./FeatureEffect-BXMKpemG.js";import"./FeatureFilter-BzdN7b7E.js";import"./FeatureReductionLayer-7Q3CJbxJ.js";import"./FeatureReductionSelection-Do1LXJh7.js";import"./labelingInfo-C8CHVUWS.js";import"./labelUtils-Cczy0uDR.js";import"./MD5-C9MwAd2G.js";import"./OperationalLayer-B61mRSes.js";import"./OrderedLayer-CfmzojSk.js";import"./OrderByInfo-Bn0SWspE.js";import"./PortalLayer-iKUPhGZB.js";import"./PortalItem-BuTU9OuN.js";import"./portalItemUtils-DIZSrm3T.js";import"./RefreshableLayer-B26jSd3d.js";import"./ScaleRangeLayer-CKYXLXxK.js";import"./TemporalLayer-D6vkocFU.js";import"./TimeInterval-CjSB1odC.js";import"./TimeInfo-Cq5mDY2W.js";import"./FeatureTemplate-BOr53vUa.js";import"./FeatureType-ByEWGsln.js";import"./fieldProperties-DJEV41A1.js";import"./versionUtils-ByKR3-oH.js";import"./styleUtils-BATHgMyw.js";import"./TopFeaturesQuery-BBItvyOE.js";import"./popupUtils-fsHWupnf.js";import"./interfaces-CL2NbQte.js";import"./capabilities-CAweHQni.js";import"./I3SIndexInfo-ByH-ZBj-.js";import"./I3SLayerDefinitions-DS-Kg5zK.js";import"./I3SUtil-vacVP6Bd.js";import"./mat4f64-Dk4dwAN8.js";import"./spatialReferenceEllipsoidUtils-BL8s_3ls.js";import"./projectVectorToVector-Chzd0Pq0.js";import"./projectPointToVector-D3506wm2.js";import"./sphere-7666U3LO.js";import"./plane-Bz78OrLf.js";import"./mat3f64-BBpwCtoL.js";import"./quatf64-BrpT0VRp.js";import"./vec2f64-Diu2Kaa8.js";import"./mathUtils-kvswLROa.js";import"./I3SBinaryReader-CtwiVPE4.js";import"./VertexAttribute-BnAa5VW0.js";import"./computeTranslationToOriginAndRotation-CLzktXYu.js";import"./edgeUtils-BIb6yRHm.js";import"./floatRGBA-C8rGFKJ0.js";import"./DecodeSymbolColor.glsl-CeBC4xQe.js";import"./interfaces-B8ge7Jg9.js";import"./NormalAttribute.glsl-Dqf1UPF9.js";import"./BindType-BmZEZMMh.js";import"./Float4DrawUniform-CWdxHXQ-.js";import"./orientedBoundingBox-COq6pSqo.js";import"./mat3-DRqs2t5W.js";import"./quat-ChS85qAG.js";import"./ViewingMode-Dodu7ZZk.js";import"./popupUtils-sb3Ob2mW.js";import"./BuildingGroupSublayer-CRW9hM9p.js";import"./SceneService-DBiT0mro.js";import"./originUtils-D69mHv66.js";import"./multiOriginJSONSupportUtils-C0wm8_Yw.js";import"./jsonContext-9yrMdsS4.js";import"./resourceUtils-DVLIxTBF.js";import"./resourceUtils-CLi0K8NA.js";import"./saveAPIKeyUtils--6vvrYdZ.js";import"./saveUtils-BlgyRdsU.js";import"./associatedFeatureServiceUtils-D5PtzNfT.js";import"./elevationInfoUtils-Bl7QRRwv.js";const ze="overview",me=t=>e=>{const i=t.toLowerCase();return e.sublayers.find(s=>{var o;return((o=s.modelName)==null?void 0:o.toLowerCase())===i})??null},_e=me("fullmodel"),Ue=me(ze);function Ke(t){const e=_e(t);e!=null&&(e.visible=!0);const i=Ue(t);i!=null&&(i.visible=!1)}function te(t,e){const i=je(t,e);if(i==null)return null;const s=i.fieldName;if(s==null||!s)return null;const o=qe(t,s),n=new Map;for(const h of i.mostFrequentValues??[])typeof h=="number"&&n.set(h,o!=null?o.getName(h):String(h));return{fieldName:s,fieldValueMap:n}}function qe(t,e){var i;for(const s of t.allSublayers.items){const o=s.type==="building-component"?(i=s.getFieldDomain)==null?void 0:i.call(s,e):null;if(o&&o.type==="coded-value")return o}return null}function je(t,e){var o;const i=((o=t.summaryStatistics)==null?void 0:o.fields)??[],s=e.toLowerCase();return i.find(n=>{var h;return((h=n.modelName)==null?void 0:h.toLowerCase())===s})??null}let u=class extends G{constructor(){super(...arguments),this.id="root",this.parent=null,this.children=new S,this.layers=new S,this.level=0,this.collapsed=!0,this._childIds=new Set,this._layerUniqueIds=new Set}initialize(){this.addHandles([this.layers.on("before-add",e=>{this._layerUniqueIds.has(e.item.uid)?e.preventDefault():this._layerUniqueIds.add(e.item.uid)}),this.layers.on("after-add",({item:e})=>{this.addHandles([$(()=>e.visible,()=>this.notifyChange("visible"),L),$(()=>e.title,()=>this.notifyChange("title"),L)],e.uid)}),this.layers.on("before-remove",({item:e})=>{this.removeHandles(e.uid),this.notifyChange("title"),this.notifyChange("visible")}),this.children.on("before-add",e=>{this._childIds.has(e.item.id)?e.preventDefault():(e.item._set("parent",this),this._childIds.add(e.item.id))})])}destroy(){this.children.forEach(e=>e.destroy())}get hasChildren(){return this.children.length>0}get isRoot(){return this.level===0}get isLeaf(){return!this.hasChildren}get isDiscipline(){return this.level===1}get visible(){return pe(this.layers,e=>e.visible)}get title(){return pe(this.layers,e=>e.title)||this.layers.items.map(e=>e.title).join(", ")||null}toggleVisibility(e){const i=e===void 0?!this.visible:e;this.layers.forEach(s=>{s.visible=i}),i&&this.parent!=null&&this.parent.toggleVisibility(!0)}toggleCollapsed(e){this.collapsed=e===void 0?!this.collapsed:e}expand(){this.collapsed=!1}expandAll(){this.expand(),this.children.forEach(e=>e.expandAll())}collapse(){this.collapsed=!0}collapseAll(){this.collapse(),this.children.forEach(e=>e.collapseAll())}toggleAllSiblingsVisibility(e){const i=e===void 0?!this.visible:e;this.toggleVisibility(i),this.parent!=null&&(this.parent.toggleVisibility(i),this.parent.children.forEach(s=>s.toggleVisibility(i)))}};function pe(t,e){let i=null;for(const s of t.items){const o=e(s);if(i!=null&&i!==o)return null;i=o}return i}l([r({nonNullable:!0})],u.prototype,"id",void 0),l([r()],u.prototype,"parent",void 0),l([r({nonNullable:!0,readOnly:!0})],u.prototype,"children",void 0),l([r({nonNullable:!0,readOnly:!0})],u.prototype,"layers",void 0),l([r({nonNullable:!0})],u.prototype,"level",void 0),l([r({nonNullable:!0})],u.prototype,"collapsed",void 0),l([r({readOnly:!0})],u.prototype,"hasChildren",null),l([r({readOnly:!0})],u.prototype,"isRoot",null),l([r({readOnly:!0})],u.prototype,"isLeaf",null),l([r({readOnly:!0})],u.prototype,"isDiscipline",null),l([r({readOnly:!0})],u.prototype,"visible",null),l([r({readOnly:!0})],u.prototype,"title",null),u=l([g("esri.widgets.BuildingExplorer.support.LayerTreeNode")],u);function re(){let t=new AbortController;return async e=>{t.abort(),t=new AbortController;const i={signal:t.signal},s=e.toArray().map(o=>Je(o,i));await Promise.all(s),ve(i)}}async function Je(t,e){await t.load(e),await t.loadAll(),ve(e),t.summaryStatistics&&await t.summaryStatistics.load(e)}let M=class extends G{constructor(e){super(e),this.root=new u,this.state="disabled",this._loadLayers=re(),this.layers=new S}initialize(){this.addHandles(this.layers.on("change",()=>this._onLayersChange())),this._onLayersChange()}destroy(){this._set("state","disabled"),this.root.destroy()}set layers(e){const i=this._get("layers");this._set("layers",oe(e,i))}_updateLayerTree(){this.root.destroy(),this._set("root",new u({collapsed:!1}));const e=new Map,i=this.layers.length>1?"modelName":"id";return this.layers.forEach(s=>{const o=_e(s);this._addNodesForSublayers(o??s,this.root,e,i)}),this}_addNodeForLayer(e,i,s,o){const n=String(e[o]).toLowerCase();if(n==null||e.isEmpty)return;const h=`${i.id}/${n}`;let p=s.get(h);p||(p=new u({id:n,level:i.level+1}),s.set(h,p)),p.layers.push(e),i.children.push(p),this._addNodesForSublayers(e,p,s,o)}_addNodesForSublayers(e,i,s,o){(e.type==="building-scene"||e.type==="building-group"&&!e.isEmpty)&&e.sublayers.forEach(n=>this._addNodeForLayer(n,i,s,o))}async _onLayersChange(){if(this._set("state","loading"),this.layers.length!==0)try{await this._loadLayers(this.layers),this._updateLayerTree(),this._set("state","ready")}catch(e){le(e)||this._set("state","failed")}}};l([r({readOnly:!0})],M.prototype,"root",void 0),l([r({type:S,nonNullable:!0})],M.prototype,"layers",null),l([r({readOnly:!0,nonNullable:!0})],M.prototype,"state",void 0),M=l([g("esri.widgets.BuildingExplorer.BuildingDisciplinesViewModel")],M);const ye=M;function J(t){const e={fieldValueMap:new Map,allowedValues:[]};for(const i of t){const s=i.fieldValueMap,o=e.fieldValueMap;s.forEach((n,h)=>{o.has(h)||(o.set(h,n),e.allowedValues.push(h))})}return e.allowedValues.sort((i,s)=>i-s),e}function Ge(t){let e=null;for(const i of t)e=e!=null?Math.min(e,i):i;return e}function Xe(t){let e=null;for(const i of t)e=e!=null?Math.max(e,i):i;return e}function Q(t,e){return e.allowedValues.length>0?Ye(t,e.allowedValues):null}function Ye(t,e){if(e.length===0)return t;if(t===1/0)return e[e.length-1];if(t===-1/0)return e[0];let i=e[0],s=Math.abs(i-t);for(const o of e){const n=Math.abs(o-t);n<s&&(i=o,s=n)}return i}let c=class extends G{constructor(e){super(e),this.state="disabled",this._valueBeforeReady=null,this._domainInfo=J([]),this._loadLayers=re(),this.layers=new S}initialize(){this.addHandles(this.layers.on("change",()=>this._onLayersChange())),this._onLayersChange()}destroy(){this._set("state","disabled")}get enabled(){return this.allowedValues.length>0&&this._get("enabled")}set enabled(e){e!==this.enabled&&this.allowedValues.length>0&&this._set("enabled",e)}get value(){return(this.state==="ready"?this._get("value"):this._valueBeforeReady)??0}set value(e){if(this.state!=="ready")return void(this._valueBeforeReady=e);if(e===this.value)return;const i=Q(e,this);i!=null&&this._set("value",i)}get min(){return Ge(this.allowedValues)}get max(){return Xe(this.allowedValues)}get allowedValues(){return this._domainInfo.allowedValues}set allowedValues(e){e==null?this._clearOverride("allowedValues"):this._override("allowedValues",e);const i=Q(this.value,this);i!=null&&(this.value=i)}get hasNext(){if(!this.enabled)return!0;const e=this._valueIndex;return e>=0&&e<this.allowedValues.length-1}get hasPrevious(){return!this.enabled||this._valueIndex>0}set layers(e){const i=this._get("layers");this._set("layers",oe(e,i))}get filterExpressions(){return{solid:null,xRay:null}}get _valueIndex(){return Me(this.allowedValues,this.value)}select(e){if(this.state!=="ready")return void(this._valueBeforeReady=e);Q(e,this)!=null&&(this.enabled=!0,this.value=e)}clear(){this.state==="ready"?this.enabled=!1:this._valueBeforeReady=null}next(){const{state:e,allowedValues:i,enabled:s,hasNext:o,_valueIndex:n}=this;if(e==="ready"||this._valueBeforeReady==null){if(i.length!==0)return s?void(o&&(this.value=i[n+1])):(this.enabled=!0,void(this.value=i[0]))}else this._valueBeforeReady++}previous(){const{state:e,allowedValues:i,enabled:s,hasPrevious:o,_valueIndex:n}=this;if(e==="ready"||this._valueBeforeReady==null){if(i.length!==0)return s?void(o&&(this.value=i[n-1])):(this.enabled=!0,void(this.value=i[i.length-1]))}else this._valueBeforeReady++}getValueLabel(e){return this.layers.length===0?null:this._domainInfo.fieldValueMap.get(e)??null}async _onLayersChange(){if(this._set("state","loading"),this._domainInfo=J([]),this.layers.length!==0)try{await this._loadLayers(this.layers),this._setup()}catch(e){le(e)||this._set("state","failed")}}};l([r({value:!1,nonNullable:!0})],c.prototype,"enabled",null),l([r({nonNullable:!0})],c.prototype,"value",null),l([r({readOnly:!0})],c.prototype,"min",null),l([r({readOnly:!0})],c.prototype,"max",null),l([r()],c.prototype,"allowedValues",null),l([r({readOnly:!0})],c.prototype,"hasNext",null),l([r({readOnly:!0})],c.prototype,"hasPrevious",null),l([r({type:S,nonNullable:!0})],c.prototype,"layers",null),l([r({nonNullable:!0})],c.prototype,"state",void 0),l([r()],c.prototype,"_valueBeforeReady",void 0),l([r({readOnly:!0})],c.prototype,"_valueIndex",null),l([r()],c.prototype,"_domainInfo",void 0),c=l([g("esri.widgets.BuildingExplorer.BuildingNumericFilterViewModel")],c);const be=c,fe="__BUILDING_EXPLORER_FILTER__";function Qe(){return`${Te()}${fe}`}function ie(t){const e=typeof t=="string"?t:t.id;return!!e&&e.includes(fe)}function we(t,e){for(const i of t.items)for(const s of i.filters.items){if(!ie(s))continue;const o=e(s);if(o!=null)return o}return null}function Ze(t,e){t.forEach(i=>{const s=i.filters.filter(n=>!ie(n));e!=null&&s.push(e),et(i.filters,s)||(i.filters=s);const o=i.filters.find(n=>ie(n));i.activeFilterId=o!=null?o.id:null})}function et(t,e){const i=e.length;if(t==null||t.length!==i)return!1;for(let s=0;s<i;++s){const o=e.at(s).toJSON(),n=t.at(s).toJSON();if(o.id="",n.id="",JSON.stringify(o)!==JSON.stringify(n))return!1}return!0}function tt(t){const e=$e(t);return e?new ge({filterExpression:e,filterMode:new Ae}):null}function it(t){const e=$e(t);return e?new ge({filterExpression:e,filterMode:new Oe}):null}function $e(t){return t.filter(e=>!!e).map(e=>`(${e})`).join(" AND ")}const st="bldglevel";let W=class extends be{constructor(){super(...arguments),this._levelFieldName=null,this._parseValueFromFilter=e=>{var o;const i=new RegExp(`${this._levelFieldName}\\s*=\\s*(\\d+)`,"gi"),s=new RegExp(`${this._levelFieldName}\\s*<\\s*(\\d+)`,"gi");for(const{filterMode:n,filterExpression:h}of((o=e.filterBlocks)==null?void 0:o.items)??[]){if(h==null)continue;let p=null;if(n.type==="solid"?p=i.exec(h):n.type==="x-ray"&&(p=s.exec(h)),p)return parseInt(p[1],10)}return null}}get filterExpressions(){return this.enabled&&this._levelFieldName?{xRay:`${this._levelFieldName} < ${this.value}`,solid:`${this._levelFieldName} = ${this.value}`}:{solid:null,xRay:null}}get _firstValue(){const e=this.allowedValues;return e.length>0?e[0]:0}_setup(){const e=[];this.layers.forEach(o=>{const n=te(o,st);n!=null&&(this._levelFieldName=n.fieldName,e.push(n))}),this._domainInfo=J(e);const i=this._valueBeforeReady;this._set("state","ready"),this._valueBeforeReady=null;const s=i??we(this.layers,this._parseValueFromFilter);s!=null?this.select(s):(this.enabled=!1,this.value=this._firstValue)}};l([r({readOnly:!0})],W.prototype,"filterExpressions",null),l([r()],W.prototype,"_levelFieldName",void 0),l([r({readOnly:!0})],W.prototype,"_firstValue",null),W=l([g("esri.widgets.BuildingExplorer.BuildingLevel")],W);const Le=W,lt="demolishedphase",ot="createdphase";let N=class extends be{constructor(){super(...arguments),this._createdPhaseFieldName=null,this._demolishedPhaseFieldName=null,this._parseValueFromFilter=e=>{var h;const i=this._createdPhaseFieldName,s=new RegExp(`${i}\\s*<=\\s*(\\d+)\\s*OR\\s*${i}\\s*IS\\s*NULL`,"gi"),o=this._demolishedPhaseFieldName,n=new RegExp(`${o}\\s*>\\s*(\\d+)\\s*OR\\s*${o}\\s*IS\\s*NULL`,"gi");for(const{filterExpression:p}of((h=e.filterBlocks)==null?void 0:h.items)??[]){const A=p?s.exec(p)??n.exec(p):null;if(A)return parseInt(A[1],10)}return null}}get filterExpressions(){if(!this.enabled)return{solid:null,xRay:null};const e=[],i=this._createdPhaseFieldName;i&&e.push(`(${i} <= ${this.value} OR ${i} IS NULL)`);const s=this._demolishedPhaseFieldName;s&&e.push(`(${s} > ${this.value} OR ${s} IS NULL)`);const o=e.join(" AND ");return{solid:o,xRay:o}}get _lastValue(){const e=this.allowedValues;return e.length>0?e[e.length-1]:0}_setup(){const e=[];this.layers.forEach(s=>{const o=te(s,ot);o!=null&&(this._createdPhaseFieldName=o.fieldName,e.push(o));const n=te(s,lt);n!=null&&(this._demolishedPhaseFieldName=n.fieldName,e.push(n))}),this._domainInfo=J(e);const i=this._valueBeforeReady;if(this._set("state","ready"),this._valueBeforeReady=null,this.allowedValues.length>0){const s=i??we(this.layers,this._parseValueFromFilter);this.select(s??this._lastValue)}else this.clear()}};l([r({readOnly:!0})],N.prototype,"filterExpressions",null),l([r()],N.prototype,"_createdPhaseFieldName",void 0),l([r()],N.prototype,"_demolishedPhaseFieldName",void 0),l([r({readOnly:!0})],N.prototype,"_lastValue",null),N=l([g("esri.widgets.BuildingExplorer.BuildingPhase")],N);const xe=N;let f=class extends G{constructor(e){super(e),this.view=null,this.state="disabled",this.level=new Le,this.phase=new xe,this.disciplines=new ye,this._loadLayers=re(),this.layers=new S}initialize(){this.addHandles([this.layers.on("change",()=>this._onLayersChange()),$(()=>({state:this.state,layers:this.layers,filter:this._filter}),({state:e,layers:i,filter:s})=>{e==="ready"&&Ze(i,s)},{initial:!0})]),this._onLayersChange()}destroy(){this.level.destroyed||this.level.destroy(),this.phase.destroyed||this.phase.destroy(),this.disciplines.destroyed||this.disciplines.destroy()}get isSupported(){var e;return((e=this.view)==null?void 0:e.type)==="3d"}get layers(){return this._get("layers")}set layers(e){const i=e.filter(s=>s instanceof He);i.length!==e.length&&We.getLogger(this).error("Some layers are not BuildingSceneLayers but only BuildingSceneLayers can be passed to the widget."),this._set("layers",oe(i,this._get("layers")))}get _filter(){const e=this.level.filterExpressions,i=this.phase.filterExpressions,s=[],o=it([e.solid,i.solid]);o!=null&&s.push(o);const n=tt([e.xRay,i.xRay]);return n!=null&&s.push(n),s.length===0?null:new De({id:Qe(),name:"Building Explorer Filter",filterBlocks:s})}async _onLayersChange(){const e=this.layers;if(this.level.layers=e,this.phase.layers=e,this.disciplines.layers=e,e.length!==0){this._set("state","loading");try{await this._loadLayers(e),await Promise.all([X(()=>this.level.state==="ready"),X(()=>this.phase.state==="ready"),X(()=>this.disciplines.state==="ready")]),e.forEach(Ke),this._set("state","ready")}catch(i){le(i)||this._set("state","failed")}}else this._set("state","disabled")}};l([r({value:null})],f.prototype,"view",void 0),l([r()],f.prototype,"isSupported",null),l([r({type:S,nonNullable:!0})],f.prototype,"layers",null),l([r({readOnly:!0})],f.prototype,"state",void 0),l([r({readOnly:!0,type:Le})],f.prototype,"level",void 0),l([r({readOnly:!0,type:xe})],f.prototype,"phase",void 0),l([r({readOnly:!0,type:ye})],f.prototype,"disciplines",void 0),l([r()],f.prototype,"_filter",null),f=l([g("esri.widgets.BuildingExplorer.BuildingExplorerViewModel")],f);const Ce=f,C="esri-building-explorer",m={base:C,panelError:`${C}__panel--error`,loadingContainer:`${C}__loading-container`,content:`${C}__content`,section:`${C}__section`,levels:`${C}__levels`,phases:`${C}__phases`,disciplines:`${C}__disciplines`};var se;const rt={expand:"expand",collapse:"collapse",hideSublayer:"hideSublayer",showSublayer:"showSublayer"},b="esri-building-disciplines-tree-node",_={base:b,root:`${b}--root`,leaf:`${b}--leaf`,label:`${b}__label`,checkbox:`${b}__checkbox`,checkboxChecked:`${b}__checkbox--checked`,checkboxIndeterminate:`${b}__checkbox--indeterminate`,collapseToggle:`${b}__collapse-toggle`,collapseToggleCollapsed:`${b}__collapse-toggle--collapsed`,children:`${b}__children`,level:t=>`${b}--level-${t}`};let B=se=class extends F{constructor(t){super(t),this.messages=rt,this.toggleSiblingsVisibility=!1,this._childWidgets=[],this._updateChildWidgets=()=>{this._destroyChildWidgets(),this._childWidgets=this.node.children.toArray().reverse().map(e=>new se({node:e,messages:this.messages,toggleSiblingsVisibility:this.toggleSiblingsVisibility}))}}initialize(){this.addHandles([Ie(()=>this.node.children,"after-changes",this._updateChildWidgets,{onListenerAdd:this._updateChildWidgets,onListenerRemove:this._updateChildWidgets}),$(()=>[this.messages,this.toggleSiblingsVisibility],this._updateChildWidgets,L)])}destroy(){this._destroyChildWidgets()}render(){const t=this.node,e=t.isRoot,i=t.isLeaf;return t.isDiscipline&&i?a("div",{key:`${t.id}-empty`}):a("div",{"aria-expanded":t.collapsed?"false":"true",bind:this,class:this.classes(_.base,_.level(t.level),{[_.root]:e,[_.leaf]:i}),key:t.id,onkeydown:this._onKeydown,role:"treeitem",tabIndex:i?void 0:0},a("label",{bind:this,class:_.label,onclick:this._onCheckboxToggle},this._renderCollapseToggle(),this._renderCheckbox(),a("span",null,t.title)),this._renderChildren(t))}_renderCheckbox(){var o,n;const t=this.node.visible,e=t===!0,i=t===null,s=e?(o=this.messages)==null?void 0:o.hideSublayer:(n=this.messages)==null?void 0:n.showSublayer;return a("button",{"aria-checked":e?"true":"false","aria-label":s,bind:this,class:this.classes(_.checkbox,{[_.checkboxChecked]:e,[z.checkMark]:e,[_.checkboxIndeterminate]:i,[z.minus]:i}),onclick:this._onCheckboxToggle,role:"checkbox",title:s,type:"button"})}_renderCollapseToggle(){var i,s;if(!this.node.hasChildren)return null;const t=this.node.collapsed,e=t?(i=this.messages)==null?void 0:i.expand:(s=this.messages)==null?void 0:s.collapse;return a("div",{"aria-label":e,bind:this,class:this.classes(_.collapseToggle,z.right,{[_.collapseToggleCollapsed]:t}),onclick:this._onCollapseToggle,title:e})}_renderChildren(t){return!t.hasChildren||t.collapsed?null:a("div",{class:_.children},this._childWidgets.map(e=>e.render()))}_onKeydown(t){switch(t.key){case"Space":case"Enter":if(!t.target.classList.contains(_.base))return;t.stopPropagation(),this.node.toggleVisibility();break;case"ArrowLeft":t.stopPropagation(),this.node.toggleCollapsed(!ee(this.container));break;case"ArrowRight":t.stopPropagation(),this.node.toggleCollapsed(ee(this.container))}}_onCheckboxToggle(t){t.preventDefault(),t.stopPropagation(),(t.metaKey||t.ctrlKey)&&this.toggleSiblingsVisibility?this.node.toggleAllSiblingsVisibility():this.node.toggleVisibility()}_onCollapseToggle(t){t.preventDefault(),t.stopPropagation(),this.node.toggleCollapsed()}_destroyChildWidgets(){this._childWidgets.forEach(t=>t.destroy()),this._childWidgets=[]}};l([r({type:u})],B.prototype,"node",void 0),l([r()],B.prototype,"messages",void 0),l([r({nonNullable:!0})],B.prototype,"toggleSiblingsVisibility",void 0),l([r()],B.prototype,"_childWidgets",void 0),B=se=l([g("esri.widgets.BuildingExplorer.BuildingDisciplinesTree.BuildingDisciplinesNode")],B);const nt=B,at={expand:"expand",collapse:"collapse",hideSublayer:"hideSublayer",showSublayer:"showSublayer"},ht={base:"esri-building-disciplines-tree"};let R=class extends F{constructor(e){super(e),this.toggleSiblingsVisibility=!1}render(){const{vm:e}=this,i=this.toggleSiblingsVisibility,s=this.messages??at;return a("div",{class:ht.base,role:"tree"},e.root.children.toArray().reverse().map(o=>a(nt,{messages:s,node:o,toggleSiblingsVisibility:i})))}};l([r()],R.prototype,"vm",void 0),l([r()],R.prototype,"messages",void 0),l([r()],R.prototype,"toggleSiblingsVisibility",void 0),R=l([g("esri.widgets.BuildingExplorer.BuildingDisciplinesTree.BuildingDisciplinesTree")],R);const dt=R,Pe=30,Ve=20,ke=30,Ee=10,q=20,j=2,Se=.035,Ne=30,Be=14,Fe=80,pt=100,ut=40,ct=Object.freeze(Object.defineProperty({__proto__:null,alphaLevelDependencyFactor:ke,alphaSpreadFactor:Ee,levelHeightDefault:Be,levelHoveredExtraHeight:Pe,levelHoveredExtraWidth:Ve,levelWidthConstant:ut,levelWidthMax:Fe,levelWidthMin:Ne,levelWidthNominator:pt,levelsMarginFactor:j,levelsPadding:q,levelsPointerAdjustment:Se},Symbol.toStringTag,{value:"Module"})),P="esri-building-level-picker",V={container:P,noLevel:`${P}--no-level`,animateLevel:`${P}--animate-level`,levelsContainer:`${P}__levels-container`,innerLevelsContainer:`${P}__inner-levels-container`,labelContainer:`${P}__label-container`,arrowUp:`${P}__arrow-up`,arrowDown:`${P}__arrow-down`},D="esri-building-level-picker-label",T={base:D,active:`${D}--active`,hover:`${D}--hover`,empty:`${D}--empty`,clearButton:`${D}__clear-button`},vt={clearLevel:"",selectLevel:""};let k=class extends F{constructor(e,i){super(e,i),this.level=null,this.active=!1,this.hovering=!1,this.onClear=()=>{}}render(){const e=this.messages??vt;if(this.level==null)return a("div",{class:T.empty,title:e.selectLevel},e.selectLevel);const i=e.clearLevel;return a("div",{"aria-label":i,bind:this,class:this.classes(T.base,{[T.active]:this.active,[T.hover]:this.hovering}),onclick:this.onClear,title:i},a("span",null,this.level),a("button",{bind:this,class:this.classes(T.clearButton,z.close),disabled:!this.active,onclick:this.onClear,type:"button"}))}};l([r()],k.prototype,"level",void 0),l([r({nonNullable:!0})],k.prototype,"active",void 0),l([r({nonNullable:!0})],k.prototype,"hovering",void 0),l([r()],k.prototype,"messages",void 0),l([r({nonNullable:!0})],k.prototype,"onClear",void 0),k=l([g("esri.widgets.BuildingExplorer.BuildingLevelPicker.Label")],k);const U="esri-building-level-picker-item",K={container:U,base:`${U}__base`,hover:`${U}--hover`,active:`${U}--active`};let w=class extends F{constructor(t,e){super(t,e),this.active=!1,this.hovering=!1,this.width=0,this.height=0,this.onSelect=()=>{},this.onFocus=()=>{},this.onBlur=()=>{},this._baseElement=null}render(){return a("div",{bind:this,class:this.classes(K.container,{[K.active]:this.active,[K.hover]:this.hovering}),key:this,styles:{height:`${this.height}px`}},this._renderBase())}focus(){this._baseElement!=null&&this._baseElement.focus()}_renderBase(){const t=this.width,e=.8*this.width;return a("div",{class:K.base,styles:{width:`${Math.round(t)}px`,height:`${Math.round(t)}px`}},a("button",{afterCreate:ce,"aria-label":this.label,bind:this,class:"rect","data-node-ref":"_baseElement",onblur:this.onBlur,onclick:this.onSelect,onfocus:this.onFocus,styles:{width:`${Math.round(e)}px`,height:`${Math.round(e)}px`},tabIndex:-1,title:this.label??"",type:"button"}))}};l([r({nonNullable:!0})],w.prototype,"level",void 0),l([r({nonNullable:!0})],w.prototype,"active",void 0),l([r({nonNullable:!0})],w.prototype,"hovering",void 0),l([r({nonNullable:!0})],w.prototype,"width",void 0),l([r({nonNullable:!0})],w.prototype,"height",void 0),l([r({nonNullable:!0})],w.prototype,"onSelect",void 0),l([r({nonNullable:!0})],w.prototype,"onFocus",void 0),l([r({nonNullable:!0})],w.prototype,"onBlur",void 0),w=l([g("esri.widgets.BuildingExplorer.BuildingLevelPicker.LevelItem")],w);const Z={selectLevel:"selectLevel",clearLevel:"clearLevel",nextLevel:"nextLevel",previousLevel:"previousLevel",currentLevel:"{{value}}"};let d=class extends F{constructor(t,e){super(t,e),this._levelHandlesKey="levelHandles",this._levelEventHandlesKey="levelEventHandles",this._levelWidgets=[],this._labelWidget=new k({onClear:()=>this.vm.clear()}),this._hoveredLevel=null,this._expandedLevelsHeight=void 0,this._normalizedPointerPosition=0,this._hovering=!1,this._containerPosTop=null,this._levelsContainer=null,this._onPointerUp=()=>{var s;if((s=window.getSelection())==null||s.removeAllRanges(),this._hoveredLevel==null)return;const{vm:i}=this;i.enabled&&this._hoveredLevel===i.value?i.clear():i.select(this._hoveredLevel)},this._onPointerEnter=()=>{this._hovering||this._levelsContainer==null||(this._hovering=!0,this._containerPosTop=this._levelsContainer.getBoundingClientRect().top??0)},this._onPointerLeave=()=>{this._hovering&&(this._normalizedPointerPosition=0,this._hoveredLevel=null,this._hovering=!1)},this._onPointerMove=i=>{var s;if(!this._hovering)return!1;if((s=window.getSelection())==null||s.removeAllRanges(),this._containerPosTop!=null){const o=this._containerPosTop,n=q*j,h=this._expandedLevelsMargin;let p=this._levelsHeight,A=o+n+h;const ne=this._levelHeight/2;A+=ne,p-=ne;let ae=(i.clientY-A)/p;ae+=Se,this._normalizedPointerPosition=ae}return!1}}postInitialize(){this.addHandles([$(()=>this._levelsContainer,()=>this._onContainerChange(),L),$(()=>this._levels,()=>this._createLevelWidgets(),L),$(()=>this.messages,()=>{this._labelWidget.messages=this.messages??Z},L)])}destroy(){this._levelWidgets.forEach(t=>t.destroy()),this._labelWidget.destroy()}get _levels(){return this.vm.allowedValues}get _numLevels(){return this._levels.length}get _levelsHeight(){return Math.round(this._levelHeight*this._numLevels)}get _expandedLevelsMargin(){return Math.round(((this._expandedLevelsHeight??0)-this._levelsHeight)/2)}get _levelWidth(){const{levelWidthNominator:t,levelWidthConstant:e}=ct,i=t/Math.sqrt(this._numLevels)+e;return Math.round(de(i,Ne,Fe))}get _levelHeight(){const t=Be,e=2*t/Math.sqrt(this._numLevels);return Math.round(de(e,2,t))}get _gaussianFactor(){const t=this._numLevels;return t/Math.log(ke*t)*Ee}get _levelClosestToPointer(){if(!this._hovering)return null;const t=this._numLevels-1,e=this._normalizedPointerPosition;return t>=0&&e!=null?this._levels[Math.round((1-e)*t)]:null}render(){const t=this._levelWidgets.length,e=t>1?this._levelWidgets.map(h=>h.render()):null,i=q*j,s=-i/j,o=this._levelsHeight,n=o+2*i;return a("div",{bind:this,class:this.classes(I.widget,V.container,{[V.animateLevel]:!this._hovering,[V.noLevel]:t<2}),key:this,onkeydown:this._onKeyDown},this._renderLabelContainer(),a("div",{afterCreate:ce,bind:this,class:V.levelsContainer,"data-node-ref":"_levelsContainer",onfocus:this._onFocus,styles:{height:`${n}px`,marginTop:`${s}px`,marginBottom:`${s}px`}},a("div",{class:V.innerLevelsContainer,styles:{height:`${o}px`,margin:q-this._expandedLevelsMargin+"px 0 0 0"}},e)))}_renderLabelContainer(){const t=this.messages??Z,e=t.previousLevel,i=t.nextLevel;return a("div",{class:V.labelContainer,tabIndex:0},a("button",{"aria-label":i,bind:this,class:V.arrowUp,disabled:!this.vm.hasNext,onclick:this._onArrowUpClick,title:i,type:"button"}),this._labelWidget.render(),a("button",{"aria-label":e,bind:this,class:V.arrowDown,disabled:!this.vm.hasPrevious,onclick:this._onArrowDownClick,title:e,type:"button"}))}_updateComponents(){const t=this.messages??Z,e=this.vm.enabled?this.vm.value:null,i=this._hoveredLevel!=null?this._hoveredLevel:e;this._levelWidgets.forEach(s=>{var n;const o=this.vm.getValueLabel(s.level);s.label=o??((n=t.currentLevel)==null?void 0:n.replace("{{level}}",String(s.level))),s.active=s.level===e,s.hovering=s.level===this._hoveredLevel}),this._labelWidget.level=i,this._labelWidget.active=i===e,this._labelWidget.hovering=this._hoveredLevel!=null}_createLevelWidgets(){this._levelWidgets.forEach(t=>t.destroy()),this._levelWidgets=this._levels.map(t=>new w({level:t,onSelect:()=>this._onLevelToggle(t)})),this.removeHandles(this._levelHandlesKey),this.addHandles([$(()=>{const{vm:t}=this;return[this.messages,t==null?void 0:t.value,t==null?void 0:t.enabled,this._hoveredLevel,this._hovering]},()=>this._updateComponents(),L),$(()=>[this._normalizedPointerPosition,this._hovering],()=>this._onPointerPositionChange(),L),$(()=>this._levelWidth,t=>this._levelWidgets.forEach(e=>e.width=t),L)],this._levelHandlesKey)}_onContainerChange(){const t=this._levelsContainer;t!=null&&(this.removeHandles(this._levelEventHandlesKey),this.addHandles([H(t,"pointerenter",this._onPointerEnter),H(t,"pointerover",this._onPointerEnter),H(t,"pointerleave",this._onPointerLeave),H(t,"pointerup",this._onPointerUp),H(t,"pointermove",this._onPointerMove)],this._levelEventHandlesKey))}_onKeyDown(t){switch(t.key){case"ArrowDown":case"ArrowLeft":t.preventDefault(),t.stopPropagation(),this.vm.previous(),this._focusCurrentLevel();break;case"ArrowUp":case"ArrowRight":t.preventDefault(),t.stopPropagation(),this.vm.next(),this._focusCurrentLevel()}}_focusCurrentLevel(){const t=this._levelWidgets.find(e=>e.level===this.vm.value);t==null||t.focus()}_onFocus(){this._hoveredLevel=this._levels.length>0?this._levels[0]:null}_onLevelToggle(t){const{vm:e}=this;e.enabled&&e.value===t?e.clear():e.select(t)}_onArrowUpClick(){this.vm.next()}_onArrowDownClick(){this.vm.previous()}_onPointerPositionChange(){let t=0;this._levelWidgets.forEach((i,s)=>{const{width:o,height:n}=this._getLevelWidgetSize(s);i.height=n,i.width=o,t+=n}),this._hoveredLevel=this._levelClosestToPointer;const e=this._expandedLevelsHeight;(e==null||Math.abs(e-t)>30)&&(this._expandedLevelsHeight=t)}_getLevelWidgetSize(t){const e={width:this._levelWidth,height:this._levelHeight};if(this._hovering){const i=this._getGaussianFactor(t,this._normalizedPointerPosition);e.width+=Ve*i,e.height+=Pe*i}return e}_getGaussianFactor(t,e){const i=this._numLevels-1,s=(i-t)/i,o=this._gaussianFactor*(s-e);return Math.exp(-(o**2))}};l([r()],d.prototype,"vm",void 0),l([r()],d.prototype,"messages",void 0),l([r()],d.prototype,"_levelWidgets",void 0),l([r()],d.prototype,"_labelWidget",void 0),l([r()],d.prototype,"_hoveredLevel",void 0),l([r()],d.prototype,"_levels",null),l([r()],d.prototype,"_numLevels",null),l([r({readOnly:!0})],d.prototype,"_levelsHeight",null),l([r()],d.prototype,"_expandedLevelsHeight",void 0),l([r({readOnly:!0})],d.prototype,"_expandedLevelsMargin",null),l([r({readOnly:!0})],d.prototype,"_levelWidth",null),l([r({readOnly:!0})],d.prototype,"_levelHeight",null),l([r({readOnly:!0})],d.prototype,"_gaussianFactor",null),l([r({readOnly:!0})],d.prototype,"_levelClosestToPointer",null),l([r({type:Number,range:{min:0,max:1}})],d.prototype,"_normalizedPointerPosition",void 0),l([r()],d.prototype,"_hovering",void 0),l([r()],d.prototype,"_containerPosTop",void 0),l([r()],d.prototype,"_levelsContainer",void 0),d=l([g("esri.widgets.BuildingExplorer.BuildingLevelPicker.BuildingLevelPicker")],d);const gt=d,mt={nextPhase:"nextPhase",previousPhase:"previousPhase",currentPhase:"{{value}}"},x="esri-building-phase-picker",y={container:`${x}`,phasesContainer:`${x}__phases-container`,phase:`${x}__phase`,phaseActive:`${x}__phase--active`,phaseCurrent:`${x}__phase--current`,divider:`${x}__divider`,dividerActive:`${x}__divider--active`,arrowLeft:`${x}__arrow-left`,arrowRight:`${x}__arrow-right`};let E=class extends F{constructor(t,e){super(t,e),this._phasesContainer=null,this._shouldScrollCurrentPhaseIntoView=!0,this._shouldFocusCurrentPhase=!1,this._onKeyDown=i=>{const{vm:s}=this;switch(i.key){case"ArrowDown":case"ArrowLeft":i.stopPropagation(),i.preventDefault(),s.previous(),this._shouldFocusCurrentPhase=!0;break;case"ArrowUp":case"ArrowRight":i.stopPropagation(),i.preventDefault(),s.next(),this._shouldFocusCurrentPhase=!0}},this._onArrowLeftClick=()=>{this.vm.previous()},this._onArrowRightClick=()=>{this.vm.next()},this._onPhasesContainerAfterCreate=i=>{this._phasesContainer=i,requestAnimationFrame(this._scrollOrFocusPhase)},this._scrollOrFocusPhase=()=>{const i=this._phasesContainer;if(this.destroyed||i==null)return;const s=i.querySelector(`.${y.phaseCurrent}`);if(s){if(this._shouldScrollCurrentPhaseIntoView){const o=i.offsetWidth,n=s.offsetLeft,h=s.offsetWidth;i.scrollLeft=-o/2+n-h/2,this._shouldScrollCurrentPhaseIntoView=!1}this._shouldFocusCurrentPhase&&(s.focus(),this._shouldFocusCurrentPhase=!1)}}}initialize(){this.addHandles($(()=>[this._currentPhase,this._phasesContainer,this.container],()=>{this._shouldScrollCurrentPhaseIntoView=!0,requestAnimationFrame(this._scrollOrFocusPhase)},L))}get _phases(){return this.vm.allowedValues}get _currentPhase(){const{vm:t}=this;return t.enabled?t.value:null}render(){if(this._phases.length<2)return a("div",{key:"no-phases"});const{vm:t,container:e,messages:i}=this,{previousPhase:s,nextPhase:o}=i??mt,n=ee(e);return a("div",{class:this.classes(I.widget,y.container),key:this,onkeydown:this._onKeyDown},a("button",{"aria-label":s,class:n?y.arrowRight:y.arrowLeft,disabled:!t.hasPrevious,onclick:this._onArrowLeftClick,title:s,type:"button"}),a("div",{afterCreate:this._onPhasesContainerAfterCreate,class:y.phasesContainer},this._renderPhaseButtons()),a("button",{"aria-label":o,class:n?y.arrowLeft:y.arrowRight,disabled:!t.hasNext,onclick:this._onArrowRightClick,title:o,type:"button"}))}_renderPhaseButtons(){const t=this._phases,e=this._currentPhase,i=[];for(let s=0;s<t.length;++s){const o=t[s],n={phase:o,active:e!=null&&o<=e,current:e!=null&&o===e};s>0&&i.push(this._renderDivider(n)),i.push(this._renderPhaseButton(n))}return i}_renderPhaseButton({phase:t,active:e,current:i}){const{vm:s}=this,o=s.getValueLabel(t);return a("button",{"aria-label":o,class:this.classes(y.phase,{[y.phaseActive]:e,[y.phaseCurrent]:i}),key:`phase-${t}`,onclick:()=>s.select(t),title:o,type:"button"},t)}_renderDivider({phase:t,active:e}){return a("div",{class:this.classes(y.divider,{[y.dividerActive]:e}),key:`phase-divider-${t}`})}};l([r({nonNullable:!0})],E.prototype,"vm",void 0),l([r()],E.prototype,"messages",void 0),l([r()],E.prototype,"_phases",null),l([r()],E.prototype,"_currentPhase",null),l([r()],E.prototype,"_phasesContainer",void 0),E=l([g("esri.widgets.BuildingExplorer.BuildingPhasePicker.BuildingPhasePicker")],E);const _t=E,ue={levels:!0,phases:!0,disciplines:!0};let v=class extends F{constructor(t,e){super(t,e),this._defaultViewModel=new Ce,this.viewModel=this._defaultViewModel,this.visibleElements={...ue},this.headingLevel=3,this.messages=null,this.messagesCommon=null,this.toggleSiblingsVisibility=!1}destroy(){this.viewModel!==this._defaultViewModel&&this._defaultViewModel.destroy()}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}get layers(){return this.viewModel.layers}set layers(t){this.viewModel.layers=t}_castVisibleElements(t){return{...ue,...t}}get icon(){return"organization"}set icon(t){this._overrideIfSome("icon",t)}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}render(){const t=this.viewModel,e=t.state==="disabled"||!t.isSupported;return a("div",{"aria-label":this.messages.widgetLabel,class:O(I.widget,m.base,I.panel,{[I.widgetDisabled]:e}),key:this},this._renderContent())}_renderContent(){const t=this.viewModel,e=this.messages;if(!t.isSupported)return a("p",{class:m.panelError},e.unsupported);if(!t.layers.length)return a("p",{class:m.panelError},e.noData);switch(t.state){case"loading":return this._renderLoadingIndicator();case"ready":return a("div",{class:m.content,key:"content"},this._renderLevelPickerSection(),this._renderPhasePickerSection(),this._renderDisciplinesSection());case"failed":return a("p",{class:m.panelError},e.failed);default:return null}}_renderLoadingIndicator(){const t=this.messagesCommon.loading;return a("div",{"aria-label":t,class:m.loadingContainer,key:"loading-container",role:"presentation",title:t},a("span",{"aria-hidden":"true",class:O(z.loadingIndicator,I.rotating)}))}_renderLevelPickerSection(){var o;const t=this.viewModel.level,e=t.state==="ready",i=t.allowedValues.length>1;if(!this.visibleElements.levels||!e||!i)return null;const s=(o=this.messages)==null?void 0:o.level;return a("div",{class:O(m.section,m.levels),key:"levels"},a(Y,{level:this.headingLevel},s==null?void 0:s.title),a(gt,{messages:s,vm:t}))}_renderPhasePickerSection(){const t=this.viewModel.phase,e=t.state==="ready",i=t.allowedValues.length>1;if(!this.visibleElements.phases||!e||!i)return null;const s=this.messages.phase;return a("div",{class:O(m.section,m.phases),key:"phases"},a(Y,{level:this.headingLevel},s.title),a(_t,{messages:s,vm:t}))}_renderDisciplinesSection(){var o;const t=this.viewModel.disciplines,e=t.state==="ready",i=t.root.hasChildren;if(!this.visibleElements.disciplines||!e||!i)return null;const s=(o=this.messages)==null?void 0:o.disciplines;return a("div",{class:O(m.section,m.disciplines),key:"disciplines"},a(Y,{level:this.headingLevel},s.title),a(dt,{messages:s,toggleSiblingsVisibility:this.toggleSiblingsVisibility,vm:t}))}};l([r({type:Ce})],v.prototype,"viewModel",void 0),l([r()],v.prototype,"view",null),l([r()],v.prototype,"layers",null),l([r()],v.prototype,"visibleElements",void 0),l([Re("visibleElements")],v.prototype,"_castVisibleElements",null),l([r()],v.prototype,"headingLevel",void 0),l([r()],v.prototype,"icon",null),l([r()],v.prototype,"label",null),l([r(),he("esri/widgets/BuildingExplorer/t9n/BuildingExplorer")],v.prototype,"messages",void 0),l([r(),he("esri/t9n/common")],v.prototype,"messagesCommon",void 0),l([r({nonNullable:!0})],v.prototype,"toggleSiblingsVisibility",void 0),l([r()],v.prototype,"uiStrings",void 0),v=l([g("esri.widgets.BuildingExplorer")],v);const Gl=v;export{Gl as default};
