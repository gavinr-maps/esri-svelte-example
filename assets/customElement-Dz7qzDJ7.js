import{L as B,c as l,x as s,i as F,a as N}from"./index-4eY77cms.js";import{e as u,n as m}from"./ref-D9wHsL_T.js";import"./directive-helpers-DaBykg1t.js";/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.32/esri/copyright.txt for details.
v4.32.12 */const M=F`:host{display:none;background:#bdf2c4}:host([selected]){display:flex}calcite-block{margin-block:0}calcite-pagination{justify-content:center}`,o=class o extends B{constructor(){super(...arguments),this._filterInputElement=u(),this._flowItemElement=u(),this.currentPage=1,this.selected=!1,this.showBackButton=!1,this.arcgisGetVersions=l(),this.arcgisManageVersion=l(),this.arcgisNewVersion=l()}load(){this._filteredVersionInfos=this.versionListElementProps.versionInfos}willUpdate(e){if(e.has("versionListElementProps")){const i=e.get("versionListElementProps"),t=this.versionListElementProps;(i==null?void 0:i.versionInfos)!==t.versionInfos&&(this._filteredVersionInfos=t.versionInfos,this._filterInputElement.value&&this._handleFilterChange())}}updated(){var e;(e=this._filterInputElement.value)==null||e.setFocus()}async setFocus(){var e;(e=this._flowItemElement.value)==null||e.setFocus()}goBack(){}_handleFilterChange(){const{versionListElementProps:{versionInfos:e}}=this,i=this._filterInputElement.value.value.toUpperCase();this._filteredVersionInfos=i===""?e:e.filter(t=>t.versionIdentifier.name.toUpperCase().includes(i)||t.versionIdentifier.guid.toUpperCase().includes(i)),this._filteredVersionInfos.length&&(this.currentPage=1)}_handleNoticeClosed(){this.versionListElementProps={...this.versionListElementProps,executionError:void 0}}_handlePaginationChange(e){this.currentPage=e.target.startItem}_getExecutionError(e){const{versionListElementProps:{strings:{executionErrors:i}}}=this;switch(e){case"no-advanced-editing-user-type-extension":return i.noAdvancedEditingUserTypeExtension;case"no-feature-service-found":return i.noFeatureServiceFound;case"no-valid-enterprise-version":return i.notValidEnterpriseVersion;case"no-valid-version-name":return i.invalidVersionName;default:return e}}_paginate(e,i,t){return e.slice((t-1)*i,t*i)}render(){const{currentPage:e,selected:i,showBackButton:t,versionListElementProps:{closable:v,currentUser:V,currentVersionIdentifier:h,executionError:d,hasAdvEditingUte:g,heading:I,isVersionAdministrator:$,isVersioningApiAvailable:f,pageSize:r,serviceName:E,serviceUrl:a,state:_,strings:{headers:p},strings:n,versionInfos:x}}=this,b=s`<calcite-block .heading=${p.currentVersion} .description=${h.name} overlay-positioning=fixed></calcite-block>`,P=s`<calcite-action id=actionRefreshVersions icon=refresh text @click=${()=>{this.arcgisGetVersions.emit({serviceUrl:a})}} slot=header-actions-end><calcite-tooltip overlay-positioning=fixed reference-element=actionRefreshVersions><span>${n.actions.refreshVersions}</span></calcite-tooltip></calcite-action>`;this._paginatedVersionInfos=this._filteredVersionInfos.length>r?this._paginate(this._filteredVersionInfos,r,e):this._filteredVersionInfos;const w=this._filteredVersionInfos.length>r?s`<calcite-pagination @calcitePaginationChange=${this._handlePaginationChange} page-size=1 .startItem=${e} .totalItems=${Math.ceil(this._filteredVersionInfos.length/r)}></calcite-pagination>`:void 0,k=this._paginate(this._paginatedVersionInfos,r,1).map(y=>s`<arcgis-version-management-version-item .versionItemElementProps=${{currentUser:V,currentVersionIdentifier:h,isCurrentVersionCard:!1,hasAdvEditingUte:g,isVersionAdministrator:$,isVersioningApiAvailable:f,serviceUrl:a,strings:n,versionInfo:y}}></arcgis-version-management-version-item>`),C=x.length>r?s`<calcite-block heading .label=${p.filterVersions} open><calcite-input-text clearable icon=search @calciteInputTextInput=${this._handleFilterChange} .placeholder=${n.actions.searchVersions} ${m(this._filterInputElement)}></calcite-input-text></calcite-block>`:void 0,L=s`<calcite-list .label=${n.headers.manageVersions}>${k}</calcite-list>`,U=f&&g?s`<calcite-fab appearance=outline-fill slot=fab text-enabled .text=${n.actions.newVersion} @click=${()=>{this.arcgisNewVersion.emit({serviceUrl:a})}}></calcite-fab>`:void 0,A=d?s`<calcite-notice @calciteNoticeClose=${this._handleNoticeClosed} class="notice" closable kind=warning open scale=s slot=footer width=full><div slot=message>${this._getExecutionError(d)}</div></calcite-notice>`:void 0;return s`<calcite-flow-item .closable=${v} .description=${E} .heading=${I} .selected=${i} .showBackButton=${t} ${m(this._flowItemElement)}><calcite-panel .loading=${_==="executing"}>${b}<calcite-panel .heading=${this._filteredVersionInfos.length?`${n.headers.manageVersions} (${this._filteredVersionInfos.length})`:n.headers.manageVersions}>${P}${C}${L}${U}</calcite-panel>${w}${A}</calcite-panel></calcite-flow-item>`}};o.properties={_filteredVersionInfos:16,currentPage:11,selected:7,showBackButton:7,versionListElementProps:0},o.styles=M;let c=o;N("arcgis-version-management-version-list",c);export{c as ArcgisVersionManagementVersionList};
