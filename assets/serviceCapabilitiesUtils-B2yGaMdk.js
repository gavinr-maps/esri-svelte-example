import{M as C}from"./Accessor-BmwT4B0c.js";import{g as v,d as h}from"./cast-CsZslgGN.js";import{d as S}from"./infoFor3D-C7tb3HsI.js";function t(e,s,r){return!!m(e,s,r)}function l(e,s,r){return m(e,s,r)}function m(e,s,r){return e&&e.hasOwnProperty(s)?e[s]:r}const A={name:"supportsName",size:"supportsSize",contentType:"supportsContentType",keywords:"supportsKeywords",exifInfo:"supportsExifInfo"};function Q(e){var r;const s=(r=e==null?void 0:e.supportedSpatialAggregationStatistics)==null?void 0:r.map(p=>p.toLowerCase());return{envelope:!!(s!=null&&s.includes("envelopeaggregate")),centroid:!!(s!=null&&s.includes("centroidaggregate")),convexHull:!!(s!=null&&s.includes("convexhullaggregate"))}}function c(e,s){var p;const r=(p=e==null?void 0:e.supportedOperationsWithCacheHint)==null?void 0:p.map(o=>o.toLowerCase());return!!(r!=null&&r.includes(s.toLowerCase()))}function R(e){var r;const s=(r=e==null?void 0:e.supportedStatisticTypes)==null?void 0:r.map(p=>p.toLowerCase());return{count:!!(s!=null&&s.includes("count")),sum:!!(s!=null&&s.includes("sum")),min:!!(s!=null&&s.includes("min")),max:!!(s!=null&&s.includes("max")),avg:!!(s!=null&&s.includes("avg")),var:!!(s!=null&&s.includes("var")),stddev:!!(s!=null&&s.includes("stddev")),percentileContinuous:!!(s!=null&&s.includes("percentile_continuous")),percentileDiscrete:!!(s!=null&&s.includes("percentile_discrete")),envelope:!!(s!=null&&s.includes("envelopeaggregate")),centroid:!!(s!=null&&s.includes("centroidaggregate")),convexHull:!!(s!=null&&s.includes("convexhullaggregate"))}}function x(e){var r;const s=(r=e==null?void 0:e.supportedNormalizationTypes)==null?void 0:r.map(p=>p.toLowerCase());return{field:!!(s!=null&&s.includes("field")),log:!!(s!=null&&s.includes("log")),naturalLog:!!(s!=null&&s.includes("naturallog")),percentOfTotal:!!(s!=null&&s.includes("percentoftotal")),squareRoot:!!(s!=null&&s.includes("squareroot"))}}function P(e,s){return{analytics:F(e),attachment:B(e),data:T(e),metadata:D(e),operations:w(e.capabilities,e,s),query:E(e,s),queryAttributeBins:b(e),queryRelated:z(e),queryTopFeatures:M(e),editing:I(e)}}function F(e){return{supportsCacheHint:c(e.advancedQueryCapabilities,"queryAnalytics")}}function B(e){const s=e.attachmentProperties,r={supportsName:!1,supportsSize:!1,supportsContentType:!1,supportsKeywords:!1,supportsExifInfo:!1,supportsCacheHint:c(e.advancedQueryCapabilities,"queryAttachments"),supportsOrderByFields:t(e.advancedQueryCapabilities,"supportsQueryAttachmentOrderByFields",!1),supportsResize:t(e,"supportsAttachmentsResizing",!1)};return s&&Array.isArray(s)&&s.forEach(p=>{const o=A[p.name];o&&(r[o]=!!p.isEnabled)}),r}function T(e){return{isVersioned:t(e,"isDataVersioned",!1),isBranchVersioned:t(e,"isDataBranchVersioned",!1),supportsAttachment:t(e,"hasAttachments",!1),supportsM:t(e,"hasM",!1),supportsZ:t(e,"hasZ",!1)}}function D(e){return{supportsAdvancedFieldProperties:t(e,"supportsFieldDescriptionProperty",!1)}}function w(e,s,r){const p=e?e.toLowerCase().split(",").map(g=>g.trim()):[],o=r?h(r):null,f=p.includes(o!=null&&o.serverType==="MapServer"?"data":"query"),a=p.includes("editing")&&!s.datesInUnknownTimezone;let u=a&&p.includes("create"),n=a&&p.includes("delete"),i=a&&p.includes("update");const y=p.includes("changetracking"),d=s.advancedQueryCapabilities;return a&&!(u||n||i)&&(u=n=i=!0),{supportsCalculate:t(s,"supportsCalculate",!1),supportsTruncate:t(s,"supportsTruncate",!1),supportsValidateSql:t(s,"supportsValidateSql",!1),supportsAdd:u,supportsDelete:n,supportsEditing:a,supportsChangeTracking:y,supportsQuery:f,supportsQueryAnalytics:t(d,"supportsQueryAnalytic",!1),supportsQueryAttachments:t(d,"supportsQueryAttachments",!1),supportsQueryBins:t(d,"supportsQueryBins",!1),supportsQueryTopFeatures:t(d,"supportsTopFeaturesQuery",!1),supportsResizeAttachments:t(s,"supportsAttachmentsResizing",!1),supportsSync:p.includes("sync"),supportsUpdate:i,supportsExceedsLimitStatistics:t(s,"supportsExceedsLimitStatistics",!1),supportsAsyncConvert3D:t(s,"supportsAsyncConvert3D",!1)}}function E(e,s){const r=e.advancedQueryCapabilities,p=e.ownershipBasedAccessControlForFeatures,o=e.archivingInfo,f=e.currentVersion,a=s==null?void 0:s.includes("MapServer"),u=!a||f>=C("mapserver-pbf-version-support"),n=v(s),i=new Set((e.supportedQueryFormats??"").split(",").map(y=>y.toLowerCase().trim()));return{maxRecordCount:l(e,"maxRecordCount",void 0),maxRecordCountFactor:l(e,"maxRecordCountFactor",void 0),standardMaxRecordCount:l(e,"standardMaxRecordCount",void 0),supportedSpatialAggregationStatistics:Q(r),supportsCacheHint:t(r,"supportsQueryWithCacheHint",!1)||c(r,"query"),supportsCentroid:t(r,"supportsReturningGeometryCentroid",!1),supportsCompactGeometry:n,supportsCurrentUser:t(r,"supportsCurrentUserQueries",!1),supportsDefaultSpatialReference:t(r,"supportsDefaultSR",!1),supportsDisjointSpatialRelationship:t(r,"supportsDisjointSpatialRel",!1),supportsDistance:t(r,"supportsQueryWithDistance",!1),supportsDistinct:t(r,"supportsDistinct",e.supportsAdvancedQueries),supportsExtent:t(r,"supportsReturningQueryExtent",!1),supportsFormatPBF:u&&i.has("pbf"),supportsFullTextSearch:t(r,"supportsFullTextSearch",!1),supportsGeometryProperties:t(r,"supportsReturningGeometryProperties",!1),supportsHavingClause:t(r,"supportsHavingClause",!1),supportsHistoricMoment:t(o,"supportsQueryWithHistoricMoment",!1),supportsMaxRecordCountFactor:t(r,"supportsMaxRecordCountFactor",!1),supportsOrderBy:t(r,"supportsOrderBy",e.supportsAdvancedQueries),supportsPagination:t(r,"supportsPagination",!1),supportsPercentileStatistics:t(r,"supportsPercentileStatistics",!1),supportsQuantization:t(e,"supportsCoordinatesQuantization",!1),supportsQuantizationEditMode:t(e,"supportsQuantizationEditMode",!1),supportsQueryByAnonymous:t(p,"allowAnonymousToQuery",!0),supportsQueryByOthers:t(p,"allowOthersToQuery",!0),supportsQueryGeometry:t(e,"supportsReturningQueryGeometry",!1),supportsResultType:t(r,"supportsQueryWithResultType",!1),supportsReturnMesh:!!S(e.infoFor3D),supportsSpatialAggregationStatistics:t(r,"supportsSpatialAggregationStatistics",!1),supportsSqlExpression:t(r,"supportsSqlExpression",!1),supportsStandardizedQueriesOnly:t(e,"useStandardizedQueries",!1),supportsStatistics:t(r,"supportsStatistics",e.supportsStatistics),supportsTopFeaturesQuery:t(r,"supportsTopFeaturesQuery",!1),supportsTrueCurve:t(r,"supportsTrueCurve",!1),tileMaxRecordCount:l(e,"tileMaxRecordCount",void 0)}}function z(e){const s=e.advancedQueryCapabilities,r=t(s,"supportsAdvancedQueryRelated",!1);return{supportsPagination:t(s,"supportsQueryRelatedPagination",!1),supportsCount:r,supportsOrderBy:r,supportsCacheHint:c(s,"queryRelated")}}function M(e){return{supportsCacheHint:c(e.advancedQueryCapabilities,"queryTopFilter")}}function b(e){const s=e?e.queryBinsCapabilities:void 0;return{supportsDate:t(s,"supportsDateBin",!1),supportsFixedInterval:t(s,"supportsFixedIntervalBin",!1),supportsAutoInterval:t(s,"supportsAutoIntervalBin",!1),supportsFixedBoundaries:t(s,"supportsFixedBoundariesBin",!1),supportsStackBy:t(s,"supportsStackBy",!1),supportsSplitBy:t(s,"supportsSplitBy",!1),supportsSnapToData:t(s,"supportsSnapToData",!1),supportsReturnFullIntervalBin:t(s,"supportsReturnFullIntervalBin",!1),supportsFirstDayOfWeek:t(s,"supportsFirstDayOfWeek",!1),supportsNormalization:t(s,"supportsNormalization",!1),supportedStatistics:R(s),supportedNormalizationTypes:x(s)}}function I(e){const s=e.ownershipBasedAccessControlForFeatures,r=e?e.advancedEditingCapabilities:void 0;return{supportsGeometryUpdate:t(e,"allowGeometryUpdates",!0),supportsGlobalId:t(e,"supportsApplyEditsWithGlobalIds",!1),supportsReturnServiceEditsInSourceSpatialReference:t(e,"supportsReturnServiceEditsInSourceSR",!1),supportsRollbackOnFailure:t(e,"supportsRollbackOnFailureParameter",!1),supportsUpdateWithoutM:t(e,"allowUpdateWithoutMValues",!1),supportsUploadWithItemId:t(e,"supportsAttachmentsByUploadId",!1),supportsDeleteByAnonymous:t(s,"allowAnonymousToDelete",!0),supportsDeleteByOthers:t(s,"allowOthersToDelete",!0),supportsUpdateByAnonymous:t(s,"allowAnonymousToUpdate",!0),supportsUpdateByOthers:t(s,"allowOthersToUpdate",!0),supportsAsyncApplyEdits:t(r,"supportsAsyncApplyEdits",!1),zDefault:l(e,"zDefault",void 0)}}function H(e){var s;return{operations:{supportsAppend:t(e,"supportsAppend",!1),supportsCoverageQuery:((s=e==null?void 0:e.playbackInfo)==null?void 0:s.klv["0601"])??!1,supportsExportClip:t(e,"supportsExportClip",!1),supportsExportFrameset:t(e,"supportsExportFrameset",!1),supportsMensuration:t(e,"supportsMensuration",!1),supportsUpdate:t(e,"supportsUpdate",!1)}}}export{H as A,P as c,t as n,l as r};
