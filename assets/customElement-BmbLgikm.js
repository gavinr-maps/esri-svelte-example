const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-CtvJE4Qe.js","./jsxFactory-Cnml7uXM.js","./Accessor-BmwT4B0c.js","./intl-Duiy0OzY.js","./Promise-DfET-uns.js","./cast-CsZslgGN.js","./index-4eY77cms.js","./index-Cx51aysm.css","./JSONSupport-DcrLLGjL.js","./Evented-Dw4_VOGn.js","./reactiveUtils-XM7cS2OP.js","./SimpleObservable-CvOkykwM.js","./uuid-Cl5lrJ4c.js","./ref-D9wHsL_T.js","./directive-helpers-DaBykg1t.js","./dom-DEluURzl.js","./guid-ejniuQmw.js","./form-BzoUrXC7.js","./interactive-DTzfFku4.js","./key-CZcQa38B.js","./label-CHHpnzD0.js","./loadable-XBvaWFYY.js","./index--OBudxYA.js","./index-CkWlzxRO.js","./index-CwGfEOCA.js","./index-DwIhxbHs.js","./observers-Co4E8E8j.js","./keyed-CU1C-h1n.js","./component-CBVlbUuE.js","./index-Dd_Yvsgp.js","./index-CMxz6F2k.js","./useT9n-C1Hrfc-A.js","./index-jjUP6Yam.js","./static-DLD4WjLv.js","./index-BPm91e5Z.js"])))=>i.map(i=>d[i]);
import{_ as x,L as Ie,u as Ae,c as He,n as We,i as Te,a as ze}from"./index-4eY77cms.js";import{g as Y,r as l,m as r,a as m,D as ye,E as re,aJ as Ue,B as Ke,at as A}from"./Accessor-BmwT4B0c.js";import{a as qe}from"./cast-CsZslgGN.js";import{O as D,c as O,n as a,y as je,g as Je,v as U,e as he}from"./jsxFactory-Cnml7uXM.js";import{V as k,d as w,P as L,w as Z}from"./reactiveUtils-XM7cS2OP.js";import{n as oe}from"./collectionUtils-CTT-51g7.js";import{c as fe,p as Ge,i as Xe,$ as Ye,f as Ze}from"./BuildingSceneLayer-DSw1aB6o.js";import{n as Qe}from"./uuid-Cl5lrJ4c.js";import{r as de}from"./mathUtils-Cfq9PL9W.js";import{e as T}from"./globalCss-vQlnDsEX.js";import{e as Q}from"./Heading-BcR6CGTM.js";import{P as et}from"./useWidget-BajufX8l.js";import"./JSONSupport-DcrLLGjL.js";import"./intl-Duiy0OzY.js";import"./Promise-DfET-uns.js";import"./Evented-Dw4_VOGn.js";import"./SimpleObservable-CvOkykwM.js";import"./CollectionFlattener-U8hHQmGf.js";import"./loadAll-D1eTJ7uv.js";import"./Portal-CmmHxpLg.js";import"./writer-DKgfqj4X.js";import"./Extent-g5W9hy0j.js";import"./Point-Cz2JYYmX.js";import"./MultiOriginJSONSupport-DbmrbwMa.js";import"./Layer-DH4_Pn8a.js";import"./Identifiable-BHVfzH03.js";import"./TimeExtent-BO6BsF_x.js";import"./timeUtils-C1c_L2Fd.js";import"./BuildingComponentSublayer-C_pZIhA8.js";import"./Graphic-Dt0LgVGU.js";import"./Clonable-Z-AWS-16.js";import"./opacityUtils-Dim20wpZ.js";import"./enumeration-DpvDkLNI.js";import"./Color-VJEMvW-n.js";import"./colorUtils-Rxh2V3ai.js";import"./ActionToggle-D7439N1A.js";import"./jsonUtils-CwFG8yN4.js";import"./Polyline-s-JzsQqo.js";import"./typeUtils-B6WBEKDM.js";import"./TextSymbol-BLIQ6RKX.js";import"./screenUtils-_ZIvrt5o.js";import"./vec3f64-BLpZdpfb.js";import"./aaBoundingBox-Dw3yBk2f.js";import"./FeatureLayer-U46cmps3.js";import"./layerContainerType-C5CzMsLd.js";import"./FeatureLayerBase-C4QQJYE9.js";import"./formUtils-l8pvwous.js";import"./Field-BDG0QV_T.js";import"./fieldType-CBeoJWlv.js";import"./HeightModelInfo-C05IFsWs.js";import"./commonProperties-B0GHoNP5.js";import"./ElevationInfo-BPOqhCue.js";import"./unitConversionUtils-rg07EgOm.js";import"./lengthUtils-_77UiyVF.js";import"./AttributeTableTemplate-cR37sM72.js";import"./timeZoneUtils-DxzjpEBb.js";import"./featureLayerUtils-Btb8HY8h.js";import"./featureQueryAll-JpNZKIBO.js";import"./Query-B_2mhyL4.js";import"./FullTextSearch-CBnxSwz4.js";import"./layerUtils-B__v9OBu.js";import"./SimpleRenderer-CEw_geZx.js";import"./commonProperties-ZfGquLPI.js";import"./colorRamps-CRjjPL3r.js";import"./SizeVariable-B-ghFm6e.js";import"./visualVariableUtils-Xcorldoo.js";import"./ColorStop-BYiAUa8d.js";import"./jsonUtils-B-voMz-i.js";import"./defaults-FkBa0ybj.js";import"./defaultsJSON-GKolV7NZ.js";import"./UniqueValueRenderer-yoWHKJ_P.js";import"./diffUtils-BanfihCO.js";import"./RendererLegendOptions-CYAPr8D6.js";import"./styleUtils-ColFrJ-Z.js";import"./AttachmentQuery-CpEmJqq-.js";import"./NormalizationBinParametersMixin-CZD0XfhN.js";import"./RelationshipQuery-B5a-mYy7.js";import"./LayerFloorInfo-iCgtHY6f.js";import"./Relationship-CTbzI1Kb.js";import"./serviceCapabilitiesUtils-B2yGaMdk.js";import"./infoFor3D-C7tb3HsI.js";import"./workers-Cds_sd9m.js";import"./Queue-BQesTh_6.js";import"./editsZScale-LI19I1vI.js";import"./queryZScale-BdW_vUm_.js";import"./projection-CyCZAIaD.js";import"./projectBuffer-CQnuEMuP.js";import"./geodesicConstants-RQL9oKdk.js";import"./FeatureSet-B5-Veyin.js";import"./APIKeyMixin-3z69J1h4.js";import"./ArcGISService-CDyDWGI0.js";import"./ScaleRangeLayer-Cnzwr9PT.js";import"./jsonUtils-DZz5FrgB.js";import"./utils-DYurMneM.js";import"./mat4f32-DcsiF_Rp.js";import"./mat4-Fi6iAz29.js";import"./common-DQOJ18NT.js";import"./CustomParametersMixin-Be7WOSEG.js";import"./DisplayFilteredLayer-CzliK74b.js";import"./scaleUtils-DPfHG2g0.js";import"./displayFilterUtils-uKPOP7_-.js";import"./EditBusLayer-KXo-LY9o.js";import"./FeatureEffectLayer-BZmannck.js";import"./FeatureEffect-DZgZP6Sj.js";import"./FeatureFilter-Ca1n-g_b.js";import"./FeatureReductionLayer-B6VhUfZv.js";import"./FeatureReductionSelection-BJWsAyix.js";import"./labelingInfo-BgG6IH9B.js";import"./labelUtils-DCpQ7n-8.js";import"./jsonUtils-BZp85R7u.js";import"./typeUtils-B3iPBwJ2.js";import"./ClassBreaksRenderer-C7fhua2J.js";import"./LRUCache-CXiGQWMN.js";import"./MemCache-CmojB_Z1.js";import"./Version-Cd3TlGH0.js";import"./FieldsIndex-FW1AMU67.js";import"./utils-UPZJIDfz.js";import"./defaultCIMValues-Bb-CUowV.js";import"./enums-BTM-fOHQ.js";import"./HeatmapColorStop-CHbSyb1s.js";import"./heatmapUtils-Cyq-bAyG.js";import"./vec42-YcqnINSP.js";import"./vec4f64-o2zAXfmz.js";import"./MD5-C9MwAd2G.js";import"./OperationalLayer-B__lrMRq.js";import"./OrderedLayer-ucEg87Tu.js";import"./OrderByInfo-KsusEmpW.js";import"./PortalLayer-Cqwv_mmr.js";import"./PortalItem-CTx1kJsR.js";import"./portalItemUtils-ByOtbGao.js";import"./RefreshableLayer-C90FXoHt.js";import"./TemporalLayer-CMqBosxi.js";import"./TimeInfo-CctegBed.js";import"./TimeInterval-B7L-CEq7.js";import"./TrackableLayer-DaYHUnrc.js";import"./FeatureTemplate-Dh5_oWTV.js";import"./FeatureType-DhERcdEP.js";import"./fieldProperties-DDN0PSrH.js";import"./TitleCreator-DIyQ9Yy3.js";import"./versionUtils-BfhafDf-.js";import"./styleUtils-Bye9ft1s.js";import"./popupUtils-CmsUVJA0.js";import"./interfaces-CL2NbQte.js";import"./capabilities-B4c8vV3b.js";import"./I3SIndexInfo-CtHVwWKN.js";import"./I3SLayerDefinitions-F93A6ZIl.js";import"./I3SUtil-BD55sujO.js";import"./mat4f64-Dk4dwAN8.js";import"./vec32-Dvg_eL9J.js";import"./projectVectorToVector-CCOy_B5J.js";import"./projectPointToVector-BoxjK-qy.js";import"./sphere-Cin5efBj.js";import"./mat3-CR8GKnhD.js";import"./mat3f64-BBpwCtoL.js";import"./plane-CpXmOyqq.js";import"./quatf64-CCm9z-pX.js";import"./vec2f64-Dy6m9Nrb.js";import"./mathUtils-BgCEaV43.js";import"./I3SBinaryReader-DxrJbUZw.js";import"./VertexAttribute-Cq4MnHjR.js";import"./computeTranslationToOriginAndRotation-DYUrDrjE.js";import"./edgeUtils-D0U-z06n.js";import"./floatRGBA-Cb__GiDF.js";import"./NormalAttribute.glsl-0GHNIsQf.js";import"./glsl-BH37Aalp.js";import"./Matrix3PassUniform-uCCQMnlP.js";import"./BindType-BBwFZqyN.js";import"./RgbaFloatEncoding.glsl-_io2eW3M.js";import"./Float4DrawUniform-Db0CLl_z.js";import"./Matrix3DrawUniform-DD7AqlIc.js";import"./orientedBoundingBox-B17G_yFO.js";import"./quat-CP7JhygC.js";import"./spatialReferenceEllipsoidUtils-DBqQpPRa.js";import"./ViewingMode-Dodu7ZZk.js";import"./Attribute-DGhdp5lO.js";import"./layerViewUtils-Bevty3Jm.js";import"./popupUtils-CY6-CisY.js";import"./BuildingGroupSublayer-e_mbCmSO.js";import"./SceneService-2h8a2pP7.js";import"./originUtils-D69mHv66.js";import"./multiOriginJSONSupportUtils-C0wm8_Yw.js";import"./jsonContext-Ctyl6VtL.js";import"./resourceUtils-DLwJDPjK.js";import"./resourceUtils-B0t9BqfX.js";import"./saveUtils-D2cY3Oni.js";import"./associatedFeatureServiceUtils-BqJqfohX.js";import"./elevationInfoUtils-D26wVF2d.js";import"./index-C5b9dHRB.js";import"./component-utils-D0ciaaZ_.js";const tt="overview",be=t=>e=>{const i=t.toLowerCase();return e.sublayers.find(s=>{var o;return((o=s.modelName)==null?void 0:o.toLowerCase())===i})??null},we=be("fullmodel"),it=be(tt);function st(t){const e=we(t);e!=null&&(e.visible=!0);const i=it(t);i!=null&&(i.visible=!1)}function ie(t,e){const i=rt(t,e);if(i==null)return null;const s=i.fieldName;if(s==null||!s)return null;const o=lt(t,s),n=new Map;for(const h of i.mostFrequentValues??[])typeof h=="number"&&n.set(h,o!=null?o.getName(h):String(h));return{fieldName:s,fieldValueMap:n}}function lt(t,e){var i;for(const s of t.allSublayers.items){const o=s.type==="building-component"?(i=s.getFieldDomain)==null?void 0:i.call(s,e):null;if(o&&o.type==="coded-value")return o}return null}function rt(t,e){var o;const i=((o=t.summaryStatistics)==null?void 0:o.fields)??[],s=e.toLowerCase();return i.find(n=>{var h;return((h=n.modelName)==null?void 0:h.toLowerCase())===s})??null}let v=class extends Y{constructor(e){super(e),this.id="root",this.parent=null,this.children=new k,this.layers=new k,this.level=0,this._childIds=new Set,this._layerUniqueIds=new Set}initialize(){this.addHandles([this.layers.on("before-add",e=>{this._layerUniqueIds.has(e.item.uid)?e.preventDefault():this._layerUniqueIds.add(e.item.uid)}),this.layers.on("after-add",({item:e})=>{this.addHandles([w(()=>e.visible,()=>this.notifyChange("visible"),L),w(()=>e.title,()=>this.notifyChange("title"),L)],e.uid)}),this.layers.on("before-remove",({item:e})=>{this.removeHandles(e.uid),this.notifyChange("title"),this.notifyChange("visible")}),this.children.on("before-add",e=>{this._childIds.has(e.item.id)?e.preventDefault():(e.item._set("parent",this),this._childIds.add(e.item.id))})])}destroy(){this.children.forEach(e=>e.destroy())}get hasChildren(){return this.children.length>0}get isDiscipline(){return this.level===1}get visible(){return ue(this.layers,e=>e.visible)}get title(){return ue(this.layers,e=>e.title)||this.layers.items.map(e=>e.title).join(", ")||null}toggleVisibility(e){const i=e===void 0?!this.visible:e;this.layers.forEach(s=>{s.visible=i}),i&&this.parent!=null&&this.parent.toggleVisibility(!0)}toggleAllSiblingsVisibility(e){const i=e===void 0?!this.visible:e;this.toggleVisibility(i),this.parent!=null&&(this.parent.toggleVisibility(i),this.parent.children.forEach(s=>s.toggleVisibility(i)))}};function ue(t,e){let i=null;for(const s of t.items){const o=e(s);if(i!=null&&i!==o)return null;i=o}return i}l([r({nonNullable:!0})],v.prototype,"id",void 0),l([r()],v.prototype,"parent",void 0),l([r({nonNullable:!0,readOnly:!0})],v.prototype,"children",void 0),l([r({nonNullable:!0,readOnly:!0})],v.prototype,"layers",void 0),l([r({nonNullable:!0})],v.prototype,"level",void 0),l([r({readOnly:!0})],v.prototype,"hasChildren",null),l([r({readOnly:!0})],v.prototype,"isDiscipline",null),l([r({readOnly:!0})],v.prototype,"visible",null),l([r({readOnly:!0})],v.prototype,"title",null),v=l([m("esri.widgets.BuildingExplorer.support.LayerTreeNode")],v);function ne(){let t=new AbortController;return async e=>{t.abort(),t=new AbortController;const i={signal:t.signal},s=e.toArray().map(o=>ot(o,i));await Promise.all(s),ye(i)}}async function ot(t,e){await t.load(e),await t.loadAll(),ye(e),t.summaryStatistics&&await t.summaryStatistics.load(e)}let F=class extends Y{constructor(e){super(e),this.root=new v,this.state="disabled",this._loadLayers=ne(),this.layers=new k}initialize(){this.addHandles(this.layers.on("change",()=>this._onLayersChange())),this._onLayersChange()}destroy(){this._set("state","disabled"),this.root.destroy()}set layers(e){const i=this._get("layers");this._set("layers",oe(e,i))}_updateLayerTree(){this.root.destroy(),this._set("root",new v);const e=new Map,i=this.layers.length>1?"modelName":"id";return this.layers.forEach(s=>{const o=we(s);this._addNodesForSublayers(o??s,this.root,e,i)}),this}_addNodeForLayer(e,i,s,o){const n=String(e[o]).toLowerCase();if(n==null||e.isEmpty)return;const h=`${i.id}/${n}`;let u=s.get(h);u||(u=new v({id:n,level:i.level+1}),s.set(h,u)),u.layers.push(e),i.children.push(u),this._addNodesForSublayers(e,u,s,o)}_addNodesForSublayers(e,i,s,o){(e.type==="building-scene"||e.type==="building-group"&&!e.isEmpty)&&e.sublayers.forEach(n=>this._addNodeForLayer(n,i,s,o))}async _onLayersChange(){if(this._set("state","loading"),this.layers.length!==0)try{await this._loadLayers(this.layers),this._updateLayerTree(),this._set("state","ready")}catch(e){re(e)||this._set("state","failed")}}};l([r({readOnly:!0})],F.prototype,"root",void 0),l([r({type:k,nonNullable:!0})],F.prototype,"layers",null),l([r({readOnly:!0,nonNullable:!0})],F.prototype,"state",void 0),F=l([m("esri.widgets.BuildingExplorer.BuildingDisciplinesViewModel")],F);const $e=F;function X(t){const e={fieldValueMap:new Map,allowedValues:[]};for(const i of t){const s=i.fieldValueMap,o=e.fieldValueMap;s.forEach((n,h)=>{o.has(h)||(o.set(h,n),e.allowedValues.push(h))})}return e.allowedValues.sort((i,s)=>i-s),e}function nt(t){let e=null;for(const i of t)e=e!=null?Math.min(e,i):i;return e}function at(t){let e=null;for(const i of t)e=e!=null?Math.max(e,i):i;return e}function ee(t,e){return e.allowedValues.length>0?ht(t,e.allowedValues):null}function ht(t,e){if(e.length===0)return t;if(t===1/0)return e[e.length-1];if(t===-1/0)return e[0];let i=e[0],s=Math.abs(i-t);for(const o of e){const n=Math.abs(o-t);n<s&&(i=o,s=n)}return i}let p=class extends Y{constructor(e){super(e),this.state="disabled",this._valueBeforeReady=null,this._domainInfo=X([]),this._loadLayers=ne(),this.layers=new k}initialize(){this.addHandles(this.layers.on("change",()=>this._onLayersChange())),this._onLayersChange()}destroy(){this._set("state","disabled")}get enabled(){return this.allowedValues.length>0&&this._get("enabled")}set enabled(e){e!==this.enabled&&this.allowedValues.length>0&&this._set("enabled",e)}get value(){return(this.state==="ready"?this._get("value"):this._valueBeforeReady)??0}set value(e){if(this.state!=="ready")return void(this._valueBeforeReady=e);if(e===this.value)return;const i=ee(e,this);i!=null&&this._set("value",i)}get min(){return nt(this.allowedValues)}get max(){return at(this.allowedValues)}get allowedValues(){return this._domainInfo.allowedValues}set allowedValues(e){e==null?this._clearOverride("allowedValues"):this._override("allowedValues",e);const i=ee(this.value,this);i!=null&&(this.value=i)}get hasNext(){if(!this.enabled)return!0;const e=this._valueIndex;return e>=0&&e<this.allowedValues.length-1}get hasPrevious(){return!this.enabled||this._valueIndex>0}set layers(e){const i=this._get("layers");this._set("layers",oe(e,i))}get filterExpressions(){return{solid:null,xRay:null}}get _valueIndex(){return Ue(this.allowedValues,this.value)}select(e){if(this.state!=="ready")return void(this._valueBeforeReady=e);ee(e,this)!=null&&(this.enabled=!0,this.value=e)}clear(){this.state==="ready"?this.enabled=!1:this._valueBeforeReady=null}next(){const{state:e,allowedValues:i,enabled:s,hasNext:o,_valueIndex:n}=this;if(e==="ready"||this._valueBeforeReady==null){if(i.length!==0)return s?void(o&&(this.value=i[n+1])):(this.enabled=!0,void(this.value=i[0]))}else this._valueBeforeReady++}previous(){const{state:e,allowedValues:i,enabled:s,hasPrevious:o,_valueIndex:n}=this;if(e==="ready"||this._valueBeforeReady==null){if(i.length!==0)return s?void(o&&(this.value=i[n-1])):(this.enabled=!0,void(this.value=i[i.length-1]))}else this._valueBeforeReady++}getValueLabel(e){return this.layers.length===0?null:this._domainInfo.fieldValueMap.get(e)??null}async _onLayersChange(){if(this._set("state","loading"),this._domainInfo=X([]),this.layers.length!==0)try{await this._loadLayers(this.layers),this._setup()}catch(e){re(e)||this._set("state","failed")}}};l([r({value:!1,nonNullable:!0})],p.prototype,"enabled",null),l([r({nonNullable:!0})],p.prototype,"value",null),l([r({readOnly:!0})],p.prototype,"min",null),l([r({readOnly:!0})],p.prototype,"max",null),l([r()],p.prototype,"allowedValues",null),l([r({readOnly:!0})],p.prototype,"hasNext",null),l([r({readOnly:!0})],p.prototype,"hasPrevious",null),l([r({type:k,nonNullable:!0})],p.prototype,"layers",null),l([r({nonNullable:!0})],p.prototype,"state",void 0),l([r()],p.prototype,"_valueBeforeReady",void 0),l([r({readOnly:!0})],p.prototype,"_valueIndex",null),l([r()],p.prototype,"_domainInfo",void 0),p=l([m("esri.widgets.BuildingExplorer.BuildingNumericFilterViewModel")],p);const Le=p,xe="__BUILDING_EXPLORER_FILTER__";function dt(){return`${Qe()}${xe}`}function se(t){const e=typeof t=="string"?t:t.id;return!!e&&e.includes(xe)}function Ce(t,e){for(const i of t.items)for(const s of i.filters.items){if(!se(s))continue;const o=e(s);if(o!=null)return o}return null}function ut(t,e){t.forEach(i=>{const s=i.filters.filter(n=>!se(n));e!=null&&s.push(e),pt(i.filters,s)||(i.filters=s);const o=i.filters.find(n=>se(n));i.activeFilterId=o!=null?o.id:null})}function pt(t,e){const i=e.length;if(t==null||t.length!==i)return!1;for(let s=0;s<i;++s){const o=e.at(s).toJSON(),n=t.at(s).toJSON();if(o.id="",n.id="",JSON.stringify(o)!==JSON.stringify(n))return!1}return!0}function ct(t){const e=Pe(t);return e?new fe({filterExpression:e,filterMode:new Xe}):null}function vt(t){const e=Pe(t);return e?new fe({filterExpression:e,filterMode:new Ge}):null}function Pe(t){return t.filter(e=>!!e).map(e=>`(${e})`).join(" AND ")}const mt="bldglevel";let R=class extends Le{constructor(e){super(e),this._levelFieldName=null,this._parseValueFromFilter=i=>{var n;const s=new RegExp(`${this._levelFieldName}\\s*=\\s*(\\d+)`,"gi"),o=new RegExp(`${this._levelFieldName}\\s*<\\s*(\\d+)`,"gi");for(const{filterMode:h,filterExpression:u}of((n=i.filterBlocks)==null?void 0:n.items)??[]){if(u==null)continue;let _=null;if(h.type==="solid"?_=s.exec(u):h.type==="x-ray"&&(_=o.exec(u)),_)return parseInt(_[1],10)}return null}}get filterExpressions(){return this.enabled&&this._levelFieldName?{xRay:`${this._levelFieldName} < ${this.value}`,solid:`${this._levelFieldName} = ${this.value}`}:{solid:null,xRay:null}}get _firstValue(){const e=this.allowedValues;return e.length>0?e[0]:0}_setup(){const e=[];this.layers.forEach(o=>{const n=ie(o,mt);n!=null&&(this._levelFieldName=n.fieldName,e.push(n))}),this._domainInfo=X(e);const i=this._valueBeforeReady;this._set("state","ready"),this._valueBeforeReady=null;const s=i??Ce(this.layers,this._parseValueFromFilter);s!=null?this.select(s):(this.enabled=!1,this.value=this._firstValue)}};l([r({readOnly:!0})],R.prototype,"filterExpressions",null),l([r()],R.prototype,"_levelFieldName",void 0),l([r({readOnly:!0})],R.prototype,"_firstValue",null),R=l([m("esri.widgets.BuildingExplorer.BuildingLevel")],R);const Ee=R,gt="demolishedphase",_t="createdphase";let B=class extends Le{constructor(e){super(e),this._createdPhaseFieldName=null,this._demolishedPhaseFieldName=null,this._parseValueFromFilter=i=>{var u;const s=this._createdPhaseFieldName,o=new RegExp(`${s}\\s*<=\\s*(\\d+)\\s*OR\\s*${s}\\s*IS\\s*NULL`,"gi"),n=this._demolishedPhaseFieldName,h=new RegExp(`${n}\\s*>\\s*(\\d+)\\s*OR\\s*${n}\\s*IS\\s*NULL`,"gi");for(const{filterExpression:_}of((u=i.filterBlocks)==null?void 0:u.items)??[]){const I=_?o.exec(_)??h.exec(_):null;if(I)return parseInt(I[1],10)}return null}}get filterExpressions(){if(!this.enabled)return{solid:null,xRay:null};const e=[],i=this._createdPhaseFieldName;i&&e.push(`(${i} <= ${this.value} OR ${i} IS NULL)`);const s=this._demolishedPhaseFieldName;s&&e.push(`(${s} > ${this.value} OR ${s} IS NULL)`);const o=e.join(" AND ");return{solid:o,xRay:o}}get _lastValue(){const e=this.allowedValues;return e.length>0?e[e.length-1]:0}_setup(){const e=[];this.layers.forEach(s=>{const o=ie(s,_t);o!=null&&(this._createdPhaseFieldName=o.fieldName,e.push(o));const n=ie(s,gt);n!=null&&(this._demolishedPhaseFieldName=n.fieldName,e.push(n))}),this._domainInfo=X(e);const i=this._valueBeforeReady;if(this._set("state","ready"),this._valueBeforeReady=null,this.allowedValues.length>0){const s=i??Ce(this.layers,this._parseValueFromFilter);this.select(s??this._lastValue)}else this.clear()}};l([r({readOnly:!0})],B.prototype,"filterExpressions",null),l([r()],B.prototype,"_createdPhaseFieldName",void 0),l([r()],B.prototype,"_demolishedPhaseFieldName",void 0),l([r({readOnly:!0})],B.prototype,"_lastValue",null),B=l([m("esri.widgets.BuildingExplorer.BuildingPhase")],B);const Ve=B;let y=class extends Y{constructor(e){super(e),this.view=null,this.state="disabled",this.level=new Ee,this.phase=new Ve,this.disciplines=new $e,this._loadLayers=ne(),this.layers=new k}initialize(){this.addHandles([this.layers.on("change",()=>this._onLayersChange()),w(()=>({state:this.state,layers:this.layers,filter:this._filter}),({state:e,layers:i,filter:s})=>{e==="ready"&&ut(i,s)},{initial:!0})]),this._onLayersChange()}destroy(){this.level.destroyed||this.level.destroy(),this.phase.destroyed||this.phase.destroy(),this.disciplines.destroyed||this.disciplines.destroy()}get isSupported(){var e;return((e=this.view)==null?void 0:e.type)==="3d"}get layers(){return this._get("layers")}set layers(e){const i=e.filter(s=>s instanceof Ye);i.length!==e.length&&Ke.getLogger(this).error("Some layers are not BuildingSceneLayers but only BuildingSceneLayers can be passed to the widget."),this._set("layers",oe(i,this._get("layers")))}get _filter(){const e=this.level.filterExpressions,i=this.phase.filterExpressions,s=[],o=vt([e.solid,i.solid]);o!=null&&s.push(o);const n=ct([e.xRay,i.xRay]);return n!=null&&s.push(n),s.length===0?null:new Ze({id:dt(),name:"Building Explorer Filter",filterBlocks:s})}async _onLayersChange(){const e=this.layers;if(this.level.layers=e,this.phase.layers=e,this.disciplines.layers=e,e.length!==0){this._set("state","loading");try{await this._loadLayers(e),await Promise.all([Z(()=>this.level.state==="ready"),Z(()=>this.phase.state==="ready"),Z(()=>this.disciplines.state==="ready")]),e.forEach(st),this._set("state","ready")}catch(i){re(i)||this._set("state","failed")}}else this._set("state","disabled")}};l([r({value:null})],y.prototype,"view",void 0),l([r()],y.prototype,"isSupported",null),l([r({type:k,nonNullable:!0})],y.prototype,"layers",null),l([r({readOnly:!0})],y.prototype,"state",void 0),l([r({readOnly:!0,type:Ee})],y.prototype,"level",void 0),l([r({readOnly:!0,type:Ve})],y.prototype,"phase",void 0),l([r({readOnly:!0,type:$e})],y.prototype,"disciplines",void 0),l([r()],y.prototype,"_filter",null),y=l([m("esri.widgets.BuildingExplorer.BuildingExplorerViewModel")],y);const Ne=y,C="esri-building-explorer",g={base:C,panelError:`${C}__panel--error`,loadingContainer:`${C}__loading-container`,content:`${C}__content`,section:`${C}__section`,levels:`${C}__levels`,phases:`${C}__phases`,disciplines:`${C}__disciplines`};var j;const yt={expand:"expand",collapse:"collapse",hideSublayer:"hideSublayer",showSublayer:"showSublayer"},pe="esri-building-disciplines-tree-node",ce={base:pe,label:`${pe}__label`};let V=j=class extends D{constructor(t){super(t),this.messages=yt,this.toggleSiblingsVisibility=!1,this._onCheckboxClick=e=>{e.stopPropagation(),(e.metaKey||e.ctrlKey)&&this.toggleSiblingsVisibility&&(this.node.toggleVisibility(),this.node.toggleAllSiblingsVisibility())},this._onCheckboxToggle=e=>{this.node.toggleVisibility(e.currentTarget.checked)}}static loadDependencies(){return O({checkbox:()=>x(()=>import("./index-CtvJE4Qe.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21]),import.meta.url),label:()=>x(()=>import("./index--OBudxYA.js"),__vite__mapDeps([22,1,2,3,4,5,6,7,8,9,10,11,12,20,15,16]),import.meta.url),tree:()=>x(()=>import("./index-CkWlzxRO.js"),__vite__mapDeps([23,1,2,3,4,5,6,7,8,9,10,11,12,15,16]),import.meta.url),"tree-item":()=>x(()=>import("./index-CwGfEOCA.js"),__vite__mapDeps([24,25,1,2,3,4,5,6,7,8,9,10,11,12,15,16,26,27,14,13,18,28]),import.meta.url)})}loadDependencies(){return j.loadDependencies()}render(){const{node:t,messages:e}=this;if(t.isDiscipline&&!t.hasChildren)return a("div",{key:`${t.id}-empty`});const i=t.visible,s=i===!0,o=i===null,n=s?e==null?void 0:e.hideSublayer:e==null?void 0:e.showSublayer;return a("calcite-tree-item",{class:ce.base,key:t.id},a("calcite-label",{class:ce.label,layout:"inline"},a("calcite-checkbox",{checked:s,indeterminate:o,label:n,onclick:this._onCheckboxClick,title:n,onCalciteCheckboxChange:this._onCheckboxToggle}),t.title),this._renderedChildren)}get _renderedChildren(){const{node:t}=this;if(!t.hasChildren)return null;const{messages:e}=this,{toggleSiblingsVisibility:i}=this;return a("calcite-tree",{slot:"children"},this.node.children.toArray().reverse().map(s=>a(j,{messages:e,node:s,toggleSiblingsVisibility:i})))}};V.vnodeSelector="calcite-tree-item",l([r({type:v})],V.prototype,"node",void 0),l([r()],V.prototype,"messages",void 0),l([r({nonNullable:!0})],V.prototype,"toggleSiblingsVisibility",void 0),l([r()],V.prototype,"_renderedChildren",null),V=j=l([m("esri.widgets.BuildingExplorer.BuildingDisciplinesTree.BuildingDisciplinesNode")],V);const ve=V,ft={expand:"expand",collapse:"collapse",hideSublayer:"hideSublayer",showSublayer:"showSublayer"},bt={base:"esri-building-disciplines-tree"};let M=class extends D{constructor(e){super(e),this.toggleSiblingsVisibility=!1}loadDependencies(){return Promise.allSettled([O({tree:()=>x(()=>import("./index-CkWlzxRO.js"),__vite__mapDeps([23,1,2,3,4,5,6,7,8,9,10,11,12,15,16]),import.meta.url)}),ve.loadDependencies()])}render(){const{vm:e}=this,i=this.toggleSiblingsVisibility,s=this.messages??ft;return a("calcite-tree",{class:bt.base,scale:"s",selectionMode:"none"},e.root.children.toArray().reverse().map(o=>a(ve,{messages:s,node:o,toggleSiblingsVisibility:i})))}};M.vnodeSelector="calcite-tree",l([r()],M.prototype,"vm",void 0),l([r()],M.prototype,"messages",void 0),l([r()],M.prototype,"toggleSiblingsVisibility",void 0),M=l([m("esri.widgets.BuildingExplorer.BuildingDisciplinesTree.BuildingDisciplinesTree")],M);const wt=M,Se=30,ke=20,Be=30,Me=10,J=20,G=2,De=.035,Fe=30,Re=14,Oe=80,$t=100,Lt=40,xt=Object.freeze(Object.defineProperty({__proto__:null,alphaLevelDependencyFactor:Be,alphaSpreadFactor:Me,levelHeightDefault:Re,levelHoveredExtraHeight:Se,levelHoveredExtraWidth:ke,levelWidthConstant:Lt,levelWidthMax:Oe,levelWidthMin:Fe,levelWidthNominator:$t,levelsMarginFactor:G,levelsPadding:J,levelsPointerAdjustment:De},Symbol.toStringTag,{value:"Module"})),P="esri-building-level-picker",E={container:P,noLevel:`${P}--no-level`,animateLevel:`${P}--animate-level`,levelsContainer:`${P}__levels-container`,innerLevelsContainer:`${P}__inner-levels-container`,labelContainer:`${P}__label-container`,arrowUp:`${P}__arrow-up`,arrowDown:`${P}__arrow-down`},H="esri-building-level-picker-label",W={base:H,active:`${H}--active`,hover:`${H}--hover`,empty:`${H}--empty`,clearButton:`${H}__clear-button`},Ct={clearLevel:"",selectLevel:""};let N=class extends D{constructor(e,i){super(e,i),this.level=null,this.active=!1,this.hovering=!1,this.onClear=()=>{}}loadDependencies(){return O({fab:()=>x(()=>import("./index-Dd_Yvsgp.js"),__vite__mapDeps([29,30,1,2,3,4,5,6,7,8,9,10,11,12,16,31,25,15,26,32,13,14,33,17,18,20,21,28]),import.meta.url)})}render(){const e=this.messages??Ct;if(this.level==null)return a("div",{class:W.empty,title:e.selectLevel},e.selectLevel);const i=e.clearLevel;return a("div",{"aria-label":i,bind:this,class:this.classes(W.base,{[W.active]:this.active,[W.hover]:this.hovering}),onclick:this.onClear,title:i},a("span",null,this.level),a("calcite-fab",{appearance:"outline-fill",class:W.clearButton,disabled:!this.active,icon:"x",key:"clear-button",kind:"neutral",onclick:this.onClear,scale:"s"}))}};l([r()],N.prototype,"level",void 0),l([r({nonNullable:!0})],N.prototype,"active",void 0),l([r({nonNullable:!0})],N.prototype,"hovering",void 0),l([r()],N.prototype,"messages",void 0),l([r({nonNullable:!0})],N.prototype,"onClear",void 0),N=l([m("esri.widgets.BuildingExplorer.BuildingLevelPicker.Label")],N);const K="esri-building-level-picker-item",q={container:K,base:`${K}__base`,hover:`${K}--hover`,active:`${K}--active`};let f=class extends D{constructor(t,e){super(t,e),this.active=!1,this.hovering=!1,this.width=0,this.height=0,this.onSelect=()=>{},this.onFocus=()=>{},this.onBlur=()=>{},this._baseElement=null}render(){return a("div",{bind:this,class:this.classes(q.container,{[q.active]:this.active,[q.hover]:this.hovering}),key:this,styles:{height:`${this.height}px`}},this._renderBase())}focus(){this._baseElement!=null&&this._baseElement.focus()}_renderBase(){const t=this.width,e=.8*this.width;return a("div",{class:q.base,styles:{width:`${Math.round(t)}px`,height:`${Math.round(t)}px`}},a("button",{afterCreate:je,"aria-label":this.label,bind:this,class:"rect","data-node-ref":"_baseElement",onblur:this.onBlur,onclick:this.onSelect,onfocus:this.onFocus,styles:{width:`${Math.round(e)}px`,height:`${Math.round(e)}px`,transform:`translate(${Je(this.container),-50}%, -50%) rotateX(66deg) rotateZ(45deg)`},tabIndex:-1,title:this.label??"",type:"button"}))}};l([r({nonNullable:!0})],f.prototype,"level",void 0),l([r({nonNullable:!0})],f.prototype,"active",void 0),l([r({nonNullable:!0})],f.prototype,"hovering",void 0),l([r({nonNullable:!0})],f.prototype,"width",void 0),l([r({nonNullable:!0})],f.prototype,"height",void 0),l([r({nonNullable:!0})],f.prototype,"onSelect",void 0),l([r({nonNullable:!0})],f.prototype,"onFocus",void 0),l([r({nonNullable:!0})],f.prototype,"onBlur",void 0),f=l([m("esri.widgets.BuildingExplorer.BuildingLevelPicker.LevelItem")],f);const te={selectLevel:"selectLevel",clearLevel:"clearLevel",nextLevel:"nextLevel",previousLevel:"previousLevel",currentLevel:"{{value}}"};let d=class extends D{constructor(t,e){super(t,e),this._levelHandlesKey="levelHandles",this._levelEventHandlesKey="levelEventHandles",this._levelWidgets=[],this._labelWidget=new N({onClear:()=>this.vm.clear()}),this._hoveredLevel=null,this._expandedLevelsHeight=void 0,this._normalizedPointerPosition=0,this._hovering=!1,this._containerPosTop=null,this._levelsContainer=null,this._onKeyDown=i=>{switch(i.key){case"ArrowDown":case"ArrowLeft":i.preventDefault(),i.stopPropagation(),this.vm.previous(),this._focusCurrentLevel();break;case"ArrowUp":case"ArrowRight":i.preventDefault(),i.stopPropagation(),this.vm.next(),this._focusCurrentLevel()}},this._onFocus=()=>{this._hoveredLevel=this._levels.length>0?this._levels[0]:null},this._onArrowUpClick=()=>{this.vm.next()},this._onArrowDownClick=()=>{this.vm.previous()},this._onPointerUp=()=>{var s;if((s=window.getSelection())==null||s.removeAllRanges(),this._hoveredLevel==null)return;const{vm:i}=this;i.enabled&&this._hoveredLevel===i.value?i.clear():i.select(this._hoveredLevel)},this._onPointerEnter=()=>{this._hovering||this._levelsContainer==null||(this._hovering=!0,this._containerPosTop=this._levelsContainer.getBoundingClientRect().top??0)},this._onPointerLeave=()=>{this._hovering&&(this._normalizedPointerPosition=0,this._hoveredLevel=null,this._hovering=!1)},this._onPointerMove=i=>{var s;if(!this._hovering)return!1;if((s=window.getSelection())==null||s.removeAllRanges(),this._containerPosTop!=null){const o=this._containerPosTop,n=J*G,h=this._expandedLevelsMargin;let u=this._levelsHeight,_=o+n+h;const I=this._levelHeight/2;_+=I,u-=I;let ae=(i.clientY-_)/u;ae+=De,this._normalizedPointerPosition=ae}return!1}}loadDependencies(){return O({action:()=>x(()=>import("./index-BPm91e5Z.js"),__vite__mapDeps([34,30,1,2,3,4,5,6,7,8,9,10,11,12,16,31,25,15,26,27,14,13,18,21,28]),import.meta.url)})}postInitialize(){this.addHandles([w(()=>this._levelsContainer,()=>this._onContainerChange(),L),w(()=>this._levels,()=>this._createLevelWidgets(),L),w(()=>this.messages,()=>{this._labelWidget.messages=this.messages??te},L)])}destroy(){this._levelWidgets.forEach(t=>t.destroy()),this._labelWidget.destroy()}get _levels(){return this.vm.allowedValues}get _numLevels(){return this._levels.length}get _levelsHeight(){return Math.round(this._levelHeight*this._numLevels)}get _expandedLevelsMargin(){return Math.round(((this._expandedLevelsHeight??0)-this._levelsHeight)/2)}get _levelWidth(){const{levelWidthNominator:t,levelWidthConstant:e}=xt,i=t/Math.sqrt(this._numLevels)+e;return Math.round(de(i,Fe,Oe))}get _levelHeight(){const t=Re,e=2*t/Math.sqrt(this._numLevels);return Math.round(de(e,2,t))}get _gaussianFactor(){const t=this._numLevels;return t/Math.log(Be*t)*Me}get _levelClosestToPointer(){if(!this._hovering)return null;const t=this._numLevels-1,e=this._normalizedPointerPosition;return t>=0&&e!=null?this._levels[Math.round((1-e)*t)]:null}render(){const t=this._levelWidgets.length,e=t>1?this._levelWidgets.map(h=>h.render()):null,i=J*G,s=-40/G,o=this._levelsHeight,n=o+2*i;return a("div",{class:this.classes(T.widget,E.container,{[E.animateLevel]:!this._hovering,[E.noLevel]:t<2}),key:this,onkeydown:this._onKeyDown},this._renderLabelContainer(),a("div",{afterCreate:h=>this._levelsContainer=h,class:E.levelsContainer,"data-node-ref":"",onfocus:this._onFocus,styles:{height:`${n}px`,marginBlockStart:`${s}px`,marginBlockEnd:`${s}px`}},a("div",{class:E.innerLevelsContainer,styles:{height:`${o}px`,margin:"0",marginBlockStart:J-this._expandedLevelsMargin+"px"}},e)))}_renderLabelContainer(){const{hasPrevious:t,hasNext:e}=this.vm,i=this.messages??te,s=i.previousLevel,o=i.nextLevel;return a("div",{class:E.labelContainer,tabIndex:0},me({className:E.arrowUp,disabled:!e,icon:"chevron-up",onClick:this._onArrowUpClick,text:o}),this._labelWidget.render(),me({className:E.arrowDown,disabled:!t,icon:"chevron-down",onClick:this._onArrowDownClick,text:s}))}_updateComponents(){const t=this.messages??te,e=this.vm.enabled?this.vm.value:null,i=this._hoveredLevel!=null?this._hoveredLevel:e;this._levelWidgets.forEach(s=>{var n;const o=this.vm.getValueLabel(s.level);s.label=o??((n=t.currentLevel)==null?void 0:n.replace("{{level}}",String(s.level))),s.active=s.level===e,s.hovering=s.level===this._hoveredLevel}),this._labelWidget.level=i,this._labelWidget.active=i===e,this._labelWidget.hovering=this._hoveredLevel!=null}_createLevelWidgets(){this._levelWidgets.forEach(t=>t.destroy()),this._levelWidgets=this._levels.map(t=>new f({level:t,onSelect:()=>this._onLevelToggle(t)})),this.removeHandles(this._levelHandlesKey),this.addHandles([w(()=>{const{vm:t}=this;return[this.messages,t==null?void 0:t.value,t==null?void 0:t.enabled,this._hoveredLevel,this._hovering]},()=>this._updateComponents(),L),w(()=>[this._normalizedPointerPosition,this._hovering],()=>this._onPointerPositionChange(),L),w(()=>this._levelWidth,t=>this._levelWidgets.forEach(e=>e.width=t),L)],this._levelHandlesKey)}_onContainerChange(){const t=this._levelsContainer;t!=null&&(this.removeHandles(this._levelEventHandlesKey),this.addHandles([A(t,"pointerenter",this._onPointerEnter),A(t,"pointerover",this._onPointerEnter),A(t,"pointerleave",this._onPointerLeave),A(t,"pointerup",this._onPointerUp),A(t,"pointermove",this._onPointerMove)],this._levelEventHandlesKey))}_focusCurrentLevel(){const t=this._levelWidgets.find(e=>e.level===this.vm.value);t==null||t.focus()}_onLevelToggle(t){const{vm:e}=this;e.enabled&&e.value===t?e.clear():e.select(t)}_onPointerPositionChange(){let t=0;this._levelWidgets.forEach((i,s)=>{const{width:o,height:n}=this._getLevelWidgetSize(s);i.height=n,i.width=o,t+=n}),this._hoveredLevel=this._levelClosestToPointer;const e=this._expandedLevelsHeight;(e==null||Math.abs(e-t)>30)&&(this._expandedLevelsHeight=t)}_getLevelWidgetSize(t){const e={width:this._levelWidth,height:this._levelHeight};if(this._hovering){const i=this._getGaussianFactor(t,this._normalizedPointerPosition);e.width+=ke*i,e.height+=Se*i}return e}_getGaussianFactor(t,e){const i=this._numLevels-1,s=(i-t)/i,o=this._gaussianFactor*(s-e);return Math.exp(-(o**2))}};function me(t){return a("calcite-action",{appearance:"transparent",class:t.className,disabled:t.disabled,icon:t.icon,key:t.className,onclick:t.onClick,scale:"s",text:t.text,textEnabled:!1,title:t.text})}l([r()],d.prototype,"vm",void 0),l([r()],d.prototype,"messages",void 0),l([r()],d.prototype,"_levelWidgets",void 0),l([r()],d.prototype,"_labelWidget",void 0),l([r()],d.prototype,"_hoveredLevel",void 0),l([r()],d.prototype,"_levels",null),l([r()],d.prototype,"_numLevels",null),l([r({readOnly:!0})],d.prototype,"_levelsHeight",null),l([r()],d.prototype,"_expandedLevelsHeight",void 0),l([r({readOnly:!0})],d.prototype,"_expandedLevelsMargin",null),l([r({readOnly:!0})],d.prototype,"_levelWidth",null),l([r({readOnly:!0})],d.prototype,"_levelHeight",null),l([r({readOnly:!0})],d.prototype,"_gaussianFactor",null),l([r({readOnly:!0})],d.prototype,"_levelClosestToPointer",null),l([r({type:Number,range:{min:0,max:1}})],d.prototype,"_normalizedPointerPosition",void 0),l([r()],d.prototype,"_hovering",void 0),l([r()],d.prototype,"_containerPosTop",void 0),l([r()],d.prototype,"_levelsContainer",void 0),d=l([m("esri.widgets.BuildingExplorer.BuildingLevelPicker.BuildingLevelPicker")],d);const Pt=d,$="esri-building-phase-picker",b={base:`${$}`,phasesContainer:`${$}__phases-container`,phase:`${$}__phase`,phaseActive:`${$}__phase--active`,phaseCurrent:`${$}__phase--current`,divider:`${$}__divider`,dividerActive:`${$}__divider--active`,arrowLeft:`${$}__arrow-left`,arrowRight:`${$}__arrow-right`},Et={nextPhase:"nextPhase",previousPhase:"previousPhase"};let S=class extends D{constructor(t,e){super(t,e),this._phasesContainer=null,this._shouldScrollCurrentPhaseIntoView=!0,this._shouldFocusCurrentPhase=!1,this._onKeyDown=i=>{const{vm:s}=this;switch(i.key){case"ArrowDown":case"ArrowLeft":i.stopPropagation(),i.preventDefault(),s.previous(),this._shouldFocusCurrentPhase=!0;break;case"ArrowUp":case"ArrowRight":i.stopPropagation(),i.preventDefault(),s.next(),this._shouldFocusCurrentPhase=!0}},this._onArrowLeftClick=()=>{this.vm.previous()},this._onArrowRightClick=()=>{this.vm.next()},this._onPhasesContainerAfterCreate=i=>{this._phasesContainer=i,requestAnimationFrame(this._scrollOrFocusPhase)},this._scrollOrFocusPhase=()=>{const i=this._phasesContainer;if(this.destroyed||i==null)return;const s=i.querySelector(`.${b.phaseCurrent}`);if(s){if(this._shouldScrollCurrentPhaseIntoView){const o=i.offsetWidth,n=s.offsetLeft,h=s.offsetWidth;i.scrollLeft=-o/2+n+h/2,this._shouldScrollCurrentPhaseIntoView=!1}this._shouldFocusCurrentPhase&&(s.focus(),this._shouldFocusCurrentPhase=!1)}}}loadDependencies(){return O({action:()=>x(()=>import("./index-BPm91e5Z.js"),__vite__mapDeps([34,30,1,2,3,4,5,6,7,8,9,10,11,12,16,31,25,15,26,27,14,13,18,21,28]),import.meta.url)})}initialize(){this.addHandles(w(()=>[this._currentPhase,this._phasesContainer,this.container],()=>{this._shouldScrollCurrentPhaseIntoView=!0,requestAnimationFrame(this._scrollOrFocusPhase)},L))}get _phases(){return this.vm.allowedValues}get _currentPhase(){const{vm:t}=this;return t.enabled?t.value:null}render(){if(this._phases.length<2)return a("div",{key:"no-phases"});const{vm:t,messages:e}=this,{previousPhase:i,nextPhase:s}=e??Et;return a("div",{class:this.classes(T.widget,b.base),key:this,onkeydown:this._onKeyDown},ge({className:b.arrowLeft,disabled:!t.hasPrevious,icon:"chevron-left",onClick:this._onArrowLeftClick,text:i}),a("div",{afterCreate:this._onPhasesContainerAfterCreate,class:b.phasesContainer},this._renderPhaseButtons()),ge({className:b.arrowRight,disabled:!t.hasNext,icon:"chevron-right",onClick:this._onArrowRightClick,text:s}))}_renderPhaseButtons(){const t=this._phases,e=this._currentPhase,i=[];for(let s=0;s<t.length;++s){const o=t[s],n={phase:o,active:e!=null&&o<=e,current:e!=null&&o===e};s>0&&i.push(this._renderDivider(n)),i.push(this._renderPhaseButton(n))}return i}_renderPhaseButton({phase:t,active:e,current:i}){const{vm:s}=this,o=s.getValueLabel(t);return a("button",{"aria-label":o,class:this.classes(b.phase,{[b.phaseActive]:e,[b.phaseCurrent]:i}),key:`phase-${t}`,onclick:()=>s.select(t),title:o,type:"button"},t)}_renderDivider({phase:t,active:e}){return a("div",{class:this.classes(b.divider,{[b.dividerActive]:e}),key:`phase-divider-${t}`})}};function ge(t){return a("calcite-action",{appearance:"transparent",class:t.className,disabled:t.disabled,icon:t.icon,iconFlipRtl:!0,key:t.className,onclick:t.onClick,scale:"s",text:t.text,textEnabled:!1,title:t.text})}l([r({nonNullable:!0})],S.prototype,"vm",void 0),l([r()],S.prototype,"messages",void 0),l([r()],S.prototype,"_phases",null),l([r()],S.prototype,"_currentPhase",null),l([r()],S.prototype,"_phasesContainer",void 0),S=l([m("esri.widgets.BuildingExplorer.BuildingPhasePicker.BuildingPhasePicker")],S);const Vt=S,_e={levels:!0,phases:!0,disciplines:!0};let c=class extends D{constructor(t,e){super(t,e),this._defaultViewModel=new Ne,this.viewModel=this._defaultViewModel,this.visibleElements={..._e},this.headingLevel=3,this.messages=null,this.messagesCommon=null,this.toggleSiblingsVisibility=!1}loadDependencies(){return O({loader:()=>x(()=>import("./index-CMxz6F2k.js"),__vite__mapDeps([30,1,2,3,4,5,6,7,8,9,10,11,12,16,31]),import.meta.url)})}destroy(){this.viewModel!==this._defaultViewModel&&this._defaultViewModel.destroy()}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}get layers(){return this.viewModel.layers}set layers(t){this.viewModel.layers=t}_castVisibleElements(t){return{..._e,...t}}get icon(){return"organization"}set icon(t){this._overrideIfSome("icon",t)}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}render(){const t=this.viewModel,e=t.state==="disabled"||!t.isSupported;return a("div",{"aria-label":this.messages.widgetLabel,class:U(T.widget,g.base,T.panel,{[T.widgetDisabled]:e}),key:this},this._renderContent())}_renderContent(){const t=this.viewModel,e=this.messages;if(!t.isSupported)return a("p",{class:g.panelError},e.unsupported);if(!t.layers.length)return a("p",{class:g.panelError},e.noData);switch(t.state){case"loading":return this._renderLoadingIndicator();case"ready":return a("div",{class:g.content,key:"content"},this._renderLevelPickerSection(),this._renderPhasePickerSection(),this._renderDisciplinesSection());case"failed":return a("p",{class:g.panelError},e.failed);default:return null}}_renderLoadingIndicator(){const t=this.messagesCommon.loading;return a("div",{"aria-label":t,class:g.loadingContainer,key:"loading-container",role:"presentation",title:t},a("calcite-loader",{label:t,type:"indeterminate"}))}_renderLevelPickerSection(){var o;const t=this.viewModel.level,e=t.state==="ready",i=t.allowedValues.length>1;if(!this.visibleElements.levels||!e||!i)return null;const s=(o=this.messages)==null?void 0:o.level;return a("div",{class:U(g.section,g.levels),key:"levels"},a(Q,{level:this.headingLevel},s==null?void 0:s.title),a(Pt,{messages:s,vm:t}))}_renderPhasePickerSection(){const t=this.viewModel.phase,e=t.state==="ready",i=t.allowedValues.length>1;if(!this.visibleElements.phases||!e||!i)return null;const s=this.messages.phase;return a("div",{class:U(g.section,g.phases),key:"phases"},a(Q,{level:this.headingLevel},s.title),a(Vt,{messages:s,vm:t}))}_renderDisciplinesSection(){var o;const t=this.viewModel.disciplines,e=t.state==="ready",i=t.root.hasChildren;if(!this.visibleElements.disciplines||!e||!i)return null;const s=(o=this.messages)==null?void 0:o.disciplines;return a("div",{class:U(g.section,g.disciplines),key:"disciplines"},a(Q,{level:this.headingLevel},s.title),a(wt,{messages:s,toggleSiblingsVisibility:this.toggleSiblingsVisibility,vm:t}))}};l([r({type:Ne})],c.prototype,"viewModel",void 0),l([r()],c.prototype,"view",null),l([r()],c.prototype,"layers",null),l([r()],c.prototype,"visibleElements",void 0),l([qe("visibleElements")],c.prototype,"_castVisibleElements",null),l([r()],c.prototype,"headingLevel",void 0),l([r()],c.prototype,"icon",null),l([r()],c.prototype,"label",null),l([r(),he("esri/widgets/BuildingExplorer/t9n/BuildingExplorer")],c.prototype,"messages",void 0),l([r(),he("esri/t9n/common")],c.prototype,"messagesCommon",void 0),l([r({nonNullable:!0})],c.prototype,"toggleSiblingsVisibility",void 0),l([r()],c.prototype,"uiStrings",void 0),c=l([m("esri.widgets.BuildingExplorer")],c);const Nt=c;/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.32/esri/copyright.txt for details.
v4.32.12 */const St=Te`@layer{arcgis-building-explorer{display:block}}`,kt=et(Nt),z=class z extends Ie{constructor(){super(...arguments),this.widget=kt(this),this.viewModel=this.widget.viewModel,this.autoDestroyDisabled=!1,this.headingLevel=this.widget.headingLevel,this.hideDisciplines=this.widget.visibleElements.disciplines,this.hideLevels=this.widget.visibleElements.levels,this.hidePhases=this.widget.visibleElements.phases,this.icon=this.widget.icon,this.label=this.widget.label,this.layers=this.widget.layers,this.level=this.viewModel.level,this.phase=this.viewModel.phase,this.position="bottom-left",this.state=this.viewModel.state,this.arcgisPropertyChange=Ae()("level","phase","state"),this.arcgisReady=He()}async destroy(){await this.manager.destroy()}};z.properties={autoDestroyDisabled:5,headingLevel:9,hideDisciplines:5,hideLevels:5,hidePhases:5,icon:1,label:1,layers:0,level:0,phase:0,position:1,referenceElement:1,state:3},z.shadowRootOptions=We,z.styles=St;let le=z;ze("arcgis-building-explorer",le);export{le as ArcgisBuildingExplorer};
