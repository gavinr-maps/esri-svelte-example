import"./intl-Do3GEEJ7.js";import{b0 as c,G as A,d as T,aO as R,B as S,z as D}from"./Accessor-BHnuXKD2.js";import{a as _,s as I}from"./formUtils-DXUHP5lI.js";import{a8 as O,S as U,a9 as F,x as j,aa as g,ab as G}from"./opacityUtils-CSd4XoR2.js";import{l as C,P}from"./layerUtils-dJgsXxkC.js";import{$ as w}from"./utils-DLmnG8WZ.js";import{R as M,T as B,F as v}from"./dateUtils-DDHuDOGz.js";import{s as b}from"./substitute-D1XJWgT5.js";var m,l;(function(e){e.Text="text",e.Number="number",e.Date="date",e.Unsupported="unsupported"})(m||(m={})),function(e){e.CANNOT_BE_EMPTY="input-validation-error::cannot-be-empty",e.TOO_SHORT="length-validation-error::too-short",e.TOO_LONG="length-validation-error::too-long"}(l||(l={}));const ae=(e,t)=>{if(!e)return!0;const{operations:n}=e;switch(t){case"INSERT":return n.supportsAdd;case"UPDATE":case"DELETE":return n.supportsUpdate;default:return!0}};function ue(e,t){const{dataType:n,domain:i,field:r,maxLength:o,minLength:a,range:s,required:u}=t;if(e==null)return u?l.CANNOT_BE_EMPTY:null;if(n==="text"&&typeof e=="string"){if(a>-1&&e.length<a)return l.TOO_SHORT;if(o>-1&&e.length>o)return l.TOO_LONG}return n!=="date"||M({type:r.type,range:s,value:e})?i?O(r,e,i):U(r,e)??O(r,e):F.OUT_OF_RANGE}function se(e,t){return!(!N(e)||!N(t))||e===t}function N(e){return e==null||e===""}function le({dataType:e,field:t,input:n}){if(e===m.Date)return-1;const r=d(t.length);if(!n||!_(n))return r;const o=d(n.maxLength);return o===-1?r:r===-1?o:Math.min(r,o)}function pe({dataType:e,field:t,input:n}){if(e===m.Date||!n||!_(n))return-1;const r=d(n.minLength);if(r<0)return-1;const o=d(t.length);return o>-1&&o<r?-1:r}function d(e){return typeof e=="number"&&e>-1?e:-1}const h={type:"number"},x={type:"number",intlOptions:{notation:"scientific"}};function $(e){return e>=1e7||e<=-1e7}function Z(e,t){return e.max!=null&&e.min!=null?t.outsideRange:e.max!=null?t.outsideRangeMax:t.outsideRangeMin}const me=e=>e&&!Number.isNaN(e.valueOf());function Y(e){var s;const{attributes:t,sourceLayer:n}=e??{},i=n&&"displayField"in n?n.displayField:null,r=i?t==null?void 0:t[i]:null,o=r!=null?JSON.stringify(r):null,a=(s=e==null?void 0:e.getObjectId())==null?void 0:s.toString();return o||a||""}const H=e=>(e==null?void 0:e.type)==="field",L=e=>(e==null?void 0:e.type)==="group",k=e=>(e==null?void 0:e.type)==="relationship",de=e=>e.type==="text",W=e=>e.type==="utilityNetworkAssociations",fe=e=>!L(e)&&e.group!=null,y=e=>e.reduce((t,n)=>L(n)?[...t,...n.inputs]:[...t,n],[]),ce=e=>y(e).filter(H),ye=e=>y(e).filter(k),Te=e=>y(e).filter(W),Oe=e=>e!=null&&(E(e,"combo-box")||E(e,"radio-buttons")),E=(e,t)=>{var n;return e!=null&&((n=e.input)==null?void 0:n.type)===t},ge=({domain:e,inputType:t="text-box",dataType:n})=>n==="number"&&t==="text-box"&&(!e||e.type!=="coded-value");function be(e,t){const{title:n,feature:i}=e??{};return n||(i?Y(i):null)||t||""}function Ne(e){const{attributes:t,fieldsIndex:n,label:i,timeZone:r}=e;if(!t||typeof t!="object")return i;const o=Object.keys(t).filter(u=>c(i,u)),a=o.map(u=>t[u]),s=o.map(u=>n.get(u)).filter(A);return K(i,J({values:a,fields:s,timeZone:r}))}const f="expression/",q="expr/",z="field/";function he(e){const[t,n]=e.split(f);return t===""&&n?n:(S.getLogger("esri.widgets.FeatureForm/featureFormUtils").error("extractExpressionNameFromString:invalid-input",`The string ${e} is not a valid expression reference of the form '${f}/expressionName'`),"")}function xe(e){return`${f}${e}`}function $e(e){return`${z}${e}`}function Ee(e){return e.startsWith(f)}function _e(e){return e.startsWith(q)}function J(e){const{fields:t,values:n}=e,i=e.timeZone??void 0,r=t.map((o,a)=>{let s=n[a];if(o.domain&&o.domain.type==="coded-value"){const u=o.domain.codedValues.find(p=>p.code===s);u!=null&&u.name&&(s=u.name)}return(w(o)||j(o))&&(s=B(o,s,{timeZone:i,...v(o)})),[o.name,s]});return Object.fromEntries(r)}function K(e,t){return T(T(e,n=>`{${n.toLowerCase()}}`),Object.fromEntries(Object.entries(t).map(([n,i])=>[n.toLowerCase(),i])))}const Fe=e=>{var n,i,r,o;const t={typeFieldName:null,types:[]};return e&&(C(e)?(t.typeFieldName=(n=e.parent)==null?void 0:n.subtypeField,t.types=((i=e.parent)==null?void 0:i.subtypes)??[]):e.type==="subtype-group"||e.type==="feature"&&((r=e.subtypes)!=null&&r.length)?(t.typeFieldName=e.subtypeField,t.types=e.subtypes??[]):"types"in e&&e.types&&(t.typeFieldName=e.typeIdField,t.types=e.types.map(({id:a,name:s,domains:u})=>({code:a,name:s,domains:u}))),t.typeFieldName!=null&&(t.typeFieldName=((o=e.getField(t.typeFieldName))==null?void 0:o.name)??t.typeFieldName)),t},ve=(e,t,n)=>{const{dataType:i,error:r,minLength:o}=e,a=t==null?void 0:t.validationErrors;if(!a||!r)return null;if(r===l.CANNOT_BE_EMPTY)return a.cannotBeNull;if(r===g.VALUE_OUT_OF_RANGE||r===F.OUT_OF_RANGE){const{field:s,range:u}=e,p={type:"date",intlOptions:{timeZone:s.type==="date"&&n?n:void 0,...v(s)}},V=Z(u,a);return b(V,u,{format:{max:i==="date"?p:u.max!=null&&$(u.max)?x:h,min:i==="date"?p:u.min!=null&&$(u.min)?x:h}})}return r===g.INVALID_CODED_VALUE?a.invalidCodedValue:r===G.INVALID_TYPE?a.invalidType:r===l.TOO_SHORT?b(a.tooShort,{min:o}):(l.TOO_LONG,null)},Le=e=>{var r;if(!e)return;const t=e.layer,n=t&&"geometryType"in t?t.geometryType:void 0,i=(r=e.geometry)==null?void 0:r.type;return i==="polyline"||n==="polyline"?"line":i==="mesh"||n==="mesh"||n==="multipatch"?"cube":i==="multipoint"||n==="multipoint"?"point":i||n||"table"},Ve=e=>{var n;const t=[];if(e.formTemplate){const{description:i,title:r}=e.formTemplate;(n=e.fields)==null||n.forEach(o=>{const a=r&&c(r,o.name),s=i&&c(i,o.name);(a||s)&&t.push(o.name)})}return t};function Ae(e,t){var i;const n=t??("formTemplate"in e&&e.formTemplate);return n?(((i=n.elements)==null?void 0:i.filter(I))??[]).some(({fieldName:r})=>!e.fieldsIndex.get(r)):!1}function Re(e,t){return e==null||t.onValue!==e&&t.offValue!==e}function Se(e,t){var n;switch(t.objectType){case"any":return!0;case"null":return e==null;case"code":return e===((n=t.codedValue)==null?void 0:n.code);case"range":return e!=null&&t.minValue!=null&&t.maxValue!=null&&+e>=t.minValue&&+e<=t.maxValue;default:return R(t.objectType),!1}}function De(e,t,n){const i=P(e),r=i==null?void 0:i.find(a=>a.code===n);if(!r)return!1;const o=i==null?void 0:i.find(a=>a.code===t);return!D(r.defaultValues,o==null?void 0:o.defaultValues)&&Object.values(r.defaultValues).some(a=>a!=null)}export{Oe as $,ye as A,xe as B,ge as C,Ne as D,fe as E,Te as I,Le as J,Ve as K,ce as L,$e as M,H as O,Ee as P,Ae as Q,he as S,de as U,L as V,_e as W,Re as X,J as Y,be as Z,y as _,ae as a,k as b,pe as c,se as d,Se as e,me as h,m as i,Y as l,le as p,Fe as q,ue as s,De as t,W as v,E as w,ve as z};
